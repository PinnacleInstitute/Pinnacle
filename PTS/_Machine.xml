<WTROOT prefix="pts" system="Pinnacle">
	<WTENTITY id="107" name="Machine" alias="mc">

		<!--Identity-->
		<WTATTRIBUTE id="10701" name="MachineID" type="number" identity="true" min="1" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="10702" name="MemberID" type="number" min="1" source="entity"/>

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="10705" name="MemberNameFirst" type="text" length="30" source="join">
			<WTJOIN entity="Member" name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10706" name="MemberNameLast" type="text" length="30" source="join">
			<WTJOIN entity="Member" name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10707" name="MemberEmail" type="text" length="80" source="join">
			<WTJOIN entity="Member" name="Email"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="10711" name="LiveDriveID" type="number" min="1" source="entity"/>
		<WTATTRIBUTE id="10712" name="NameLast" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="10713" name="NameFirst" type="text" length="30" min="1" max="30" required="true" title="true" source="entity"/>
		<WTATTRIBUTE id="10714" name="MachineName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameLast"/>
			<WTCOMPUTE text=", "/>
			<WTCOMPUTE name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10715" name="Email" type="text" length="80" min="1" max="80" required="true" source="entity"/>
		<WTATTRIBUTE id="10716" name="Password" type="text" length="20" min="1" max="20" required="true" source="entity"/>
		<WTATTRIBUTE id="10717" name="WebName" type="text" length="80" min="1" max="80" required="true" source="entity"/>
		<WTATTRIBUTE id="10718" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Setup"/>
			<WTENUM id="2" name="Active"/>
			<WTENUM id="3" name="Cancelled"/>
			<WTENUM id="4" name="Removed"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10719" name="Service" type="number" source="entity">
			<WTENUM id="1" name="Backup"/>
			<WTENUM id="2" name="Briefcase"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10720" name="ActiveDate" type="date" source="entity">
			<WTFORMAT value="mm/dd/yy" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10721" name="CancelDate" type="date" source="entity">
			<WTFORMAT value="mm/dd/yy" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10722" name="RemoveDate" type="date" source="entity">
			<WTFORMAT value="mm/dd/yy" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="10723" name="BackupUsed" type="text" length="10" min="1" max="10" source="entity"/>
		<WTATTRIBUTE id="10724" name="BackupCapacity" type="text" length="10" min="1" max="10" source="entity"/>
		<WTATTRIBUTE id="10725" name="BriefcaseUsed" type="text" length="10" min="1" max="10" source="entity"/>
		<WTATTRIBUTE id="10726" name="BriefcaseCapacity" type="text" length="10" min="1" max="10" source="entity"/>
		<WTATTRIBUTE id="10727" name="Qty" type="number" min="1" source="entity"/>

		<WTINDEX name="Email">
			<WTATTRIBUTE name="Email"/>
		</WTINDEX>
		<WTINDEX name="WebName">
			<WTATTRIBUTE name="WebName"/>
		</WTINDEX>
		<WTINDEX name="MachineName">
			<WTATTRIBUTE name="NameLast"/>
			<WTATTRIBUTE name="NameFirst"/>
		</WTINDEX>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Machine" entity="Machine" alias="mc"/>
			<WTRELATIONSHIP name="Common" entity="Machine" alias="mc">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="mc" name="MemberID" relalias="me" relname="MemberID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="MachineName" default="true"/>
			<WTATTRIBUTE name="Email"/>
		</WTENUM>

	</WTENTITY>

	<WTPROCEDURES>
		<!--================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="NewID" datatype="number"/>
			<WTDECLARE name="Result" datatype="number"/>
			<WTSETVALUE name="Now" value="SYS(timestamp)"/>
			<WTCODEGROUP>
				<WTINSERT/>
				<WTSETVALUE name="NewID" value="SYS(identity)"/>
				<WTSETVALUE name="PARAM(MachineID)" value="NewID"/>
				<WTPROCEDURE name="Machine_SetCustomerPrice">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="Result" direction="output" datatype="number"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(SalesItem.MachineID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTDECLARE name="MemberID" datatype="number"/>
			<WTDECLARE name="Result" datatype="number"/>
			<WTCODEGROUP>
				<WTPROCEDURE name="Machine_GetMemberID">
					<WTPARAM name="MachineID" direction="input" value="PARAM(Machine.MachineID)"/>
					<WTPARAM name="MemberID" direction="output" value="MemberID"/>
				</WTPROCEDURE>
				<WTDELETE>
					<WTJOIN name="Machine" lock="true"/>
					<WTCONDITION expr="ATTR(Machine.MachineID)" oper="equal" value="PARAM(MachineID)"/>
				</WTDELETE>
				<WTCODEGROUP>
					<WTPROCEDURE name="Machine_SetCustomerPrice">
						<WTPARAM name="MemberID" direction="input" value="MemberID"/>
						<WTPARAM name="Result" direction="output" datatype="number"/>
					</WTPROCEDURE>
				</WTCODEGROUP>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchEmail" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(Email)" direction="input"/>
			<WTPARAM name="ATTR(MachineID)" direction="output"/>
			<WTDECLARE name="MachineID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="MachineID" value="ATTR(Machine.MachineID)"/>
					<WTJOIN name="Machine" lock="false"/>
					<WTCONDITION expr="ATTR(Machine.Email)" oper="equal" value="PARAM(Email)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(MachineID)" value="MachineID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="Result" datatype="number"/>
			<WTCODEGROUP>
				<WTSETVALUE name="Now" value="SYS(timestamp)"/>
				<WTUPDATE>
					<WTJOIN name="Machine" lock="true"/>
					<WTCONDITION expr="ATTR(Machine.MachineID)" oper="equal" value="PARAM(MachineID)"/>
				</WTUPDATE>
				<WTPROCEDURE name="Machine_SetCustomerPrice">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="Result" direction="output" datatype="number"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="ListAll" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(Machine.MemberID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Machine.MachineID)"/>
					<WTATTRIBUTE value="ATTR(Machine.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Machine.LiveDriveID)"/>
					<WTATTRIBUTE value="ATTR(Machine.NameFirst)"/>
					<WTATTRIBUTE value="ATTR(Machine.NameLast)"/>
					<WTATTRIBUTE value="ATTR(Machine.Email)"/>
					<WTATTRIBUTE value="ATTR(Machine.Password)"/>
					<WTATTRIBUTE value="ATTR(Machine.WebName)"/>
					<WTATTRIBUTE value="ATTR(Machine.Status)"/>
					<WTATTRIBUTE value="ATTR(Machine.Service)"/>
					<WTATTRIBUTE value="ATTR(Machine.ActiveDate)"/>
					<WTATTRIBUTE value="ATTR(Machine.CancelDate)"/>
					<WTATTRIBUTE value="ATTR(Machine.RemoveDate)"/>
					<WTATTRIBUTE value="ATTR(Machine.BackupUsed)"/>
					<WTATTRIBUTE value="ATTR(Machine.BackupCapacity)"/>
					<WTATTRIBUTE value="ATTR(Machine.BriefcaseUsed)"/>
					<WTATTRIBUTE value="ATTR(Machine.BriefcaseCapacity)"/>
					<WTATTRIBUTE value="ATTR(Machine.Qty)"/>
					<WTJOIN name="Machine"/>
					<WTCONDITION expr="ATTR(Machine.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTORDER name="ATTR(Machine.Status)"/>
					<WTORDER name="ATTR(Machine.NameLast)"/>
					<WTORDER name="ATTR(Machine.NameFirst)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="List" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(Machine.MemberID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Machine.MachineID)"/>
					<WTATTRIBUTE value="ATTR(Machine.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Machine.LiveDriveID)"/>
					<WTATTRIBUTE value="ATTR(Machine.NameFirst)"/>
					<WTATTRIBUTE value="ATTR(Machine.NameLast)"/>
					<WTATTRIBUTE value="ATTR(Machine.Email)"/>
					<WTATTRIBUTE value="ATTR(Machine.Password)"/>
					<WTATTRIBUTE value="ATTR(Machine.WebName)"/>
					<WTATTRIBUTE value="ATTR(Machine.Status)"/>
					<WTATTRIBUTE value="ATTR(Machine.Service)"/>
					<WTATTRIBUTE value="ATTR(Machine.ActiveDate)"/>
					<WTATTRIBUTE value="ATTR(Machine.CancelDate)"/>
					<WTATTRIBUTE value="ATTR(Machine.RemoveDate)"/>
					<WTATTRIBUTE value="ATTR(Machine.BackupUsed)"/>
					<WTATTRIBUTE value="ATTR(Machine.BackupCapacity)"/>
					<WTATTRIBUTE value="ATTR(Machine.BriefcaseUsed)"/>
					<WTATTRIBUTE value="ATTR(Machine.BriefcaseCapacity)"/>
					<WTATTRIBUTE value="ATTR(Machine.Qty)"/>
					<WTJOIN name="Machine"/>
					<WTCONDITION expr="ATTR(Machine.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Machine.Status)" oper="not-equal" value="SYSCON(MACHINE-STATUS-REMOVED)" connector="and"/>
					<WTORDER name="ATTR(Machine.Status)"/>
					<WTORDER name="ATTR(Machine.NameLast)"/>
					<WTORDER name="ATTR(Machine.NameFirst)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="MemberCount" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="SetCustomerPrice" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Logon" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(Email)" direction="input"/>
			<WTPARAM name="ATTR(Password)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="20"/>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--============================================================================================-->
		<WTWEBPAGE name="10701" caption="Find" action="5" navbar="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="IsAnonymous" connector="or"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>


			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(MachineName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Machines" project="ptsMachineUser" class="CMachines">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachines" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Machines" project="ptsMachineUser" class="CMachines">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
				<WTMETHOD name="Find">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMachines" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="center"/>

				<WTROW>
					<WTSTATIC col="1" label="Machines" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader"/>
					<WTCOMBO col="1" value="ATTR(Machines.FindTypeID)" translate="true">
						<WTOPTION id="10714" label="MachineName"/>
						<WTOPTION id="10715" label="MachineEmail"/>
					</WTCOMBO>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>
				
				<WTSTATIC label="computers"/>
				<WTSTATIC label="notes"/>
				<WTSTATIC label="affiliate"/>

				<WTROW>
					<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Machine">
						<WTCOLUMN width="20" align="left" valign="top" label="MachineName"/>
						<WTCOLUMN width="20" align="left" valign="top" label="MachineEmail"/>
						<WTCOLUMN width="20" align="left" valign="top" label="Customer"/>
						<WTCOLUMN width="20" align="left" valign="top" label="CustomerEmail"/>
						<WTCOLUMN width="20" align="right" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP><WTIMAGE value="CONST(MachineStatus&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Machine.MachineName)"/>
							</WTSTATIC>

							<WTSTATIC col="2" value="DATA(Machine.Email)"/>
							<WTSTATIC col="3">
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(@membernamelast, ', ',first@membernamefirst)&quot;/&gt;)"/>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(Machine.MemberEmail)"/>
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(machine16.gif)" alt="computers" imgalign="absmiddle">
										<WTLINK name="10711" return="false" target="_blank">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(entity4.gif)" alt="affiliate" imgalign="absmiddle">
										<WTLINK name="0403" return="false" target="_blank">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											<WTPARAM name="contentpage" value="CONST(3)"/>
											<WTPARAM name="popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(notessm.gif)" alt="notes" imgalign="absmiddle">
										<WTLINK name="9005" return="false" target="_blank">
											<WTPARAM name="OwnerType" value="ENTITY(Member)"/>
											<WTPARAM name="OwnerID" value="DATA(MemberID)"/>
											<WTPARAM name="Title" value="DATA(MachineName)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
    
		<!--============================================================================================-->
		<WTWEBPAGE name="10702" caption="Machine" header="false" footer="false" navbar="false" stylesheet="StyleSheet5.css"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
      <!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberCount" datatype="number"/>
			<WTPARAM name="Price" datatype="currency"/>

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="LD_API.asp"/>
			<WTINCLUDE name="Comm.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
			</WTCODEGROUP>
			
			<WTSUB name="NewMachine">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="MemberCount">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="reqMemberCount" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="PARAM(MemberCount)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="ATTR(NameFirst)"/>
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="ATTR(NameLast)"/>
						<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="PARAM(MemberCount)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpNameFirst)"/>
						<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpNameLast)"/>
						<WTSETATTRIBUTE name="ATTR(Email)" value="CONST(tmpEmail)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="AddMachine">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)"/>
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
					<WTSETATTRIBUTE name="ATTR(Password)" value="FORM(Password)"/>
<WTCUSTOM>
			If ValidEmail( .Email ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="FetchEmail">
							<WTPARAM name="Email" direction="input" value="ATTR(Email)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CLng(.MachineID))" oper="not-equal" value="CONST(0)"/>
							<WTERROR number="10123" message="Oops, This email address is already assigned to another computer."/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(LEN(.Password))" oper="less" value="CONST(6)"/>
							<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MachineID" direction="input" value="CONST(0)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MACHINE-STATUS-SETUP)"/>
						<WTSETATTRIBUTE name="ATTR(Service)" value="SYSCON(MACHINE-SERVICE-BACKUP)"/>
						<WTSETATTRIBUTE name="ATTR(Qty)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="PARAM(Price)" value="CONST(5)"/>
						<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)"/>
						<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)"/>
						<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
						<WTSETATTRIBUTE name="ATTR(Password)" value="FORM(Password)"/>
						<WTSETATTRIBUTE name="ATTR(WebName)" value="CONST(&quot;temp&quot;)"/>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="MachineID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCALLSUB name="SetComputerWebName oMachine"/>
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
<WTCUSTOM>
			Result = UpdateComputerStatus( oMachine, tmpStatus )
			If Result &lt;&gt; "OK" Then
	DoError -1, "", Result
	Else
	'Email Support for new computer limits
	SendEmail reqSysCompanyID, "support@cloudzow.com", "support@cloudzow.com", "limit@cloudzow.com", "", "", "NEW COMPUTER: " + .Email, .NameFirst + " " + .NameLast + " - " + .LiveDriveID + " (" + .Qty + ")"
	End If
</WTCUSTOM>
							<WTMETHOD name="Save">
								<WTCONDITION expr="NoErrors"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTCODEGROUP>
								<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
						'Email Software Installation Instructions
						Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
						If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
						Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "10708.asp?CompanyID=5&amp;MachineID=" &amp; MachineID
							oHTTP.send
						End If
						Set oHTTP = Nothing
</WTCUSTOM>
							</WTCODEGROUP>
							<WTMETHOD name="Delete">
								<WTCONDITION expr="IsErrors"/>
								<WTCONDITION expr="CONST(MachineID)" oper="greater" value="CONST(0)" connector="and"/>
								<WTPARAM name="MachineID" direction="input" value="ATTR(MachineID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- New Computer - Update Upline Group Sales Volumes -->
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(101)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(Price)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMachine"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTCALLSUB name="AddMachine"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="AddAnother" type="Add">
				<WTCALLSUB name="AddMachine"/>
				<WTCALLSUB name="NewMachine">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="TitleCase(obj)">	
					var val = obj.value;
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
				</WTFUNCTION>

				<WTFUNCTION name="Validate()">	
					var valid = 1;
					var namefirst = document.getElementById('NameFirst').value;
					var namelast = document.getElementById('NameLast').value;
					var email = document.getElementById('Email').value;
					var password = document.getElementById('Password').value;

					if(namefirst==''){ alert('Oops, First Name Required!'); valid=0; };
					if(valid==1 &amp;&amp; namelast==''){ alert('Oops, Last Name Required!'); valid=0; };
					if(valid==1 &amp;&amp; email==''){ alert('Oops, Email Required!'); valid=0; };
					if(valid==1 &amp;&amp; password==''){ alert('Oops, Password Required!'); valid=0; };

					return valid;
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="NewMachine" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" merge="2" align="left" label="NewMachineText" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="UserName"/>
					<WTTEXT col="2" value="ATTR(Machine.NameFirst)" width="200" label="NameFirst" size="25" required="false">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Machine.NameLast)" width="240" label="NameLast" size="25" required="false">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Machine.Email)" required="false" class="prompt"/>
					<WTSTATIC col="2" label="Unique"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Password"/>
					<WTTEXT col="2" value="ATTR(Machine.Password)" required="false" class="prompt"/>
					<WTSTATIC col="2" label="PasswordText"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" value="CONST(Add)">
						<WTCONDITION expr="IsActive"/>
<!--						<WTCLICK>if( validate() == 1 ) { doSubmit(2,&quot;&quot;); this.disabled = true }</WTCLICK>-->
						<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
					</WTBUTTON>
<!--					
					<WTBUTTON col="2" action="4" value="CONST(AddAnother)">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
-->					
					<WTBUTTON col="2" action="3" value="CONST(Cancel)"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="10703" caption="Machine" header="false" footer="false" navbar="false" stylesheet="StyleSheet5.css"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" >
		<!--============================================================================================-->
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Price" datatype="currency"/>
			<WTPARAM name="ShowPassword" datatype="number"/>

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="LD_API.asp"/>
			
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
			</WTCODEGROUP>

			<WTSUB name="SetPassword">
				<WTCODEGROUP>
					<WTCONDITION expr="IsSysAdmin"/>
					<WTSETATTRIBUTE name="PARAM(ShowPassword)" value="CONST(1)"/>
				</WTCODEGROUP>					
<!--
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="SYS(MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
					<WTSETATTRIBUTE name="PARAM(ShowPassword)" value="CONST(1)"/>
				</WTCODEGROUP>					
				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTSETATTRIBUTE name="PARAM(ShowPassword)" value="CONST(1)"/>
				</WTCODEGROUP>		
-->							
			</WTSUB>

			<WTSUB function="Update_Computer(oMachine)">
<WTCUSTOM>
	Result = UpdateComputer( oMachine )
	If Result &lt;&gt; "OK" Then DoError -1, "", Result
</WTCUSTOM>
			</WTSUB>

			<WTSUB function="Update_Computer_Status(oMachine, tmpStatus)">
<WTCUSTOM>
	Result = UpdateComputerStatus( oMachine, tmpStatus )
	If Result &lt;&gt; "OK" Then DoError -1, "", Result
</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="SetPassword"/>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
<WTCUSTOM>
			If ValidEmail( .Email ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="FetchEmail">
							<WTPARAM name="Email" direction="input" value="ATTR(Email)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CLng(.MachineID))" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="CONST(CLng(.MachineID))" oper="not-equal" value="PARAM(MachineID)" connector="and"/>
							<WTERROR number="10123" message="Oops, This email address is already assigned to another computer."/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="ATTR(Password)" value="FORM(Password)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(LEN(.Password))" oper="less" value="CONST(6)"/>
							<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpWebName)" value="ATTR(WebName)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTES/>
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpEmail)" oper="not-equal" value="ATTR(Email)" connector="and"/>
						<WTCALLSUB name="SetComputerWebName oMachine"/>
					</WTCODEGROUP>
-->					
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(LiveDriveID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpNameFirst)" oper="not-equal" value="ATTR(NameFirst)"/>
							<WTCONDITION expr="CONST(tmpNameLast)" oper="not-equal" value="ATTR(NameLast)" connector="or"/>
							<WTCONDITION expr="CONST(tmpEmail)" oper="not-equal" value="ATTR(Email)" connector="or"/>
							<WTCONDITION expr="CONST(tmpWebName)" oper="not-equal" value="ATTR(WebName)" connector="or"/>
							<WTCALLSUB name="Update_Computer oMachine"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="ATTR(Status)" connector="and"/>
						<WTCALLSUB name="Update_Computer_Status oMachine, tmpStatus"/>
					</WTCODEGROUP>

					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCALLSUB name="SetPassword">
						<WTCONDITION expr="IsErrors"/>
					</WTCALLSUB>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Delete">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>


			<WTACTION id="5" name="Cancel" type="Update">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MACHINE-STATUS-CANCELLED)"/>
					<WTSETATTRIBUTE name="PARAM(Price)" value="CONST(-5)"/>
					<WTCALLSUB name="Update_Computer_Status oMachine, tmpStatus"/>
					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(tmpStatus)"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<!-- Cancelled Computer - Update Upline Group Sales Volumes -->
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(101)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(Price)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="6" name="Activate" type="Update">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
					<WTSETATTRIBUTE name="PARAM(Price)" value="CONST(5)"/>
					<WTCALLSUB name="Update_Computer_Status oMachine, tmpStatus"/>
					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(tmpStatus)"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<!-- Activated Computer - Update Upline Group Sales Volumes -->
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(101)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(Price)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="7" name="Remove" type="Update">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MACHINE-STATUS-REMOVED)"/>
					<WTCALLSUB name="Update_Computer_Status oMachine, tmpStatus"/>
					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(tmpStatus)"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="8" name="GetBackup" type="Update">
				<WTCALLSUB name="SetPassword"/>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
	Result = GetUser( oMachine )
	If Result &lt;&gt; "OK" Then DoError -1, "", Result Else .Save 1 End If	
</WTCUSTOM>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="left">
						<WTSTATIC tag="Machine" value="ATTR(Machine.Email)" space="2"/>
						<WTSTATIC value="ATTR(Machine.Status)" fontcolor="green">
							<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-SETUP)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Machine.Status)" fontcolor="black">
							<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Machine.Status)" fontcolor="red">
							<WTCONDITION expr="ATTR(Machine.Status)" oper="greater" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" bold="true">
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Machine.LiveDriveID)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC label="LiveDriveID"/>
							<WTSTATIC value="ATTR(Machine.LiveDriveID)" space="3"/>
						</WTSTATIC>
						<WTSTATIC tag="ActiveDate" value="ATTR(Machine.ActiveDate)" space="3">
							<WTCONDITION expr="ATTR(Machine.Status)" oper="not-equal" value="SYSCON(MACHINE-STATUS-SETUP)"/>
						</WTSTATIC>
						<WTSTATIC tag="CancelDate" value="ATTR(Machine.CancelDate)" space="3">
							<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-CANCELLED)"/>
						</WTSTATIC>
						<WTSTATIC tag="RemoveDate" value="ATTR(Machine.RemoveDate)">
							<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-REMOVED)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="NotManager"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>
				
				<WTROW>
					<WTCONDITION expr="IsManager"/>
					<WTSTATIC col="1" tag="MemberID"/>
					<WTTEXT col="2" value="ATTR(Machine.MemberID)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="UserName"/>
					<WTTEXT col="2" value="ATTR(Machine.NameFirst)" width="200" label="NameFirst" size="25" required="false"/>
					<WTTEXT col="2" value="ATTR(Machine.NameLast)" width="240" label="NameLast" size="25" required="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Machine.Email)" required="false" class="prompt"/>
					<WTSTATIC col="2" label="Unique"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="NotManager"/>
					<WTHIDDEN value="ATTR(Machine.WebName)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="IsManager"/>
					<WTSTATIC col="1" tag="WebName"/>
					<WTTEXT col="2" value="ATTR(Machine.WebName)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(ShowPassword)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="Password"/>
					<WTTEXT col="2" value="ATTR(Machine.Password)" required="false" class="prompt"/>
					<WTSTATIC col="2" label="PasswordText"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(ShowPassword)" oper="equal" value="CONST(0)"/>
					<WTHIDDEN value="ATTR(Machine.Password)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Machine.BackupUsed)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="BackupUsed"/>
					<WTSTATIC col="2" value="ATTR(Machine.BackupUsed)" space="3"/>
					<WTSTATIC col="2" tag="BackupCapacity"/>
					<WTSTATIC col="2" value="ATTR(Machine.BackupCapacity)" noprespace="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Machine.BriefcaseUsed)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="BriefcaseUsed"/>
					<WTSTATIC col="2" value="ATTR(Machine.BriefcaseUsed)" space="3"/>
					<WTSTATIC col="2" tag="BriefcaseCapacity"/>
					<WTSTATIC col="2" value="ATTR(Machine.BriefcaseCapacity)" noprespace="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsSysAdmin"/>
					<WTROW>
						<WTSTATIC col="1" tag="Status"/>
						<WTCOMBO col="2" value="ATTR(Machine.Status)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotSysAdmin"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Machine.Status)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1" tag="Qty"/>
						<WTTEXT col="2" value="ATTR(Machine.Qty)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ActiveDate"/>
						<WTTEXT col="2" value="ATTR(Machine.ActiveDate)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CancelDate"/>
						<WTTEXT col="2" value="ATTR(Machine.CancelDate)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="RemoveDate"/>
						<WTTEXT col="2" value="ATTR(Machine.RemoveDate)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Machine.Qty)"/>
						<WTHIDDEN value="ATTR(Machine.ActiveDate)"/>
						<WTHIDDEN value="ATTR(Machine.CancelDate)"/>
						<WTHIDDEN value="ATTR(Machine.RemoveDate)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="8" value="CONST(GetBackup)">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-ACTIVE)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)"/>
					<WTBUTTON col="1" merge="2" action="5" value="CONST(CancelMachine)" msg="ConfirmCancelMachine">
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="7" value="CONST(RemoveMachine)" msg="ConfirmRemoveMachine">
						<WTCONDITION expr="IsSysAdmin"/>
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-CANCELLED)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="6" value="CONST(ActivateMachine)" msg="ConfirmActivateMachine">
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-SETUP)"/>
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-CANCELLED)" connector="or"/>
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-REMOVED)" connector="or"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(DeleteMachine)" msg="ConfirmDeleteMachine">
						<WTCONDITION expr="IsSysAdmin"/>
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-SETUP)" connector="and" paren="start"/>
						<WTCONDITION expr="ATTR(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-REMOVED)" connector="or" paren="end"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="10705" caption="User Logon" header="false" footer="false" navbar="false" stylesheet="StyleSheet5.css"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="10705">
		<!--============================================================================================-->
			<WTPARAM name="Logon" datatype="text"/>
			<WTPARAM name="Password" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="Logon2" datatype="text"/>
			<WTPARAM name="Password2" datatype="text"/>
			<WTPARAM name="Remember2" datatype="number"/>
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="Warn" datatype="number"/>
			<WTPARAM name="ContactInfo" datatype="number"/>

			<WTCODEGROUP>
<WTCUSTOM>
tmpUserAgent = Request.ServerVariables("HTTP_USER_AGENT")
If InStr(tmpUserAgent, "MSIE 8.0" ) &gt; 0 OR InStr(tmpUserAgent, "MSIE 9.0" ) &gt; 0 Then reqWarn = 1
</WTCUSTOM>			
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;BrowserWarning.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTGETCOOKIE name="PARAM(Logon)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Password)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTGETCOOKIE name="PARAM(Logon2)" value="CONST(LGN2)"/>
				<WTGETCOOKIE name="PARAM(Password2)" value="CONST(PWD2)"/>
				<WTSETATTRIBUTE name="PARAM(Remember2)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Logon2)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="1" name="Logon2" type="Update">

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember2)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN2)" value="PARAM(Logon2)"/>
					<WTSETCOOKIE name="CONST(PWD2)" value="PARAM(Password2)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember2)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN2)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD2)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>

				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Logon">
						<WTPARAM name="Email" direction="input" value="PARAM(Logon2)"/>
						<WTPARAM name="Password" direction="input" value="PARAM(Password2)"/>
						<WTPARAM name="Result" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTSETATTRIBUTE name="CONST(tmpResultCode)" value="CONST(Left(Result,1))" />
				<WTSETATTRIBUTE name="CONST(tmpResultNum)" value="CONST(Mid(Result,2))" />
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(Result)" oper="equal" value="&quot;E1&quot;"/>
					<WTERROR number="10129" message="Oops, Your Logon Email could not be found."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(Result)" oper="equal" value="&quot;E2&quot;"/>
					<WTERROR number="10130" message="Oops, Your Password is incorrect."/>
				</WTCODEGROUP>
				<!-- Check if we found the Customer -->
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpResultCode)" oper="equal" value="&quot;C&quot;"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpResultNum)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
						<!-- Display message to contact Customer Support if status is inactive, suspended, or not set -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpStatus)" oper="less" value="SYSCON(MEMBER-PAID)"/>
							<WTCONDITION expr="CONST(tmpStatus)" oper="greater" value="SYSCON(MEMBER-FREE)" connector="or"/>
							<WTERROR number="-2147220517" message="Oops, Please contact Customer Support to access the system."/>
							<WTSETATTRIBUTE name="PARAM(ContactInfo)" value="SYSCON(YES)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTSETATTRIBUTE name="ATTR(VisitDate)" value="SYS(Now)"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETCACHE name="CUSTOMER" value="CONST(tmpResultNum)"/>
						<WTRETURN>
							<WTLINK name="10711" secure="false">
								<WTPARAM name="MemberID" value="CONST(tmpResultNum)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<!-- Check if we found a single computer user -->
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpResultCode)" oper="equal" value="&quot;M&quot;"/>
					<WTSETCACHE name="CUSTOMER" value="CONST(tmpResultCode)"/>
					<WTRETURN>
						<WTLINK name="10711" secure="false">
							<WTPARAM name="MachineID" value="CONST(tmpResultNum)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="2" name="Logon" type="Update">
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="PARAM(Logon)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="PARAM(Password)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>

				<WTRETURN>
					<WTLINK name="0101" >
						<WTPARAM name="Lgn" value="PARAM(Logon)"/>
						<WTPARAM name="Pwd" value="PARAM(Password)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

      <!-- Send email to machine email in file for forgot password-->
      <WTACTION id="3" name="ForgotPassword" type="Update">
			<WTSETATTRIBUTE name="CONST(tmpMachineID)" value="CONST(0)" />
			<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
				<WTMETHOD name="FetchEmail">
					<WTPARAM name="Email" direction="input" value="PARAM(Logon2)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="CONST(tmpMachineID)" value="ATTR(MachineID)" />
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpMachineID)" oper="equal" value="CONST(0)"/>
					<WTERROR number="10129" message="Oops, Your Logon Email could not be found."/>
				</WTCODEGROUP>
			</WTOBJECT>
			<WTCODEGROUP>
				<WTCONDITION expr="CONST(tmpMachineID)" oper="not-equal" value="CONST(0)"/>
<WTCUSTOM>
          Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
          If oHTTP Is Nothing Then
	          Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
          Else
		      oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "10706.asp?MachineId=" &amp; tmpMachineID
			  oHTTP.send
          End If
          Set oHTTP = Nothing
</WTCUSTOM>
			</WTCODEGROUP>
      </WTACTION>  

			<WTACTION id="4" name="ForgotPassword2" type="Update">
				<WTRETURN>
					<WTLINK name="0102"/>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>

				<WTROW>
					<WTIMAGE col="1" value="CONST(logo.png)" align="center"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" value="CONST(IMPORTANT TERMINATION NOTICE... CLICK HERE)" align="center" fontcolor="red" fontsize="6">
						<WTLINK name="CONST(http://www.cloudzow.com/home/cloudzownotice.html)" type="anchor" target="notice" return="false" nodata="true"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="30"  align="center"/>
						<WTCOLUMN width="250" align="center"/>
						<WTCOLUMN width="40"  align="center"/>
						<WTCOLUMN width="250" align="center"/>
						<WTCOLUMN width="30"  align="center"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTABLE col="2" valign="top" padding="0" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="80" align="right"/>
								<WTCOLUMN width="170" align="left"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" height="18" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(machine16.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC label="CustomerLogon" fontcolor="darkblue" bold="true"/>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-top="12" margin-bottom="6">
									<WTSTATIC col="1" tag="Logon" align="right"/>
									<WTTEXT col="2"  value="PARAM(Logon2)" align="left" size="20"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="Password" align="right"/>
									<WTTEXT col="2" value="PARAM(Password2)" align="left" size="20" required="false" secure="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTCHECK col="2" value="PARAM(Remember2)" label="Remember" align="left"/>
								</WTROW>
								<WTROW margin-top="12" margin-bottom="12">
									<WTBUTTON col="1" merge="2" action="1" value="CONST(LogonCustomer)" align="center"/>
								</WTROW>
								<WTROW margin-bottom="12">
									<WTBUTTON col="1" merge="2" action="3" value="CONST(ForgotPassword)" align="center" msg="msgForgotPassword" btnclass="smbutton"/>
								</WTROW>
							</WTTABLE>
							<WTSTATIC col="3"/>
							<WTTABLE col="4" valign="top" padding="0" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="80" align="right"/>
								<WTCOLUMN width="170" align="left"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" height="18" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(entity4.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC label="SystemLogon" fontcolor="darkblue" bold="true"/>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-top="12" margin-bottom="6">
									<WTSTATIC col="1" tag="Logon2" align="right"/>
									<WTTEXT col="2"  value="PARAM(Logon)" align="left" size="20"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="Password" align="right"/>
									<WTTEXT col="2" value="PARAM(Password)" align="left" size="20" required="false" secure="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTCHECK col="2" value="PARAM(Remember)" label="Remember" align="left"/>
								</WTROW>
								<WTROW margin-top="12" margin-bottom="12">
									<WTBUTTON col="1" merge="2" action="2" value="CONST(LogonSystem)" align="center"/>
								</WTROW>
								<WTROW margin-bottom="12">
									<WTBUTTON col="1" merge="2" action="4" value="CONST(ForgotPassword)" align="center" btnclass="smbutton"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
				  	<WTCONDITION expr="PARAM(ContactInfo)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="ContactInfo" align="center" class="PageHeading">
						<WTLINK name="CONST(http://www.cloudzow.com/home/contact.html)" type="anchor" target="contactinfo" return="false" nodata="true"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Computer User Forgot Password Email -->
		<!--==================================================================================================-->
		<WTWEBPAGE name="10706" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl">
		<!--==================================================================================================-->
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>
			<!--Required Parameter for Mail-->

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
		        
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Machine.Email)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Forgot Password&quot;)"/>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender"/>

			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="UserName">
						<WTSTATIC value="ATTR(Machine.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Machine.NameLast)"/>
					</WTSTATIC>
				</WTROW>
		  
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Email" value="ATTR(Machine.Email)"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Password" value="ATTR(Machine.Password)"/>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1">
						<WTSTATIC label="LogonInstruction"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC value="ATTR(Company.CompanyName)"/>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- New Customer Welcome Email -->
		<!--==================================================================================================-->
		<WTWEBPAGE name="10707" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl">
		<!--==================================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>
			<!--Required Parameter for Mail-->

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
		        
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machines" project="ptsMachineUser" class="CMachines">
					<WTMETHOD name="List">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachines" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;CustomerWelcome.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>

				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Welcome to CloudZow!&quot;)"/>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender"/>

			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" label="Welcome">
						<WTSTATIC space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
		  
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>

				<WTROW margin-top="6">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Machine">
						<WTCOLUMN width="30" align="left" label="UserName"/>
						<WTCOLUMN width="35" align="left" label="Email"/>
						<WTCOLUMN width="35" align="left" label="Password"/>
						
						<WTROW height="18">
<!--							<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>-->
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Machine.NameFirst)" space="1"/>
								<WTSTATIC value="DATA(Machine.NameLast)"/>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Machine.Email)"/>
							<WTSTATIC col="3" value="DATA(Machine.Password)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC value="ATTR(Company.CompanyName)"/>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- New Computer Software Install Email -->
		<!--==================================================================================================-->
		<WTWEBPAGE name="10708" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl">
		<!--==================================================================================================-->
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>
			<!--Required Parameter for Mail-->

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
		        
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Machine.Email)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;SoftwareInstallation.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>

				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;CloudZow! Software Installation&quot;)"/>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender"/>

			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" label="Welcome">
						<WTSTATIC space="1"/>
						<WTSTATIC value="ATTR(Machine.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Machine.NameLast)"/>
					</WTSTATIC>
				</WTROW>
		  
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Email" value="ATTR(Machine.Email)"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Password" value="ATTR(Machine.Password)"/>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC value="ATTR(Company.CompanyName)"/>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- New Customer to Affiliate Upgrade Email -->
		<!--==================================================================================================-->
		<WTWEBPAGE name="10709" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl">
			<!--==================================================================================================-->
			<WTPARAM name="MemberEmail" datatype="text"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>
			<!--Required Parameter for Mail-->

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text"/>
					</WTMETHOD>
				
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(Member.ReferralID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpReferralID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Member.Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Member.Email)"/>
				</WTOBJECT>


				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Become a CloudZow Affiliate&quot;)"/>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender"/>

			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" label="Welcome">
						<WTSTATIC space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
	
				<WTROW margin-top="12">
					<WTSTATIC col="1" label="CustomerUpgradeLabel" class="PageHeading">
						<WTLINK name="http://www.cloudzow.com/customerupgrade" return="false">
							<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
						</WTLINK>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="10711" caption="Customer Portal" header="false" footer="false" navbar="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Total" datatype="currency"/>
			<WTPARAM name="PrepaidMachines" datatype="number"/>
			<WTPARAM name="Customer" datatype="number"/>
			<WTPARAM name="GrandTotal" datatype="currency"/>
			<WTPARAM name="TrialDays" datatype="number"/>
			<WTPARAM name="ShowPassword" datatype="number"/>
			<WTPARAM name="IsEdit" datatype="number"/>
			<WTPARAM name="IsMoney" datatype="number"/>
			<WTPARAM name="IsUniversity" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTGETCACHE name="CONST(tmpMemberID)" value="CUSTOMER"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsAnonymous"/>
				<WTCONDITION expr="CONST(CSTR(reqMemberID))" oper="not-equal" value="CONST(tmpMemberID)" connector="and"/>
				<WTCONDITION expr="CONST(tmpMemberID)" oper="not-equal" value="CONST(&quot;M&quot;)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsEmployee"/>
				<WTSETATTRIBUTE name="PARAM(IsEdit)" value="CONST(1)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsAnonymous"/>
				<WTCONDITION expr="PARAM(MachineID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(IsEdit)" value="CONST(1)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="SYS(MemberID)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(IsEdit)" value="CONST(1)"/>
			</WTCODEGROUP>
<!--
			<WTSUB name="SetPassword">
				<WTCODEGROUP>
					<WTCONDITION expr="IsManager"/>
					<WTSETATTRIBUTE name="PARAM(ShowPassword)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="SYS(MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
					<WTSETATTRIBUTE name="PARAM(ShowPassword)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTSETATTRIBUTE name="PARAM(ShowPassword)" value="CONST(1)"/>
				</WTCODEGROUP>					
			</WTSUB>
-->			
			<WTSUB name="LoadMachines">
<!--				<WTCALLSUB name="SetPassword"/>-->
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTCONDITION expr="PARAM(MachineID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberOnly"/>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(.ReferralID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTCUSTOM>Response.Write "Invalid Access to Customer Portal."
				Response.Write "&lt;BR&gt;MemberID: " + CStr(reqMemberID) + " - " + CStr(tmpMemberID)
				Response.End</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(PrepaidMachines)" value="ATTR(Process)"/>
					<WTSETATTRIBUTE name="PARAM(Customer)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Customer)" value="CONST(0)">
						<WTCONDITION expr="ATTR(Level)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
<WTCUSTOM>
			reqTrialDays = .TrialDays - DateDiff( "d", .EnrollDate, reqSysDate)
			if reqTrialDays &lt; 0 Then reqTrialDays = 0
</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
	If InStr( .Options2, "M" ) &gt; 0 Then reqIsMoney = 1
	If InStr( .Options2, "U" ) &gt; 0 Then reqIsUniversity = 1
</WTCUSTOM>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(MachineID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machines" project="ptsMachineUser" class="CMachines">
					<WTCONDITION expr="PARAM(MachineID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="ListAll">
						<WTCONDITION expr="IsEmployee"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="List">
						<WTCONDITION expr="NotEmployee"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
<WTCUSTOM>
				reqCount = 0
				reqTotal = 0
				tmpCnt = 0
				For Each oMachine in oMachines
					tmpCnt = tmpCnt + 1
					With oMachine
						If .Status &lt;= 2 Then
							reqCount = reqCount + 1
							Select Case .Service
							Case 1
								reqTotal = reqTotal + 5
							Case 2
								reqTotal = reqTotal + 15
							End Select	
						End If
					End With
				Next
				reqTotal = FormatCurrency(reqTotal)
				reqGrandTotal = reqPrepaidMachines * 5
				reqGrandTotal = FormatCurrency(reqGrandTotal)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachines" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Customer)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Count)" oper="less" value="PARAM(PrepaidMachines)" connector="and"/>
<WTCUSTOM>
	If tmpCnt = 0 Then
	xmlMachines = "&lt;PTSMACHINES&gt;"
	Else
		xmlMachines = Replace( xmlMachines, "&lt;/PTSMACHINES&gt;", "" )
	END If
	For x = reqCount+1 to reqPrepaidMachines
		xmlMachines = xmlMachines + "&lt;PTSMACHINE" + " status=""0"" memberid=""" + CSTR(x) + """/&gt;"
	Next
	xmlMachines = xmlMachines + "&lt;/PTSMACHINES&gt;"
</WTCUSTOM>
					</WTCODEGROUP>
					
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;ProductSupport.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMachines"/>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="5" name="Update" type="Update">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMachines"/>
			</WTACTION>
			
			<WTACTION id="6" name="NewMachine" type="Update">
				<WTRETURN>
					<WTLINK name="10702" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="7" name="Finished" type="Update">
				<WTRETURN>
					<WTLINK name="Page" nolocaldata="true">
						<WTPARAM name="Page" value="CONST(&quot;Install&quot;)"/>
						<WTPARAM name="Company" value="SYS(CompanyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="8" name="Billing" type="Update">
				<WTRETURN>
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="9" name="AddBilling" type="Update">
				<WTRETURN>
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="10" name="ChangeComputers" type="Update">
				<WTRETURN>
					<WTLINK name="Change" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="75" align="left"/>
				<WTCOLUMN width="675" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
				</WTROW>

				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>
				<WTSTATIC label="Discover"/>
				<WTSTATIC label="Amex"/>
				
				<WTFUNCTION name="CustomerBilling()">
					var url, win, member;
					member = document.getElementById('MemberID').value
					url = "Trialp.asp?memberid=" + member
		            win = window.open(url,"CustomerBilling","");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="GetWebName(WName)">
					var url1, win, webnm;
					webnm = WName;
					url1 = "http://" + webnm + ".cloudzow.net"
					win = window.open(url1,"","");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTIMAGE col="1" value="CONST(Machine48.gif)"/>
					<WTSTATIC col="2" fontsize="3" fontcolor="#000070">
						<WTSTATIC bold="true">
							<WTSTATIC tag="Affiliate">
								<WTCONDITION expr="PARAM(Customer)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC tag="Customer">
								<WTCONDITION expr="PARAM(Customer)" oper="not-equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
							<WTSTATIC value="ATTR(Member.NameLast)" space="3"/>
							<WTSTATIC value="ATTR(Member.Email)"/>
						</WTSTATIC>

						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC fontsize="2">
								<WTSTATIC tag="BillTo"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
									<WTCODEGROUP>	
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
										<WTSTATIC value="ATTR(Billing.CardType)" space="1" enum="true"/>
										<WTSTATIC value="ATTR(Billing.CardNumber)" space="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSBILLING/@cardmo,'/',/DATA/TXN/PTSBILLING/@cardyr)&quot;/&gt;)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CardName)" space="1"/>
									</WTCODEGROUP>	
									<WTCODEGROUP>	
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(2)"/>
										<WTSTATIC value="ATTR(Billing.CheckBank)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CheckName)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CheckRoute)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CheckAccount)" space="1"/>
									</WTCODEGROUP>	
									<WTBUTTON action="8" value="CONST(Edit)" btnclass="smbutton"/>
								</WTCODEGROUP>	
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MachineID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Customer)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="2" fontsize="3" fontcolor="#000070" align="center">
								<WTCODEGROUP>	
									<WTCONDITION expr="PARAM(TrialDays)" oper="equal" value="CONST(0)"/>
									<WTSTATIC label="TrialExpired1" newline="1" bold="true"/>
									<WTSTATIC label="TrialExpired2"/>
								</WTCODEGROUP>	
								<WTSTATIC bold="true">	
									<WTCONDITION expr="PARAM(TrialDays)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC value="PARAM(TrialDays)" space="1"/>
									<WTSTATIC label="TrialRemaining"/>
								</WTSTATIC>	
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTBUTTON col="1" merge="2" value="CONST(CustomerAddBilling)" align="center">
								<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
								<WTCLICK>CustomerBilling();</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="12">
						<WTCONDITION expr="PARAM(Customer)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTBUTTON col="1" merge="2" action="9" value="CONST(AddBilling)" align="center"/>
					</WTROW>
				</WTCODEGROUP>
<!--				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
-->
				<WTSTATIC label="EditComputer"/>
				<WTSTATIC label="ConvertCustomer"/>
				<WTSTATIC label="ConfigureNewComputer"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MachineID)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="200" align="right"/>
						<WTCOLUMN width="400" align="left"/>
						<WTROW height="18">
							<WTSTATIC col="1" tag="UserName"/>
							<WTSTATIC col="2" bold="true">
								<WTSTATIC value="ATTR(Machine.NameFirst)" space="1"/>
								<WTSTATIC value="ATTR(Machine.NameLast)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW height="18">
							<WTSTATIC col="1" tag="Email"/>
							<WTSTATIC col="2" value="ATTR(Machine.Email)" bold="true"/>
						</WTROW>
<!--						
						<WTROW height="18">
							<WTSTATIC col="1" tag="Password"/>
							<WTSTATIC col="2" value="ATTR(Machine.Password)" bold="true"/>
						</WTROW>
-->						
						<WTROW height="18">
							<WTSTATIC col="1" tag="OnlineData"/>
							<WTSTATIC col="2" value="ATTR(Machine.WebName)" bold="true">
								<WTLINK name="GetWebName('&lt;xsl:value-of select=&quot;@webname&quot;/&gt;')" click="true" />
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
					</WTROW>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MachineID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSMACHINES/PTSMACHINE))" oper="greater" value="CONST(0)" connector="and"/>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" align="left" class="prompt">
							<WTCODEGROUP>
								<WTSTATIC label="NewMachineListText">
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSMACHINES/PTSMACHINE))" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="MachineListText">
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSMACHINES/PTSMACHINE))" oper="greater" value="CONST(0)"/>
								</WTSTATIC>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Machine">
							<WTCOLUMN width="25" align="left" label="UserName"/>
							<WTCOLUMN width="30" align="left" label="Email"/>
<!--							<WTCOLUMN width="15" align="left" label="Password"/>-->
							<WTCOLUMN width="25" align="left" label="OnlineData"/>
							<WTCOLUMN width="17" align="left" label="Service"/>
							<WTCOLUMN width="3" align="center"/>

	
							<WTROW height="18">
								<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(MACHINE-STATUS-SETUP)"/>
								<WTSTATIC col="1">
									<WTCODEGROUP><WTIMAGE value="CONST(MachineStatus&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC fontcolor="green">
										<WTSTATIC value="DATA(Machine.NameFirst)" space="1"/>
										<WTSTATIC value="DATA(Machine.NameLast)" space="1"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(edit.gif)" alt="EditComputer" valign="top" imgalign="absmiddle">
											<WTLINK name="10703">
												<WTPARAM name="MachineID" value="DATA(Machine.MachineID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(Machine.Email)" fontcolor="green"/>
<!--
								<WTSTATIC col="3">
									<WTSTATIC value="DATA(Machine.Password)" fontcolor="green">
										<WTCONDITION expr="PARAM(ShowPassword)" oper="not-equal" value="CONST(0)"/>
									</WTSTATIC>
								</WTSTATIC>
-->								
								<WTSTATIC col="3" value="DATA(Machine.WebName)" fontcolor="green">
									<WTLINK name="GetWebName('&lt;xsl:value-of select=&quot;@webname&quot;/&gt;')" click="true" />
								</WTSTATIC>
								<WTSTATIC col="4" fontcolor="green">
									<WTSTATIC value="DATA(Machine.Qty)" space="1" fontcolor="purple"/>
									<WTSTATIC value="DATA(Machine.Service)" space="1"/>
									<WTSTATIC value="DATA(Machine.BackupUsed)"/>
								</WTSTATIC>
								<WTSTATIC col="5"/>
							</WTROW>

							<WTROW height="18">
								<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
								<WTSTATIC col="1">
									<WTCODEGROUP><WTIMAGE value="CONST(MachineStatus&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Machine.NameFirst)" space="1"/>
									<WTSTATIC value="DATA(Machine.NameLast)" space="1"/>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(edit.gif)" alt="EditComputer" valign="top" imgalign="absmiddle">
											<WTLINK name="10703">
												<WTPARAM name="MachineID" value="DATA(Machine.MachineID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(Machine.Email)"/>
<!--								
								<WTSTATIC col="3">
									<WTSTATIC value="DATA(Machine.Password)">
										<WTCONDITION expr="PARAM(ShowPassword)" oper="not-equal" value="CONST(0)"/>
									</WTSTATIC>
								</WTSTATIC>
-->								
								<WTSTATIC col="3" value="DATA(Machine.WebName)">
									<WTLINK name="GetWebName('&lt;xsl:value-of select=&quot;@webname&quot;/&gt;')" click="true" />
								</WTSTATIC>
								<WTSTATIC col="4">
									<WTSTATIC value="DATA(Machine.Qty)" space="1" fontcolor="purple"/>
									<WTSTATIC value="DATA(Machine.Service)" space="1"/>
									<WTSTATIC value="DATA(Machine.BackupUsed)"/>
								</WTSTATIC>
								<WTSTATIC col="5">
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(Customer)" oper="equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(NewCustomer16.gif)" alt="ConvertCustomer" valign="top" imgalign="absmiddle">
											<WTLINK name="https://www.cloudzow.com/10712">
												<WTPARAM name="MachineID" value="DATA(MachineID)"/>
												<WTPARAM name="E" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							
							<WTROW height="18">
								<WTCONDITION expr="DATA(Status)" oper="greater" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
								<WTSTATIC col="1">
									<WTCODEGROUP><WTIMAGE value="CONST(MachineStatus&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC fontcolor="red">
										<WTSTATIC value="DATA(Machine.NameFirst)" space="1"/>
										<WTSTATIC value="DATA(Machine.NameLast)" space="1"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(edit.gif)" alt="EditComputer" valign="top" imgalign="absmiddle">
											<WTLINK name="10703">
												<WTPARAM name="MachineID" value="DATA(Machine.MachineID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(Machine.Email)" fontcolor="red"/>
<!--
								<WTSTATIC col="3">
									<WTSTATIC value="DATA(Machine.Password)" fontcolor="red">
										<WTCONDITION expr="PARAM(ShowPassword)" oper="not-equal" value="CONST(0)"/>
									</WTSTATIC>
								</WTSTATIC>
-->								
								<WTSTATIC col="3" value="DATA(Machine.WebName)" fontcolor="red">
									<WTLINK name="GetWebName('&lt;xsl:value-of select=&quot;@webname&quot;/&gt;')" click="true" />
								</WTSTATIC>	
								<WTSTATIC col="4" fontcolor="red">
									<WTSTATIC value="DATA(Machine.Qty)" space="1" fontcolor="purple"/>
									<WTSTATIC value="DATA(Machine.Service)" space="1"/>
									<WTSTATIC value="DATA(Machine.BackupUsed)"/>
								</WTSTATIC>
								<WTSTATIC col="5"/>
							</WTROW>
							
							<WTROW height="18">
								<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(0)"/>
								<WTSTATIC col="1">
									<WTCODEGROUP><WTIMAGE value="CONST(MachineStatus0.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC label="UnusedComputer"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)" space="1"/>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(addnew.gif)" alt="ConfigureNewComputer" valign="top" imgalign="absmiddle">
											<WTLINK name="10702">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="3" merge="3"/>
							</WTROW>
							
							<WTROW height="18">
								<WTCONDITION expr="DATA(Machine.Status)" oper="greater" value="SYSCON(MACHINE-STATUS-SETUP)"/>
								<WTSTATIC col="1" merge="5" fontcolor="gray">
									<WTSTATIC space="5"/>
									<WTSTATIC tag="ActiveDate" value="DATA(Machine.ActiveDate)" space="3">
										<WTCONDITION expr="DATA(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
									</WTSTATIC>
									<WTSTATIC tag="CancelDate" value="DATA(Machine.CancelDate)" space="3">
										<WTCONDITION expr="DATA(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-CANCELLED)"/>
									</WTSTATIC>
									<WTSTATIC tag="RemoveDate" value="DATA(Machine.RemoveDate)">
										<WTCONDITION expr="DATA(Machine.Status)" oper="equal" value="SYSCON(MACHINE-STATUS-REMOVED)"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>

					<WTROW>
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="170" align="left"/>
							<WTCOLUMN width="487" align="right"/>
							<WTCOLUMN width="75" align="right"/>
							<WTCOLUMN width="18" align="right"/>
							<WTROW margin-top="6">
								<WTSTATIC col="1" tag="ActiveMachines" value="PARAM(Count)" bold="true"/>
								<WTSTATIC col="2">
									<WTSTATIC tag="Total" bold="true">
										<WTCONDITION expr="PARAM(Customer)" oper="not-equal" value="CONST(0)"/>
										<WTCONDITION expr="PARAM(PrepaidMachines)" oper="less-equal" value="PARAM(Count)" connector="or"/>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTSTATIC value="PARAM(Total)" bold="true">
										<WTCONDITION expr="PARAM(Customer)" oper="not-equal" value="CONST(0)"/>
										<WTCONDITION expr="PARAM(PrepaidMachines)" oper="less-equal" value="PARAM(Count)" connector="or"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="6">
								<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)"/>
								<WTCONDITION expr="ATTR(Member.Price)" oper="not-equal" value="PARAM(Total)" connector="and"/>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" tag="CustomerTotal" bold="true"/>
								<WTSTATIC col="3" value="ATTR(Member.Price)" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTCONDITION expr="PARAM(PrepaidMachines)" oper="greater" value="PARAM(Count)"/>
								<WTSTATIC col="1" tag="PrePaidMachines" value="PARAM(PrepaidMachines)" bold="true"/>
								<WTSTATIC col="2" tag="GrandTotal" bold="true"/>
								<WTSTATIC col="3" value="PARAM(GrandTotal)" bold="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>
					
				</WTCODEGROUP>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(IsEdit)" oper="not-equal" value="CONST(0)"/>
					<WTBUTTON col="1" merge="2" action="6" value="CONST(NewMachine)" align="center"/>
					<WTBUTTON col="1" merge="2" action="10" value="CONST(ChangeMachine)" align="center">
						<WTCONDITION expr="PARAM(Customer)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Count)" oper="less" value="CONST(8)" connector="and"/>
					</WTBUTTON>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(IsMoney)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(IsUniversity)" oper="not-equal" value="CONST(0)" connector="or"/>

					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="175" align="center"/>
						<WTCOLUMN width="175" align="center"/>
						<WTCOLUMN width="200" align="center"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTIMAGE col="2" value="CONST(ZowMoney.gif)" imgalign="absmiddle" align="center">
									<WTCONDITION expr="PARAM(IsMoney)" oper="not-equal" value="CONST(0)"/>
								<WTLINK name="Money" target="Money">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(ZowUniversity.gif)" imgalign="absmiddle" align="center">
								<WTCONDITION expr="PARAM(IsUniversity)" oper="not-equal" value="CONST(0)"/>
								<WTLINK name="University" target="University">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC col="4"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="ZowMoney" align="center"/>
							<WTSTATIC col="3" label="ZowUniversity" align="center"/>
							<WTSTATIC col="4"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="24" margin-bottom="12">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true" align="center" />
				</WTROW>

				<WTROW margin-bottom="6">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="10721" caption="Find" action="5" navbar="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
			</WTCODEGROUP>
			
			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="CONST(0419)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XMLFind">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
				<WTMETHOD name="FindOwner">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="center"/>

				<WTROW>
					<WTSTATIC col="1" label="Members" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader"/>
					<WTCOMBO col="1" value="ATTR(Members.FindTypeID)" translate="true">
						<WTOPTION id="419" label="MemberName"/>
						<WTOPTION id="430" label="Email"/>
						<WTOPTION id="401" label="MemberID"/>
					</WTCOMBO>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>
				
				<WTSTATIC label="computers"/>
				<WTSTATIC label="notes"/>

				<WTROW>
					<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Member">
						<WTCOLUMN width="10" align="left" valign="top" label="#"/>
						<WTCOLUMN width="25" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="30" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Status"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Computers"/>
						<WTCOLUMN width="15" align="right" valign="top"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Member.MemberID)"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Level)" oper="equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(Customer16.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Level)" oper="equal" value="CONST(1)"/>
									<WTIMAGE value="CONST(Member16.gif)"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Member.MemberName)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.Email)"/>
							<WTIMAGE col="4" value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
							<WTSTATIC col="5">
								<WTSTATIC value="DATA(Member.Process)" space="2"/>
								<WTSTATIC value="DATA(Member.Price)"/>
							</WTSTATIC>
							<WTSTATIC col="6">
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(machine16.gif)" alt="computers" imgalign="absmiddle">
										<WTLINK name="10711" return="false" target="_blank">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(notessm.gif)" alt="notes" imgalign="absmiddle">
										<WTLINK name="9005" return="false" target="_blank">
											<WTPARAM name="OwnerType" value="ENTITY(Member)"/>
											<WTPARAM name="OwnerID" value="DATA(MemberID)"/>
											<WTPARAM name="Title" value="DATA(MemberName)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="5" fontcolor="gray">
								<WTSTATIC tag="EnrollDate"/>
								<WTSTATIC value="DATA(Member.EnrollDate)"/>
								<WTSTATIC space="2"/>
								<WTSTATIC tag="VisitDate"/>
								<WTSTATIC value="DATA(Member.VisitDate)"/>
								<WTSTATIC space="2"/>
								<WTSTATIC tag="PaidDate"/>
								<WTSTATIC value="DATA(Member.PaidDate)"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Affiliate Enrollment Page for Machine! -->
		<!--============================================================================================-->
		<WTWEBPAGE name="join" caption="New Affiliate" navbar="false" header="false" footer="false" stylesheet="StyleSheetJoin.css" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="join">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="NewMemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>

			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="S" datatype="number"/>
			
			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>
			<WTPARAM name="CountryID" datatype="text"/>
			<WTPARAM name="CountryName" datatype="text"/>
			<WTPARAM name="CountryNameb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="BadPayment" datatype="number"/>
<!-- Mode 0 ... Agreement -->
<!-- Mode 1 ... Contact Info -->
<!-- Mode 2 ... Membership Selection -->
<!-- Mode 3 ... Payment -->
<!-- Mode 4 ... Confirmation -->
<!-- Mode 5 ... Welcome -->
			
			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="LD_API.asp"/>
			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="BillingProcess.asp"/>
			<WTINCLUDE name="Products.asp"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="AuthorizeToken.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(5)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="PARAM(M)" value="CONST(0)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(S)" value="PARAM(M)">
					<WTCONDITION expr="PARAM(S)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)">
					<WTCONDITION expr="PARAM(CountryIDb)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="SYS(ActionCode)" oper="greater-equal" value="CONST(1)"/>
				<WTCONDITION expr="SYS(ActionCode)" oper="less-equal" value="CONST(4)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree)" value="FORM(IsAgree)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree2)" value="FORM(IsAgree2)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadMember"/>
			</WTCODEGROUP>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadAgree">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll1.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(TRIM(.NameFirst + &quot; &quot; + .NameLast))"/>
<WTCUSTOM>
If .Status &lt;&gt; "1" Then
	Response.Write "The Affiliate that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
	Response.End
End If
</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon/Website Name is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
<!--					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10006" message="Oops, Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
<!--
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
-->				
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
<!--						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<!--					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>-->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
<!--						<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>

					<WTCALLSUB name="ClearProducts oMember"/>
					
					<!-- FAST TRACK PACK -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
						<WTCALLSUB name="SetFastTrack oMember"/>
						<WTCALLSUB name="SetProduct oMember, cZowBackups, 8"/>
						<WTCALLSUB name="SetProduct oMember, cZowMoney, 1"/>
						<WTCALLSUB name="SetProduct oMember, cZowUniversity, 1"/>
						<WTCALLSUB name="GetPrice oMember"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(299)"/>
					</WTCODEGROUP>
					<!-- ZOW PACK -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
						<WTCALLSUB name="SetProduct oMember, cZowBackups, 2"/>
						<WTCALLSUB name="SetProduct oMember, cZowMoney, 1"/>
						<WTCALLSUB name="SetProduct oMember, cZowUniversity, 1"/>
						<WTCALLSUB name="GetPrice oMember"/>
					</WTCODEGROUP>
					<!-- FRIENDS AND FAMILY PACK -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
						<WTCALLSUB name="SetProduct oMember, cZowBackups, 8"/>
						<WTCALLSUB name="GetPrice oMember"/>
					</WTCODEGROUP>
					<!-- RESELLER WITH 1 COMPUTER -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
						<WTCALLSUB name="SetProduct oMember, cZowBackups, 1"/>
						<WTCALLSUB name="GetPrice oMember"/>
					</WTCODEGROUP>
					<!-- FREE RESELLER -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="ATTR(Title2)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="ATTR(BV)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="ATTR(BV2)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(Price)">
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
						<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
						<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(1)">
							<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)">
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
						<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
						<WTSETATTRIBUTE name="ATTR(Icons)" value="CONST(tmpIcons)"/>
						<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
							<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
						<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEF&quot;)"/>

						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(S)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(reqSysDate)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>

						<WTMETHOD name="Add">
							<WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>LogMemberNote reqNewMemberID, "PAYPAL ENROLLMENT"</WTCUSTOM>
					</WTCODEGROUP>

					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<!-- Create/Update the billing tokens -->
						<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
						<WTCALLSUB name="GetToken reqNewMemberID, reqBillingID, tmpName, .Email, reqProcessor, reqMemberToken, reqToken, reqPayDesc "/>
						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(CSTR(reqProcessor) + &quot;-&quot; + CSTR(reqMemberToken))"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
						<!-- Process the first payment -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
							<WTCALLSUB name="GetPayment reqNewMemberID, BillingPrice, reqPayType, reqPayDesc, reqProcessor, reqMemberToken, reqToken"/>
							<WTCODEGROUP>
	 							<WTCONDITION expr="NoErrors"/>
								<!-- Update Billing Date -->
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
								<WTMETHOD name="Save">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?Leaders=1&amp;MemberID=" &amp; reqNewMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(NewMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
<!--					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- New Member Activation Processing -->
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Membership)" oper="less" value="CONST(5)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(NewMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MACHINE-STATUS-SETUP)"/>
					<WTSETATTRIBUTE name="ATTR(Service)" value="SYSCON(MACHINE-SERVICE-BACKUP)"/>
					<WTSETATTRIBUTE name="ATTR(Qty)" value="CONST(2)"/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)"/>
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
					<WTSETATTRIBUTE name="ATTR(Password)" value="FORM(NewPassword)"/>
					<WTSETATTRIBUTE name="ATTR(WebName)" value="CONST(&quot;temp&quot;)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="MachineID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCALLSUB name="SetComputerWebName oMachine"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>

					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MACHINE-STATUS-ACTIVE)"/>
<WTCUSTOM>
				Result = UpdateComputerStatus( oMachine, tmpStatus )
				If Result &lt;&gt; "OK" Then
	DoError -1, "", Result
	LogMemberNote reqNewMemberID, "ENROLL COMPUTER ERROR: " + Result
	SendEmail reqSysCompanyID, "support@CloudZow.com", "support@CloudZow.com", "support@CloudZow.com", "", "", "ENROLL COMPUTER ERROR: " + .Email, .NameFirst + " " + .NameLast + " - " + .LiveDriveID + " - " + Result
	Else
	'Email Support for new computer limits
	SendEmail reqSysCompanyID, "support@CloudZow.com", "support@CloudZow.com", "limit@CloudZow.com", "", "", "NEW COMPUTER: " + .Email, .NameFirst + " " + .NameLast + " - " + .LiveDriveID + " (" + .Qty + ")"
	End If
</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="CONST(Len(.CountryID))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTACTION id="0" name="Agree" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="1" name="Contact" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>
			
			<WTACTION id="2" name="Membership" type="New">
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
<!--
				<WTSETATTRIBUTE name="CONST(tmpTaxIDType)" value="FORM(TaxIDType1)">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="equal" value="CONST(224)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpTaxIDType)" value="FORM(TaxIDType2)">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
				</WTSETATTRIBUTE>
-->				
				<WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10125" message="Oops, Please enter a First Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10126" message="Oops, Please enter a Last Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
					<WTCUSTOM>
						If ValidEmail( tmpEmail ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
					</WTCUSTOM>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(LEN(tmpPassword))" oper="less" value="CONST(6)"/>
						<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(2)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>
			
			<WTACTION id="3" name="Payment" type="New">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTCONDITION expr="PARAM(Membership)" oper="less" value="CONST(5)"/>
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="FetchEmail">
							<WTPARAM name="Email" direction="input" value="ATTR(Email)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CLng(.MachineID))" oper="not-equal" value="CONST(0)"/>
							<WTERROR number="10123" message="Oops, This email address is already assigned to another computer."/>
							<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(3)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>
			
			<WTACTION id="4" name="Confirm" type="New">
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="CONST(lcase(tmpCardNumber))" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="CONST(&quot;&quot;)">
					<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(5)"/>
					<WTCONDITION expr="CONST(tmpCardNumber)" oper="equal" value="CONST(&quot;paypal&quot;)" connector="and"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Membership)" oper="less" value="CONST(5)" connector="and"/>
					<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
					<WTERROR number="10128" message="Oops, You must agree to be billed monthly."/>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpCardNumber)" oper="not-equal" value="CONST(&quot;paypal&quot;)" connector="and"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(4)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>
			
			<WTACTION id="5" name="Process" type="Add">
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(5)"/>
					<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;AffiliateWelcome.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
						<WTMETHOD name="Load" />
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>
			</WTACTION>
			
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
				<WTCALLSUB name="LoadAgree"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)" connector="or"/>
				<WTCALLSUB name="LoadCountrys"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(4)"/>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;GlobalCashCard.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="PARAM(CountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryName)" value="ATTR(CountryName)" />
					<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="PARAM(CountryIDb)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CountryID" direction="input" value="PARAM(CountryIDb)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="540" align="left"/>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
				
					if( payobj != null ) {
						//var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype = payobj.value;
					
						//var l = payobj.length;
						//for( i = 0; i &lt; l; i++ ) {
						//	if (payobj[i].checked) {
						//		paytype = payobj[i].value;
						//		i = l;
						//	}
						//}
						//if (paytype == 5) {
						//	if ( countryid != 224 ) {
						//		paytype = 1;
						//		document.getElementById('PayType').value = paytype;
						//		alert("Electronic Checks not available outside the United States");
						//	}
						//}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>
<!--				
				<WTFUNCTION name="ShowTaxIDType()">
					var countryid = document.getElementById('CountryID').value;
					if( countryid == 224 ) {
						document.getElementById('TaxIDType1').style.display = '';
						document.getElementById('TaxIDType2').style.display = 'none';
					}	
					else {
						document.getElementById('TaxIDType1').style.display = 'none';
						document.getElementById('TaxIDType2').style.display = '';
					}	
				</WTFUNCTION>
-->
				<WTFUNCTION name="CheckType(val)">	
						ToggleType();
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">	
					var val = obj.value;
					if ( val.length == 2 ) {
						obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {					
						obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatPhone(obj)">	
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					if( newval.length == 10 ) {
						obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
					}	
					if( newval.length == 11 ) {
						obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
					}	
					if( newval.length == 12 ) {
						obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
					}	
				</WTFUNCTION>
<!--				
				<WTFUNCTION name="FormatTaxID(obj)">
					var countryid = document.getElementById('CountryID').value;
					var taxidtype = document.getElementById('TaxIDType1').value;
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					if( countryid == 224 ) {
						if( taxidtype == 1 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Social Security Number'); }
							else {
								obj.value = newval.substring(0,3) + '-' + newval.substring(3,5) + '-' + newval.substring(5,9);
							}
						}
						if( taxidtype == 2 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Employer Identification Number'); }
							else {
								obj.value = newval.substring(0,2) + '-' + newval.substring(2,9);
							}
						}
					}
				</WTFUNCTION>
-->				
				<WTFUNCTION name="FormatCardCode(obj)">	
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
						alert('Oops, Invalid Security Code'); 
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatLogon(obj)">	
					var val = obj.value;
					var newval = val.replace(/[^0-9a-zA-Z]/g, ''); 
					obj.value = newval;
					if( newval.length &lt; 6 ) {
						alert('Oops, Logon must be at least 6 characters or numbers.'); 
					}
				</WTFUNCTION>
				<WTFUNCTION name="ShowCC()">
					var disp, membership = document.getElementById('Membership').value;
					if( membership &lt; 5 ) { disp = 'none' } else { disp = '' }
					document.getElementById('CCRequired').style.display = disp;
					if( membership &lt; 5 ) { disp = '' } else { disp = 'none' }
					document.getElementById('Agree2').style.display = disp;
					//document.getElementById('Payment').style.display = disp;
					//document.getElementById('CardRows').style.display = disp;
					//document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>
				<WTFUNCTION name="ViewVideo()">
					var url, win;
					url = "Simplified.html"
					win = window.open(url,"Simplified","top=10,left=10,height=750,width=850,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				
				<WTFUNCTION name="Init()">
					var mode = document.getElementById('Mode').value;
					if( mode == 1 ) {
						//ShowTaxIDType();
					}
					if( mode == 2 ) {
						// do nothing
					}
					if( mode == 3 ) {
						ToggleType();
						ShowCC(); 
					}
				</WTFUNCTION>
				
				<WTLOAD>Init();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(Mode)"/>
					<WTHIDDEN value="PARAM(NewMemberID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(Processor)"/>
					<WTHIDDEN value="PARAM(MemberToken)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(BadPayment)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="3" label="BadPaymentText" class="PageHeading" fontcolor="red" align="left"/>
				</WTROW>

				<!-- === Agreement ====================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="3" align="center" bold="true">
							<WTSTATIC tag="ReferredBy"/>
							<WTSTATIC value="PARAM(ReferredBy)"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
							<WTCODEGROUP><WTCHECK value="PARAM(IsAgree)"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="1" value="CONST(Continue)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Contact Information ============================================ -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
				 		<WTIMAGE col="1" merge="3" value="CONST(JoinMode1.png)" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, First Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="340" label="NameLast" size="25" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Last Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CompanyName"/>
						<WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Email"/>
						<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Email Required!')};</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60">
							<WTEXIT>if(this.value==''){alert('Oops, Mailing Address Required!')}; document.getElementById('Street1b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60">
							<WTEXIT>document.getElementById('Street2b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.City)" width="200" label="City" size="27">
							<WTEXIT>if(this.value==''){alert('Oops, City Required!');}else{TitleCase(this);}; document.getElementById('Cityb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" width="340" label="State" size="27">
							<WTEXIT>if(this.value==''){alert('Oops, State Required!');}else{TitleCase(this);}; document.getElementById('Stateb').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" width="100" label="Zip" size="8">
							<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')}; document.getElementById('Zipb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" width="440" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
							<WTEXIT>document.getElementById('CountryIDb').value = this.value;</WTEXIT>
						</WTCOMBO>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="20">
							<WTEXIT>FormatPhone(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-top="3">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="DOB"/>
						<WTTEXT col="3" value="ATTR(Member.AutoShipDate)" size="8" type="date"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewLogon"/>
						<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20" class="prompt">
							<WTEXIT>FormatLogon(this);</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="3" label="LogonTip"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewPassword"/>
						<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20" secure="false" class="prompt">
							<WTEXIT>if(this.value==''){alert('Oops, Password Required!');}</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="3" label="PasswordText"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="2" value="CONST(Continue)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Membership ===================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.AutoShipDate)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
				 		<WTIMAGE col="1" merge="3" value="CONST(JoinMode2.png)" align="center"/>
					</WTROW>
					<WTROW>
				 		<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
				 			<WTCODEGROUP>
								<WTIMAGE value="CONST(ViewVideo.gif)" imgalign="absmiddle">
									<WTLINK name="ViewVideo()" click="true" />
								</WTIMAGE>
				 			</WTCODEGROUP>
							<WTSTATIC space="3"/>
							<WTSTATIC label="ViewVideo" fontsize="4"/>
				 		</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="50" align="center"/>
							<WTCOLUMN width="100" align="left"/>
							<WTCOLUMN width="550" align="left"/>
							<WTCOLUMN width="50" align="center"/>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" class="PageHeading" fontsize="6" valign="top" align="center">
									<WTCODEGROUP><WTIMAGE value="CONST(Affiliate.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC label="QualifiedAffiliate"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" bold="true" align="left" valign="top">
									<WTSTATIC label="QualifiedAffiliateText"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
		 						<WTRADIO col="3" group="Membership" name="1" align="left" datapathx="/DATA/PARAM/@membership=1"/>
								<WTSTATIC col="3" label="FastTrack" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="FastTrack1"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="FastTrack2"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="FastTrack3"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="FastTrack4"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="FastTrack5"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/>
									<WTSTATIC space="3"/>
									<WTSTATIC label="FastTrack6"/>
								</WTSTATIC>
							</WTROW>

							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
		 						<WTRADIO col="3" group="Membership" name="2" align="left" datapathx="/DATA/PARAM/@membership=2"/>
								<WTSTATIC col="3" label="ZowPack" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="ZowPack1"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="ZowPack2"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="ZowPack3"/>
								</WTSTATIC>
							</WTROW>
<!--
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
		 						<WTRADIO col="3" group="Membership" name="3" align="left" datapathx="/DATA/PARAM/@membership=3"/>
								<WTSTATIC col="3" label="FAFPack" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" fontsize="2">
									<WTSTATIC space="5"/><WTSTATIC space="3"/>
									<WTSTATIC label="FAFPack1"/>
								</WTSTATIC>
							</WTROW>
-->
							<WTROW margin-top="12">
								<WTSTATIC col="1" merge="2"/>
								<WTBUTTON col="3" merge="2" action="3" value="CONST(Continue)" align="left"/>
								<WTBUTTON col="3" merge="2" value="CONST(Back)" action="1" align="left"/>
							</WTROW>
							<WTROW id="Reseller">
								<WTTABLE col="1" merge="4">
									<WTCOLUMN width="50" align="center"/>
									<WTCOLUMN width="100" align="left"/>
									<WTCOLUMN width="550" align="left"/>
									<WTCOLUMN width="50" align="center"/>
									<WTROW margin-top="24">
										<WTSTATIC col="1" merge="2"/>
										<WTSTATIC col="3" label="ResellerText" fontsize="1"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" merge="2"/>
		 								<WTRADIO col="3" group="Membership" name="4" datapathx="/DATA/PARAM/@membership=4"/>
										<WTSTATIC col="3" label="Reseller1" fontsize="1"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" merge="2"/>
		 								<WTRADIO col="3" group="Membership" name="5" datapathx="/DATA/PARAM/@membership=5"/>
										<WTSTATIC col="3" label="Reseller0" fontsize="1"/>
									</WTROW>
								</WTTABLE>
							</WTROW>
						</WTTABLE>
					</WTROW>
<!--
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="3" value="CONST(Continue)" align="center"/>
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="1" align="center"/>
					</WTROW>
-->					
				</WTCODEGROUP>

				<!-- === Payment ========================================================= -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.AutoShipDate)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTROW margin-top="6" margin-bottom="6">
				 		<WTIMAGE col="1" merge="3" value="CONST(JoinMode3.png)" align="center"/>
					</WTROW>
					<WTROW id="CCRequired" style="display:none" margin-bottom="6">
						<WTSTATIC col="1" merge="3" bold="true" align="center" fontcolor="red">
							<WTSTATIC label="CCRequired"/>
						</WTSTATIC>
					</WTROW>
					<WTROW id="Payment">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="750" align="center"/>

							<WTROW id="Pay2" margin-bottom="12">
								<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
							</WTROW>
							<WTROW>
								<WTHIDDEN value="PARAM(PayType)"/>
							</WTROW>
							<WTROW id="Pay3" margin-bottom="6">
				 				<WTSTATIC col="1" align="center">
				 					<WTCODEGROUP>
										<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
											<WTCLICK>CheckType(1);</WTCLICK>
										</WTIMAGE>
				 					</WTCODEGROUP>
				 					<WTCODEGROUP>
										<WTSTATIC space="3"/>
										<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
											<WTCLICK>CheckType(2);</WTCLICK>
										</WTIMAGE>
				 					</WTCODEGROUP>
				 					<WTCODEGROUP>
										<WTSTATIC space="3"/>
										<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
											<WTCLICK>CheckType(3);</WTCLICK>
										</WTIMAGE>
				 					</WTCODEGROUP>
				 					<WTCODEGROUP>
										<WTSTATIC space="3"/>
										<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
											<WTCLICK>CheckType(4);</WTCLICK>
										</WTIMAGE>
				 					</WTCODEGROUP>
				 				</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW id="CardRows">
						<WTSTATIC col="1"/>
						<WTTABLE col="2" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW>
								<WTSTATIC col="1" tag="CardNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
									<WTEXIT>var x = this.value; if(x.tolowercase() != 'paypal'){this.value = x.replace(/[^\d]/g, '')};</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardDate"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
									<WTOPTION id="" label="Select"/>
									<WTOPTION id="1" label="January"/>
									<WTOPTION id="2" label="February"/>
									<WTOPTION id="3" label="March"/>
									<WTOPTION id="4" label="April"/>
									<WTOPTION id="5" label="May"/>
									<WTOPTION id="6" label="June"/>
									<WTOPTION id="7" label="July"/>
									<WTOPTION id="8" label="August"/>
									<WTOPTION id="9" label="September"/>
									<WTOPTION id="10" label="October"/>
									<WTOPTION id="11" label="November"/>
									<WTOPTION id="12" label="December"/>
								</WTCOMBO>
								<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
									<WTOPTION id="" label="Select"/>
									<WTOPTION id="12" label="2012"/>
									<WTOPTION id="13" label="2013"/>
									<WTOPTION id="14" label="2014"/>
									<WTOPTION id="15" label="2015"/>
									<WTOPTION id="16" label="2016"/>
									<WTOPTION id="17" label="2017"/>
									<WTOPTION id="18" label="2018"/>
									<WTOPTION id="19" label="2019"/>
									<WTOPTION id="20" label="2020"/>
									<WTOPTION id="21" label="2021"/>
									<WTOPTION id="22" label="2022"/>
									<WTOPTION id="23" label="2023"/>
									<WTOPTION id="24" label="2024"/>
									<WTOPTION id="25" label="2025"/>
								</WTCOMBO>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardName"/>
								<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardCode"/>
								<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
									<WTEXIT>FormatCardCode(this);</WTEXIT>
								</WTTEXT>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTTOOLTIP>
											<WTIMAGE value="CONST(SymbolHelp.gif)"/>
											<WTTIP>
												<WTIMAGE value="CONST(SecurityCode.png)"/>
											</WTTIP>
										</WTTOOLTIP>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<WTROW>
								<WTSTATIC col="1" tag="BillingAddress" />
								<WTTEXT col="2" value="PARAM(Street1b)" size="60">
									<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
									<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
								</WTTEXT>
								<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
									<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left" required="true">
									<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
								</WTTEXT>
								<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTROW id="Secure" margin-top="12">
						<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW id="Agree2">
						<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
							<WTCODEGROUP><WTCHECK value="PARAM(IsAgree2)"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="4" value="CONST(Continue)" align="center"/>
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="2" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Confirm ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(4)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.AutoShipDate)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
				 		<WTIMAGE col="1" merge="3" value="CONST(JoinMode4.png)" align="center"/>
					</WTROW>
					<WTROW>
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="100" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.NameLast)" newline="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.CompanyName)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Email)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Phone1)" newline="1"/>
									<WTSTATIC value="ATTR(Member.AutoShipDate)" newline="1"/>
									<WTSTATIC value="ATTR(Address.Street1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.City)" space="1"/>
									<WTSTATIC value="ATTR(Address.State)" space="1"/>
									<WTSTATIC value="ATTR(Address.Zip)" newline="1"/>
									<WTSTATIC value="PARAM(CountryName)" newline="1"/>
									<WTSTATIC tag="Logon" value="ATTR(Member.NewLogon)" space="2"/>
									<WTSTATIC value="ATTR(Member.NewPassword)"/>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTSTATIC label="BillingInfo" newline="1" bold="true"/>
									<WTSTATIC value="ATTR(Billing.CardNumber)" newline="1"/>
									<WTSTATIC tag="Expires" value="ATTR(Billing.CardMo)" space="1"/>
									<WTSTATIC value="ATTR(Billing.CardYr)" newline="1"/>
									<WTSTATIC value="ATTR(Billing.CardName)" newline="1"/>
									<WTSTATIC tag="Code" value="ATTR(Billing.CardCode)" newline="1"/>
									<WTSTATIC value="PARAM(Street1b)" newline="1"/>
									<WTSTATIC value="PARAM(Cityb)" space="1"/>
									<WTSTATIC value="PARAM(Stateb)" space="1"/>
									<WTSTATIC value="PARAM(Zipb)" newline="1"/>
									<WTSTATIC value="PARAM(CountryNameb)" newline="2"/>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
							<WTSTATIC label="SelectedFastTrack">
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="SelectedAffiliate">
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)" connector="or"/>
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)" connector="or"/>
								<WTSTATIC label="SelectedReseller" newline="1"/>
								<WTSTATIC label="SelectedReseller2" fontcolor="red"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(5)"/>
						<WTSTATIC col="1" merge="3" align="center" class="PageHeading" fontcolor="red">
							<WTSTATIC label="FastTrackPrice">
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="ZowPackPrice">
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
							<WTSTATIC label="FAFPackPrice">
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
							<WTSTATIC label="Reseller1Price">
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
						<WTSTATIC col="1" merge="3" label="NoCharge" align="center" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(Membership)" oper="less-equal" value="CONST(3)"/>
						<WTSTATIC col="1" merge="3" label="ReducePrice" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="18" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Confirm)" align="center">
							<WTCLICK>doSubmit(5,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="3" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Welcome ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(5)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Proof of Joining! -->
		<!--============================================================================================-->
		<WTWEBPAGE name="joinr" caption="Join Confirmation" navbar="false" header="false" footer="false" stylesheet="StyleSheetJoin.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="joinr">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(IsAgree)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree2)" value="CONST(1)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpBillingID)" value="ATTR(BillingID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="FetchOwner">
						<WTPARAM name="OwnerType" direction="input" value="CONST(4)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(tmpBillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="540" align="left"/>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-top="6" margin-bottom="6">
					<WTIMAGE col="1" merge="3" value="CONST(JoinMode4.png)" align="center"/>
				</WTROW>
				<WTROW>
					<WTTABLE col="1" merge="3">
						<WTCOLUMN width="100" align="left"/>
						<WTCOLUMN width="325" align="left"/>
						<WTCOLUMN width="325" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2">
								<WTSTATIC tag="EnrollDate" space="1" bold="true"/>
								<WTSTATIC value="ATTR(Member.EnrollDate)" newline="1" bold="true"/>
								<WTSTATIC value="ATTR(Member.NameFirst)" space="1" bold="true"/>
								<WTSTATIC value="ATTR(Member.NameLast)" newline="1" bold="true"/>
								<WTSTATIC value="ATTR(Member.CompanyName)" newline="1"/>
								<WTSTATIC value="ATTR(Member.Email)" newline="1"/>
								<WTSTATIC value="ATTR(Member.Phone1)" newline="1"/>
								<WTSTATIC value="ATTR(Member.AutoShipDate)" newline="1"/>
								<WTSTATIC value="ATTR(Address.Street1)" newline="1"/>
								<WTSTATIC value="ATTR(Address.City)" space="1"/>
								<WTSTATIC value="ATTR(Address.State)" space="1"/>
								<WTSTATIC value="ATTR(Address.Zip)" newline="1"/>
								<WTSTATIC value="ATTR(Address.CountryName)" newline="1"/>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTSTATIC label="BillingInfo" newline="1" bold="true"/>
								<WTSTATIC value="ATTR(Billing.CardNumber)" newline="1"/>
								<WTSTATIC tag="Expires" value="ATTR(Billing.CardMo)" space="1"/>
								<WTSTATIC value="ATTR(Billing.CardYr)" newline="1"/>
								<WTSTATIC value="ATTR(Billing.CardName)" newline="1"/>
								<WTSTATIC tag="Code" value="ATTR(Billing.CardCode)" newline="1"/>
								<WTSTATIC value="ATTR(Billing.Street1)" newline="1"/>
								<WTSTATIC value="ATTR(Billing.City)" space="1"/>
								<WTSTATIC value="ATTR(Billing.State)" space="1"/>
								<WTSTATIC value="ATTR(Billing.Zip)" newline="1"/>
								<WTSTATIC value="ATTR(Billing.CountryName)" newline="2"/>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC label="SelectedAffiliate" space="1">
							<WTCONDITION expr="ATTR(Member.Title)" oper="greater" value="CONST(1)"/>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
							<WTSTATIC label="SelectedReseller" space="1"/>
						</WTCODEGROUP>
						<WTSTATIC value="ATTR(Member.Price)" space="1"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
						<WTCODEGROUP>
							<WTCHECK value="PARAM(IsAgree)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
						<WTCODEGROUP>
							<WTCHECK value="PARAM(IsAgree2)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="18" margin-bottom="12">
					<WTBUTTON col="1" merge="3" value="CONST(Confirm)" align="center">
						<WTCLICK>doSubmit(5,&quot;&quot;); this.disabled = true</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="3" value="CONST(Back)" action="3" align="center"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Convert Machine to Customer -->
		<!--============================================================================================-->
		<WTWEBPAGE name="10712" caption="Convert Computer" navbar="false" header="false" footer="false" focus="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="10712">
		<!--============================================================================================-->
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="E" datatype="number"/>
			<WTPARAM name="Email" datatype="text"/>
			<WTPARAM name="BillingName" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="BadPayment" datatype="number"/>

			<WTINCLUDE name="LD_API.asp"/>
			<WTINCLUDE name="BillingProcess.asp"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="AuthorizeToken.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(5)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadMachine">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="PARAM(Email)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="PARAM(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpNameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpNameLast)"/>
					<WTSETATTRIBUTE name="ATTR(Email)" value="CONST(tmpEmail)"/>
					<WTSETATTRIBUTE name="ATTR(Process)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(5)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadMachine"/>
				<WTCALLSUB name="LoadCountrys"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
<!--						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<!--					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>-->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="FORM(BillingName)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
<!--						<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->
						<WTCODEGROUP>
		 					<WTCONDITION expr="NoErrors"/>
							<WTMETHOD name="Save">
								<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="Add">
								<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
								<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="UpdateMember">
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpActiveDate)" value="ATTR(ActiveDate)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpNameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpNameLast)"/>
					<WTSETATTRIBUTE name="ATTR(Email)" value="CONST(tmpEmail)"/>
					<WTSETATTRIBUTE name="ATTR(Process)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(5)"/>
					
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEF&quot;)"/>

					<WTSETATTRIBUTE name="ATTR(ReferralID)" value="CONST(tmpMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpDays)" value="CONST(DateDiff(&quot;d&quot;,tmpActiveDate,reqSysDate))"/>
					<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(tmpDays)"/>

					<WTMETHOD name="Add">
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<!-- Create/Update the billing tokens -->
						<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot;, &quot; + .NameLast)"/>
						<WTCALLSUB name="GetToken reqMemberID, reqBillingID, tmpName, .Email, reqProcessor, reqMemberToken, reqToken, reqPayDesc "/>
						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(CSTR(reqProcessor) + &quot;-&quot; + CSTR(reqMemberToken))"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<!-- Process the first payment -->
						<WTCALLSUB name="GetPayment reqMemberID, .Price, reqPayType, reqPayDesc, reqProcessor, reqMemberToken, reqToken"/>
						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<!-- Activate new Customer -->
							<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
							<!-- Update Billing Date -->
							<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .EnrollDate))"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>	
				<!-- Move computer to new member -->
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LogMemberNote reqMemberID, &quot;Customer created from their referring Affiliate's computer.&quot;">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadMachine"/>
				<WTCALLSUB name="LoadCountrys"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="FORM(MemberID)"/>
				<WTSETATTRIBUTE name="PARAM(BillingID)" value="FORM(BillingID)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10128" message="Oops, You must agree to be billed monthly."/>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="UpdateMember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="SendEmail" type="Update">
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					reqE = 2
					url = "http://" + reqSysServerName + reqSysServerPath + "10713.asp?machineid=" &amp; reqMachineID
					oHTTP.open "GET", url
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
				<WTCALLSUB name="NewMember"/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="210" align="right"/>
				<WTCOLUMN width="490" align="left"/>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
						//var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype = payobj.value; 
						//var l = payobj.length;
						//for( i = 0; i &lt; l; i++ ) {
						//	if (payobj[i].checked) {
						//		paytype = payobj[i].value;
						//		i = l;
						//	}
						//}
						//if (paytype == 5) {
						//	if ( countryid != 224 ) {
						//		paytype = 1;
						//		document.getElementById('PayType').value = paytype;
						//		alert("Electronic Checks not available outside the United States");
						//	}
						//}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
						ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="TitleCase(obj)">	
					var val = obj.value;
					if ( val.length == 2 ) {
						obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {					
						obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatCardCode(obj)">	
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
						alert('Oops, Invalid Security Code'); 
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>

				<WTSTATIC label="IsAgree"/>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(Email)"/>
					<WTHIDDEN value="PARAM(BillingName)"/>
					<WTHIDDEN value="PARAM(Processor)"/>
					<WTHIDDEN value="PARAM(MemberToken)"/>
					<WTHIDDEN value="PARAM(Token)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(E)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading" fontcolor="blue">
						<WTSTATIC label="EmailSent" space="1"/>
						<WTSTATIC value="PARAM(Email)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="Checkout" space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="Email" space="1"/>
						<WTSTATIC value="ATTR(Member.Email)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="TotalComputers" space="1"/>
						<WTSTATIC value="ATTR(Member.Process)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="TotalPrice" space="1"/>
						<WTSTATIC value="ATTR(Member.Price)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(E)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="4" value="CONST(SendEmail)" align="center"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" align="center" bold="true"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTHIDDEN value="PARAM(PayType)"/>
				</WTROW>
				<WTROW margin-bottom="6">
				 	<WTSTATIC col="1" merge="3" align="center">
				 		<WTCODEGROUP>
							<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
								<WTCLICK>CheckType(1);</WTCLICK>
							</WTIMAGE>
				 		</WTCODEGROUP>
				 		<WTCODEGROUP>
							<WTSTATIC space="3"/>
							<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
								<WTCLICK>CheckType(2);</WTCLICK>
							</WTIMAGE>
				 		</WTCODEGROUP>
				 		<WTCODEGROUP>
							<WTSTATIC space="3"/>
							<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
								<WTCLICK>CheckType(3);</WTCLICK>
							</WTIMAGE>
				 		</WTCODEGROUP>
				 		<WTCODEGROUP>
							<WTSTATIC space="3"/>
							<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
								<WTCLICK>CheckType(4);</WTCLICK>
							</WTIMAGE>
				 		</WTCODEGROUP>
				 	</WTSTATIC>
				</WTROW>

				<WTROW id="CardRows">
					<WTSTATIC col="1"/>
					<WTTABLE col="2" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
								<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
								<WTOPTION id="" label="Select"/>
								<WTOPTION id="1" label="January"/>
								<WTOPTION id="2" label="February"/>
								<WTOPTION id="3" label="March"/>
								<WTOPTION id="4" label="April"/>
								<WTOPTION id="5" label="May"/>
								<WTOPTION id="6" label="June"/>
								<WTOPTION id="7" label="July"/>
								<WTOPTION id="8" label="August"/>
								<WTOPTION id="9" label="September"/>
								<WTOPTION id="10" label="October"/>
								<WTOPTION id="11" label="November"/>
								<WTOPTION id="12" label="December"/>
							</WTCOMBO>
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
								<WTOPTION id="" label="Select"/>
								<WTOPTION id="12" label="2012"/>
								<WTOPTION id="13" label="2013"/>
								<WTOPTION id="14" label="2014"/>
								<WTOPTION id="15" label="2015"/>
								<WTOPTION id="16" label="2016"/>
								<WTOPTION id="17" label="2017"/>
								<WTOPTION id="18" label="2018"/>
								<WTOPTION id="19" label="2019"/>
								<WTOPTION id="20" label="2020"/>
								<WTOPTION id="21" label="2021"/>
								<WTOPTION id="22" label="2022"/>
								<WTOPTION id="23" label="2023"/>
								<WTOPTION id="24" label="2024"/>
								<WTOPTION id="25" label="2025"/>
							</WTCOMBO>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
								<WTEXIT>FormatCardCode(this);</WTEXIT>
							</WTTEXT>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTTOOLTIP>
										<WTIMAGE value="CONST(SymbolHelp.gif)"/>
										<WTTIP>
											<WTIMAGE value="CONST(SecurityCode.png)"/>
										</WTTIP>
									</WTTOOLTIP>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="BillingAddress" />
							<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60">
								<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="25" align="left">
								<WTEXIT>if(this.value==''){alert('Oops, City Required!');}else{TitleCase(this);}</WTEXIT>
							</WTTEXT>
							<WTTEXT col="2" value="ATTR(Billing.State)" width="240" label="State" size="25" align="left">
								<WTEXIT>if(this.value==''){alert('Oops, State Required!');}else{TitleCase(this);}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10" align="left">
								<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')}</WTEXIT>
							</WTTEXT>
							<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-top="18">
					<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
					<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="3" value="CONST(Submit)" align="center">
						<WTCLICK>doSubmit(2,''); this.disabled = true</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="3" action="3" value="CONST(Cancel)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Convert Affiliate Computer to New Customer Upgrade Email -->
		<!--==================================================================================================-->
		<WTWEBPAGE name="10713" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl">
			<!--==================================================================================================-->
			<WTPARAM name="MachineID" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>
			<!--Required Parameter for Mail-->

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="PARAM(MachineID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Machine.Email)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachine" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Machine.Email)"/>
				</WTOBJECT>

				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Become a CloudZow Customer&quot;)"/>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender"/>

			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" label="Welcome">
						<WTSTATIC space="1"/>
						<WTSTATIC value="ATTR(Machine.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Machine.NameLast)"/>
					</WTSTATIC>
				</WTROW>
	
				<WTROW margin-top="12">
					<WTSTATIC col="1" label="ConvertComputerText" class="PageHeading">
						<WTLINK name="https://www.cloudzow.com/10712" return="false">
							<WTPARAM name="MachineID" value="PARAM(MachineID)"/>
						</WTLINK>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>