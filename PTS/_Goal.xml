<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="70" name="Goal" alias="go" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="7001" name="GoalID" type="number" identity="true" min="1" required="true" source="entity" title="true"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="7002" name="MemberID" type="number" min="1" source="entity"/>
		<WTATTRIBUTE id="7003" name="ParentID" type="number" min="1" source="entity"/>
		<WTATTRIBUTE id="7004" name="AssignID" type="number" source="entity"/>
		<WTATTRIBUTE id="7005" name="CompanyID" type="number" source="entity"/>
		<WTATTRIBUTE id="7006" name="ProspectID" type="number" source="entity"/>

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="7007" name="NameLast" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="Member" name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7008" name="NameFirst" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="Member" name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7009" name="MemberName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameFirst"/>
			<WTCOMPUTE text=" "/>
			<WTCOMPUTE name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7010" name="AssignNameLast" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="AuthUser" name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7011" name="AssignNameFirst" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="AuthUser" name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7012" name="AssignName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="AssignNameFirst"/>
			<WTCOMPUTE text=" "/>
			<WTCOMPUTE name="AssignNameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7013" name="ProspectName" type="text" length="60" source="join">
			<WTJOIN entity="Prospect" name="ProspectName"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="7015" name="GoalName" type="text" length="60" min="1" max="60" required="true" source="entity"/>
		<WTATTRIBUTE id="7016" name="Description" type="text" length="2000" min="1" max="2000" source="entity" embedhtml="true"/>
		<WTATTRIBUTE id="7017" name="GoalType" type="number" source="entity">
			<WTENUM id="1" name="Company"/>
			<WTENUM id="2" name="Department"/>
			<WTENUM id="3" name="Individual"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7018" name="Priority" type="number" source="entity">
			<WTENUM id="1" name="High"/>
			<WTENUM id="2" name="Medium"/>
			<WTENUM id="3" name="Low"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7019" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Declared"/>
			<WTENUM id="2" name="Committed"/>
			<WTENUM id="3" name="Completed"/>
			<WTENUM id="4" name="Cancelled"/>
		</WTATTRIBUTE>

		<WTATTRIBUTE id="7020" name="CreateDate" type="date" source="entity"/>
		<WTATTRIBUTE id="7021" name="CommitDate" type="date" source="entity"/>
		<WTATTRIBUTE id="7022" name="CompleteDate" type="date" source="entity"/>
		<WTATTRIBUTE id="7023" name="Variance" type="number" source="entity"/>
		<WTATTRIBUTE id="7024" name="RemindDate" type="date" source="entity"/>
		<WTATTRIBUTE id="7025" name="Template" type="number" source="entity"/>
		<WTATTRIBUTE id="7026" name="Children" type="number" source="entity"/>
		<WTATTRIBUTE id="7027" name="Qty" type="number" source="entity"/>
		<WTATTRIBUTE id="7028" name="ActQty" type="number" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="7090" name="FromDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="7091" name="ToDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="7092" name="Num1" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="7093" name="Num2" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="7094" name="Num3" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="7095" name="Email" type="text" length="80" source="entity" persist="false"/>
		<WTATTRIBUTE id="7096" name="FromEmail" type="text" length="80" source="entity" persist="false"/>
		<WTATTRIBUTE id="7097" name="IsMsg" type="yesno" source="entity" persist="false"/>

		<!--Indexes-->
		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CommitDate"/>
		</WTINDEX>
		<WTINDEX name="Template">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="Template"/>
		</WTINDEX>
		<WTINDEX name="ParentID">
			<WTATTRIBUTE name="ParentID"/>
		</WTINDEX>
		<WTINDEX name="ProspectID">
			<WTATTRIBUTE name="ProspectID"/>
		</WTINDEX>
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID"/>
		</WTINDEX>
		<WTINDEX name="RemindDate">
			<WTATTRIBUTE name="RemindDate"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Goal" entity="Goal" alias="go"/>
			<WTRELATIONSHIP name="Common" entity="Goal" alias="go">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="go" name="MemberID" relalias="me" relname="MemberID"/>
				</WTENTITY>
				<WTENTITY name="AuthUser" entity="AuthUser" alias="au">
					<WTATTRIBUTE alias="go" name="AssignID" relalias="au" relname="AuthUserID"/>
				</WTENTITY>
				<WTENTITY name="Prospect" entity="Prospect" alias="pr">
					<WTATTRIBUTE alias="go" name="ProspectID" relalias="pr" relname="ProspectID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="GoalName" default="true" contains="true"/>
			<WTATTRIBUTE name="Description" contains="true"/>	
			<WTATTRIBUTE name="GoalID"/>
			<WTATTRIBUTE name="GoalType"/>
			<WTATTRIBUTE name="Priority"/>
		</WTENUM>

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="GOAL-STATUS-DECLARE" value="1"/>
			<WTSYSCON name="GOAL-STATUS-COMMIT" value="2"/>
			<WTSYSCON name="GOAL-STATUS-COMPLETE" value="3"/>
			<WTSYSCON name="GOAL-STATUS-CANCEL" value="4"/>
			<WTSYSCON name="TEMPLATE-MEMBER" value="1"/>
			<WTSYSCON name="TEMPLATE-PROSPECT" value="2"/>
			<WTSYSCON name="TEMPLATE-TASK" value="3"/>
		</WTSYSCONS>

	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE name="Count" type="Count" style="GenerateDataProc.xsl"/>
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTCODEGROUP>
				<WTPROCEDURE name="Shortcut_DeleteItem">
					<WTPARAM name="EntityID" direction="input" value="ENTITY(Goal)"/>
					<WTPARAM name="ItemID" direction="input" value="PARAM(GoalID)"/>
				</WTPROCEDURE>
				<WTPROCEDURE name="Goal_DeleteGoals">
					<WTPARAM name="ParentID" direction="input" value="PARAM(GoalID)"/>
				</WTPROCEDURE>
				<WTDELETE>
					<WTJOIN name="Goal" lock="true"/>
					<WTCONDITION expr="ATTR(GoalID)" oper="equal" value="PARAM(GoalID)"/>
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Goal.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Goal.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindPrimary" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Goal.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.ParentID)" oper="equal" value="CONST(0)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindPrimaryStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Goal.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.ParentID)" oper="equal" value="CONST(0)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)" connector="and"/>
			<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListParent" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(ParentID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Goal.ParentID)"/>
					<WTATTRIBUTE value="ATTR(Goal.AssignID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTATTRIBUTE value="ATTR(Goal.Description)"/>
					<WTATTRIBUTE value="ATTR(Goal.Priority)"/>
					<WTATTRIBUTE value="ATTR(Goal.Status)"/>
					<WTATTRIBUTE value="ATTR(Goal.CommitDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.RemindDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.Variance)"/>
					<WTATTRIBUTE value="ATTR(Goal.Children)"/>
					<WTATTRIBUTE value="ATTR(Goal.Qty)"/>
					<WTATTRIBUTE value="ATTR(Goal.ActQty)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.ParentID)" oper="equal" value="PARAM(ParentID)"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListProspect" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(ProspectID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Goal.ParentID)"/>
					<WTATTRIBUTE value="ATTR(Goal.ProspectID)"/>
					<WTATTRIBUTE value="ATTR(Goal.AssignID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTATTRIBUTE value="ATTR(Goal.Description)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalType)"/>
					<WTATTRIBUTE value="ATTR(Goal.Priority)"/>
					<WTATTRIBUTE value="ATTR(Goal.Status)"/>
					<WTATTRIBUTE value="ATTR(Goal.CommitDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.Variance)"/>
					<WTATTRIBUTE value="ATTR(Goal.Children)"/>
					<WTATTRIBUTE value="ATTR(Goal.Qty)"/>
					<WTATTRIBUTE value="ATTR(Goal.ActQty)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.ProspectID)" oper="equal" value="PARAM(ProspectID)"/>
					<WTCONDITION expr="ATTR(Goal.ParentID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportMember" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(GoalType)" direction="input"/>
			<WTPARAM name="ATTR(Priority)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Goal.ParentID)"/>
					<WTATTRIBUTE value="ATTR(Goal.AssignID)"/>
					<WTATTRIBUTE value="ATTR(Goal.AssignName)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTATTRIBUTE value="ATTR(Goal.Description)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalType)"/>
					<WTATTRIBUTE value="ATTR(Goal.Priority)"/>
					<WTATTRIBUTE value="ATTR(Goal.Status)"/>
					<WTATTRIBUTE value="ATTR(Goal.CommitDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.Variance)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportBusiness" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(MemberID)" direction="input"/>  <!-- MasterID -->
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(GoalType)" direction="input"/>
			<WTPARAM name="ATTR(Priority)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>  <!-- Group -->
					<WTATTRIBUTE value="ATTR(Goal.MemberName)"/>  <!-- Role -->
					<WTATTRIBUTE value="ATTR(Goal.Num1)"/>
					<WTATTRIBUTE value="ATTR(Goal.Num2)"/>
					<WTATTRIBUTE value="ATTR(Goal.Num3)"/>
					<WTATTRIBUTE value="ATTR(Goal.Variance)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportCompany" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(MemberID)" direction="input"/>  <!-- CompanyID -->
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(GoalType)" direction="input"/>
			<WTPARAM name="ATTR(Priority)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>  <!-- Business -->
					<WTATTRIBUTE value="ATTR(Goal.MemberName)"/>  <!-- Role -->
					<WTATTRIBUTE value="ATTR(Goal.Num1)"/>
					<WTATTRIBUTE value="ATTR(Goal.Num2)"/>
					<WTATTRIBUTE value="ATTR(Goal.Num3)"/>
					<WTATTRIBUTE value="ATTR(Goal.Variance)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="EnumXML" name="EnumMemberList" enumname="EnumUserMemberList" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Template)" direction="input"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="Enum" name="EnumUserMemberList" style="GenerateDataProc.xsl" column="GoalName" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Template)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE alias="Name" value="ATTR(Goal.GoalName)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="PARAM(Template)" connector="and"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="EnumXML" name="EnumCompanyList" enumname="EnumUserCompanyList" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Template)" direction="input"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="Enum" name="EnumUserCompanyList" style="GenerateDataProc.xsl" column="GoalName" template="new" passthru="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>	
			<WTPARAM name="ATTR(Template)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE alias="Name" value="ATTR(Goal.GoalName)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="PARAM(Template)" connector="and"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="Reminder" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(RemindDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTATTRIBUTE value="ATTR(Goal.Description)"/>
					<WTATTRIBUTE value="ATTR(Goal.ParentID)"/>
					<WTATTRIBUTE value="ATTR(Goal.CommitDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.Email)"/>
					<WTATTRIBUTE value="ATTR(Goal.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Goal.IsMsg)"/>
					<WTATTRIBUTE value="ATTR(Goal.FromEmail)"/>
					<WTATTRIBUTE value="ATTR(Goal.ProspectName)"/>
					<WTATTRIBUTE value="ATTR(Goal.MemberName)"/>  <!-- Parent Name -->
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListTemplate" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListMemberTrack" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Template)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="PARAM(Template)" connector="and"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListActiveTrack" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)" connector="and"/>
					<WTCONDITION expr="ATTR(Goal.ParentID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListCompanyTrack" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Template)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)"/>
					<WTATTRIBUTE value="ATTR(Goal.GoalName)"/>
					<WTJOIN name="Goal"/>
					<WTCONDITION expr="ATTR(Goal.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="PARAM(Template)" connector="and"/>
					<WTORDER name="ATTR(Goal.GoalName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE name="Copy"  type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(GoalID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(ProspectID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(GoalName)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTPARAM name="NewGoalID" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="CheckTrack"  type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(ParentID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="GoalID" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="Goals" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(GoalID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)" />
					<WTATTRIBUTE value="ATTR(Goal.ParentID)" />
					<WTATTRIBUTE value="ATTR(Goal.GoalName)" />
					<WTATTRIBUTE value="ATTR(Goal.Description)"/>
					<WTATTRIBUTE value="ATTR(Goal.Qty)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="Preview" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(GoalID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Goal.GoalID)" />
					<WTATTRIBUTE value="ATTR(Goal.ParentID)" />
					<WTATTRIBUTE value="ATTR(Goal.GoalName)" />
					<WTATTRIBUTE value="ATTR(Goal.Status)"/>
					<WTATTRIBUTE value="ATTR(Goal.CommitDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Goal.Variance)"/>
					<WTATTRIBUTE value="ATTR(Goal.Qty)"/>
					<WTATTRIBUTE value="ATTR(Goal.ActQty)"/>
					<WTATTRIBUTE value="ATTR(Goal.Description)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="CalcChildren" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true" >
			<WTPARAM name="ATTR(GoalID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="UpdateStatus" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true" >
			<WTPARAM name="ATTR(GoalID)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTPARAM name="ATTR(ActQty)" direction="input"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="XML" name="XMLDashboard" element="Goal" style="GenerateDataProc.xsl" template="new" nobusn="true" nodata="true">
			<WTATTRIBUTE value="GoalID" alias="id"/>
			<WTATTRIBUTE value="GoalName" alias="name"/>
		</WTPROCEDURE>

	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--============================================================================================-->
		<WTWEBPAGE name="7001" caption="Member Goals" action="5" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Primary" datatype="number"/>
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotGoals" connector="and"/>
				<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(GoalName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<!-- SAVE MEMBERID BEING MENTORED -->
				<WTSETCACHE name="MentoringID" value="PARAM(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTSETCACHE>
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>

				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(Primary)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
				<WTMETHOD name="Find">
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Primary)" oper="equal" value="CONST(0)" connector="and"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindStatus">
					<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Primary)" oper="equal" value="CONST(0)" connector="and"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindPrimary">
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Primary)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindPrimaryStatus">
					<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Primary)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>
				
				<WTSTATIC label="GoalPreview"/>
				<WTSTATIC label="GoalDetails"/>
				<WTSTATIC label="Children"/>
				<WTSTATIC label="Child"/>

				<WTROW>
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTSTATIC tag="Mentoring" fontcolor="red"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="300" align="left"/>
						<WTCOLUMN width="300" align="right"/>
						<WTROW>
							<WTSTATIC col="1" class="PageHeading">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(goal32.gif)" alt="calendar" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC label="FindGoal"/>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPinnacleTutorial"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
										<WTLINK name="Tutorial" target="Tutorial">
											<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-GOALS)"/>
											<WTPARAM name="contentpage" value="CONST(3)"/>
											<WTPARAM name="popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" align="right" bold="true">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="NewGoal">
										<WTLINK name="7002">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											<WTPARAM name="Popup" value="PARAM(Popup)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(template.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="GoalTemplate">
										<WTLINK name="7005">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
<!--											<WTPARAM name="Popup" value="PARAM(Popup)"/>-->
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
<!--								
								<WTLINK name="7020" label="Report" class="PageHeadingLink" target="GoalReport">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
-->								
						</WTROW>
						</WTTABLE>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="GoalFindText" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Goals.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="greater" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="ShowStatus" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="PARAM(Status)" prespace="false">
						<WTOPTION id="0" label="All"/>
						<WTOPTION id="1" label="Declared"/>
						<WTOPTION id="2" label="Committed"/>
						<WTOPTION id="3" label="Completed"/>
<!--						<WTOPTION id="4" label="Cancelled"/>-->
					</WTCOMBO>
					<WTCHECK col="1" value="PARAM(Primary)" label="Primary"/>
<!--					<WTIMAGE col="1" value="CONST(Primary.gif)"/>-->
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Goal">
						<WTCOLUMN width="54" align="left" valign="top" label="Goal"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Projected"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Actual"/>
						<WTCOLUMN width="8" align="center" valign="top" label="Variance"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Reminder"/>
						<WTCOLUMN width="8" align="center" valign="top" label="Priority"/>
						<WTROW height="18">
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
									<WTCONDITION expr="DATA(Goal.Status)" oper="not-equal" value="SYSCON(GOAL-STATUS-CANCEL)" connector="and"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GreenChecksm.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(RedChecksm.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(RedX.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-CANCEL)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Goal.ParentID)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(foldersm.gif)" alt="Child" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
									<WTCONDITION expr="DATA(Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
									<WTIMAGE value="CONST(Template.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Goal.GoalName)" space="1">
									<WTLINK name="7050" target="Preview">
										<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalPreview.gif)" alt="GoalPreview" imgalign="absmiddle">
										<WTLINK name="7050" target="Preview">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
										</WTLINK>
									</WTIMAGE>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Goalsm.gif)" alt="GoalDetails" imgalign="absmiddle">
										<WTLINK name="7003">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
											<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											<WTPARAM name="Popup" value="PARAM(Popup)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Children)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(GoalChildren.gif)" alt="Children" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTSTATIC>
									<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC fontcolor="red">
										<WTCONDITION expr="DATA(Goal.ActQty)" oper="less" value="DATA(Qty)"/>
										<WTSTATIC value="DATA(Goal.ActQty)" space="1"/>
										<WTSTATIC label="of" space="1"/>
										<WTSTATIC value="DATA(Goal.Qty)"/>
									</WTSTATIC>
									<WTSTATIC fontcolor="green">
										<WTCONDITION expr="DATA(Goal.ActQty)" oper="greater-equal" value="DATA(Qty)"/>
										<WTSTATIC value="DATA(Goal.ActQty)" space="1"/>
										<WTSTATIC label="of" space="1"/>
										<WTSTATIC value="DATA(Goal.Qty)"/>
									</WTSTATIC>
								</WTSTATIC>
<!--
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;))" fontcolor="blue"/>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@parentid&quot;/&gt;))" fontcolor="purple">
									<WTCONDITION expr="DATA(Goal.ParentID)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@assignname&quot;/&gt;))" fontcolor="blue"/>
-->
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Goal.CommitDate)" valign="top"/>
							<WTSTATIC col="3" value="DATA(Goal.CompleteDate)" valign="top"/>
							<WTSTATIC col="4" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
									<WTSTATIC value="DATA(Goal.Variance)" fontcolor="green">
										<WTCONDITION expr="DATA(Goal.Variance)" oper="less" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Goal.Variance)">
										<WTCONDITION expr="DATA(Goal.Variance)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Goal.Variance)" fontcolor="red">
										<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="5" value="DATA(Goal.RemindDate)" valign="top"/>
							<WTSTATIC col="6" value="DATA(Goal.Priority)" valign="top"/>
						</WTROW>
<!--
						<WTROW>
							<WTSTATIC col="1" merge="6" value="DATA(Goal.Description)" embedhtml="true"/>
						</WTROW>
-->
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7002" caption="New Goal" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ParentID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="ProspectID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="Template" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="NewGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(ParentID)" value="PARAM(ParentID)"/>
					<WTSETATTRIBUTE name="ATTR(AssignID)" value="SYS(UserID)"/>
					<WTSETATTRIBUTE name="ATTR(Template)" value="PARAM(Template)"/>
					<WTSETATTRIBUTE name="ATTR(Template)" value="SYSCON(TEMPLATE-TASK)">
						<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewGoal"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(ProspectID)" value="PARAM(ProspectID)"/>
					<WTSETATTRIBUTE name="ATTR(CreateDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(Template)" value="PARAM(Template)"/>
					<WTSETATTRIBUTE name="ATTR(Template)" value="SYSCON(TEMPLATE-TASK)">
						<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTES/>
<WTCUSTOM>
				If .Status &lt; 4 Then
					If .Status = 0 Then .Status = 1
					If IsDate(.CommitDate) Then
						.Status = 2
						If IsDate(.CompleteDate) Then
							.Status = 3
							.Variance = DATEDIFF("d", .CommitDate, .CompleteDate)
							.RemindDate = ""
						End If
					End If
				End If
</WTCUSTOM>
					<WTMETHOD name="Add">
						<WTPARAM name="GoalID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="CalcChildren">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="GoalID" direction="input" value="PARAM(ParentID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="Copy" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpGoalID)" value="FORM(GoalID)"/>
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTCONDITION expr="CONST(tmpGoalID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Copy">
						<WTPARAM name="GoalID" direction="input" value="CONST(tmpGoalID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)"/>
						<WTPARAM name="GoalName" direction="input" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="UserID" direction="input" value="SYS(UserID)"/>
						<WTPARAM name="CopyGoalID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="CONST(tmpGoalID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="NoErrors" connector="and"/>
				</WTRETURN>
				<WTCALLSUB name="NewGoal">
					<WTCONDITION expr="CONST(tmpGoalID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="IsErrors" connector="or"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right"/>
				<WTCOLUMN width="460" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC label="NewGoal">
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
							<WTIMAGE value="CONST(Templatemd.gif)"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="NewGoalTemplate"/>
						</WTCODEGROUP>
						
						<WTSTATIC label="NewTask">
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)"/>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)" connector="or"/>
								<WTSTATIC space="1"/>
								<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
									<WTLINK name="Tutorial" target="Tutorial">
										<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-GOALS)"/>
										<WTPARAM name="contentpage" value="CONST(3)"/>
										<WTPARAM name="popup" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
					<WTROW margin-bottom="6">
						<WTIMAGE col="1" value="CONST(goal.gif)" align="center" valign="top"/>
						<WTSTATIC col="2" align="left" class="prompt">
							<WTSTATIC label="Instructions" newline="1"/>
							<WTSTATIC label="Instruction1" newline="1"/>
							<WTSTATIC label="Instruction2" newline="1"/>
							<WTSTATIC label="Instruction3" newline="1"/>
							<WTSTATIC label="Instruction4"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1" tag="MemberID"/>
						<WTTEXT col="2" value="ATTR(Goal.MemberID)" size="5"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ParentID"/>
						<WTTEXT col="2" value="ATTR(Goal.ParentID)" size="5"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="AssignID"/>
						<WTTEXT col="2" value="ATTR(Goal.AssignID)" size="5"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Status"/>
						<WTCOMBO col="2" value="ATTR(Goal.Status)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTHIDDEN value="ATTR(Goal.MemberID)"/>
					<WTHIDDEN value="ATTR(Goal.ParentID)"/>
					<WTHIDDEN value="ATTR(Goal.AssignID)"/>
					<WTHIDDEN value="ATTR(Goal.Status)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC tag="Goal">
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC tag="Track">
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
						</WTSTATIC>
						<WTSTATIC tag="Task">
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)"/>
						</WTSTATIC>
					</WTSTATIC>
					<WTTEXT col="2" value="ATTR(Goal.GoalName)" size="60" focus="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="GoalType"/>
					<WTCOMBO col="2" value="ATTR(Goal.GoalType)"/>
					<WTSTATIC col="2" tag="Priority"/>
					<WTCOMBO col="2" value="ATTR(Goal.Priority)" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
					<WTSTATIC col="1" tag="Qty"/>
					<WTTEXT col="2" value="ATTR(Goal.Qty)" size="3" prespace="false"/>
					<WTSTATIC col="2" tag="ActQty"/>
					<WTTEXT col="2" value="ATTR(Goal.ActQty)" size="3" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CommitDate"/>
					<WTTEXT col="2" value="ATTR(Goal.CommitDate)"/>
					<WTSTATIC col="2">
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
						<WTSTATIC tag="CompleteDate"/>
						<WTCODEGROUP>
							<WTTEXT value="ATTR(Goal.CompleteDate)"/>
						</WTCODEGROUP>
					</WTSTATIC>	
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="RemindDate"/>
					<WTTEXT col="2" value="ATTR(Goal.RemindDate)"/>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Goal.Description)" cols="72" rows="8" htmleditor="true" embedhtml="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(ParentID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)" connector="and"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="CopyGoal" align="left" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CopyGoalID"/>
						<WTTEXT col="2" value="ATTR(Goal.GoalID)" size="5"/>
						<WTBUTTON col="2" value="CONST(Preview)" btnclass="smbutton">
							<WTCLICK>
						var url, win, g;
						g = Goal.GoalID.value
						if( g != 0 ) {
							url = "7012.asp?goalid=" + g
							win = window.open(url,'Template');
							win.focus();
						}
							</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="2" action="4" value="CONST(Copy)" align="center">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-top="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="18" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7003" caption="Goal Details" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--==================================================================-->
			<WTPARAM name="GoalID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="UpdateGoalID" datatype="number"/>
			<WTPARAM name="ClearGoal" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ProspectID" datatype="number"/>

			<WTSUB function="AddNote(prmNotes, prmGoalID)">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="SYS(UserID)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="CONST(70)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(prmGoalID)"/>
					<WTSETATTRIBUTE name="ATTR(IsLocked)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(prmNotes)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- CHECK FOR ILLEGAL ACCESS -->
					<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="PARAM(ProspectID)" value="ATTR(ProspectID)"/>
					<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
						<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberOnly"/>
						<WTCONDITION expr="CONST(Clng(.MemberID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
						<WTCONDITION expr="CONST(Clng(.MemberID))" oper="not-equal" value="CONST(Clng(tmpMentoringID))" connector="and"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(GoalName)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="ListParent">
						<WTPARAM name="ParentID" direction="input" value="PARAM(GoalID)"/>
					</WTMETHOD>
<!--
<WTCUSTOM>
					For Each oGoal in oGoals
						With oGoal
							.GoalName = .GoalName + " [view]"
						End With
					Next
</WTCUSTOM>
-->
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB function="ReturnGoal(prmParentID, prmMemberID)">
				<!-- If we don't know the parent, look it up -->
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
<!--
					<WTCONDITION expr="CONST(prmParentID)" oper="equal" value="CONST(-1)"/>
					<WTCONDITION expr="CONST(prmMemberID)" oper="equal" value="CONST(-1)" connector="or"/>
-->
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(prmParentID)" value="ATTR(ParentID)"/>
					<WTSETATTRIBUTE name="CONST(prmMemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpTemplate)" value="ATTR(Template)"/>
				</WTOBJECT>
				<!-- If company, go to company list -->
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(prmParentID)" oper="equal" value="CONST(0)"/>
					<WTRETURN>
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="7014" return="false">
							<WTPARAM name="CompanyID" value="CONST(tmpCompanyID)"/>
							<WTPARAM name="Template" value="CONST(tmpTemplate)"/>
						</WTLINK>
					</WTRETURN>
					<!-- If we don't have a parent, return to the goal list -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="equal" value="CONST(0)"/>
						<WTRETURN>
							<WTCONDITION expr="CONST(tmpTemplate)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTCONDITION expr="CONST(tmpTemplate)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
							<WTLINK name="7014" return="false">
								<WTPARAM name="MemberID" value="CONST(prmMemberID)"/>
								<WTPARAM name="Template" value="CONST(tmpTemplate)"/>
							</WTLINK>
						</WTRETURN>
						<WTRETURN>
							<WTLINK name="7001" return="false">
								<WTPARAM name="MemberID" value="CONST(prmMemberID)"/>
								<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								<WTPARAM name="Popup" value="PARAM(Popup)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<!-- If we have a parent, return to the parent detail page -->
				<WTRETURN>
					<WTCONDITION expr="CONST(prmParentID)" oper="not-equal" value="CONST(0)"/>
					<WTLINK name="7003" nolocaldata="true">
						<WTPARAM name="GoalID" value="CONST(prmParentID)"/>
						<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
						<WTPARAM name="Popup" value="PARAM(Popup)"/>
					</WTLINK>
				</WTRETURN>
			</WTSUB>

			<WTSUB name="UpdateGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTCONDITION expr="PARAM(UpdateGoalID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(UpdateGoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCommitDate)" value="ATTR(CommitDate)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompleteDate)" value="ATTR(CompleteDate)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ClearGoal)" oper="equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(GOAL-STATUS-COMPLETE)"/>
							<WTSETATTRIBUTE name="ATTR(CompleteDate)" value="SYS(Date)"/>
							<WTSETATTRIBUTE name="ATTR(RemindDate)" value="CONST(&quot;&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(0)"/>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(GOAL-STATUS-DECLARE)" connector="or"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(GOAL-STATUS-COMMIT)"/>
							<WTSETATTRIBUTE name="ATTR(CommitDate)" value="SYS(Date)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ClearGoal)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(CommitDate)" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompleteDate)" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(RemindDate)" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Variance)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(ActQty)" value="CONST(0)"/>
					</WTCODEGROUP>
<WTCUSTOM>
				If .Status &lt; 4 Then
					If IsDate(.CommitDate) Then
						.Status = 2
						If IsDate(.CompleteDate) Then
							.Status = 3
							.Variance = DATEDIFF("d", .CommitDate, .CompleteDate)
							.RemindDate = ""
						End If
					End If
				End If
</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)" connector="and"/>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpCommitDate)" oper="not-equal" value="CONST(&quot;0&quot;)"/>
							<WTCONDITION expr="CONST(tmpCommitDate)" oper="not-equal" value="ATTR(CommitDate)" connector="and"/>
							<WTCALLSUB name="AddNote &quot;Projected Date Changed from &quot; + tmpCommitDate + &quot; to &quot; + .CommitDate, reqUpdateGoalID"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpCompleteDate)" oper="not-equal" value="CONST(&quot;0&quot;)"/>
							<WTCONDITION expr="CONST(tmpCompleteDate)" oper="not-equal" value="ATTR(CompleteDate)" connector="and"/>
							<WTCALLSUB name="AddNote &quot;Complete Date Changed from &quot; + tmpCompleteDate + &quot; to &quot; + .CompleteDate, reqUpdateGoalID"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="and"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="and"/>
						<WTHTTP>
							<WTLINK name="0418">
								<WTPARAM name="MemberID" value="ATTR(MemberID)"/>
								<WTPARAM name="Notify" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
								<WTPARAM name="ID" value="ATTR(GoalID)"/>
							</WTLINK>
						</WTHTTP>
						<WTHTTP>
							<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
							<WTLINK name="0438">
								<WTPARAM name="MemberID" value="ATTR(MemberID)"/>
								<WTPARAM name="Notify" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
								<WTPARAM name="ID" value="ATTR(GoalID)"/>
							</WTLINK>
						</WTHTTP>
					</WTCODEGROUP>
				</WTOBJECT>
				
				<WTRETURN>
					<WTLINK name="7003" return="false">
						<WTPARAM name="GoalID" value="PARAM(GoalID)"/>
						<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
						<WTPARAM name="Popup" value="PARAM(Popup)"/>
					</WTLINK>
				</WTRETURN>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="UpdateGoal">
					<WTCONDITION expr="PARAM(UpdateGoalID)" oper="greater" value="CONST(0)"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadGoal"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTRETURN>
					<WTLINK name="7004" nolocaldata="true">
						<WTPARAM name="GoalID" value="PARAM(GoalID)"/>
						<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
						<WTPARAM name="Popup" value="PARAM(Popup)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCALLSUB name="ReturnGoal -1, -1"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="4" name="Task" type="Update">
				<WTRETURN>
					<WTLINK name="7002" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="ProspectID" value="PARAM(ProspectID)"/>
						<WTPARAM name="ParentID" value="PARAM(GoalID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right"/>
				<WTCOLUMN width="460" align="left"/>

				<WTSTATIC label="Edit"/>
				<WTSTATIC label="Start"/>
				<WTSTATIC label="Complete"/>
				<WTSTATIC label="Clear"/>

				<WTROW>
					<WTHIDDEN value="PARAM(ContentPage)"/>
					<WTHIDDEN value="PARAM(Popup)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(ProspectID)"/>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="2" valign="top" padding="0" style="border: 1px #62B462 solid">
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="430" align="center"/>
						<WTCOLUMN width="150" align="center"/>
						<WTCOLUMN width="10" align="center"/>
						<WTROW>
							<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head1.gif">
								<WTSTATIC fontcolor="darkblue" bold="true" align="center">
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(Goalsm.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
										<WTSTATIC tag="Goal" value="ATTR(Goal.GoalName)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
										<WTIMAGE value="CONST(Template.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
										<WTSTATIC tag="Track" value="ATTR(Goal.GoalName)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)"/>
										<WTIMAGE value="CONST(Goalsm.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
										<WTSTATIC tag="Task" value="ATTR(Goal.GoalName)"/>
									</WTCODEGROUP>
									<WTSTATIC>
										<WTCONDITION expr="ATTR(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)" connector="and"/>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
										<WTSTATIC space="1"/>
										<WTSTATIC fontcolor="red">
											<WTCONDITION expr="ATTR(Goal.ActQty)" oper="less" value="ATTR(Qty)"/>
											<WTSTATIC value="ATTR(Goal.ActQty)" space="1"/>
											<WTSTATIC label="of" space="1"/>
											<WTSTATIC value="ATTR(Goal.Qty)"/>
										</WTSTATIC>
										<WTSTATIC fontcolor="green">
											<WTCONDITION expr="ATTR(Goal.ActQty)" oper="greater-equal" value="ATTR(Qty)"/>
											<WTSTATIC value="ATTR(Goal.ActQty)" space="1"/>
											<WTSTATIC label="of" space="1"/>
											<WTSTATIC value="ATTR(Goal.Qty)"/>
										</WTSTATIC>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="NotMemberOnly"/>
										<WTCONDITION expr="_IsShortcuts" connector="or"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Shortcut.gif)">
											<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
												<WTPARAM name="EntityID" value="ENTITY(Goal)"/>
												<WTPARAM name="ItemID" value="ATTR(Goal.GoalID)"/>
												<WTPARAM name="Name" value="ATTR(Goal.GoalName)" clean="true"/>
												<WTPARAM name="URL" value="SYS(PageURL)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
<!--
									<WTCODEGROUP>
										<WTCONDITION expr="_IsPinnacleTutorial"/>
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
											<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)" connector="or"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
												<WTLINK name="Tutorial" target="Tutorial">
													<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-GOALS)"/>
													<WTPARAM name="contentpage" value="CONST(3)"/>
													<WTPARAM name="popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
-->
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="3" align="left" value="ATTR(Goal.Description)" embedhtml="true"/>
							</WTROW>
							<WTROW margin-top="3" margin-bottom="3">
								<WTDIVIDER col="1" merge="4" height="1" color="SYS(box1)"/>
							</WTROW>
						</WTCODEGROUP>

						<WTROW>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="center">
								<WTSTATIC tag="CreateDate"/>
								<WTSTATIC value="ATTR(Goal.CreateDate)" space="5" bold="true"/>
								<WTSTATIC tag="RemindDate"/>
								<WTSTATIC value="ATTR(Goal.RemindDate)" space="5" bold="true"/>
							</WTSTATIC>
							<WTSTATIC col="3" merge="2" align="right" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalPreviewmd.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="7012" target="Preview">
											<WTPARAM name="GoalID" value="ATTR(Goal.GoalID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(GoalEdit1.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="7004">
											<WTPARAM name="GoalID" value="ATTR(Goal.GoalID)"/>
											<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											<WTPARAM name="Popup" value="PARAM(Popup)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="center">
								<WTSTATIC tag="CommitDate"/>
								<WTSTATIC value="ATTR(Goal.CommitDate)" space="5" bold="true"/>
								<WTSTATIC tag="CompleteDate"/>
								<WTSTATIC value="ATTR(Goal.CompleteDate)" space="5" bold="true" newline="1"/>
								<WTSTATIC tag="RemindDate"/>
								<WTSTATIC value="ATTR(Goal.RemindDate)" space="5" bold="true"/>
								<WTSTATIC tag="GoalType"/>
								<WTSTATIC value="ATTR(Goal.GoalType)" space="5" bold="true"/>
								<WTSTATIC tag="Priority"/>
								<WTSTATIC value="ATTR(Goal.Priority)" bold="true" newline="1"/>
								<WTSTATIC label="#"/>
								<WTSTATIC value="ATTR(Goal.GoalID)" bold="true" space="1"/>
								<WTSTATIC tag="AssignName"/>
								<WTSTATIC value="ATTR(Goal.AssignName)" fontcolor="blue"/>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Goal.ProspectID)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC align="left" bold="true">
										<WTSTATIC space="3"/>
										<WTSTATIC tag="Service"/>
										<WTSTATIC value="ATTR(Goal.ProspectName)" fontcolor="purple">
											<WTLINK name="8153" target="Prospect">
												<WTPARAM name="ProspectID" value="ATTR(Goal.ProspectID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTSTATIC>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" merge="2" align="right" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalPreviewmd.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="7050" target="Preview">
											<WTPARAM name="GoalID" value="ATTR(Goal.GoalID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(0)"/>
										<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(GOAL-STATUS-DECLARE)" connector="or"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(GoalStart1.gif)" alt="Start" imgalign="absmiddle">
											<WTLINK name="7003" skipreturn="true">
												<WTPARAM name="GoalID" value="ATTR(GoalID)"/>
												<WTPARAM name="UpdateGoalID" value="ATTR(GoalID)"/>
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												<WTPARAM name="Popup" value="PARAM(Popup)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>

									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(GoalComplete1.gif)" alt="Complete" imgalign="absmiddle">
											<WTLINK name="7003" skipreturn="true">
												<WTPARAM name="GoalID" value="ATTR(GoalID)"/>
												<WTPARAM name="UpdateGoalID" value="ATTR(GoalID)"/>
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												<WTPARAM name="Popup" value="PARAM(Popup)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>

									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Status)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(GoalClear1.gif)" alt="Clear" imgalign="absmiddle">
											<WTLINK name="7003" skipreturn="true">
												<WTPARAM name="GoalID" value="ATTR(GoalID)"/>
												<WTPARAM name="UpdateGoalID" value="ATTR(GoalID)"/>
												<WTPARAM name="ClearGoal" value="CONST(1)"/>
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												<WTPARAM name="Popup" value="PARAM(Popup)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>

									<WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(GoalEdit1.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="7004">
												<WTPARAM name="GoalID" value="ATTR(Goal.GoalID)"/>
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												<WTPARAM name="Popup" value="PARAM(Popup)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>

								</WTSTATIC>
							</WTSTATIC>
						</WTROW>

					</WTTABLE>

				</WTROW>

				<WTROW margin-top="3" margin-bottom="3">
					<WTBUTTON col="1" merge="2" action="4" value="CONST(NewSubGoal)" btnclass="smbutton" align="right"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" btnclass="smbutton" align="right">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" btnclass="smbutton" align="right">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<!-- ************************************************************************************ -->
					
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>

					<WTROW>
						<WTTABLE col="1" merge="2" valign="top" padding="0" style="border: 1px #62B462 solid">
							<WTCOLUMN width="600" align="left"/>
							<WTROW>
								<WTSTATIC col="1" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head1.gif">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GoalChildren.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC fontcolor="darkblue" bold="true">
										<WTSTATIC value="PARAM(Count)" space="1"/>
										<WTSTATIC label="Tasks"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTRECORDSET col="1" merge="2" graybar="true" entity="Goal">
									<WTCOLUMN width="48" align="left" valign="top" label="GoalNames"/>
									<WTCOLUMN width="12" align="center" valign="top" label="Projected"/>
									<WTCOLUMN width="12" align="center" valign="top" label="Actual"/>
									<WTCOLUMN width="8" align="center" valign="top" label="Variance"/>
									<WTCOLUMN width="12" align="center" valign="top" label="Reminder"/>
									<WTCOLUMN width="8" align="center" valign="top" label="Priority"/>
									<WTROW height="15">
										<WTSTATIC col="1">
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
												<WTCONDITION expr="DATA(Goal.Status)" oper="not-equal" value="SYSCON(GOAL-STATUS-CANCEL)" connector="and"/>
												<WTCODEGROUP>
													<WTIMAGE value="CONST(GreenChecksm.gif)">
														<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
													</WTIMAGE>
												</WTCODEGROUP>
												<WTCODEGROUP>
													<WTIMAGE value="CONST(RedChecksm.gif)">
														<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
													</WTIMAGE>
												</WTCODEGROUP>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTIMAGE value="CONST(RedX.gif)">
													<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-CANCEL)"/>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTIMAGE value="CONST(Primary.gif)">
													<WTCONDITION expr="DATA(Goal.ParentID)" oper="equal" value="CONST(0)"/>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1" fontcolor="purple">
												<WTLINK name="7003">
													<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
													<WTPARAM name="Popup" value="PARAM(Popup)"/>
												</WTLINK>
											</WTSTATIC>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Children)" oper="not-equal" value="CONST(0)"/>
												<WTIMAGE value="CONST(GoalChildren.gif)" imgalign="absmiddle"/>
											</WTCODEGROUP>

											<WTSTATIC bold="true">

												<WTCODEGROUP>
													<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
													<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>

													<WTCODEGROUP>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(GoalPreview.gif)" alt="Preview" imgalign="absmiddle">
															<WTLINK name="7050" target="Preview">
																<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
															</WTLINK>
														</WTIMAGE>
													</WTCODEGROUP>
													
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(0)"/>
														<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(GOAL-STATUS-DECLARE)" connector="or"/>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(GoalStart.gif)" alt="Start" imgalign="absmiddle">
															<WTLINK name="7003" skipreturn="true">
																<WTPARAM name="GoalID" value="ATTR(GoalID)"/>
																<WTPARAM name="UpdateGoalID" value="DATA(GoalID)"/>
																<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
																<WTPARAM name="Popup" value="PARAM(Popup)"/>
															</WTLINK>
														</WTIMAGE>
													</WTCODEGROUP>

													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(GoalComplete.gif)" alt="Complete" imgalign="absmiddle">
															<WTLINK name="7003" skipreturn="true">
																<WTPARAM name="GoalID" value="ATTR(GoalID)"/>
																<WTPARAM name="UpdateGoalID" value="DATA(GoalID)"/>
																<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
																<WTPARAM name="Popup" value="PARAM(Popup)"/>
															</WTLINK>
														</WTIMAGE>
													</WTCODEGROUP>

													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(GoalClear.gif)" alt="Clear" imgalign="absmiddle">
															<WTLINK name="7003" skipreturn="true">
																<WTPARAM name="GoalID" value="ATTR(GoalID)"/>
																<WTPARAM name="UpdateGoalID" value="DATA(GoalID)"/>
																<WTPARAM name="ClearGoal" value="CONST(1)"/>
																<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
																<WTPARAM name="Popup" value="PARAM(Popup)"/>
															</WTLINK>
														</WTIMAGE>
													</WTCODEGROUP>
												</WTCODEGROUP>
												
												<WTCODEGROUP>
													<WTSTATIC space="1"/>
													<WTIMAGE value="CONST(GoalEdit.gif)" alt="Edit" imgalign="absmiddle">
														<WTLINK name="7004">
															<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
															<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
															<WTPARAM name="Popup" value="PARAM(Popup)"/>
														</WTLINK>
													</WTIMAGE>
												</WTCODEGROUP>

											</WTSTATIC>
											<WTSTATIC>
												<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
												<WTSTATIC space="1"/>
												<WTSTATIC fontcolor="red">
													<WTCONDITION expr="DATA(Goal.ActQty)" oper="less" value="DATA(Qty)"/>
													<WTSTATIC value="DATA(Goal.ActQty)" space="1"/>
													<WTSTATIC label="of" space="1"/>
													<WTSTATIC value="DATA(Goal.Qty)"/>
												</WTSTATIC>
												<WTSTATIC fontcolor="green">
													<WTCONDITION expr="DATA(Goal.ActQty)" oper="greater-equal" value="DATA(Qty)"/>
													<WTSTATIC value="DATA(Goal.ActQty)" space="1"/>
													<WTSTATIC label="of" space="1"/>
													<WTSTATIC value="DATA(Goal.Qty)"/>
												</WTSTATIC>
											</WTSTATIC>
		<!--
											<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;))" fontcolor="blue"/>
		-->
		<!--
											<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@parentid&quot;/&gt;))" fontcolor="purple">
												<WTCONDITION expr="DATA(Goal.ParentID)" oper="not-equal" value="CONST(0)"/>
											</WTSTATIC>
		-->
										</WTSTATIC>
										<WTSTATIC col="2" value="DATA(Goal.CommitDate)" valign="top"/>
										<WTSTATIC col="3" value="DATA(Goal.CompleteDate)" valign="top"/>
										<WTSTATIC col="4" valign="top">
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
												<WTSTATIC value="DATA(Goal.Variance)" fontcolor="green">
													<WTCONDITION expr="DATA(Goal.Variance)" oper="less" value="CONST(0)"/>
												</WTSTATIC>
												<WTSTATIC value="DATA(Goal.Variance)">
													<WTCONDITION expr="DATA(Goal.Variance)" oper="equal" value="CONST(0)"/>
												</WTSTATIC>
												<WTSTATIC value="DATA(Goal.Variance)" fontcolor="red">
													<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
												</WTSTATIC>
											</WTCODEGROUP>
										</WTSTATIC>
										<WTSTATIC col="5" value="DATA(Goal.RemindDate)" valign="top"/>
										<WTSTATIC col="6" value="DATA(Goal.Priority)" valign="top"/>
									</WTROW>
									<WTROW>
										<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
										<WTSTATIC col="1" merge="6" align="left" value="DATA(Goal.Description)" embedhtml="true"/>
									</WTROW>
									<WTROW margin-top="3" margin-bottom="3">
										<WTDIVIDER col="1" merge="6" height="1" color="SYS(box1)"/>
									</WTROW>

								</WTRECORDSET>

							</WTROW>
						</WTTABLE>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="6">
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
					<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
					<WTFRAME col="1" merge="2" src="CONST(9011.asp?Height=150&amp;amp;OwnerType=70&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@goalid&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;)" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="300" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7004" caption="Edit Goal" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--==================================================================-->
			<WTPARAM name="GoalID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>

			<WTSUB function="AddNote(prmNotes)">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="SYS(UserID)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="CONST(70)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(GoalID)"/>
					<WTSETATTRIBUTE name="ATTR(IsLocked)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(prmNotes)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- CHECK FOR ILLEGAL ACCESS -->
					<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
					<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
						<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberOnly"/>
						<WTCONDITION expr="CONST(Clng(.MemberID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
						<WTCONDITION expr="CONST(Clng(.MemberID))" oper="not-equal" value="CONST(Clng(tmpMentoringID))" connector="and"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCommitDate)" value="ATTR(CommitDate)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompleteDate)" value="ATTR(CompleteDate)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTES/>
<WTCUSTOM>
				If .Status &lt; 4 Then
					If IsDate(.CommitDate) Then
						.Status = 2
						If IsDate(.CompleteDate) Then
							.Status = 3
							.Variance = DATEDIFF("d", .CommitDate, .CompleteDate)
							.RemindDate = ""
						End If
					End If
				End If
</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpCommitDate)" oper="not-equal" value="CONST(&quot;0&quot;)"/>
							<WTCONDITION expr="CONST(tmpCommitDate)" oper="not-equal" value="ATTR(CommitDate)" connector="and"/>
							<WTCALLSUB name="AddNote(&quot;Projected Date Changed from &quot; + tmpCommitDate + &quot; to &quot; + .CommitDate)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpCompleteDate)" oper="not-equal" value="CONST(&quot;0&quot;)"/>
							<WTCONDITION expr="CONST(tmpCompleteDate)" oper="not-equal" value="ATTR(CompleteDate)" connector="and"/>
							<WTCALLSUB name="AddNote(&quot;Complete Date Changed from &quot; + tmpCompleteDate + &quot; to &quot; + .CompleteDate)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTCALLSUB name="LoadGoal">
						<WTCONDITION expr="IsErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
					</WTCALLSUB>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="and"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="and"/>
						<WTHTTP>
							<WTLINK name="0418">
								<WTPARAM name="MemberID" value="ATTR(MemberID)"/>
								<WTPARAM name="Notify" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
								<WTPARAM name="ID" value="ATTR(GoalID)"/>
							</WTLINK>
						</WTHTTP>
						<WTHTTP>
							<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
							<WTLINK name="0438">
								<WTPARAM name="MemberID" value="ATTR(MemberID)"/>
								<WTPARAM name="Notify" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
								<WTPARAM name="ID" value="ATTR(GoalID)"/>
							</WTLINK>
						</WTHTTP>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadGoal"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateGoal"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(prmParentID)" value="ATTR(ParentID)"/>
					<WTSETATTRIBUTE name="CONST(prmMemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpTemplate)" value="ATTR(Template)"/>
					<WTMETHOD name="Delete">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(2)">
						<WTCONDITION expr="NoErrors"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="CalcChildren">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(prmParentID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="GoalID" direction="input" value="CONST(prmParentID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCALLSUB name="LoadGoal">
						<WTCONDITION expr="IsErrors"/>
					</WTCALLSUB>
				</WTOBJECT>
				<!-- If we don't have a parent, return to the goal list -->
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpTemplate)" oper="equal" value="CONST(1)"/>
					<WTCONDITION expr="CONST(tmpTemplate)" oper="equal" value="CONST(2)" connector="or"/>
					<WTRETURN>
						<WTLINK name="7014" return="false">
							<WTPARAM name="CompanyID" value="CONST(tmpCompanyID)"/>
							<WTPARAM name="MemberID" value="CONST(prmMemberID)"/>
							<WTPARAM name="Template" value="CONST(tmpTemplate)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpTemplate)" oper="not-equal" value="CONST(1)"/>
					<WTCONDITION expr="CONST(tmpTemplate)" oper="not-equal" value="CONST(2)" connector="and"/>
					<WTRETURN>
						<WTCONDITION expr="CONST(prmParentID)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
						<WTLINK name="7001" return="false">
							<WTPARAM name="MemberID" value="CONST(prmMemberID)"/>
							<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
							<WTPARAM name="Popup" value="PARAM(Popup)"/>
						</WTLINK>
					</WTRETURN>
					<WTRETURN>
						<WTCONDITION expr="CONST(prmParentID)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
						<WTLINK name="7011" return="false">
							<WTPARAM name="CompanyID" value="CONST(tmpCompanyID)"/>
						</WTLINK>
					</WTRETURN>
					<!-- If we have a parent, return to the parent detail page -->
					<WTRETURN>
						<WTCONDITION expr="CONST(prmParentID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
						<WTLINK name="7003" nolocaldata="true">
							<WTPARAM name="GoalID" value="CONST(prmParentID)"/>
							<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
							<WTPARAM name="Popup" value="PARAM(Popup)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
					<WTRETURN/>
				</WTCODEGROUP>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right"/>
				<WTCOLUMN width="460" align="left"/>

				<WTROW>
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" label="GoalDeleted" align="center" class="PageHeading" fontcolor="red"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="not-equal" value="CONST(2)"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
							<WTSTATIC tag="Goal" value="ATTR(Goal.GoalName)">
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
								<WTIMAGE value="CONST(Templatemd.gif)"/>
								<WTSTATIC space="1"/>
								<WTSTATIC tag="Track" value="ATTR(Goal.GoalName)"/>
								<WTSTATIC space="1"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSGOAL/@goalid&quot;/&gt;))" fontcolor="purple"/>
							</WTCODEGROUP>
							<WTSTATIC tag="Task" value="ATTR(Goal.GoalName)">
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTIMAGE col="1" merge="2" value="CONST(Shortcut.gif)">
							<WTCONDITION expr="NotMemberOnly"/>
							<WTCONDITION expr="_IsShortcuts" connector="or"/>
							<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
								<WTPARAM name="EntityID" value="ENTITY(Goal)"/>
								<WTPARAM name="ItemID" value="ATTR(Goal.GoalID)"/>
								<WTPARAM name="Name" value="ATTR(Goal.GoalName)" clean="true"/>
								<WTPARAM name="URL" value="SYS(PageURL)"/>
							</WTLINK>
						</WTIMAGE>

						<WTSTATIC col="1" merge="2">
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)" connector="or"/>
								<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
									<WTLINK name="Tutorial" target="Tutorial">
										<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-GOALS)"/>
										<WTPARAM name="contentpage" value="CONST(3)"/>
										<WTPARAM name="popup" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>

						<WTSTATIC col="1" merge="2" label="Updated" fontcolor="red">
							<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC col="1" merge="2" label="Deleted" fontcolor="red">
							<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" btnclass="smbutton">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
					</WTROW>

					<WTROW>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
						<WTSTATIC col="1" tag="GoalID" height="18"/>
						<WTSTATIC col="2" value="ATTR(Goal.GoalID)" bold="true"/>
						<WTSTATIC col="2" value="ATTR(Goal.CreateDate)" fontcolor="purple"/>
						<WTSTATIC col="2" tag="AssignName"/>
						<WTSTATIC col="2" value="ATTR(Goal.AssignName)" fontcolor="blue" prespace="false"/>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr="IsEmployee"/>
						<WTROW>
							<WTSTATIC col="1" tag="CompanyID"/>
							<WTTEXT col="2" value="ATTR(Goal.CompanyID)" size="5"/>
							<WTSTATIC col="2" label="ForTemplate"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="MemberID"/>
							<WTTEXT col="2" value="ATTR(Goal.MemberID)" size="5"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="ParentID"/>
							<WTTEXT col="2" value="ATTR(Goal.ParentID)" size="5"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="AssignID"/>
							<WTTEXT col="2" value="ATTR(Goal.AssignID)" size="5"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Template"/>
							<WTTEXT col="2" value="ATTR(Goal.Template)" size="5"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="ProspectID"/>
							<WTTEXT col="2" value="ATTR(Goal.ProspectID)" size="5"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Status"/>
							<WTCOMBO col="2" value="ATTR(Goal.Status)"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW>
						<WTCONDITION expr="NotEmployee"/>
						<WTHIDDEN value="ATTR(Goal.CompanyID)"/>
						<WTHIDDEN value="ATTR(Goal.MemberID)"/>
						<WTHIDDEN value="ATTR(Goal.ParentID)"/>
						<WTHIDDEN value="ATTR(Goal.AssignID)"/>
						<WTHIDDEN value="ATTR(Goal.ProspectID)"/>
						<WTHIDDEN value="ATTR(Goal.Template)"/>
						<WTHIDDEN value="ATTR(Goal.Status)"/>
					</WTROW>

					<WTROW>
						<WTSTATIC col="1">
							<WTSTATIC tag="Goal">
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC tag="Track">
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
							</WTSTATIC>
							<WTSTATIC tag="Task">
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTTEXT col="2" value="ATTR(Goal.GoalName)" size="60" focus="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="GoalType"/>
						<WTCOMBO col="2" value="ATTR(Goal.GoalType)"/>
						<WTSTATIC col="2" tag="Priority"/>
						<WTCOMBO col="2" value="ATTR(Goal.Priority)" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
						<WTSTATIC col="1" tag="Qty"/>
						<WTTEXT col="2" value="ATTR(Goal.Qty)" size="3" prespace="false"/>
						<WTSTATIC col="2" tag="ActQty"/>
						<WTTEXT col="2" value="ATTR(Goal.ActQty)" size="3" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CommitDate"/>
						<WTTEXT col="2" value="ATTR(Goal.CommitDate)"/>
						<WTSTATIC col="2">
							<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTCONDITION expr="ATTR(Goal.Template)" oper="not-equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="and"/>
							<WTSTATIC tag="CompleteDate"/>
							<WTCODEGROUP>
								<WTTEXT value="ATTR(Goal.CompleteDate)"/>
							</WTCODEGROUP>
						</WTSTATIC>	
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="RemindDate"/>
						<WTTEXT col="2" value="ATTR(Goal.RemindDate)"/>
					</WTROW>

					<WTROW>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
						<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)" connector="or"/>
						<WTSTATIC col="1" tag="CreateDate"/>
						<WTTEXT col="2" value="ATTR(Goal.CreateDate)"/>
					</WTROW>

					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Goal.Description)" cols="72" rows="8" htmleditor="true" embedhtml="true"/>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="6">
						<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Close)">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" align="center" msg="ConfirmDelete"/>

	<!--
							<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
							<WTCONDITION expr="IsEmployee" connector="or"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							<WTCONDITION expr="IsMemberBusiness" connector="or" paren="start"/>
							<WTCONDITION expr="ATTR(Goal.MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and" paren="end"/>
						</WTBUTTON>
	-->
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7005" caption="Success Track" contentpage="1" focus="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="ProspectID" datatype="number"/>
			<WTPARAM name="TMemberID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="TList" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)"/>
			</WTCODEGROUP>

			<WTSUB name="NewGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AssignID)" value="SYS(UserID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(TMemberID)" value="ATTR(MentorID)">
						<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="EnumCompanyList">
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(0)"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Template" direction="input" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						</WTMETHOD>
						<WTMETHOD name="EnumMemberList">
							<WTCONDITION expr="PARAM(TList)" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(TMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="MemberID" direction="input" value="PARAM(TMemberID)"/>
							<WTPARAM name="Template" direction="input" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="EnumCompanyList">
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(0)"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Template" direction="input" value="SYSCON(TEMPLATE-PROSPECT)"/>
							<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						</WTMETHOD>
						<WTMETHOD name="EnumMemberList">
							<WTCONDITION expr="PARAM(TList)" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(TMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="MemberID" direction="input" value="PARAM(TMemberID)"/>
							<WTPARAM name="Template" direction="input" value="SYSCON(TEMPLATE-PROSPECT)"/>
							<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewGoal"/>
			</WTACTION>

			<WTACTION id="4" name="Copy" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpGoalName)" value="FORM(GoalName)"/>
				<WTSETATTRIBUTE name="CONST(tmpGoalID)" value="FORM(CompanyID)"/>
				<WTSETATTRIBUTE name="CONST(tmpGoalID)" value="FORM(GoalID)">
					<WTCONDITION expr="CONST(tmpGoalID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTCONDITION expr="CONST(tmpGoalID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Copy">
						<WTPARAM name="GoalID" direction="input" value="CONST(tmpGoalID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)"/>
						<WTPARAM name="GoalName" direction="input" value="CONST(tmpGoalName)"/>
						<WTPARAM name="UserID" direction="input" value="SYS(UserID)"/>
						<WTPARAM name="CopyGoalID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpGoalID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="NoErrors" connector="and"/>
					<WTRETURN>
						<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)"/>
						<WTLINK name="7001" return="false">
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
							<WTPARAM name="Popup" value="PARAM(Popup)"/>
						</WTLINK>
					</WTRETURN>
					<WTRETURN>
						<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="7013" return="false">
							<WTPARAM name="ProspectID" value="PARAM(ProspectID)"/>
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				<WTCALLSUB name="NewGoal">
					<WTCONDITION expr="CONST(tmpGoalID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="IsErrors" connector="or"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right"/>
				<WTCOLUMN width="460" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Templatemd.gif)"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="GoalTemplate"/>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
								<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)" connector="or"/>
								<WTSTATIC space="1"/>
								<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absbottom">
									<WTLINK name="Tutorial" target="Tutorial">
										<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-TRACKS)"/>
										<WTPARAM name="contentpage" value="CONST(3)"/>
										<WTPARAM name="popup" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="CopyGoalTemplate" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="SelectTemplates" align="center" bold="true"/>
				</WTROW>

				<WTROW margin-bottom="6">
				 	<WTRADIO col="1" merge="2" group="TList" name="0" align="center" check="/DATA/PARAM/@tlist=0">
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTRADIO>
					<WTSTATIC col="1" label="CompanyTemplates" prespace="false"/>
				 	<WTRADIO col="1" group="TList" name="1" check="/DATA/PARAM/@tlist=1">
						<WTCONDITION expr="ATTR(Member.MentorID)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTRADIO>
					<WTSTATIC col="1" label="MentorTemplates" prespace="false">
						<WTCONDITION expr="ATTR(Member.MentorID)" oper="not-equal" value="CONST(0)"/>
					</WTSTATIC>
				 	<WTRADIO col="1" group="TList" name="2" check="/DATA/PARAM/@tlist=2">
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTRADIO>
					<WTSTATIC col="1" label="MemberTemplates" prespace="false"/>
					<WTTEXT col="1" value="PARAM(TMemberID)" size="3"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC label="SelectFrom" space="1"/>
						<WTSTATIC label="CompanyTemplates">
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="MentorTemplates">
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(2)"/>
							<WTSTATIC label="MemberTemplates"/>
							<WTSTATIC value="PARAM(TMemberID)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSGOALS/ENUM))" oper="greater" value="CONST(1)" />
					<WTROW>
						<WTSTATIC col="1" tag="CopyTemplate"/>
						<WTCOMBO col="2" value="ATTR(Goal.CompanyID)" datapath="/DATA/TXN/PTSGOALS/ENUM" align="left">
							<WTCHANGE>document.getElementById('GoalName').value = this.options[this.selectedIndex].text;</WTCHANGE>
						</WTCOMBO>
						<WTBUTTON col="2" value="CONST(Preview)" btnclass="smbutton">
							<WTCLICK>
						var url, win, g;
						g = Goal.CompanyID.value
						if( g != 0 ) {
							url = "7012.asp?goalid=" + g
							win = window.open(url,'Template');
							win.focus();
						}
							</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="NewName"/>
						<WTTEXT col="2" value="ATTR(Goal.GoalName)" required="false"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSGOALS/ENUM))" oper="less-equal" value="CONST(1)" />
					<WTSTATIC col="1" merge="2" label="NoTemplates" fontcolor="red" bold="true" align="center"/>
				</WTROW>
<!--
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" label="Or" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CopyGoalID"/>
					<WTTEXT col="2" value="ATTR(Goal.GoalID)" size="5" required="false"/>
					<WTBUTTON col="2" value="CONST(Preview)" btnclass="smbutton">
						<WTCLICK>
					var url, win, g;
					g = Goal.GoalID.value
					if( g != 0 ) {
						url = "7012.asp?goalid=" + g
						win = window.open(url,'Template');
						win.focus();
					}
						</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
-->
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Join)" align="center">
						<WTCONDITION expr="IsActive"/>
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSGOALS/ENUM))" oper="greater" value="CONST(1)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7006" caption="Check Copy Track" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="TrackID" datatype="number"/>
			<WTPARAM name="ProspectID" datatype="number"/>
			<WTPARAM name="GoalID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<!-- Check if this member has already registered this track -->
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(TrackID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="CheckTrack">
						<WTPARAM name="reqGoalID" direction="return" datatype="number"/>
						<WTPARAM name="ParentID" direction="input" value="PARAM(TrackID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<!-- If the returned goal # < 0, the member's group has a replacement track -->
					<!-- The returned negative goal #, it is the replacement track (negated) -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(GoalID)" oper="less" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(TrackID)" value="CONST(ABS(reqGoalID))"/>
						<WTSETATTRIBUTE name="PARAM(GoalID)" value="CONST(0)"/>
					</WTCODEGROUP>
					<!-- If no goal was found, then copy the track -->
					<WTMETHOD name="Copy">
						<WTCONDITION expr="PARAM(GoalID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="GoalID" direction="input" value="PARAM(TrackID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)"/>
						<WTPARAM name="GoalName" direction="input" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="UserID" direction="input" value="SYS(UserID)"/>
						<WTPARAM name="reqGoalID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="PARAM(GoalID)" oper="not-equal" value="CONST(0)"/>
					<WTLINK name="7050">
						<WTPARAM name="GoalID" value="PARAM(GoalID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" label="CopyTrackError" class="PageHeading" align="center" fontcolor="red"/>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" label="MemberID" value="PARAM(MemberID)"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" label="TrackID" value="PARAM(TrackID)"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" label="#" value="PARAM(GoalID)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7007" caption="Document" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="GoalID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>

			<WTSUB name="LoadGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqGoalID &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Goals\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="SaveGoal">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqGoalID &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Goals\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadGoal"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="SaveGoal"/>
				<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTSTATIC col="1" align="left" class="PageHeading">
						<WTSTATIC value="ATTR(Goal.GoalName)"/>
						<WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Updated" fontcolor="red">
								<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				
				<WTROW>
					<WTMEMO col="1" align="left" value="ATTR(HTMLFile.Data)" cols="90" rows="30" htmleditor="true" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7008" caption="Document" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="GoalID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqGoalID &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Goals\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTSTATIC col="1" align="left" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="7011" caption="Success Tracks" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="22">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="ListTemplate">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="300" align="right"/>

				<WTROW>
					<WTSTATIC col="1" label="GoalTemplates" class="PageHeading" align="left"/>
					<WTLINKGROUP col="2" align="right">
						<WTCONDITION expr="IsActive"/>
						<WTLINK name="7002" label="NewGoalTemplate">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						</WTLINK>
					</WTLINKGROUP>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Goal">
						<WTCOLUMN width="5" align="center" valign="top"/>
						<WTCOLUMN width="10" align="left" valign="top"/>
						<WTCOLUMN width="85" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Template.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Goal.GoalID)"/>
							<WTSTATIC col="3" value="DATA(Goal.GoalName)">
								<WTLINK name="7003">
									<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="7012" caption="Preview Goal" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="GoalID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="Goals">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)" />
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				<WTROW>
					<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
						<WTCOLUMN width="50" align="left"/>
						<WTCOLUMN width="50" align="left"/>
						<WTCOLUMN width="50" align="left"/>
						<WTCOLUMN width="50" align="left"/>
						<WTCOLUMN width="550" align="left"/>
						<WTROW>
							<WTSTATIC col="1" merge="5" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalPreview.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC value="ATTR(Goal.GoalName)"  fontcolor="darkblue" bold="true"/>
							</WTSTATIC>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
							<WTROW margin-top="3">
								<WTCONDITION expr="ATTR(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
								<WTSTATIC col="1" merge="5" align="left" value="ATTR(Goal.Description)" embedhtml="true"/>
							</WTROW>
							<WTROW margin-top="3" margin-bottom="6">
								<WTDIVIDER col="1" merge="5" height="1" color="SYS(box)"/>
							</WTROW>
						</WTCODEGROUP>

						<WTREPEAT entity="Goal">
							<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="PARAM(GoalID)"/>	
							<WTROW class="graybar">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="4">
									<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@qty&quot;/&gt;))">
										<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
										<WTSTATIC newline="1"/>
										<WTSTATIC value="DATA(Goal.Description)" embedhtml="true" space="1"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="3" margin-bottom="3">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" merge="4" height="1" color="SYS(box)"/>
							</WTROW>

							<WTREPEAT entity="Goal">
								<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="DATA(Current.GoalID)"/>
								<WTROW>
									<WTSTATIC col="1" merge="2"/>
									<WTSTATIC col="3" merge="3">
										<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
										<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@qty&quot;/&gt;))">
											<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
											<WTSTATIC newline="1"/>
											<WTSTATIC value="DATA(Goal.Description)" embedhtml="true" space="1"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-top="3" margin-bottom="3">
									<WTSTATIC col="1" merge="2"/>
									<WTDIVIDER col="3" merge="3" height="1" color="SYS(headerdivider)"/>
								</WTROW>

								<WTREPEAT entity="Goal">
									<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="DATA(Current.GoalID)"/>
									<WTROW class="graybar">
										<WTSTATIC col="1" merge="3"/>
										<WTSTATIC col="4" merge="2">
											<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
											<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@qty&quot;/&gt;))">
												<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
											</WTSTATIC>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
												<WTSTATIC newline="1"/>
												<WTSTATIC value="DATA(Goal.Description)" embedhtml="true" space="1"/>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTROW>
									<WTROW margin-top="3" margin-bottom="3">
										<WTSTATIC col="1" merge="3"/>
										<WTDIVIDER col="4" merge="2" height="1" color="SYS(headerdivider)"/>
									</WTROW>

									<WTREPEAT entity="Goal">
										<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="DATA(Current.GoalID)"/>
										<WTROW>
											<WTSTATIC col="1" merge="4"/>
											<WTSTATIC col="5">
												<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
												<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@qty&quot;/&gt;))">
													<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
												</WTSTATIC>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
													<WTSTATIC newline="1"/>
													<WTSTATIC value="DATA(Goal.Description)" embedhtml="true" space="1"/>
												</WTCODEGROUP>
											</WTSTATIC>
										</WTROW>
										<WTROW margin-top="3" margin-bottom="3">
											<WTSTATIC col="1" merge="4"/>
											<WTDIVIDER col="5" height="1" color="SYS(headerdivider)"/>
										</WTROW>

									</WTREPEAT>
								</WTREPEAT>
							</WTREPEAT>
						</WTREPEAT>

					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6">
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" align="left" tag="Total" value="PARAM(Count)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="7013" caption="Customer Goals" page-width="580" page-left="0" margin-width="0"
		 navbar="false" header="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="ProspectID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="ListProspect">
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="left"/>
				<WTCOLUMN width="380" align="right"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" align="right">
							<WTCODEGROUP>
								<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle"/>
								<WTSTATIC space="1"/>
								<WTSTATIC label="NewFollowupGoal">
									<WTLINK name="7002">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="ProspectID" value="PARAM(ProspectID)"/>
										<WTPARAM name="ContentPage" value="CONST(1)"/>
									</WTLINK>
								</WTSTATIC>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTIMAGE value="CONST(template.gif)" imgalign="absmiddle"/>
								<WTSTATIC space="1"/>
								<WTSTATIC label="FollowupTemplate">
									<WTLINK name="7005">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="ProspectID" value="PARAM(ProspectID)"/>
										<WTPARAM name="ContentPage" value="CONST(1)"/>
									</WTLINK>
								</WTSTATIC>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Goal">
						<WTCOLUMN width="58" align="left" valign="top" label="FollowupGoal"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Projected"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Actual"/>
						<WTCOLUMN width="8" align="center" valign="top" label="Variance"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
									<WTCONDITION expr="DATA(Goal.Status)" oper="not-equal" value="SYSCON(GOAL-STATUS-CANCEL)" connector="and"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GreenChecksm.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(RedChecksm.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(RedX.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-CANCEL)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(foldersm.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Goal.ParentID)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>

								<WTSTATIC value="DATA(Goal.GoalName)" space="1">
									<WTLINK name="7050" target="Preview">
										<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalPreview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="7050" target="Preview">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
										</WTLINK>
									</WTIMAGE>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalEdit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="7003" target="Goal">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
<!--								
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;))" fontcolor="blue"/>
-->
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Children)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(GoalChildren.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>

								<WTSTATIC>
									<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC fontcolor="red">
										<WTCONDITION expr="DATA(Goal.ActQty)" oper="less" value="DATA(Qty)"/>
										<WTSTATIC value="DATA(Goal.ActQty)" space="1"/>
										<WTSTATIC label="of" space="1"/>
										<WTSTATIC value="DATA(Goal.Qty)"/>
									</WTSTATIC>
									<WTSTATIC fontcolor="green">
										<WTCONDITION expr="DATA(Goal.ActQty)" oper="greater-equal" value="DATA(Qty)"/>
										<WTSTATIC value="DATA(Goal.ActQty)" space="1"/>
										<WTSTATIC label="of" space="1"/>
										<WTSTATIC value="DATA(Goal.Qty)"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Goal.Priority)" valign="top"/>
							<WTSTATIC col="3" value="DATA(Goal.CommitDate)" valign="top"/>
							<WTSTATIC col="4" value="DATA(Goal.CompleteDate)" valign="top"/>
							<WTSTATIC col="5" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
									<WTSTATIC value="DATA(Goal.Variance)" fontcolor="green">
										<WTCONDITION expr="DATA(Goal.Variance)" oper="less" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Goal.Variance)">
										<WTCONDITION expr="DATA(Goal.Variance)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Goal.Variance)" fontcolor="red">
										<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
<!--
				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
-->
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="7014" caption="Success Tracks" contentpage="true" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Template" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="ListMemberTrack">
				 		<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Template" direction="input" value="PARAM(Template)"/>
					</WTMETHOD>
					<WTMETHOD name="ListCompanyTrack">
				 		<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Template" direction="input" value="PARAM(Template)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="300" align="right"/>

				<WTSTATIC label="Export"/>
				<WTSTATIC label="EditTrack"/>
				<WTSTATIC label="EditGoal"/>

				<WTROW>
					<WTSTATIC col="1" class="PageHeading" align="left">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Template.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTCODEGROUP>
					 		<WTCONDITION expr="PARAM(Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTSTATIC label="MemberSuccessTracks"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
					 		<WTCONDITION expr="PARAM(Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)"/>
							<WTSTATIC label="ProspectSuccessTracks"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
								<WTLINK name="Tutorial" target="Tutorial">
									<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-CUSTOMTRACKS)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
									<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
					<WTSTATIC col="2" align="right" bold="true">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="NewGoalTemplate">
								<WTLINK name="7002">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="Template" value="PARAM(Template)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
			 				<WTCONDITION expr="IsEmployee"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(import.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Import">
								<WTLINK name="70Import" target="Import">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="prompt" align="left">
						<WTCODEGROUP>
					 		<WTCONDITION expr="PARAM(Template)" oper="equal" value="SYSCON(TEMPLATE-MEMBER)"/>
							<WTSTATIC label="MemberSuccessTrackText"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
					 		<WTCONDITION expr="PARAM(Template)" oper="equal" value="SYSCON(TEMPLATE-PROSPECT)"/>
							<WTSTATIC label="ProspectSuccessTrackText"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Goal">
						<WTCOLUMN width="10" align="center" valign="top"/>
						<WTCOLUMN width="90" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Template.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Goal.GoalName)"/>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="EditTrack" imgalign="absmiddle">
										<WTLINK name="7003">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalEdit.gif)" alt="EditGoal" imgalign="absmiddle">
										<WTLINK name="7004">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
											<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalPreview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="7012" target="Preview">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
							 		<WTCONDITION expr="IsEmployee"/>
									<WTIMAGE value="CONST(ArrowDown.gif)" alt="Export" imgalign="absmiddle">
										<WTLINK name="ExportGoal" target="Export">
											<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="70Import" caption="Import Track" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="Cnt" datatype="number"/>

			<WTACTION id="1" name="Update" type="Update">
				<WTRETURN>
					<WTLINK name="ImportGoal" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="ImportTrack"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="prompt" align="center">
							<WTSTATIC label="ImportTrackText"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC tag="Company" value="PARAM(CompanyID)" newline="1"/>
							<WTSTATIC tag="Member" value="PARAM(MemberID)"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC value="PARAM(Cnt)" space="1"/>
							<WTSTATIC label="ImportSuccess"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Import)" align="center">
				 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--==================================================================-->
		<WTWEBPAGE name="7020" caption="Goal Reports" form="Report" header="false" footer="false" navbar="false"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="7020">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MasterID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="AssessmentID" datatype="number"/>
			<WTPARAM name="MemberName" datatype="text"/>
			<WTPARAM name="BusinessName" datatype="text"/>
			<WTPARAM name="GoalType" datatype="number"/>
			<WTPARAM name="Priority" datatype="number"/>
<!--			<WTPARAM name="M" datatype="number"/>-->
			  
			<WTACTION id="0" name="New" type="New">
				<!-- SAVE MEMBERID BEING MENTORED -->
<!--
				<WTSETCACHE name="MentoringID" value="PARAM(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTSETCACHE>
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
-->
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2010&quot;"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)"/>
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)"/>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="CONST(0)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(MemberName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
						<WTSETATTRIBUTE name="PARAM(MasterID)" value="ATTR(MasterID)">
							<WTCONDITION expr="PARAM(MasterID)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)">
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MasterID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(BusinessName)" value="ATTR(CompanyName)"/>
						<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)">
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
				</WTOBJECT>
<!--
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
-->				
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="225" align="right"/>
				<WTCOLUMN width="525" align="left"/>
			
				<WTFUNCTION name="CreateReport( page, target, options )">
					var url;
					var win;
					url = page + ".asp?CompanyID=" + Report.CompanyID.value + "&amp;MasterID=" + Report.MasterID.value + "&amp;MemberID=" + Report.MemberID.value + "&amp;FromDate=" + Report.FromDate.value + "&amp;ToDate=" + Report.ToDate.value;
					if ( options ) url += "&amp;" + options;
					win = window.open(url,target);
					win.focus();
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MasterID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" label="GoalReports" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="ReportText" align="left" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="ReportOn"/>
					<WTCOMBO col="2" name="Term" value="PARAM(Term)" prespace="false">
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="UptoToday"/>
						<WTOPTION id="4" label="PrevWeek"/>
						<WTOPTION id="5" label="PrevMonth"/>
						<WTOPTION id="6" label="PrevYear"/>
						<WTOPTION id="7" label="WeekToDate"/>
						<WTOPTION id="8" label="MonthToDate"/>
						<WTOPTION id="9" label="YearToDate"/>
<!--						
						<WTOPTION id="10" label="Tomorrow"/>
						<WTOPTION id="11" label="Next7Days"/>
						<WTOPTION id="12" label="Next14Days"/>
						<WTOPTION id="13" label="Next30Days"/>
-->						
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="2" tag="From"/>
					<WTTEXT col="2" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" prespace="false"/>
					<WTSTATIC col="2" tag="To"/>
					<WTTEXT col="2" value="PARAM(ToDate)" name="ToDate" type="date" size="8" prespace="false"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="24">
					<WTSTATIC col="1" tag="GoalType"/>
					<WTCOMBO col="2" value="PARAM(GoalType)" prespace="false">
						<WTOPTION id="0" label="All"/>
						<WTOPTION id="1" label="Company"/>
						<WTOPTION id="2" label="Department"/>
						<WTOPTION id="3" label="Individual"/>
					</WTCOMBO>
					<WTSTATIC col="2" tag="Priority"/>
					<WTCOMBO col="2" value="PARAM(Priority)" prespace="false">
						<WTOPTION id="0" label="All"/>
						<WTOPTION id="1" label="High"/>
						<WTOPTION id="2" label="Medium"/>
						<WTOPTION id="3" label="Low"/>
					</WTCOMBO>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="IsEmployee" connector="or"/>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTBUTTON col="1" merge="2" align="center">
							<WTSTATIC value="PARAM(MemberName)" spacex="1"/>
							<WTSTATIC label="DetailReport"/>
							<WTCLICK>CreateReport("7021","Report","report=1");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberBusiness"/>
						<WTCONDITION expr="IsEmployee" connector="or"/>
						<WTROW margin-bottom="12">
							<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="CONST(0)"/>
							<WTBUTTON col="1" merge="2" align="center">
								<WTSTATIC value="PARAM(BusinessName)" spacex="1"/>
								<WTSTATIC label="SummaryReport"/>
								<WTCLICK>CreateReport("7021","Report","report=2");</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>
<!--
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTROW margin-bottom="12">
							<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
							<WTBUTTON col="1" merge="2" align="center">
								<WTSTATIC value="ATTR(Company.CompanyName)" spacex="1"/>
								<WTSTATIC label="SummaryReport"/>
								<WTCLICK>CreateReport("7021","Report","report=3");</WTCLICK>
							</WTBUTTON>
						</WTROW>
				</WTCODEGROUP>
-->
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7021" caption="Goal Report" header="false" footer="false" navbar="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="7021">
		<!--==================================================================-->
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MasterID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="GoalType" datatype="number"/>
			<WTPARAM name="Priority" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqReport &lt; 1 OR reqReport &gt; 3 Then reqReport = 1
				If NOT IsDate(reqFromDate) OR NOT IsDate(reqToDate) Then
					reqFromDate = CDate( DateAdd("d", -1, Date()) )
					reqToDate = CDate( Date() )
				End If
</WTCUSTOM>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="ReportMember">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="GoalType" direction="input" value="PARAM(GoalType)"/>
						<WTPARAM name="Priority" direction="input" value="PARAM(Priority)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportBusiness">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="MasterID" direction="input" value="PARAM(MasterID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="GoalType" direction="input" value="PARAM(GoalType)"/>
						<WTPARAM name="Priority" direction="input" value="PARAM(Priority)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportCompany">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="GoalType" direction="input" value="PARAM(GoalType)"/>
						<WTPARAM name="Priority" direction="input" value="PARAM(Priority)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MasterID" direction="input" value="PARAM(MasterID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(CompanyName)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(CompanyName)"/>
				</WTOBJECT>

			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6"/>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="GoalMemberReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" label="GoalBusinessReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
					<WTSTATIC col="1" merge="2" label="GoalCompanyReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="PARAM(Title)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" class="BoldText">
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>
<!--
				<WTROW>
					<WTLINKGROUP  col="1" merge="2" align="right" >
						<WTLINK name="7002" label="NewGoal" class="PageHeadingLink" target="goal">
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						</WTLINK>
					</WTLINKGROUP>
				</WTROW>
-->
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Goal">
						<WTCOLUMN width="50" align="left" valign="top" label="GoalName"/>
						<WTCOLUMN width="10" align="left" valign="top" label="GoalType"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Committed"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Completed"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Variance"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
									<WTCONDITION expr="DATA(Goal.Status)" oper="not-equal" value="SYSCON(GOAL-STATUS-CANCEL)" connector="and"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GreenChecksm.gif)">
											<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(RedChecksm.gif)">
											<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(RedX.gif)">
										<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-CANCEL)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Primary.gif)">
										<WTCONDITION expr="DATA(Goal.ParentID)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Goal.GoalName)">
									<WTLINK name="7003" target="goal"><WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@assignname&quot;/&gt;))" fontcolor="blue"/>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Goal.GoalType)"/>
							<WTSTATIC col="3" value="DATA(Goal.Priority)"/>
							<WTSTATIC col="4" value="DATA(Goal.CommitDate)"/>
							<WTSTATIC col="5" value="DATA(Goal.CompleteDate)"/>
							<WTSTATIC col="6">
								<WTSTATIC value="DATA(Goal.Variance)">
									<WTCONDITION expr="DATA(Goal.CompleteDate)" oper="not-equal" value="CONST('')"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="6" value="DATA(Goal.Description)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Goal">
<!--						<WTCOLUMN width="40" align="left" valign="top" label="Group"/>-->
						<WTCOLUMN width="20" align="left" valign="top" label="Role"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Total"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Ontime"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Late"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Variance"/>
						<WTROW>
<!--							<WTSTATIC col="1" value="DATA(Goal.GoalName)"/>-->
							<WTSTATIC col="1" value="DATA(Goal.MemberName)"/>
							<WTSTATIC col="2" value="DATA(Goal.Num1)"/>
							<WTSTATIC col="3" value="DATA(Goal.Num2)"/>
							<WTSTATIC col="4" value="DATA(Goal.Num3)"/>
							<WTSTATIC col="5" value="DATA(Goal.Variance)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Goal">
						<WTCOLUMN width="40" align="left" valign="top" label="Business"/>
						<WTCOLUMN width="12" align="left" valign="top" label="Role"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Total"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Ontime"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Late"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Variance"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Goal.GoalName)"/>
							<WTSTATIC col="2" value="DATA(Goal.MemberName)"/>
							<WTSTATIC col="3" value="DATA(Goal.Num1)"/>
							<WTSTATIC col="4" value="DATA(Goal.Num2)"/>
							<WTSTATIC col="5" value="DATA(Goal.Num3)"/>
							<WTSTATIC col="5" value="DATA(Goal.Variance)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="GoalReminder" worker="true" navbar="false" header="false" footer="false"
			aspstyle="GenerateWebASP.xsl">
		<!--==================================================================-->
			<WTPARAM name="RemindDate" datatype="date"/>

			<WTINCLUDE name="Comm.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(RemindDate)" value="CONST(Date())">
					<WTCONDITION expr="PARAM(RemindDate)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
				
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="Reminder">
						<WTPARAM name="RemindDate" direction="input" value="PARAM(RemindDate)"/>
					</WTMETHOD>
<WTCUSTOM>
				Set oMail = server.CreateObject("CDO.Message")
				If oMail Is Nothing Then
					DoError Err.Number, Err.Source, "Unable to Create Object - CDO.Message"
				Else
					oMail.Sender = tmpSender
					For Each oGoal in oGoals
						tmpMsgTo = ""
						With oGoal
							tmpFrom = .FromEmail
							tmpTo = .Email
							If .IsMsg &lt;&gt; "0" Then tmpMsgTo = .MemberID
							tmpBody = ""
							If .ProspectName = "" Then
								tmpSubject = "GOAL due: " + .CommitDate + " - " + .GoalName
							Else
								tmpSubject = "SERVICE due: " + .CommitDate + " - " + .GoalName
								tmpBody = "Service for: " + .ProspectName + "&lt;BR&gt;"
							End If	
							tmpBody = tmpBody + .Description
						End With
						'check for valid to email address
						If InStr(tmpTo, "@") &gt; 0 Then
							With oMail
								.From = tmpFrom
								.To = tmpTo
								.Subject = tmpSubject 
								.HTMLBody = tmpBody
								.Send
							End With
						End If
						If tmpMsgTo &lt;&gt; "" Then
							SendMsg 1, tmpMsgTo, tmpSubject, tmpBody 
						End If
					Next
				End If
				Set oMail = Nothing
</WTCUSTOM>
				</WTOBJECT>

<WTCUSTOM>
		Response.end
</WTCUSTOM>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="7050" caption="Goal Preview" navbar="false" langfile="7050"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="GoalID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			
			<WTSUB name="LoadPreview">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="Preview">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadPreview"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
<WTCUSTOM>
				If Request.Form.Item( .GoalID ) = "on" Then
					If .Status = 0 Then .Status = 1
					.Status = CLng(.Status) + 1
					.UpdateStatus CLng(.GoalID), .Status, .ActQty
					If .Status = 3 Then
						Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
						If oHTTP Is Nothing Then
							DoError Err.Number, Err.Source, "Unable to Create HTTP Object - MSXML2.ServerXMLHTTP"
						Else
							tmpServer = "http://" + reqSysServerName + reqSysServerPath
							oHTTP.open "GET", tmpServer + "0418.asp" &amp; "?MemberID=" &amp; reqMemberID &amp; "&amp;Notify=" &amp; 4 &amp; "&amp;ID=" &amp; .GoalID
							oHTTP.send
							If reqSysMemberID &lt;&gt; reqMemberID Then
								tmpServer = "http://" + reqSysServerName + reqSysServerPath
								oHTTP.open "GET", tmpServer + "0438.asp" &amp; "?MemberID=" &amp; reqMemberID &amp; "&amp;Notify=" &amp; 4 &amp; "&amp;ID=" &amp; .GoalID
								oHTTP.send
							End If
						End If
						Set oHTTP = Nothing
					End If
				End If
</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTMETHOD name="Preview">
						<WTPARAM name="GoalID" direction="input" value="PARAM(GoalID)" />
					</WTMETHOD>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					DoError Err.Number, Err.Source, "Unable to Create HTTP Object - MSXML2.ServerXMLHTTP"
				Else
					For Each oGoal in oGoals
						With oGoal
							tmpID = Request.Form.Item(.GoalID)
							tmpActQty = Request.Form.Item( "Q" + .GoalID )
							If tmpActQty = "" Then tmpActQty = "0" Else tmpActQty = CStr(tmpActQty)
							tmpUpdate = 0
							If tmpID = "on" Then
								If .Status = 0 Then .Status = 1
								.Status = CLng(.Status) + 1
								tmpUpdate = 1
							End If
							If tmpActQty &lt;&gt; .ActQty Then
								.ActQty = tmpActQty
								tmpUpdate = 1
							End If   
							If tmpUpdate = 1 Then
								.UpdateStatus CLng(.GoalID), .Status, .ActQty
							End If
							If tmpID &gt; 0 AND .Status = 3 Then
								tmpServer = "http://" + reqSysServerName + reqSysServerPath
								oHTTP.open "GET", tmpServer + "0418.asp" &amp; "?MemberID=" &amp; reqMemberID &amp; "&amp;Notify=" &amp; 4 &amp; "&amp;ID=" &amp; .GoalID
								oHTTP.send
								If reqSysMemberID &lt;&gt; reqMemberID Then
									tmpServer = "http://" + reqSysServerName + reqSysServerPath
									oHTTP.open "GET", tmpServer + "0438.asp" &amp; "?MemberID=" &amp; reqMemberID &amp; "&amp;Notify=" &amp; 4 &amp; "&amp;ID=" &amp; .GoalID
									oHTTP.send
								End If
							End If
						End With
					Next
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
				</WTOBJECT>
				<WTCALLSUB name="LoadPreview"/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW margin-bottom="6">
					<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="530" align="center"/>
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="10" align="center"/>
						<WTROW>
							<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(GoalPreview.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC value="ATTR(Goal.GoalName)"  fontcolor="darkblue" bold="true"/>
								<WTCODEGROUP>
									<WTCONDITION expr="NotMemberOnly"/>
									<WTCONDITION expr="_IsShortcuts" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Shortcut.gif)">
										<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
											<WTPARAM name="EntityID" value="ENTITY(Goal)"/>
											<WTPARAM name="ItemID" value="ATTR(Goal.GoalID)"/>
											<WTPARAM name="Name" value="ATTR(Goal.GoalName)" clean="true"/>
											<WTPARAM name="URL" value="SYS(PageURL)"/>
											<WTPARAM name="IsPopup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPinnacleTutorial"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="CONST(0)"/>
										<WTCONDITION expr="ATTR(Goal.Template)" oper="equal" value="SYSCON(TEMPLATE-TASK)" connector="or"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
											<WTLINK name="Tutorial" target="Tutorial">
												<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-GOALS)"/>
												<WTPARAM name="contentpage" value="CONST(3)"/>
												<WTPARAM name="popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left">
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Goal.ProspectID)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC value="ATTR(Goal.ProspectName)" fontcolor="purple"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
									<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="or"/>
									<WTSTATIC tag="CommitDate"/>
									<WTSTATIC value="ATTR(Goal.CommitDate)"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(GreenChecksm.gif)"/>
										<WTSTATIC fontcolor="green" space="1">
											<WTSTATIC value="ATTR(Goal.CompleteDate)" space="1"/>
											<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/TXN/PTSGOAL/@variance&quot;/&gt;))"/>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Goal.Variance)" oper="greater" value="CONST(0)"/>
										<WTIMAGE value="CONST(RedChecksm.gif)"/>
										<WTSTATIC fontcolor="red" space="1">
											<WTSTATIC value="ATTR(Goal.CompleteDate)" space="1"/>
											<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/TXN/PTSGOAL/@variance&quot;/&gt;))"/>
										</WTSTATIC>
									</WTCODEGROUP>
								</WTCODEGROUP>

								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
									<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)" connector="or"/>
									<WTCHECK name="&lt;xsl:value-of select=&quot;/DATA/TXN/PTSGOAL/@goalid&quot;/&gt;"/>
									<WTSTATIC label="Start" fontcolor="blue">
										<WTCONDITION expr="ATTR(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
									</WTSTATIC>
									<WTSTATIC label="Complete" fontcolor="green">
										<WTCONDITION expr="ATTR(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
									</WTSTATIC>
								</WTCODEGROUP>

								<WTSTATIC>
									<WTCONDITION expr="ATTR(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTTEXT value="ATTR(Goal.ActQty)" size="1" textclass="smbutton"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC fontcolor="red">
										<WTCONDITION expr="ATTR(Goal.ActQty)" oper="less" value="ATTR(Goal.Qty)"/>
										<WTSTATIC label="of" space="1"/>
										<WTSTATIC value="ATTR(Goal.Qty)"/>
									</WTSTATIC>
									<WTSTATIC fontcolor="green">
										<WTCONDITION expr="ATTR(Goal.ActQty)" oper="greater-equal" value="ATTR(Goal.Qty)"/>
										<WTSTATIC label="of" space="1"/>
										<WTSTATIC value="ATTR(Goal.Qty)"/>
									</WTSTATIC>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTSTATIC space="2"/>
									<WTIMAGE value="CONST(GoalEdit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="7004" target="Goal">
											<WTPARAM name="GoalID" value="ATTR(Goal.GoalID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>

							</WTSTATIC>
							
							<WTSTATIC col="3" align="right">
								<WTCODEGROUP>
									<WTBUTTON action="1" value="CONST(Update)" btnclass="smbutton"/>
									<WTBUTTON action="0" value="CONST(Refresh)" btnclass="smbutton"/>
									<WTBUTTON value="CONST(Close)" btnclass="smbutton">
										<WTCLICK>window.close()</WTCLICK>
									</WTBUTTON>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
							<WTROW margin-top="3" margin-bottom="3">
								<WTCONDITION expr="ATTR(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" align="left">
									<WTSTATIC value="ATTR(Goal.Description)" embedhtml="true"/>
								</WTSTATIC>
							</WTROW>
						</WTCODEGROUP>
					</WTTABLE>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
							<WTCOLUMN width="50" align="left"/>
							<WTCOLUMN width="50" align="left"/>
							<WTCOLUMN width="50" align="left"/>
							<WTCOLUMN width="50" align="left"/>
							<WTCOLUMN width="550" align="left"/>
							<WTROW>
								<WTSTATIC col="1" merge="5" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GoalChildren.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC fontcolor="darkblue" bold="true">
										<WTSTATIC value="PARAM(Count)" space="1"/>
										<WTSTATIC label="Tasks"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>

							<!-- ********************************************************************************* -->
							<WTREPEAT entity="Goal">
								<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="PARAM(GoalID)"/>	
								<WTROW class="graybar">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" merge="4">
										<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
											<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="or"/>
											<WTSTATIC value="DATA(Goal.CommitDate)"/>
											<WTSTATIC space="1"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)"/>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
												<WTIMAGE value="CONST(GreenChecksm.gif)"/>
												<WTSTATIC fontcolor="green" space="1">
													<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
													<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
												</WTSTATIC>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
												<WTIMAGE value="CONST(RedChecksm.gif)"/>
												<WTSTATIC fontcolor="red" space="1">
													<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
													<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
												</WTSTATIC>
											</WTCODEGROUP>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
											<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)" connector="or"/>
											<WTCHECK name="&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;"/>
											<WTSTATIC label="Start" fontcolor="blue">
												<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
											</WTSTATIC>
											<WTSTATIC label="Complete" fontcolor="green">
												<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
											</WTSTATIC>
										</WTCODEGROUP>
										
										<WTSTATIC>
											<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
											<WTSTATIC space="1"/>
											<WTCODEGROUP>
												<WTTEXT name="Q&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;" value="CONST(&lt;xsl:value-of select=&quot;@actqty&quot;/&gt;)" size="1" textclass="smbutton"/>
												<WTSTATIC space="1"/>
											</WTCODEGROUP>
											<WTSTATIC fontcolor="red">
												<WTCONDITION expr="DATA(Goal.ActQty)" oper="less" value="DATA(Qty)"/>
												<WTSTATIC label="of" space="1"/>
												<WTSTATIC value="DATA(Goal.Qty)"/>
											</WTSTATIC>
											<WTSTATIC fontcolor="green">
												<WTCONDITION expr="DATA(Goal.ActQty)" oper="greater-equal" value="DATA(Qty)"/>
												<WTSTATIC label="of" space="1"/>
												<WTSTATIC value="DATA(Goal.Qty)"/>
											</WTSTATIC>
										</WTSTATIC>
										<WTCODEGROUP>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(GoalEdit.gif)" alt="Edit" imgalign="absmiddle">
												<WTLINK name="7004" target="Goal">
													<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
											<WTSTATIC newline="1"/>
											<WTSTATIC value="DATA(Goal.Description)" embedhtml="true"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-top="3" margin-bottom="3" class="graybar">
									<WTSTATIC col="1"/>
									<WTDIVIDER col="2" merge="4" height="1" color="SYS(box)"/>
								</WTROW>

								<!-- ********************************************************************************* -->
								<WTREPEAT entity="Goal">
									<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="DATA(Current.GoalID)"/>
									<WTROW>
										<WTSTATIC col="1" merge="2"/>
										<WTSTATIC col="3" merge="3">
											<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
												<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="or"/>
												<WTSTATIC value="DATA(Goal.CommitDate)"/>
												<WTSTATIC space="1"/>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)"/>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
													<WTIMAGE value="CONST(GreenChecksm.gif)"/>
													<WTSTATIC fontcolor="green" space="1">
														<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
														<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
													</WTSTATIC>
												</WTCODEGROUP>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
													<WTIMAGE value="CONST(RedChecksm.gif)"/>
													<WTSTATIC fontcolor="red" space="1">
														<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
														<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
													</WTSTATIC>
												</WTCODEGROUP>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
												<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)" connector="or"/>
												<WTCHECK name="&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;"/>
												<WTSTATIC label="Start" fontcolor="blue">
													<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
												</WTSTATIC>
												<WTSTATIC label="Complete" fontcolor="green">
													<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
												</WTSTATIC>
											</WTCODEGROUP>
											<WTSTATIC>
												<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
												<WTSTATIC space="1"/>
												<WTCODEGROUP>
													<WTTEXT name="Q&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;" value="CONST(&lt;xsl:value-of select=&quot;@actqty&quot;/&gt;)" size="1"/>
													<WTSTATIC space="1"/>
												</WTCODEGROUP>
												<WTSTATIC fontcolor="red">
													<WTCONDITION expr="DATA(Goal.ActQty)" oper="less" value="DATA(Qty)"/>
													<WTSTATIC label="of" space="1"/>
													<WTSTATIC value="DATA(Goal.Qty)"/>
												</WTSTATIC>
												<WTSTATIC fontcolor="green">
													<WTCONDITION expr="DATA(Goal.ActQty)" oper="greater-equal" value="DATA(Qty)"/>
													<WTSTATIC label="of" space="1"/>
													<WTSTATIC value="DATA(Goal.Qty)"/>
												</WTSTATIC>
											</WTSTATIC>
											<WTCODEGROUP>
												<WTSTATIC space="2"/>
												<WTIMAGE value="CONST(GoalEdit.gif)" alt="Edit" imgalign="absmiddle">
													<WTLINK name="7004" target="Goal">
														<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
														<WTPARAM name="ContentPage" value="CONST(3)"/>
														<WTPARAM name="Popup" value="CONST(1)"/>
													</WTLINK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
												<WTSTATIC newline="1"/>
												<WTSTATIC value="DATA(Goal.Description)" embedhtml="true"/>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTROW>
									<WTROW margin-top="3" margin-bottom="3">
										<WTSTATIC col="1" merge="2"/>
										<WTDIVIDER col="3" merge="3" height="1" color="SYS(box)"/>
									</WTROW>

									<!-- ********************************************************************************* -->
									<WTREPEAT entity="Goal">
										<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="DATA(Current.GoalID)"/>
										<WTROW class="graybar">
											<WTSTATIC col="1" merge="3"/>
											<WTSTATIC col="4" merge="2">
												<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
													<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="or"/>
													<WTSTATIC value="DATA(Goal.CommitDate)"/>
													<WTSTATIC space="1"/>
												</WTCODEGROUP>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)"/>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
														<WTIMAGE value="CONST(GreenChecksm.gif)"/>
														<WTSTATIC fontcolor="green" space="1">
															<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
															<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
														</WTSTATIC>
													</WTCODEGROUP>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
														<WTIMAGE value="CONST(RedChecksm.gif)"/>
														<WTSTATIC fontcolor="red" space="1">
															<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
															<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
														</WTSTATIC>
													</WTCODEGROUP>
												</WTCODEGROUP>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
													<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)" connector="or"/>
													<WTCHECK name="&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;"/>
													<WTSTATIC label="Start" fontcolor="blue">
														<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
													</WTSTATIC>
													<WTSTATIC label="Complete" fontcolor="green">
														<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
													</WTSTATIC>
												</WTCODEGROUP>
												<WTSTATIC>
													<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
													<WTSTATIC space="1"/>
													<WTCODEGROUP>
														<WTTEXT name="Q&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;" value="CONST(&lt;xsl:value-of select=&quot;@actqty&quot;/&gt;)" size="1"/>
														<WTSTATIC space="1"/>
													</WTCODEGROUP>
													<WTSTATIC fontcolor="red">
														<WTCONDITION expr="DATA(Goal.ActQty)" oper="less" value="DATA(Qty)"/>
														<WTSTATIC label="of" space="1"/>
														<WTSTATIC value="DATA(Goal.Qty)"/>
													</WTSTATIC>
													<WTSTATIC fontcolor="green">
														<WTCONDITION expr="DATA(Goal.ActQty)" oper="greater-equal" value="DATA(Qty)"/>
														<WTSTATIC label="of" space="1"/>
														<WTSTATIC value="DATA(Goal.Qty)"/>
													</WTSTATIC>
												</WTSTATIC>
												<WTCODEGROUP>
													<WTSTATIC space="2"/>
													<WTIMAGE value="CONST(GoalEdit.gif)" alt="Edit" imgalign="absmiddle">
														<WTLINK name="7004" target="Goal">
															<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
															<WTPARAM name="ContentPage" value="CONST(3)"/>
															<WTPARAM name="Popup" value="CONST(1)"/>
														</WTLINK>
													</WTIMAGE>
												</WTCODEGROUP>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
													<WTSTATIC newline="1"/>
													<WTSTATIC value="DATA(Goal.Description)" embedhtml="true" space="1"/>
												</WTCODEGROUP>
											</WTSTATIC>
										</WTROW>
										<WTROW margin-top="3" margin-bottom="3" class="graybar">
											<WTSTATIC col="1" merge="3"/>
											<WTDIVIDER col="4" merge="2" height="1" color="SYS(box)"/>
										</WTROW>

										<!-- ********************************************************************************* -->
										<WTREPEAT entity="Goal">
											<WTFILTER name="DATA(Goal.ParentID)" oper="equal" value="DATA(Current.GoalID)"/>
											<WTROW>
												<WTSTATIC col="1" merge="4"/>
												<WTSTATIC col="5">
													<WTSTATIC value="DATA(Goal.GoalName)" bold="true" space="1"/>
													<WTSTATIC space="1"/>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
														<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)" connector="or"/>
														<WTSTATIC value="DATA(Goal.CommitDate)"/>
														<WTSTATIC space="1"/>
													</WTCODEGROUP>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMPLETE)"/>
														<WTCODEGROUP>
															<WTCONDITION expr="DATA(Goal.Variance)" oper="less-equal" value="CONST(0)"/>
															<WTIMAGE value="CONST(GreenChecksm.gif)"/>
															<WTSTATIC fontcolor="green" space="1">
																<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
																<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
															</WTSTATIC>
														</WTCODEGROUP>
														<WTCODEGROUP>
															<WTCONDITION expr="DATA(Goal.Variance)" oper="greater" value="CONST(0)"/>
															<WTIMAGE value="CONST(RedChecksm.gif)"/>
															<WTSTATIC fontcolor="red" space="1">
																<WTSTATIC value="DATA(Goal.CompleteDate)" space="1"/>
																<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@variance&quot;/&gt;))"/>
															</WTSTATIC>
														</WTCODEGROUP>
													</WTCODEGROUP>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
														<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)" connector="or"/>
														<WTCHECK name="&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;"/>
														<WTSTATIC label="Start" fontcolor="blue">
															<WTCONDITION expr="DATA(Goal.Status)" oper="less-equal" value="SYSCON(GOAL-STATUS-DECLARE)"/>
														</WTSTATIC>
														<WTSTATIC label="Complete" fontcolor="green">
															<WTCONDITION expr="DATA(Goal.Status)" oper="equal" value="SYSCON(GOAL-STATUS-COMMIT)"/>
														</WTSTATIC>
													</WTCODEGROUP>
													<WTSTATIC>
														<WTCONDITION expr="DATA(Goal.Qty)" oper="not-equal" value="CONST(0)"/>
														<WTSTATIC space="1"/>
														<WTCODEGROUP>
															<WTTEXT name="Q&lt;xsl:value-of select=&quot;@goalid&quot;/&gt;" value="CONST(&lt;xsl:value-of select=&quot;@actqty&quot;/&gt;)" size="1"/>
															<WTSTATIC space="1"/>
														</WTCODEGROUP>
														<WTSTATIC fontcolor="red">
															<WTCONDITION expr="DATA(Goal.ActQty)" oper="less" value="DATA(Qty)"/>
															<WTSTATIC label="of" space="1"/>
															<WTSTATIC value="DATA(Goal.Qty)"/>
														</WTSTATIC>
														<WTSTATIC fontcolor="green">
															<WTCONDITION expr="DATA(Goal.ActQty)" oper="greater-equal" value="DATA(Qty)"/>
															<WTSTATIC label="of" space="1"/>
															<WTSTATIC value="DATA(Goal.Qty)"/>
														</WTSTATIC>
													</WTSTATIC>
													<WTCODEGROUP>
														<WTSTATIC space="2"/>
														<WTIMAGE value="CONST(GoalEdit.gif)" alt="Edit" imgalign="absmiddle">
															<WTLINK name="7004" target="Goal">
																<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
																<WTPARAM name="ContentPage" value="CONST(3)"/>
																<WTPARAM name="Popup" value="CONST(1)"/>
															</WTLINK>
														</WTIMAGE>
													</WTCODEGROUP>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Goal.Description)" oper="not-equal" value="CONST('  ')"/>
														<WTSTATIC newline="1"/>
														<WTSTATIC value="DATA(Goal.Description)" embedhtml="true"/>
													</WTCODEGROUP>
												</WTSTATIC>
											</WTROW>
											<WTROW margin-top="3" margin-bottom="3">
												<WTSTATIC col="1" merge="4"/>
												<WTDIVIDER col="5" height="1" color="SYS(box)"/>
											</WTROW>

										</WTREPEAT>
									</WTREPEAT>
								</WTREPEAT>
							</WTREPEAT>

						</WTTABLE>
					</WTROW>

				</WTCODEGROUP>

				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>