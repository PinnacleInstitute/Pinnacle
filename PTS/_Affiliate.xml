<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="06" name="Affiliate" alias="af" log="false" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="0601" name="AffiliateID" type="number" identity="true" min="1" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="0602" name="AuthUserID" type="number" source="entity"><WTINIT/></WTATTRIBUTE>
		<WTATTRIBUTE id="0603" name="CompanyID" type="number" source="entity"/>
		<WTATTRIBUTE id="0604" name="MemberID" type="number" source="entity"/>
		<WTATTRIBUTE id="0605" name="SponsorID" type="number" source="entity"/>

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="0610" name="UserGroup" type="number" source="join" passthru="true">
			<WTJOIN entity="AuthUser" name="UserGroup"/>
			<WTENUM id="61" name="AuthUser"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0611" name="UserStatus" type="number" source="join" passthru="true">
			<WTJOIN entity="AuthUser" name="UserStatus"/>
			<WTENUM id="1" name="Active"/>
			<WTENUM id="2" name="InActive"/>
			<WTENUM id="3" name="ReadOnly"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0612" name="Logon" type="text" length="80" source="join">
			<WTJOIN entity="AuthUser" name="Logon"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="0615" name="AffiliateName" type="text" length="60" min="1" max="60" source="entity" required="true" title="true"/>
		<WTATTRIBUTE id="0616" name="NameLast" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0617" name="NameFirst" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0618" name="ContactName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameLast"/>
			<WTCOMPUTE text=", "/>
			<WTCOMPUTE name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0619" name="Street" type="text" length="60" min="1" max="60" source="entity"/>
		<WTATTRIBUTE id="0620" name="Unit" type="text" length="40" min="1" max="40" source="entity"/>
		<WTATTRIBUTE id="0621" name="City" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0622" name="State" type="text" length="30" min="1"  max="30" source="entity"/>
		<WTATTRIBUTE id="0623" name="Zip" type="text" length="20" min="1"  max="20" source="entity"/>
		<WTATTRIBUTE id="0624" name="Country" type="text" length="30" min="1"  max="30" source="entity"/>
		<WTATTRIBUTE id="0625" name="Email" type="text" length="80" min="1" max="80" source="entity"/>
		<WTATTRIBUTE id="0626" name="Phone1" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0627" name="Phone2" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0628" name="Fax" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0629" name="SSN" type="text" length="18" min="1" max="18" source="entity"/>
		<WTATTRIBUTE id="0630" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Pending"/>
			<WTENUM id="2" name="Active"/>
			<WTENUM id="3" name="InActive"/>
			<WTENUM id="4" name="Cancelled"/>
			<WTENUM id="5" name="Terminated"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0631" name="EnrollDate" type="date" source="entity"/>
		<WTATTRIBUTE id="0632" name="Website" type="text" length="80" min="1" max="80" source="entity" language="false"/>
		<WTATTRIBUTE id="0633" name="Terms" type="text" length="1000" min="1" max="1000" embedhtml="true" source="entity"/>
		<WTATTRIBUTE id="0634" name="LeadCampaigns" type="text" length="50" min="1" max="50" source="entity" language="false"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="0698" name="NewLogon" type="text" length="80" min="3" max="80" source="entity" persist="false" passthru="true"/>
		<WTATTRIBUTE id="0699" name="NewPassword" type="password" length="30" min="3" max="30" source="entity" persist="false" passthru="true"/>
		
		<!--Indexes-->
		<WTINDEX name="AuthUserID">
			<WTATTRIBUTE name="AuthUserID"/>
		</WTINDEX>
		<WTINDEX name="AffiliateName">
			<WTATTRIBUTE name="AffiliateName"/>
		</WTINDEX>
		<WTINDEX name="ContactName">
			<WTATTRIBUTE name="NameLast"/>
			<WTATTRIBUTE name="NameFirst"/>
		</WTINDEX>
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID"/>
		</WTINDEX>
		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Affiliate" entity="Affiliate" alias="af"/>
			<WTRELATIONSHIP name="Common" entity="Affiliate" alias="af">
				<WTENTITY name="AuthUser" entity="AuthUser" alias="au">
					<WTATTRIBUTE alias="af" name="AuthUserID" relalias="au" relname="AuthUserID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="AffiliateName" default="true"/>	
			<WTATTRIBUTE name="ContactName"/>
			<WTATTRIBUTE name="AffiliateID"/>
			<WTATTRIBUTE name="Email"/>
		</WTENUM>

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="AFFILIATE-PENDING" value="1"/>
			<WTSYSCON name="AFFILIATE-ACTIVE" value="2"/>
			<WTSYSCON name="AFFILIATE-INACTIVE" value="3"/>
			<WTSYSCON name="AFFILIATE-CANCELLED" value="4"/>
			<WTSYSCON name="AFFILIATE-TERMINATED" value="5"/>
		</WTSYSCONS>

	</WTENTITY>

	<!--Procedures-->
	<WTPROCEDURES>
		<!--================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="NewID" datatype="number"/>
			<WTDECLARE name="AuthUserID" datatype="number"/>
			<WTDECLARE name="MemberID" datatype="number"/>
			<WTSETVALUE name="Now" value="SYS(timestamp)"/>
			<WTSETVALUE name="AuthUserID" value="CONST(0)"/>
			<WTSETVALUE name="MemberID" value="CONST(0)"/>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UserGroup)" oper="greater" value="CONST(0)"/>
				<WTPROCEDURE name="AuthUser_Add">
					<WTPARAM name="ATTR(Logon)" direction="input" value="PARAM(NewLogon)"/>
					<WTPARAM name="ATTR(Password)" direction="input" value="PARAM(NewPassword)"/>
					<WTPARAM name="ATTR(Email)" direction="input" value="PARAM(Email)"/>
					<WTPARAM name="ATTR(NameLast)" direction="input" value="PARAM(NameLast)"/>
					<WTPARAM name="ATTR(NameFirst)" direction="input" value="PARAM(NameFirst)"/>
					<WTPARAM name="ATTR(UserGroup)" direction="input" value="PARAM(UserGroup)"/>
					<WTPARAM name="ATTR(UserStatus)" direction="input" value="PARAM(UserStatus)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="AuthUserID" direction="output"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTINSERT/>
			</WTCODEGROUP>
			<WTSETVALUE name="NewID" value="CONST(@@IDENTITY)"/>
			<WTSETVALUE name="PARAM(AffiliateID)" value="NewID"/>
			<WTSETVALUE name="PARAM(AuthUserID)" value="AuthUserID"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Count" name="Count" style="GenerateDataProc.xsl"/>
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(AffiliateID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTDECLARE name="AuthUserID" datatype="number"/>
			<WTDECLARE name="MemberID" datatype="number"/>
			<WTCODEGROUP>
				<WTPROCEDURE name="Shortcut_DeleteItem">
					<WTPARAM name="EntityID" direction="input" value="ENTITY(Affiliate)"/>
					<WTPARAM name="ItemID" direction="input" value="PARAM(AffiliateID)"/>
				</WTPROCEDURE>
				<WTPROCEDURE name="Affiliate_FetchIDs">
					<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="AuthUserID" direction="output"/>
					<WTPARAM name="MemberID" direction="output"/>
				</WTPROCEDURE>
				<WTCODEGROUP>
					<WTCONDITION expr="AuthUserID" oper="greater" value="CONST(0)"/>
					<WTPROCEDURE name="AuthUser_Delete">
						<WTPARAM name="ATTR(AuthUserID)" direction="input" value="AuthUserID"/>
						<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					</WTPROCEDURE>
				</WTCODEGROUP>
				<WTDELETE>
					<WTJOIN name="Affiliate" lock="true"/>
					<WTCONDITION expr="ATTR(Affiliate.AffiliateID)" oper="equal" value="PARAM(AffiliateID)"/>
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchIDs" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(AffiliateID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="output"/>
			<WTPARAM name="ATTR(MemberID)" direction="output"/>
			<WTDECLARE name="AuthUserID" datatype="number"/>
			<WTDECLARE name="MemberID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="AuthUserID" value="ATTR(Affiliate.AuthUserID)"/>
					<WTATTRIBUTE name="MemberID" value="ATTR(Affiliate.MemberID)"/>
					<WTJOIN name="Affiliate" lock="false"/>
					<WTCONDITION expr="ATTR(Affiliate.AffiliateID)" oper="equal" value="PARAM(AffiliateID)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(AuthUserID)" value="AuthUserID" null="0"/>
				<WTSETVALUE name="PARAM(MemberID)" value="MemberID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Affiliate.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindMember" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Affiliate.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Fetch" name="LoadAuthUser" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(Employee.AuthUserID)" direction="input"/>
			<WTPARAM name="ATTR(Employee.AffiliateID)" direction="output"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="CONST(@AffiliateID)" value="ATTR(Affiliate.AffiliateID)"/>
					<WTJOIN name="Affiliate" lock="false"/>
					<WTCONDITION expr="ATTR(Affiliate.AuthUserID)" oper="equal" value="PARAM(AuthUserID)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="Fetch" name="LoadLogon" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(Affiliate.Logon)" direction="input"/>
			<WTPARAM name="ATTR(Affiliate.AffiliateID)" direction="output"/>
			<WTPARAM name="ATTR(Affiliate.AffiliateName)" direction="output"/>
			<WTPARAM name="ATTR(Affiliate.CompanyID)" direction="output"/>
			<WTPARAM name="ATTR(Affiliate.NameLast)" direction="output"/>
			<WTPARAM name="ATTR(Affiliate.NameFirst)" direction="output"/>
			<WTPARAM name="ATTR(Affiliate.Phone1)" direction="output"/>
			<WTPARAM name="ATTR(Affiliate.Email)" direction="output"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="CONST(@AffiliateID)" value="ATTR(Affiliate.AffiliateID)"/>
					<WTATTRIBUTE name="CONST(@AffiliateName)" value="ATTR(Affiliate.AffiliateName)"/>
					<WTATTRIBUTE name="CONST(@CompanyID)" value="ATTR(Affiliate.CompanyID)"/>
					<WTATTRIBUTE name="CONST(@NameLast)" value="ATTR(Affiliate.NameLast)"/>
					<WTATTRIBUTE name="CONST(@NameFirst)" value="ATTR(Affiliate.NameFirst)"/>
					<WTATTRIBUTE name="CONST(@Phone1)" value="ATTR(Affiliate.Phone1)"/>
					<WTATTRIBUTE name="CONST(@Email)" value="ATTR(Affiliate.Email)"/>
					<WTJOIN name="Common" lock="false"/>
					<WTCONDITION expr="ATTR(AuthUser.Logon)" oper="equal" value="PARAM(Logon)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="NewID" datatype="number"/>
			<WTSETVALUE name="Now" value="SYS(timestamp)"/>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(AuthUserID)" oper="greater" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(UserGroup)" oper="equal" value="CONST(0)" connector="and"/>
				<WTPROCEDURE name="AuthUser_Delete">
					<WTPARAM name="ATTR(AuthUserID)" direction="input" value="PARAM(AuthUserID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
				</WTPROCEDURE>
				<WTSETVALUE name="PARAM(AuthUserID)" value="CONST(0)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(AuthUserID)" oper="greater" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(UserGroup)" oper="greater" value="CONST(0)" connector="and"/>
				<WTPROCEDURE name="AuthUser_Update">
					<WTPARAM name="ATTR(AuthUserID)" direction="input" value="PARAM(AuthUserID)"/>
					<WTPARAM name="ATTR(Email)" direction="input" value="PARAM(Email)"/>
					<WTPARAM name="ATTR(NameLast)" direction="input" value="PARAM(NameLast)"/>
					<WTPARAM name="ATTR(NameFirst)" direction="input" value="PARAM(NameFirst)"/>
					<WTPARAM name="ATTR(UserGroup)" direction="input" value="PARAM(UserGroup)"/>
					<WTPARAM name="ATTR(UserStatus)" direction="input" value="PARAM(UserStatus)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(AuthUserID)" oper="equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(UserGroup)" oper="greater" value="CONST(0)" connector="and"/>
				<WTPROCEDURE name="AuthUser_Add">
					<WTPARAM name="ATTR(Logon)" direction="input" value="PARAM(NewLogon)"/>
					<WTPARAM name="ATTR(Password)" direction="input" value="PARAM(NewPassword)"/>
					<WTPARAM name="ATTR(Email)" direction="input" value="PARAM(Email)"/>
					<WTPARAM name="ATTR(NameLast)" direction="input" value="PARAM(NameLast)"/>
					<WTPARAM name="ATTR(NameFirst)" direction="input" value="PARAM(NameFirst)"/>
					<WTPARAM name="ATTR(UserGroup)" direction="input" value="PARAM(UserGroup)"/>
					<WTPARAM name="ATTR(UserStatus)" direction="input" value="PARAM(UserStatus)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="NewID" direction="output"/>
				</WTPROCEDURE>
				<WTSETVALUE name="PARAM(AuthUserID)" value="NewID" null="0"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTUPDATE>
					<WTJOIN name="Affiliate" lock="true"/>
					<WTCONDITION expr="ATTR(Affiliate.AffiliateID)" oper="equal" value="PARAM(AffiliateID)"/>
				</WTUPDATE>
			</WTCODEGROUP>
		</WTPROCEDURE>

	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--============================================================================================-->
		<WTWEBPAGE name="0601" caption="Find" action="5" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="23">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotAffiliates" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(AffiliateName)">
					<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Affiliates" project="ptsAffiliateUser" class="CAffiliates">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliates" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Affiliates" project="ptsAffiliateUser" class="CAffiliates">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
				<WTMETHOD name="Find">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlAffiliates" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="75" align="center"/>
						<WTCOLUMN width="325" align="center"/>
						<WTCOLUMN width="200" align="left"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(Affiliate.gif)"/>
							<WTSTATIC col="2" label="FindAffiliate" class="PageHeading"/>
							<WTLINKGROUP  col="3" align="right" >
								<WTLINK name="0602" label="NewAffiliate" class="PageHeadingLink">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTLINKGROUP>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="AffiliatesText" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="left"/>
					<WTCOMBO col="1" value="ATTR(Affiliates.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Affiliate">
						<WTCOLUMN width="34" align="left" valign="top" label="AffiliateName"/>
						<WTCOLUMN width="33" align="left" valign="top" label="ContactNameAddress"/>
						<WTCOLUMN width="33" align="left" valign="top" label="EmailStatus"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Affiliate.AffiliateName)">
								<WTLINK name="0603">
									<WTPARAM name="AffiliateID" value="DATA(Affiliate.AffiliateID)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Affiliate.ContactName)"/>
							<WTSTATIC col="3" value="DATA(Affiliate.Email)">
								<WTLINK type="mail" name="DATA(Affiliate.Email)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" fontcolor="gray">
								<WTSTATIC value="DATA(Affiliate.AffiliateID)" space="3"/>
								<WTSTATIC value="DATA(Affiliate.MemberID)">
									<WTCONDITION expr="NotMemberOnly"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2" fontcolor="gray">
								<WTSTATIC value="DATA(Affiliate.City)" space="1"/>
								<WTSTATIC value="DATA(Affiliate.State)" space="1"/>
								<WTSTATIC value="DATA(Affiliate.Zip)" space="1"/>
								<WTSTATIC value="DATA(Affiliate.Country)"/>
							</WTSTATIC>
							<WTSTATIC col="3" fontcolor="gray">
								<WTSTATIC value="DATA(Affiliate.Status)" fontcolor="green">
									<WTCONDITION expr="DATA(Affiliate.Status)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Affiliate.Status)">
									<WTCONDITION expr="DATA(Affiliate.Status)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Affiliate.Status)" fontcolor="red">
									<WTCONDITION expr="DATA(Affiliate.Status)" oper="greater" value="CONST(2)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0602" caption="New Affiliate" navbar="false" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" secured="23">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="AffiliateID" datatype="number"/>
			<WTPARAM name="ProspectID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
		
			<WTSUB name="LoadAffiliate">
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<!--
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="CONST(61)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="CONST(1)"/>
-->
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(date)"/>
<!--					<WTSETATTRIBUTE name="ATTR(Country)" value="CONST(&quot;USA&quot;)"/>-->
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
<!-- Add Action -->
			<WTACTION id="2" name="Add" type="Add">
				<!-- Check for valid logon and password ... -->
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="OOops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="LoadAffiliate"/>
				</WTCODEGROUP>
				
				<!-- If valid logon and password then add the Affiliate -->
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>

					<WTSETATTRIBUTE name="CONST(tmpAffiliateName)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpStreet)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpUnit)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpCity)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpState)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpZip)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpCountry)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpWebsite)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="CONST(0)"/>
					<WTOBJECT name="Prospect" project="ptsProspectUser" class="CProspect">
						<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpAffiliateName)" value="ATTR(ProspectName)"/>
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="ATTR(NameLast)"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="ATTR(NameFirst)"/>
						<WTSETATTRIBUTE name="CONST(tmpStreet)" value="ATTR(Street)"/>
						<WTSETATTRIBUTE name="CONST(tmpUnit)" value="ATTR(Unit)"/>
						<WTSETATTRIBUTE name="CONST(tmpCity)" value="ATTR(City)"/>
						<WTSETATTRIBUTE name="CONST(tmpState)" value="ATTR(State)"/>
						<WTSETATTRIBUTE name="CONST(tmpZip)" value="ATTR(Zip)"/>
						<WTSETATTRIBUTE name="CONST(tmpCountry)" value="ATTR(Country)"/>
						<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
						<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="ATTR(Phone1)"/>
						<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="ATTR(Phone2)"/>
						<WTSETATTRIBUTE name="CONST(tmpWebsite)" value="ATTR(Website)"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
					</WTOBJECT>

					<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
						<WTMETHOD name="Load">
							<WTPARAM name="AffiliateID" direction="input" value="CONST(0)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
						<WTSETATTRIBUTES/>
<WTCUSTOM>
					If .AffiliateName = &quot;&quot; Then .AffiliateName = .NameLast + &quot;, &quot; + .NameFirst
					If .Status = "0" Then .Status = 2
</WTCUSTOM>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(AffiliateName)" value="CONST(tmpAffiliateName)"/>
							<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpNameLast)"/>
							<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpNameFirst)"/>
							<WTSETATTRIBUTE name="ATTR(Street)" value="CONST(tmpStreet)"/>
							<WTSETATTRIBUTE name="ATTR(Unit)" value="CONST(tmpUnit)"/>
							<WTSETATTRIBUTE name="ATTR(City)" value="CONST(tmpCity)"/>
							<WTSETATTRIBUTE name="ATTR(State)" value="CONST(tmpState)"/>
							<WTSETATTRIBUTE name="ATTR(Zip)" value="CONST(tmpZip)"/>
							<WTSETATTRIBUTE name="ATTR(Country)" value="CONST(tmpCountry)"/>
							<WTSETATTRIBUTE name="ATTR(Email)" value="CONST(tmpEmail)"/>
							<WTSETATTRIBUTE name="ATTR(Phone1)" value="CONST(tmpPhone1)"/>
							<WTSETATTRIBUTE name="ATTR(Phone2)" value="CONST(tmpPhone2)"/>
							<WTSETATTRIBUTE name="ATTR(Website)" value="CONST(tmpWebsite)"/>
							<WTSETATTRIBUTE name="ATTR(MemberID)" value="CONST(tmpMemberID)"/>
						</WTCODEGROUP>

						<WTMETHOD name="Add">
		 					<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="reqAffiliateID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpAuthUser)" value="ATTR(Affiliate.AuthUserID)"/>
						<WTMETHOD name="XML">
		 					<WTCONDITION expr="IsErrors"/>
							<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>
				
<!-- Send confirmation email -->				
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpAuthUser)" oper="greater" value="CONST(0)" connector="and"/>
					<WTRETURN>
						<WTCONDITION expr="IsAffiliateOnly"/>
						<WTLINK name="0105" return="false">
							<WTPARAM name="AuthUserID" value="CONST(tmpAuthUser)"/>
							<WTPARAM name="MailReturnURL" value="CONST(&quot;0630.asp?AffiliateID=&quot; &amp; reqAffiliateID)"/>
						</WTLINK>
					</WTRETURN>
					<WTRETURN>
						<WTCONDITION expr="NotAffiliateOnly"/>
						<WTLINK name="0105" return="false">
							<WTPARAM name="AuthUserID" value="CONST(tmpAuthUser)"/>
							<WTPARAM name="MailReturnURL" value="CONST(Replace(GetCache(&quot;0602URL&quot;), &quot;%26&quot;, &quot;&amp;&quot;))"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>

				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>


	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Affiliate.AffiliateID)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="3"  align="left" label="NewAffiliate" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step1.gif)" align="center" valign="top"/>
					<WTSTATIC col="2" merge="2" align="left" label="NewAffiliateText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="AffiliateName"/>
					<WTTEXT col="3" value="ATTR(Affiliate.AffiliateName)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="ContactName"/>
					<WTTEXT col="3" value="ATTR(Affiliate.NameFirst)" width="200" label="NameFirst" size="25"/>
					<WTTEXT col="3" value="ATTR(Affiliate.NameLast)" width="240" label="NameLast" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Email"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Email)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="SSN"/>
					<WTTEXT col="3" value="ATTR(Affiliate.SSN)" size="18"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step2.gif)" align="center" valign="top"/>
					<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="NewLogon"/>
					<WTTEXT col="3" value="ATTR(Affiliate.NewLogon)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="NewPassword"/>
					<WTTEXT col="3" value="ATTR(Affiliate.NewPassword)" size="20"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step3.gif)" align="center" valign="top"/>
					<WTSTATIC col="2" tag="Address"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Street)" width="294" label="Street" size="40"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Unit)" width="146" label="Unit" size="10"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2"/>
					<WTTEXT col="3" value="ATTR(Affiliate.City)" width="200" label="City" size="25"/>
					<WTTEXT col="3" value="ATTR(Affiliate.State)" width="240" label="State" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Zip)" width="200" label="Zip" size="25"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Country)" width="240" label="Country" size="25"/>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Phone1"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Phone1)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Phone2"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Phone2)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Fax"/>
					<WTTEXT col="3" value="ATTR(Affiliate.Fax)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Website" />
					<WTTEXT col="3" value="ATTR(Affiliate.Website)" size="60" />
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="NotAffiliateOnly"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" valign="top" tag="Terms"/> 
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTMEMO col="2" merge="2" align="left" value="ATTR(Affiliate.Terms)" rows="4" cols="72" htmleditor="editor_simple"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Status"/>
						<WTCOMBO col="3" value="ATTR(Affiliate.Status)"/>
						<WTSTATIC col="3" tag="EnrollDate"/>
						<WTTEXT col="3" value="ATTR(Affiliate.EnrollDate)" prespace="false"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="LeadCampaignsText" align="left" class="prompt" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="LeadCampaigns"/>
						<WTTEXT col="3" value="ATTR(Affiliate.LeadCampaigns)"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="CopyProspect" align="left" class="prompt" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="ProspectID" />
						<WTTEXT col="3" value="PARAM(ProspectID)" size="5" />
						<WTBUTTON col="3" action="2" value="CONST(Copy)" align="center">
							<WTCONDITION expr="IsActive" />
						</WTBUTTON>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="UserAccessText" align="left" class="prompt" />
					</WTROW>
					 <WTROW>
						<WTSTATIC col="1"/>
					 	<WTSTATIC col="2" tag="UserAccess"/>
					 	<WTCOMBO col="3" value="ATTR(Affiliate.UserGroup)"/>
					 	<WTCOMBO col="3" value="ATTR(Affiliate.UserStatus)"/>
					 </WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsAffiliateOnly"/>
					<WTROW>		
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="EnrollDate" height="18"/>
						<WTSTATIC col="3" value="ATTR(Affiliate.EnrollDate)"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Affiliate.EnrollDate)"/>
						<WTHIDDEN value="ATTR(Affiliate.Status)"/>
						<WTHIDDEN value="ATTR(Affiliate.LeadCampaigns)"/>
						<WTHIDDEN value="ATTR(Affiliate.UserGroup)"/>
						<WTHIDDEN value="ATTR(Affiliate.UserStatus)"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="2"/>
					<WTBUTTON col="3" action="2" value="CONST(Submit)">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="3" action="3" value="CONST(Cancel)"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0603" contentpage="true" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="23">
		<!--============================================================================================-->
			<WTPARAM name="AffiliateID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTSUB name="UpdateAffiliate">
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
<WTCUSTOM>
			If .AffiliateName = &quot;&quot; Then .AffiliateName = .NameLast + &quot;, &quot; + .NameFirst
</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
	 					<WTCONDITION expr="IsErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateAffiliate"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Delete">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
			
	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTTAB name="AffiliateTab">
					<WTITEM label="Status" width="145"><WTLINK name="JAVA(ShowTab('TabStatus',1))"/></WTITEM>
					<WTITEM label="Contact" width="145"><WTLINK name="JAVA(ShowTab('TabContact',1))"/></WTITEM>
					<WTITEM label="Terms" width="145"><WTLINK name="JAVA(ShowTab('TabTerms',1))"/></WTITEM>
					<WTITEM label="Notes" width="145">
						<WTCONDITION expr="NotAffiliateOnly"/>
						<WTLINK name="JAVA(ShowTab('TabNotes',1))"/>
					</WTITEM>
				</WTTAB>

				<WTFUNCTION name="ShowTab(tab, shw)">
               document.getElementById('TabStatus').style.display = 'none';
               document.getElementById('TabContact').style.display = 'none';
               document.getElementById('TabTerms').style.display = 'none';
               document.getElementById('TabNotes').style.display = 'none';
               document.getElementById(tab).style.display = '';
					if (shw > 0) {
						content = window.document.getElementById('AffiliateName');
						if(content)
							content.scrollIntoView();
					}	
			    </WTFUNCTION>  
				<WTLOAD>
					ShowTab('TabStatus',0);
				</WTLOAD>

				<WTCODEGROUP>
					<WTCONDITION expr="NotAffiliateOnly"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" tag="Affiliate" value="ATTR(Affiliate.AffiliateName)" bold="true" class="PageHeading"/>
						<WTIMAGE col="1" merge="2" value="CONST(Shortcut.gif)">
							<WTCONDITION expr="NotMemberOnly"/>
							<WTCONDITION expr="_IsShortcuts" connector="or"/>
							<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
								<WTPARAM name="EntityID" value="ENTITY(Affiliate)"/>
								<WTPARAM name="ItemID" value="ATTR(Affiliate.AffiliateID)"/>
								<WTPARAM name="Name" value="ATTR(Affiliate.AffiliateName)" clean="true"/>
								<WTPARAM name="URL" value="SYS(PageURL)"/>
							</WTLINK>
						</WTIMAGE>
					</WTROW>
					<WTROW>
						<WTLINKGROUP col="1" merge="2" align="right">
							<WTLINK name="0604" label="LeadCampaigns" class="PageHeadingLink">
						 		<WTPARAM name="AffiliateID" value="PARAM(AffiliateID)"/>
								<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								<WTPARAM name="Popup" value="PARAM(Popup)"/>
							</WTLINK>
							<WTLINK name="0104" label="ResetLogon" class="PageHeadingLink">
						 		<WTCONDITION expr="ATTR(UserGroup)" oper="not-equal" value="CONST(0)"/>
						 		<WTPARAM name="AuthUserID" value="ATTR(Affiliate.AuthUserID)"/>
							</WTLINK>
						</WTLINKGROUP>
					</WTROW>
					<WTROW margin-bottom="2">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
					</WTROW>
					<WTROW margin-top="2">
						<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="right" btnclass="smbutton">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="right" btnclass="smbutton">
							<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" btnclass="smbutton">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTSTATIC col="1" tag="AffiliateID" height="18"/>
					<WTSTATIC col="2" value="ATTR(Affiliate.AffiliateID)" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1" tag="CompanyID"/>
						<WTTEXT col="2" value="ATTR(Affiliate.CompanyID)" valign="center" label="CompanyID" size="6"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Affiliate.CompanyID)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="NotAffiliateOnly"/>
					<WTROW>
						<WTSTATIC col="1" tag="MemberID"/>
						<WTTEXT col="2" value="ATTR(Affiliate.MemberID)" valign="center" label="MemberID" size="6"/>
						<WTLINKGROUP col="2">
							<WTCONDITION expr="NotMemberOnly"/>
							<WTCONDITION expr="ATTR(Affiliate.MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTLINK name="0403" label="MemberID" class="PageHeadingLink" target="Member">
								<WTPARAM name="MemberID" value="ATTR(Affiliate.MemberID)" />
								<WTPARAM name="Popup" value="CONST(1)"/>
							</WTLINK>
						</WTLINKGROUP>
						<WTSTATIC col="2" space="3"/>
						<WTSTATIC col="2" tag="SponsorID"/>
						<WTTEXT col="2" value="ATTR(Affiliate.SponsorID)" valign="center" label="SponsorID" size="6"/>
						<WTLINKGROUP col="2">
							<WTCONDITION expr="ATTR(Affiliate.SponsorID)" oper="not-equal" value="CONST(0)" />
							<WTLINK name="0603" label="SponsorID" class="PageHeadingLink" target="Affiliate">
								<WTPARAM name="AffiliateID" value="ATTR(Affiliate.SponsorID)" />
								<WTPARAM name="Popup" value="CONST(1)"/>
							</WTLINK>
						</WTLINKGROUP>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsAffiliateOnly"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Affiliate.MemberID)"/>
						<WTHIDDEN value="ATTR(Affiliate.SponsorID)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="NotAffiliateOnly"/>
					<WTROW>
						<WTSTATIC col="1" tag="AffiliateName"/>
						<WTTEXT col="2" value="ATTR(Affiliate.AffiliateName)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ContactName"/>
						<WTTEXT col="2" value="ATTR(Affiliate.NameFirst)" width="200" label="NameFirst" size="25"/>
						<WTTEXT col="2" value="ATTR(Affiliate.NameLast)" width="240" label="NameLast" size="25"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsAffiliateOnly"/>
					<WTROW>
						<WTSTATIC col="1" tag="AffiliateName" height="18"/>
						<WTSTATIC col="2" value="ATTR(Affiliate.AffiliateName)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ContactName" height="18"/>
						<WTSTATIC col="2" value="ATTR(Affiliate.ContactName)"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTROW>
						<WTHIDDEN value="ATTR(Affiliate.AffiliateName)"/>
						<WTHIDDEN value="ATTR(Affiliate.NameFirst)"/>
						<WTHIDDEN value="ATTR(Affiliate.NameLast)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Affiliate.Email)" size="60"/>
				</WTROW>
				
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="left">
						<WTCODEGROUP><WTSTARTTAB name="AffiliateTab"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW id="TabStatus">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTCODEGROUP>
							<WTCONDITION expr="NotAffiliateOnly"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Status"/>
								<WTCOMBO col="2" value="ATTR(Affiliate.Status)"/>
								<WTSTATIC col="2" tag="EnrollDate"/>
								<WTTEXT col="2" value="ATTR(Affiliate.EnrollDate)" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="SSN"/>
								<WTTEXT col="2" value="ATTR(Affiliate.SSN)" size="18"/>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" merge="2" label="LeadCampaignsText" align="left" class="prompt"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="LeadCampaigns"/>
								<WTTEXT col="2" value="ATTR(Affiliate.LeadCampaigns)"/>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" merge="2" label="UserAccessText" align="left" class="prompt" />
							</WTROW>
							<WTROW>
					 			<WTSTATIC col="1" tag="UserAccess"/>
					 			<WTCOMBO col="2" value="ATTR(Affiliate.UserGroup)"/>
					 			<WTCOMBO col="2" value="ATTR(Affiliate.UserStatus)"/>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="IsAffiliateOnly"/>
							<WTROW>		
								<WTSTATIC col="1" tag="EnrollDate" height="18"/>
								<WTSTATIC col="2" value="ATTR(Affiliate.EnrollDate)"/>
							</WTROW>
							<WTROW>
								<WTHIDDEN value="ATTR(Affiliate.Status)"/>
								<WTHIDDEN value="ATTR(Affiliate.EnrollDate)"/>
								<WTHIDDEN value="ATTR(Affiliate.SSN)"/>
								<WTHIDDEN value="ATTR(Affiliate.LeadCampaigns)"/>
								<WTHIDDEN value="ATTR(Affiliate.UserGroup)"/>
								<WTHIDDEN value="ATTR(Affiliate.UserStatus)"/>
							</WTROW>
						</WTCODEGROUP>
					</WTTABLE>
				</WTROW>

				<WTROW id="TabContact">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW>
							<WTSTATIC col="1" tag="Address"/>
							<WTTEXT col="2" value="ATTR(Affiliate.Street)" width="294" label="Street" size="40"/>
							<WTTEXT col="2" value="ATTR(Affiliate.Unit)" width="146" label="Unit" size="10"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTEXT col="2" value="ATTR(Affiliate.City)" width="200" label="City" size="25"/>
							<WTTEXT col="2" value="ATTR(Affiliate.State)" width="240" label="State" size="25"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTEXT col="2" value="ATTR(Affiliate.Zip)" width="200" label="Zip" size="25"/>
							<WTTEXT col="2" value="ATTR(Affiliate.Country)" width="240" label="Country" size="25"/>
						</WTROW>
						
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Phone1"/>
							<WTTEXT col="2" value="ATTR(Affiliate.Phone1)" size="30"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Phone2"/>
							<WTTEXT col="2" value="ATTR(Affiliate.Phone2)" size="30"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Fax"/>
							<WTTEXT col="2" value="ATTR(Affiliate.Fax)" size="30"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Website" />
							<WTTEXT col="2" value="ATTR(Affiliate.Website)" size="60" />
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="TabTerms">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW>
							<WTCONDITION expr="NotAffiliateOnly"/>
							<WTMEMO col="1" merge="2" align="left" value="ATTR(Affiliate.Terms)" rows="8" cols="72" htmleditor="editor_simple"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="IsAffiliateOnly"/>
							<WTSTATIC col="1" merge="2" align="left" value="ATTR(Affiliate.Terms)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				
				<WTROW id="TabNotes">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTCONDITION expr="NotAffiliateOnly"/>
						<WTROW margin-bottom="6">
							<WTFRAME col="1" merge="2" src="CONST(9011.asp?OwnerType=6&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@affiliateid&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/TXN/PTSAFFILIATE/@AffiliateName&quot;/&gt;)" name="NotesFrame" frmwidth="600" frmheight="250" label="NoFrameSupport" border="0"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" align="center" msg="ConfirmDelete">
						<WTCONDITION expr="IsActive"/>
						<WTCONDITION expr="NotAffiliateOnly" connector="and"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0604" caption="Affiliate Back-Office" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="AffiliateID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
		 			<WTCONDITION expr="PARAM(AffiliateID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(AffiliateID)" value="SYS(AffiliateID)"/>
				</WTCODEGROUP>
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpLeadCampaigns)" value="ATTR(LeadCampaigns)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="LeadCampaigns" project="ptsLeadCampaignUser" class="CLeadCampaigns">
					<WTMETHOD name="ListAffiliate">
			 			<WTCONDITION expr="CONST(tmpLeadCampaigns)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)" />
					</WTMETHOD>
					<WTMETHOD name="ListAffiliateText">
			 			<WTCONDITION expr="CONST(tmpLeadCampaigns)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)" />
						<WTPARAM name="LeadCampaigns" direction="input" value="CONST(tmpLeadCampaigns)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlLeadCampaigns" direction="return" concat="true" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN />
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left" />
				<WTROW>
					<WTSTATIC col="1" label="LeadCampaigns" class="PageHeading" align="left" />
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="left" label="LeadProgramsText" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="LeadCampaign">
						<WTCOLUMN width="80" align="left" valign="top" label="LeadCampaignName"/>
						<WTCOLUMN width="20" align="right" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(LeadCampaign.LeadCampaignName)" space="1">
									<WTLINK name="1413">
										<WTPARAM name="LeadCampaignID" value="DATA(LeadCampaignID)" />
										<WTPARAM name="MemberID" value="ATTR(Affiliate.MemberID)" />
										<WTPARAM name="AffiliateID" value="PARAM(AffiliateID)" />
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@leadcampaignid&quot;/&gt;))" fontcolor="purple"/>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC label="Preview" space="2">
									<WTLINK name="lp" class="PageHeadingLink" target="preview">
										<WTPARAM name="p" value="DATA(LeadCampaignID)" />
										<WTPARAM name="Preview" value="CONST(1)" />
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC label="Usage">
									<WTLINK name="1413">
										<WTPARAM name="LeadCampaignID" value="DATA(LeadCampaignID)" />
										<WTPARAM name="MemberID" value="ATTR(Affiliate.MemberID)" />
										<WTPARAM name="AffiliateID" value="PARAM(AffiliateID)" />
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" value="DATA(LeadCampaign.Objective)" fontcolor="gray" />
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="NotAffiliateOnly"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0630" caption="Affiliate Confirmation" navbar="false" header="false" footer="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--=============================================================================================-->
			<WTPARAM name="AffiliateID" datatype="number"/>
			
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(AffiliateID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="const(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;AffiliateConfirm.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Continue" type="Continue">
				<WTRETURN>
					<WTLINK name="0101"/>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="10" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="470" align="left"/>
				<WTCOLUMN width="10"/>
	
				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="left" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="AffiliateID"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.AffiliateID)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="AffiliateName"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.AffiliateName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="ContactName"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.ContactName)"/>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Website"/>
					<WTSTATIC col="3">
						<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSAFFILIATE/@logon&quot;/&gt;.pinnaclep.com)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1" merge="2"/>
					<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Email"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Email)"/>
					<WTSTATIC col="3" tag="SSN"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.SSN)" prespace="false"/>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="EnrollDate"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.EnrollDate)"/>
				</WTROW>

				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Address"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Street)"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Unit)"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.City)"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.State)"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Zip)"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Country)"/>
				</WTROW>
				
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1" merge="2"/>
					<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Phone1"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Phone1)"/>
					<WTSTATIC col="3" tag="Phone2"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Phone2)" prespace="false"/>
					<WTSTATIC col="3" tag="Fax"/>
					<WTSTATIC col="3" value="ATTR(Affiliate.Fax)" prespace="false"/>
				</WTROW>

				<WTROW>  
					<WTBUTTON col="1" merge="4" align="center" action="1" value="Continue"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		
	</WTWEBPAGES>
</WTROOT>