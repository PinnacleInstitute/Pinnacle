<WTROOT prefix="pts" system="Pinnacle">

	<WTENTITY id="133" name="GFTG" alias="gg">
		<!--Identity-->
		<WTATTRIBUTE id="13301" name="GftgID" type="number" identity="true" title="true" min="1" required="true" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="13395" name="Result" type="text" length="1000" source="entity" persist="false"/>
		<WTATTRIBUTE id="13396" name="Status" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="13397" name="czDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="13398" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="13399" name="Amount" type="number" source="entity" persist="false"/>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Gftg" entity="Gftg" alias="gg"/>
		</WTRELATIONSHIPS>
	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="CustomList" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Gftg.GftgID)"/>
					<WTATTRIBUTE value="ATTR(Gftg.Result)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
<!-- Processing - Admin Page -->
		<!--==================================================================-->
		<WTWEBPAGE name="13300" caption="Gftg Processing" header="false" footer="false" navbar="false" wrapper="wrapper800" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="13300" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Process" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Result" datatype="text"/>

			<WTDATATXN name="Members"/>
			<WTDATATXN name="Gftgs"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="Payout.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="PaymentFile.asp"/>
			<WTINCLUDE name="Orders.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
			<WTINCLUDE name="DeclineEmail.asp"/>

			<WTCODEGROUP>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(13)"/>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<!-- Set this page to not timeout for 4 hours -->
				<WTCUSTOM>Server.ScriptTimeout = 14400</WTCUSTOM>				
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
			<!-- Disable Certain Features based on User Type -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsManagerOnly"/>
				<WTCUSTOM>If InStr( ",2,3,5,6,11,12,13,21,22,23,24,25,26,27,29,30,31,33,34,35,37,39,40,41,42,43,44,45,46,47,48,49,", CSTR(reqProcess)+"," ) = 0 Then reqProcess = 0</WTCUSTOM>
			</WTCODEGROUP>
<WTCUSTOM>
	'Set date range to previous month
	If reqOption = 0 Then
	reqFromDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqToDate = DateAdd( "d", -1, reqFromDate )
	reqFromDate = DateAdd( "m", -1, reqFromDate )
	End If
	'Set date range to current date
	If reqOption = 1 Then
	reqToDate = reqSysDate
	reqFromDate = reqSysDate
	End If
	'Set date range to previous month
	If reqOption = 2 Then
	reqToDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqFromDate = DateAdd( "m", -1, reqToDate )
	reqToDate = DateAdd( "d", -1, reqToDate )
	End If
	'Set date range to one month back from last Sunday
	If reqOption = 3 Then
	reqToDate = DateAdd( "d", -5, reqSysDate )
	reqFromDate = DateAdd( "m", -1, reqToDate )
	End If
	'Set date range to 1 week back
	If reqOption = 4 Then
	reqToDate = DateAdd( "d", -1, reqSysDate )
	reqFromDate = DateAdd( "d", -7, reqToDate )
	End If
	'Set date range to yesterday
	If reqOption = 5 Then
	reqFromDate = DateAdd( "d", -1, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 2 days ago
	If reqOption = 6 Then
	reqFromDate = DateAdd( "d", -2, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 3 days ago
	If reqOption = 7 Then
	reqFromDate = DateAdd( "d", -3, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 4 days ago
	If reqOption = 8 Then
	reqFromDate = DateAdd( "d", -4, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 5 days ago
	If reqOption = 9 Then
	reqFromDate = DateAdd( "d", -5, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set todate to 1 week back
	If reqOption = 11 Then
	reqToDate = DateAdd( "d", -7, reqSysDate )
	End If
	'Set todate to 2 weeks back
	If reqOption = 12 Then
	reqToDate = DateAdd( "d", -14, reqSysDate )
	End If
	'Set todate to 3 weeks back
	If reqOption = 13 Then
	reqToDate = DateAdd( "d", -21, reqSysDate )
	End If
	'Set todate to 4 weeks back
	If reqOption = 14 Then
	reqToDate = DateAdd( "d", -28, reqSysDate )
	End If
</WTCUSTOM>
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>

					<!-- Create Billing Tokens -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						<WTCUSTOM>
							Result = BillingTokens()
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " New Billing Tokens Successfully Created! (" + aResult(1) + " bad)"
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Create Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(200)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Autoship Payments Successfully Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Process Order Payments for Sales Orders and email bonus recipients -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						<WTCUSTOM>
							PaymentOwnerType = 52
							PostProcess = 1
							Result = ProcessPayments( reqCompanyID, PaymentOwnerType, "1/1/2099", PostProcess )
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " Payments Successfully Processed! (" + aResult(1) + " bad)"
						</WTCUSTOM>
						<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult">
							<WTCONDITION expr="CONST(aResult(0))" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- List Declined Token -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Tokens!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="Level" direction="input" value="CONST(4)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Declined Payments Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Verify Bonus Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Earn Bonuses!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Calculate Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						<WTOBJECT name="Commission" project="ptsCommissionUser" class="CCommission">
							<WTMETHOD name="CustomCommissions">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="CommType" direction="input" value="CONST(1)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="CONST(Amount)" value="CONST(0)"/>
							<WTMETHOD name="TotalCommissions">
								<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Bonuses Created! (&quot; &amp; FormatCurrency(Amount,2) &amp; &quot;)&quot;)"/>
						</WTOBJECT>
						<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult">
							<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
					
					<!-- Display Hidden Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(202)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Bonuses Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Create Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyPayouts">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payouts Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Payout Credits -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(4)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(30)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payment Credits Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Verify Payout Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(6)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Receive a Payout!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Create Payout Files -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS MARK PAYOUTS PAID AMOUNT -->
						<WTCALLSUB name="ExportWallet reqCompanyID, 12, reqToDate, -1, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; PayQuicker eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="ExportWallet reqCompanyID, 11, reqToDate, -1, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; iPayout eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="ExportWallet reqCompanyID, 13, reqToDate, -1, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; Solid Trust eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;No Payouts to Export!&quot;)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- Mark Payouts Paid -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS EXPORT PAYOUTS AMOUNT -->
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyStatus2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="PaidDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(-1)"/>
								<WTPARAM name="Reference" direction="input" value="CONST(&quot;3&quot;)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Pending Payouts Marked Paid!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Display Hidden Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(203)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Payouts Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Recalculate Group Sales Volume and Promotions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(1)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Group Sales Totals Recalculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Post sales summary -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(2)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Sales Summary Postings!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- List Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All New eWallets to be Created -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTOBJECT name="Gftgs" project="ptsGftgUser" class="CGftgs">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlGftgs" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;New eWallets to be imported to iPayout in a .CSV file!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Assign New eWallets to Payout Method -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New eWallets Assigned!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Mark GCC Payment Orders Pending (in process)-->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All New Global Cash Card orders marked pending!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Set All Member Alerts-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Member Alerts Set!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Clean up Data -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Data Cleaned Up!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Export Submitted Orders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Export Green Fuel Tab Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Submitted Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export Polydot Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; Polydot Submitted Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>
							<!-- Update These Submitted Orders to InProcess -->
							<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
								<WTMETHOD name="Custom2">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="Status" direction="input" value="CONST(101)"/>
									<WTPARAM name="OrderDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
									<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Export Inprocess Orders -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFTG Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
-->
					
					<!-- Update Inprocess Orders to Complete -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="OrderDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Inprocess Orders to Complete -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Email Commissions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						<WTCALLSUB name="CommissionEmail reqCompanyID, 0, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Commission Emails Sent&quot;)"/>
					</WTCODEGROUP>

					<!-- Recalculate All Title Advancements -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(15)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Title Advancements Calculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>


					<!-- Export Payment to process -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						<WTSETATTRIBUTE name="CONST(PaymentOwnerType)" value="CONST(52)"/>
						<WTCALLSUB name="ExportPayments reqCompanyID, PaymentOwnerType, &quot;1/1/2099&quot;, CCTotal, CKTotal, CCFile, CKFile, ErrorMsg"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(ErrorMsg)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTCUSTOM>
								response.write ErrorMsg
								response.end
							</WTCUSTOM>
						</WTCODEGROUP>
						<!-- Exported CC Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/Billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CCFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CCTotal) + &quot; CC Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Exported ACH Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CKTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CKFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CKTotal) + &quot; ACH Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(CCTotal + CKTotal)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- Update Binary Sales -->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payments Updated in the Binary Sales Volume!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Update Binary Counts -->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						<WTOBJECT name="Gftg" project="ptsGftgUser" class="CGftg">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(301)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Binary Downline member counts Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->					

					<!-- List Top Recruiters -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(99)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Recruiters!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Earners -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(98)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Earners!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Countries -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(97)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Countries!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Email Members with Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="DeclineEmail reqCompanyID, 0, 1, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Declined Payments Emailed!&quot;)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<!-- Suspend Payments -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(207)"/>
							<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Suspended with Declined Payments!&quot;)"/>
					</WTOBJECT>
				</WTCODEGROUP>

				<!-- Cancel Suspended Payments -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(208)"/>
							<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Suspended Members Cancelled with Declined Payments!&quot;)"/>
					</WTOBJECT>
				</WTCODEGROUP>

			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="center"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(Result)" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="24">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC label="NotAvailable">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="BillingTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateDeclined">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						</WTSTATIC>
						<WTSTATIC label="BonusQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						</WTSTATIC>
						<WTSTATIC label="CalcBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentCredits">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutPaid">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayPayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSummary">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						</WTSTATIC>
						<WTSTATIC label="ListOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						</WTSTATIC>
						<WTSTATIC label="CreateWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						</WTSTATIC>
						<WTSTATIC label="AssignWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						</WTSTATIC>
						<!--
						<WTSTATIC label="MarkGCC">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="SetAlerts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						</WTSTATIC>
						<WTSTATIC label="CleanupData">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						</WTSTATIC>
						<WTSTATIC label="EmailCommissions">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						</WTSTATIC>
						<WTSTATIC label="TitleAdvancements">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						</WTSTATIC>
<!--						
						<WTSTATIC label="UpdateBinarySales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateBinaryCount">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="TopRecruiters">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						</WTSTATIC>
						<WTSTATIC label="TopEarners">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						</WTSTATIC>
						<WTSTATIC label="TopCountries">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineEmail">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineSuspend">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineCancel">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTSTATIC col="1" label="From" align="center" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
					<WTTEXT col="1" align="center" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(cashregister.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0436d" return="false" target="Declines">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@status&quot;/&gt;)" space="3"/>
<!--
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
-->									
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" label="eWalletHdr" align="left"/>
						</WTROW>
						<WTROW>
							<WTREPEAT entity="Gftg">
								<WTROW>
									<WTSTATIC col="1" value="DATA(Result)" align="left"/>
								</WTROW>
							</WTREPEAT>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" action="1" value="CONST(Process)" align="center">
						<WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Member Change Membership Options Page -->
		<!--============================================================================================-->
		<WTWEBPAGE name="13301" caption="Change Membership" navbar="false" header="false" footer="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="13301" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="OrderOption" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="Amount" datatype="number"/>
			<WTPARAM name="BillingPrice" datatype="number"/>
			<WTPARAM name="CountryID" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="Result" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(13)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="NewBilling">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(.Title + 1)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(0)">
						<WTCONDITION expr="PARAM(Membership)" oper="greater" value="CONST(4)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(1)"/>
						<!-- Set AutoShip Order Option -->
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(1)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;104&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(2)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;105&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(3)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;106&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(4)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;107&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(5)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;108&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(6)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;109&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(7)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;111&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>

					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(21)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;224&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(22)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;225&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(23)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;226&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(24)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;227&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(25)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;228&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(26)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;229&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(27)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;221&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>

					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(31)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;334&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(32)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;335&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(33)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;336&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(34)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;337&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(35)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;338&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(36)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;339&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(37)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;331&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>

					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(PayType)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
				</WTOBJECT>
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Upgrade.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="FetchOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryID)" value="ATTR(CountryID)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewBilling"/>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to recurring billing."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(0)"/>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(1)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					<WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdateBilling)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					
					<WTSETATTRIBUTE name="CONST(oldPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Member.Title)"/>
					<WTSETATTRIBUTE name="CONST(oldMembership)" value="CONST(.Title + 1)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>

					<!-- **************************************************************** -->
					<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(0)"/>

					<!-- Set Autoship options -->
					<WTCODEGROUP>
						<!-- Autoship Pack #1 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;104&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(46.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(52.95)">
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #2 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;105&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(47.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(53.95)">
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #3 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;106&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(47.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(53.95)">
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #4 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(4)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;107&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(48.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(54.95)">
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #5 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(5)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;108&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(48.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(54.95)">
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #6 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(6)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;109&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(48.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(54.95)">
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #7 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(7)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;111&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(66.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(75.95)">
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<!-- Autoship Pack #21 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(21)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;224&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(91.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(104.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #22 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(22)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;225&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(93.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(106.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #23 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(23)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;226&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(93.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(106.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #24 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(24)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;227&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(95.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(108.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #25 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(25)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;228&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(95.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(108.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #26 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(26)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;229&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(95.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(108.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #27 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(27)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;221&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(131.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(144.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<!-- Autoship Pack #31 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(31)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;334&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(135.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(148.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #32 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(32)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;335&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(138.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(151.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #33 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(33)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;336&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(138.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(151.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #34 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(34)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;337&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(141.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(154.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #35 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(35)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;338&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(141.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(154.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #36 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(36)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;339&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(141.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(154.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Autoship Pack #37 -->
						<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(37)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;331&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(197.95)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(210.95)">
							<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>

					<!-- Upgrade Autoship Only -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
						<!-- remove all old autoship codes -->
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;104&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;105&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;106&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;107&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;108&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;109&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;111&quot;, &quot;&quot;))"/>

						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;224&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;225&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;226&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;227&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;228&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;229&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;221&quot;, &quot;&quot;))"/>

						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;334&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;335&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;336&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;337&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;338&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;339&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;331&quot;, &quot;&quot;))"/>

						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(.Options2 + &quot;,&quot; + tmpCode )"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>

					<!-- Wholsale Buyer -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldTitle)" oper="equal" value="CONST(0)"/>
						<!-- Upgrade to Affiliate -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(Price)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<!-- Upgrade to Silver -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;101,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(206.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(212.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<!-- Upgrade to Gold -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(206.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(212.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<!-- Upgrade to Platinum -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(357.40)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(366.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="ATTR(Options2)"/>
					</WTCODEGROUP>

					<!-- Affiliate -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldTitle)" oper="equal" value="CONST(1)"/>
						<!-- Upgrade to Silver $179 -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;121,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(185.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(191.95)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<!-- Upgrade to Gold $229 -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;122,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(235.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(241.95)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<!-- Upgrade to Platinum $329 -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;123,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(335.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(341.95)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="ATTR(Options2)"/>
					</WTCODEGROUP>

					<!-- Silver -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldTitle)" oper="equal" value="CONST(2)"/>
						<!-- Upgrade to Gold $70 -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;124,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(76.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(82.95)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<!-- Upgrade to Platinum $170 -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;125,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(176.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(182.95)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="ATTR(Options2)"/>
					</WTCODEGROUP>

					<!-- Gold -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldTitle)" oper="equal" value="CONST(3)"/>
						<!-- Upgrade to Platinum $120 -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Member.Title)" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;126,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(126.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(132.95)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(1)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="ATTR(Options2)"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="CONST(newTitle)" value="ATTR(Member.Title)"/>

					<!-- Temporarily turn off payment processing-->
<!--					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>-->

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Qualify)" oper="not-equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>

					<!-- If there is a change to the membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdate)" oper="not-equal" value="CONST(0)"/>
						<!-- Get Payment -->
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(1)"/>

							<WTCUSTOM>
								tmpProcessor = ""
								tmpAcct = ""
								Select Case reqPayType
								Case 1, 2, 3, 4	'Process Credit Cards
								tmpProcessor = tmpCardProcessor
								tmpAcct = tmpCardAcct
								Case 5 'Process Electronic Checks
								tmpProcessor = tmpCheckProcessor
								tmpAcct = tmpCheckAcct
								End Select
							</WTCUSTOM>
							<WTCALLSUB name="Result = SubmitPayment( reqCompanyID, reqMemberID, reqPayType, reqPayDesc, reqBillingPrice, Purpose, PostProcess )"/>
<!--						<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, reqBillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>-->
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
								<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(tmpUpdatePaidDate)" oper="not-equal" value="CONST(0)"/>
									<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
									<WTMETHOD name="Save">
										<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
									</WTMETHOD>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<!-- log the membership change -->
						<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE: (&quot; + oldOptions2 + &quot;) to (&quot; + .Options2 + &quot;)&quot;">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
						<WTCALLSUB name="reqBillingPrice = FormatCurrency( reqBillingPrice, 2 )">
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>

				<!-- If there is a change to the member's title -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(newTitle)" oper="not-equal" value="CONST(oldTitle)" connector="and"/>
					<!-- log the title change -->
					<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
						<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="PARAM(MemberID)"/>
						<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
						<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(newTitle)"/>
						<WTSETATTRIBUTE name="ATTR(MemberTitle.IsEarned)" value="CONST(1)"/>
						<WTMETHOD name="Add">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTOBJECT>
					<!-- notify the referrer -->
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTCONDITION expr="CONST(tmpReferralID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpReferralID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)"/>
						<WTCUSTOM>
							tmpSender = "support@gft-global.com"
							tmpFrom = "support@gft-global.com"
							Select Case newTitle
							Case 1
							tmpSubject = tmpName + " has upgraded to an Affiliate"
							Case 2
							tmpSubject = tmpName + " has upgraded to the Silver Pack"
							Case 3
							tmpSubject = tmpName + " has upgraded to the Gold Pack"
							Case 4
							tmpSubject = tmpName + " has upgraded to the Platinum Pack"
							End Select
							tmpBody = tmpSubject
							SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
						</WTCUSTOM>
					</WTOBJECT>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadBilling"/>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="175" align="center"/>
				<WTCOLUMN width="575" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="PARAM(CountryID)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
					//var countryid = document.getElementById('CountryID').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none';
					var paytype = payobj.value;
					//var l = payobj.length;
					//for( i = 0; i &lt; l; i++ ) {
					//	if (payobj[i].checked) {
					//		paytype = payobj[i].value;
					//		i = l;
					//	}
					//}
					//if (paytype == 5) {
					//	if ( countryid != 224 ) {
					//		paytype = 1;
					//		document.getElementById('PayType').value = paytype;
					//		alert("Electronic Checks not available outside the United States");
					//	}
					//}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
					ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowCC()">
					var disp, computers = document.getElementById('Computers').value;
					if( computers == 0 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					document.getElementById('Payment').style.display = disp;
					document.getElementById('CardRows').style.display = disp;
					document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="formatCurrency(num)">
					num = num.toString().replace(/\$|\,/g,'');
					if(isNaN(num))
					num = "0";
					sign = (num == (num = Math.abs(num)));
					num = Math.floor(num*100+0.50000000001);
					cents = num%100;
					num = Math.floor(num/100).toString();
					if(cents&lt;10)
					cents = "0" + cents;
					for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
					num = num.substring(0,num.length-(4*i+3))+','+
					num.substring(num.length-(4*i+3));
					return (((sign)?'':'-') + '$' + num + '.' + cents);
					//return (((sign)?'':'-') + '$' + num);
				</WTFUNCTION>
				
				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="2"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="SuccessfulChange" value="ATTR(Member.Price)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" merge="2" label="SuccessfulPayment" value="PARAM(BillingPrice)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Continue)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>

					<WTROW margin-bottom="12">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="690" align="left"/>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="0" align="left" valign="top" datapathx="/DATA/PARAM/@membership=0"/>
								<WTSTATIC col="3" label="Membership_0"/>
							</WTROW>
							<WTROW margin-top="12">
								<WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(1)"/>
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership_0_1"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership_0_1i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(2)"/>
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
								<WTSTATIC col="3">
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(0)"/>
										<WTSTATIC label="Membership_0_2"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_0_2i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
										<WTSTATIC label="Membership_1_2"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_1_2i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(3)"/>
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
								<WTSTATIC col="3">
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(0)"/>
										<WTSTATIC label="Membership_0_3"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_0_3i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
										<WTSTATIC label="Membership_1_3"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_1_3i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
										<WTSTATIC label="Membership_2_3"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_2_3i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(4)"/>
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
								<WTSTATIC col="3">
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(0)"/>
										<WTSTATIC label="Membership_0_4"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_0_4i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
										<WTSTATIC label="Membership_1_4"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_1_4i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
										<WTSTATIC label="Membership_2_4"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_2_4i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
										<WTSTATIC label="Membership_3_4"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
										<WTSTATIC label="Membership_3_4i"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<WTROW margin-top="24">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" label="OrderOption13_Text1" class="PageHeading" fontcolor="blue" align="left"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=1"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption_1" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption_1i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=2"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption_2" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption_2i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=3"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption_3" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption_3i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=4"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption_4" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption_4i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="5" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=5"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption_5" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption_5i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="6" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=6"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption_6" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption_6i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="7" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=7"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption_7" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption_7i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>

							<WTROW margin-top="24">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" label="OrderOption13_Text2" class="PageHeading" fontcolor="blue" align="left"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="21" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=21"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_21" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_21i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="22" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=22"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_22" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_22i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="23" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=23"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_23" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_23i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="24" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=24"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_24" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_24i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="25" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=25"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_25" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_25i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="26" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=26"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_26" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_26i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="27" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=27"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_27" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_27i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>

							<WTROW margin-top="24">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" label="OrderOption13_Text3" class="PageHeading" fontcolor="blue" align="left"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="31" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=31"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_31" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_31i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="32" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=32"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_32" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_32i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="33" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=33"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_33" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_33i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="34" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=34"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_34" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_34i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="35" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=35"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_35" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_35i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="36" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=36"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_36" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_36i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="OrderOption" name="37" align="left" valign="top" datapathx="/DATA/PARAM/@orderoption=37"/>
								<WTSTATIC col="3">
									<WTSTATIC label="OrderOption13_37" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption13_37i" bold="true"><WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTSTATIC>
							</WTROW>

						</WTTABLE>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr = "ATTR(Member.BillingID)" oper="equal" value="CONST(0)" />
						<WTROW margin-top="12" id="Agree2">
							<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW id="Payment">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="750" align="center"/>

								<WTROW margin-top="12" margin-bottom="12">
									<WTDIVIDER col="1" height="1" color="#584b42"/>
								</WTROW>
								<WTROW id="Pay2" margin-bottom="6">
									<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="6">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="CardRows">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="BillingAddress" />
									<WTTEXT col="2" value="PARAM(Street1b)" size="60">
										<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left" required="true">
										<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
						</WTROW>
						
					</WTCODEGROUP>
					
					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Change)" align="center"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="13302" caption="GFTG Stats" header="false" footer="false" navbar="false" action="0" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="13302">
			<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					If reqDay &gt; 0 Then reqToday = DateAdd("d", reqDay * -1, reqSysDate) Else reqToday = reqSysDate
					Select Case DATEPART("w", reqToday )
					Case 1 reqToday = reqToday &amp; " Sunday"
					Case 2 reqToday = reqToday &amp; " Monday"
					Case 3 reqToday = reqToday &amp; " Tuesday"
					Case 4 reqToday = reqToday &amp; " Wednesday"
					Case 5 reqToday = reqToday &amp; " Thursday"
					Case 6 reqToday = reqToday &amp; " Friday"
					Case 7 reqToday = reqToday &amp; " Saturday"
					End Select
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="GFTG" project="ptsGFTGUser" class="CGFTG">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(7)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="center"/>
				<WTCOLUMN width="6" align="center"/>
				<WTCOLUMN width="300" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="GFTGStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Members"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Wholesale" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m01)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m07)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m099)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Affiliate" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m11)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m17)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m199)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Silver" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m21)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m27)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m299)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Gold" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m31)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m37)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m399)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Platinum" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m41)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m47)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m499)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Emerald+" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m51)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m57)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m599)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.T1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.T7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.T99)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
					<WTSTATIC col="2"/>
					<WTTABLE col="3" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Sales"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Today" bold="true" align="center"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.S1)" align="center"/>
									<WTSTATIC col="2" value="ATTR(Stats.S7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.S30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.S99)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Bonuses"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Today" bold="true" align="center"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.P1)" align="center"/>
									<WTSTATIC col="2" value="ATTR(Stats.P7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.P30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.P99)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12">
					<WTTABLE col="1" merge="3">
						<WTCOLUMN width="606" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="10" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="SupportTickets"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="1hr" bold="true"/>
									<WTSTATIC col="3" label="4hr" bold="true"/>
									<WTSTATIC col="4" label="12hr" bold="true"/>
									<WTSTATIC col="5" label="1day" bold="true"/>
									<WTSTATIC col="6" label="2day" bold="true"/>
									<WTSTATIC col="7" label="3day" bold="true"/>
									<WTSTATIC col="8" label="7day" bold="true"/>
									<WTSTATIC col="9" label="14day" bold="true"/>
									<WTSTATIC col="10" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Submitted" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z1a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z1b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z1c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z1d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z1e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z1f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z1g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z1h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z1t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Assigned" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z2a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z2b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z2c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z2d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z2e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z2f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z2g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z2h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z2t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Resolved" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z3a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z3b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z3c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z3d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z3e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z3f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z3g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z3h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z3t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Postponed" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z4a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z4b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z4c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z4d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z4e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z4f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z4g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z4h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z4t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z5a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z5b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z5c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z5d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z5e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z5f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z5g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z5h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z5t)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>