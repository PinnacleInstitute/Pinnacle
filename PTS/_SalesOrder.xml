<WTROOT prefix="pts" system="Pinnacle">
	<WTENTITY id="52" name="SalesOrder" alias="so">
		<!--Identity-->
		<WTATTRIBUTE id="5201" name="SalesOrderID" type="number" identity="true" min="1" required="true" title="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="5202" name="CompanyID" type="number" source="entity"/>
		<WTATTRIBUTE id="5203" name="MemberID" type="number" source="entity" />
		<WTATTRIBUTE id="5204" name="ProspectID" type="number" source="entity" />
		<WTATTRIBUTE id="5205" name="AffiliateID" type="number" source="entity" />
		<WTATTRIBUTE id="5206" name="PromotionID" type="number" source="entity" />
		<WTATTRIBUTE id="5207" name="PartyID" type="number" source="entity" />
		<WTATTRIBUTE id="5208" name="AddressID" type="number" source="entity" />

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="5210" name="NameLast" type="text" length="30" source="join">
			<WTJOIN entity="Member" name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="5211" name="NameFirst" type="text" length="30" source="join">
			<WTJOIN entity="Member" name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="5212" name="MemberName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameLast"/>
			<WTCOMPUTE text=", "/>
			<WTCOMPUTE name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="5213" name="ProspectName" type="text" length="60" source="join">
			<WTJOIN entity="Prospect" name="ProspectName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="5214" name="PromotionName" type="text" length="60" source="join">
			<WTJOIN entity="Promotion" name="PromotionName"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="5221" name="OrderDate" type="date" source="entity" />
		<WTATTRIBUTE id="5222" name="Amount" type="currency" min="0" max="99999999.99" source="entity" />
		<WTATTRIBUTE id="5223" name="Tax" type="currency" min="0" max="999999.99" source="entity" />
		<WTATTRIBUTE id="5224" name="Total" type="currency" min="0" max="99999999.99" source="entity" />
		<WTATTRIBUTE id="5225" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Submitted"/>
			<WTENUM id="2" name="Inprocess"/>
			<WTENUM id="3" name="Complete"/>
			<WTENUM id="4" name="Cancelled"/>
			<WTENUM id="5" name="Returned"/>
			<WTENUM id="6" name="Backorder"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="5226" name="Notes" type="text" length="1000" min="1" max="1000" source="entity"/>
		<WTATTRIBUTE id="5227" name="Discount" type="currency" min="0" max="999999.99" source="entity"/>
		<WTATTRIBUTE id="5228" name="Shipping" type="currency" min="0" max="999999.99" source="entity"/>
		<WTATTRIBUTE id="5229" name="Ship" type="number" source="entity">
			<WTENUM id="1" name="Ship1"/>
			<WTENUM id="2" name="Ship2"/>
			<WTENUM id="3" name="Ship3"/>
			<WTENUM id="4" name="Ship4"/>
			<WTENUM id="5" name="Ship5"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="5230" name="IsTaxable" type="yesno" source="entity"/>
		<WTATTRIBUTE id="5231" name="IsRecur" type="yesno" source="entity"/>
		<WTATTRIBUTE id="5232" name="PinnDate" type="date" source="entity"/>
		<WTATTRIBUTE id="5233" name="PinnAmount" type="currency" min="0" max="999999.99" source="entity"/>
		<WTATTRIBUTE id="5234" name="CommDate" type="date" source="entity"/>
		<WTATTRIBUTE id="5235" name="CommAmount" type="currency" min="0" max="999999.99" source="entity"/>
		<WTATTRIBUTE id="5236" name="AutoShip" type="number" source="entity">
			<WTENUM id="1" name="AutoShip1"/>
			<WTENUM id="2" name="AutoShip2"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="5237" name="IsActive" type="yesno" source="entity"/>
		<WTATTRIBUTE id="5238" name="BV" type="currency" min="0" max="99999999.99" source="entity"/>
		<WTATTRIBUTE id="5239" name="Track" type="text" length="40" min="1" max="40" source="entity" language="false"/>
		<WTATTRIBUTE id="5240" name="Valid" type="number" source="entity"/>

		<!--Non Persistant Attributes-->
		<WTATTRIBUTE id="5296" name="Result" type="text" length="2000" source="entity" persist="false" language="false"/>
		<WTATTRIBUTE id="5297" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="5298" name="ReportFromDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="5299" name="ReportToDate" type="date" source="entity" persist="false"/>
		
		<!--Indexes-->
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID" />
			<WTATTRIBUTE name="OrderDate" />
		</WTINDEX>
		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID" />
			<WTATTRIBUTE name="OrderDate" />
		</WTINDEX>
		<WTINDEX name="ProspectID">
			<WTATTRIBUTE name="ProspectID" />
			<WTATTRIBUTE name="OrderDate" />
		</WTINDEX>
		<WTINDEX name="PromotionID">
			<WTATTRIBUTE name="PromotionID"/>
		</WTINDEX>
		<WTINDEX name="PartyID">
			<WTATTRIBUTE name="PartyID"/>
		</WTINDEX>
		<WTINDEX name="AffiliateID">
			<WTATTRIBUTE name="AffiliateID"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="SalesOrder" entity="SalesOrder" alias="so" />
			<WTRELATIONSHIP name="Common" entity="SalesOrder" alias="so">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="so" name="MemberID" relalias="me" relname="MemberID" />
				</WTENTITY>
				<WTENTITY name="Prospect" entity="Prospect" alias="pr">
					<WTATTRIBUTE alias="so" name="ProspectID" relalias="pr" relname="ProspectID" />
				</WTENTITY>
				<WTENTITY name="Promotion" entity="Promotion" alias="pm">
					<WTATTRIBUTE alias="so" name="PromotionID" relalias="pm" relname="PromotionID" />
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Report" entity="SalesOrder" alias="so">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="so" name="MemberID" relalias="me" relname="MemberID" />
				</WTENTITY>
				<WTENTITY name="Prospect" entity="Prospect" alias="pr">
					<WTATTRIBUTE alias="so" name="ProspectID" relalias="pr" relname="ProspectID" />
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Prospect" entity="SalesOrder" alias="so">
				<WTENTITY name="Prospect" entity="Prospect" alias="pr">
					<WTATTRIBUTE alias="so" name="ProspectID" relalias="pr" relname="ProspectID" />
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Member" entity="SalesOrder" alias="so">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="so" name="MemberID" relalias="me" relname="MemberID" />
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>
		
		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="OrderDate" default="true" />
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="ProspectName"/>
			<WTATTRIBUTE name="SalesOrderID"/>
			<WTATTRIBUTE name="AffiliateID"/>
			<WTATTRIBUTE name="PromotionID"/>
			<WTATTRIBUTE name="Amount"/>
			<WTATTRIBUTE name="PinnAmount"/>
			<WTATTRIBUTE name="CommAmount"/>
			<WTATTRIBUTE name="Notes" contains="true"/>
		</WTENUM>

		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="STATUS-SUBMITTED" value="1"/>
			<WTSYSCON name="STATUS-INPROCESS" value="2"/>
			<WTSYSCON name="STATUS-COMPLETE" value="3"/>
			<WTSYSCON name="STATUS-CANCELLED" value="4"/>
			<WTSYSCON name="STATUS-RETURNED" value="5"/>
			<WTSYSCON name="PAYTYPE-VISA" value="1"/>
			<WTSYSCON name="PAYTYPE-CREDITCARD" value="4"/>
			<WTSYSCON name="PAYTYPE-CHECK" value="5"/>
			<WTSYSCON name="BILL-PAYTYPE-CREDITCARD" value="1"/>
			<WTSYSCON name="BILL-PAYTYPE-CHECK" value="2"/>
			<WTSYSCON name="PAYSTATUS-SUBMITTED" value="1"/>
			<WTSYSCON name="PAYSTATUS-APPROVED" value="3"/>
			<WTSYSCON name="FULFILL-COURSE" value="1"/>
			<WTSYSCON name="FULFILL-ASSESSMENT" value="2"/>
			<WTSYSCON name="FULFILL-DOWNLOAD" value="3"/>
			<WTSYSCON name="FULFILL-CUSTOM" value="4"/>
			<WTSYSCON name="LOCKS-NOEDIT" value="1"/>
			<WTSYSCON name="LOCKS-NODELETE" value="2"/>
			<WTSYSCON name="AUTOSHIP-ORDER" value="1"/>
			<WTSYSCON name="AUTOSHIP-TEMPLATE" value="2"/>
			<WTSYSCON name="ORDER-PICKUP" value="5"/>
		</WTSYSCONS>

	</WTENTITY>
	
	<WTPROCEDURES>
		<!--===================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" />
		<!--===================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(SalesOrderID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTCODEGROUP>
					<WTPROCEDURE name="SalesItem_DeleteSalesOrder">
						<WTPARAM name="ATTR(SalesOrderID)" direction="input" value="PARAM(SalesOrderID)"/>
						<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					</WTPROCEDURE>
				</WTCODEGROUP>
				<WTDELETE>
					<WTJOIN name="SalesOrder" lock="true"/>
					<WTCONDITION expr="ATTR(SalesOrder.SalesOrderID)" oper="equal" value="PARAM(SalesOrderID)"/>
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common" />
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(SalesOrder.CompanyID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(SalesOrder.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Find" name="FindStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(SalesOrder.CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(SalesOrder.Status)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(SalesOrder.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(SalesOrder.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date" />
			<WTCODEGROUP>
				<WTSETVALUE name="Now" value="SYS(timestamp)" />
				<WTUPDATE>
					<WTJOIN name="SalesOrder" lock="true" />
					<WTCONDITION expr="ATTR(SalesOrder.SalesOrderID)" oper="equal" value="PARAM(SalesOrderID)" />
				</WTUPDATE>
				<WTPROCEDURE name="SalesOrder_ComputeTotalPrice">
					<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
				</WTPROCEDURE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ListDate" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.CompanyID)" direction="input" />
			<WTPARAM name="ATTR(SalesOrder.OrderDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)" />
					<WTATTRIBUTE value="ATTR(Member.NameFirst)" alias="NameFirst"/>
					<WTATTRIBUTE value="ATTR(Member.NameLast)" alias="NameLast"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Notes)" />
					<WTJOIN name="Report" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(SalesOrder.OrderDate)" exprfunc="wtfn_DateOnly" oper="equal" value="PARAM(OrderDate)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="less-equal" value="CONST(3)" connector="and"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ListMember" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.MemberID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.BV)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Status)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Notes)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.IsRecur)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.ProspectID)"/>
					<WTATTRIBUTE value="ATTR(Prospect.ProspectName)" alias="ProspectName"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Track)"/>
					<WTJOIN name="Prospect" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="not-equal" value="CONST(0)" connector="and"/>
<!--
					<WTCONDITION expr="ATTR(Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="less-equal" value="CONST(3)" connector="and"/>
-->					
					<WTORDER name="ATTR(OrderDate)" descend="true"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ListParty" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.PartyID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.BV)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Status)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Notes)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.IsRecur)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.ProspectID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.PartyID)" oper="equal" value="PARAM(PartyID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="less-equal" value="CONST(3)" connector="and"/>
					<WTORDER name="ATTR(OrderDate)" descend="true"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ListProspect" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.ProspectID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.BV)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Status)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Notes)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.IsRecur)" />
					<WTJOIN name="SalesOrder" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.ProspectID)" oper="equal" value="PARAM(ProspectID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="less-equal" value="CONST(3)" connector="and"/>
					<WTORDER name="ATTR(OrderDate)" descend="true"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ListAutoShip" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.MemberID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Notes)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.IsActive)" />
					<WTATTRIBUTE value="ATTR(SalesOrder.Valid)" />
					<WTJOIN name="SalesOrder" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)" connector="and"/>
					<WTORDER name="ATTR(IsActive)" descend="true"/>
					<WTORDER name="ATTR(OrderDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ListPromotion" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.PromotionID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)"/>
					<WTATTRIBUTE value="ATTR(Member.NameFirst)" alias="NameFirst"/>
					<WTATTRIBUTE value="ATTR(Member.NameLast)" alias="NameLast"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Amount)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)"/>
					<WTJOIN name="Report" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.PromotionID)" oper="equal" value="PARAM(PromotionID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="less-equal" value="CONST(3)" connector="and"/>
					<WTORDER name="ATTR(OrderDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ReportCompany" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.MemberID)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.MemberName)" alias="MemberName"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Amount)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Shipping)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Tax)"/>
					<WTJOIN name="Report" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="less-equal" value="CONST(3)" connector="and"/>
					<WTCONDITION expr="ATTR(OrderDate)" oper="greater-equal" value="PARAM(ReportFromDate)" connector="and"/>
					<WTCONDITION expr="ATTR(OrderDate)" oper="less-equal" value="PARAM(ReportToDate)" connector="and"/>
					<WTORDER name="ATTR(OrderDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="List" name="ReportAffiliate" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SalesOrder.AffiliateID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.OrderDate)"/>
					<WTATTRIBUTE value="ATTR(Member.NameFirst)" alias="NameFirst"/>
					<WTATTRIBUTE value="ATTR(Member.NameLast)" alias="NameLast"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Amount)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)"/>
					<WTJOIN name="Report" lock="false"/>
					<WTCONDITION expr="ATTR(SalesOrder.AffiliateID)" oper="equal" value="PARAM(AffiliateID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="less-equal" value="CONST(3)" connector="and"/>
					<WTCONDITION expr="ATTR(OrderDate)" oper="greater-equal" value="PARAM(ReportFromDate)" connector="and"/>
					<WTCONDITION expr="ATTR(OrderDate)" oper="less-equal" value="PARAM(ReportToDate)" connector="and"/>
					<WTORDER name="ATTR(OrderDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="GetPromotion" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(SalesOrderID)" direction="input"/>
			<WTPARAM name="ATTR(NameLast)" direction="input"/>  <!-- Promotion Code -->
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="ProductEmails" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(SalesOrderID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="500"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="ProductFulfillment" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(SalesOrderID)" direction="input"/>
			<WTPARAM name="ATTR(Quantity)" direction="input"/>  <!-- Fulfill type -->
			<WTPARAM name="Result" direction="output" datatype="text" length="500"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="GetShipping" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(SalesOrderID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="UpdateRecurring" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(OrderDate)" direction="input"/>
			<WTPARAM name="ATTR(SalesOrderID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="SetAutoShip" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(SalesOrderID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>	<!-- Custom Calculation # -->
			<WTPARAM name="ATTR(SalesOrderID)" direction="input" required="false" passthru="true"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom2" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>	<!-- Custom # -->
			<WTPARAM name="ATTR(OrderDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="CustomList" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/> 	<!-- Custom List # -->
			<WTPARAM name="ATTR(OrderDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Result)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="CustomList2" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/> <!-- Custom List # -->
			<WTPARAM name="ATTR(ReportFromDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SalesOrder.SalesOrderID)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Total)"/>
					<WTATTRIBUTE value="ATTR(SalesOrder.Result)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="DeleteAbandoned" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5201" header="false" footer="false" navbar="false" caption="Find" action="5" wrapper="wrapper900" page-left="10"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="125">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="SearchText" datatype="text" />
			<WTPARAM name="FindTypeID" datatype="number" />
			<WTPARAM name="Bookmark" datatype="text" />
			<WTPARAM name="Direction" datatype="number" />

      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(OrderDate)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)" />
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)" />
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(15)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark" />
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)" />
			</WTACTION>
			
			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)" />
			</WTACTION>
			
			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)" />
			</WTACTION>

			<WTACTION id="8" name="Delete" type="New">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="DeleteAbandoned">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)" />
				<WTMETHOD name="Find">
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text" />
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="FindStatus">
					<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text" />
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlSalesOrders" direction="return" datatype="text" />
					<WTPARAM name="Option" direction="input" value="CONST(15)" />
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)" />
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text" />
				</WTMETHOD>
			</WTOBJECT>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="900" align="left"/>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="500" align="left"/>
						<WTCOLUMN width="400" align="right"/>
						<WTROW>
							<WTSTATIC col="1" label="FindSalesOrder" class="PageHeading"/>
							<WTBUTTON col="2" action="8" value="CONST(DeleteAbandoned)" btnclass="smbutton">
								<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
							</WTBUTTON>
              <WTSTATIC col="2" bold="true">
                <WTSTATIC label="Report">
                  <WTLINK name="5214" target="Report">
                  <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
                </WTLINK>
                </WTSTATIC>
                <WTSTATIC space="1"/>
                <WTSTATIC value="CONST(|)" space="1"/>
                <WTSTATIC label="UpdateTracking">
                  <WTLINK name="5225" target="Import">
                    <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
                  </WTLINK>
                </WTSTATIC>
              </WTSTATIC>
            </WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" />
					<WTCOMBO col="1" value="ATTR(SalesOrders.FindTypeID)" translate="true" prespace="false"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader" />
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true" prespace="false" />
					<WTSTATIC col="1" tag="Status" class="ColumnHeader"/>
					<WTCOMBO col="1" value="PARAM(Status)" prespace="false">
						<WTOPTION id="0" label="All"/>
						<WTOPTION id="1" label="Submitted"/>
						<WTOPTION id="2" label="Inprocess"/>
						<WTOPTION id="3" label="Complete"/>
						<WTOPTION id="4" label="Cancelled"/>
						<WTOPTION id="5" label="Returned"/>
					</WTCOMBO>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true" />
				</WTROW>
				
				<WTROW>
					<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" prevnext="true" entity="SalesOrder">
						<WTCOLUMN width="10" align="left" valign="top" label="OrderDate" />
						<WTCOLUMN width="10" align="left" valign="top" label="Status" />
						<WTCOLUMN width="10" align="left" valign="top" label="Total" />
						<WTCOLUMN width="10" align="left" valign="top" label="Amount" />
						<WTCOLUMN width="10" align="left" valign="top" label="Shipping" />
						<WTCOLUMN width="10" align="left" valign="top" label="Tax" />
						<WTCOLUMN width="30" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="10" align="center" valign="top" label="SalesOrderID" />

						<WTROW>
							<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(SalesOrder.OrderDate)"/>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(edit.gif)" valign="top" imgalign="absmiddle">
										<WTLINK name="5203"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Status)"/>
							<WTSTATIC col="3" value="DATA(Total)"/>
							<WTSTATIC col="4" value="DATA(Amount)"/>
							<WTSTATIC col="5" value="DATA(Shipping)"/>
							<WTSTATIC col="6" value="DATA(Tax)"/>
							<WTSTATIC col="7">
								<WTSTATIC value="DATA(MemberName)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Track)" oper="not-equal" value="CONST('')"/>
									<WTSTATIC space="1"/>
                  <WTSTATIC fontcolor="purple">
                    <WTSTATIC label="Track"/>
                    <WTSTATIC value="DATA(SalesOrder.Track)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="8" value="DATA(SalesOrderID)"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(0)"/>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(SalesOrder.OrderDate)" fontcolor="red"/>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(edit.gif)" valign="top" imgalign="absmiddle">
										<WTLINK name="5203"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Status)" fontcolor="red"/>
							<WTSTATIC col="3" value="DATA(Total)" fontcolor="red"/>
							<WTSTATIC col="4" value="DATA(Amount)" fontcolor="red"/>
							<WTSTATIC col="5" value="DATA(Shipping)" fontcolor="red"/>
							<WTSTATIC col="6" value="DATA(Tax)" fontcolor="red"/>
							<WTSTATIC col="7" value="DATA(MemberName)" fontcolor="red"/>
							<WTSTATIC col="8" value="DATA(SalesOrderID)" fontcolor="red"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5202" header="false" footer="false" navbar="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" secured="125">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="ProspectID" datatype="number" />

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(SalesOrder.OrderDate)" value="SYS(Now)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.Status)" value="SYSCON(STATUS-SUBMITTED)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(ProspectID)" value="PARAM(ProspectID)"/>
					<WTSETATTRIBUTES />
					<WTSETATTRIBUTE name="ATTR(Total)" value="ATTR(Amount)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="SalesOrderID" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="5203" skipreturn="true" nolocaldata="true">
						<WTPARAM name="SalesOrderID" value="CONST(SalesOrderID)"/>
						<WTPARAM name="ContentPage" value="CONST(ContentPage)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right" />
				<WTCOLUMN width="440" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" label="NewSalesOrder" class="PageHeading" />
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="OrderDate" />
					<WTTEXT col="2" value="ATTR(SalesOrder.OrderDate)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Amount" />
					<WTTEXT col="2" value="ATTR(SalesOrder.Amount)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status" />
					<WTCOMBO col="2" value="ATTR(SalesOrder.Status)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="AffiliateID" />
					<WTTEXT col="2" value="ATTR(SalesOrder.AffiliateID)" size="3"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PromotionID" />
					<WTTEXT col="2" value="ATTR(SalesOrder.PromotionID)" size="3"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(SalesOrder.IsTaxable)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(SalesOrder.IsRecur)"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" />
					<WTDIVIDER col="2" align="left" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Notes" valign="top" />
					<WTMEMO col="2" value="ATTR(SalesOrder.Notes)" rows="4" />
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" />
					<WTBUTTON col="2" action="2" value="CONST(Add)">
						<WTCONDITION expr="IsActive" />
					</WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)" />
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5203" header="false" footer="false" navbar="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="125">
		<!-- =============================================================================================== -->
			<WTPARAM name="SalesOrderID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="ProspectID" datatype="number" />
			<WTPARAM name="Popup" datatype="number"/>

			<WTSUB name="LoadOrder">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)" />
					<WTSETATTRIBUTE name="PARAM(ProspectID)" value="ATTR(ProspectID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTSUB>

			<WTSUB name="LoadList">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="ListOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Prospect" project="ptsProspectUser" class="CProspect">
					<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProspect" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
					</WTMETHOD>
					<WTCUSTOM>
				For Each oSalesItem in oSalesItems
					With oSalesItem
						If .InputValues &lt;&gt; "" Then
'							pos = InStr(.InputValues, "(")
'							If pos &gt; 0 Then .InputValues = Left(.InputValues, pos-1)
							.InputValues = Replace(.InputValues, vbCrLf, ":")
							.InputValues = Replace(.InputValues, ":", "~")
						End If
					End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesItems" direction="return" concat="true" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Payments" project="ptsPaymentUser" class="CPayments">
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="ListOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(SalesOrder)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(SalesOrderID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayments" direction="return" concat="true" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadOrder" />
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)" />
					<WTSETATTRIBUTE name="PARAM(ProspectID)" value="ATTR(ProspectID)" />
					<WTSETATTRIBUTES />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors" />
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors" />
					<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Delete">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadOrder">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
				</WTRETURN>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right" />
				<WTCOLUMN width="440" align="left" />

				<WTROW>
					<WTSTATIC col="1" align="left" tag="SalesOrder" value="ATTR(SalesOrder.SalesOrderID)" class="PageHeading" />

					<WTSTATIC col="2" bold="true" align="right">
						<WTSTATIC label="PrintableReceipt" space="1">
							<WTLINK name="5216" class="PageHeadingLink" target="Receipt">
	 							<WTPARAM name="SalesOrderID" value="ATTR(SalesOrder.SalesOrderID)"/>
							</WTLINK>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" />
							<WTSTATIC value="CONST(|)" space="1"/>
							<WTSTATIC label="ShoppingCart">
								<WTLINK name="5250" class="PageHeadingLink" target="ShoppingCart">
	 								<WTPARAM name="ShoppingCartID" value="ATTR(SalesOrder.SalesOrderID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTSTATIC col="1" merge="2" align="left" valign="top">
						<WTSTATIC tag="Member" bold="true"/>
						<WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Member16.gif)" alt="Edit" imgalign="absmiddle">
								<WTLINK name="0403" target="_blank">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="ContentPage" value="CONST(3)"/>
									<WTPARAM name="Popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
								<WTLINK name="0475" return="false" target="_blank">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="Code" value="CONST(1)"/>
									<WTPARAM name="ContentPage" value="CONST(3)"/>
									<WTPARAM name="Popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
					<WTSTATIC col="1" merge="2" align="left" bold="true">
						<WTCONDITION expr="ATTR(Member.NameLast)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
						<WTSTATIC value="CONST(,)" space="1"/>
						<WTREPEAT entity="Address">
							<WTSTATIC fontcolor="blue">
								<WTCONDITION expr="DATA(IsActive)" oper="not-equal" value="CONST(0)"/>
								<WTSTATIC label="AddressType1">
									<WTCONDITION expr="DATA(AddressType)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="AddressType2">
									<WTCONDITION expr="DATA(AddressType)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="AddressType3">
									<WTCONDITION expr="DATA(AddressType)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="AddressType4">
									<WTCONDITION expr="DATA(AddressType)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC space="1"/>
							<WTSTATIC value="DATA(Address.Street1)" space="1"/>
							<WTSTATIC value="DATA(Address.Street2)"/>
							<WTSTATIC value="CONST(,)" space="1"/>
							<WTSTATIC value="DATA(Address.City)"/>
							<WTSTATIC value="CONST(,)" space="1"/>
							<WTSTATIC value="DATA(Address.State)" space="1"/>
							<WTSTATIC value="DATA(Address.Zip)" space="1"/>
							<WTSTATIC value="DATA(Address.CountryName)"/>
						</WTREPEAT>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)" />
					<WTSTATIC col="1" merge="2" tag="Customer" align="left" bold="true" valign="top"/>
					<WTSTATIC col="1" merge="2" align="left" bold="true">
						<WTSTATIC value="ATTR(Prospect.ProspectName)" space="1"/>
						<WTSTATIC value="CONST(,)" space="1"/>
						<WTSTATIC value="DATA(Prospect.Street1)" space="1"/>
						<WTSTATIC value="DATA(Prospect.Street2)"/>
						<WTSTATIC value="CONST(,)" space="1"/>
						<WTSTATIC value="DATA(Prospect.City)"/>
						<WTSTATIC value="CONST(,)" space="1"/>
						<WTSTATIC value="DATA(Prospect.State)" space="1"/>
						<WTSTATIC value="DATA(Prospect.Zip)" space="1"/>
						<WTSTATIC value="DATA(Prospect.CountryName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1" tag="MemberID" />
						<WTTEXT col="2" value="ATTR(SalesOrder.MemberID)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ProspectID" />
						<WTTEXT col="2" value="ATTR(SalesOrder.ProspectID)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="PartyID" />
						<WTTEXT col="2" value="ATTR(SalesOrder.PartyID)" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTHIDDEN value="ATTR(SalesOrder.MemberID)"/>
					<WTHIDDEN value="ATTR(SalesOrder.ProspectID)"/>
					<WTHIDDEN value="ATTR(SalesOrder.PartyID)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="OrderDate" />
					<WTTEXT col="2" value="ATTR(SalesOrder.OrderDate)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Amount" />
					<WTTEXT col="2" value="ATTR(SalesOrder.Amount)" size="10"/>
					<WTSTATIC col="2" tag="BV"/>
					<WTSTATIC col="2" value="ATTR(SalesOrder.BV)" prespace="false"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" align="left" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Discount" />
					<WTTEXT col="2" value="ATTR(SalesOrder.Discount)" size="10"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Tax" />
					<WTTEXT col="2" value="ATTR(SalesOrder.Tax)" size="10"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Shipping" />
					<WTTEXT col="2" value="ATTR(SalesOrder.Shipping)" size="10"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Total" />
					<WTTEXT col="2" value="ATTR(SalesOrder.Total)" size="10"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status" />
					<WTCOMBO col="2" value="ATTR(SalesOrder.Status)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="AffiliateID" />
					<WTTEXT col="2" value="ATTR(SalesOrder.AffiliateID)" size="3"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PromotionID" />
					<WTTEXT col="2" value="ATTR(SalesOrder.PromotionID)" size="3"/>
					<WTSTATIC col="2" value="ATTR(SalesOrder.PromotionName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(SalesOrder.IsTaxable)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(SalesOrder.IsRecur)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="AutoShip"/>
					<WTCOMBO col="2" value="ATTR(SalesOrder.AutoShip)"/>
					<WTCHECK col="2" value="ATTR(SalesOrder.IsActive)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Notes" valign="top" />
					<WTMEMO col="2" value="ATTR(SalesOrder.Notes)" rows="4" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Ship" />
					<WTCOMBO col="2" value="ATTR(SalesOrder.Ship)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Track" />
					<WTTEXT col="2" value="ATTR(SalesOrder.Track)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="IsEmployee"/>
					<WTSTATIC col="1" tag="PinnDate" />
					<WTTEXT col="2" value="ATTR(SalesOrder.PinnDate)" />
					<WTTEXT col="2" value="ATTR(SalesOrder.PinnAmount)" size="8"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW>
						<WTSTATIC col="1" tag="PinnDate" />
						<WTSTATIC col="2" value="ATTR(SalesOrder.PinnDate)"/>
						<WTSTATIC col="2" value="ATTR(SalesOrder.PinnAmount)"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(SalesOrder.PinnDate)"/>
						<WTHIDDEN value="ATTR(SalesOrder.PinnAmount)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTSTATIC col="1" tag="CommDate" />
					<WTTEXT col="2" value="ATTR(SalesOrder.CommDate)" />
					<WTTEXT col="2" value="ATTR(SalesOrder.CommAmount)" size="8"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" />
					<WTBUTTON col="2" action="1" value="CONST(Update)">
						<WTCONDITION expr="IsActive" />
					</WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
					</WTBUTTON>
					<WTBUTTON col="2" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="2" action="4" value="CONST(Delete)" msg="ConfirmDelete">
						<WTCONDITION expr="IsEmployee" />
						<WTCONDITION expr="IsActive" connector="and"/>
					</WTBUTTON>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" align="left" label="SalesItems" class="PageHeading" />
					<WTSTATIC col="2" align="right" label="NewSalesItem" bold="true">
						<WTCONDITION expr="IsActive"/>
						<WTLINK name="5302"><WTPARAM name="SalesOrderID" value="PARAM(SalesOrderID)"/></WTLINK>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="SalesItem">
						<WTCOLUMN width="5" align="left" valign="top" label="Qty" />
						<WTCOLUMN width="71" align="left" valign="top" label="ProductName" />
						<WTCOLUMN width="12" align="left" valign="top" label="Price" />
						<WTCOLUMN width="12" align="left" valign="top" label="Options" />
						<WTROW>
							<WTSTATIC col="1" value="DATA(Quantity)"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(ProductName)"/>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(edit.gif)" valign="top" imgalign="absmiddle">
										<WTLINK name="5303"><WTPARAM name="SalesItemID" value="DATA(SalesItem.SalesItemID)"/></WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(BillDate)" oper="not-equal" value="CONST('')"/>
									<WTIMAGE value="CONST(recur.gif)" valign="top" imgalign="absmiddle"/>
									<WTSTATIC value="DATA(BillDate)" fontcolor="purple"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(InputValues)" oper="not-equal" value="CONST('')" />
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(SalesItem.InputValues)" space="2" fontcolor="blue"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(SalesItem.Price)" />
							<WTSTATIC col="4" value="DATA(SalesItem.OptionPrice)" />
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTSTATIC label="Submitted"/>
				<WTSTATIC label="Pending"/>
				<WTSTATIC label="Approved"/>
				<WTSTATIC label="Declined"/>
				<WTSTATIC label="Cancelled"/>
				<WTSTATIC label="Returned"/>

				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>
				<WTSTATIC label="Discover"/>
				<WTSTATIC label="Amex"/>
				<WTSTATIC label="Check"/>
				<WTSTATIC label="PayPal"/>
				<WTSTATIC label="Cash"/>
				<WTSTATIC label="PO"/>
				<WTSTATIC label="MiscPay1"/>
				<WTSTATIC label="MiscPay2"/>
				<WTSTATIC label="MiscPay3"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" />
					<WTROW margin-top="12">
						<WTSTATIC col="1" label="Payments" align="left" class="PageHeading" />
						<WTSTATIC col="2" label="NewPayment" bold="true" align="right">
							<WTLINK name="1002">
								<WTPARAM name="OwnerType" value="ENTITY(SalesOrder)"/>
								<WTPARAM name="OwnerID" value="PARAM(SalesOrderID)"/>
							</WTLINK>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="2">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Payment">
							<WTCOLUMN width="15" align="left" label="PayDate"/>
							<WTCOLUMN width="15" align="left" label="PayType"/>
							<WTCOLUMN width="13" align="left" label="Amount"/>
							<WTCOLUMN width="17" align="left" label="Status"/>
							<WTCOLUMN width="30" align="left" label="Reference"/>
							<WTCOLUMN width="10" align="center"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTSTATIC value="DATA(PayDate)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(edit.gif)" valign="top" imgalign="absmiddle">
											<WTLINK name="1003"><WTPARAM name="PaymentID" value="DATA(PaymentID)"/></WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(Payment.PayType)" enum="true"/>
								<WTSTATIC col="3" value="DATA(Payment.Total)"/>
								<WTSTATIC col="4" value="DATA(Payment.Status)"/>
								<WTSTATIC col="5" value="DATA(Payment.Reference)"/>
								<WTSTATIC col="6"/>
<!--								
								<WTSTATIC col="6" label="CopyLink">
										<WTLINK name="1002"><WTPARAM name="CopyID" value="DATA(Payment.PaymentID)"/></WTLINK>
								</WTSTATIC>
-->								
							</WTROW>
							<WTROW>
								<WTCONDITION expr="DATA(Notes)" oper="not-equal" value="CONST('')" />
								<WTSTATIC col="1" merge="6" value="DATA(Notes)" fontcolor="gray"/>
							</WTROW>
							<WTROW>
								<WTCONDITION expr="DATA(Description)" oper="not-equal" value="CONST('')" />
								<WTSTATIC col="1" merge="6" value="DATA(Description)" fontcolor="gray"/>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5210" caption="Party Orders" header="false" footer="false" navbar="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!-- =============================================================================================== -->
			<WTPARAM name="PartyID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ListParty">
						<WTPARAM name="PartyID" direction="input" value="PARAM(PartyID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" concat="true" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left" />
				
				<WTROW>
					<WTSTATIC col="1" label="SalesOrders" class="PageHeading" />
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				
				<WTROW margin-bottom="12">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="SalesOrder">
						<WTCOLUMN width="12" align="left" valign="top" label="OrderDate" />
						<WTCOLUMN width="12" align="left" valign="top" label="Amount" />
						<WTCOLUMN width="15" align="left" valign="top" label="Status" />
						<WTCOLUMN width="56" align="left" valign="top" label="MemberName" />
						<WTCOLUMN width="5" align="left" />
						<WTROW>
							<WTSTATIC col="1" value="DATA(SalesOrder.OrderDate)"/>
							<WTSTATIC col="2" value="DATA(SalesOrder.Total)"/>
							<WTSTATIC col="3" value="DATA(SalesOrder.Status)" valign="top"/>
							<WTSTATIC col="4" value="DATA(SalesOrder.MemberName)"/>
							<WTIMAGE col="5" value="CONST(preview.gif)" alt="Preview" imgalign="absmiddle">
								<WTLINK name="5216" target="preview"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
							</WTIMAGE>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5211" caption="Sales Orders" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ListMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" concat="true" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left" />
				<WTCOLUMN width="300" align="right" />
				
				<WTROW>
					<WTSTATIC col="1" label="SalesOrders" class="PageHeading" />
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTCONDITION expr="IsEmployee"/>
							<WTIMAGE value="CONST(ShoppingCart16.png)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="NewSalesOrder">
								<WTLINK name="5250" target="ShoppingCart">
									<WTPARAM name="C" value="PARAM(CompanyID)" />
									<WTPARAM name="Me" value="PARAM(MemberID)" />
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				
				<WTROW margin-bottom="12">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="SalesOrder">
						<WTCOLUMN width="12" align="left" valign="top" label="OrderDate" />
						<WTCOLUMN width="12" align="left" valign="top" label="Amount" />
						<WTCOLUMN width="15" align="left" valign="top" label="Status" />
						<WTCOLUMN width="61" align="left" valign="top" label="Notes" />
						<WTROW>
							<WTSTATIC col="1" valign="top">
								<WTSTATIC value="DATA(SalesOrder.OrderDate)">
									<WTCONDITION expr="IsEmployee"/>
									<WTLINK name="5203"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="DATA(SalesOrder.OrderDate)">
									<WTCONDITION expr="NotEmployee"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2" valign="top">
								<WTSTATIC value="DATA(SalesOrder.Total)">
									<WTCONDITION expr="IsEmployee"/>
									<WTLINK name="5203"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="DATA(SalesOrder.Total)">
									<WTCONDITION expr="NotEmployee"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsRecur)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(recur.gif)" valign="top" imgalign="absmiddle"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(SalesOrder.Status)" valign="top"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="5216" target="preview">
											<WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(ProspectID)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(SalesOrder.ProspectName)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(SalesOrder.Notes)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Track)" oper="not-equal" value="CONST('')"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(SalesOrder.Track)" fontcolor="purple"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5231" caption="Customer Orders" header="false" navbar="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="ProspectID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Prospect" project="ptsProspectUser" class="CProspect">
					<WTMETHOD name="Load">
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProspect" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ListProspect">
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" concat="true" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left" />
				<WTCOLUMN width="200" align="right" />
				
				<WTROW>
					<WTSTATIC col="1" tag="SalesOrders" value="ATTR(Prospect.ProspectName)" class="PageHeading" />
					<WTSTATIC col="2" align="right">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle">
								<WTLINK name="5202">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
									<WTPARAM name="MemberID" value="PARAM(MemberID)" />
									<WTPARAM name="ProspectID" value="PARAM(ProspectID)" />
									<WTPARAM name="ContentPage" value="CONST(3)" />
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NewSalesOrder">
							<WTLINK name="5202">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
								<WTPARAM name="MemberID" value="PARAM(MemberID)" />
								<WTPARAM name="ProspectID" value="PARAM(ProspectID)" />
								<WTPARAM name="ContentPage" value="CONST(3)" />
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				
				<WTROW margin-bottom="12">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="SalesOrder">
						<WTCOLUMN width="14" align="left" valign="top" label="OrderDate" />
						<WTCOLUMN width="15" align="left" valign="top" label="Total" />
						<WTCOLUMN width="15" align="left" valign="top" label="Status" />
						<WTCOLUMN width="56" align="left" valign="top" label="Notes" />
						<WTROW>
							<WTSTATIC col="1" valign="top">
								<WTSTATIC value="DATA(SalesOrder.OrderDate)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="NotMemberOnly"/>
									<WTIMAGE value="CONST(edit.gif)" valign="top" imgalign="absmiddle">
										<WTLINK name="5203">
											<WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)" />
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" valign="top">
								<WTSTATIC value="DATA(SalesOrder.Total)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsRecur)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(recur.gif)" valign="top" imgalign="absmiddle"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(SalesOrder.Status)" valign="top"/>
							<WTSTATIC col="4">
								<WTSTATIC value="DATA(SalesOrder.Notes)">
									<WTCONDITION expr="NotMemberOnly"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="5216" target="preview"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5212" caption="List" navbar="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="PromotionID" datatype="number" />
			<WTPARAM name="Count" datatype="number" />
			<WTPARAM name="Amount" datatype="number" />
			<WTPARAM name="Total" datatype="number" />

			<WTINCLUDE name="Company.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="GetCompany(reqCompanyID)">
					<WTCONDITION expr="IsAnonymous"/>
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ListPromotion">
						<WTPARAM name="PromotionID" direction="input" value="PARAM(PromotionID)" />
					</WTMETHOD>
<WTCUSTOM>
					For Each oSalesOrder In oSalesOrders
						reqCount = reqCount + 1
						reqAmount = CCur(reqAmount) + CCur(oSalesOrder.Amount)
						reqTotal = CCur(reqTotal) + CCur(oSalesOrder.Total)
					Next
					reqAmount = FormatCurrency(reqAmount)
					reqTotal = FormatCurrency(reqTotal)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" concat="true" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Promotion" project="ptsPromotionUser" class="CPromotion">
					<WTMETHOD name="Load">
						<WTPARAM name="PromotionID" direction="input" value="PARAM(PromotionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPromotion" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />

				<WTROW>
					<WTSTATIC col="1" tag="SalesOrders" value="ATTR(Promotion.PromotionName)" align="center" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				
				<WTROW margin-bottom="3">
					<WTRECORDSET col="1" graybar="true" entity="SalesOrder">
						<WTCOLUMN width="15" align="left" valign="top" label="OrderDate"/>
						<WTCOLUMN width="55" align="left" valign="top" label="Member"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Amount"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Total"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(SalesOrder.OrderDate)">
									<WTCONDITION expr="IsAnonymous"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(SalesOrder.OrderDate)">
									<WTCONDITION expr="NotAnonymous"/>
									<WTLINK name="5203" target="order">
										<WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/>
										<WTPARAM name="Popup" value="CONST(1)"/>
										<WTPARAM name="ContentPage" value="CONST(3)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(SalesOrder.NameFirst)" space="1"/>
								<WTSTATIC value="DATA(SalesOrder.NameLast)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(SalesOrder.Amount)"/>
							<WTSTATIC col="4" value="DATA(SalesOrder.Total)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="455" align="left"/>
						<WTCOLUMN width="97" align="left"/>
						<WTCOLUMN width="98" align="left"/>
						<WTROW>
							<WTSTATIC col="1" bold="true">
								<WTSTATIC value="PARAM(Count)" space="1"/>
								<WTSTATIC label="SalesOrders"/>
							</WTSTATIC>
							<WTSTATIC col="2" value="PARAM(Amount)" bold="true"/>
							<WTSTATIC col="3" value="PARAM(Total)" bold="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5213" caption="SalesOrders" form="Report" navbar="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="A" datatype="number" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Count" datatype="number" />
			<WTPARAM name="Amount" datatype="number" />
			<WTPARAM name="Total" datatype="number" />

			<WTINCLUDE name="Company.asp"/>

			<WTSUB name="LoadReport">
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="DATEADD(&quot;d&quot;,1,reqToDate)" />
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ReportAffiliate">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(A)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="CONST(tmpToDate)"/>
					</WTMETHOD>
<WTCUSTOM>
					For Each oSalesOrder In oSalesOrders
						reqCount = reqCount + 1
						reqAmount = CCur(reqAmount) + CCur(oSalesOrder.Amount)
						reqTotal = CCur(reqTotal) + CCur(oSalesOrder.Total)
					Next
					reqAmount = FormatCurrency(reqAmount)
					reqTotal = FormatCurrency(reqTotal)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" concat="true" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTMETHOD name="Load">
						<WTPARAM name="AffiliateID" direction="input" value="PARAM(A)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)" />
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2000&quot;" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				<WTCALLSUB name="GetCompany(reqCompanyID)">
					<WTCONDITION expr="IsAnonymous"/>
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
			</WTACTION>
			
			<WTACTION id="5" name="Report" type="Update">
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="UptoToday" />
						<WTOPTION id="4" label="PrevWeek" />
						<WTOPTION id="5" label="PrevMonth" />
						<WTOPTION id="6" label="PrevYear" />
						<WTOPTION id="7" label="WeekToDate" />
						<WTOPTION id="8" label="MonthToDate" />
						<WTOPTION id="9" label="YearToDate" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
					<WTBUTTON col="1" action="5" value="CONST(Report)" default="true" />
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" tag="SalesOrders" value="ATTR(Affiliate.AffiliateName)" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
					</WTROW>

					<WTROW margin-bottom="3">
						<WTRECORDSET col="1" graybar="true" entity="SalesOrder">
							<WTCOLUMN width="15" align="left" valign="top" label="OrderDate"/>
							<WTCOLUMN width="55" align="left" valign="top" label="Member"/>
							<WTCOLUMN width="15" align="left" valign="top" label="Amount"/>
							<WTCOLUMN width="15" align="left" valign="top" label="Total"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTSTATIC value="DATA(SalesOrder.OrderDate)">
										<WTCONDITION expr="IsAnonymous"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(SalesOrder.OrderDate)">
										<WTCONDITION expr="NotAnonymous"/>
										<WTLINK name="5203" target="order">
											<WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTSTATIC value="DATA(SalesOrder.NameFirst)" space="1"/>
									<WTSTATIC value="DATA(SalesOrder.NameLast)"/>
								</WTSTATIC>
								<WTSTATIC col="3" value="DATA(SalesOrder.Amount)"/>
								<WTSTATIC col="4" value="DATA(SalesOrder.Total)"/>
							</WTROW>
						</WTRECORDSET>
					</WTROW>

					<WTROW>
						<WTTABLE col="1">
							<WTCOLUMN width="455" align="left"/>
							<WTCOLUMN width="97" align="left"/>
							<WTCOLUMN width="98" align="left"/>
							<WTROW>
								<WTSTATIC col="1" bold="true">
									<WTSTATIC value="PARAM(Count)" space="1"/>
									<WTSTATIC label="SalesOrders"/>
								</WTSTATIC>
								<WTSTATIC col="2" value="PARAM(Amount)" bold="true"/>
								<WTSTATIC col="3" value="PARAM(Total)" bold="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5214" caption="SalesOrders" form="Report" navbar="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Count" datatype="number" />
			<WTPARAM name="Total" datatype="number" />
			<WTPARAM name="Amount" datatype="number" />
			<WTPARAM name="Shipping" datatype="number" />
			<WTPARAM name="Tax" datatype="number" />

			<WTSUB name="LoadReport">
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="DATEADD(&quot;d&quot;,1,reqToDate)" />
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ReportCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="CONST(tmpToDate)"/>
					</WTMETHOD>
<WTCUSTOM>
	For Each oItem In oSalesOrders
		With oItem
			reqCount = reqCount + 1
			reqTotal = CCur(reqTotal) + CCur(.Total)
			reqAmount = CCur(reqAmount) + CCur(.Amount)
			reqShipping = CCur(reqShipping) + CCur(.Shipping)
			reqTax = CCur(reqTax) + CCur(.Tax)
		End With
	Next
	reqTotal = FormatCurrency(reqTotal)
	reqAmount = FormatCurrency(reqAmount)
	reqShipping = FormatCurrency(reqShipping)
	reqTax = FormatCurrency(reqTax)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" concat="true" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)" />
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2000&quot;" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
			</WTACTION>
			
			<WTACTION id="5" name="Report" type="Update">
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="UptoToday" />
						<WTOPTION id="4" label="PrevWeek" />
						<WTOPTION id="5" label="PrevMonth" />
						<WTOPTION id="6" label="PrevYear" />
						<WTOPTION id="7" label="WeekToDate" />
						<WTOPTION id="8" label="MonthToDate" />
						<WTOPTION id="9" label="YearToDate" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
					<WTBUTTON col="1" action="5" value="CONST(Report)" default="true" />
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" tag="SalesOrders" value="ATTR(Company.CompanyName)" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
					</WTROW>

					<WTROW margin-bottom="3">
						<WTRECORDSET col="1" graybar="true" entity="SalesOrder">
							<WTCOLUMN width="12" align="left" valign="top" label="OrderDate"/>
							<WTCOLUMN width="34" align="left" valign="top" label="MemberName" />
							<WTCOLUMN width="15" align="left" valign="top" label="Total"/>
							<WTCOLUMN width="15" align="left" valign="top" label="Amount"/>
							<WTCOLUMN width="12" align="left" valign="top" label="Shipping"/>
							<WTCOLUMN width="12" align="left" valign="top" label="Tax"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTSTATIC value="DATA(SalesOrder.OrderDate)">
										<WTCONDITION expr="IsAnonymous"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(SalesOrder.OrderDate)">
										<WTCONDITION expr="NotAnonymous"/>
										<WTLINK name="5203" target="order">
											<WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(SalesOrder.MemberName)"/>
								<WTSTATIC col="3" value="DATA(SalesOrder.Total)"/>
								<WTSTATIC col="4" value="DATA(SalesOrder.Amount)"/>
								<WTSTATIC col="5" value="DATA(SalesOrder.Shipping)"/>
								<WTSTATIC col="6" value="DATA(SalesOrder.Tax)"/>
							</WTROW>
						</WTRECORDSET>
					</WTROW>

					<WTROW>
						<WTTABLE col="1">
							<WTCOLUMN width="298" align="left"/>
							<WTCOLUMN width="98" align="left"/>
							<WTCOLUMN width="98" align="left"/>
							<WTCOLUMN width="78" align="left"/>
							<WTCOLUMN width="78" align="left"/>
							<WTROW>
								<WTSTATIC col="1" bold="true">
									<WTSTATIC value="PARAM(Count)" space="1"/>
									<WTSTATIC label="SalesOrders"/>
								</WTSTATIC>
								<WTSTATIC col="2" value="PARAM(Total)" bold="true"/>
								<WTSTATIC col="3" value="PARAM(Amount)" bold="true"/>
								<WTSTATIC col="4" value="PARAM(Shipping)" bold="true"/>
								<WTSTATIC col="5" value="PARAM(Tax)" bold="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================-->
		<WTWEBPAGE name="5215" log="true" caption="Sales Order Email" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl" langfile="5215">
			<!--==================================================================================================-->
			<WTPARAM name="SalesOrderID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(SalesOrder.CompanyID)" />
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(SalesOrder.MemberID)" />
					<WTMETHOD name="ProductEmails">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="tmpBCC" direction="return" datatype="text" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)" />
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="ATTR(Company.CompanyName)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Payments" project="ptsPaymentUser" class="CPayments">
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
					</WTMETHOD>
<WTCUSTOM>
					For Each oPayment In oPayments
						oPayment.CardNumber = "************" + Right(oPayment.CardNumber,4)
					Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayments" direction="return" concat="true" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpMemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)" />
					<WTCUSTOM>
				If InStr(tmpTo, "@") = 0 Then
					tmpTo = tmpFrom
				End If	
	</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
					<WTMETHOD name="ListOwnerType">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="CONST(tmpMemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
					</WTMETHOD>
					<WTCUSTOM>
				'Get all the email adresses for internal notifications
				For Each oSalesItem in oSalesItems
					With oSalesItem
						tmpSubject = tmpSubject + " - " + .ProductName
						If .InputValues &lt;&gt; "" Then
							pos = InStr(.InputValues, "(")
							If pos &gt; 0 Then
								.InputValues = Left(.InputValues, pos-1)
							End If
						End If
					End With
				Next
	</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesItems" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
				
				<WTMAIL from="tmpFrom" to="tmpTo" bcc="tmpBCC" subject="tmpSubject" sender="tmpSender"/>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="125" align="right" />
				<WTCOLUMN width="525" align="left" />
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" label="SalesOrderText" class="PageHeading" align="left" />
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" division="true" bold="true" align="left">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1" />
						<WTSTATIC value="ATTR(Member.NameLast)" newline="1" />
						<WTREPEAT entity="Address">
							<WTSTATIC value="DATA(Address.Street1)" space="2" />
							<WTSTATIC value="DATA(Address.Street2)" newline="1" />
							<WTSTATIC value="DATA(Address.City)"/>
							<WTSTATIC value="CONST(,)" space="1"/>
							<WTSTATIC value="DATA(Address.State)" space="2" />
							<WTSTATIC value="DATA(Address.Zip)" space="2" />
							<WTSTATIC value="DATA(Address.CountryName)" newline="2" />
						</WTREPEAT>
						<WTSTATIC tag="Email" value="ATTR(Member.Email)" newline="1" />
						<WTSTATIC tag="Phone1" value="ATTR(Member.Phone1)" newline="1" />
						<WTSTATIC tag="Phone2" value="ATTR(Member.Phone2)" />
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" tag="OrderID" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.SalesOrderID)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="OrderDate" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.OrderDate)" bold="true" />
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" tag="Amount" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Amount)" bold="true" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(SalesOrder.Discount)" oper="not-equal" value="CONST(0)" />
					<WTSTATIC col="1" tag="Discount" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Discount)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Tax" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Tax)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Shipping" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Shipping)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Total" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Total)" bold="true" />
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" tag="Ship" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Ship)" bold="true"/>
				</WTROW>
				<WTREPEAT entity="Payment">
					<WTROW>
						<WTSTATIC col="1" tag="Payee" height="18" />
						<WTSTATIC col="2" value="DATA(Payment.Payee)" bold="true" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="PayType" height="18" />
						<WTSTATIC col="2" value="DATA(Payment.PayType)" bold="true" enum="true" />
						<WTSTATIC col="2" value="DATA(Payment.CardNumber)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Reference" height="18" />
						<WTSTATIC col="2" value="DATA(Payment.Reference)" bold="true" />
						<WTSTATIC col="2" value="DATA(Payment.Notes)" />
					</WTROW>
				</WTREPEAT>

				<WTROW margin-top="12">
					<WTRECORDSET col="1" merge="2" entity="SalesItem">
						<WTCOLUMN width="5" align="left" valign="top" label="Qty" />
						<WTCOLUMN width="65" align="left" valign="top" label="ProductName" />
						<WTCOLUMN width="15" align="left" valign="top" label="Price" />
						<WTCOLUMN width="15" align="left" valign="top" label="Options" />
						<WTROW>
							<WTSTATIC col="1" value="DATA(SalesItem.Quantity)" />
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(ProductName)" newline="1"/>
								<WTSTATIC value="DATA(SalesItem.InputValues)" space="2" fontcolor="blue">
									<WTCONDITION expr="DATA(InputValues)" oper="not-equal" value="CONST('')" />
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(SalesItem.Price)" />
							<WTSTATIC col="4" value="DATA(SalesItem.OptionPrice)" />
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="24">
					<WTSTATIC col="1" merge="2" value="ATTR(Company.CompanyName)" class="PageHeading" align="left" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" division="true" bold="true" align="left">
						<WTSTATIC tag="Email" value="ATTR(Company.Email)" newline="1" />
						<WTSTATIC tag="Phone" value="ATTR(Company.Phone1)" newline="1" />
						<WTSTATIC tag="Fax" value="ATTR(Company.Fax)" newline="1" />
					</WTSTATIC>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="5216" caption="Sales Order Receipt" navbar="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLReport.xsl" >
		<!--==================================================================-->
			<WTPARAM name="SalesOrderID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="AddressID" datatype="number" />
			<WTPARAM name="ProspectID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(SalesOrder.CompanyID)" />
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(SalesOrder.MemberID)" />
					<WTSETATTRIBUTE name="PARAM(AddressID)" value="ATTR(SalesOrder.AddressID)" />
					<WTSETATTRIBUTE name="PARAM(ProspectID)" value="ATTR(SalesOrder.ProspectID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(AddressID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="ListOwnerType">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-SHIPPING)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="PARAM(AddressID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="PARAM(AddressID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Prospect" project="ptsProspectUser" class="CProspect">
					<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ProspectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProspect" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
					</WTMETHOD>
<WTCUSTOM>
				For Each oSalesItem in oSalesItems
					With oSalesItem
						If .InputValues &lt;&gt; "" Then
							pos = InStr(.InputValues, "(")
							If pos &gt; 0 Then
								.InputValues = Left(.InputValues, pos-1)
							End If
						End If
					End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesItems" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Payments" project="ptsPaymentUser" class="CPayments">
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="ListOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(SalesOrder)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(SalesOrderID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayments" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="125" align="right" />
				<WTCOLUMN width="525" align="left" />
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" label="SalesOrderText" class="PageHeading" align="left" />
				</WTROW>

				<WTROW margin-top="6">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTSTATIC col="1" merge="2" division="true" bold="true" align="left">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1" />
						<WTSTATIC value="ATTR(Member.NameLast)" newline="1" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(AddressID)" oper="equal" value="CONST(0)" />
							<WTREPEAT entity="Address">
								<WTSTATIC value="DATA(Address.Street1)" space="1"/>
								<WTSTATIC value="DATA(Address.Street2)"/>
								<WTSTATIC value="CONST(,)" space="1"/>
								<WTSTATIC value="DATA(Address.City)"/>
								<WTSTATIC value="CONST(,)" space="1"/>
								<WTSTATIC value="DATA(Address.State)" space="1"/>
								<WTSTATIC value="DATA(Address.Zip)" space="1"/>
								<WTSTATIC value="DATA(Address.CountryName)" newline="1"/>
							</WTREPEAT>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(AddressID)" oper="not-equal" value="CONST(0)" />
							<WTSTATIC value="ATTR(Address.Street1)" space="1"/>
							<WTSTATIC value="ATTR(Address.Street2)"/>
							<WTSTATIC value="CONST(,)" space="1"/>
							<WTSTATIC value="ATTR(Address.City)"/>
							<WTSTATIC value="CONST(,)" space="1"/>
							<WTSTATIC value="ATTR(Address.State)" space="1"/>
							<WTSTATIC value="ATTR(Address.Zip)" space="1"/>
							<WTSTATIC value="ATTR(Address.CountryName)" newline="1"/>
						</WTCODEGROUP>
						<WTSTATIC tag="Email" value="ATTR(Member.Email)" newline="1" />
						<WTSTATIC tag="Phone1" value="ATTR(Member.Phone1)" newline="1" />
						<WTSTATIC tag="Phone2" value="ATTR(Member.Phone2)" />
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)" />
					<WTSTATIC col="1" merge="2" tag="Customer" align="left" bold="true" valign="top"/>
					<WTSTATIC col="1" merge="2" align="left" bold="true">
						<WTSTATIC value="ATTR(Prospect.ProspectName)" space="1"/>
						<WTSTATIC value="CONST(,)" space="1"/>
						<WTSTATIC value="DATA(Prospect.Street1)" space="1"/>
						<WTSTATIC value="DATA(Prospect.Street2)"/>
						<WTSTATIC value="CONST(,)" space="1"/>
						<WTSTATIC value="DATA(Prospect.City)"/>
						<WTSTATIC value="CONST(,)" space="1"/>
						<WTSTATIC value="DATA(Prospect.State)" space="1"/>
						<WTSTATIC value="DATA(Prospect.Zip)" space="1"/>
						<WTSTATIC value="DATA(Prospect.CountryName)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="SalesOrderID" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.SalesOrderID)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="OrderDate" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.OrderDate)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Status)" bold="true" />
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Amount" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Amount)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(SalesOrder.BV)" oper="not-equal" value="CONST('$0.00')" />
					<WTSTATIC col="1" tag="BV" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.BV)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(SalesOrder.Discount)" oper="not-equal" value="CONST(0)" />
					<WTSTATIC col="1" tag="Discount" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Discount)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Tax" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Tax)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Shipping" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Shipping)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Total" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Total)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Ship" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Ship)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Track" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Track)" bold="true" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(SalesOrder.Notes)" oper="not-equal" value="CONST('')" />
					<WTSTATIC col="1" tag="Notes" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Notes)" />
				</WTROW>

				<WTROW margin-top="6">
					<WTRECORDSET col="1" merge="2" align="left" entity="SalesItem">
						<WTCOLUMN width="5" align="left" valign="top" label="Qty" />
						<WTCOLUMN width="65" align="left" valign="top" label="ProductName" />
						<WTCOLUMN width="15" align="left" valign="top" label="Price" />
						<WTCOLUMN width="15" align="left" valign="top" label="Options" />
						<WTROW>
							<WTSTATIC col="1" value="DATA(SalesItem.Quantity)" />
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(ProductName)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(BillDate)" oper="not-equal" value="CONST('')"/>
									<WTIMAGE value="CONST(recur.gif)" valign="top" imgalign="absmiddle"/>
									<WTSTATIC value="DATA(BillDate)" fontcolor="purple"/>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(SalesItem.InputValues)" space="2" fontcolor="blue">
									<WTCONDITION expr="DATA(InputValues)" oper="not-equal" value="CONST('')" />
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(SalesItem.Price)" />
							<WTSTATIC col="4" value="DATA(SalesItem.OptionPrice)" />
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(ProspectID)" oper="equal" value="CONST(0)" />
					<WTRECORDSET col="1" merge="2" align="left" entity="Payment">
						<WTCOLUMN width="15" align="left" label="PaymentDate"/>
						<WTCOLUMN width="13" align="left" label="Amount"/>
						<WTCOLUMN width="15" align="left" label="PayType"/>
						<WTCOLUMN width="17" align="left" label="Status"/>
						<WTCOLUMN width="40" align="left" label="Reference"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Payment.PayDate)"/>
							<WTSTATIC col="2" value="DATA(Payment.Total)"/>
							<WTSTATIC col="3" value="DATA(Payment.PayType)" enum="true"/>
							<WTSTATIC col="4" value="DATA(Payment.Status)"/>
							<WTSTATIC col="5" value="DATA(Payment.Reference)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="24">
					<WTSTATIC col="1" merge="2" value="ATTR(Company.CompanyName)" class="PageHeading" align="left" />
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" division="true" bold="true" align="left">
						<WTSTATIC tag="Email" value="ATTR(Company.Email)" newline="1" />
						<WTSTATIC tag="Phone" value="ATTR(Company.Phone1)" newline="1">
							<WTCONDITION expr="ATTR(Company.Phone1)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC tag="Fax" value="ATTR(Company.Fax)" newline="1">
							<WTCONDITION expr="ATTR(Company.Fax)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--==================================================================================================-->
		<WTWEBPAGE name="5217" log="true" caption="Download" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl" langfile="5217">
			<!--==================================================================================================-->
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="Download" datatype="text" />

			<WTDATATXN name="Downloads"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Download)" value="CONST(Replace(reqDownload, &quot;%26&quot;, &quot;&amp;&quot;))"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(Member.CompanyID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)" />
				</WTOBJECT>
				<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
					<WTMETHOD name="ListOwnerType">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)" />
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Download from &quot; + .CompanyName)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
<WTCUSTOM>
			aDownloads = split(reqDownload, ",")
			total = UBOUND(aDownloads)
			xmlDownloads = "&lt;PTSDOWNLOADS&gt;"
			For x = 0 to total
				xmlDownloads = xmlDownloads + "&lt;PTSDOWNLOAD name=""" + CleanXML(aDownloads(x)) + """/&gt;"
			Next
			xmlDownloads = xmlDownloads + "&lt;/PTSDOWNLOADS&gt;"
</WTCUSTOM>
				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender"/>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />

				<WTROW margin-top="12">
					<WTSTATIC col="1" label="DownloadText" class="PageHeading" align="left" />
				</WTROW>
				<WTROW margin-top="12" margin-bottom="24">
					<WTSTATIC col="1" division="true" bold="true" align="left">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1" />
						<WTSTATIC value="ATTR(Member.NameLast)" newline="1" />
						<WTREPEAT entity="Address">
							<WTSTATIC value="DATA(Address.Street1)" space="1"/>
							<WTSTATIC value="DATA(Address.Street2)" newline="1"/>
							<WTSTATIC value="DATA(Address.City)" space="1"/>
							<WTSTATIC value="CONST(,)" space="1"/>
							<WTSTATIC value="DATA(Address.State)" space="1"/>
							<WTSTATIC value="DATA(Address.Zip)" space="1"/>
							<WTSTATIC value="DATA(Address.CountryName)"/>
						</WTREPEAT>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="DownloadFiles" class="PageHeading" align="left" />
				</WTROW>
				<WTREPEAT entity="Download">
					<WTROW>
						<WTSTATIC col="1" value="DATA(name)">
							<WTLINK name="DATA(Name)" type="anchor"/>
						</WTSTATIC>
					</WTROW>
				</WTREPEAT>

				<WTROW margin-top="24">
					<WTSTATIC col="1" value="ATTR(Company.CompanyName)" class="PageHeading" align="left" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" division="true" bold="true" align="left">
						<WTSTATIC tag="Email" value="ATTR(Company.Email)" newline="1" />
						<WTSTATIC tag="Phone" value="ATTR(Company.Phone1)" newline="1">
							<WTCONDITION expr="ATTR(Company.Phone1)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC tag="Fax" value="ATTR(Company.Fax)" newline="1">
							<WTCONDITION expr="ATTR(Company.Fax)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="5221" caption="Sales Orders" page-width="580" page-left="0" margin-width="0" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0">
		<!-- =============================================================================================== -->
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ListMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left" />

				<WTROW>
					<WTSTATIC col="1" align="right">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(ShoppingCart16.png)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="ShoppingCart">
							<WTLINK name="5250" target="ShoppingCart">
								<WTPARAM name="Me" value="PARAM(MemberID)" />
								<WTPARAM name="C" value="PARAM(CompanyID)" />
								<WTPARAM name="N" value="CONST(1)" />
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="SalesOrder">
						<WTCOLUMN width="12" align="left" valign="top" label="OrderDate" />
						<WTCOLUMN width="15" align="left" valign="top" label="Amount" />
						<WTCOLUMN width="15" align="left" valign="top" label="Status" />
						<WTCOLUMN width="58" align="left" valign="top" label="Preview" />
						<WTROW>
							<WTSTATIC col="1" value="DATA(SalesOrder.OrderDate)" valign="top"/>
							<WTSTATIC col="2" valign="top">
								<WTSTATIC value="DATA(SalesOrder.Total)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="5203" target="_blank">
											<WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)" />
											<WTPARAM name="Popup" value="CONST(1)" />
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
<!--								<WTSTATIC value="DATA(SalesOrder.BV)" fontcolor="purple" space="1"/>-->
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsRecur)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(recur.gif)" valign="top" imgalign="absmiddle"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(SalesOrder.Status)" valign="top"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="5216" target="preview">
											<WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(ProspectID)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(SalesOrder.ProspectName)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(SalesOrder.Notes)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Track)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC space="1"/>
                  <WTSTATIC fontcolor="purple">
                    <WTSTATIC label="Track"/>
                    <WTSTATIC value="DATA(SalesOrder.Track)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW>
					<WTBUTTON col="1" action="0" value="CONST(Refresh)" align="center" btnclass="smbutton"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="5250" worker="true" aspstyle="GenerateWebASP.xsl">
		<!--==================================================================-->
		<!-- Enroll Example: 5250.asp?c=13&sp=84&n=1&m=1&s=1&l=1&p=3&a=1      -->
		<!-- Order Example: 5250.asp?c=13&n=1&p=3							  -->
		<!--==================================================================-->
			<WTPARAM name="ProductID" datatype="text" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="PromotionID" datatype="number" />
			<WTPARAM name="NoAdd" datatype="number" />
			<WTPARAM name="P" datatype="text" />	<!-- Alternate Product #s -->
			<WTPARAM name="PT" datatype="number" /> <!-- ProductTypeID for product list -->
			<WTPARAM name="C" datatype="number" />	<!-- Alternate Company # -->
			<WTPARAM name="ME" datatype="number" />	<!-- Alternate Member # -->
			<WTPARAM name="SP" datatype="number" />	<!-- Sponsor Member # -->
			<WTPARAM name="PR" datatype="number" />	<!-- Alternate Promotion # -->
			<WTPARAM name="NA" datatype="number" />	<!-- Alternate No Add -->
			<WTPARAM name="R" datatype="text" />	<!-- Member Reference -->
			<WTPARAM name="N" datatype="number" />  <!-- New Sales Order -->
			<WTPARAM name="M" datatype="number" />  <!-- Member Enrollment -->
			<WTPARAM name="S" datatype="number" />  <!-- Member Status -->
			<WTPARAM name="L" datatype="number" />  <!-- Member Level -->
			<WTPARAM name="T" datatype="number" />  <!-- Member Title # -->
			<WTPARAM name="G" datatype="text" />    <!-- Member Group -->
			<WTPARAM name="A" datatype="number" />  <!-- Auto Ship flag -->
			<WTPARAM name="PA" datatype="number" /> <!-- Party ID --> 
			<WTPARAM name="BadProduct" datatype="text" />

			<WTINCLUDE name="Company.asp"/>
			<WTINCLUDE name="Recur.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(SP)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(SP)" value="A" datatype="number"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<!-- Setup alternate parameters -->
				<WTSETATTRIBUTE name="PARAM(P)" value="PARAM(ProductID)">
					<WTCONDITION expr="PARAM(ProductID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(C)" value="PARAM(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(ME)" value="PARAM(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(PR)" value="PARAM(PromotionID)">
					<WTCONDITION expr="PARAM(PromotionID)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(NA)" value="PARAM(NoAdd)">
					<WTCONDITION expr="PARAM(NoAdd)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<!-- Lookup the member if the reference is provided -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(ME)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(R)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="FetchRef">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Reference" direction="input" value="PARAM(R)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(ME)" value="ATTR(MemberID)"/>
<WTCUSTOM>
				If reqME = 0 Then
					response.write "0 - Member Not Found - Order Not Processed"
					response.end
				End If
</WTCUSTOM>
					</WTOBJECT>	
				</WTCODEGROUP>
				<!-- Get Company Info if we haven't already -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCALLSUB name="GetCompany(reqC)" />
				</WTCODEGROUP>
				<!-- Get system company and member if not provided -->
				<WTSETATTRIBUTE name="PARAM(C)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(ME)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(ME)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				
				<WTSETCACHE name="CONST(SHOPPINGCART)" value="CONST(0)">
					<WTCONDITION expr="PARAM(N)" oper="not-equal" value="CONST(0)"/>
				</WTSETCACHE>
				<WTGETCACHE name="CONST(tmpShoppingCartID)" value="CONST(SHOPPINGCART)" datatype="number"/>

				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="CONST(tmpShoppingCartID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(ME)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="CONST(tmpShoppingCartID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(SalesOrder.MemberID)" value="PARAM(ME)" />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="CONST(tmpShoppingCartID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(SalesOrder.CompanyID)" value="PARAM(C)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.MemberID)" value="PARAM(ME)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.PromotionID)" value="PARAM(PR)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.PartyID)" value="PARAM(PA)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.OrderDate)" value="SYS(now)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.AffiliateID)" value="SYS(AffiliateID)" />
					<!-- If we are not enrolling a new member and this is an autoship, set to autoship -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(SalesOrder.AutoShip)" value="SYSCON(AUTOSHIP-TEMPLATE)" />
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTPARAM name="tmpShoppingCartID" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTMETHOD name="SetAutoShip">
							<WTPARAM name="MemberID" direction="input" value="PARAM(ME)" />
							<WTPARAM name="SalesOrderID" direction="input" value="CONST(tmpShoppingCartID)" />
						</WTMETHOD>
					</WTCODEGROUP>
					<WTSETCACHE name="CONST(SHOPPINGCART)" value="CONST(tmpShoppingCartID)" />
				</WTOBJECT>
				<!-- If we are not enrolling a new member and this is an autoship, set autoship date -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(ME)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(ME)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(AutoShipDate)" oper="equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(AutoShipDate)" value="SYS(Date)" />
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTOBJECT>	
				</WTCODEGROUP>
<!--
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="CONST(tmpShoppingCartID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(PR)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="CONST(tmpShoppingCartID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(SalesOrder.PromotionID)" value="PARAM(PR)" />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
-->
<WTCUSTOM>
If (reqP &lt;&gt; "") Then
    Set oProduct = server.CreateObject("ptsProductUser.CProduct")
    Set oSalesItem = server.CreateObject("ptsSalesItemUser.CSalesItem")

    With oSalesItem
        .SalesOrderID = tmpShoppingCartID
        .Status = 1
    End With

	aProducts = Split(reqP, ",")
	reqTotal = UBOUND(aProducts)
	For x = 0 to reqTotal
		tmpLocks = 0
		tmpQty = 1
		tmpInputValues = ""
		product = aProducts(x)
		If Left(product, 1) = "(" Then
			pos = InStr(product, ")")
			If pos &gt; 0 Then
				tmpQty = Mid( product, 2, pos-2)
				product = Mid( product, pos+1)
			End If	
		End If
		If Left(product, 1) = "*" Then
			tmpLocks = 1
			product = Mid( product, 2)		
		End If
		If Left(product, 1) = "-" Then
			tmpLocks = 2
			product = Mid( product, 2)		
		End If
		pos = InStr(product, ";")
		If pos &gt; 0 Then
			tmpInputValues = Replace(product, ";", vbCrLf, pos+1)
			product = Left(product, pos-1)
		End If
		productid = product
		With oProduct
			.Load productid, 1
			tmpInventory = .Inventory
			tmpInStock = .InStock
			tmpPrice = .Price
			tmpBV = .BV
			tmpRecur = .Recur
			tmpTerm = .RecurTerm
			tmpInputOptions = .InputOptions
		End With

		'Check for Inventory Stock
		result = oProduct.CheckInventory( productid, 0 )
		If result &lt;&gt; -999999 AND result &lt; 0 Then
			If reqBadProduct &lt;&gt; "" Then reqBadProduct = reqBadProduct + ","
			reqBadProduct = reqBadProduct + productid
		Else
			tmpStartBill = 0
			tmpEndBill = 0
			If tmpRecur > 0 Then GetRecur tmpStartBill, tmpEndBill, tmpRecur, tmpTerm

			tmpOptionPrice = 0
			If tmpInputOptions &lt;&gt; "" Then
			    Set oInputOptions = server.CreateObject("wtSystem.CInputOptions")
				With oInputOptions
					.Load tmpInputOptions, tmpInputValues
					tmpInputValues = .Values
					tmpOptionPrice = .TotalPrice
				End With	
				Set oInputOptions = Nothing
			End If

			With oSalesItem
				SalesItemID = CLng(.DuplicateProduct(tmpShoppingCartID, productid))
				If (SalesItemID = 0) Then
					.ProductID = productid
					.Quantity = tmpQty
					.Price = tmpPrice
					.BV = tmpBV
					.BillDate = tmpStartBill
					.EndDate = tmpEndBill
					.InputValues = tmpInputValues
					.OptionPrice = tmpOptionPrice
					.Locks = tmpLocks
					SalesItemID = .Add(1)
				End If
			End With
		End If
    Next
    Set oSalesItem = Nothing
    Set oProduct = Nothing
End If
</WTCUSTOM>
				<WTRETURN>
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)" />
					<WTLINK name="0432" return="false">
						<WTPARAM name="CompanyID" value="PARAM(C)"/>
						<WTPARAM name="MemberID" value="PARAM(SP)"/>
						<WTPARAM name="S" value="PARAM(S)"/>
						<WTPARAM name="L" value="PARAM(L)"/>
						<WTPARAM name="T" value="PARAM(T)"/>
						<WTPARAM name="G" value="PARAM(G)"/>
						<WTPARAM name="A" value="PARAM(A)"/>
					</WTLINK>
				</WTRETURN>
				<WTRETURN>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTLINK name="5251" return="false">
						<WTPARAM name="ShoppingCartID" value="CONST(tmpShoppingCartID)"/>
						<WTPARAM name="CompanyID" value="PARAM(C)"/>
						<WTPARAM name="MemberID" value="PARAM(ME)"/>
						<WTPARAM name="SponsorID" value="PARAM(SP)"/>
						<WTPARAM name="NoAdd" value="PARAM(NA)"/>
						<WTPARAM name="BadProduct" value="PARAM(BadProduct)"/>
						<WTPARAM name="ProductTypeID" value="PARAM(PT)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--******************************************************************************************-->
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="5251" caption="Shopping Cart" focus="false" navbar="false" footer="false"  
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="5251">
		<!--============================================================================================-->
			<WTPARAM name="ShoppingCartID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="SponsorID" datatype="number" />
			<WTPARAM name="NoAdd" datatype="number" />
			<WTPARAM name="Shipping" datatype="number" />
			<WTPARAM name="ShipOption" datatype="text" />
			<WTPARAM name="Code" datatype="text" />
			<WTPARAM name="BadProduct" datatype="text" />
			<WTPARAM name="Invalid" datatype="number" />
			<WTPARAM name="EditItems" datatype="number" />
			<WTPARAM name="Dirty" datatype="number" />
			<WTPARAM name="ProductTypeID" datatype="number" />
			<WTPARAM name="Public" datatype="number" />
			<WTPARAM name="Level" datatype="number" />
			<WTPARAM name="RemovePromo" datatype="number" />
			<WTPARAM name="Credit" datatype="text" />
			<WTPARAM name="ReferredBy" datatype="text"/>

			<WTINCLUDE name="InputOptions.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Dirty)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Public)" value="CONST(1)"/>
				<WTCALLSUB name="GoProducts">
					<WTCONDITION expr="PARAM(ProductTypeID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(SponsorID)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(SponsorID)" value="A" datatype="number"/>
			</WTCODEGROUP>

			<WTSUB name="GoProducts">
				<WTRETURN>
					<WTLINK name="5252" nolocaldata="true">
						<WTPARAM name="ProductTypeID" value="PARAM(ProductTypeID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="SponsorID" value="PARAM(SponsorID)"/>
						<WTPARAM name="Public" value="PARAM(Public)"/>
						<WTPARAM name="Level" value="PARAM(Level)"/>
					</WTLINK>
				</WTRETURN>
			</WTSUB>
			
			<WTSUB name="LoadShoppingCart">
				<WTGETCACHE name="PARAM(ShoppingCartID)" value="CONST(SHOPPINGCART)" datatype="number"/>
				<WTSETATTRIBUTE name="CONST(tmpSalesItems)" value="CONST(0)" />
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="PARAM(ShoppingCartID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(ShoppingCartID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(SalesOrder.CompanyID)" />
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(SalesOrder.MemberID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
					<WTMETHOD name="GetShipping">
						<WTPARAM name="reqShipping" direction="return" datatype="number" />
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(ShoppingCartID)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="PARAM(Shipping)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ShipOption)" value="ATTR(Shopping)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Public)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(Level)" value="ATTR(Level)"/>
<!--
					<WTSETATTRIBUTE name="PARAM(Public)" value="CONST(0)">
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)" />
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(2)" connector="or"/>
					</WTSETATTRIBUTE>
-->					
					<!-- Check for Member Credit -->
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="reqCredit" direction="return" datatype="text"/>
					</WTMETHOD>
<WTCUSTOM>
		If reqCredit &lt;&gt; "" Then
			If reqCredit = "0.00" Then
				reqCredit = ""
			Else	
				reqCredit = FormatCurrency(reqCredit)
			End If
		End If
</WTCUSTOM>					
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(SponsorID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(SponsorID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTCONDITION expr="PARAM(ShoppingCartID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(ShoppingCartID)" />
					</WTMETHOD>
<WTCUSTOM>
				For Each oSalesItem in oSalesItems
					tmpSalesItems = tmpSalesItems + 1
					With oSalesItem
						'Remove locks from sales items for employees, company administrators and group managers
			            If (reqSysUserGroup &lt;= 23) Or (reqSysUserGroup = 51) Or (reqSysUserGroup = 52) Then
							.Locks = 0
						End If	
			            If .Locks = 0 Then reqEditItems = 1
						.Price = CCUR(.Price) + CCUR(.OptionPrice)
						.OptionPrice = CCUR(.Price) * CLng(.Quantity)
						tmpValid = IsValidInputOptions( .InputOptions, .InputValues)
						If tmpValid = 0 Then 
							reqInvalid = reqInvalid + 1
							.Invalid = 1
						Else	
							.Invalid = 0
						End If	

'						If .InputValues &lt;&gt; "" Then
'							pos = InStr(.InputValues, "(")
'							If pos &gt; 0 Then
'								.InputValues = Left(.InputValues, pos-1)
'							End If
'						End If
					End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesItems" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTOBJECT name="ProductTypes" project="ptsProductTypeUser" class="CProductTypes">
					<WTCONDITION expr="PARAM(NoAdd)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Public)" oper="not-equal" value="CONST(0)" />
						<WTMETHOD name="EnumCompanyPublic">
							<WTPARAM name="xmlProductTypes" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="ItemID" direction="input" value="CONST(tmpProductTypeID)"/>
							<WTPARAM name="Element" direction="input" value="CONST()"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Public)" oper="equal" value="CONST(0)" />
						<WTMETHOD name="EnumCompanyAll">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							<WTPARAM name="xmlProductTypes" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="ItemID" direction="input" value="CONST(tmpProductTypeID)"/>
							<WTPARAM name="Element" direction="input" value="CONST()"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="EnumCompany">
							<WTCONDITION expr="NotEmployee"/>
							<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
							<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
							<WTPARAM name="xmlProductTypes" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Levels" direction="input" value="CONST(CStr(reqLevel))"/>
							<WTPARAM name="ItemID" direction="input" value="CONST(tmpProductTypeID)"/>
							<WTPARAM name="Element" direction="input" value="CONST()"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
<!-- Check if there is only one product type, if so, select and go to it -->
<WTCODEGROUP>
	<WTCONDITION expr="CONST(tmpSalesItems)" oper="equal" value="CONST(0)" />
<WTCUSTOM>
Set oProductType = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
oProductType.loadXML xmlProductTypes
Set oItems = oProductType.selectNodes("PTSPRODUCTTYPES/ENUM") 
x = 0
id = 0
For Each oItem In oItems
   x = x + 1
   id = oItem.getAttribute("id") 
Next
Set oItems = Nothing
Set oProductType = Nothing

If( x = 2 ) Then
	reqProductTypeID = id
	GoProducts()	
End If
</WTCUSTOM>
</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="SaveSalesOrder">
				<WTGETCACHE name="PARAM(ShoppingCartID)" value="CONST(SHOPPINGCART)" datatype="number"/>

				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="PARAM(Code)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTMETHOD name="GetPromotion">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(ShoppingCartID)" />
						<WTPARAM name="Code" direction="input" value="PARAM(Code)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Code)" value="CONST(&quot;&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(1)" />
						<WTERROR number="10015" message="Oops, Invalid Promotion Code." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(2)" />
						<WTERROR number="10016" message="Oops, The Promotion has not started." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(3)" />
						<WTERROR number="10017" message="Oops, The Promotion has expired." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(4)" />
						<WTERROR number="10018" message="Oops, The Promotion has been used." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(ShoppingCartID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(SalesOrder.Ship)" value="FORM(Ship)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.Notes)" value="FORM(Notes)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(RemovePromo)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(SalesOrder.PromotionID)" value="CONST(0)" />
						<WTSETATTRIBUTE name="PARAM(RemovePromo)" value="CONST(0)" />
					</WTCODEGROUP>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidateSalesItems">
				<WTGETCACHE name="PARAM(ShoppingCartID)" value="CONST(SHOPPINGCART)" datatype="number"/>
				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(ShoppingCartID)" />
					</WTMETHOD>
<WTCUSTOM>
				For Each oSalesItem in oSalesItems
					With oSalesItem
						tmpErrors = ValidateInputOptions( .InputOptions, .InputValues)
					End With
				Next
</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				If reqBadProduct &lt;&gt; "" Then
					Set oProduct = server.CreateObject("ptsProductUser.CProduct")
					aProducts = Split(reqBadProduct, ",")
					reqTotal = UBOUND(aProducts)
					For x = 0 to reqTotal
						productid = aProducts(x)
						With oProduct
							.Load productid, 1
							DoError 0, "", "Oops, " + .ProductName + " is no longer available."
						End With
					Next
					Set oProduct = Nothing
				End If
</WTCUSTOM>
				<WTSETCACHE name="CONST(SHOPPINGCART)" value="CONST(&quot;&quot;)"/>
				<WTSETCACHE name="CONST(SHOPPINGCART)" value="PARAM(ShoppingCartID)">
					<WTCONDITION expr="PARAM(ShoppingCartID)" oper="not-equal" value="CONST(0)"/>
				</WTSETCACHE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadShoppingCart"/>
			</WTACTION>
			
			<WTACTION id="2" name="Checkout" type="Update">
				<WTCALLSUB name="SaveSalesOrder"/>
				<WTCALLSUB name="ValidateSalesItems"/>
				<WTCALLSUB name="LoadShoppingCart">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="5253" nolocaldata="true">
						<WTPARAM name="SponsorID" value="PARAM(SponsorID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
<!-- FIX SSL
					<WTLINK name="5253" nolocaldata="true" secure="true">
						<WTPARAM name="SponsorID" value="PARAM(SponsorID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
-->					
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="4" name="Shipping" type="Update">
				<WTCALLSUB name="SaveSalesOrder"/>
				<WTCALLSUB name="LoadShoppingCart"/>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right" />
				<WTCOLUMN width="700" align="left" />
				<WTCOLUMN width="25" align="left" />

				<WTFUNCTION name="GoProductType()">
					var ptype = document.getElementById('ProductType').value;
					var company = document.getElementById('CompanyID').value;
					var member = document.getElementById('MemberID').value;
					var sponsor = document.getElementById('SponsorID').value;
					var public = document.getElementById('Public').value;
					var level = document.getElementById('Level').value;
					if ( ptype != 0 )
					document.location='5252.asp?producttypeid=' + ptype + '&amp;companyid=' + company +  '&amp;memberid=' + member + '&amp;sponsorid=' + sponsor + '&amp;public=' + public + '&amp;level=' + level
				</WTFUNCTION>
				<WTFUNCTION name="ViewPromo(id)">
					var url, win;
					url = "0704.asp?promotionid=" + id
		            win = window.open(url,"Promo","top=100,left=100,height=300,width=650,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="CloseAutoShip()">
					var parent = window.opener;
					if( parent != null ) 
						parent.doSubmit(0,"");
					window.close();
				</WTFUNCTION>
				<WTFUNCTION name="ViewImage(id)">
					var url, win;
					url = "5006.asp?productid=" + id
		            win = window.open(url,"ProductImage","top=50,left=50,height=500,width=500,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTSTATIC label="EditProduct"/>
				<WTSTATIC label="EditProduct1"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(SponsorID)"/>
					<WTHIDDEN value="PARAM(Dirty)"/>
					<WTHIDDEN value="PARAM(Public)"/>
					<WTHIDDEN value="PARAM(Level)"/>
					<WTHIDDEN value="PARAM(RemovePromo)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NoAdd)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPRODUCTTYPES/ENUM))" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="gray" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" bold="true" align="center">
							<WTSTATIC tag="ContinueShopping" fontcolor="dimgray" fontsize="3">
								<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSALESITEMS/PTSSALESITEM))" oper="not-equal" value="CONST(0)" />
							</WTSTATIC>
							<WTSTATIC tag="SelectProductType">
								<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
							</WTSTATIC>
							<WTSTATIC tag="SelectAutoShipProductType">
								<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
							</WTSTATIC>
						</WTSTATIC>
						<WTCOMBO col="1" merge="2" value="ATTR(Product.ProductType)" datapath="/DATA/TXN/PTSPRODUCTTYPES/ENUM" prespace="false">
							<WTCHANGE>GoProductType();</WTCHANGE>
						</WTCOMBO>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="gray" />
					</WTROW>
				</WTCODEGROUP>

				<WTSTATIC label="Ship1" />
				<WTSTATIC label="Ship2" />
				<WTSTATIC label="Ship3" />
				<WTSTATIC label="Ship4" />
				<WTSTATIC label="Ship5" />

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ShoppingCartID)" oper="equal" value="CONST('')" />
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSALESITEMS/PTSSALESITEM))" oper="equal" value="CONST(0)" connector="or" />
					<WTROW margin-top="12">
						<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
						<WTBUTTON col="1" merge="2" action="3" value="CONST(CloseShoppingCart)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
						<WTBUTTON col="1" merge="2" value="CONST(CloseAutoShipment)" align="center">
							<WTCLICK>CloseAutoShip()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ShoppingCartID)" oper="not-equal" value="CONST('')" />
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSALESITEMS/PTSSALESITEM))" oper="not-equal" value="CONST(0)" connector="and" />
					<WTROW>
						<WTSTATIC col="1" />
						<WTTABLE col="2">
							<WTCOLUMN width="500" align="left" />
							<WTCOLUMN width="200" align="right" />
							<WTROW>
								<WTSTATIC col="1" align="left" class="PageHeading">
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
										<WTSTATIC label="ShoppingCart"/>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(SponsorID)" oper="not-equal" value="CONST(0)" />
											<WTSTATIC space="2"/>
											<WTSTATIC fontsize="2" fontcolor="purple">
												<WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)"/>
											</WTSTATIC>
										</WTCODEGROUP>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
										<WTSTATIC tag="ShoppingCart">
											<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
										</WTSTATIC>
										<WTSTATIC tag="AutoShip">
											<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
										</WTSTATIC>
										<WTCODEGROUP>
											<WTCONDITION expr="IsEmployee"/>
											<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
											<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
											<WTSTATIC value="PARAM(ShoppingCartID)" fontcolor="purple" space="1"/>
										</WTCODEGROUP>
										<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
										<WTSTATIC value="ATTR(Member.NameLast)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Credit)" oper="not-equal" value="CONST('')" />
											<WTSTATIC space="2"/>
											<WTSTATIC fontsize="2" fontcolor="purple">
												<WTSTATIC tag="Credit" value="PARAM(Credit)"/>
											</WTSTATIC>
										</WTCODEGROUP>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTBUTTON col="2" value="CONST(CloseShoppingCart)" align="right" btnclass="smbutton">
									<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
									<WTCLICK>window.close()</WTCLICK>
								</WTBUTTON>
							</WTROW>
						</WTTABLE>					
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(EditItems)" oper="not-equal" value="CONST(0)" />
						<WTSTATIC col="1" />
						<WTSTATIC col="2" align="left" class="prompt">
							<WTSTATIC label="ShoppingCartText">
								<WTCONDITION expr="PARAM(Invalid)" oper="equal" value="CONST(0)" />
							</WTSTATIC>
							<WTSTATIC label="ShoppingCartInvalid" fontcolor="red">
								<WTCONDITION expr="PARAM(Invalid)" oper="not-equal" value="CONST(0)" />
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="3">
						<WTSTATIC col="1" />
						<WTRECORDSET col="2" graybar="true" entity="SalesItem">
							<WTCOLUMN width="10" align="left" valign="top"/>
							<WTCOLUMN width="4" align="center" valign="top" label="Qty"/>
							<WTCOLUMN width="62" align="left" valign="top" label="Description"/>
							<WTCOLUMN width="10" align="right" valign="top" label="Price"/>
							<WTCOLUMN width="10" align="right" valign="top" label="Total"/>
							<WTCOLUMN width="4" align="right" valign="top" />
							<WTROW>
								<WTSTATIC col="1" valign="top">
									<WTCODEGROUP>
										<WTIMAGE value="DATA(Product.Image)" imgwidth="60" imgpath="Images\Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;\">
											<WTCONDITION expr="DATA(Image)" oper="not-equal" value="CONST('')" />
											<WTLINK name="ViewImage(&lt;xsl:value-of select=&quot;@productid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(SalesItem.Quantity)" valign="top" />
								<WTSTATIC col="3" valign="top">
									<WTSTATIC value="DATA(SalesItem.ProductName)" space="1" bold="true">
										<WTCONDITION expr="DATA(Locks)" oper="equal" value="SYSCON(LOCKS-NOEDIT)"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Locks)" oper="not-equal" value="SYSCON(LOCKS-NOEDIT)"/>
										<WTSTATIC value="DATA(SalesItem.ProductName)" space="1" bold="true">
											<WTLINK name="5303" nodata="true">
												<WTPARAM name="SalesItemID" value="DATA(SalesItem.SalesItemID)"/>
												<WTPARAM name="contentpage" value="CONST(3)"/>
											</WTLINK>
										</WTSTATIC>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Invalid)" oper="equal" value="CONST(0)" />
											<WTIMAGE value="CONST(Edit.gif)" alt="EditProduct" imgalign="absmiddle">
												<WTLINK name="5303" nodata="true">
													<WTPARAM name="SalesItemID" value="DATA(SalesItem.SalesItemID)"/>
													<WTPARAM name="contentpage" value="CONST(3)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Invalid)" oper="not-equal" value="CONST(0)" />
											<WTIMAGE value="CONST(Edit1.gif)" alt="EditProduct1" imgalign="absmiddle">
												<WTLINK name="5303" nodata="true">
													<WTPARAM name="SalesItemID" value="DATA(SalesItem.SalesItemID)"/>
													<WTPARAM name="contentpage" value="CONST(3)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
									<WTSTATIC newline="1"/>
									<WTSTATIC value="DATA(SalesItem.InputValues)" fontcolor="blue"/>
								</WTSTATIC>
								<WTSTATIC col="4" value="DATA(SalesItem.Price)"  valign="top"/>
								<WTSTATIC col="5" value="DATA(SalesItem.OptionPrice)"  valign="top"/>
								<WTSTATIC col="6" valign="top">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Locks)" oper="equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(Trash.gif)" alt="Delete" imgalign="absmiddle">
											<WTLINK name="5303" nodata="true"><WTPARAM name="DeleteID" value="DATA(SalesItem.SalesItemID)" /></WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(Valid)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="5" fontcolor="red">
								<WTSTATIC label="SalesItemValid1">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesItemValid2">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesItemValid3">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesItemValid4">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesItemValid12">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(12)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesItemValid13">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(13)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesItemValid14">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(14)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1" />
						<WTTABLE col="2">
							<WTCOLUMN width="120" align="right" />
							<WTCOLUMN width="460" align="left" />
							<WTCOLUMN width="60" align="right" />
							<WTCOLUMN width="60" align="right" />
							<WTROW>
								<WTSTATIC col="1" merge="2" />
								<WTSTATIC col="3" tag="Amount" height="18" />
								<WTSTATIC col="4" value="ATTR(SalesOrder.Amount)" bold="true" />
							</WTROW>
							<WTROW>
								<WTCONDITION expr="ATTR(SalesOrder.Discount)" oper="not-equal" value="CONST('$0.00')" />
								<WTCONDITION expr="ATTR(SalesOrder.PromotionID)" oper="not-equal" value="CONST(0)" connector="or"/>
								<WTSTATIC col="1" merge="2" align="left" bold="true">
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(SalesOrder.PromotionID)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(SalesOrder.PromotionName)" fontcolor="blue"/>
										<WTCODEGROUP>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Preview.gif)">
												<WTLINK click="true" name="CONST(ViewPromo(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSALESORDER/@promotionid&quot;/&gt;))"/>
											</WTIMAGE>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Trash.gif)">
												<WTLINK click="true" name="CONST(document.getElementById('RemovePromo').value=1;doSubmit(4,''))"/>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTSTATIC tag="Discount" height="18">
										<WTCONDITION expr="ATTR(SalesOrder.Discount)" oper="not-equal" value="CONST('$0.00')" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="4">
									<WTSTATIC value="ATTR(SalesOrder.Discount)" bold="true">
										<WTCONDITION expr="ATTR(SalesOrder.Discount)" oper="not-equal" value="CONST('$0.00')" />
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
								<WTSTATIC col="1" tag="PromotionID">
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="ATTR(SalesOrder.PromotionID)" oper="equal" value="CONST(0)" connector="or"/>
								</WTSTATIC>
								<WTTEXT col="2" value="PARAM(Code)" size="5">
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="ATTR(SalesOrder.PromotionID)" oper="equal" value="CONST(0)" connector="or"/>
								</WTTEXT>
								<WTBUTTON col="2" action="4" value="CONST(Update)" btnclass="smbutton">
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="ATTR(SalesOrder.PromotionID)" oper="equal" value="CONST(0)" connector="or"/>
								</WTBUTTON>
								<WTSTATIC col="3" tag="Tax" height="18" />
								<WTSTATIC col="4" value="ATTR(SalesOrder.Tax)" bold="true" />
							</WTROW>
							<WTROW>
								<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="Tax" height="18" />
								<WTSTATIC col="4" value="ATTR(SalesOrder.Tax)" bold="true" />
							</WTROW>
							<WTROW>
								<WTCONDITION expr="PARAM(Shipping)" oper="not-equal" value="CONST(0)"/>
								<WTSTATIC col="1" tag="Ship"/>
								<WTCOMBO col="2" value="ATTR(SalesOrder.Ship)">
									<WTCHANGE>document.getElementById('Dirty').value = 1</WTCHANGE>
									<WTOPTION id="1" label="Ship1">
										<WTCONDITION expr="PARAM(ShipOption)" oper="equal" value="CONST('')"/>
										<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@shipoption, '1'))" connector="or"/>
									</WTOPTION>
									<WTOPTION id="2" label="Ship2">
										<WTCONDITION expr="PARAM(ShipOption)" oper="equal" value="CONST('')"/>
										<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@shipoption, '2'))" connector="or"/>
									</WTOPTION>
									<WTOPTION id="3" label="Ship3">
										<WTCONDITION expr="PARAM(ShipOption)" oper="equal" value="CONST('')"/>
										<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@shipoption, '3'))" connector="or"/>
									</WTOPTION>
									<WTOPTION id="4" label="Ship4">
										<WTCONDITION expr="PARAM(ShipOption)" oper="equal" value="CONST('')"/>
										<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@shipoption, '4'))" connector="or"/>
									</WTOPTION>
									<WTOPTION id="5" label="Ship5">
										<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@shipoption, '5'))"/>
									</WTOPTION>
								</WTCOMBO>
								<WTSTATIC col="3" tag="Shipping" height="18"/>
								<WTSTATIC col="4" value="ATTR(SalesOrder.Shipping)" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2" align="left" class="prompt">
<!--
									<WTCODEGROUP>
										<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="SYSCON(LEGACYMAX)" />
										<WTSTATIC label="ShipMessage14a" newline="1"/>
										<WTSTATIC label="ShipMessage14b" newline="2"/>
									</WTCODEGROUP>
-->
									<WTCODEGROUP>
<!--										<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />-->
<!--
										<WTSTATIC tag="Instructions">
											<WTCONDITION expr="PARAM(Shipping)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
-->
									</WTCODEGROUP>
<!--									
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
										<WTSTATIC tag="PaymentMethod"/>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTCLICK>
												var url, win 
												url = "2904.asp?payment=" + document.getElementById('Notes').value + "&amp;cart=1";
												win = window.open(url, '', "top=200 left=200 width=360, height=200 status=no");
												win.focus();
											</WTCLICK>
										</WTIMAGE>
									</WTCODEGROUP>
-->									
								</WTSTATIC>
								<WTSTATIC col="3" tag="Total" valign="top"/>
								<WTSTATIC col="4" value="ATTR(SalesOrder.Total)" valign="top" bold="true" />
							</WTROW>
							<WTCODEGROUP>
								<WTROW>
									<WTSTATIC col="1" merge="4" tag="Instructions" align="left"/>
								</WTROW>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)"/>
									<WTROW>
										<WTMEMO col="1" merge="4" value="ATTR(SalesOrder.Notes)" cols="50" rows="4" align="left"/>
									</WTROW>
									<WTROW margin-top="6">
										<WTBUTTON col="1" merge="2" action="4" value="CONST(Update)" align="center"/>
									</WTROW>
								</WTCODEGROUP>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)"/>
								<WTROW>
									<WTMEMO col="1" merge="4" value="ATTR(SalesOrder.Notes)" cols="50" rows="2" align="left">
										<WTCHANGE>document.getElementById('Dirty').value = 1</WTCHANGE>
									</WTMEMO>
								</WTROW>
								<WTROW margin-top="6">
									<WTBUTTON col="1" merge="2" action="4" value="CONST(Save)" align="center"/>
								</WTROW>
							</WTCODEGROUP>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="4" height="1" color="SYS(medium)" />
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(SalesOrder.Valid)" oper="equal" value="CONST(0)" />
						<WTROW margin-top="12">
							<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="not-equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
							<WTSTATIC col="1" merge="2" label="CheckoutText" align="right" class="prompt"/>
							<WTBUTTON col="1" merge="2" action="2" value="CONST(Checkout)"/>
							<WTBUTTON col="1" merge="2" value="CONST(Close)">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
						<WTROW margin-top="12">
							<WTCONDITION expr="ATTR(SalesOrder.AutoShip)" oper="equal" value="SYSCON(AUTOSHIP-TEMPLATE)" />
							<WTBUTTON col="1" merge="2" value="CONST(CloseAutoShipment)" align="right">
								<WTCLICK>
									var dirty = document.getElementById('Dirty').value;
									var good = 1;
									if( dirty != 0 ) {
										alert('Click the "Save" button to save your changes.');
										good = 0;
									}	
									if( good == 1 ) {
										CloseAutoShip();
									}	
								</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="5252" caption="Shopping Cart" footer="false" navbar="false"
	   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="5252" track="0">
		<!--==================================================================-->
			<WTPARAM name="ProductTypeID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="SponsorID" datatype="number" />
			<WTPARAM name="Public" datatype="number" />
			<WTPARAM name="Level" datatype="number" />
			<WTPARAM name="Sort" datatype="number" />

			<WTINCLUDE name="Recur.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Products" project="ptsProductUser" class="CProducts">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Public)" oper="not-equal" value="CONST(0)" />
						<WTMETHOD name="ListProductTypePublic">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(0)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
						</WTMETHOD>
						<WTMETHOD name="ListProductPriceLowPublic">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(1)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
						</WTMETHOD>
						<WTMETHOD name="ListProductPriceHighPublic">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(2)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
						</WTMETHOD>
						<WTMETHOD name="ListProductNamePublic">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(3)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Public)" oper="equal" value="CONST(0)" />
						<WTMETHOD name="ListProductType">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(0)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
							<WTPARAM name="Levels" direction="input" value="CONST(CStr(reqLevel))" />
						</WTMETHOD>
						<WTMETHOD name="ListProductPriceLow">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(1)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
							<WTPARAM name="Levels" direction="input" value="CONST(CStr(reqLevel))" />
						</WTMETHOD>
						<WTMETHOD name="ListProductPriceHigh">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(2)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
							<WTPARAM name="Levels" direction="input" value="CONST(CStr(reqLevel))" />
						</WTMETHOD>
						<WTMETHOD name="ListProductName">
							<WTCONDITION expr="PARAM(Sort)" oper="equal" value="CONST(3)" />
							<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
							<WTPARAM name="Levels" direction="input" value="CONST(CStr(reqLevel))" />
						</WTMETHOD>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProducts" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="ProductType" project="ptsProductTypeUser" class="CProductType">
					<WTMETHOD name="Load">
						<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProductType" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Add" type="Add">
				<WTGETCACHE name="CONST(tmpShoppingCartID)" value="CONST(SHOPPINGCART)" datatype="number"/>
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="CONST(tmpShoppingCartID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(SalesOrder.CompanyID)" value="PARAM(CompanyID)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.MemberID)" value="PARAM(MemberID)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.OrderDate)" value="SYS(now)" />
					<WTSETATTRIBUTE name="ATTR(SalesOrder.AffiliateID)" value="SYS(AffiliateID)" />
					<WTMETHOD name="Add">
						<WTPARAM name="tmpShoppingCartID" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETCACHE name="CONST(SHOPPINGCART)" value="CONST(tmpShoppingCartID)" />
				</WTOBJECT>
				<WTOBJECT name="Products" project="ptsProductUser" class="CProducts">
					<WTMETHOD name="ListProductType">
						<WTCONDITION expr="PARAM(Public)" oper="equal" value="CONST(0)" />
						<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
						<WTPARAM name="Levels" direction="input" value="CONST(CStr(reqLevel))" />
					</WTMETHOD>
					<WTMETHOD name="ListProductTypePublic">
						<WTCONDITION expr="PARAM(Public)" oper="not-equal" value="CONST(0)" />
						<WTPARAM name="ProductTypeID" direction="input" value="PARAM(ProductTypeID)" />
					</WTMETHOD>
<WTCUSTOM>
				Set oProduct = server.CreateObject("ptsProductUser.CProduct")
				Set oSalesItem = server.CreateObject("ptsSalesItemUser.CSalesItem")
				With oSalesItem
					.SalesOrderID = tmpShoppingCartID
					.Status = 1
					.Quantity = 1
				End With
				For Each oItem in oProducts
					tmpID = oItem.ProductID
					tmpQty = Request.Form.Item(tmpID)
					If tmpQty = "" Then tmpQty = 0
					If tmpQty &gt; 0 Then
						With oProduct
							.Load CLng(tmpID), CLng(reqSysUserID)
							tmpPrice = .Price
							tmpBV = .BV
							tmpRecur = .Recur
							tmpTerm = .RecurTerm
							tmpInputOptions = .InputOptions
						End With	
						If (Err.Number = 0) Then
							tmpStartBill = 0
							tmpEndBill = 0
							If tmpRecur > 0 Then GetRecur tmpStartBill, tmpEndBill, tmpRecur, tmpTerm

							tmpInputValues = ""
							tmpOptionPrice = 0
							If tmpInputOptions &lt;&gt; "" Then
					            Set oInputOptions = server.CreateObject("wtSystem.CInputOptions")
								With oInputOptions
									.Load tmpInputOptions
									tmpInputValues = .Values
									tmpOptionPrice = .TotalPrice
								End With	
					            Set oInputOptions = Nothing
							End If

							With oSalesItem
								.ProductID = CLng(tmpID)
								.Quantity = tmpQty
								.Price = tmpPrice
								.BV = tmpBV
								.BillDate = tmpStartBill
								.EndDate = tmpEndBill
								.InputValues = tmpInputValues
								.OptionPrice = tmpOptionPrice
								SalesItemID = CLng(.Add( CLng(reqSysUserID )))
							End With
						End If
					End If
				Next
				Set oSalesItem = Nothing
				Set oProduct = Nothing
</WTCUSTOM>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="5251" return="false">
						<WTPARAM name="ShoppingCartID" value="CONST(tmpShoppingCartID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="SponsorID" value="PARAM(SponsorID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTGETCACHE name="CONST(tmpShoppingCartID)" value="CONST(SHOPPINGCART)" datatype="number"/>
				<WTRETURN>
					<WTLINK name="5251" return="false">
						<WTPARAM name="ShoppingCartID" value="CONST(tmpShoppingCartID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="SponsorID" value="PARAM(SponsorID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<!--******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="130" align="center" />
				<WTCOLUMN width="30" align="center" />
				<WTCOLUMN width="480" align="left" />
				<WTCOLUMN width="60" align="right" />

				<WTFUNCTION name="ViewImage(id)">
					var url, win;
					url = "5006.asp?productid=" + id
		            win = window.open(url,"ProductImage","top=50,left=50,height=500,width=500,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="4" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="4" value="ATTR(ProductType.Description)" embedhtml="true" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="4" label="SortBy" align="center" bold="true"/>
					<WTCOMBO col="1" name="Sort" value="PARAM(Sort)">
						<WTCHANGE>doSubmit(0,"")</WTCHANGE>
						<WTOPTION id="0" label="Default" />
						<WTOPTION id="1" label="LowestPrice" />
						<WTOPTION id="2" label="HighestPrice" />
						<WTOPTION id="3" label="ProductName" />
					</WTCOMBO>
					<WTBUTTON col="1" action="1" value="CONST(AddCart)" align="center" />
					<WTBUTTON col="1" action="3" value="CONST(Return)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="4" height="1" color="SYS(divider)" />
				</WTROW>
				<WTREPEAT entity="Product">
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" valign="top">
							<WTCODEGROUP>
								<WTIMAGE value="DATA(Product.Image)" imgwidth="120" imgpath="Images\Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;\">
									<WTCONDITION expr="DATA(Product.Image)" oper="not-equal" value="CONST('')" />
									<WTLINK name="ViewImage(&lt;xsl:value-of select=&quot;@productid&quot;/&gt;)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="2" valign="top">
							<WTCODEGROUP>
<!--								<WTCHECK name="&lt;xsl:value-of select=&quot;@productid&quot;/&gt;" />-->
								<WTTEXT name="&lt;xsl:value-of select=&quot;@productid&quot;/&gt;" size="1" value="CONST(0)"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="3" align="left" valign="top">
							<WTSTATIC value="DATA(Product.ProductName)" fontsize="3" newline="1" />
							<WTSTATIC value="DATA(Product.Description)" embedhtml="true" />
						</WTSTATIC>
						<WTSTATIC col="4" valign="top">
							<WTSTATIC value="DATA(Product.Price)" valign="top" bold="true">
								<WTCONDITION expr="DATA(Product.Price)" oper="not-equal" value="CONST('$0.00')" />
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="4" height="1" color="gray"/>
					</WTROW>
				</WTREPEAT>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="4" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTBUTTON col="1" merge="4" action="1" value="CONST(AddCart)" align="center" />
					<WTBUTTON col="1" action="3" value="CONST(Return)" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="5253" caption="Check Out" footer="false" navbar="false" 
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="5253">
		<!--=============================================================================================-->
			<WTPARAM name="SalesOrderID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="AddressID" datatype="number" />
			<WTPARAM name="SponsorID" datatype="number" />
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="Total" datatype="currency" />
			<WTPARAM name="ProcessPayment" datatype="number" />
			<WTPARAM name="MemberEmail" datatype="text" />
			<WTPARAM name="ShipOption" datatype="text" />
			<WTPARAM name="ExistingPayments" datatype="number" />
			<WTPARAM name="NoBill" datatype="number" />
			<WTPARAM name="CashPayment" datatype="number"/>
			<WTPARAM name="Wallet" datatype="text"/>

			<WTPARAM name="Street12" datatype="text"/>
			<WTPARAM name="Street22" datatype="text"/>
			<WTPARAM name="City2" datatype="text"/>
			<WTPARAM name="State2" datatype="text"/>
			<WTPARAM name="Zip2" datatype="text"/>
			<WTPARAM name="CountryID2" datatype="text"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsEmployee"/>
				<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
				<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(SponsorID)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(SponsorID)" value="A" datatype="number"/>
			</WTCODEGROUP>

			<WTSUB name="LoadOrder">
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)">
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Total)" value="ATTR(Total)" />
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)"/>
					</WTOBJECT>
					<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="FetchCompany">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						</WTMETHOD>			
						<WTMETHOD name="Load">
							<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
						<WTSETATTRIBUTE name="PARAM(ShipOption)" value="ATTR(Shopping)"/>
<WTCUSTOM>If InStr(reqShipOption, "P") &gt; 0 Then reqProcessPayment = 1</WTCUSTOM>
<WTCUSTOM>If InStr(reqShipOption, "E") &gt; 0 Then reqExistingPayments = 1</WTCUSTOM>
					</WTOBJECT>
				</WTCODEGROUP>
				<WTOBJECT name="Payments" project="ptsPaymentUser" class="CPayments">
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(ExistingPayments)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="ListMemberPayments">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
<WTCUSTOM>
				Set oBilling = server.CreateObject("ptsBillingUser.CBilling")
				For Each oPayment In oPayments
					PaymentBilling oPayment.Description, oBilling
					With oBilling
						If .PayType = "1" Then   'Credit Card
							tmpDate = .CardMo + "/1/" + .CardYr
							If ISDATE(tmpDate) Then
								tmpDate = DATEADD("m", 1, tmpDate)
								If CDate(tmpDate) > Date() Then
									Select Case .CardType
									Case 1
										tmpCardType = "Visa"
										If InStr(reqPaymentOptions,"A") = 0 Then oPayment.Description = ""
									Case 2
										tmpCardType = "MasterCard"
										If InStr(reqPaymentOptions,"B") = 0 Then oPayment.Description = ""
									Case 3
										tmpCardType = "Discover"
										If InStr(reqPaymentOptions,"C") = 0 Then oPayment.Description = ""
									Case 4
										tmpCardType = "Amex"
										If InStr(reqPaymentOptions,"D") = 0 Then oPayment.Description = ""
									Case Else 
										oPayment.Description = ""
									End Select
									If oPayment.Description &lt;&gt; "" Then
										oPayment.Description = tmpCardType + ", ************" + Right(.CardNumber,4) + ", " + .CardMo + "/" + .CardYr + ", " + .CardName
									End If	
								Else
									oPayment.Description = ""
								End If	
							End If	
						End If
						If .PayType = "2" Then   'Check
							If InStr(reqPaymentOptions,"E") = 0 Then
								oPayment.Description = ""
							Else	
								oPayment.Description = .CheckBank + ", ************" + Right(.CheckAccount,4)+ ", " + .CheckName
							End If	
						End If
					End With
				Next
				Set oBilling = Nothing
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayments" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadCountry">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMember">
<WTCUSTOM>If reqMemberID = 0 Then reqMemberID = Numeric(Request.Form.Item("MemberID"))</WTCUSTOM>
				<WTCALLSUB name="LoadOrder" />
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpBillingID)" value="ATTR(BillingID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AddressID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="AddressID" direction="input" value="PARAM(AddressID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AddressID)" oper="equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
							<WTMETHOD name="FetchOwner">
								<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
								<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-SHIPPING)"/>
							</WTMETHOD>
							<WTMETHOD name="FetchOwner">
								<WTCONDITION expr="ATTR(Street1)" oper="equal" value="CONST(&quot;&quot;)"/>
								<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
								<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(AddressID)" value="ATTR(AddressID)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(AddressID)" oper="equal" value="CONST(0)"/>
							<WTMETHOD name="Load">
								<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(AddressID)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Street12)" value="ATTR(Street1)" />
							<WTSETATTRIBUTE name="PARAM(Street22)" value="ATTR(Street2)" />
							<WTSETATTRIBUTE name="PARAM(City2)" value="ATTR(City)" />
							<WTSETATTRIBUTE name="PARAM(State2)" value="ATTR(State)" />
							<WTSETATTRIBUTE name="PARAM(Zip2)" value="ATTR(Zip)" />
							<WTSETATTRIBUTE name="PARAM(CountryID2)" value="ATTR(CountryID)" />
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCALLSUB name="LoadCountry"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(tmpBillingID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			<WTSUB name="ReloadMember">
				<WTCALLSUB name="LoadOrder" />
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)" />
					<WTSETATTRIBUTE name="ATTR(Phone1)" value="FORM(Phone1)" />
					<WTSETATTRIBUTE name="ATTR(Phone2)" value="FORM(Phone2)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCODEGROUP>
						<WTMETHOD name="Load">
							<WTPARAM name="AddressID" direction="input" value="PARAM(AddressID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="ATTR(CountryID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCALLSUB name="LoadCountry"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)" />
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street12)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street22)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City2)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State2)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip2)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID2)" />
					<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
					<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
					<WTSETATTRIBUTE name="ATTR(CheckNumber)" value="FORM(CheckNumber)" />
					<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB sub="Reorder(product)">
<!--
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
-->				
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email3)"/>
				</WTOBJECT>
<WTCUSTOM>
		If InStr(tmpTo, "@") &gt; 0 Then
			If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
			tmpSubject = "REORDER: " + product
			tmpBody = ""
			SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
		End If
</WTCUSTOM>
			</WTSUB>

			<WTSUB sub="NewOrderNotice(id)">
<!--				
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
				</WTOBJECT>
-->				
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email3)"/>
					<WTCUSTOM>
						tmpURL = "http://" + reqSysServerName + reqSysServerPath + "5216.asp?SalesOrderID=" + CStr(id)

						If InStr(tmpTo, "@") &gt; 0 Then
						If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
							tmpSubject = "NEW ORDER: #" + CStr(id)
							tmpBody = "&lt;a href='" + tmpURL + "'&gt;Sales Order Receipt&lt;/a&gt;"
							SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
						End If
					</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>
			<WTCODEGROUP>
				<WTCONDITION expr="SYS(MemberID)" oper="not-equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)" />
			</WTCODEGROUP>
						
			<!-- ====================================================================== -->
			<WTACTION id="0" name="New" type="New">
				<WTGETCACHE name="PARAM(SalesOrderID)" value="CONST(SHOPPINGCART)" datatype="number"/>
				<WTCALLSUB name="LoadMember"/>
				<WTSETATTRIBUTE name="PARAM(CountryID2)" value="CONST(224)"/>
			</WTACTION>
			
			<!-- ====================================================================== -->
			<WTACTION id="1" name="Purchase" type="Update">
				<WTGETCACHE name="PARAM(SalesOrderID)" value="CONST(SHOPPINGCART)" datatype="number"/>

				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
					</WTMETHOD>
<WTCUSTOM>
				'confirm inventoried product availability
			    Set oProduct = server.CreateObject("ptsProductUser.CProduct")
				For Each oSalesItem In oSalesItems
					With oSalesItem
						result = oProduct.CheckInventory( .ProductID, .SalesItemID )
						If result &lt;&gt; -999999 AND result &lt; 0 Then DoError 0, "", "Oops, " + .ProductName + " is no longer available."
					End With	
				Next
			    Set oProduct = Nothing
</WTCUSTOM>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)" connector="and"/>

					<!-- Validate Card Number if paying by Credit Card -->
					<WTSETATTRIBUTE name="CONST(tmpPaymentMethod)" value="FORM(PaymentMethod)" datatype="number"/>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

					<!-- If NoBill, Don't validate payment -->
					<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpPaymentMethod)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
						<WTMETHOD name="ValidCheckRoute">
							<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
							<WTPARAM name="result" direction="return" datatype="number" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
							<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
						</WTCODEGROUP>
					</WTOBJECT>

					<!-- If NoBill, Don't validate payment -->
					<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpPaymentMethod)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
						<WTMETHOD name="ValidCardNumber">
							<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
							<WTPARAM name="result" direction="return" datatype="number" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
							<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
							<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- card matches selected type -->
							<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
							<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
							<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
							<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Visa -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(1)" />
							<WTCONDITION expr="NotPaymentVisa" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Mastercard -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(2)" />
							<WTCONDITION expr="NotPaymentMC" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Discover -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(3)" />
							<WTCONDITION expr="NotPaymentDiscover" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Amex -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(4)" />
							<WTCONDITION expr="NotPaymentAmex" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- All other credit cards are not allowed -->
							<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
					</WTOBJECT>
					<!-- If NoBill, Don't validate payment -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors" />
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(tmpPaymentMethod)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
						<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
						<WTCODEGROUP> <!-- check for current card date -->
							<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
							<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
						</WTCODEGROUP>
					</WTCODEGROUP>

					<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
						<WTCONDITION expr="NoErrors" />
						<WTCONDITION expr="CONST(tmpPaymentMethod)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
							<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
							<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
							<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
							<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
							<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
							<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
							<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
							<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street12)" />
							<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street22)" />
							<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City2)" />
							<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State2)" />
							<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip2)" />
							<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID2)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
							<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
							<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
							<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
							<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
							<WTSETATTRIBUTE name="ATTR(CheckNumber)" value="FORM(CheckNumber)" />
							<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
							<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="greater-equal" value="SYSCON(PAYTYPE-WALLET)" />
							<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
							<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
							<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Wallet)" />
						</WTCODEGROUP>
						<!-- If NoBill, Don't validate payment -->
						<WTMETHOD name="Validate">
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
							<WTPARAM name="New" direction="input" value="CONST(1)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTCALLSUB name="tmpDescription = BillingPayment( oBilling )"/>
					</WTOBJECT>
				</WTCODEGROUP>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-SHIPPING)" />
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="ATTR(CountryID)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="ATTR(CountryID)" oper="equal" value="CONST(&quot;0&quot;)" connector="or"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)" />
					<WTSETATTRIBUTE name="ATTR(Phone1)" value="FORM(Phone1)" />
					<WTSETATTRIBUTE name="ATTR(Phone2)" value="FORM(Phone2)" />
					<WTSETATTRIBUTE name="ATTR(Fax)" value="FORM(Fax)" />

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Phone1)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="ATTR(Phone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTCONDITION expr="ATTR(Fax)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="PARAM(MemberID)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
							<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
							<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(SponsorID)"/>
<!--							<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(SponsorID)"/>-->
<!--							<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(SponsorID)"/>-->
<!--							<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEF&quot;)"/>-->
							<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MEMBER-FREE)"/>
							<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
							<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="tmpMemberID" direction="return" datatype="number"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTMETHOD name="Save">
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="PARAM(AddressID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpStreet1)" value="ATTR(Street1)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="ATTR(CountryID)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="ATTR(CountryID)" oper="equal" value="CONST(&quot;0&quot;)" connector="or"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AddressID)" oper="not-equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpStreet1)" oper="equal" value="ATTR(Street1)"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpStreet1)" oper="not-equal" value="ATTR(Street1)"/>
							<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(0)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="reqAddressID" direction="return" datatype="number"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AddressID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
						<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(tmpMemberID)"/>
						<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-SHIPPING)"/>
						<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
						<WTSETATTRIBUTES/>
						<WTMETHOD name="Add">
							<WTPARAM name="reqAddressID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="CONST(tmpMemberID)">
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressID)" value="PARAM(AddressID)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Update Recurring SalesItems for payment -->
					<WTMETHOD name="UpdateRecurring">
						<WTPARAM name="OrderDate" direction="input" value="CONST(Date())"/>
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
					</WTMETHOD>
<WTCUSTOM>
				tmpPurpose = oSalesItems.Item(1).ProductName

			    Set oProduct = server.CreateObject("ptsProductUser.CProduct")
				For Each oSalesItem In oSalesItems
					With oSalesItem
						result = oProduct.UpdateInventory( .ProductID, .SalesItemID )
						If result &lt;&gt; -999999 Then 
							Reorder(.ProductName + " " + .InputValues + " (" + CStr(result) + ")" )
						End If	
					End With
				Next
			    Set oProduct = Nothing
</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpPaymentMethod)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="CONST(tmpPaymentMethod)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="ATTR(PayType)"/>
					<WTSETATTRIBUTE name="CONST(tmpDescription)" value="ATTR(Description)"/>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerType)" value="ENTITY(SalesOrder)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerID)" value="PARAM(SalesOrderID)"/>
					<WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(tmpPayType)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(PAYSTATUS-SUBMITTED)"/>
					<WTSETATTRIBUTE name="ATTR(Amount)" value="PARAM(Total)"/>
					<WTSETATTRIBUTE name="ATTR(Total)" value="PARAM(Total)"/>
					<WTSETATTRIBUTE name="ATTR(Description)" value="CONST(tmpDescription)"/>
					<WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(tmpPurpose)"/>
					<WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>

					<!-- Administrator specified no processing of this payment, mark it approved -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(PAYSTATUS-APPROVED)"/>
						<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(.Notes + &quot; NOT BILLED&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
					</WTCODEGROUP>

					<WTMETHOD name="Add">
						<WTPARAM name="PaymentID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<!-- Send New Order Notification to Company -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCUSTOM>NewOrderNotice(reqSalesOrderID)</WTCUSTOM>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="FetchCompany">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						</WTMETHOD>
						<WTMETHOD name="Load">
							<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
						<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
						<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
						<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
						<WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
						<WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
						<WTSETATTRIBUTE name="PARAM(ShipOption)" value="ATTR(Shopping)"/>
						<WTCUSTOM>If InStr(reqShipOption, "P") &gt; 0 Then reqProcessPayment = 1</WTCUSTOM>
						<WTCUSTOM>If InStr(reqShipOption, "E") &gt; 0 Then reqExistingPayments = 1</WTCUSTOM>
						<WTCUSTOM>EmailBonuses = InStr(reqShipOption, "N")</WTCUSTOM>
					</WTOBJECT>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ProcessPayment)" oper="not-equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(1)"/>
							<WTCUSTOM>
								tmpProcessor = ""
								tmpAcct = ""
								Select Case tmpPayType
								Case 1, 2, 3, 4	'Process Credit Cards
								tmpProcessor = tmpCardProcessor
								tmpAcct = tmpCardAcct
								Case 5 'Process Electronic Checks
								tmpProcessor = tmpCheckProcessor
								tmpAcct = tmpCheckAcct
								Case 11, 12, 13 'Process Wallets
								tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
								End Select
							</WTCUSTOM>
							<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, PaymentID, tmpPayType, tmpDescription, reqTotal, tmpPurpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
								<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<!-- Administrator specified no processing of this payment, do the post processing -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
								<WTMETHOD name="Custom">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
									<WTPARAM name="Status" direction="input" value="CONST(99)" />
									<WTPARAM name="EnrollDate" direction="input" value="CONST(0)" />
									<WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)" />
									<WTPARAM name="Amount" direction="input" value="CONST(0)" />
									<WTPARAM name="Result" direction="return" datatype="number" />
								</WTMETHOD>
							</WTOBJECT>
							<!-- Email Commissions -->
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(EmailBonuses)" oper="not-equal" value="CONST(0)"/>
								<WTCALLSUB name="CommissionEmail reqCompanyID, PaymentID, 0, 0, tmpTotal"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<!-- Call Custom procedure to finalize Sales Order -->
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors" />
							<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
								<WTMETHOD name="Custom">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="Status" direction="input" value="CONST(1)"/>
									<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<!-- Custom Company Activation Processing (only for Legacy Max) -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors" />
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LEGACYMAX)" connector="and"/>
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
								<WTMETHOD name="Custom">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="Status" direction="input" value="CONST(100)"/>
									<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
									<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
									<WTPARAM name="Count" direction="return" datatype="number"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors" />
						<WTCUSTOM>Response.Redirect "5254.asp?txn=1&amp;SalesOrderID=" + CStr(reqSalesOrderID)</WTCUSTOM>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTCALLSUB name="ReloadMember">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>

			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="right" />
				<WTCOLUMN width="440" align="left" />

				<WTROW>
					<WTHIDDEN value="PARAM(SalesOrderID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(AddressID)"/>
					<WTHIDDEN value="PARAM(PaymentOptions)"/>
					<WTHIDDEN value="PARAM(Total)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
					var payobj = SalesOrder.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
						var paytype=1;
						var l = payobj.length;
						if( l == null ) {
							if( payobj.checked ) {
								paytype = payobj.value
							}
						}
						else
						{
						for( i = 0; i &lt; l; i++ ) {
								if (payobj[i].checked) {
									paytype = payobj[i].value;
									i = l;
								}
							}
						}

						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						if (paytype &lt;= 5) VisibleAddress = '';
						if (paytype &gt;= 11 &amp;&amp; paytype &lt;= 13) VisibleWallet = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
						document.getElementById('WalletRows').style.display = VisibleWallet;

						CheckMethod(0);
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = SalesOrder.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>
				
				<WTFUNCTION name="CheckMethod(val)">	
					var payobj = SalesOrder.elements['PaymentMethod'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
					}
				</WTFUNCTION>

				<WTFUNCTION name="FindEmail()">
					var email = document.getElementById('MemberEmail').value;
					if( email == '' ) {
						alert('Please enter your email address.');
					}
					else {
						var url, win;
						url = "0434.asp?email=" + email + "&amp;companyid=" + document.getElementById('CompanyID').value; 
						win = window.open(url,"Email","top=100,left=100,height=300,width=340,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
						win.focus();
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatPhone(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					if( newval.length == 10 ) {
					obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
					}
					if( newval.length == 11 ) {
					obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
					}
					if( newval.length == 12 ) {
					obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>
				
				<WTROW>
					<WTSTATIC col="1" merge="2" label="Checkout" class="PageHeading" align="center" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="OrderInfoText" class="prompt" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Amount" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Amount)" bold="true" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(SalesOrder.Discount)" oper="not-equal" value="CONST('$0.00')" />
					<WTSTATIC col="1" tag="Discount" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Discount)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Tax" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Tax)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Shipping" height="18" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Shipping)" bold="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Total" height="24" />
					<WTSTATIC col="2" value="ATTR(SalesOrder.Total)" bold="true" />
				</WTROW>

				<!--*************************************************************************************-->
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(SalesOrder.MemberID)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="ExistingMember" class="PageHeading" align="center" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" tag="EnterEmail" align="center"/>
						<WTTEXT col="1" merge="2" value="PARAM(MemberEmail)" size="40" prespace="false"/>
						<WTBUTTON col="1" merge="2" action="4" value="CONST(FindMe)">
							<WTCLICK>FindEmail();</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="NotMe" class="PageHeading" align="center"/>
							<WTBUTTON col="1" merge="2" value="CONST(Clear)" prespace="false">
								<WTCLICK>document.getElementById('MemberID').value = 0; doSubmit(0,&quot;&quot;);</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>
				
				<!--*************************************************************************************-->
				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="MemberInfo" class="PageHeading" align="center" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Name" />
					<WTTEXT col="2" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" required="true" >
						<WTEXIT>if(this.value==''){alert('Oops, First Name Required!')};TitleCase(this);</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25" required="true" >
						<WTEXIT>if(this.value==''){alert('Oops, Last Name Required!')};TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Email" />
					<WTTEXT col="2" value="ATTR(Member.Email)" size="40" required="true" >
						<WTEXIT>if(this.value==''){alert('Oops, Email Required!')};</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" />
					<WTDIVIDER col="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address" bold="true"/>
					<WTTEXT col="2" value="ATTR(Address.Street1)" size="60" required="true">
						<WTEXIT>if(this.value==''){alert('Street Required!');} if( getElementById('Street12').value == ''){getElementById('Street12').value = this.value}</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Address.Street2)" size="60">
						<WTEXIT>if( getElementById('Street22').value == ''){getElementById('Street22').value = this.value}</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CityState"/>
					<WTTEXT col="2" value="ATTR(Address.City)" size="25" required="true">
						<WTEXIT>if(this.value==''){alert('City Required!');} if( getElementById('City2').value == ''){getElementById('City2').value = this.value}</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Address.State)" size="25" required="true">
						<WTEXIT>if(this.value==''){alert('State Required!');} if( getElementById('State2').value == ''){getElementById('State2').value = this.value}</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="ZipCountry" />
					<WTTEXT col="2" value="ATTR(Address.Zip)" size="10" required="true">
						<WTEXIT>if(this.value==''){alert('Zip Code Required!');} if( getElementById('Zip2').value == ''){getElementById('Zip2').value = this.value}</WTEXIT>
					</WTTEXT>
					<WTCOMBO col="2" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" required="true">
						<WTEXIT>document.getElementById('CountryID2').value = this.value;</WTEXIT>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" />
					<WTDIVIDER col="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone1" />
					<WTTEXT col="2" value="ATTR(Member.Phone1)" size="15" required="true">
						<WTEXIT>FormatPhone(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				
				<!--*************************************************************************************-->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="PaymentInfo" class="PageHeading" align="center" />
					</WTROW>
					
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPAYMENTS/PTSPAYMENT[@description!='']))" oper="not-equal" value="CONST(0)" />
						<WTROW>
							<WTSTATIC col="1" merge="2" label="UsePaymentsText" class="prompt" align="center"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
						</WTROW>
						<WTREPEAT entity="Payment">
							<WTFILTER name="DATA(Description)" oper="not-equal" value="CONST('')"/>	
							<WTROW margin-top="3">
				 				<WTRADIO col="1" group="PaymentMethod" name="&lt;xsl:value-of select=&quot;@paymentid&quot;/&gt;" check="first"/>
								<WTIMAGE col="1" value="CONST(PayType&lt;xsl:value-of select=&quot;@paytype&quot;/&gt;.gif)" imgalign="absmiddle" prespace="false">
									<WTCLICK escape="false">CheckMethod(&lt;xsl:value-of select=&quot;@paymentid&quot;/&gt;);</WTCLICK>
								</WTIMAGE>
								<WTSTATIC col="2" space="1"/>
								<WTSTATIC col="2" value="DATA(Payment.Description)" valign="center" fontsize="2" bold="true"/>
							</WTROW>
						</WTREPEAT>
						<WTROW margin-top="3">
				 			<WTRADIO col="1" group="PaymentMethod" name="0"/>
							<WTIMAGE col="1" value="CONST(PayType0.gif)" imgalign="absmiddle" prespace="false">
								<WTCLICK>CheckMethod(0);</WTCLICK>
							</WTIMAGE>
							<WTSTATIC col="2" space="1"/>
							<WTSTATIC col="2" label="NewPayment" bold="true" fontsize="2"/>
						</WTROW>						
						<WTROW margin-top="6" margin-bottom="18">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-bottom="6">
				 		<WTSTATIC col="1" merge="2" align="center">
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentVisa"/>
				 				<WTRADIO group="PayType" name="1" check="/DATA/TXN/PTSBILLING/@paytype=1">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(1);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentMC"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="2" check="/DATA/TXN/PTSBILLING/@paytype=2">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(2);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentDiscover"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="3" check="/DATA/TXN/PTSBILLING/@paytype=3">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(3);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentAmex"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="4" check="/DATA/TXN/PTSBILLING/@paytype=4">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(4);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentCheck"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(5);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentWallet"/>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPaymentiPayout"/>
									<WTSTATIC space="3"/>
									<WTRADIO group="PayType" name="11" check="/DATA/TXN/PTSBILLING/@paytype=11">
										<WTCLICK>ToggleType();</WTCLICK>
									</WTRADIO>
									<WTIMAGE value="CONST(PayType11.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(11);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPaymentPayQuicker"/>
									<WTSTATIC space="3"/>
									<WTRADIO group="PayType" name="12" check="/DATA/TXN/PTSBILLING/@paytype=12">
										<WTCLICK>ToggleType();</WTCLICK>
									</WTRADIO>
									<WTIMAGE value="CONST(PayType12.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(12);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPaymentSolidTrust"/>
									<WTSTATIC space="3"/>
									<WTRADIO group="PayType" name="13" check="/DATA/TXN/PTSBILLING/@paytype=13">
										<WTCLICK>ToggleType();</WTCLICK>
									</WTRADIO>
									<WTIMAGE value="CONST(PayType13.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(13);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(CashPayment)" oper="not-equal" value="CONST(0)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPaymentCash"/>
									<WTSTATIC space="3"/>
									<WTRADIO group="PayType" name="7" check="/DATA/TXN/PTSBILLING/@paytype=7">
										<WTCLICK>ToggleType();</WTCLICK>
									</WTRADIO>
									<WTIMAGE value="CONST(PayType7.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(7);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPaymentPO"/>
									<WTSTATIC space="3"/>
									<WTRADIO group="PayType" name="8" check="/DATA/TXN/PTSBILLING/@paytype=8">
										<WTCLICK>ToggleType();</WTCLICK>
									</WTRADIO>
									<WTIMAGE value="CONST(PayType8.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(8);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTCODEGROUP>
				 		</WTSTATIC>
					</WTROW>

					<WTROW id="WalletRows">
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="WalletName"/>
								<WTTEXT col="2" value="PARAM(Wallet)" required="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW id="CardRows">
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="200" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
									<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardDate"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
									<WTOPTION id="" label="Select"/>
									<WTOPTION id="1" label="January"/>
									<WTOPTION id="2" label="February"/>
									<WTOPTION id="3" label="March"/>
									<WTOPTION id="4" label="April"/>
									<WTOPTION id="5" label="May"/>
									<WTOPTION id="6" label="June"/>
									<WTOPTION id="7" label="July"/>
									<WTOPTION id="8" label="August"/>
									<WTOPTION id="9" label="September"/>
									<WTOPTION id="10" label="October"/>
									<WTOPTION id="11" label="November"/>
									<WTOPTION id="12" label="December"/>
								</WTCOMBO>
								<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false">
									<WTOPTION id="" label="Select"/>
									<WTOPTION id="13" label="2013"/>
									<WTOPTION id="14" label="2014"/>
									<WTOPTION id="15" label="2015"/>
									<WTOPTION id="16" label="2016"/>
									<WTOPTION id="17" label="2017"/>
									<WTOPTION id="18" label="2018"/>
									<WTOPTION id="19" label="2019"/>
									<WTOPTION id="20" label="2020"/>
									<WTOPTION id="21" label="2021"/>
									<WTOPTION id="22" label="2022"/>
									<WTOPTION id="23" label="2023"/>
									<WTOPTION id="24" label="2024"/>
									<WTOPTION id="25" label="2025"/>
								</WTCOMBO>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardName"/>
								<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardCode"/>
								<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
									<WTEXIT>FormatCardCode(this);</WTEXIT>
								</WTTEXT>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTTOOLTIP>
											<WTIMAGE value="CONST(SymbolHelp.gif)"/>
											<WTTIP>
												<WTIMAGE value="CONST(SecurityCode.png)"/>
											</WTTIP>
										</WTTOOLTIP>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Address2" bold="true"/>
								<WTTEXT col="2" value="PARAM(Street12)" size="40" required="true">
									<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTTEXT col="2" value="PARAM(Street22)" size="60"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CityState"/>
								<WTTEXT col="2" value="PARAM(City2)" size="27" required="true">
									<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
								</WTTEXT>
								<WTTEXT col="2" value="PARAM(State2)" size="27" required="true">
									<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="ZipCountry"/>
								<WTTEXT col="2" value="PARAM(Zip2)" width="100" label="Zip" size="8" align="left" required="true">
									<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
								</WTTEXT>
								<WTCOMBO col="2" value="PARAM(CountryID2)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW id="CheckRows">
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="200" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckBank"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckRoute"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTTOOLTIP>
											<WTIMAGE value="CONST(SymbolHelp.gif)"/>
											<WTTIP>
												<WTIMAGE value="CONST(checkref.gif)"/>
											</WTTIP>
										</WTTOOLTIP>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckAccount"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTTOOLTIP>
											<WTIMAGE value="CONST(SymbolHelp.gif)"/>
											<WTTIP>
												<WTIMAGE value="CONST(checkref.gif)"/>
											</WTTIP>
										</WTTOOLTIP>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckName"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12">
						<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
					</WTROW>
<!--
					<WTROW margin-top="12">
						<WTCONDITION expr="IsEmployee"/>
						<WTCHECK col="1" merge="2" value="PARAM(ProcessPayment)" align="center"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="NotEmployee"/>
						<WTHIDDEN value="PARAM(ProcessPayment)"/>
					</WTROW>
-->
					<WTROW>
						<WTHIDDEN value="PARAM(ProcessPayment)"/>
					</WTROW>

				</WTCODEGROUP>

				<!--*************************************************************************************-->
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="NoBillText" class="PageHeading" align="center" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="PARAM(NoBill)" label="NoBill"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="24">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Purchase)" align="center">
						<WTCLICK>doSubmit(1,&quot;&quot;); this.disabled = true</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<!-- Sales Order / Member Enrollment Confirmation / Fulfillment Page                                                 -->
		<!--=============================================================================================-->
		<WTWEBPAGE name="5254" caption="Order Confirmation" top="true" navbar="false" footer="false" 
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="5254">
			<WTPARAM name="SalesOrderID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="Txn" datatype="number" />
			<WTPARAM name="Member" datatype="number" />
			<WTPARAM name="AutoShip" datatype="number" />	<!-- create auto ship after new member creation -->

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Member)" oper="equal" value="CONST(0)" connector="and"/>
					<WTRETURN>
						<WTLINK name="5251" return="false">
							<WTPARAM name="ShoppingCartID" value="PARAM(SalesOrderID)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="not-equal" value="CONST(0)"/>
					<WTSETCACHE name="CONST(SHOPPINGCART)" value="CONST(&quot;&quot;)"/>
					<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
						<WTMETHOD name="Load">
							<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(SalesOrder.Status)" value="SYSCON(STATUS-SUBMITTED)" />
						<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
						<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)" />
						<WTSETATTRIBUTE name="CONST(tmpPromotionID)" value="ATTR(PromotionID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTMETHOD name="ProductFulfillment">
							<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
							<WTPARAM name="Fulfill" direction="input" value="SYSCON(FULFILL-COURSE)" />
							<WTPARAM name="tmpCourses" direction="return" datatype="text" />
						</WTMETHOD>
						<WTMETHOD name="ProductFulfillment">
							<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
							<WTPARAM name="Fulfill" direction="input" value="SYSCON(FULFILL-ASSESSMENT)" />
							<WTPARAM name="tmpAssessments" direction="return" datatype="text" />
						</WTMETHOD>
						<WTMETHOD name="ProductFulfillment">
							<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
							<WTPARAM name="Fulfill" direction="input" value="SYSCON(FULFILL-DOWNLOAD)" />
							<WTPARAM name="tmpDownloads" direction="return" datatype="text" />
						</WTMETHOD>
						<WTMETHOD name="ProductFulfillment">
							<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
							<WTPARAM name="Fulfill" direction="input" value="SYSCON(FULFILL-CUSTOM)" />
							<WTPARAM name="tmpCustoms" direction="return" datatype="text" />
						</WTMETHOD>
					</WTOBJECT>

					<WTOBJECT name="Promotion" project="ptsPromotionUser" class="CPromotion">
						<WTCONDITION expr="CONST(tmpPromotionID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="GetUsed">
							<WTPARAM name="PromotionID" direction="input" value="CONST(tmpPromotionID)"/>
							<WTPARAM name="Result" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>

					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpAuthUserID)" value="ATTR(AuthUserID)"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberNameLast)" value="ATTR(NameLast)"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberNameFirst)" value="ATTR(NameFirst)"/>
						<WTSETATTRIBUTE name="CONST(tmpEnrollDate)" value="ATTR(EnrollDate)"/>
					</WTOBJECT>
<WTCUSTOM>
			'Send Email Confirmation and logon for new members (enrolled within last 2 minutes)
			Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
			If oHTTP Is Nothing Then
				Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
			Else
				tmpServer = "http://" + reqSysServerName + reqSysServerPath
				URL = tmpServer + "5215.asp?SalesOrderID=" + CStr(reqSalesOrderID)
				oHTTP.open "GET", URL
				oHTTP.send

				'new member enrolled within last 2 minutes
				If DateDiff("n", tmpEnrollDate, Now()) &lt; 2 Then
					URL = tmpServer + "0105.asp?AuthUserID=" &amp; tmpAuthUserID
					oHTTP.open "GET", URL
					oHTTP.send
				End If
			End If
			Set oHTTP = Nothing
			
			'Register Courses for purchased products
			If tmpCourses &lt;&gt; "" Then
				Set oSession = server.CreateObject("ptsSessionUser.CSession")
				With oSession
					.SysCurrentLanguage = reqSysLanguage
					.Load 0, CLng(reqSysUserID)
					.MemberID = reqMemberID
					.Status = 1
					.CommStatus = 1
					.RegisterDate = reqSysDate
					.NameLast = tmpMemberNameLast
					.NameFirst = tmpMemberNameFirst
				End With

				aCourses = split(tmpCourses, ",")
				total = UBOUND(aCourses)
				For x = 0 to total
					courseid = aCourses(x)
					If courseid &lt;&gt; "" Then
						With oSession
							.CourseID = courseid
							.Add(CLng(reqSysUserID))
						End With
					End If
				Next
				Set oSession = Nothing
			End If

			'Register Assessments for purchased products
			If tmpAssessments &lt;&gt; "" Then
				Set oMemberAssess = server.CreateObject("ptsMemberAssessUser.CMemberAssess")
				With oMemberAssess
					.SysCurrentLanguage = reqSysLanguage
					.Load 0, CLng(reqSysUserID)
					.MemberID = reqMemberID
					.StartDate = Now
					.CommStatus = 1
				End With

				aAssessments = split(tmpAssessments, ",")
				total = UBOUND(aAssessments)
				For x = 0 to total
					assessid = aAssessments(x)
					If assessid &lt;&gt; "" Then
						With oMemberAssess
							.AssessmentID = assessid
							.Add(CLng(reqSysUserID))
						End With
					End If
				Next
				Set oMemberAssess = Nothing
			End If

			'Email downloads for purchased products
			If tmpDownloads &lt;&gt; "" Then
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					tmpServer = "http://" + reqSysServerName + reqSysServerPath
					aDownloads = split(tmpDownloads, ",")
					total = UBOUND(aDownloads)
					For x = 0 to total
						tmpDownload = aDownloads(x)
						URL = tmpServer + "5217.asp?MemberID=" + CStr(reqMemberID) + "&amp;download=" + Replace(tmpDownload, "&amp;", "%26")
						oHTTP.open "GET", URL
						oHTTP.send
					Next
				End If
				Set oHTTP = Nothing
			End If

			'process custom fulfillment for purchased products
			If tmpCustoms &lt;&gt; "" Then
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					aCustoms = split(tmpCustoms, ",")
					total = UBOUND(aCustoms)
					For x = 0 to total
						tmpCustom = aCustoms(x)
						If InStr(tmpCustom, "?") = 0 Then 
							tmpCustom = tmpCustom + "?"
						Else
							tmpCustom = tmpCustom + "&amp;"
						End If
						URL = tmpCustom + "MemberID=" + CStr(reqMemberID)
						oHTTP.open "GET", URL
						oHTTP.send
					Next
				End If
				Set oHTTP = Nothing
			End If
</WTCUSTOM>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="AutoShip" type="Update">
				<WTRETURN>
					<WTLINK name="5250" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="N" value="CONST(1)"/>
						<WTPARAM name="A" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--*************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="right" />

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Member)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="CheckoutSuccess"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="CheckEmail"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" action="3" value="CONST(NewOrder)" align="center">
							<WTCONDITION expr="IsEmployee"/>
						</WTBUTTON>
						<WTBUTTON col="1" value="CONST(CloseShoppingCart)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Member)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="EnrollSuccess"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="EnrollEmail"/>
						</WTSTATIC>
					</WTROW>
					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AutoShip)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="24" margin-bottom="24">
							<WTSTATIC col="1" class="PageHeading" align="center">
								<WTSTATIC label="AutoShipText"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="24">
							<WTBUTTON col="1" action="3" value="CONST(CreateAutoShip)" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="5222" caption="Add Sales Order" navbar="false" worker="true" aspstyle="GenerateWebASP.xsl"> 
		<!--==================================================================-->
			<WTPARAM name="CO" datatype="number"/>
			<WTPARAM name="RE" datatype="text"/>
			<WTPARAM name="ON" datatype="text"/>
			<WTPARAM name="SD" datatype="text"/>
			<WTPARAM name="SM" datatype="number"/>
			<WTPARAM name="AS" datatype="number"/>
			<WTPARAM name="TP" datatype="currency"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
		If reqCO = 0 Then
			response.write "0 - Missing Company"
			response.end
		End If
		If reqRE = "" Then
			response.write "0 - Missing Reference Number"
			response.end
		End If
		If reqSD = "" Then reqSD = Now()
		If reqSM = 0 Then reqSM = 1
</WTCUSTOM>					
				<!-- lookup reference member number -->
				<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(RE)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTMETHOD name="FetchRef">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CO)"/>
						<WTPARAM name="Reference" direction="input" value="PARAM(RE)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
					response.write "0 - Invalid Member Reference Number"
					response.end
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	

				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CO)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="CONST(tmpMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(OrderDate)" value="PARAM(SD)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(STATUS-COMPLETE)" />
					<WTSETATTRIBUTE name="ATTR(Ship)" value="PARAM(SM)"/>
					<WTSETATTRIBUTE name="ATTR(Total)" value="PARAM(TP)"/>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;D#&quot; + reqRE + &quot; O#&quot; + reqON)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AS)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(AutoShip)" value="SYSCON(AUTOSHIP-ORDER)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTPARAM name="SalesOrderID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
					If Len(xmlError) = 0 Then
						response.write SalesOrderID
					Else
						response.write "0 - " + xmlError
					End If	
					response.end
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="5223" caption="Update Order Status" navbar="false" worker="true" aspstyle="GenerateWebASP.xsl"> 
		<!--==================================================================-->
			<WTPARAM name="SO" datatype="number"/>
			<WTPARAM name="ST" datatype="number"/>
			<WTPARAM name="TR" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
		If reqSO = 0 Then
			response.write "0 - Missing Sales Order #"
			response.end
		End If
		If reqST &lt; 0 OR reqStatus &gt; 5 Then
			response.write "0 - Invalid Status"
			response.end
		End If
</WTCUSTOM>					
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SO)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="PARAM(ST)">
							<WTCONDITION expr="PARAM(ST)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
<WTCUSTOM>
					If reqTR &lt;&gt; "" Then
						tmpTrack = .Track
						If tmpTrack &lt;&gt; "" Then .Track = tmpTrack + " "
						.Track = tmpTrack + reqTR
					End If	
</WTCUSTOM>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
					</WTCODEGROUP>
<WTCUSTOM>
				If .MemberID = "" Then
					response.write "0 - Invalid Sales Order #"
					response.end
				End If	
				
				If Len(xmlError) = 0 Then
					response.write .SalesOrderID
				Else
					response.write "0 - " + xmlError
				End If	
				response.end
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="5224" caption="Finalize Sales Order" navbar="false" worker="true" aspstyle="GenerateWebASP.xsl"> 
		<!--==================================================================-->
			<WTPARAM name="SO" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
		If reqSO = 0 Then
			response.write "0 - Missing Sales Order"
			response.end
		End If
</WTCUSTOM>					
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(1)"/>
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SO)"/>
					</WTMETHOD>
<WTCUSTOM>
					If Len(xmlError) = 0 Then
						response.write reqSO
					Else
						response.write "0 - " + xmlError
					End If	
					response.end
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

    <!--=============================================================================================-->
    <WTWEBPAGE name="5225" caption="Update Tracking" action="false" footer="false" navbar="false" wrapper="wrapper600" secured="61" langfile="5225"
		submit="5225Upload.asp" type="multi" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
      <!--=============================================================================================-->
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="UploadError" datatype="number"/>
      <WTPARAM name="UploadErrorDesc" datatype="text"/>
      <WTPARAM name="Orders" datatype="number"/>

      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
        <WTCUSTOM>
          DoError reqUploadError, "Upload", reqUploadErrorDesc
        </WTCUSTOM>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(Orders)" oper="equal" value="CONST(-1)"/>
        <WTCUSTOM>
          DoError reqUploadError, "Import", "No Order Tracking #s Updated!"
        </WTCUSTOM>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(Orders)" oper="greater" value="CONST(0)"/>
        <WTCUSTOM>
          DoError reqUploadError, "Import", reqOrders &amp; " Order Tracking #s Successfully Updated!"
        </WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
        <WTSETCACHE name="COMPANYID" value="PARAM(CompanyID)"/>
      </WTACTION>

      <!--*******************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="600" align="left"/>

        <WTROW>
          <WTSTATIC col="1" label="UploadOrders" class="PageHeading"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="UploadOrdersText" class="prompt"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="UploadOrdersFormat" class="prompt"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="UploadOrdersExample" class="prompt"/>
        </WTROW>
        <WTROW margin-bottom="24">
          <WTDIVIDER col="1" height="1" color="SYS(divider)"/>
        </WTROW>

        <WTROW margin-bottom="24">
          <WTFILE col="1" value="upload" align="center" size="40"/>
          <WTBUTTON col="1" align="center" default="true" action="1" value="CONST(Submit)"/>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>


  </WTWEBPAGES>
</WTROOT>