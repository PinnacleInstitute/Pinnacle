<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="41" name="SurveyQuestion" alias="sq" language="false" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="4101" name="SurveyQuestionID" type="number" identity="true" min="1" required="true" title="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="4102" name="SurveyID" type="number" source="entity" parent="true"/>
		
		<!--Foreign Table Fields-->

		<!--Attributes-->
		<WTATTRIBUTE id="4105" name="Question" type="text" length="1000" min="1" max="1000" source="entity"/>
		<WTATTRIBUTE id="4106" name="Seq" type="number" source="entity" seq="10"/>
		<WTATTRIBUTE id="4107" name="IsText" type="yesno" source="entity"/>
		<WTATTRIBUTE id="4108" name="Total" type="number" source="entity"/>
		<WTATTRIBUTE id="4109" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Active"/>
			<WTENUM id="2" name="Inactive"/>
		</WTATTRIBUTE>
		
		<!--Indexes-->
		<WTINDEX name="SurveyID">
			<WTATTRIBUTE name="SurveyID"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="SurveyQuestion" entity="SurveyQuestion" alias="sq"/>
			<WTRELATIONSHIP name="Common" entity="SurveyQuestion" alias="sq"/>
		</WTRELATIONSHIPS>

		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="QUESTION-ACTIVE" value="1"/>
			<WTSYSCON name="QUESTION-INACTIVE" value="2"/>
			<WTSYSCON name="SURVEY-ACTIVE" value="1"/>
			<WTSYSCON name="SURVEY-NOTACTIVE" value="99"/>
		</WTSYSCONS>

	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--==================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<!--==================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListSurveyAll" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SurveyID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.SurveyQuestionID)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.SurveyID)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.Question)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.Seq)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.IsText)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.Status)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.Total)"/>
					<WTJOIN name="SurveyQuestion"/>
					<WTCONDITION expr="ATTR(SurveyQuestion.SurveyID)" oper="equal" value="PARAM(SurveyID)"/>
					<WTORDER name="ATTR(SurveyQuestion.Seq)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListSurvey" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(SurveyID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.SurveyQuestionID)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.SurveyID)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.Question)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.Seq)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.IsText)"/>
					<WTATTRIBUTE value="ATTR(SurveyQuestion.Total)"/>
					<WTJOIN name="SurveyQuestion"/>
					<WTCONDITION expr="ATTR(SurveyQuestion.SurveyID)" oper="equal" value="PARAM(SurveyID)"/>
					<WTCONDITION expr="ATTR(SurveyQuestion.Status)" oper="less-equal" value="CONST(1)" connector="and"/>
					<WTORDER name="ATTR(SurveyQuestion.Seq)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--===============================================================================-->
		<WTWEBPAGE name="4102" caption="SurveyQuestion" contentpage="true" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="61">
		<!--===============================================================================-->
			<WTPARAM name="SurveyID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="SurveyQuestion" project="ptsSurveyQuestionUser" class="CSurveyQuestion">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyQuestionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(SurveyID)" value="PARAM(SurveyID)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestion" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION name="Add" type="Add" id="1">
				<WTOBJECT name="SurveyQuestion" project="ptsSurveyQuestionUser" class="CSurveyQuestion">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyQuestionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(SurveyID)" value="PARAM(SurveyID)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="SurveyQuestionID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSurveyQuestionID)" value="ATTR(SurveyQuestion.SurveyQuestionID)"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSurveyQuestions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTOBJECT name="SurveyChoice" project="ptsSurveyChoiceUser" class="CSurveyChoice">
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="ATTR(SurveyQuestionID)" value="CONST(tmpSurveyQuestionID)"/>
<WTCUSTOM>
			For x = 1 To 5
				s = trim(Request.Form.Item("Choice" &amp; x))
				If s &lt;&gt; "" Then
					.Choice = s
					.Seq = x * 10
					SurveyChoiceID = CLng(.Add(CLng(reqSysUserID)))
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
				End If
			Next
</WTCUSTOM>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="SurveyQuestion" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="NewSurveyQuestionText" align="left" class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" tag="Question" valign="top"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="2" value="ATTR(SurveyQuestion.Question)" rows="4" cols="72" focus="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Seq"/>
					<WTTEXT col="2" value="ATTR(SurveyQuestion.Seq)" size="2"/>
					<WTCHECK col="2" value="ATTR(SurveyQuestion.IsText)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="ChoiceText" align="left" class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Choice1"/>
					<WTTEXT col="2" name="Choice1" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Choice2"/>
					<WTTEXT col="2" name="Choice2" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Choice3"/>
					<WTTEXT col="2" name="Choice3" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Choice4"/>
					<WTTEXT col="2" name="Choice4" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Choice5"/>
					<WTTEXT col="2" name="Choice5" size="60"/>
				</WTROW>
			
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Add)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="4103" caption="SurveyQuestion" contentpage="true" 
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="61">
		<!--===============================================================================-->
			<WTPARAM name="SurveyQuestionID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="SurveyQuestion" project="ptsSurveyQuestionUser" class="CSurveyQuestion">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyQuestionID" direction="input" value="PARAM(SurveyQuestionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestion" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="SurveyQuestion" project="ptsSurveyQuestionUser" class="CSurveyQuestion">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyQuestionID" direction="input" value="PARAM(SurveyQuestionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSurveyQuestions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="SurveyQuestion" project="ptsSurveyQuestionUser" class="CSurveyQuestion">
					<WTMETHOD name="Delete">
						<WTPARAM name="SurveyQuestionID" direction="input" value="PARAM(SurveyQuestionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyQuestion" project="ptsSurveyQuestionUser" class="CSurveyQuestion">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyQuestionID" direction="input" value="PARAM(SurveyQuestionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestion" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="SurveyQuestion" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="EditSurveyQuestionText" align="left" class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" tag="Question" valign="top"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="2" value="ATTR(SurveyQuestion.Question)" rows="4" cols="72"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Seq"/>
					<WTTEXT col="2" value="ATTR(SurveyQuestion.Seq)" size="2"/>
					<WTCHECK col="2" value="ATTR(SurveyQuestion.IsText)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Status"/>
					<WTCOMBO col="2" value="ATTR(SurveyQuestion.Status)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Total"/>
					<WTSTATIC col="2" value="ATTR(SurveyQuestion.Total)"/>
				</WTROW>
			
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="4111" caption="Survey" focus="false" contentpage="true" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="61">
		<!--===============================================================================-->
			<WTPARAM name="SurveyID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>

			<WTSUB name="LoadSurvey">
				<WTOBJECT name="Survey" project="ptsSurveyUser" class="CSurvey">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurvey" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyQuestions" project="ptsSurveyQuestionUser" class="CSurveyQuestions">
					<WTMETHOD name="ListSurveyAll">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyChoices" project="ptsSurveyChoiceUser" class="CSurveyChoices">
					<WTMETHOD name="ListSurveyAll">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyChoices" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="LoadSurvey"/>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="20" align="left"/>
				<WTCOLUMN width="580" align="left"/>

				<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="450" align="left"/>
						<WTCOLUMN width="150" align="right"/>
						<WTROW>
							<WTCONDITION expr="ATTR(Survey.Status)" oper="equal" value="CONST(3)"/>
							<WTSTATIC col="1" tag="Survey" value="ATTR(Survey.SurveyName)" class="PageHeading"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="ATTR(Survey.Status)" oper="not-equal" value="CONST(3)"/>
							<WTSTATIC col="1" tag="Survey" value="ATTR(Survey.SurveyName)" class="PageHeading"/>
							<WTLINKGROUP  col="2" align="right" >
								<WTLINK name="4102" label="NewSurveyQuestion" class="PageHeadingLink">
									<WTPARAM name="SurveyID" value="PARAM(SurveyID)"/>
									<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
								</WTLINK>
							</WTLINKGROUP>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoQuestions" class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION))" oper="greater" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="SurveyHelpEmployee" class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTREPEAT xpath="/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION">
						<WTROW>
							<WTSTATIC col="1" merge="2">
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;.)"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(redchecksm.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(SurveyQuestion.Status)" oper="equal" value="SYSCON(QUESTION-INACTIVE)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(SurveyQuestion.Question)" space="2">
<!--									<WTCONDITION expr="DATA(Total)" oper="equal" value="CONST(0)"/> -->
									<WTLINK name="4103">
										<WTPARAM name="SurveyQuestionID" value="DATA(SurveyQuestion.SurveyQuestionID)"/>
										<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
									</WTLINK>
								</WTSTATIC>
<!--								
								<WTSTATIC value="DATA(SurveyQuestion.Question)" space="2">
									<WTCONDITION expr="DATA(Total)" oper="greater" value="CONST(0)"/>
								</WTSTATIC>
-->
								<WTCODEGROUP>
<!--									<WTCONDITION expr="DATA(Total)" oper="equal" value="CONST(0)"/> -->
									<WTSTATIC value="CONST( ()"/>
									<WTSTATIC value="CONST(add choice)">
										<WTLINK name="4202">
											<WTPARAM name="SurveyQuestionID" value="DATA(SurveyQuestion.SurveyQuestionID)"/>
											<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="CONST())"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
<!--									<WTCONDITION expr="DATA(Total)" oper="greater" value="CONST(0)"/> -->
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(IsText)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="CONST( ()"/>
										<WTSTATIC value="CONST(view comments)">
											<WTLINK name="4113" target="comments">
												<WTPARAM name="SurveyQuestionID" value="DATA(SurveyQuestion.SurveyQuestionID)"/>
											</WTLINK>
										</WTSTATIC>
										<WTSTATIC value="CONST())"/>
									</WTCODEGROUP>
									<WTSTATIC value="CONST( ( &lt;xsl:value-of select=&quot;@total&quot;/&gt; ))" bold="true"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTVARIABLE name="tmpTotal" value="DATA(Total)"/>
						<WTROW>
							<WTREPEAT xpath="/DATA/TXN/PTSSURVEYCHOICES/PTSSURVEYCHOICE[(@surveyquestionid = current()/@surveyquestionid)]">
								<WTROW>
									<WTSTATIC col="1"/>
<!--									<WTRADIO col="2" group="&lt;xsl:value-of select=&quot;@surveyquestionid&quot;/&gt;" name="&lt;xsl:value-of select=&quot;@surveyquestionid&quot;/&gt;"/> -->
									<WTSTATIC col="2" value="CONST( - )"/>
									<WTSTATIC col="2" value="DATA(Choice)">
<!--										<WTCONDITION expr="CONST($tmpTotal)" oper="equal" value="CONST(0)"/> -->
										<WTLINK name="4203">
											<WTPARAM name="SurveyChoiceID" value="DATA(SurveyChoiceID)"/>
											<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
										</WTLINK>
									</WTSTATIC>
<!--									
									<WTSTATIC col="2" value="DATA(Choice)">
										<WTCONDITION expr="CONST($tmpTotal)" oper="greater" value="CONST(0)"/> 
									</WTSTATIC>
-->
									<WTSTATIC col="2">
										<WTCONDITION expr="CONST($tmpTotal)" oper="greater" value="CONST(0)"/> 
										<WTSTATIC value="CONST(( &lt;xsl:value-of select=&quot;@total&quot;/&gt; - &lt;xsl:value-of select=&quot;format-number(@total div $tmpTotal, '#0.0%')&quot;/&gt; ))" bold="true"/>
									</WTSTATIC>
								</WTROW>
							</WTREPEAT>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(IsText)" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="DATA(Total)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSTATIC col="1"/>
							<WTMEMO col="2" value="CONST('')" rows="2" cols="68"/>
						</WTROW>

						<WTROW margin-bottom="12"/>				

					</WTREPEAT>

				</WTROW>				
				
				<WTROW margin-top="12" margin-bottom="12">				
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="4112" caption="Survey Questions" focus="false" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0">
		<!--===============================================================================-->
			<WTPARAM name="SurveyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>

			<WTINCLUDE name="Company.asp"/>

			<WTSUB name="LoadSurvey">
				<WTOBJECT name="Survey" project="ptsSurveyUser" class="CSurvey">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(SURVEY-NOTACTIVE)">
						<WTCONDITION expr="ATTR(Status)" oper="not-equal" value="SYSCON(SURVEY-ACTIVE)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
						<WTCALLSUB name="GetCompany(.CompanyID)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurvey" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyQuestions" project="ptsSurveyQuestionUser" class="CSurveyQuestions">
					<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="SYSCON(SURVEY-NOTACTIVE)"/>
					<WTMETHOD name="ListSurvey">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyChoices" project="ptsSurveyChoiceUser" class="CSurveyChoices">
					<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="SYSCON(SURVEY-NOTACTIVE)"/>
					<WTMETHOD name="ListSurvey">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyChoices" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyAnswers" project="ptsSurveyAnswerUser" class="CSurveyAnswers">
					<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="SYSCON(SURVEY-NOTACTIVE)"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)" connector="and"/>
					<WTMETHOD name="ListSurvey">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyAnswers" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="SaveSurvey">
				<WTOBJECT name="SurveyQuestions" project="ptsSurveyQuestionUser" class="CSurveyQuestions">
					<WTMETHOD name="ListSurvey">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestions" direction="return" datatype="text"/>
					</WTMETHOD>
<WTCUSTOM>
				Set oSurveyAnswer = server.CreateObject("ptsSurveyAnswerUser.CSurveyAnswer")
				If oSurveyAnswer Is Nothing Then
				   DoError Err.Number, Err.Source, "Unable to Create Object - ptsSurveyAnswerUser.CSurveyAnswer"
				Else
					With oSurveyAnswer
					   .SysCurrentLanguage = reqSysLanguage
					   .MemberID = reqSysMemberID
					   .AnswerDate = Now()
					End With
				End If

				If reqMemberID &gt; 0 Then
					Set oSurveyAnswers = server.CreateObject("ptsSurveyAnswerUser.CSurveyAnswers")
					If oSurveyAnswers Is Nothing Then
						DoError Err.Number, Err.Source, "Unable to Create Object - ptsSurveyAnswerUser.CSurveyAnswers"
					Else
						With oSurveyAnswers
							.SysCurrentLanguage = reqSysLanguage
							.ListSurvey reqSurveyID, reqMemberID, CLng(reqSysUserID)
							If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
						End With
					End If
				End If

				For Each oSurveyQuestion in oSurveyQuestions
					tmpQuestionID = oSurveyQuestion.SurveyQuestionID
					tmpIsText = oSurveyQuestion.IsText
					tmpID = Request.Form.Item(tmpQuestionID)

					'Check if the Question has already been Answered
					tmpSurveyAnswerID = 0
					If reqMemberID &gt; 0 Then
						For Each oAnswer in oSurveyAnswers
							If oAnswer.SurveyQuestionID = tmpQuestionID Then
								tmpSurveyAnswerID = oAnswer.SurveyAnswerID
								Exit For
							End If
						Next
					End If

					With oSurveyAnswer
						.SurveyQuestionID = tmpQuestionID
					   .SurveyChoiceID = tmpID
						.Answer = Request.Form.Item("T" &amp; tmpQuestionID)

						If tmpSurveyAnswerID > 0 Then
				         .SurveyAnswerID = tmpSurveyAnswerID
				         .Save reqSysUserID
						Else
						   SurveyAnswerID = CLng(.Add( reqSysUserID ))
						End If
					   If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
					End With
				Next
				Set oSurveyAnswer = Nothing
				Set oSurveyAnswers = Nothing
</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadSurvey"/>
			</WTACTION>
			
			<WTACTION id="2" name="Update" type="Update">
				<WTCALLSUB name="SaveSurvey"/>
				<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)"/>
				<WTRETURN>
					<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="15" align="left"/>
				<WTCOLUMN width="585" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(SURVEY-NOTACTIVE)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1" merge="2" label="SurveyInactive" align="center" class="PageHeading" fontcolor="red" fontsize="4"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="24">
						<WTSTATIC col="1" merge="2" value="ATTR(Survey.SurveyName)" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" merge="2" label="Congrats" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>

					<WTROW>
						<WTSTATIC col="1" merge="2" tag="Survey" value="ATTR(Survey.SurveyName)" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION))" oper="equal" value="CONST(0)"/>
						<WTSTATIC col="1" merge="2" label="NoQuestions" class="Prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION))" oper="greater" value="CONST(0)"/>
						<WTSTATIC col="1" merge="2" label="SurveyHelp" class="Prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" value="ATTR(Survey.Description)"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					
					<WTROW margin-bottom="6">
						<WTREPEAT xpath="/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION[position()]">
							<WTROW>
								<WTSTATIC col="1" merge="2">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;.)"/>

									<WTSTATIC value="DATA(SurveyQuestion.Question)"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTREPEAT xpath="/DATA/TXN/PTSSURVEYCHOICES/PTSSURVEYCHOICE[(@surveyquestionid = current()/@surveyquestionid)]">
									<WTROW>
										<WTSTATIC col="1"/>
										<WTRADIO col="2" group="&lt;xsl:value-of select=&quot;@surveyquestionid&quot;/&gt;" name="&lt;xsl:value-of select=&quot;@surveychoiceid&quot;/&gt;" 
											datapathx="/DATA/TXN/PTSSURVEYANSWERS/PTSSURVEYANSWER[@surveychoiceid=current()/@surveychoiceid]"/>
										<WTSTATIC col="2" value="DATA(Choice)"/>
									</WTROW>
								</WTREPEAT>
							</WTROW>
							<WTROW>
								<WTCONDITION expr="DATA(IsText)" oper="not-equal" value="CONST(0)"/>
								<WTSTATIC col="1"/>
								<WTMEMO col="2" name="T&lt;xsl:value-of select=&quot;@surveyquestionid&quot;/&gt;" rows="4" cols="68"
										value="CONST(/DATA/TXN/PTSSURVEYANSWERS/PTSSURVEYANSWER[@surveyquestionid=current()/@surveyquestionid]/@answer)"/>
							</WTROW>
							<WTROW margin-bottom="12"/>
						</WTREPEAT>
					</WTROW>
					
					<WTROW margin-top="12" margin-bottom="12">				
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Submit)" align="center"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center">
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="4113" caption="Surveys Comments" navbar="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="SurveyQuestionID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="SurveyQuestion" project="ptsSurveyQuestionUser" class="CSurveyQuestion">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyQuestionID" direction="input" value="PARAM(SurveyQuestionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestion" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyAnswers" project="ptsSurveyAnswerUser" class="CSurveyAnswers">
					<WTMETHOD name="ListComments">
						<WTPARAM name="SurveyQuestionID" direction="input" value="PARAM(SurveyQuestionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyAnswers" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTSTATIC col="1" tag="SurveyQuestion" value="ATTR(SurveyQuestion.Question)" class="PageHeading"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="SurveyAnswer">
						<WTCOLUMN width="100" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(SurveyAnswer.AnswerDate)"/>
								<WTSTATIC value="CONST( - )"/>
								<WTSTATIC value="DATA(SurveyAnswer.Answer)"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="4160" caption="Survey Report" focus="false" contentpage="true" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="61"
		footer="false" navbar="false" header="ReportHeader">
		<!--===============================================================================-->
			<WTPARAM name="SurveyID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>

			<WTSUB name="LoadSurvey">
				<WTOBJECT name="Survey" project="ptsSurveyUser" class="CSurvey">
					<WTMETHOD name="Load">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpOrgID)" value="ATTR(OrgID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurvey" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="CONST(tmpOrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyQuestions" project="ptsSurveyQuestionUser" class="CSurveyQuestions">
					<WTMETHOD name="ListSurvey">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyQuestions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyChoices" project="ptsSurveyChoiceUser" class="CSurveyChoices">
					<WTMETHOD name="ListSurvey">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyChoices" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SurveyAnswers" project="ptsSurveyAnswerUser" class="CSurveyAnswers">
					<WTMETHOD name="ListComments_SurveyID">
						<WTPARAM name="SurveyID" direction="input" value="PARAM(SurveyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSurveyAnswers" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="LoadSurvey"/>
			</WTACTION>
			

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="15" align="left"/>
				<WTCOLUMN width="15" align="left"/>
				<WTCOLUMN width="620" align="left"/>

				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Survey.SurveyName)" newline="1"/>
						<WTSTATIC value="ATTR(Org.OrgName)" newline="1"/>
						<WTSTATIC value="ATTR(Survey.EndDate)" />
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="ATTR(Survey.EndDate)" newline="1"/>
						<WTSTATIC value="SYS(Date)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="3" label="NoQuestions" class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION))" oper="greater" value="CONST(0)"/>
					<WTSTATIC col="1" merge="3" value="ATTR(Survey.Description)"  class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTREPEAT xpath="/DATA/TXN/PTSSURVEYQUESTIONS/PTSSURVEYQUESTION">
						<WTROW >
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;.)" valign="top" bold="true"/>
							<WTSTATIC col="2" merge="2" value="DATA(SurveyQuestion.Question)" space="2" bold="true"/>
							<WTSTATIC col="2" merge="2" value="CONST( ( &lt;xsl:value-of select=&quot;@total&quot;/&gt; ))" bold="true"/>
						</WTROW>
						<WTVARIABLE name="tmpTotal" value="DATA(Total)"/>
						<WTROW>
							<WTREPEAT xpath="/DATA/TXN/PTSSURVEYCHOICES/PTSSURVEYCHOICE[(@surveyquestionid = current()/@surveyquestionid)]">
								<WTROW>
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" merge="2" value="CONST( - )"/>
									<WTSTATIC col="2"  merge="2" value="DATA(Choice)"/>
									<WTSTATIC col="2" merge="2" >
										<WTCONDITION expr="CONST($tmpTotal)" oper="greater" value="CONST(0)"/> 
										<WTSTATIC value="CONST(( &lt;xsl:value-of select=&quot;@total&quot;/&gt; - &lt;xsl:value-of select=&quot;format-number(@total div $tmpTotal, '#0.0%')&quot;/&gt; ))" bold="true"/>
									</WTSTATIC>
								</WTROW>
							</WTREPEAT>
						</WTROW>

						<WTCODEGROUP>
							<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSURVEYANSWERS/PTSSURVEYANSWER[(@answer != '') and (@surveyquestionid = current()/@surveyquestionid) ]))" 
								oper="greater" value="CONST(0)"/>
							<WTROW margin-top="6" >
								<WTSTATIC col="1" merge="2"/>						
								<WTDIVIDER col="3" height="1"  color="SYS(divider)"/>
							</WTROW>			
							<WTROW>
								<WTREPEAT xpath="/DATA/TXN/PTSSURVEYANSWERS/PTSSURVEYANSWER[(@surveyquestionid = current()/@surveyquestionid)]">
									<WTROW>
										<WTCONDITION expr="DATA(SurveyAnswer.Answer)" oper="not-equal" value="CONST('')" />
										<WTSTATIC col="1"/>
										<WTSTATIC col="2"/>
										<WTTABLE col="3">
											<WTCOLUMN width="80" align="left"/>
											<WTCOLUMN width="540" align="left"/>
											<WTROW  margin-bottom="1">
												<WTSTATIC col="1" value="DATA(SurveyAnswer.AnswerDate)" valign="top"/> 
												<WTSTATIC col="1" value="CONST( - )"/>
												<WTSTATIC col="2" value="DATA(SurveyAnswer.Answer)"/>
											</WTROW>
										</WTTABLE>
									</WTROW>
								</WTREPEAT>
							</WTROW>
							<WTROW >
								<WTSTATIC col="1" merge="2"/>						
								<WTDIVIDER col="3" height="1"  color="SYS(divider)"/>
							</WTROW>			
						</WTCODEGROUP>
					<WTROW margin-bottom="12"/>				
				 </WTREPEAT>
			   </WTROW>				
				
				<WTROW margin-top="12" margin-bottom="12">				
					<WTSTATIC/>
					<WTBUTTON col="1" merge="3" align="center" value="CONST(Close)" >
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>


	</WTWEBPAGES>

</WTROOT>