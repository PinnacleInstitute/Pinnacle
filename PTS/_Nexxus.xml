<WTROOT prefix="pts" system="Pinnacle">

	<WTENTITY id="158" name="Nexxus" alias="nx">
		<!--Identity-->
		<WTATTRIBUTE id="15801" name="NexxusID" type="number" identity="true" title="true" min="1" required="true" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="15895" name="Result" type="text" length="1000" source="entity" persist="false"/>
		<WTATTRIBUTE id="15896" name="Status" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="15897" name="czDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="15898" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="15899" name="Amount" type="number" source="entity" persist="false"/>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Nexxus" entity="Nexxus" alias="nx"/>
		</WTRELATIONSHIPS>

    <!-- System Constants -->
    <WTSYSCONS>
      <WTSYSCON name="ENROLL-AGREE" value="1" />
      <WTSYSCON name="ENROLL-CONFIRM" value="5" />
      <WTSYSCON name="ENROLL-PROCESS" value="6" />
    </WTSYSCONS>

  </WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
    <!--==================================================================-->
    <WTPROCEDURE name="CustomList" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
      <WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
      <WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
      <WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
      <WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
      <WTCODEGROUP>
        <WTSELECT>
          <WTATTRIBUTE value="ATTR(Nexxus.NexxusID)"/>
          <WTATTRIBUTE value="ATTR(Nexxus.Result)"/>
        </WTSELECT>
      </WTCODEGROUP>
    </WTPROCEDURE>
    <!--==================================================================-->
    <WTPROCEDURE name="CustomList2" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
      <WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
      <WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
      <WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
      <WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
      <WTPARAM name="ATTR(Result)" direction="input" required="false" passthru="true"/>
      <WTCODEGROUP>
        <WTSELECT>
          <WTATTRIBUTE value="ATTR(Nexxus.NexxusID)"/>
          <WTATTRIBUTE value="ATTR(Nexxus.Result)"/>
        </WTSELECT>
      </WTCODEGROUP>
    </WTPROCEDURE>
  </WTPROCEDURES>

	<WTWEBPAGES>
<!-- Processing - Admin Page -->
		<!--==================================================================-->
		<WTWEBPAGE name="15800" caption="Nexxus Processing" header="false" footer="false" navbar="false" wrapper="wrapper800" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="15800" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Process" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Result" datatype="text"/>
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Count" datatype="number"/>
      <WTPARAM name="Total" datatype="money"/>
      <WTPARAM name="txtOption" datatype="text"/>

      <WTDATATXN name="Members"/>
			<WTDATATXN name="Nexxuss"/>
      <WTDATATXN name="SalesOrders"/>
      <WTDATATXN name="Payouts"/>

      <WTINCLUDE name="Note.asp"/>
<!--      <WTINCLUDE name="Payout.asp"/>-->
      <WTINCLUDE name="WalletPayout.asp"/>
      <WTINCLUDE name="BillingPayout.asp"/>
      <WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="PaymentFile.asp"/>
			<WTINCLUDE name="Orders.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
			<WTINCLUDE name="DeclineEmail.asp"/>
      <WTINCLUDE name="LostBonusEmail.asp"/>
      <WTINCLUDE name="Statement.asp"/>

      <WTCODEGROUP>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(21)"/>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<!-- Set this page to not timeout for 4 hours -->
				<WTCUSTOM>Server.ScriptTimeout = 14400</WTCUSTOM>				
			</WTCODEGROUP>

      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
			<!-- Disable Certain Features based on User Type -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsManagerOnly"/>
				<WTCUSTOM>If InStr( ",2,3,5,6,11,12,13,21,22,23,24,25,26,27,29,30,31,33,34,35,37,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,", ","+CSTR(reqProcess)+"," ) = 0 Then reqProcess = 0</WTCUSTOM>
			</WTCODEGROUP>
        <!-- Set default User Input Options -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)" connector="or"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="CONST(100)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
        </WTCODEGROUP>
<WTCUSTOM>
  'Set date range to previous month
  If reqOption = 0 Then
  reqFromDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
  reqToDate = DateAdd( "d", -1, reqFromDate )
  reqFromDate = DateAdd( "m", -1, reqFromDate )
  End If
  'Set date range to current date
  If reqOption = 1 Then
  reqToDate = reqSysDate
  reqFromDate = reqSysDate
  End If
  'Set date range to current date
  If reqOption = 21 Then
  reqFromDate = reqSysDate
  reqToDate = DateAdd( "d", 3, reqFromDate )
  End If
  'Set date range to previous month
  If reqOption = 2 Then
  reqToDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
  reqFromDate = DateAdd( "m", -1, reqToDate )
  reqToDate = DateAdd( "d", -1, reqToDate )
  End If
  'Set date range to one month back from last Sunday
  If reqOption = 3 Then
  reqToDate = DateAdd( "d", -5, reqSysDate )
  reqFromDate = DateAdd( "m", -1, reqToDate )
  End If
  'Set date range to 1 week back
  If reqOption = 4 Then
  reqToDate = DateAdd( "d", -1, reqSysDate )
  reqFromDate = DateAdd( "d", -7, reqToDate )
  End If
  'Set date range to yesterday
  If reqOption = 5 Then
  reqFromDate = DateAdd( "d", -1, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 2 days ago
  If reqOption = 6 Then
  reqFromDate = DateAdd( "d", -2, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 3 days ago
  If reqOption = 7 Then
  reqFromDate = DateAdd( "d", -3, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 4 days ago
  If reqOption = 8 Then
  reqFromDate = DateAdd( "d", -4, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 5 days ago
  If reqOption = 9 Then
  reqFromDate = DateAdd( "d", -5, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set todate to 1 week back
  If reqOption = 11 Then
  reqToDate = DateAdd( "d", -7, reqSysDate )
  End If
  'Set todate to 2 weeks back
  If reqOption = 12 Then
  reqToDate = DateAdd( "d", -14, reqSysDate )
  End If
  'Set todate to 3 weeks back
  If reqOption = 13 Then
  reqToDate = DateAdd( "d", -21, reqSysDate )
  End If
  'Set todate to 4 weeks back
  If reqOption = 14 Then
  reqToDate = DateAdd( "d", -28, reqSysDate )
  End If
</WTCUSTOM>
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(93)" connector="or"/>
          <WTCODEGROUP>
						<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)" connector="or"/>
          <WTCODEGROUP>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
            <WTERROR number="10133" message="Oops, Please enter the required information." />
          </WTCODEGROUP>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(88)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(txtOption)" oper="equal" value="CONST(&quot;&quot;)"/>
            <WTERROR number="10133" message="Oops, Please enter the required information." />
          </WTCODEGROUP>
        </WTCODEGROUP>

        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>

					<!-- Create Billing Tokens -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						<WTCUSTOM>
							Result = BillingTokens()
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " New Billing Tokens Successfully Created! (" + aResult(1) + " bad)"
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Create Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(200)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payments Successfully Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Process Order Payments for Member Payments and email bonus recipients -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						<WTCUSTOM>
							PaymentOwnerType = 4
							PostProcess = 1
							Result = ProcessPayments( reqCompanyID, PaymentOwnerType, "1/1/2099", PostProcess )
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " Payments Successfully Processed! (" + aResult(1) + " bad)"
						</WTCUSTOM>
						<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult">
							<WTCONDITION expr="CONST(aResult(0))" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- List Declined Token -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Tokens!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(100)"/>
								<WTPARAM name="Level" direction="input" value="CONST(4)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Declined Payments Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Verify Bonus Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Earn Bonuses!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Calculate Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						<WTOBJECT name="Commission" project="ptsCommissionUser" class="CCommission">
							<WTMETHOD name="CustomCommissions">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="CommType" direction="input" value="CONST(1)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="CONST(Amount)" value="CONST(0)"/>
							<WTMETHOD name="TotalCommissions">
								<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Bonuses Created! (&quot; &amp; FormatCurrency(Amount,2) &amp; &quot;) &quot;)"/>
						</WTOBJECT>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + &quot; from &quot; + CStr(reqFromDate) + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					
					<!-- Display Hidden Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(202)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Bonuses Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Create Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyPayouts">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payouts Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Payout Credits -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(4)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(30)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payment Credits Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Verify Payout Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(6)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Receive a Payout!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Create Payout Files -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
            <WTCALLSUB name="ExportWalletWallet reqCompanyID, 14, reqToDate, tmpTotal, tmpFile, tmpAmount"/>
            <WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; BitCoin eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
            <WTCALLSUB name="ExportWalletWallet reqCompanyID, 13, reqToDate, tmpTotal, tmpFile, tmpAmount"/>
            <WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; STP eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;No Payouts to Export!&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>

							<!-- Mark Payouts Paid -->
              <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
								<WTMETHOD name="WalletStatus">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="PayType" direction="input" value="CONST(14)"/>
									<WTPARAM name="Count" direction="return" datatype="number"/>
								</WTMETHOD>
								<WTMETHOD name="WalletStatus">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="PayType" direction="input" value="CONST(13)"/>
									<WTPARAM name="Count" direction="return" datatype="number"/>
								</WTMETHOD>
							</WTOBJECT>
            </WTCODEGROUP>

					</WTCODEGROUP>

					<!-- Mark Payouts Paid -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS EXPORT PAYOUTS AMOUNT -->
<!--
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyStatus2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="PaidDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(-1)"/>
								<WTPARAM name="Reference" direction="input" value="CONST(&quot;3&quot;)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Pending Payouts Marked Paid!&quot;)"/>
						</WTOBJECT>
-->						
					</WTCODEGROUP>
					
					<!-- Display Hidden Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(203)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Payouts Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Recalculate Group Sales Volume and Promotions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(1)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Group Sales Totals Recalculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Post sales summary -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(2)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Sales Summary Postings!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- List Enroller Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(90)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Enroller Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All New eWallets to be Created -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTOBJECT name="Nexxuss" project="ptsNexxusUser" class="CNexxuss">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlNexxuss" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;New eWallets to be imported to iPayout in a .CSV file!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Assign New eWallets to Payout Method -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New eWallets Assigned!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Mark GCC Payment Orders Pending (in process)-->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All New Global Cash Card orders marked pending!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Set All Member Alerts-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Member Alerts Set!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Clean up Data -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Data Cleaned Up!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Export Submitted Orders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Export Green Fuel Tab Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export Nexxus Max Inhouse Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; LM Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export Nexxus Max OIL Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 3, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; LM-OIL Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>

							<!-- Update These Submitted Orders to InProcess -->
							<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
								<WTMETHOD name="Custom2">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="Status" direction="input" value="CONST(101)"/>
									<WTPARAM name="OrderDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
									<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Export Inprocess Orders -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; Nexxus Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
-->
					
					<!-- Update Inprocess Orders to Complete -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="OrderDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Inprocess Orders to Complete -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Email Commissions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						<WTCALLSUB name="CommissionEmail reqCompanyID, 0, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Commission Emails Sent&quot;)"/>
					</WTCODEGROUP>

					<!-- Recalculate All Title Advancements -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(15)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Title Advancements Calculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>


					<!-- Export Payment to process -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						<WTSETATTRIBUTE name="CONST(PaymentOwnerType)" value="CONST(52)"/>
						<WTCALLSUB name="ExportPayments reqCompanyID, PaymentOwnerType, &quot;1/1/2099&quot;,  CCTotal, CKTotal, CCFile, CKFile, ErrorMsg"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(ErrorMsg)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTCUSTOM>
								response.write ErrorMsg
								response.end
							</WTCUSTOM>
						</WTCODEGROUP>
						<!-- Exported CC Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/Billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CCFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CCTotal) + &quot; CC Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Exported ACH Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CKTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusmarketing.com/billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CKFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CKTotal) + &quot; ACH Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCTotal + CKTotal)" oper="not-equal" value="CONST(0)"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Update Binary Sales -->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payments Updated in the Binary Sales Volume!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Update Binary Counts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(301)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Binary Downline member counts Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Recruiters -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(99)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Recruiters!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Earners -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(98)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Earners!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Countries -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(97)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Countries!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Email Members with Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="DeclineEmail reqCompanyID, 0, 0, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Declined Payments Emailed!&quot;)"/>
					</WTCODEGROUP>

					<!-- Suspend Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(207)"/>
								<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Suspended with Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Cancel Suspended Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(208)"/>
								<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Suspended Members Cancelled with Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Enrolled Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="Level" direction="input" value="PARAM(MemberID)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Member #&quot; + CStr(reqMemberID) + &quot; Downline Enrolled Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Binary Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(107)"/>
								<WTPARAM name="Level" direction="input" value="PARAM(MemberID)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Member #&quot; + CStr(reqMemberID) + &quot; Downline Binary Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Salesorder Cash Payments to be processed -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(104)"/>  <!-- Cash Payments -->
								<WTPARAM name="Level" direction="input" value="CONST(1)"/> <!-- Salesorders -->-->
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Cash Payments to be Processed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Salesorders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
							<WTMETHOD name="CustomList2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(1)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTCUSTOM>
								For Each oItem in oSalesOrders
								With oItem
								.Result = CHR(34) + Replace(.Result, "|", CHR(34) + "," + CHR(34)) + CHR(34)
								End With
								Next
							</WTCUSTOM>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlSalesOrders" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Sales Orders!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Binary Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(91)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Binary Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Missing Wallets -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(56)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Dealers with Missing Wallets!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Cancel Trial Members over 30 Days -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(57)"/>
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(302)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Trial Dealers Moved to Free Dealer!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

          <!-- Lock all payout methods -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(58)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(304)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(1)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( &quot;All Payout Methods Locked!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Unlock all payout methods -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(59)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(304)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(2)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( &quot;All Payout Methods Unlocked!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- List Order Errors -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(106)"/>
                <WTPARAM name="Level" direction="input" value="CONST(0)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Dealers with Order Errors!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>
\
          <!-- List All Wallet Payout Requests -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)"/>
            <WTOBJECT name="Payouts" project="ptsPayoutUser" class="CPayouts">
              <WTMETHOD name="WalletExport">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="PayoutID" direction="input" value="CONST(0)"/>
                <WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
                <WTPARAM name="PayType" direction="input" value="CONST(0)"/>
              </WTMETHOD>
              <WTCUSTOM>
                reqTotal = 0.0
                reqCount = 0
                For Each oItem in oPayouts
                  With oItem
                    If InStr(.Notes, "|") > 0 Then
                      a = Split(.Notes, "|")
                      .OwnerID = a(1)
                      .Notes = Replace(.Notes, "|", " - " )
                    End If
                    reqCount = reqCount + 1
                    reqTotal = reqTotal + CCUR(.Amount)
                  End With
                Next
                reqTotal = FormatCurrency(reqTotal,2)
              </WTCUSTOM>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlPayouts" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Wallet Payout Requests!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Clear Lost Bonuses -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(74)"/>
            <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
                <WTPARAM name="Status" direction="input" value="CONST(1080)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(CSTR(Count) +  &quot; Lost Bonuses Cleared!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- List Lost Bonuses -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
            <WTSETATTRIBUTE name="CONST(MinLostBonus)" value="PARAM(MemberID)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(80)"/>
                <WTPARAM name="Level" direction="input" value="CONST(MinLostBonus)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;List Lost Bonuses!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Email Members with Lost Bonuses -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)"/>
            <WTSETATTRIBUTE name="CONST(MinLostBonus)" value="PARAM(MemberID)"/>
            <WTCALLSUB name="LostBonusEmail reqCompanyID, MinLostBonus, tmpTotal"/>
            <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Lost Bonuses Emailed!&quot;)"/>
          </WTCODEGROUP>

          <!-- Reconcile Company Wallets -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(77)"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(210)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Reconcilled Company Wallets!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- List Sponsor Matrix Orphan Affiliates -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(78)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(107)"/>
                <WTPARAM name="Level" direction="input" value="CONST(0)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Matrix Sponsor Orphaned Affiliates!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!--  Sales Team Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(79)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(1)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Sales Team Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Billing Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(80)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(2)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Billing Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Order Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(81)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(3)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Payout Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(4)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Wallet Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

					<!-- List Summary Nexxus Coin Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(83)"/>
						<WTOBJECT name="Nexxuss" project="ptsNexxusUser" class="CNexxuss">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(10)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlNexxuss" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Nexxus Coin Order Summary!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Detail Nexxus Coin Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
						<WTOBJECT name="Nexxuss" project="ptsNexxusUser" class="CNexxuss">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlNexxuss" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Nexxus Coin Order Details!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Summary Hardware Wallet Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(85)"/>
						<WTOBJECT name="Nexxuss" project="ptsNexxusUser" class="CNexxuss">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlNexxuss" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Nexxus Hardware Wallet Order Summary!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

          <!-- List Detail Hardware Wallet Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)"/>
						<WTOBJECT name="Nexxuss" project="ptsNexxusUser" class="CNexxuss">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(13)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlNexxuss" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Nexxus Hardware Wallet Order Details!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

          <!-- Delete all AuthLog records -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(87)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(502)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( &quot;All Marketing IP Logs Deleted!&quot;)"/>
            </WTOBJECT>
					</WTCODEGROUP>

          <!-- List Members by City or State -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(88)"/>
            <WTOBJECT name="Nexxuss" project="ptsNexxusUser" class="CNexxuss">
              <WTMETHOD name="CustomList2">
                <WTPARAM name="Status" direction="input" value="CONST(1)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="input" value="PARAM(txtOption)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlNexxuss" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Members by Location!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Create Merchant Invoices -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(89)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(700)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text" length="1000"/>
              </WTMETHOD>
						  <WTCUSTOM>
                a = Split( Result, "|")
                tmpCount = a(0)
                tmpTotal = a(1)
						  </WTCUSTOM>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( tmpCount + &quot; Merchant Invoices Created! &quot; + tmpTotal)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Create ACH Invoices File -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(90)"/>
						<WTCUSTOM>
              'tmpProcessor = 1 '???
              tmpProcessor = 0 'Paper Check
              Result = CreateACHFile( reqCompanyID, tmpProcessor )
              a = Split( Result, "|")
              tmpTotal = a(0)
              tmpFile = a(1)
            </WTCUSTOM>
          	<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.nexxusuniversity.com/billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; ACH Invoices &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(MSG + &quot;&lt;br&gt;&quot; + LINK)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(MSG + URL)"/>
              <WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>
						</WTCODEGROUP>
          </WTCODEGROUP>

          <!-- Mark ACH Invoices Pending -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(91)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(701)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text" length="1000"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( Result + &quot; Invoices Marked Pending!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Check Onhold Rewards Releases -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(92)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(702)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text" length="1000"/>
              </WTMETHOD>
						  <WTCUSTOM>
                a = Split( Result, "|")
                tmpCount = a(0)
                tmpTotal = a(1)
						  </WTCUSTOM>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( tmpCount + &quot; Rewards Unheld! &quot; + tmpTotal)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Calculate Payment2 Bonuses -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(93)"/>
            <WTOBJECT name="Commission" project="ptsCommissionUser" class="CCommission">
              <WTMETHOD name="CustomCommissions">
                <WTPARAM name="CompanyID" direction="input" value="CONST(-21)"/>
                <WTPARAM name="CommType" direction="input" value="CONST(1)"/>
                <WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
                <WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Bonuses Created!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Process Pending Statements / Invoices -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(94)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(703)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text" length="1000"/>
              </WTMETHOD>
              <WTCUSTOM>
                a = Split( Result, "|")
                tmpCount = a(0)
                tmpTotal = a(1)
              </WTCUSTOM>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( tmpCount + &quot; Paid Invoices Processed! &quot; + tmpTotal)"/>
            </WTOBJECT>
          </WTCODEGROUP>

        </WTCODEGROUP>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="center"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(Result)" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="24">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC label="NotAvailable">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="BillingTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateDeclined">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						</WTSTATIC>
						<WTSTATIC label="BonusQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						</WTSTATIC>
						<WTSTATIC label="CalcBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentCredits">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutPaid">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayPayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSummary">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						</WTSTATIC>
						<WTSTATIC label="ListReferralOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						</WTSTATIC>
						<WTSTATIC label="CreateWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						</WTSTATIC>
						<WTSTATIC label="AssignWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						</WTSTATIC>
						<!--
						<WTSTATIC label="MarkGCC">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="SetAlerts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						</WTSTATIC>
						<WTSTATIC label="CleanupData">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						</WTSTATIC>
						<WTSTATIC label="EmailCommissions">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						</WTSTATIC>
						<WTSTATIC label="TitleAdvancements">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						</WTSTATIC>
<!--						
						<WTSTATIC label="UpdateBinarySales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="UpdateBinaryCount">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						</WTSTATIC>
						<WTSTATIC label="TopRecruiters">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						</WTSTATIC>
						<WTSTATIC label="TopEarners">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						</WTSTATIC>
						<WTSTATIC label="TopCountries">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineEmail">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineSuspend">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineCancel">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						</WTSTATIC>
						<WTSTATIC label="AllMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						</WTSTATIC>
						<WTSTATIC label="EnrollMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
						</WTSTATIC>
						<WTSTATIC label="BinaryMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)"/>
						</WTSTATIC>
						<WTSTATIC label="CashPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)"/>
						</WTSTATIC>
						<WTSTATIC label="ListSalesOrders">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						</WTSTATIC>
						<WTSTATIC label="ListBinaryOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)"/>
						</WTSTATIC>
						<WTSTATIC label="ListMissingWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(56)"/>
						</WTSTATIC>
            <WTSTATIC label="CancelTrialDealers">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(57)"/>
            </WTSTATIC>
            <WTSTATIC label="LockPayouts">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(58)"/>
            </WTSTATIC>
            <WTSTATIC label="UnlockPayouts">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(59)"/>
            </WTSTATIC>
            <WTSTATIC label="ListOrderErrors">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)"/>
            </WTSTATIC>
            <WTSTATIC label="WalletPayouts">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)"/>
            </WTSTATIC>
            <WTSTATIC label="ClearLostBonuses">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(74)"/>
            </WTSTATIC>
            <WTSTATIC label="ListLostBonuses">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
            </WTSTATIC>
            <WTSTATIC label="EmailLostBonuses">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)"/>
            </WTSTATIC>
            <WTSTATIC label="ReconcileWallets">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(77)"/>
            </WTSTATIC>
            <WTSTATIC label="ListSponsorOrphans">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(78)"/>
            </WTSTATIC>
            <WTSTATIC label="SalesTeamExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(79)"/>
            </WTSTATIC>
            <WTSTATIC label="BillingExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(80)"/>
            </WTSTATIC>
            <WTSTATIC label="OrderExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(81)"/>
            </WTSTATIC>
            <WTSTATIC label="PayoutExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)"/>
            </WTSTATIC>
            <WTSTATIC label="CoinOrderSummary">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(83)"/>
            </WTSTATIC>
            <WTSTATIC label="CoinOrderDetail">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
            </WTSTATIC>
            <WTSTATIC label="WalletOrderSummary">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(85)"/>
            </WTSTATIC>
            <WTSTATIC label="WalletOrderDetail">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)"/>
            </WTSTATIC>
            <WTSTATIC label="DeleteMarketingIPs">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(87)"/>
            </WTSTATIC>
            <WTSTATIC label="ListMembersByLocation">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(88)"/>
            </WTSTATIC>
            <WTSTATIC label="CreateStatements">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(89)"/>
            </WTSTATIC>
            <WTSTATIC label="CreateACHFile">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(90)"/>
            </WTSTATIC>
            <WTSTATIC label="MarkACHPending">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(91)"/>
            </WTSTATIC>
            <WTSTATIC label="RewardHoldRelease">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(92)"/>
            </WTSTATIC>
            <WTSTATIC label="RewardBonuses">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(93)"/>
            </WTSTATIC>
            <WTSTATIC label="PendingInvoices">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(94)"/>
            </WTSTATIC>
          </WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(93)" connector="or"/>
          <WTSTATIC col="1" label="From" align="center" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)" connector="or"/>
          <WTTEXT col="1" align="center" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
					<WTSTATIC col="1" tag="MemberID" align="center" />
					<WTTEXT col="1" align="center" value="PARAM(MemberID)" name="MemberID" size="8" />
				</WTROW>
        <WTROW margin-top="12">
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)" connector="or"/>
          <WTSTATIC col="1" tag="MinLostBonus" align="center" />
          <WTTEXT col="1" align="center" value="PARAM(MemberID)" name="MemberID" size="5" />
        </WTROW>
        <WTROW margin-top="12">
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(88)"/>
          <WTSTATIC col="1" tag="State" align="center" />
          <WTTEXT col="1" align="center" value="PARAM(txtOption)" size="20" />
        </WTROW>

        <WTROW margin-bottom="12" margin-top="12">
          <WTBUTTON col="1" action="1" value="CONST(Process)" align="center">
            <WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)" connector="or"/>
            <WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(cashregister.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0436d" return="false" target="Declines">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(Level)"/>
                        <WTPARAM name="Code" value="CONST(2)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="1003" return="false" target="Finances">
                        <WTPARAM name="PaymentID" value="DATA(MemberID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Email.gif)" alt="Email" imgalign="absmiddle">
                      <WTLINK name="0436e" target="DeclineEmail">
                        <WTPARAM name="MemberID" value="DATA(Level)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(79)"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(80)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(81)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)" connector="or"/>
            <WTROW margin-top="12"/>
            <WTREPEAT entity="Member">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@level&quot;/&gt;.gif)" imgalign="absmiddle" path="Company\14"/>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(82)"/>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="Code" value="CONST(2)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)"/>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="Code" value="CONST(4)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(genealogy.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0470" return="false" target="SalesTeam">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                      <WTLINK name="0403" target="Member">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(78)" connector="or"/>
            <WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)" space="3"/>
                  <WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@status&quot;/&gt;)"/>
                  <WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@status&quot;/&gt;)" space="3"/>
<!--
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
-->									
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="SalesOrder">
							<WTROW>
								<WTSTATIC col="1" value="DATA(Result)" align="left"/>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" label="eWalletHdr" align="left"/>
						</WTROW>
						<WTROW>
							<WTREPEAT entity="Nexxus">
								<WTROW>
									<WTSTATIC col="1" value="DATA(Result)" align="left"/>
								</WTROW>
							</WTREPEAT>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(56)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GLogo.png)" alt="Edit" path="company/21/" imgalign="absmiddle">
											<WTLINK name="15803" target="Wallet">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)"/>
            <WTROW margin-top="12">
              <WTSTATIC col="1" align="center" class="PageHeading">
                <WTSTATIC tag="Total"/>
                <WTSTATIC value="PARAM(Count)" space="2"/>
                <WTSTATIC value="CONST(-)" space="2"/>
                <WTSTATIC value="PARAM(Total)"/>
              </WTSTATIC>
            </WTROW>
            <WTROW margin-top="12"/>
            <WTREPEAT entity="Payout">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(OwnerID)"/>
                        <WTPARAM name="Code" value="CONST(4)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                      <WTLINK name="0403" target="Member">
                        <WTPARAM name="MemberID" value="DATA(OwnerID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Email.gif)" alt="Email" imgalign="absmiddle">
                      <WTLINK name="0836" target="PayoutEmail">
                        <WTPARAM name="PayoutID" value="DATA(PayoutID)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="DATA(PayType)" oper="equal" value="SYSCON(PAYOUT_BITCOIN)"/>
                    <WTCONDITION expr="DATA(PayType)" oper="equal" value="SYSCON(PAYOUT_ETHER)" connector="or"/>
                    <WTCONDITION expr="DATA(PayType)" oper="equal" value="SYSCON(PAYOUT_NEXXUS)" connector="or"/>
                    <WTCONDITION expr="DATA(PayType)" oper="equal" value="SYSCON(PAYOUT_SOLIDTRUST)" connector="or"/>
                    <WTIMAGE value="CONST(cashregister.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0803" target="Payout">
                        <WTPARAM name="PayoutID" value="DATA(PayoutID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                        <WTPARAM name="Wallet" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="DATA(PayType)" oper="not-equal" value="SYSCON(PAYOUT_BITCOIN)"/>
                    <WTCONDITION expr="DATA(PayType)" oper="not-equal" value="SYSCON(PAYOUT_SOLIDTRUST)" connector="and"/>
                    <WTIMAGE value="CONST(blank16.gif)" imgalign="absmiddle"/>
                  </WTCODEGROUP>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(Amount)"/>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(Notes)"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
            <WTROW margin-top="12"/>
            <WTREPEAT entity="Member">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@level&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/21"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="Code" value="CONST(2)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                      <WTLINK name="0403" target="Member">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(83)"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(85)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)" connector="or"/>
            <WTREPEAT entity="Nexxus">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
                    <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)" connector="or"/>
                    <WTIMAGE value="CONST(calculator32.gif)" imgalign="absmiddle">
                      <WTLINK name="NexxusFulfill" target="NexxusFulfill">
                        <WTPARAM name="PaymentID" value="DATA(NexxusID)"/>
                        <WTPARAM name="Process" value="PARAM(Process)"/>
                      </WTLINK>
                    </WTIMAGE>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTSTATIC value="DATA(Result)" align="left" fontsize="5"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(88)"/>
            <WTREPEAT entity="Nexxus">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                      <WTLINK name="0403" target="Member">
                        <WTPARAM name="MemberID" value="DATA(NexxusID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTSTATIC value="DATA(Result)" align="left"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

        </WTCODEGROUP>

        <WTROW margin-bottom="12"/>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Member Change Membership Options Page -->
		<!--============================================================================================-->
		<WTWEBPAGE name="15801" caption="Upgrade Membership" navbar="false" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="15801">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Package" datatype="number"/>
      <WTPARAM name="Binary" datatype="number"/>

      <WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(0)"/>
          <WTSETATTRIBUTE name="PARAM(Binary)" value="CONST(1)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(1)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(.Options2, &quot;102&quot;))" oper="not-equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(2)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(.Options2, &quot;103&quot;))" oper="not-equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(3)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(.Options2, &quot;B1&quot;))" oper="equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Binary)" value="CONST(1)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(.Options2, &quot;B2&quot;))" oper="equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Binary)" value="CONST(2)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(.Options2, &quot;B3&quot;))" oper="equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Binary)" value="CONST(3)"/>
          </WTCODEGROUP>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadLists"/>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>

          <!-- Set Affiliate Package Options -->
					<WTCODEGROUP>
						<!-- Beginner -->
						<WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;101&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(10)"/>
          </WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Basic -->
						<WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;102&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(25)"/>
          </WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Pro -->
						<WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;103&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(50)"/>
          </WTCODEGROUP>
          
          <WTCODEGROUP>
            <!-- Binary Weak Leg (Default) -->
            <WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(1)"/>
            <WTSETATTRIBUTE name="CONST(tmpBinary)" value="CONST(&quot;B1&quot;)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <!-- Binary Left Leg -->
            <WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(2)"/>
            <WTSETATTRIBUTE name="CONST(tmpBinary)" value="CONST(&quot;B2&quot;)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <!-- Binary Right Leg -->
            <WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(3)"/>
            <WTSETATTRIBUTE name="CONST(tmpBinary)" value="CONST(&quot;B3&quot;)"/>
          </WTCODEGROUP>

					<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(tmpBinary + &quot;, &quot; + tmpCode)"/>

          <WTMETHOD name="Save">
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>

          <!-- If there is a change to the membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldOptions2)" oper="not-equal" value="ATTR(Options2)"/>
						<!-- log the membership change -->
						<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE: (&quot; + oldOptions2 + &quot;) to (&quot; + .Options2 + &quot;)&quot;">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
						<!-- Update possible old pending payment or create new payment -->
						<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(303)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
				</WTOBJECT>

				<!-- If there is a change to the member's title (or they activated) -->
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<!-- Custom Upgrade Processing -->
					<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
						<WTMETHOD name="Custom">
							<WTPARAM name="Status" direction="input" value="CONST(102)"/>
							<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Result" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>
        
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="right"/>
				<WTCOLUMN width="400" align="left"/>

        <WTROW margin-top="12">
          <WTSTATIC col="1" merge="2" label="Affiliate Options" align="center" class="PageHeading"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" tag="Package"/>
          <WTCOMBO col="2" value="PARAM(Package)">
            <WTOPTION id="0" label="Package0"/>
            <WTOPTION id="1" label="Package1"/>
            <WTOPTION id="2" label="Package2"/>
            <WTOPTION id="3" label="Package3"/>
          </WTCOMBO>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" tag="Binary"/>
          <WTCOMBO col="2" value="PARAM(Binary)">
            <WTOPTION id="1" label="Binary1"/>
            <WTOPTION id="2" label="Binary2"/>
            <WTOPTION id="3" label="Binary3"/>
          </WTCOMBO>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Update)" align="center"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="15802" caption="Nexxus Stats" header="false" footer="false" navbar="false" action="0" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="15802" secured="1251">
			<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					If reqDay &gt; 0 Then reqToday = DateAdd("d", reqDay * -1, reqSysDate) Else reqToday = reqSysDate
					Select Case DATEPART("w", reqToday )
					Case 1 reqToday = reqToday &amp; " Sunday"
					Case 2 reqToday = reqToday &amp; " Monday"
					Case 3 reqToday = reqToday &amp; " Tuesday"
					Case 4 reqToday = reqToday &amp; " Wednesday"
					Case 5 reqToday = reqToday &amp; " Thursday"
					Case 6 reqToday = reqToday &amp; " Friday"
					Case 7 reqToday = reqToday &amp; " Saturday"
					End Select
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(7)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="center"/>
				<WTCOLUMN width="6" align="center"/>
				<WTCOLUMN width="300" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="Statistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" valign="top">
						<WTCOLUMN width="300" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="90" align="right"/>
								<WTCOLUMN width="70" align="center"/>
								<WTCOLUMN width="70" align="center"/>
								<WTCOLUMN width="70" align="center"/>
                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Customers"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
                </WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Member" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m11)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m17)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m199)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="3" align="left">
  									<WTSTATIC space="2"/>
	  								<WTSTATIC tag="CustomerRatio"/>
									</WTSTATIC>
									<WTSTATIC col="4" value="ATTR(Stats.ac)"/>
								</WTROW>
              </WTTABLE>
            </WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="90" align="right"/>
								<WTCOLUMN width="70" align="center"/>
								<WTCOLUMN width="70" align="center"/>
								<WTCOLUMN width="70" align="center"/>
								<WTROW>
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Members"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
                <WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Affiliate" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m21)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m27)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m299)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Bronze" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m31)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m37)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m399)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Silver" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m41)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m47)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m499)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Gold" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m51)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m57)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m599)"/>
								</WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Diamond" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.m61)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.m67)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.m699)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Platinum" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.m71)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.m77)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.m799)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Ambassador" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.m81)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.m87)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.m899)"/>
                </WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Active" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.t1)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.t7)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.t99)"/>
                </WTROW>
                <WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="3" align="left">
  									<WTSTATIC space="2"/>
	  								<WTSTATIC tag="Paid90"/>
									</WTSTATIC>
                  <WTSTATIC col="4" value="ATTR(Stats.aa)"/>
                </WTROW>
                <WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="3" align="left">
  									<WTSTATIC space="2"/>
	  								<WTSTATIC tag="Visit90"/>
									</WTSTATIC>
                  <WTSTATIC col="4" value="ATTR(Stats.av)"/>
                </WTROW>
                <WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="3" align="left">
  									<WTSTATIC space="2"/>
	  								<WTSTATIC tag="Engaged90"/>
									</WTSTATIC>
                  <WTSTATIC col="4" value="ATTR(Stats.ae)"/>
                </WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
                <WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Suspended" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.a1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.a7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.a99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Cancelled" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.c1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.c7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.c99)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
					<WTSTATIC col="2"/>
					<WTTABLE col="3" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Sales"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Today" bold="true" align="center"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" value="ATTR(Stats.S1)" align="center"/>
                  <WTSTATIC col="2" value="ATTR(Stats.S7)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.S30)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.S99)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2"/>
                  <WTSTATIC col="3"/>
                  <WTSTATIC col="4" value="ATTR(Stats.S100)"/>
                </WTROW>
              </WTTABLE>
						</WTROW>
            
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="75" align="right"/>
                <WTCOLUMN width="75" align="center"/>
                <WTCOLUMN width="75" align="center"/>
                <WTCOLUMN width="75" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Bonuses"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" label="Today" bold="true" align="center"/>
                  <WTSTATIC col="2" label="Days7" bold="true"/>
                  <WTSTATIC col="3" label="Days30" bold="true"/>
                  <WTSTATIC col="4" label="Total" bold="true"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" value="ATTR(Stats.B1)" align="center"/>
                  <WTSTATIC col="2" value="ATTR(Stats.B7)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.B30)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.B99)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2"/>
                  <WTSTATIC col="3"/>
                  <WTSTATIC col="4" value="ATTR(Stats.B100)"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="63" align="center"/>
                <WTCOLUMN width="79" align="center"/>
                <WTCOLUMN width="79" align="center"/>
                <WTCOLUMN width="79" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Wallet"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" label="Available" bold="true"/>
                  <WTSTATIC col="3" label="Requested" bold="true"/>
                  <WTSTATIC col="4" label="Total" bold="true"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Total" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.W1)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.W2)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.W3)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Qualified" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.W4)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.W5)"/>
                  <WTSTATIC col="4"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="63" align="center"/>
                <WTCOLUMN width="79" align="center"/>
                <WTCOLUMN width="79" align="center"/>
                <WTCOLUMN width="79" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="QualifiedAffiliates"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" label="Days7" bold="true"/>
                  <WTSTATIC col="3" label="Days30" bold="true"/>
                  <WTSTATIC col="4" label="Total" bold="true"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="CCS" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.CCS1)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.CCS2)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.CCS3)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="QA" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.QA1)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.QA2)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.QA3)"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="15804" caption="Nexxus Dashboard" header="false" footer="false" navbar="false" action="0" wrapper="wrapper400s"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="15804" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Show" datatype="number"/>
      
      <WTPARAM name="Today" datatype="text"/>

      <WTDATATXN name="Dash"/>

      <!-- CHECK FOR NON-DOWNLINE ACCESS -->
			<WTSUB name="CheckUpline">
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="CheckUpline">
							<WTPARAM name="SponsorID" direction="input" value="SYS(MemberID)"/>
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(1)"/>
							<WTPARAM name="Result" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTRETURN>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
						<WTLINK name="0101" return="false">
							<WTPARAM name="ActionCode" value="CONST(9)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTSUB>

  <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(Show)" value="CONST(1)">
          <WTCONDITION expr="IsEmployee"/>
          <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
          <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="SYS(MemberID)" connector="or"/>
        </WTSETATTRIBUTE>
        <WTCUSTOM>
          reqToday = reqSysDate
          Select Case DATEPART("w", reqToday )
          Case 1 reqToday = reqToday &amp; " Sunday"
          Case 2 reqToday = reqToday &amp; " Monday"
          Case 3 reqToday = reqToday &amp; " Tuesday"
          Case 4 reqToday = reqToday &amp; " Wednesday"
          Case 5 reqToday = reqToday &amp; " Thursday"
          Case 6 reqToday = reqToday &amp; " Friday"
          Case 7 reqToday = reqToday &amp; " Saturday"
          End Select
        </WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="CheckUpline"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
          <WTMETHOD name="Load">
            <WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlCompany" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(8)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="xmlDash" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="400" align="center"/>

        <WTROW>
          <WTSTATIC col="1" align="center">
            <WTCODEGROUP>
              <WTIMAGE value="CONST(Dashboard48c.png)" imgalign="absmiddle"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
        
        <WTROW margin-bottom="3">
          <WTSTATIC col="1" align="center" class="PageHeading">
            <WTSTATIC space="1"/>
            <WTSTATIC label="Dashboard"/>
            <WTSTATIC value="CONST( - )"/>
            <WTSTATIC value="PARAM(Today)" newline="1"/>
            <WTSTATIC bold="true">
              <WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
              <WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
              <WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;))"/>
            </WTSTATIC>
            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(Dash.f)" oper="not-equal" value="CONST(0)"/>
              <WTIMAGE value="CONST(IsLocked.gif)" imgalign="absmiddle"/>
            </WTCODEGROUP>
<!--            
            <WTSTATIC newline="1"/>
            <WTSTATIC label="Joined" space="1"/>
            <WTSTATIC value="ATTR(Member.EnrollDate)"/>
-->            
          </WTSTATIC>
        </WTROW>

        <WTROW margin-bottom="3">
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="150" align="right"/>
                <WTCOLUMN width="250" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Advancement"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="Title" align="right"/>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;"/>
                    </WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Title1">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title2">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title3">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title4">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title5">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title6">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title7">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title8">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(8)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title9">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(9)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title10">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(10)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title11">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(11)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="PayTitle" align="right"/>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title2&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;"/>
                    </WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Title1">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title2">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title3">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title4">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title5">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title6">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title7">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title8">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(8)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title9">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(9)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title10">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(10)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title11">
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(11)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(10)"/>
                  <WTSTATIC col="1" tag="NextTitle" align="right"/>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title+1&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;"/>
                    </WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Title2">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title3">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title4">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title5">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title6">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title7">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title8">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title9">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(8)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title10">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(9)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title11">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(10)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="NeedNext" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC value="ATTR(Dash.a1)"/>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Personal">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="greater-equal" value="CONST(5)"/>
                      <WTCONDITION expr="ATTR(Member.Title)" oper="less-equal" value="CONST(7)" connector="and"/>
                    </WTSTATIC>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Need3">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need4">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need5">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need6">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need7">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need8">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need9">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(8)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need10">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(9)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need11">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(10)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="PersonalsTeam" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC value="ATTR(Member.BV)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Member.QV)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="LastRecruit" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.r1)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.r1)">
                      <WTCONDITION expr="ATTR(Dash.r1)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.r2)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.r2)">
                      <WTCONDITION expr="ATTR(Dash.r2)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-bottom="3">
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="150" align="right"/>
                <WTCOLUMN width="250" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Qualifications"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="BonusQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="Yes" bold="true">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(0)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NotActive" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NoPayment" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NoReferrals" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="PayoutQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="Yes" bold="true">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(0)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NotActive" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NoPayoutMethod" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NoTaxID" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="TeamQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="not-equal" value="CONST(0)"/>
                      <WTCONDITION expr="ATTR(Member.Title2)" oper="less" value="CONST(3)" connector="or"/>
                    </WTSTATIC>
                    <WTSTATIC>
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(0)"/>
                      <WTSTATIC label="Level4">
                        <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(3)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level5">
                        <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(4)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level6">
                        <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(5)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level8">
                        <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(6)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level10">
                        <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(7)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level12">
                        <WTCONDITION expr="ATTR(Member.Title2)" oper="equal" value="CONST(8)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-bottom="3">
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="100" align="right"/>
                <WTCOLUMN width="100" align="center"/>
                <WTCOLUMN width="100" align="center"/>
                <WTCOLUMN width="100" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Finances"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTCONDITION expr="PARAM(Show)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" label="Recent" bold="true"/>
                  <WTSTATIC col="3" label="Quarter" bold="true"/>
                  <WTSTATIC col="4" label="Total" bold="true"/>
                </WTROW>

                <WTROW margin-bottom="2">
                  <WTCONDITION expr="PARAM(Show)" oper="not-equal" value="CONST(0)"/>
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="PARAM(Show)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC col="1" tag="Payouts" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Dash.p1)"/>
                  <WTSTATIC col="3" value="ATTR(Dash.p3)"/>
                  <WTSTATIC col="4" value="ATTR(Dash.p99)"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="FirstOrder" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.b3)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.b3)">
                      <WTCONDITION expr="ATTR(Dash.b3)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="3">
                    <WTSTATIC value="ATTR(Dash.b4)">
                      <WTCONDITION expr="ATTR(Dash.b4)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="4"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="LastOrder" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.b1)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.b1)">
                      <WTCONDITION expr="ATTR(Dash.b1)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="3">
                    <WTSTATIC value="ATTR(Dash.b2)">
                      <WTCONDITION expr="ATTR(Dash.b2)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="4"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="NextOrder" align="right"/>
                    <WTSTATIC col="2">
                      <WTSTATIC value="ATTR(Member.Price)">
                        <WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
                      </WTSTATIC>
                      <WTSTATIC label="None">
                        <WTCONDITION expr="ATTR(Member.Billing)" oper="not-equal" value="CONST(3)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC col="3">
                      <WTSTATIC value="ATTR(Member.PaidDate)">
                        <WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                  <WTSTATIC col="4"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Member.Retail)" oper="not-equal" value="CONST('$0.00')"/>
                  <WTSTATIC col="1" tag="LostBonuses" align="right" fontcolor="red"/>
                  <WTSTATIC col="2" value="ATTR(Member.Retail)" fontcolor="red"/>
                  <WTSTATIC col="3" merge="2" align="left" fontcolor="red">
                    <WTSTATIC label="since" space="1"/>
                    <WTSTATIC value="ATTR(Company.LostBonusDate)"/>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW>
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="3">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="400" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Leadership"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l11)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="Enroller" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l11)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l12)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l13)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l21)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="Mentor" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l21)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l22)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l23)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l31)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="D1Leader" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l31)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l32)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l33)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l41)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="D2Leader" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l41)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l42)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l43)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l51)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="D3Leader" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l51)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l52)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l53)"/>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-top="6" margin-bottom="6">
          <WTBUTTON col="1" value="Close">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

  		<!--============================================================================================-->
		<WTWEBPAGE name="15805" caption="Nexxus Support" header="false" footer="false" navbar="false" action="0" wrapper="wrapper800"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="15805" secured="1251">
			<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>
			<WTPARAM name="OrgID" datatype="number"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
          If reqDay &gt; 0 Then tmpToday = CStr(DateAdd("d", reqDay * -1, reqSysDate)) Else tmpToday = reqSysDate
					Select Case DATEPART("w", tmpToday )
					Case 1 reqToday = "Sunday "
					Case 2 reqToday = "Monday "
					Case 3 reqToday = "Tuesday "
					Case 4 reqToday = "Wednesday "
					Case 5 reqToday = "Thursday "
					Case 6 reqToday = "Friday "
					Case 7 reqToday = "Saturday "
					End Select
          reqToday = reqToday + tmpToday + " " + CStr(Time())
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(12)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
        <WTCONDITION expr="PARAM(OrgID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>			
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Orgs" project="ptsOrgUser" class="COrgs">
					<WTMETHOD name="ListActiveUsers">
						<WTPARAM name="CompanyID" direction="input" value="SYSCON(NEXXUS)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrgs" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="267" align="center"/>
				<WTCOLUMN width="267" align="center"/>
				<WTCOLUMN width="266" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NexxusSupportStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

        <WTROW>
					<WTTABLE col="1" merge="3">
						<WTCOLUMN width="800" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="80" align="right"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="11" height="24" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true" fontsize="3">
                      <WTCODEGROUP>
                        <WTCONDITION expr="PARAM(OrgID)" oper="equal" value="CONST(0)"/>
			        			    <WTSTATIC label="AllSupportTickets"/>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="PARAM(OrgID)" oper="not-equal" value="CONST(0)"/>
						            <WTSTATIC value="ATTR(Org.NameFirst)" space="1"/>
						            <WTSTATIC value="ATTR(Org.NameLast)" space="1"/>
                        <WTSTATIC label="SupportTickets"/>
                      </WTCODEGROUP>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTDIVIDER col="1" merge="11" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="1hr" bold="true"/>
									<WTSTATIC col="3" label="4hr" bold="true"/>
									<WTSTATIC col="4" label="12hr" bold="true"/>
									<WTSTATIC col="5" label="1day" bold="true"/>
									<WTSTATIC col="6" label="2day" bold="true"/>
									<WTSTATIC col="7" label="3day" bold="true"/>
									<WTSTATIC col="8" label="7day" bold="true"/>
									<WTSTATIC col="9" label="14day" bold="true"/>
									<WTSTATIC col="10" label="14+day" bold="true"/>
									<WTSTATIC col="11" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Submitted" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z1a)" fontcolor="green"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z1b)" fontcolor="green"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z1c)" fontcolor="orange"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z1d)" fontcolor="orange"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z1e)" fontcolor="purple"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z1f)" fontcolor="purple"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z1g)" fontcolor="red"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z1h)" fontcolor="red"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z1i)" fontcolor="red" bold="true"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z1t)" fontcolor="blue"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Assigned" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z2a)" fontcolor="green"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z2b)" fontcolor="green"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z2c)" fontcolor="orange"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z2d)" fontcolor="orange"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z2e)" fontcolor="purple"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z2f)" fontcolor="purple"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z2g)" fontcolor="red"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z2h)" fontcolor="red"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z2i)" fontcolor="red" bold="true"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z2t)" fontcolor="blue"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="InProcess" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z3a)" fontcolor="green"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z3b)" fontcolor="green"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z3c)" fontcolor="orange"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z3d)" fontcolor="orange"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z3e)" fontcolor="purple"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z3f)" fontcolor="purple"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z3g)" fontcolor="red"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z3h)" fontcolor="red"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z3i)" fontcolor="red" bold="true"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z3t)" fontcolor="blue"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTDIVIDER col="1" merge="11" height="1" color="#5084A2"/>
								</WTROW>
                <WTROW margin-bottom="6">
                  <WTSTATIC col="1" tag="Unresolved" align="right" fontcolor="blue"/>
                  <WTSTATIC col="2" value="ATTR(Stats.Z7a)" fontcolor="blue"/>
                  <WTSTATIC col="3" value="ATTR(Stats.Z7b)" fontcolor="blue"/>
                  <WTSTATIC col="4" value="ATTR(Stats.Z7c)" fontcolor="blue"/>
                  <WTSTATIC col="5" value="ATTR(Stats.Z7d)" fontcolor="blue"/>
                  <WTSTATIC col="6" value="ATTR(Stats.Z7e)" fontcolor="blue"/>
                  <WTSTATIC col="7" value="ATTR(Stats.Z7f)" fontcolor="blue"/>
                  <WTSTATIC col="8" value="ATTR(Stats.Z7g)" fontcolor="blue"/>
                  <WTSTATIC col="9" value="ATTR(Stats.Z7h)" fontcolor="blue"/>
                  <WTSTATIC col="10" value="ATTR(Stats.Z7i)" fontcolor="blue"/>
                  <WTSTATIC col="11" value="ATTR(Stats.Z7t)" fontcolor="blue"/>
                </WTROW>
<!--                
                <WTROW margin-bottom="6">
                  <WTSTATIC col="1" tag="Resolved" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.Z4a)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.Z4b)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.Z4c)"/>
                  <WTSTATIC col="5" value="ATTR(Stats.Z4d)"/>
                  <WTSTATIC col="6" value="ATTR(Stats.Z4e)"/>
                  <WTSTATIC col="7" value="ATTR(Stats.Z4f)"/>
                  <WTSTATIC col="8" value="ATTR(Stats.Z4g)"/>
                  <WTSTATIC col="9" value="ATTR(Stats.Z4h)"/>
                  <WTSTATIC col="10" value="ATTR(Stats.Z4i)"/>
                  <WTSTATIC col="11" value="ATTR(Stats.Z4t)"/>
                </WTROW>
                <WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Postponed" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z5a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z5b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z5c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z5d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z5e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z5f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z5g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z5h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z5i)"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z5t)"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTDIVIDER col="1" merge="11" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z6a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z6b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z6c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z6d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z6e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z6f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z6g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z6h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z6i)"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z6t)"/>
								</WTROW>
-->                
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTSTATIC col="1" tag="OrgID" align="center"/>
					<WTTEXT col="1" value="PARAM(OrgID)" size="4" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

      	<WTROW>
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="200" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="100" align="center"/>
                <WTCOLUMN width="100" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="2" height="24" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC label="DailyResolvedTickets" fontcolor="darkblue" bold="true"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="2" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Today" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD1)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Yesterday" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD2)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="2DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD3)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="3DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD4)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="4DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD5)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="5DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD6)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="6DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD7)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="7DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD8)"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>

          <WTTABLE col="2" valign="top">
            <WTCOLUMN width="200" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="80" align="right"/>
                <WTCOLUMN width="60" align="center"/>
                <WTCOLUMN width="60" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="3" height="24" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC label="ResolvedTicketDays" fontcolor="darkblue" bold="true"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="3" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="SameDay" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR1)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP1)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="NextDay" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR2)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP2)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="2Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR3)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP3)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="3Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR4)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP4)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="4Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR5)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP5)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="5Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR6)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP6)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="6Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR7)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP7)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="6+Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR8)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP8)"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>

          <WTTABLE col="3" valign="top">
            <WTCOLUMN width="200" align="center"/>
            <WTROW margin-bottom="6">
              <WTRECORDSET col="1" graybar="true" entity="Org" valign="top">
                <WTCOLUMN width="40" align="center" label="OrgID"/>
                <WTCOLUMN width="60" align="left" label="StaffName"/>
                <WTROW>
                  <WTSTATIC col="1" value="DATA(Org.OrgID)" align="center"/>
                  <WTSTATIC col="2" value="DATA(Org.NameFirst)" align="left"/>
                </WTROW>
              </WTRECORDSET>
            </WTROW>
          </WTTABLE>

        </WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="NexxusProduct" caption="Nexxus Products" page-left="5" page-top="5" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false" secure="52">
      <!--==================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Product" datatype="number"/>
      <WTPARAM name="Language" datatype="text"/>

      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(Language)" oper="equal" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Language)" value="CONST(&quot;en&quot;)"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="SYSCON(NEXXUS)"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsEmployee"/>
        <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
        <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="CONST(37702)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTSETATTRIBUTE name="PARAM(Product)" value="CONST(0)"/>
        <!-- Override Company Member Accounts -->
        <WTSETATTRIBUTE name="PARAM(Product)" value="CONST(205)">
          <!-- Company, Joe Blow, Gary B, Bill R, Kelly B, Kelly Ann, Jim A, Mike S, Kalpesh, Elizebeth, Raul, Jhoanna, Robert Cadle, Michael Bailey, Kenny Martin, Rosalinda Burton -->
          <WTCONDITION expr="CONST(InStr( &quot;38567,37702,37703,37704,37720,37731,38886,39060,39501,39431,37801,39045,37823,37736,39229,39032 &quot;, reqMemberID))" oper="greater" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTCONDITION expr="PARAM(Product)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(501)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="reqProduct" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Product&quot; + CStr(reqProduct) + &quot;.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID) + &quot;\Products&quot; )"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(Language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
            <WTCUSTOM>
              xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqMemberID) )
            </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCODEGROUP>
          <WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTSTATIC newline="2" />
          <WTBUTTON valuex="Close Window" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTCODEGROUP>
      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="NexxusCertify" caption="Certification Program" page-left="5" page-top="5" navbar="false" header="false" footer="false" page-image="bg.jpg"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false">
      <!--==================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Product" datatype="number"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="SYSCON(NEXXUS)"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsEmployee"/>
        <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
        <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="CONST(37702)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTSETATTRIBUTE name="PARAM(Product)" value="CONST(0)"/>
        <!-- Override Company Member Accounts -->
        <WTSETATTRIBUTE name="PARAM(Product)" value="CONST(205)">
          <WTCONDITION expr="CONST(InStr( &quot;37702,37703,37704,37720,37731&quot;, reqMemberID))" oper="greater" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTCONDITION expr="PARAM(Product)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(501)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(1)"/>
            <WTPARAM name="reqProduct" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Product&quot; + CStr(reqProduct) + &quot;.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID) + &quot;\Products&quot; )"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="CONST(en)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>
      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCODEGROUP>
          <WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTSTATIC newline="2" />
          <WTBUTTON value="CONST(CloseWindow)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTCODEGROUP>
      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="RewardsCertify" caption="Rewards Certify" page-left="5" page-top="5" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false" secure="52">
      <!--==================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Language" datatype="text"/>

      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(Language)" oper="equal" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Language)" value="CONST(&quot;en&quot;)"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="SYSCON(NEXXUS)"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsEmployee"/>
        <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
        <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="CONST(37702)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;RewardsCertify.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID) + &quot;\Products&quot; )"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(Language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
          <WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqMemberID) )
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>
      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCODEGROUP>
          <WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTSTATIC newline="2" />
          <WTBUTTON value="CONST(CloseWindow)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTCODEGROUP>
      </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Retail Order Form -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusOrder" caption="New Customer" navbar="false" header="false" footer="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusOrder">
      <!--============================================================================================-->
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="NewMemberID" datatype="number"/>
      <WTPARAM name="BillingID" datatype="number"/>
      <WTPARAM name="PayID" datatype="number"/>
      <WTPARAM name="GroupID" datatype="number"/>
      <WTPARAM name="ReferID" datatype="number"/>
      <WTPARAM name="IsAgree" datatype="number"/>
      <WTPARAM name="IsAgree2" datatype="number"/>
      <WTPARAM name="PayType" datatype="number"/>
      <WTPARAM name="ReferredBy" datatype="text"/>
      <WTPARAM name="Title" datatype="number"/>
      <WTPARAM name="Membership" datatype="number"/>
      <WTPARAM name="OrderOption" datatype="number"/>
      <WTPARAM name="Retail" datatype="number"/>
      <WTPARAM name="PaymentOptions" datatype="text" />
      <WTPARAM name="Option" datatype="number"/>
      <WTPARAM name="Billing" datatype="number"/>
      <WTPARAM name="BillDay" datatype="number"/>
      <WTPARAM name="Reference" datatype="text" />

      <WTPARAM name="NoBill" datatype="number"/>
      <WTPARAM name="NoBanner" datatype="number"/>
      <WTPARAM name="NoPayment" datatype="number"/>
      <WTPARAM name="NoRefer" datatype="number"/>
      <WTPARAM name="NoValidate" datatype="number"/>
      <WTPARAM name="TextEmail" datatype="number"/>
      <WTPARAM name="NoPayout" datatype="number"/>
      <WTPARAM name="GetMemberID" datatype="number"/>
      <WTPARAM name="BillOneTime" datatype="number"/>
      <WTPARAM name="AutoShipMonths" datatype="number"/>
      <WTPARAM name="RegisterWallet" datatype="number"/>

      <!-- Referring Member -->
      <WTPARAM name="M" datatype="number"/>
      <!-- Gift Certificate -->
      <WTPARAM name="G" datatype="number"/>
      <!-- Promocode -->
      <WTPARAM name="P" datatype="text"/>
      <WTPARAM name="GiftAmt" datatype="number"/>
      <WTPARAM name="GiftAmtRetail" datatype="number"/>
      <!-- Sponsor -->
      <WTPARAM name="S" datatype="number"/>
      <!-- CompanyID -->
      <WTPARAM name="C" datatype="number"/>
      <!-- Sponsor3ID (Binary) -->
      <WTPARAM name="S3" datatype="number"/>
      <WTPARAM name="Pos" datatype="number"/>
      <WTPARAM name="Placement" datatype="text"/>

      <WTPARAM name="Street1b" datatype="text"/>
      <WTPARAM name="Street2b" datatype="text"/>
      <WTPARAM name="Cityb" datatype="text"/>
      <WTPARAM name="Stateb" datatype="text"/>
      <WTPARAM name="Zipb" datatype="text"/>
      <WTPARAM name="CountryIDb" datatype="text"/>
      <WTPARAM name="CountryID" datatype="text"/>
      <WTPARAM name="CountryName" datatype="text"/>
      <WTPARAM name="CountryNameb" datatype="text"/>

      <WTPARAM name="TokenType" datatype="number"/>
      <WTPARAM name="TokenOwner" datatype="number"/>
      <WTPARAM name="Token" datatype="number"/>
      <WTPARAM name="PayDesc" datatype="text"/>
      <WTPARAM name="Mode" datatype="number"/>
      <WTPARAM name="BadPayment" datatype="number"/>
      <WTPARAM name="CashPayment" datatype="number"/>
      <WTPARAM name="Wallet" datatype="text"/>
      <WTPARAM name="NotifyCompany" datatype="text"/>
      <WTPARAM name="IsCaptcha" datatype="number"/>
      <WTPARAM name="Captcha" datatype="text"/>

      <WTPARAM name="Existing" datatype="number"/>

      <WTPARAM name="Price1" datatype="text"/>
      <WTPARAM name="Price2" datatype="text"/>
      <WTPARAM name="Price3" datatype="text"/>
      <WTPARAM name="Price4" datatype="text"/>
      <WTPARAM name="Promo" datatype="text"/>

      <!-- Mode 0 ... Agreement -->
      <!-- Mode 4 ... Confirmation -->
      <!-- Mode 5 ... Process/Welcome -->

      <WTINCLUDE name="Email.asp"/>
      <WTINCLUDE name="Billing.asp"/>
      <WTINCLUDE name="Payment.asp"/>
      <WTINCLUDE name="Note.asp"/>

      <WTINCLUDE name="Comm.asp"/>
      <WTINCLUDE name="CommissionEmail.asp"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(C)" value="SYSCON(NEXXUS)"/>
      </WTCODEGROUP>

      <WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(P)" oper="not-equal" value="CONST(&quot;&quot;)" />
          <WTCUSTOM>
            pos = InStr(reqP, "-")
            If pos > 0 Then
            reqM = Left( reqP, pos-1)
            reqG = Mid( reqP, pos+1, Len(reqP)-pos)
            End If
          </WTCUSTOM>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
        </WTCODEGROUP>

        <WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)">
          <WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)" />
        </WTSETATTRIBUTE>

        <WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
        <WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(0)" />
          <WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
          <WTGETCACHE name="PARAM(M)" value="A" datatype="number"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
          <WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MemberID)"/>
        </WTCODEGROUP>
        <!-- If no referring member then use Nexxus University #37702 -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
          <WTSETATTRIBUTE name="PARAM(M)" value="CONST(37702)"/>
        </WTCODEGROUP>
<!--
        <WTCODEGROUP>
          <WTCONDITION expr="SYS(CompanyID)" oper="equal" value="SYSCON(NEXXUS)" />
          <WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
          <WTSETATTRIBUTE name="PARAM(M)" value="CONST(37702)"/>
        </WTCODEGROUP>
  -->
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
        <WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
<!--
        <WTSETATTRIBUTE name="PARAM(S)" value="PARAM(M)">
          <WTCONDITION expr="PARAM(S)" oper="equal" value="CONST(0)" />
        </WTSETATTRIBUTE>
-->
        <WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)">
          <WTCONDITION expr="PARAM(CountryIDb)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(&quot;No Referrer&quot;)">
          <WTCONDITION expr="PARAM(NoRefer)" oper="not-equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>

        <WTSETATTRIBUTE name="CONST(ValidMemberStatus)" value="CONST(&quot;1234&quot;)"/>

        <WTCODEGROUP>
          <WTCONDITION expr="IsEmployee"/>
          <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
          <WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <!-- Custom Company Setup -->
      <WTCODEGROUP>
        <!-- Nexxus -->
        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
        <WTSETATTRIBUTE name="PARAM(BillOneTime)" value="CONST(1)"/>
      </WTCODEGROUP>
      
      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(Promo)" oper="equal" value="CONST(&quot;&quot;)" />
        <WTGETCACHE name="CONST(tmpPromo)" value="PROMO"/>
        <WTSETATTRIBUTE name="PARAM(Promo)" value="CONST(tmpPromo)">
          <WTCONDITION expr="CONST(tmpPromo)" oper="not-equal" value="CONST(&quot;&quot;)" />
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadCompanyOptions">
        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadCountrys">
        <WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
          <WTMETHOD name="EnumCompany">
            <WTPARAM name="xmlCountrys" direction="return" datatype="text" />
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
            <WTPARAM name="ItemID" direction="input" value="CONST()" />
            <WTPARAM name="Element" direction="input" value="CONST()" />
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadPaymentOptions">
        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadAgree">
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Enroll2.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)">
            <WTCONDITION expr="ATTR(IsCompany)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="PARAM(ReferredBy)" value="ATTR(CompanyName)">
            <WTCONDITION expr="ATTR(IsCompany)" oper="not-equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCUSTOM>
            If InStr( ValidMemberStatus, .Status ) = 0 Then
            Response.Write "The Member that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
            Response.End
            End If
          </WTCUSTOM>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Promo)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            <WTCUSTOM>
              pos = InStr(reqPromo, "-")
              If pos > 0 Then
              tmpMemberID = Left( reqPromo, pos-1)
              tmpPromoCode = Mid( reqPromo, pos+1, Len(reqPromo)-pos)
              If tmpMemberID = .MemberID Then
              If tmpPromoCode = "10" Then
              reqPrice1 = "$8.95"
              reqPrice2 = "$22.45"
              reqPrice3 = "$71.95"
              reqPrice4 = "$89.95"
              End If
              If tmpPromoCode = "20" Then
              reqPrice1 = "$7.95"
              reqPrice2 = "$19.45"
              reqPrice3 = "$63.95"
              reqPrice4 = "$79.95"
              End If
              If tmpPromoCode = "25" Then
              reqPrice1 = "$7.45"
              reqPrice2 = "$18.75"
              reqPrice3 = "$59.95"
              reqPrice4 = "$74.95"
              End If
              If tmpPromoCode = "30" Then
              reqPrice1 = "$6.95"
              reqPrice2 = "$17.45"
              reqPrice3 = "$55.95"
              reqPrice4 = "$69.95"
              End If
              If tmpPromoCode = "40" Then
              reqPrice1 = "$5.95"
              reqPrice2 = "$14.95"
              reqPrice3 = "$47.95"
              reqPrice4 = "$59.95"
              End If
              If tmpPromoCode = "50" Then
              reqPrice1 = "$4.95"
              reqPrice2 = "$12.45"
              reqPrice3 = "$39.95"
              reqPrice4 = "$55.00"
              End If
              End If
              End If
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
            <WTMETHOD name="Load">
              <WTPARAM name="MemberID" direction="input" value="PARAM(S3)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(TRIM(.NameFirst + &quot; &quot; + .NameLast))"/>
            <WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(reqPlacement + &quot; (Left Side)&quot;)">
              <WTCONDITION expr="PARAM(Pos)" oper="equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(reqPlacement + &quot; (Right Side)&quot;)">
              <WTCONDITION expr="PARAM(Pos)" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidLogon">
        <WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
        <WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(6)" connector="and"/>
          <WTERROR number="10101" message="Oops, Your Logon Name must be at least six characters/numbers long."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(6)" connector="and"/>
          <WTERROR number="10102" message="Oops, Your Password must be at least six characters/numbers long."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
          <WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
            <WTMETHOD name="IsLogon">
              <WTPARAM name="IsAvailable" direction="return" datatype="number"/>
              <WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
            </WTMETHOD>
          </WTOBJECT>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
            <WTERROR number="-2147220513" message="Oops, The Logon/Website Name is not available.  Please select another or contact Member Support for assistance."/>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidAddress">
        <WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
          <WTCONDITION expr="NoErrors" />
          <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
          <WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
          <WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
          <WTSETATTRIBUTES/>
          <WTMETHOD name="Validate">
            <WTPARAM name="New" direction="input" value="CONST(1)" />
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidPhone">
        <WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
          <WTERROR number="10006" message="Oops, Phone Number is Required."/>
        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidBilling">
        <!-- Validate Card Number if paying by Credit Card -->
        <WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
        <WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
        <WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

        <WTOBJECT name="Payment" project="wtPayment" class="CPayment">
          <WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
          <WTMETHOD name="ValidCheckRoute">
            <WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
            <WTPARAM name="result" direction="return" datatype="number" />
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
            <WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
          </WTCODEGROUP>
        </WTOBJECT>
        <WTOBJECT name="Payment" project="wtPayment" class="CPayment">
          <WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
          <WTMETHOD name="ValidCardNumber">
            <WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
            <WTPARAM name="result" direction="return" datatype="number" />
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
            <WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
            <WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
          </WTCODEGROUP>
          <WTCODEGROUP>
            <!-- check for visa, mc, diners, amex -->
            <WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
            <WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
            <WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
            <WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
            <WTSETATTRIBUTE name="CONST(reqPayType)" value="CONST(CLng(result))" />
            <!-- <WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
          </WTCODEGROUP>
          <WTCODEGROUP>
            <!-- All other credit cards are not allowed -->
            <WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
            <WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
          </WTCODEGROUP>
        </WTOBJECT>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors" />
          <WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
          <WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
          <WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
          <WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
          <WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
          <WTCODEGROUP>
            <!-- check for current card date -->
            <WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
            <WTERROR number="10013" message="Oops, Credit Card date has expired." />
          </WTCODEGROUP>
        </WTCODEGROUP>

        <WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
        <WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
        <WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
          <WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
        </WTOBJECT>

        <WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTCONDITION expr="NoErrors" />
  <!-- 	  <WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>-->
          <WTMETHOD name="Load">
            <WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
            <WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
            <WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
            <WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
            <WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
            <WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
            <WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
            <WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
            <WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
            <WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
            <WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
            <WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
            <WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
            <WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
            <WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
            <WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpPayType)" oper="greater-equal" value="SYSCON(PAYTYPE-WALLET)" />
            <WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
            <WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
            <WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Wallet)" />
          </WTCODEGROUP>
          <WTMETHOD name="Validate">
            <WTCONDITION expr="NoErrors"/>
            <WTPARAM name="New" direction="input" value="CONST(1)" />
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
            <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
            <WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
            <WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
            <WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
            <WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
            <WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
            <WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
            <WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
            <WTMETHOD name="Save">
              <WTCONDITION expr="NoErrors"/>
              <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTMETHOD name="Add">
              <WTCONDITION expr="NoErrors"/>
              <WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
              <WTPARAM name="reqBillingID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="NoErrors"/>
              <WTCALLSUB name=".Token = SetVault( reqCompanyID, reqBillingID )"/>
              <WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="AddMember">
        <!-- get company options -->
        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpPrice1)" value="ATTR(Price)"/>
          <WTSETATTRIBUTE name="CONST(tmpPrice2)" value="ATTR(Price2)"/>
          <WTSETATTRIBUTE name="CONST(tmpPrice3)" value="ATTR(Price3)"/>
          <WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
          <WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
          <WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
          <WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
          <WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
          <WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
          <WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
          <WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
          <WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
          <WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
        </WTOBJECT>

        <!-- get referrer's group # -->
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
          <WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email2)"/>
          <WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email)">
            <WTCONDITION expr="CONST(InStr(ReferEmail, &quot;@&quot;))" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
        </WTOBJECT>
        <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
          <WTMETHOD name="Load">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(CompanyEmail)" value="ATTR(Email)"/>
          <WTSETATTRIBUTE name="PARAM(NotifyCompany)" value="ATTR(Email)">
            <WTCONDITION expr="PARAM(NotifyCompany)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
        </WTOBJECT>

        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTES/>

          <WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;IPL:3&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
          <WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(Price)"/>
          <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)">
            <WTCONDITION expr="PARAM(BillDay)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
            <WTCUSTOM>
              mo = DATEPART( "m", DATE())
              yr = DATEPART( "yyyy", DATE())
              If reqBillDay = 1 Then
              tmpDate = CSTR(mo) + "/1/" + CSTR(yr)
              .PaidDate = DateAdd( "m", 1, tmpDate )
              Else
              .PaidDate = CSTR(mo) + "/" + CSTR(reqBillDay) + "/" + CSTR(yr)
              End If
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
          <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;Enrollment&quot;)"/>

          <!-- Custom Company Setup -->
          <WTCODEGROUP>
            <!-- NEXXUS -->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
            <WTCODEGROUP>
              <!-- Cryptocurrency Fundamentals Certification Program -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;205&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;205&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(99.95)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price4)">
                <WTCONDITION expr="PARAM(Price4)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpPrice)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(tmpPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Cryptocurrency Fundamentals All Courses -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;204&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;204&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(79.95)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price3)">
                <WTCONDITION expr="PARAM(Price3)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpPrice)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(tmpPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Cryptocurrency Fundamentals - History of Money Course -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;201&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;201&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(24.95)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price2)">
                <WTCONDITION expr="PARAM(Price2)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpPrice)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(tmpPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Cryptocurrency Fundamentals - Bitcoin Solution Course -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;202&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;202&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(24.95)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price2)">
                <WTCONDITION expr="PARAM(Price2)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpPrice)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(tmpPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Cryptocurrency Fundamentals - Understanding Cryptocurrency Course -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;203&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;203&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(24.95)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price2)">
                <WTCONDITION expr="PARAM(Price2)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpPrice)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(tmpPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Cryptocurrency Fundamentals - Cryptocurrency Introduction Course -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;200&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;200&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(9.95)"/>
              <WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price1)">
                <WTCONDITION expr="PARAM(Price1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpPrice)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(tmpPrice)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
            <WTMETHOD name="Save">
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
            <WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
            <WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="ATTR(Billing)" value="PARAM(Billing)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Billing)" oper="equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
              <WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(1)">
                <WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
            <WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
            <WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
            <WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
              <WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCG&quot;)"/>

            <WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
            <WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>

            <WTMETHOD name="Add">
              <WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(G)" oper="greater" value="CONST(0)"/>
				    <WTOBJECT name="Gift" project="ptsGiftUser" class="CGift">
					    <WTMETHOD name="Load">
						    <WTPARAM name="GiftID" direction="input" value="PARAM(G)"/>
						    <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					    </WTMETHOD>
              <WTSETATTRIBUTE name="ATTR(Member2ID)" value="PARAM(NewMemberID)" />
              <WTSETATTRIBUTE name="ATTR(ActiveDate)" value="SYS(Date)" />
              <WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(Purpose)" />
              <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;&quot;)" />
              <WTMETHOD name="Save">
						    <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					    </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
          
          <!-- Get Payment -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
            <WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
            <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
            <!-- Payment Post Processing is done after the new member is activated below -->
            <WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
            <WTCUSTOM>
              tmpProcessor = 0
              tmpAcct = ""
              Select Case reqPayType
              Case 1, 2, 3, 4	'Process Credit Cards
              tmpProcessor = tmpCardProcessor
              tmpAcct = tmpCardAcct
              Case 5 'Process Electronic Checks
              tmpProcessor = tmpCheckProcessor
              tmpAcct = tmpCheckAcct
              Case 11, 12, 13 'Process Wallets
              tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
              End Select
            </WTCUSTOM>
            <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqNewMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
              <WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(BillOneTime)" oper="not-equal" value="CONST(1)"/>
                <WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))">
                  <WTCONDITION expr="PARAM(AutoShipMonths)" oper="equal" value="CONST(0)"/>
                </WTSETATTRIBUTE>
                <WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, reqAutoShipMonths, .PaidDate))">
                  <WTCONDITION expr="PARAM(AutoShipMonths)" oper="not-equal" value="CONST(0)"/>
                </WTSETATTRIBUTE>
                <WTMETHOD name="Save">
                  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
                </WTMETHOD>
              </WTCODEGROUP>
            </WTCODEGROUP>
          </WTCODEGROUP>

          <!-- Send Welcome Email w/ Logon and Password -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="CONST(tmpSendEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
            <WTCONDITION expr="PARAM(Existing)" oper="equal" value="SYSCON(NO)" connector="and"/>
            <WTCUSTOM>
              Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
              If oHTTP Is Nothing Then
              Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
              Else
              oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
              oHTTP.send
              End If
              Set oHTTP = Nothing
            </WTCUSTOM>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>

            <!-- Send notice to Referrer -->
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(ReferEmail)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              <WTCONDITION expr="PARAM(Existing)" oper="equal" value="SYSCON(NO)" connector="and"/>
              <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
              <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
              <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
              <WTCUSTOM>
                If reqG = 0 Then
                tmpSubject = "NEW REFERRED CUSTOMER: " + tmpNameFirst + " " + tmpNameLast + " - " + tmpEmail
                Else
                tmpSubject = "NEW REFERRED COURSE CERTIFICATE CUSTOMER: " + tmpNameFirst + " " + tmpNameLast + " - " + tmpEmail
                End If
                tmpBody = ""
                SendEmail reqCompanyID, CompanyEmail, CompanyEmail, ReferEmail, "", "", tmpSubject, tmpBody
              </WTCUSTOM>
            </WTCODEGROUP>

          </WTCODEGROUP>

        </WTOBJECT>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(Existing)" oper="equal" value="SYSCON(NO)" connector="and"/>
          <WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
            <WTMETHOD name="Load">
              <WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(NewMemberID)"/>
            <WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
            <WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
            <WTSETATTRIBUTES/>
            <WTMETHOD name="Add">
              <WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              <WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>

          <!-- Custom Company Activation Processing -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Existing)" oper="equal" value="SYSCON(NO)"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(100)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Custom Company Payment Post Processing -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
            <WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
            <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
            <WTCALLSUB name="CommissionEmail reqCompanyID, PaymentID, 0, 0, tmpTotal">
              <WTCONDITION expr="CONST(EmailBonuses)" oper="not-equal" value="CONST(0)"/>
            </WTCALLSUB>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <WTCALLSUB name="LogMemberNote reqNewMemberID, &quot;ENROLL ERROR: &quot; + err.description + xmlError">
          <WTCONDITION expr="IsErrors"/>
          <WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
        </WTCALLSUB>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Existing)" oper="equal" value="SYSCON(NO)"/>
            <WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)"/>
            <WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)"/>
            <WTSETATTRIBUTE name="ATTR(CompanyName)" value="FORM(CompanyName)"/>
            <WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
            <WTSETATTRIBUTE name="ATTR(Email2)" value="FORM(Email2)"/>
            <WTSETATTRIBUTE name="ATTR(Phone1)" value="FORM(Phone1)"/>
            <WTSETATTRIBUTE name="ATTR(NewLogon)" value="FORM(NewLogon)"/>
            <WTSETATTRIBUTE name="ATTR(NewPassword)" value="FORM(NewPassword)"/>
          </WTCODEGROUP>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
          <WTMETHOD name="Load">
            <WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTES/>
          <WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
            <WTCONDITION expr="CONST(Len(.CountryID))" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlAddress" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTMETHOD name="Load">
            <WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)"/>
          <WTSETATTRIBUTE name="ATTR(PayType)" value="PARAM(PayType)">
            <WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(&quot;&quot;)"/>
            <WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(&quot;0&quot;)" connector="or"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTES/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlBilling" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadLists">
        <WTCALLSUB name="LoadAgree"/>
        <WTCALLSUB name="LoadCountrys"/>
        <WTCALLSUB name="LoadPaymentOptions"/>
        <WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
          <WTCONDITION expr="NoErrors"/>
          <WTMETHOD name="Load">
            <WTPARAM name="CountryID" direction="input" value="PARAM(CountryID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(CountryName)" value="ATTR(CountryName)" />
          <WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="PARAM(CountryIDb)"/>
            <WTMETHOD name="Load">
              <WTPARAM name="CountryID" direction="input" value="PARAM(CountryIDb)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="DuplicateEmail">
        <!-- Look for email in free members only-->
        <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
        <WTSETATTRIBUTE name="CONST(tmpEmail)" value="CONST(&quot;**&quot; + tmpEmail)"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="ExistEmail">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
            <WTPARAM name="MemberID" direction="return" datatype="number"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(MemberID)" oper="not-equal" value="CONST(0)"/>
            <WTERROR number="10123" message="Oops, This email address is already assigned to someone else."/>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="ValidateContact">
        <WTCALLSUB name="LoadCompanyOptions">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
        <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
        <WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
        <WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTERROR number="10125" message="Oops, Please enter a First Name."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTERROR number="10126" message="Oops, Please enter a Last Name."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
          <WTCUSTOM>
            If ValidEmail( tmpEmail ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
          </WTCUSTOM>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCALLSUB name="DuplicateEmail"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(LEN(tmpPassword))" oper="less" value="CONST(6)"/>
            <WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
          </WTCODEGROUP>
        </WTCODEGROUP>
        <WTCALLSUB name="ValidAddress">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidPhone">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidLogon">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
      </WTSUB>

      <WTSUB name="ValidateCustomer">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Status)" oper="not-equal" value="CONST(3)"/>
            <WTERROR number="10155" message="Oops, Invalid Customer #."/>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="ValidateMembership">
      </WTSUB>

      <WTSUB name="ValidatePayment">
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)" connector="and"/>
          <WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
          <WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="CONST(lcase(tmpCardNumber))" />
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)"/>
            <WTERROR number="10128" message="Oops, You must agree to the payment terms."/>
          </WTCODEGROUP>
          <WTCALLSUB name="ValidBilling">
            <WTCONDITION expr="NoErrors"/>
          </WTCALLSUB>
        </WTCODEGROUP>
      </WTSUB>

      <WTSUB name="ValidateGift">
				<WTOBJECT name="Gift" project="ptsGiftUser" class="CGift">
					<WTMETHOD name="Load">
						<WTPARAM name="GiftID" direction="input" value="PARAM(G)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Member2ID)" oper="not-equal" value="SYSCON(NO)"/>
            <WTSETATTRIBUTE name="PARAM(G)" value="CONST(-1)" />
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(CSTR(reqMemberID))"/>
            <WTSETATTRIBUTE name="PARAM(G)" value="CONST(-2)" />
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(G)" oper="greater" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)" />
            <WTSETATTRIBUTE name="PARAM(GiftAmt)" value="ATTR(Amount)" />
            <WTSETATTRIBUTE name="PARAM(GiftAmtRetail)" value="CONST(9.95)">
              <WTCONDITION expr="ATTR(Amount)" oper="equal" value="CONST(2)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(GiftAmtRetail)" value="CONST(24.95)">
              <WTCONDITION expr="ATTR(Amount)" oper="equal" value="CONST(10)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(GiftAmtRetail)" value="CONST(79.95)">
              <WTCONDITION expr="ATTR(Amount)" oper="equal" value="CONST(25)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(GiftAmtRetail)" value="CONST(99.95)">
              <WTCONDITION expr="ATTR(Amount)" oper="equal" value="CONST(50)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>
      
      <WTSUB name="ValidateConfirm">
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(IsCaptcha)" oper="not-equal" value="CONST(0)"/>
          <WTSETATTRIBUTE name="CONST(TestCaptcha)" value="FORM(Captcha)" />
          <WTCUSTOM>
            If IsEmpty(Session("ASPCAPTCHA")) or Trim(Session("ASPCAPTCHA")) = "" Then
            DoError 0, "", "Oops, Your time has expired! Please reenter."
            else
            ' Uppercase fix for turkish charset
            TestCaptcha = Replace(TestCaptcha, "i", "I", 1, -1, 1)
            TestCaptcha = Replace(TestCaptcha, "İ", "I", 1, -1, 1)
            TestCaptcha = Replace(TestCaptcha, "ı", "I", 1, -1, 1)
            TestCaptcha = UCase(TestCaptcha)

            If StrComp(TestCaptcha, Trim(Session("ASPCAPTCHA")), 1) &lt;&gt; 0 Then
            DoError 0, "", "Oops, You entered the wrong security answer! Please reenter."
            reqCaptcha = ""
            End If
            ' IMPORTANT: Must remove session value for security after the CAPTCHA test
            Session("ASPCAPTCHA") = vbNullString
            Session.Contents.Remove("ASPCAPTCHA")
            End If
          </WTCUSTOM>
        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="ValidateGift">
          <WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
        </WTCALLSUB>
        <WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
          <WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(G)" oper="greater" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
              <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(50)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(2)">
              <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(25)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(3)">
              <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(10)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(6)">
              <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(2)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>
        </WTCODEGROUP>
        <WTCALLSUB name="LoadMember"/>
        <WTCALLSUB name="LoadLists"/>
        <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-AGREE)">
          <WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTCONDITION expr="PARAM(G)" oper="greater-equal" value="CONST(0)" connector="and"/>
        </WTSETATTRIBUTE>
      </WTACTION>

      <WTACTION id="1" name="Submit" type="New">
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Existing)" oper="equal" value="SYSCON(NO)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
            <WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
          </WTCODEGROUP>
          <WTCALLSUB name="ValidateContact">
            <WTCONDITION expr="NoErrors"/>
          </WTCALLSUB>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Existing)" oper="not-equal" value="SYSCON(NO)"/>
          <WTCALLSUB name="ValidateCustomer">
            <WTCONDITION expr="NoErrors"/>
          </WTCALLSUB>
        </WTCODEGROUP>
        <WTCALLSUB name="ValidateMembership">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidatePayment">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidateConfirm">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidateGift">
          <WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
        </WTCALLSUB>
        <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONFIRM)">
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(G)" oper="greater-equal" value="CONST(0)" connector="and"/>
        </WTSETATTRIBUTE>
        <WTCALLSUB name="LoadMember"/>
        <WTCALLSUB name="LoadLists">
          <WTCONDITION expr="IsErrors"/>
        </WTCALLSUB>
      </WTACTION>

      <WTACTION id="2" name="Process" type="Add">
        <WTCALLSUB name="Addmember">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCODEGROUP>
          <WTCONDITION expr="IsErrors"/>
          <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-AGREE)"/>
          <WTCALLSUB name="LoadMember"/>
          <WTCALLSUB name="LoadLists"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PROCESS)"/>
          <WTSETATTRIBUTE name="CONST(tmpLogon)" value="FORM(NewLogon)"/>
          <WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Existing)" oper="not-equal" value="SYSCON(NO)"/>
            <WTSETATTRIBUTE name="CONST(tmpLogon)" value="CONST(&quot;Existing&quot;)"/>
            <WTSETATTRIBUTE name="CONST(tmpPassword)" value="CONST(&quot;Existing&quot;)"/>
          </WTCODEGROUP>
          <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
            <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Welcome2.htm&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
            <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
            <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
            <WTMETHOD name="Load" />
            <WTMETHOD name="XML">
              <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
            </WTMETHOD>
            <WTCUSTOM>
              xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqNewMemberID) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
              xmlHTMLFile = Replace( xmlHTMLFile, "{pwd}", tmpPassword )
            </WTCUSTOM>
          </WTOBJECT>
        </WTCODEGROUP>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="50" align="right"/>
        <WTCOLUMN width="160" align="right"/>
        <WTCOLUMN width="540" align="left"/>

        <WTFUNCTION name="ToggleType()">
          var payobj = Nexxus.elements['PayType'];
          if( payobj != null ) {
          var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleCash = 'none'; var VisibleWallet = 'none'; var VisibleBitCoin = 'none'; var VisibleAddress = 'none';
          var paytype=1;
          var l = payobj.length;
          if( l == null ) {
          if( payobj.checked ) {
          paytype = payobj.value
          }
          }
          else {
          for( i = 0; i &lt; l; i++ ) {
          if (payobj[i].checked) {
          paytype = payobj[i].value;
          i = l;
          }
          }
          }
          if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
          if (paytype == 5) VisibleCheck = '';
          if (paytype == 7) VisibleCash = '';
          if (paytype &lt;= 5) VisibleAddress = '';
          if (paytype &gt;= 11 &amp;&amp; paytype &lt;= 13) VisibleWallet = '';
          if (paytype == 14) VisibleBitCoin = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          document.getElementById('BitCoinRows').style.display = VisibleBitCoin;
          document.getElementById('CashRows').style.display = VisibleCash;
          document.getElementById('BillingAddress').style.display = VisibleAddress;
          }
        </WTFUNCTION>

        <WTFUNCTION name="CheckType(val)">
          var payobj = Nexxus.elements['PayType'];
          if( payobj != null ) {
          var l = payobj.length;
          for( i = 0; i &lt; l; i++ ) {
          if (payobj[i].value == val) {
          payobj[i].checked=true;
          i = l;
          }
          }
          ToggleType();
          }
        </WTFUNCTION>

        <!--				
				  <WTFUNCTION name="ShowTaxIDType()">
					  var countryid = document.getElementById('CountryID').value;
					  if( countryid == 224 ) {
						  document.getElementById('TaxIDType1').style.display = '';
						  document.getElementById('TaxIDType2').style.display = 'none';
					  }	
					  else {
						  document.getElementById('TaxIDType1').style.display = 'none';
						  document.getElementById('TaxIDType2').style.display = '';
					  }	
				  </WTFUNCTION>
  -->
        <!--
				  <WTFUNCTION name="CheckType(val)">
					  ToggleType();
				  </WTFUNCTION>
  -->
        <WTFUNCTION name="TitleCase(obj)">
          var val = obj.value;
          if ( val.length == 2 ) {
          obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
          }
          else {
          obj.value = val.charAt(0).toUpperCase() + val.slice(1);
          }
        </WTFUNCTION>

        <WTFUNCTION name="FormatPhone(obj)">
          var val = obj.value;
          var newval = val.replace(/[^\d]/g, '');
          if( newval.length == 10 ) {
          obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
          }
          if( newval.length == 11 ) {
          obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
          }
          if( newval.length == 12 ) {
          obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
          }
        </WTFUNCTION>
        <!--				
				  <WTFUNCTION name="FormatTaxID(obj)">
					  var countryid = document.getElementById('CountryID').value;
					  var taxidtype = document.getElementById('TaxIDType1').value;
					  var val = obj.value;
					  var newval = val.replace(/[^\d]/g, ''); 
					  if( countryid == 224 ) {
						  if( taxidtype == 1 ) {
							  if( newval.length &lt; 9 ) {
								  alert('Oops, Invalid Social Security Number'); }
							  else {
								  obj.value = newval.substring(0,3) + '-' + newval.substring(3,5) + '-' + newval.substring(5,9);
							  }
						  }
						  if( taxidtype == 2 ) {
							  if( newval.length &lt; 9 ) {
								  alert('Oops, Invalid Employer Identification Number'); }
							  else {
								  obj.value = newval.substring(0,2) + '-' + newval.substring(2,9);
							  }
						  }
					  }
				  </WTFUNCTION>
  -->
        <WTFUNCTION name="FormatCardCode(obj)">
          var val = obj.value;
          var newval = val.replace(/[^\d]/g, '');
          obj.value = newval.substring(0,4);
          //if( newval.length &lt; 3 ) {
          //alert('Oops, Invalid Security Code');
          //}
        </WTFUNCTION>
        <WTFUNCTION name="FormatLogon(obj)">
          var val = obj.value;
          var newval = val.replace(/[^0-9a-zA-Z]/g, '');
          obj.value = newval;
          if( newval.length &lt; 6 ) {
          alert('Oops, Logon must be at least 6 characters or numbers.');
          }
        </WTFUNCTION>
        <WTFUNCTION name="ShowCC()">
          var disp, membership = document.getElementById('Membership').value;
          if( membership == 5 ) { disp = '' } else { disp = 'none' }
          document.getElementById('CCRequired').style.display = disp;
          if( membership == 5 ) { disp = 'none' } else { disp = '' }
          document.getElementById('Agree2').style.display = disp;
          //document.getElementById('Payment').style.display = disp;
          //document.getElementById('CardRows').style.display = disp;
          //document.getElementById('Secure').style.display = disp;
        </WTFUNCTION>
        <WTFUNCTION name="ShowContact()">
          var disp; exist = document.getElementById('Existing').checked;
          if( exist == 1 ) { disp = 'none' } else { disp = '' }
          document.getElementById('NewContact').style.display = disp;
          if( exist == 1 ) { disp = '' } else { disp = 'none' }
          document.getElementById('ExistingContact').style.display = disp;
        </WTFUNCTION>

        <WTFUNCTION name="Init()">
          var mode = document.getElementById('Mode').value;
          if( mode == 1 ) {
          //ShowTaxIDType();
          ToggleType();
          ShowContact();
          }
        </WTFUNCTION>

        <WTFUNCTION name="MsgBox(msg)">
          alert(msg);
        </WTFUNCTION>

        <WTLOAD>Init();</WTLOAD>

        <WTROW>
          <WTHIDDEN value="PARAM(Mode)"/>
<!--          <WTHIDDEN value="PARAM(NewMemberID)"/>-->
          <WTHIDDEN value="PARAM(BillingID)"/>
          <WTHIDDEN value="PARAM(PayID)"/>
          <WTHIDDEN value="PARAM(TokenOwner)"/>
          <WTHIDDEN value="PARAM(TokenType)"/>
          <WTHIDDEN value="PARAM(Token)"/>
          <WTHIDDEN value="PARAM(PayDesc)"/>
          <WTHIDDEN value="PARAM(NoValidate)"/>
          <WTHIDDEN value="PARAM(ReferredBy)"/>
          <WTHIDDEN value="PARAM(Placement)"/>
          <WTHIDDEN value="PARAM(G)"/>
          <WTHIDDEN value="PARAM(GiftAmt)"/>
          <WTHIDDEN value="PARAM(GiftAmtRetail)"/>
          <WTHIDDEN value="PARAM(Price1)"/>
          <WTHIDDEN value="PARAM(Price2)"/>
          <WTHIDDEN value="PARAM(Price3)"/>
          <WTHIDDEN value="PARAM(Price4)"/>
        </WTROW>

        <WTSTATIC label="IsAgree"/>
        <WTSTATIC label="IsAgree2"/>
        <WTSTATIC label="CompanyNameTip"/>
        <WTSTATIC label="Email2Tip"/>
        <WTSTATIC label="Checking"/>
        <WTSTATIC label="Savings"/>
        <WTSTATIC label="Existing"/>

        <WTROW margin-top="12" margin-bottom="12">
          <WTCONDITION expr="PARAM(BadPayment)" oper="not-equal" value="CONST(0)"/>
          <WTSTATIC col="1" merge="3" label="BadPaymentText" class="PageHeading" fontcolor="red" align="center"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTCONDITION expr="PARAM(G)" oper="less" value="CONST(0)"/>
          <WTSTATIC col="1" merge="3" class="PageHeading" fontcolor="red" align="center">
            <WTSTATIC label="GiftNotAvailable">
              <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(-1)"/>
            </WTSTATIC>
            <WTSTATIC label="GiftNotValid">
              <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(-2)"/>
            </WTSTATIC>
          </WTSTATIC>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(ReferredBy)" oper="equal" value="CONST('')"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(GetMemberID)" oper="not-equal" value="CONST(0)"/>
            <WTROW margin-top="24">
              <WTSTATIC col="1" merge="3" align="center" class="PageHeading">
                <WTSTATIC label="GetMemberID"/>
              </WTSTATIC>
            </WTROW>
            <WTROW margin-top="6">
              <WTSTATIC col="1" />
              <WTSTATIC col="2" tag="MemberID" />
              <WTTEXT col="3" value="PARAM(MemberID)" size="6">
                <WTENTER>if(this.value==0){this.value=''}</WTENTER>
              </WTTEXT>
            </WTROW>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(GetMemberID)" oper="equal" value="CONST(0)"/>
            <WTROW margin-top="24" margin-bottom="12">
              <WTSTATIC col="1" merge="3" align="center" class="PageHeading" fontcolor="red">
                <WTSTATIC label="NoReferral1" newline="2"/>
                <WTSTATIC label="NoReferral2"/>
              </WTSTATIC>
            </WTROW>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <!-- === Agreement ====================================================== -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>

				  <WTROW>
					  <WTSTATIC col="1" merge="3" align="right">
						  <WTCODEGROUP><WTTRANSLATE/></WTCODEGROUP>
					  </WTSTATIC>
				  </WTROW>
          <WTROW margin-top="6">
            <WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
          </WTROW>
          <WTROW margin-top="6" margin-bottom="12">
            <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
            <WTSTATIC col="1" merge="3" align="center" bold="true">
              <WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(Placement)" oper="not-equal" value="CONST('')"/>
                <WTSTATIC newline="1"/>
                <WTSTATIC tag="Placement" value="PARAM(Placement)"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(divider)" />
          </WTROW>

          <!-- === Contact Information ============================================ -->
          <WTROW margin-bottom="6">
            <WTSTATIC col="1"/>
            <WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
          </WTROW>

          <WTROW margin-bottom="6">
            <WTSTATIC col="1"/>
            <WTSTATIC col="2" merge="2" align="left" bold="true" fontsize="3">
              <WTCODEGROUP>
                <WTCHECK value="PARAM(Existing)">
                  <WTCLICK>ShowContact();</WTCLICK>
                </WTCHECK>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>

          <WTROW id="ExistingContact" style="display:none">
            <WTSTATIC col="1"/>
            <WTSTATIC col="2" tag="ExistingMemberID"/>
            <WTTEXT col="3" value="PARAM(NewMemberID)" size="6"/>
          </WTROW>

          <WTROW id="NewContact">
            <WTTABLE col="1" merge="3">
              <WTCOLUMN width="50" align="right"/>
              <WTCOLUMN width="160" align="right"/>
              <WTCOLUMN width="540" align="left"/>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTSTATIC col="2" tag="MemberName"/>
                <WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true" required="false">
                  <WTEXIT>TitleCase(this);</WTEXIT>
                </WTTEXT>
                <WTTEXT col="3" value="ATTR(Member.NameLast)" width="340" label="NameLast" size="25" required="false">
                  <WTEXIT>TitleCase(this);</WTEXIT>
                </WTTEXT>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTSTATIC col="2">
                  <WTSTATIC label="CompanyName"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(TipQuestion.gif)" alt="CompanyNameTip">
                      <WTLINK name="CONST(alert('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='CompanyNameTip']&quot;/&gt;');)" click="true" />
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                </WTSTATIC>
                <WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
              </WTROW>
              <WTROW margin-top="6">
                <WTSTATIC col="1"/>
                <WTSTATIC col="2" tag="Email"/>
                <WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="false"/>
              </WTROW>
              <WTROW>
                <WTCONDITION expr="PARAM(TextEmail)" oper="not-equal" value="CONST(0)"/>
                <WTSTATIC col="1"/>
                <WTSTATIC col="2">
                  <WTSTATIC label="Email2"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(TipQuestion.gif)" alt="Email2Tip">
                      <WTLINK name="CONST(MsgBox('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='Email2Tip']&quot;/&gt;');)" click="true" />
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                </WTSTATIC>
                <WTTEXT col="3" value="ATTR(Member.Email2)" size="60" required="false"/>
                <WTSTATIC col="3">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(LearnMore.gif)">
                      <WTLINK name="Page" target="Help">
                        <WTPARAM name="Page" value="CONST(Email2)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                </WTSTATIC>
              </WTROW>
              <WTROW margin-top="6">
                <WTSTATIC col="1" />
                <WTSTATIC col="2" tag="Address" />
                <WTTEXT col="3" value="ATTR(Address.Street1)" size="60">
                  <WTEXIT>document.getElementById('Street1b').value = this.value;</WTEXIT>
                </WTTEXT>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" />
                <WTSTATIC col="2"/>
                <WTTEXT col="3" value="ATTR(Address.Street2)" size="60">
                  <WTEXIT>document.getElementById('Street2b').value = this.value;</WTEXIT>
                </WTTEXT>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" />
                <WTSTATIC col="2"/>
                <WTTEXT col="3" value="ATTR(Address.City)" width="200" label="City" size="27" required="false">
                  <WTEXIT>TitleCase(this); document.getElementById('Cityb').value = this.value;</WTEXIT>
                </WTTEXT>
                <WTTEXT col="3" value="ATTR(Address.State)" width="340" label="State" size="27" required="false">
                  <WTEXIT>TitleCase(this); document.getElementById('Stateb').value = this.value;</WTEXIT>
                </WTTEXT>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" />
                <WTSTATIC col="2" />
                <WTTEXT col="3" value="ATTR(Address.Zip)" width="100" label="Zip" size="8" required="false">
                  <WTEXIT>document.getElementById('Zipb').value = this.value;</WTEXIT>
                </WTTEXT>
                <WTCOMBO col="3" value="ATTR(Address.CountryID)" width="440" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
                  <WTEXIT>document.getElementById('CountryIDb').value = this.value;</WTEXIT>
                </WTCOMBO>
              </WTROW>
              <WTROW margin-top="6">
                <WTSTATIC col="1"/>
                <WTSTATIC col="2" tag="Phone"/>
                <WTTEXT col="3" value="ATTR(Member.Phone1)" size="20">
                  <WTEXIT>FormatPhone(this);</WTEXIT>
                </WTTEXT>
              </WTROW>
              <WTROW margin-top="12" margin-bottom="6">
                <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
              </WTROW>
              <WTROW margin-bottom="6">
                <WTSTATIC col="1"/>
                <WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTSTATIC col="2" tag="NewLogon"/>
                <WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20" class="prompt">
                  <WTEXIT>FormatLogon(this);</WTEXIT>
                </WTTEXT>
                <WTSTATIC col="3" label="LogonTip"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTSTATIC col="2" tag="NewPassword"/>
                <WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20" secure="false" class="prompt">
                  <WTEXIT>if(this.value==''){alert('Oops, Password Required!');}</WTEXIT>
                </WTTEXT>
                <WTSTATIC col="3" label="PasswordText"/>
              </WTROW>
            </WTTABLE>
          </WTROW>
          <WTROW margin-top="24" margin-bottom="18">
            <WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(divider)" />
          </WTROW>

          <!-- === Membership ===================================================== -->
          <!-- NEXXUS -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTROW margin-bottom="12">
              <WTTABLE col="1" merge="3">
                <WTCOLUMN width="60" align="left"/>
                <WTCOLUMN width="30" align="left"/>
                <WTCOLUMN width="660" align="left"/>
                <WTROW margin-top="6">
                  <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(50)" connector="or"/>
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
                  <WTSTATIC col="3">
                    <WTSTATIC bold="true">
                      <WTSTATIC label="Membership21_1"/>
                      <WTSTATIC fontcolor="red">
                        <WTCONDITION expr="PARAM(Price4)" oper="not-equal" value="CONST('')"/>
                        <WTSTATIC space="1"/>
                        <WTSTATIC label="SpecialPrice" space="1"/>
                        <WTSTATIC value="PARAM(Price4)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC label="Membership21_1a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="6">
                  <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(25)" connector="or"/>
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
                  <WTSTATIC col="3">
                    <WTSTATIC bold="true">
                      <WTSTATIC label="Membership21_2"/>
                      <WTSTATIC fontcolor="red">
                        <WTCONDITION expr="PARAM(Price3)" oper="not-equal" value="CONST('')"/>
                        <WTSTATIC space="1"/>
                        <WTSTATIC label="SpecialPrice" space="1"/>
                        <WTSTATIC value="PARAM(Price3)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC label="Membership21_2a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="6">
                  <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(10)" connector="or"/>
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
                  <WTSTATIC col="3">
                    <WTSTATIC bold="true">
                      <WTSTATIC label="Membership21_3"/>
                      <WTSTATIC fontcolor="red">
                        <WTCONDITION expr="PARAM(Price2)" oper="not-equal" value="CONST('')"/>
                        <WTSTATIC space="1"/>
                        <WTSTATIC label="SpecialPrice" space="1"/>
                        <WTSTATIC value="PARAM(Price2)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC label="Membership21_3a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="6">
                  <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(10)" connector="or"/>
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
                  <WTSTATIC col="3">
                    <WTSTATIC bold="true">
                      <WTSTATIC label="Membership21_4"/>
                      <WTSTATIC fontcolor="red">
                        <WTCONDITION expr="PARAM(Price2)" oper="not-equal" value="CONST('')"/>
                        <WTSTATIC space="1"/>
                        <WTSTATIC label="SpecialPrice" space="1"/>
                        <WTSTATIC value="PARAM(Price2)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC label="Membership21_4a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="6">
                  <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(10)" connector="or"/>
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="5" align="left" valign="top" datapathx="/DATA/PARAM/@membership=5"/>
                  <WTSTATIC col="3">
                    <WTSTATIC bold="true">
                      <WTSTATIC label="Membership21_5"/>
                      <WTSTATIC fontcolor="red">
                        <WTCONDITION expr="PARAM(Price2)" oper="not-equal" value="CONST('')"/>
                        <WTSTATIC space="1"/>
                        <WTSTATIC label="SpecialPrice" space="1"/>
                        <WTSTATIC value="PARAM(Price2)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC label="Membership21_5a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="6">
                  <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  <WTCONDITION expr="PARAM(GiftAmt)" oper="equal" value="CONST(2)" connector="or"/>
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="6" align="left" valign="top" datapathx="/DATA/PARAM/@membership=6"/>
                  <WTSTATIC col="3">
                    <WTSTATIC bold="true">
                      <WTSTATIC label="Membership21_6"/>
                      <WTSTATIC fontcolor="red">
                        <WTCONDITION expr="PARAM(Price1)" oper="not-equal" value="CONST('')"/>
                        <WTSTATIC space="1"/>
                        <WTSTATIC label="SpecialPrice" space="1"/>
                        <WTSTATIC value="PARAM(Price1)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC label="Membership21_6a"/>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTCODEGROUP>
          <WTROW margin-top="24" margin-bottom="12">
            <WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(divider)" />
          </WTROW>

          <!-- === Payment ========================================================= -->
          
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(G)" oper="greater" value="CONST(0)"/>
            <WTROW>
              <WTSTATIC col="1" merge="3" align="center" class="PageHeading">
                <WTSTATIC label="GiftCertificate"/>
                <WTSTATIC value="PARAM(G)" space="1"/>
                <WTSTATIC label="for$"/>
                <WTSTATIC value="PARAM(GiftAmtRetail)"/>
              </WTSTATIC>
            </WTROW>
          </WTCODEGROUP>
            
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>

            <WTROW id="Payment">
              <WTTABLE col="1" merge="3">
                <WTCOLUMN width="750" align="center"/>

                <WTROW id="Pay2" margin-bottom="12">
                  <WTSTATIC col="1" align="center" class="prompt">
                    <WTSTATIC label="PaymentText">
                      <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(17)"/>
                    </WTSTATIC>
                    <WTSTATIC label="BitCoinPayments">
                      <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(17)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW id="Pay3" margin-bottom="6">
                  <WTSTATIC col="1" align="center">
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsPaymentVisa"/>
                      <WTRADIO group="PayType" name="1" check="/DATA/TXN/PTSBILLING/@paytype=1">
                        <WTCLICK>ToggleType();</WTCLICK>
                      </WTRADIO>
                      <WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
                        <WTCLICK>CheckType(1);</WTCLICK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsPaymentMC"/>
                      <WTSTATIC space="3"/>
                      <WTRADIO group="PayType" name="2" check="/DATA/TXN/PTSBILLING/@paytype=2">
                        <WTCLICK>ToggleType();</WTCLICK>
                      </WTRADIO>
                      <WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
                        <WTCLICK>CheckType(2);</WTCLICK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsPaymentDiscover"/>
                      <WTSTATIC space="3"/>
                      <WTRADIO group="PayType" name="3" check="/DATA/TXN/PTSBILLING/@paytype=3">
                        <WTCLICK>ToggleType();</WTCLICK>
                      </WTRADIO>
                      <WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
                        <WTCLICK>CheckType(3);</WTCLICK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsPaymentAmex"/>
                      <WTSTATIC space="3"/>
                      <WTRADIO group="PayType" name="4" check="/DATA/TXN/PTSBILLING/@paytype=4">
                        <WTCLICK>ToggleType();</WTCLICK>
                      </WTRADIO>
                      <WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
                        <WTCLICK>CheckType(4);</WTCLICK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsPaymentCheck"/>
                      <WTSTATIC space="3"/>
                      <WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
                        <WTCLICK>ToggleType();</WTCLICK>
                      </WTRADIO>
                      <WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
                        <WTCLICK>CheckType(5);</WTCLICK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsPaymenteWallet"/>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentiPayout"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="11" check="/DATA/TXN/PTSBILLING/@paytype=11">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType11.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(11);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentPayQuicker"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="12" check="/DATA/TXN/PTSBILLING/@paytype=12">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType12.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(12);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentSolidTrust"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="13" check="/DATA/TXN/PTSBILLING/@paytype=13">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType13.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(13);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
<!--
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentBitCoin"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="14" check="/DATA/TXN/PTSBILLING/@paytype=14">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType14.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(14);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
-->
<!--                      
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentNeteller"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="15" check="/DATA/TXN/PTSBILLING/@paytype=15">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType15.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(15);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
-->                      
                    </WTCODEGROUP>
                    
                    <WTCODEGROUP>
                      <WTCONDITION expr="PARAM(CashPayment)" oper="not-equal" value="CONST(0)"/>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentCash"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="7" check="/DATA/TXN/PTSBILLING/@paytype=7">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType7.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(7);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentPO"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="8" check="/DATA/TXN/PTSBILLING/@paytype=8">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType8.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(8);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>

            <WTROW id="CashRows" style="display:none">
            </WTROW>

            <WTROW id="WalletRows" style="display:none">
              <WTTABLE col="1" merge="3">
                <WTCOLUMN width="100" align="right"/>
                <WTCOLUMN width="500" align="left"/>
                <WTROW margin-top="6" margin-bottom="6">
                  <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="WalletName"/>
                  <WTTEXT col="2" value="PARAM(Wallet)" required="true"/>
                </WTROW>
              </WTTABLE>
            </WTROW>

            <WTROW id="BitCoinRows" style="display:none">
              <WTTABLE col="1" merge="3">
                <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(17)"/>
                <WTCOLUMN width="100" align="right"/>
                <WTCOLUMN width="500" align="left"/>
                <WTROW margin-top="6" margin-bottom="6">
                  <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" merge="2" label="BitCoinPayments" class="PageHeading" fontcolor="red" align="center"/>
                </WTROW>
              </WTTABLE>
            </WTROW>

            <WTROW id="CardRows" style="display:none">
              <WTSTATIC col="1"/>
              <WTTABLE col="2" merge="2">
                <WTCOLUMN width="100" align="right"/>
                <WTCOLUMN width="500" align="left"/>
                <WTROW>
                  <WTSTATIC col="1" tag="CardNumber"/>
                  <WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
                    <WTEXIT>var x = this.value; if(x.tolowercase() != 'paypal'){this.value = x.replace(/[^\d]/g, '')};</WTEXIT>
                  </WTTEXT>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="CardDate"/>
                  <WTCOMBO col="2" value="ATTR(Billing.CardMo)">
                    <WTOPTION id="" label="Select"/>
                    <WTOPTION id="1" label="January"/>
                    <WTOPTION id="2" label="February"/>
                    <WTOPTION id="3" label="March"/>
                    <WTOPTION id="4" label="April"/>
                    <WTOPTION id="5" label="May"/>
                    <WTOPTION id="6" label="June"/>
                    <WTOPTION id="7" label="July"/>
                    <WTOPTION id="8" label="August"/>
                    <WTOPTION id="9" label="September"/>
                    <WTOPTION id="10" label="October"/>
                    <WTOPTION id="11" label="November"/>
                    <WTOPTION id="12" label="December"/>
                  </WTCOMBO>
                  <WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
                    <WTOPTION id="" label="Select"/>
                    <WTOPTION id="13" label="2013"/>
                    <WTOPTION id="14" label="2014"/>
                    <WTOPTION id="15" label="2015"/>
                    <WTOPTION id="16" label="2016"/>
                    <WTOPTION id="17" label="2017"/>
                    <WTOPTION id="18" label="2018"/>
                    <WTOPTION id="19" label="2019"/>
                    <WTOPTION id="20" label="2020"/>
                    <WTOPTION id="21" label="2021"/>
                    <WTOPTION id="22" label="2022"/>
                    <WTOPTION id="23" label="2023"/>
                    <WTOPTION id="24" label="2024"/>
                    <WTOPTION id="25" label="2025"/>
                    <WTOPTION id="26" label="2026"/>
                    <WTOPTION id="27" label="2027"/>
                    <WTOPTION id="28" label="2028"/>
                    <WTOPTION id="29" label="2029"/>
                    <WTOPTION id="30" label="2030"/>
                    <WTOPTION id="31" label="2031"/>
                    <WTOPTION id="32" label="2032"/>
                    <WTOPTION id="33" label="2033"/>
                    <WTOPTION id="34" label="2034"/>
                    <WTOPTION id="35" label="2035"/>
                  </WTCOMBO>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="CardName"/>
                  <WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="CardCode"/>
                  <WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
                    <WTEXIT>FormatCardCode(this);</WTEXIT>
                  </WTTEXT>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTTOOLTIP>
                        <WTIMAGE value="CONST(SymbolHelp.gif)"/>
                        <WTTIP>
                          <WTIMAGE value="CONST(SecurityCode.png)"/>
                        </WTTIP>
                      </WTTOOLTIP>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>

            <WTROW id="CheckRows" style="display:none">
              <WTSTATIC col="1"/>
              <WTTABLE col="2" merge="2">
                <WTCOLUMN width="100" align="right"/>
                <WTCOLUMN width="500" align="left"/>
                <WTROW>
                  <WTSTATIC col="1" tag="CheckBank"/>
                  <WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25"/>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="CheckRoute"/>
                  <WTTEXT col="2" value="ATTR(Billing.CheckRoute)"/>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTTOOLTIP>
                        <WTIMAGE value="CONST(SymbolHelp.gif)"/>
                        <WTTIP>
                          <WTIMAGE value="CONST(checkref.gif)"/>
                        </WTTIP>
                      </WTTOOLTIP>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="CheckAccount"/>
                  <WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25"/>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTTOOLTIP>
                        <WTIMAGE value="CONST(SymbolHelp.gif)"/>
                        <WTTIP>
                          <WTIMAGE value="CONST(checkref.gif)"/>
                        </WTTIP>
                      </WTTOOLTIP>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="CheckAcctType"/>
                  <WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)"/>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" tag="CheckName"/>
                  <WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25"/>
                </WTROW>
              </WTTABLE>
            </WTROW>

            <WTROW id="BillingAddress" style="display:none">
              <WTSTATIC col="1"/>
              <WTTABLE col="2" merge="2">
                <WTCOLUMN width="100" align="right"/>
                <WTCOLUMN width="500" align="left"/>
                <WTROW>
                  <WTSTATIC col="1" tag="BillingAddress" />
                  <WTTEXT col="2" value="PARAM(Street1b)" size="60">
                    <WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
                  </WTTEXT>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1"/>
                  <WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1"/>
                  <WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
                    <WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
                  </WTTEXT>
                  <WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
                    <WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
                  </WTTEXT>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1"/>
                  <WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left">
                    <WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
                  </WTTEXT>
                  <WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
                </WTROW>
              </WTTABLE>
            </WTROW>

            <WTROW id="Secure" margin-top="12">
              <WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
              <WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
            </WTROW>

            <WTROW margin-top="6" margin-bottom="12">
              <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
            </WTROW>
            <WTROW id="Agree2">
              <WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
                <WTCODEGROUP>
                  <WTCHECK value="PARAM(IsAgree2)"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(0)"/>
                  <WTSTATIC label="IsAgree2Billed">
                    <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
                  </WTSTATIC>
                  <WTSTATIC label="IsAgree2Monthly">
                    <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(GCR)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTSTATIC label="IsAgree2Annually">
                  <WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(2)"/>
                </WTSTATIC>
                <WTSTATIC label="IsAgree2OneTime">
                  <WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(1)"/>
                </WTSTATIC>
              </WTSTATIC>
            </WTROW>
            <WTROW margin-top="12">
              <WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
              <WTSTATIC col="1" merge="3" align="center">
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
                  <WTCOMBO value="PARAM(BillDay)">
                    <WTOPTION id="1" label="BillDay1"/>
                    <WTOPTION id="15" label="BillDay15"/>
                  </WTCOMBO>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>

          </WTCODEGROUP>
          <WTROW margin-top="12">
            <WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
              <WTCODEGROUP>
                <WTCHECK value="PARAM(IsAgree)"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="3" action="1" value="CONST(Continue)" align="center"/>
          </WTROW>
        </WTCODEGROUP>

        <!-- === Confirm ======================================================== -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
          <WTHIDDEN value="PARAM(M)"/>
          <WTHIDDEN value="PARAM(IsAgree)"/>
          <WTHIDDEN value="PARAM(Wallet)"/>
          <WTHIDDEN value="ATTR(Member.NameFirst)"/>
          <WTHIDDEN value="ATTR(Member.NameLast)"/>
          <WTHIDDEN value="ATTR(Member.CompanyName)"/>
          <WTHIDDEN value="ATTR(Member.Email)"/>
          <WTHIDDEN value="ATTR(Member.Reference)"/>
          <WTHIDDEN value="ATTR(Address.Street1)"/>
          <WTHIDDEN value="ATTR(Address.Street2)"/>
          <WTHIDDEN value="ATTR(Address.City)"/>
          <WTHIDDEN value="ATTR(Address.State)"/>
          <WTHIDDEN value="ATTR(Address.Zip)"/>
          <WTHIDDEN value="ATTR(Address.CountryID)"/>
          <WTHIDDEN value="ATTR(Member.Phone1)"/>
          <WTHIDDEN value="ATTR(Member.NewLogon)"/>
          <WTHIDDEN value="ATTR(Member.NewPassword)"/>
          <WTHIDDEN value="PARAM(Membership)"/>
          <WTHIDDEN value="PARAM(OrderOption)"/>
          <WTHIDDEN value="PARAM(BillDay)"/>
          <WTHIDDEN value="PARAM(IsAgree2)"/>
          <WTHIDDEN value="ATTR(Billing.PayType)"/>
          <WTHIDDEN value="ATTR(Billing.CardNumber)"/>
          <WTHIDDEN value="ATTR(Billing.CardMo)"/>
          <WTHIDDEN value="ATTR(Billing.CardYr)"/>
          <WTHIDDEN value="ATTR(Billing.CardName)"/>
          <WTHIDDEN value="ATTR(Billing.CardCode)"/>
          <WTHIDDEN value="ATTR(Billing.CheckBank)"/>
          <WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
          <WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
          <WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
          <WTHIDDEN value="ATTR(Billing.CheckName)"/>
          <WTHIDDEN value="PARAM(Street1b)"/>
          <WTHIDDEN value="PARAM(Street2b)"/>
          <WTHIDDEN value="PARAM(Cityb)"/>
          <WTHIDDEN value="PARAM(Stateb)"/>
          <WTHIDDEN value="PARAM(Zipb)"/>
          <WTHIDDEN value="PARAM(CountryIDb)"/>
          <WTHIDDEN value="PARAM(NewMemberID)"/>

          <WTROW>
            <WTTABLE col="1" merge="3">
              <WTCOLUMN width="100" align="left"/>
              <WTCOLUMN width="325" align="left"/>
              <WTCOLUMN width="325" align="left"/>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTSTATIC col="2">
                  <WTSTATIC value="ATTR(Member.NameFirst)" space="1" bold="true"/>
                  <WTSTATIC value="ATTR(Member.NameLast)" newline="1" bold="true"/>
                  <WTSTATIC value="ATTR(Member.CompanyName)" newline="1"/>
                  <WTSTATIC value="ATTR(Member.Email)" newline="1"/>
                  <WTSTATIC value="ATTR(Member.Reference)" newline="1">
                    <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
                  </WTSTATIC>
                  <WTSTATIC value="ATTR(Member.Phone1)" newline="1"/>
                  <WTSTATIC value="ATTR(Address.Street1)" newline="1"/>
                  <WTSTATIC value="ATTR(Address.City)" space="1"/>
                  <WTSTATIC value="ATTR(Address.State)" space="1"/>
                  <WTSTATIC value="ATTR(Address.Zip)" newline="1"/>
                  <WTSTATIC value="PARAM(CountryName)" newline="1"/>
                  <WTSTATIC tag="Logon" value="ATTR(Member.NewLogon)" space="2"/>
                  <WTSTATIC value="ATTR(Member.NewPassword)"/>
                </WTSTATIC>
                <WTSTATIC col="3">
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(G)" oper="greater" value="CONST(0)"/>
                    <WTSTATIC label="GiftCertificate"/>
                    <WTSTATIC value="PARAM(G)" space="1"/>
                    <WTSTATIC label="for$"/>
                    <WTSTATIC value="PARAM(GiftAmtRetail)"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                    <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)"/>
                    <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
                    <WTSTATIC label="BillingInfo" newline="1" bold="true"/>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="greater-equal" value="CONST(1)"/>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="less-equal" value="CONST(4)" connector="and"/>
                      <WTSTATIC value="ATTR(Billing.CardNumber)" newline="1"/>
                      <WTSTATIC tag="Expires" value="ATTR(Billing.CardMo)" space="1"/>
                      <WTSTATIC value="ATTR(Billing.CardYr)" newline="1"/>
                      <WTSTATIC value="ATTR(Billing.CardName)" newline="1"/>
                      <WTSTATIC tag="Code" value="ATTR(Billing.CardCode)" newline="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(5)"/>
                      <WTSTATIC value="ATTR(Billing.CheckBank)" newline="1"/>
                      <WTSTATIC value="ATTR(Billing.CheckRoute)" space="1"/>
                      <WTSTATIC value="ATTR(Billing.CheckAccount)" newline="1"/>
                      <WTSTATIC label="Checking">
                        <WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(1)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Savings">
                        <WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(2)"/>
                      </WTSTATIC>
                      <WTSTATIC newline="1"/>
                      <WTSTATIC value="ATTR(Billing.CheckName)" newline="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(7)"/>
                      <WTSTATIC label="CashPayment" newline="1"/>
                      <WTSTATIC label="CashPayment15">
                        <!-- CIS -->
                        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
                      </WTSTATIC>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(11)"/>
                      <WTSTATIC tag="iPayout" value="PARAM(Wallet)"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(12)"/>
                      <WTSTATIC tag="PayQuicker" value="PARAM(Wallet)"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(13)"/>
                      <WTSTATIC tag="SolidTrust" value="PARAM(Wallet)"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(14)"/>
                      <WTSTATIC label="BitCoinPayments"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="ATTR(Billing.PayType)" oper="less" value="CONST(7)"/>
                      <WTSTATIC value="PARAM(Street1b)" newline="1"/>
                      <WTSTATIC value="PARAM(Cityb)" space="1"/>
                      <WTSTATIC value="PARAM(Stateb)" space="1"/>
                      <WTSTATIC value="PARAM(Zipb)" newline="1"/>
                      <WTSTATIC value="PARAM(CountryNameb)" newline="2"/>
                    </WTCODEGROUP>
                    
                    </WTCODEGROUP>
                  </WTCODEGROUP>
                </WTSTATIC>
              </WTROW>
            </WTTABLE>
          </WTROW>
          <WTROW margin-top="12" margin-bottom="12">
            <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
          </WTROW>

          <WTROW margin-bottom="12">
            <WTSTATIC col="1" merge="3" align="center" bold="true">
              <WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(Placement)" oper="not-equal" value="CONST('')"/>
                <WTSTATIC newline="1"/>
                <WTSTATIC tag="Placement" value="PARAM(Placement)"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>

          <!-- Custom Company Membership Info -->
          <WTCODEGROUP>
            <!-- NEXXUS-->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" merge="2" class="PageHeading" align="center">
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
                  <WTSTATIC label="Membership21_1" newline="1"/>
                  <WTSTATIC label="Membership21_1a" newline="1"/>
                  <WTSTATIC label="Membership21_1b">
                    <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
                  <WTSTATIC label="Membership21_2" newline="1"/>
                  <WTSTATIC label="Membership21_2a" newline="1"/>
                  <WTSTATIC label="Membership21_2b">
                    <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
                  <WTSTATIC label="Membership21_3" newline="1"/>
                  <WTSTATIC label="Membership21_3a" newline="1"/>
                  <WTSTATIC label="Membership21_3b">
                    <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
                  <WTSTATIC label="Membership21_4" newline="1"/>
                  <WTSTATIC label="Membership21_4a" newline="1"/>
                  <WTSTATIC label="Membership21_4b">
                    <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
                  <WTSTATIC label="Membership21_5" newline="1"/>
                  <WTSTATIC label="Membership21_5a" newline="1"/>
                  <WTSTATIC label="Membership21_5b">
                    <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
                  <WTSTATIC label="Membership21_6" newline="1"/>
                  <WTSTATIC label="Membership21_6a" newline="1"/>
                  <WTSTATIC label="Membership21_6b">
                    <WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>
          </WTCODEGROUP>

          <WTFUNCTION name="RefreshCaptchaImage(valImageId)">
            var objImage = document.getElementById(valImageId)
            if (objImage != undefined) {
            var now = new Date();
            objImage.src = objImage.src.split('?')[0] + '?x=' + now.toUTCString();
            }
          </WTFUNCTION>

          <WTCODEGROUP>
            <!-- Required Captcha -->
            <WTCONDITION expr="PARAM(IsCaptcha)" oper="not-equal" value="CONST(0)"/>
            <WTROW margin-top="18">
              <WTIMAGE col="1" merge="3" value="CONST(captcha.asp)" imgpath="include/" id="imgCaptcha" align="center" imgalign="absmiddle" />
              <WTBUTTON col="1" merge="3" value="CONST(NewCaptcha)" align="center" btnclass="smbutton">
                <WTCLICK>RefreshCaptchaImage('imgCaptcha');</WTCLICK>
              </WTBUTTON>
            </WTROW>
            <WTROW margin-top="6">
              <WTSTATIC col="1" merge="3" tag="WriteCaptcha" align="center"/>
              <WTTEXT col="1" merge="3" value="PARAM(Captcha)" size="10"/>
            </WTROW>
          </WTCODEGROUP>

          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="3" value="CONST(Back)" action="0" align="center"/>
            <WTBUTTON col="1" merge="3" value="CONST(Confirm)" align="center">
              <WTCLICK> this.disabled = true; doSubmit(2,&quot;&quot;);</WTCLICK>
            </WTBUTTON>
          </WTROW>
        </WTCODEGROUP>

        <!-- === Welcome ======================================================== -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PROCESS)"/>
          <WTROW margin-top="12">
            <WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
          </WTROW>
          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
              <WTCLICK>window.close()</WTCLICK>
            </WTBUTTON>
          </WTROW>
        </WTCODEGROUP>

				<WTROW>
					<WTSTATIC col="1" merge="3" align="right">
						<WTCODEGROUP><WTTRANSLATE/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
    
    </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Gift Certificate Order Form -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusGift" caption="New Course Certificate" navbar="false" footer="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusGift" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="BillingID" datatype="number"/>
      <WTPARAM name="Qty" datatype="number"/>
      <WTPARAM name="PV" datatype="number"/>
      <WTPARAM name="Option" datatype="number"/>
      <WTPARAM name="Wallet" datatype="currency"/>
      <WTPARAM name="WalletNumber" datatype="currency"/>

      <WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
      <WTPARAM name="URL" datatype="text"/>

      <WTINCLUDE name="Billing.asp"/>
      <WTINCLUDE name="Payment.asp"/>
      <WTINCLUDE name="IP.asp"/>

      <WTCODEGROUP>
          <WTCUSTOM>
          reqURL = "http://" + reqSysServerName + reqSysServerPath + "Attachments/38/21/LargePayments.pdf"
        </WTCUSTOM>
      </WTCODEGROUP>
      
      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="GetBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
            <WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
      </WTSUB>
      
      <WTSUB name="GetWallet">
        <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
          <WTMETHOD name="WalletTotal">
            <WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
            <WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            a = Split(Result, ";")
            reqWalletNumber = a(0)
            reqWallet = FormatCurrency(a(0),2)
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="AddOrder">
        <WTCALLSUB name="GetWallet"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="FORM(Qty)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="FORM(PV)"/>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;100&quot;)"/>
        
        <!-- PROCESS WALLET PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="greater-equal" value="CONST(CCUR(reqQty * reqPV))"/>
          <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV)"/>
          <!-- DEBIT WALLET -->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
					  <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTCUSTOM>
              IP = Request.ServerVariables("REMOTE_ADDR")
              tmpLocation = GetIPCity( IP )
            </WTCUSTOM>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(5)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice * -1)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(Left(&quot;Course Certificate &quot; + IP + &quot; &quot; + tmpLocation, 500) )"/>
            <WTMETHOD name="Add">
              <WTPARAM name="PayoutID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- CREATE PAYMENT -->
				  <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					  <WTCONDITION expr="NoErrors"/>
					  <WTMETHOD name="Load">
						  <WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
					  <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					  <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					  <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					  <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Date)"/>
					  <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
					  <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(90)"/>
					  <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(3)"/>
					  <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice)"/>
					  <WTSETATTRIBUTE name="ATTR(Total)" value="CONST(BillingPrice)"/>
					  <WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(Purpose)"/>
					  <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(&quot;Course Certificate&quot;)"/>
					  <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;&quot;)"/>
					  <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PayoutID)"/>
					  <WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(CSTR(reqQty) + &quot;.0&quot; + CSTR(reqPV))">
              <WTCONDITION expr="CONST(LEN(CSTR(reqPV)))" oper="equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(CSTR(reqQty) + &quot;.&quot; + CSTR(reqPV))">
              <WTCONDITION expr="CONST(LEN(CSTR(reqPV)))" oper="not-equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTMETHOD name="Add">
						  <WTPARAM name="PaymentID" direction="return" datatype="number"/>
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
				  </WTOBJECT>
          <!-- UPDATE WALLET PAYOUT REFERENCE-->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
					  <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(PayoutID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PaymentID)"/>
					  <WTMETHOD name="Save">
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
          </WTOBJECT>
          <!-- Custom Company Payment Post Processing -->
          <WTCODEGROUP>
					  <WTCONDITION expr="NoErrors"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
        </WTCODEGROUP>
        
        <!-- PROCESS CREDIT CARD PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="less" value="CONST(CCUR(reqQty * reqPV))"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(CCUR(reqQty * reqPV))" oper="less" value="CONST(100)"/>
            <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV * 1.05)"/>
            <WTCALLSUB name="GetBilling"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(CCUR(reqQty * reqPV))" oper="greater-equal" value="CONST(100)"/>
            <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV)"/>
  					<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(14)"/> <!-- Create Bitcoin Payment -->
          </WTCODEGROUP>

          <!-- get company options -->
          <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
            <WTMETHOD name="FetchCompany">
              <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
            </WTMETHOD>
            <WTMETHOD name="Load">
              <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
            <WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
            <WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
            <WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
            <WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
            <WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
            <WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
            <WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
          </WTOBJECT>
        
          <!-- Get Payment -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
            <WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
            <WTCUSTOM>
              tmpProcessor = 0
              tmpAcct = ""
              Select Case reqPayType
              Case 1, 2, 3, 4	'Process Credit Cards
              tmpProcessor = tmpCardProcessor
              tmpAcct = tmpCardAcct
              Case 5 'Process Electronic Checks
              tmpProcessor = tmpCheckProcessor
              tmpAcct = tmpCheckAcct
              Case 11, 12, 13 'Process Wallets
              tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
              End Select
            </WTCUSTOM>
          
            <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
          
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
              <WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
            </WTCODEGROUP>
          
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
  			      <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					      <WTMETHOD name="Load">
						      <WTPARAM name="PaymentID" direction="input" value="CONST(PaymentID)"/>
						      <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					      </WTMETHOD>
                <WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(CSTR(reqQty) + &quot;.0&quot; + CSTR(reqPV))">
                  <WTCONDITION expr="CONST(LEN(CSTR(reqPV)))" oper="equal" value="CONST(1)"/>
                </WTSETATTRIBUTE>
                <WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(CSTR(reqQty) + &quot;.&quot; + CSTR(reqPV))">
                  <WTCONDITION expr="CONST(LEN(CSTR(reqPV)))" oper="not-equal" value="CONST(1)"/>
                </WTSETATTRIBUTE>
                <WTMETHOD name="Save">
						      <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					      </WTMETHOD>
				      </WTOBJECT>
              <!-- Custom Company Payment Post Processing -->
              <WTCODEGROUP>
                <WTCONDITION expr="NoErrors"/>
                <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
                  <WTMETHOD name="Custom">
                    <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                    <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                    <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                    <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
                    <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                    <WTPARAM name="Count" direction="return" datatype="number"/>
                  </WTMETHOD>
                </WTOBJECT>
              </WTCODEGROUP>
            </WTCODEGROUP>

          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Qty)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="CONST(10)"/>
        <WTCALLSUB name="GetBilling"/>
        <WTCALLSUB name="GetWallet"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="AddOrder"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
      </WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="5" name="Billing" type="Update">
				<WTRETURN>
					<WTLINK name="2903" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
<!-- FIX SSL					
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->					
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="7" name="AddBilling" type="Update">
				<WTRETURN>
					<WTLINK name="2902" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
<!-- FIX SSL					
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="200" align="right"/>
        <WTCOLUMN width="500" align="left"/>

				<WTFUNCTION name="UpdateTotal()">	
					var qty = parseInt(document.getElementById('Qty').value);
					var pv = parseInt(document.getElementById('PV').value);
					var wallet = document.getElementById('Wallet').value;
          var msg;
          var number = Number( wallet.replace(/[^0-9\.]+/g,""));
          if( number >= qty * pv ) { 
            msg = formatCurrency( qty * pv ) + ' from Wallet'
          }
          else {
            if ( (qty * pv) &lt; 100 ) {
            msg = formatCurrency( qty * pv * 1.05 ) + ' from Credit Card'
            }
            else {
            msg = formatCurrency( qty * pv ) + " bitcoin, cashier's check or wire"
            }
          }
					document.getElementById('Total').value = msg;
				</WTFUNCTION>
        
        <WTFUNCTION name="SetPack()">
          var opt = parseInt(document.getElementById('Option').value);
          var qty = 0;
          var pv = 0;
          if( opt == 1 ) { qty = 10; pv = 50; }
          if( opt == 2 ) { qty = 20; pv = 50; }
          if( opt == 3 ) { qty = 40; pv = 50; }
          if( qty > 0 ) {
          document.getElementById('Qty').value = qty;
          document.getElementById('PV').value = pv;
          UpdateTotal();
          }
        </WTFUNCTION>

        <WTFUNCTION name="formatCurrency(num)">
					num = num.toString().replace(/\$|\,/g,'');
					if(isNaN(num))
					num = "0";
					sign = (num == (num = Math.abs(num)));
					num = Math.floor(num*100+0.50000000001);
					cents = num%100;
					num = Math.floor(num/100).toString();
					if(cents&lt;10)
					cents = "0" + cents;
					for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
					num = num.substring(0,num.length-(4*i+3))+','+
					num.substring(num.length-(4*i+3));
					return (((sign)?'':'-') + '$' + num + '.' + cents);
					//return (((sign)?'':'-') + '$' + num);
				</WTFUNCTION>
        
				<WTLOAD>UpdateTotal()</WTLOAD>

  <WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="GiftOrder" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="NoBilling" align="left" class="PageHeading"/>
          </WTROW>
					<WTROW>
						<WTBUTTON col="1" merge="2" action="7" value="CONST(AddBilling)" align="center"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center" btnclass="smbutton"/>
					</WTROW>
				</WTCODEGROUP>
  
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="GiftOrderText" align="left" class="prompt"/>
          </WTROW>
          <WTROW margin-bottom="6">
            <WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" merge="2" tag="Quantity" align="center"/>
            <WTTEXT col="1" value="PARAM(Qty)" size="3">
              <WTKEY>UpdateTotal()</WTKEY>
            </WTTEXT>
            <WTSTATIC col="1" tag="Certificate"/>
            <WTCOMBO col="1" value="PARAM(PV)" prespace="false">
              <WTOPTION id="2" label="Cert5"/>
              <WTOPTION id="10" label="Cert10"/>
              <WTOPTION id="25" label="Cert25"/>
              <WTOPTION id="50" label="Cert50"/>
              <WTCHANGE>UpdateTotal()</WTCHANGE>
            </WTCOMBO>
            <WTSTATIC col="1" tag="Option"/>
            <WTCOMBO col="1" value="PARAM(Option)" prespace="false">
              <WTOPTION id="0" label="blank"/>
              <WTOPTION id="1" label="Pack1"/>
              <WTOPTION id="2" label="Pack2"/>
              <WTOPTION id="3" label="Pack3"/>
              <WTCHANGE>SetPack()</WTCHANGE>
            </WTCOMBO>
          </WTROW>
        
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
          <WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						  <WTSTATIC tag="TotalDue"/>
              <WTCODEGROUP><WTTEXT name="Total" value="CONST($10.00)" disabled="true" size="40" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/></WTCODEGROUP>
					  </WTSTATIC>
					</WTROW>
          <WTROW margin-bottom="3">
						<WTSTATIC col="1" merge="2" align="center" class="Prompt">
						  <WTSTATIC label="Processing100" space="1" bold="true" fontsize="3"/>
              <WTSTATIC label="ClickHere" bold="true" underline="true">
                <WTLINK name="PARAM(URL)" type="anchor" target="_blank"/>
              </WTSTATIC>
              <WTSTATIC newline="1"/>
              <WTSTATIC label="ProcessingFee"/>
						</WTSTATIC>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
          <WTROW margin-bottom="12">
						<WTSTATIC col="1" tag="WalletBalance"/>
						<WTSTATIC col="2" value="PARAM(Wallet)"/>
					</WTROW>
          
          <WTCODEGROUP>	
					  <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
					  <WTROW>
						  <WTSTATIC col="1" tag="CardType"/>
						  <WTSTATIC col="2">
							  <WTSTATIC label="Visa">
								  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(1)"/>
							  </WTSTATIC>
							  <WTSTATIC label="MasterCard">
								  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(2)"/>
							  </WTSTATIC>
							  <WTSTATIC label="Discover">
								  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(3)"/>
							  </WTSTATIC>
							  <WTSTATIC label="Amex">
								  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(4)"/>
							  </WTSTATIC>
						  </WTSTATIC>
					  </WTROW>
					  <WTROW>
						  <WTSTATIC col="1" tag="CardNumber"/>
						  <WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
					  </WTROW>
					  <WTROW>
						  <WTSTATIC col="1" tag="CardDate"/>
						  <WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
						  <WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
					  </WTROW>
					  <WTROW>
						  <WTSTATIC col="1" tag="CardName"/>
						  <WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
					  </WTROW>
					  <WTROW>
						  <WTSTATIC col="1" tag="CardCode"/>
						  <WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
					  </WTROW>
				  </WTCODEGROUP>	
          
          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="2" value="CONST(Purchase)" align="center" msg="ConfirmPurchase">
              <WTCLICK escape="false"> this.disabled = true; doSubmit(1,'&lt;xsl:value-of select="/DATA/LANGUAGE/LABEL[@name='ConfirmPurchase']"/&gt;');</WTCLICK>
            </WTBUTTON>
						<WTBUTTON col="1" merge="2" action="5" value="CONST(EditBilling)" align="center"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					</WTROW>
        
				</WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Scholarship Packs Order Form -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusGift4" caption="Scholarship Packs" navbar="false" footer="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusGift4" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Qty" datatype="number"/>
      <WTPARAM name="PV" datatype="number"/>
      <WTPARAM name="Option" datatype="number"/>
      <WTPARAM name="Wallet" datatype="currency"/>
      <WTPARAM name="WalletNumber" datatype="currency"/>
      <WTPARAM name="Mode" datatype="number"/>

      <WTPARAM name="PaymentID" datatype="number"/>
      <WTPARAM name="PayType" datatype="number"/>
      <WTPARAM name="PayDesc" datatype="text"/>
      <WTPARAM name="URL" datatype="text"/>

      <WTINCLUDE name="Billing.asp"/>
      <WTINCLUDE name="Payment.asp"/>
      <WTINCLUDE name="IP.asp"/>

      <WTCODEGROUP>
        <WTCUSTOM>
          reqURL = "http://" + reqSysServerName + reqSysServerPath + "Attachments/38/21/DirectPayments.pdf"
        </WTCUSTOM>
      </WTCODEGROUP>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="GetWallet">
        <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
          <WTMETHOD name="WalletTotal">
            <WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
            <WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            a = Split(Result, ";")
            reqWalletNumber = a(0)
            reqWallet = FormatCurrency(a(0),2)
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="AddOrder">
        <WTCALLSUB name="GetWallet"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="FORM(Qty)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="FORM(PV)"/>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;100&quot;)"/>

        <!-- PROCESS WALLET PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="greater-equal" value="CONST(CCUR(reqQty * reqPV))"/>
          <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV)"/>
          <!-- DEBIT WALLET -->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTCUSTOM>
              IP = Request.ServerVariables("REMOTE_ADDR")
              tmpLocation = GetIPCity( IP )
            </WTCUSTOM>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(5)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice * -1)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(Left(&quot;Course Certificate &quot; + IP + &quot; &quot; + tmpLocation, 500) )"/>
            <WTMETHOD name="Add">
              <WTPARAM name="PayoutID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- CREATE PAYMENT -->
          <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(90)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(3)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Total)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(Purpose)"/>
            <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(&quot;Course Certificate&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PayoutID)"/>
            <WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(CSTR(reqQty) + &quot;.0&quot; + CSTR(reqPV))">
              <WTCONDITION expr="CONST(LEN(CSTR(reqPV)))" oper="equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(CSTR(reqQty) + &quot;.&quot; + CSTR(reqPV))">
              <WTCONDITION expr="CONST(LEN(CSTR(reqPV)))" oper="not-equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTMETHOD name="Add">
              <WTPARAM name="reqPaymentID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- UPDATE WALLET PAYOUT REFERENCE-->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(PayoutID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="PARAM(PaymentID)"/>
            <WTMETHOD name="Save">
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- Custom Company Payment Post Processing -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(PaymentID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <!-- PROCESS CREDIT CARD PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="less" value="CONST(CCUR(reqQty * reqPV))"/>
          <WTCODEGROUP>
            <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV)"/>
            <WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(14)"/>
            <!-- Create Bitcoin Payment -->
          </WTCODEGROUP>

          <!-- get company options -->
          <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
            <WTMETHOD name="FetchCompany">
              <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
            </WTMETHOD>
            <WTMETHOD name="Load">
              <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
            <WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
          </WTOBJECT>

          <!-- Get Payment -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(PaymentID)" value="CONST(0)"/>
            <WTCUSTOM>
              tmpProcessor = 0
              tmpAcct = ""
            </WTCUSTOM>

            <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>

            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
              <WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
            </WTCODEGROUP>

            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(PaymentID)" value="CONST(CLng(Result))"/>
              <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
                <WTMETHOD name="Load">
                  <WTPARAM name="PaymentID" direction="input" value="PARAM(PaymentID)"/>
                  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
                </WTMETHOD>
                <WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(CSTR(reqQty) + &quot;.&quot; + CSTR(reqPV))"/>
                <WTMETHOD name="Save">
                  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
                </WTMETHOD>
              </WTOBJECT>
              <!-- Custom Company Payment Post Processing -->
              <WTCODEGROUP>
                <WTCONDITION expr="NoErrors"/>
                <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
                  <WTMETHOD name="Custom">
                    <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                    <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                    <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                    <WTPARAM name="Quantity" direction="input" value="PARAM(PaymentID)"/>
                    <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                    <WTPARAM name="Count" direction="return" datatype="number"/>
                  </WTMETHOD>
                </WTOBJECT>
              </WTCODEGROUP>
            </WTCODEGROUP>

          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Option)" value="CONST(3)"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="CONST(40)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="CONST(50)"/>
        <WTCALLSUB name="GetWallet"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="AddOrder"/>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
          <WTLINK name="CryptoPay" return="false">
            <WTPARAM name="PaymentID" value="PARAM(PaymentID)"/>
          </WTLINK>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="2" name="Update2" type="Update">
        <WTCALLSUB name="AddOrder"/>
        <WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)"/>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="200" align="right"/>
        <WTCOLUMN width="500" align="left"/>

        <WTFUNCTION name="UpdateTotal()">
          var qty = parseInt(document.getElementById('Qty').value);
          var pv = parseInt(document.getElementById('PV').value);
          var wallet = document.getElementById('Wallet').value;
          var msg;
          var number = Number( wallet.replace(/[^0-9\.]+/g,""));
          if( number >= qty * pv ) {
          msg = formatCurrency( qty * pv ) + ' from Wallet'
          }
          else {
          if ( (qty * pv) &lt; 100 ) {
          msg = formatCurrency( qty * pv * 1.05 ) + ' from Credit Card'
          }
          else {
          msg = formatCurrency( qty * pv ) + " bitcoin, cashier's check or wire"
          }
          }
          document.getElementById('Total').value = msg;
        </WTFUNCTION>

        <WTFUNCTION name="SetPack()">
          var opt = parseInt(document.getElementById('Option').value);
          var qty = 0;
          var pv = 0;
          if( opt == 1 ) { qty = 10; pv = 50; }
          if( opt == 2 ) { qty = 20; pv = 50; }
          if( opt == 3 ) { qty = 40; pv = 50; }
          if( opt == 4 ) { qty = 100; pv = 50; }
          if( opt == 5 ) { qty = 200; pv = 50; }
          if( qty > 0 ) {
          document.getElementById('Qty').value = qty;
          document.getElementById('PV').value = pv;
          UpdateTotal();
          }
        </WTFUNCTION>

        <WTFUNCTION name="formatCurrency(num)">
          num = num.toString().replace(/\$|\,/g,'');
          if(isNaN(num))
          num = "0";
          sign = (num == (num = Math.abs(num)));
          num = Math.floor(num*100+0.50000000001);
          cents = num%100;
          num = Math.floor(num/100).toString();
          if(cents&lt;10)
          cents = "0" + cents;
          for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
          num = num.substring(0,num.length-(4*i+3))+','+
          num.substring(num.length-(4*i+3));
          return (((sign)?'':'-') + '$' + num + '.' + cents);
          //return (((sign)?'':'-') + '$' + num);
        </WTFUNCTION>

        <WTLOAD>UpdateTotal()</WTLOAD>

        <WTROW>
          <WTHIDDEN value="PARAM(Wallet)"/>
          <WTHIDDEN value="PARAM(Qty)"/>
          <WTHIDDEN value="PARAM(PV)"/>
        </WTROW>
          
        <WTROW>
          <WTSTATIC col="1" merge="2" label="GiftOrder" class="PageHeading" align="left"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" align="center" class="Prompt">
              <WTSTATIC label="GiftOrderText2" bold="true" fontsize="3"/>
            </WTSTATIC>
          </WTROW>
          <WTROW margin-bottom="6">
            <WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" merge="2" align="center" class="Prompt">
              <WTSTATIC label="Processing2" bold="true" fontsize="3" newline="2"/>
              <WTSTATIC label="ClickHere" bold="true" underline="true">
                <WTLINK name="PARAM(URL)" type="anchor" target="_blank"/>
              </WTSTATIC>
            </WTSTATIC>
          </WTROW>
          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
              <WTCLICK>window.close()</WTCLICK>
            </WTBUTTON>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="GiftOrderText" align="left" class="prompt"/>
          </WTROW>
          <WTROW margin-bottom="6">
            <WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" merge="2" tag="Option" align="center"/>
            <WTCOMBO col="1" value="PARAM(Option)" prespace="false">
              <WTOPTION id="1" label="Pack1"/>
              <WTOPTION id="2" label="Pack2"/>
              <WTOPTION id="3" label="Pack3"/>
<!--              
              <WTOPTION id="4" label="Pack4"/>
              <WTOPTION id="5" label="Pack5"/>
-->              
              <WTCHANGE>SetPack()</WTCHANGE>
            </WTCOMBO>
          </WTROW>

          <WTROW margin-top="6" margin-bottom="6">
            <WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
          </WTROW>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" align="center" class="PageHeading">
              <WTSTATIC tag="TotalDue"/>
              <WTCODEGROUP>
                <WTTEXT name="Total" value="CONST($2000.00)" disabled="true" size="40" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" merge="2" align="center" class="Prompt">
              <WTSTATIC label="Processing" space="1" bold="true" fontsize="3"/>
            </WTSTATIC>
          </WTROW>

          <WTROW margin-top="6" margin-bottom="6">
            <WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTSTATIC col="1" tag="WalletBalance"/>
            <WTSTATIC col="2" value="PARAM(Wallet)"/>
          </WTROW>

          <WTROW margin-top="12" margin-bottom="12">
<!--            
            <WTBUTTON col="1" merge="2" value="CONST(Purchase)" align="center" msg="ConfirmPurchase">
              <WTCLICK escape="false"> this.disabled = true; doSubmit(1,'&lt;xsl:value-of select="/DATA/LANGUAGE/LABEL[@name='ConfirmPurchase']"/&gt;');</WTCLICK>
            </WTBUTTON>
-->            
            <WTBUTTON col="1" merge="2" value="CONST(Purchase2)" align="center" msg="ConfirmPurchase2">
              <WTCLICK escape="false"> this.disabled = true; doSubmit(2,'&lt;xsl:value-of select="/DATA/LANGUAGE/LABEL[@name='ConfirmPurchase2']"/&gt;');</WTCLICK>
            </WTBUTTON>
            <WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
              <WTCLICK>window.close()</WTCLICK>
            </WTBUTTON>
          </WTROW>

        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Certificate Consolidator -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusGift2" caption="Certificate Consolidator" navbar="false" footer="false" header="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusGift2" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Qty" datatype="number"/>
      <WTPARAM name="Cert" datatype="number"/>
      <WTPARAM name="Cnt" datatype="number"/>

      <WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="GetCertificates">
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(600)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="reqCnt" direction="return" datatype="number"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="Consolidate">
        <WTCALLSUB name="GetCertificates"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="FORM(Qty)"/>
        <WTSETATTRIBUTE name="PARAM(Cert)" value="FORM(Cert)"/>
        <!-- Custom Company Certificate Consolidation -->
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTCONDITION expr="PARAM(Qty)" oper="greater" value="CONST(0)"/>
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="PARAM(Cert)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="PARAM(Qty)"/>
            <WTPARAM name="reqCnt" direction="return" datatype="number"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="GetCertificates"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(Cert)" value="CONST(601)"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="Consolidate"/>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="200" align="right"/>
        <WTCOLUMN width="500" align="left"/>

        <WTFUNCTION name="UpdateTotal()">
          var qty = parseInt(document.getElementById('Qty').value);
          var cert = parseInt(document.getElementById('Cert').value);
          var available = document.getElementById('Cnt').value;
          var amt = 0;
          if( cert == 601 ) { amt = 5 }
          if( cert == 602 ) { amt = 13 }
          if( cert == 603 ) { amt = 30 }
          qty = qty * amt;
          if( available &lt; qty ) {
          qty = amt;
          document.getElementById('Qty').value = 1;
          alert('Oops! Not Enough $2 Cetificates Available.');
          }
          document.getElementById('Total').value = qty;
        </WTFUNCTION>

        <WTLOAD>UpdateTotal()</WTLOAD>

        <WTROW>
          <WTHIDDEN value="PARAM(Cnt)"/>
        </WTROW>

        <WTROW>
          <WTSTATIC col="1" merge="2" align="left" class="PageHeading">
            <WTCODEGROUP>
              <WTSTATIC space="5"/>
              <WTIMAGE value="CONST(certificate32.gif)" imgalign="absmiddle"/>
              <WTSTATIC space="5"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTSTATIC label="CertificateConsolidation" fontsize="4"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Cnt)" oper="less" value="CONST(5)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="NoConsolidate" align="center" class="PageHeading" fontcolor="red"/>
          </WTROW>
          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Cnt)" oper="greater-equal" value="CONST(5)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="GiftConsolidateText" align="left" class="prompt"/>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTSTATIC col="1" tag="Quantity"/>
            <WTTEXT col="2" value="PARAM(Qty)" size="3">
              <WTKEY>UpdateTotal()</WTKEY>
            </WTTEXT>
            <WTSTATIC col="2" tag="Certificate"/>
            <WTCOMBO col="2" value="PARAM(Cert)" prespace="false">
              <WTOPTION id="601" label="Cert10">
                <WTCONDITION expr="PARAM(Cnt)" oper="greater-equal" value="CONST(5)"/>
              </WTOPTION>
              <WTOPTION id="602" label="Cert25">
                <WTCONDITION expr="PARAM(Cnt)" oper="greater-equal" value="CONST(13)"/>
              </WTOPTION>
              <WTOPTION id="603" label="Cert50">
                <WTCONDITION expr="PARAM(Cnt)" oper="greater-equal" value="CONST(30)"/>
              </WTOPTION>
              <WTCHANGE>UpdateTotal()</WTCHANGE>
            </WTCOMBO>
          </WTROW>

          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" align="center" class="PageHeading">
              <WTSTATIC tag="TotalCertificates" space="1"/>
              <WTSTATIC value="PARAM(Cnt)" fontsize="4" space="5"/>
              <WTSTATIC tag="TotalConsolidated"/>
              <WTCODEGROUP>
                <WTTEXT name="Total" value="CONST(5)" disabled="true" size="2" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>

          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="2" action="1" value="CONST(Consolidate)" align="center" msg="ConfirmConsolidate"/>
            <WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
          </WTROW>

        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Certificate Splitter -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusGift3" caption="Certificate Splitter" navbar="false" footer="false" header="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusGift3" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Qty" datatype="number"/>
      <WTPARAM name="Cert" datatype="number"/>
      <WTPARAM name="Cnt10" datatype="number"/>
      <WTPARAM name="Cnt25" datatype="number"/>
      <WTPARAM name="Cnt50" datatype="number"/>

      <WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="GetCertificates">
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(600)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(1)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCUSTOM>
              a = Split(Result, ";")
              reqCnt10 = a(0)
              reqCnt25 = a(1)
              reqCnt50 = a(2)
            </WTCUSTOM>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="SplitCertificates">
        <WTCALLSUB name="GetCertificates"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="FORM(Qty)"/>
        <WTSETATTRIBUTE name="PARAM(Cert)" value="FORM(Cert)"/>
        <!-- Custom Company Certificate Splitter -->
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTCONDITION expr="PARAM(Qty)" oper="greater" value="CONST(0)"/>
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="PARAM(Cert)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="PARAM(Qty)"/>
            <WTPARAM name="reqCnt" direction="return" datatype="number"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="GetCertificates"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(Cert)" value="CONST(613)">
          <WTCONDITION expr="PARAM(Cnt50)" oper="greater" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="PARAM(Cert)" value="CONST(612)">
          <WTCONDITION expr="PARAM(Cnt25)" oper="greater" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="PARAM(Cert)" value="CONST(611)">
          <WTCONDITION expr="PARAM(Cnt10)" oper="greater" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="SplitCertificates"/>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="200" align="right"/>
        <WTCOLUMN width="500" align="left"/>

        <WTFUNCTION name="UpdateTotal()">
          var qty = parseInt(document.getElementById('Qty').value);
          var cert = parseInt(document.getElementById('Cert').value);
          var amt = 0;
          if( cert == 611 ) { amt = document.getElementById('Cnt10').value; }
          if( cert == 612 ) { amt = document.getElementById('Cnt25').value; }
          if( cert == 613 ) { amt = document.getElementById('Cnt50').value; }
          if( qty &gt; amt ) {
          qty = 1;
          document.getElementById('Qty').value = 1;
          alert('Oops! Not Enough Cetificates Available.');
          }
          document.getElementById('Available').value = amt;
          document.getElementById('Total').value = qty;
        </WTFUNCTION>

        <WTLOAD>UpdateTotal()</WTLOAD>

        <WTROW>
          <WTHIDDEN value="PARAM(Cnt10)"/>
          <WTHIDDEN value="PARAM(Cnt25)"/>
          <WTHIDDEN value="PARAM(Cnt50)"/>
        </WTROW>

        <WTROW>
          <WTSTATIC col="1" merge="2" align="left" class="PageHeading">
            <WTCODEGROUP>
              <WTSTATIC space="5"/>
              <WTIMAGE value="CONST(certificate32.gif)" imgalign="absmiddle"/>
              <WTSTATIC space="5"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTSTATIC label="CertificateSplit" fontsize="4"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Cnt10)" oper="equal" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(Cnt25)" oper="equal" value="CONST(0)" connector="and"/>
          <WTCONDITION expr="PARAM(Cnt50)" oper="equal" value="CONST(0)" connector="and"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="NoSplit" align="center" class="PageHeading" fontcolor="red"/>
          </WTROW>
          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Cnt10)" oper="greater" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(Cnt25)" oper="greater" value="CONST(0)" connector="or"/>
          <WTCONDITION expr="PARAM(Cnt50)" oper="greater" value="CONST(0)" connector="or"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="GiftSplitText" align="left" class="prompt"/>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTSTATIC col="1" tag="Quantity"/>
            <WTTEXT col="2" value="PARAM(Qty)" size="3">
              <WTKEY>UpdateTotal()</WTKEY>
            </WTTEXT>
            <WTSTATIC col="2" tag="Certificate"/>
            <WTCOMBO col="2" value="PARAM(Cert)" prespace="false">
              <WTOPTION id="611" label="Cert10">
                <WTCONDITION expr="PARAM(Cnt10)" oper="greater" value="CONST(0)"/>
              </WTOPTION>
              <WTOPTION id="612" label="Cert25">
                <WTCONDITION expr="PARAM(Cnt25)" oper="greater" value="CONST(0)"/>
              </WTOPTION>
              <WTOPTION id="613" label="Cert50">
                <WTCONDITION expr="PARAM(Cnt50)" oper="greater" value="CONST(0)"/>
              </WTOPTION>
              <WTCHANGE>UpdateTotal()</WTCHANGE>
            </WTCOMBO>
          </WTROW>

          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" align="center" class="PageHeading">
              <WTSTATIC tag="TotalCertificates" space="1"/>
              <WTCODEGROUP>
                <WTTEXT name="Available" value="CONST(1)" disabled="true" size="2" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/>
              </WTCODEGROUP>
              <WTSTATIC space="5"/>
              <WTSTATIC tag="TotalSplit"/>
              <WTCODEGROUP>
                <WTTEXT name="Total" value="CONST(1)" disabled="true" size="2" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>

          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="2" action="1" value="CONST(Split)" align="center" msg="ConfirmSplit"/>
            <WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
          </WTROW>

        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Affiliate Package Order Form -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusOrder2" caption="Affiliate Package" navbar="false" footer="false" header="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusOrder2" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="BillingID" datatype="number"/>
      <WTPARAM name="Package" datatype="number"/>
      <WTPARAM name="AutoOrder" datatype="number"/>
      <WTPARAM name="Wallet" datatype="currency"/>
      <WTPARAM name="WalletNumber" datatype="currency"/>
      <WTPARAM name="Result" datatype="number"/>

      <WTPARAM name="PayType" datatype="number"/>
      <WTPARAM name="PayDesc" datatype="text"/>

      <WTINCLUDE name="Billing.asp"/>
      <WTINCLUDE name="Payment.asp"/>
      <WTINCLUDE name="IP.asp"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="GetBilling">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(0)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(101)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;102&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(102)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;103&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(103)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;106&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(106)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;107&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(107)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;108&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(Package)" value="CONST(108)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
          <WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
          <WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
            <WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
            <WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
            <WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlBilling" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="GetWallet">
        <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
          <WTMETHOD name="WalletTotal">
            <WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
            <WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            a = Split(Result, ";")
            reqWalletNumber = a(0)
            reqWallet = FormatCurrency(a(0),2)
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="AddOrder">
        <WTCALLSUB name="GetWallet"/>
        <WTSETATTRIBUTE name="PARAM(Package)" value="FORM(Package)"/>
        <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
        <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(10)">
          <WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(101)"/>
          <WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(106)" connector="or"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(25)">
          <WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(102)"/>
          <WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(107)" connector="or"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(50)">
          <WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(103)"/>
          <WTCONDITION expr="PARAM(Package)" oper="equal" value="CONST(108)" connector="or"/>
        </WTSETATTRIBUTE>

        <!-- PROCESS WALLET PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)"/>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="greater-equal" value="CONST(CCUR(BillingPrice))" connector="and"/>
          <!-- DEBIT WALLET -->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTCUSTOM>
              IP = Request.ServerVariables("REMOTE_ADDR")
              tmpLocation = GetIPCity( IP )
            </WTCUSTOM>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(5)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice * -1)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(Left(&quot;Affiliate Pack &quot; + IP + &quot; &quot; + tmpLocation, 500) )"/>
            <WTMETHOD name="Add">
              <WTPARAM name="PayoutID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- CREATE PAYMENT -->
          <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(90)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(3)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Total)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Purpose)" value="PARAM(Package)"/>
            <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(&quot;Affiliate Pack&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PayoutID)"/>
            <WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
            <WTMETHOD name="Add">
              <WTPARAM name="PaymentID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- UPDATE WALLET PAYOUT REFERENCE-->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(PayoutID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PaymentID)"/>
            <WTMETHOD name="Save">
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- Custom Company Payment Post Processing -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
            <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)"/>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <!-- PROCESS BILLING METHOD / CREDIT CARD PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)"/>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="less" value="CONST(CCUR(BillingPrice))" connector="and"/>

          <WTCALLSUB name="GetBilling"/>
          <WTSETATTRIBUTE name="CONST(tmpBillingPrice)" value="CONST(BillingPrice)"/>
            <!-- Add Credit Card Fees -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(PayType)" oper="less-equal" value="CONST(4)"/>
            <WTSETATTRIBUTE name="CONST(tmpBillingPrice)" value="CONST(11)">
              <WTCONDITION expr="CONST(BillingPrice)" oper="equal" value="CONST(10)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="CONST(tmpBillingPrice)" value="CONST(27)">
              <WTCONDITION expr="CONST(BillingPrice)" oper="equal" value="CONST(25)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="CONST(tmpBillingPrice)" value="CONST(53)">
              <WTCONDITION expr="CONST(BillingPrice)" oper="equal" value="CONST(50)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>

          <!-- get company options -->
          <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
            <WTMETHOD name="FetchCompany">
              <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
            </WTMETHOD>
            <WTMETHOD name="Load">
              <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
            <WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
            <WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
            <WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
            <WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
            <WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
            <WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
            <WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
          </WTOBJECT>

          <!-- Get Payment -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
            <WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
            <WTCUSTOM>
              tmpProcessor = 0
              tmpAcct = ""
              Select Case reqPayType
              Case 1, 2, 3, 4	'Process Credit Cards
              tmpProcessor = tmpCardProcessor
              tmpAcct = tmpCardAcct
              Case 5 'Process Electronic Checks
              tmpProcessor = tmpCheckProcessor
              tmpAcct = tmpCheckAcct
              Case 11, 12, 13 'Process Wallets
              tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
              End Select
            </WTCUSTOM>

            <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, tmpBillingPrice, reqPackage, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>

            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
              <WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="NoErrors"/>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)">
                <WTCONDITION expr="PARAM(PayType)" oper="less-equal" value="CONST(4)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(3)">
                <WTCONDITION expr="PARAM(PayType)" oper="greater" value="CONST(4)"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(AutoOrder)" oper="not-equal" value="SYSCON(NO)"/>
            <WTCONDITION expr="CONST(BillingPrice)" oper="equal" value="CONST(0)" connector="or"/>
            <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
              <WTMETHOD name="Load">
                <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
                <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(BillingPrice)"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="ATTR(Options2)"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="CONST(Replace( Options2, &quot;101&quot;, &quot;&quot;))"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="CONST(Replace( Options2, &quot;102&quot;, &quot;&quot;))"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="CONST(Replace( Options2, &quot;103&quot;, &quot;&quot;))"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="CONST(Replace( Options2, &quot;106&quot;, &quot;&quot;))"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="CONST(Replace( Options2, &quot;107&quot;, &quot;&quot;))"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="CONST(Replace( Options2, &quot;108&quot;, &quot;&quot;))"/>
              <WTSETATTRIBUTE name="CONST(Options2)" value="CONST(Replace( Options2, &quot;,&quot;, &quot;&quot;))"/>
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)"/>
                <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Options2 + &quot;,&quot; + CSTR(reqPackage))"/>
                <WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DateAdd(&quot;m&quot;, 1, reqSysDate))"/>
              </WTCODEGROUP>
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(BillingPrice)" oper="equal" value="CONST(0)"/>
                <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Options2)"/>
                <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
                <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(2)"/>
              </WTCODEGROUP>
              <WTMETHOD name="Save">
                <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(AutoOrder)" value="CONST(1)"/>
        <WTCALLSUB name="GetBilling"/>
        <WTCALLSUB name="GetWallet"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="AddOrder"/>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <WTACTION id="5" name="Billing" type="Update">
        <WTRETURN>
          <WTLINK name="2903" nolocaldata="true">
            <WTPARAM name="MemberID" value="PARAM(MemberID)"/>
            <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
            <WTPARAM name="BillingID" value="PARAM(BillingID)"/>
            <WTPARAM name="contentpage" value="CONST(3)"/>
          </WTLINK>
          <!-- FIX SSL					
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
        </WTRETURN>
      </WTACTION>

      <WTACTION id="7" name="AddBilling" type="Update">
        <WTRETURN>
          <WTLINK name="2902" nolocaldata="true">
            <WTPARAM name="MemberID" value="PARAM(MemberID)"/>
            <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
            <WTPARAM name="contentpage" value="CONST(3)"/>
          </WTLINK>
          <!-- FIX SSL					
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
        </WTRETURN>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="200" align="right"/>
        <WTCOLUMN width="500" align="left"/>

        <WTFUNCTION name="UpdateTotal()">
          var paytype = parseInt(document.getElementById('PayType').value);
          var pkg = parseInt(document.getElementById('Package').value);
          var wallet = document.getElementById('Wallet').value;
          var price = 0;
          var msg;
          var number = Number( wallet.replace(/[^0-9\.]+/g,""));
          if( pkg == 101 || pkg == 106 ) { price = 10 }
          if( pkg == 102 || pkg == 107 ) { price = 25 }
          if( pkg == 103 || pkg == 108 ) { price = 50 }

          if( price == 0 ) {
          msg = formatCurrency( price );
          }
          else {
          if( number >= price ) {
          msg = formatCurrency( price ) + ' from Wallet';
          }
          else {
            if( paytype == 1 ) {
              if( price == 10 ) { price = 11 }
              if( price == 25 ) { price = 27 }
              if( price == 50 ) { price = 53 }
              msg = formatCurrency( price ) + ' from Credit Card';
            }
            if( paytype == 4 ) {
              msg = formatCurrency( price ) + ' from Cryptocurrency'; 
            }
          }
          }
          document.getElementById('Total').value = msg;
        </WTFUNCTION>

        <WTFUNCTION name="formatCurrency(num)">
          num = num.toString().replace(/\$|\,/g,'');
          if(isNaN(num))
          num = "0";
          sign = (num == (num = Math.abs(num)));
          num = Math.floor(num*100+0.50000000001);
          cents = num%100;
          num = Math.floor(num/100).toString();
          if(cents&lt;10)
          cents = "0" + cents;
          for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
          num = num.substring(0,num.length-(4*i+3))+','+
          num.substring(num.length-(4*i+3));
          return (((sign)?'':'-') + '$' + num + '.' + cents);
          //return (((sign)?'':'-') + '$' + num);
        </WTFUNCTION>

        <WTLOAD>UpdateTotal()</WTLOAD>

        <WTROW>
          <WTHIDDEN value="PARAM(BillingID)"/>
          <WTHIDDEN value="PARAM(Wallet)"/>
          <WTHIDDEN value="ATTR(Billing.PayType)"/>
        </WTROW>
        <WTSTATIC label="AutoOrder"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" label="AffiliatePackage" class="PageHeading" align="left"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
          <WTROW margin-top="24" margin-bottom="24">
            <WTSTATIC col="1" merge="2" align="center" fontsize="4" fontcolor="blue">
              <WTSTATIC label="SuccessfulPurchase">
                <WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(1)"/>
              </WTSTATIC>
              <WTSTATIC label="SuccessfulRemove">
                <WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(2)"/>
              </WTSTATIC>
              <WTSTATIC label="SuccessfulSubmit">
                <WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(3)"/>
              </WTSTATIC>
            </WTSTATIC>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
              <WTCLICK>window.close()</WTCLICK>
            </WTBUTTON>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
            <WTROW margin-bottom="6">
              <WTSTATIC col="1" merge="2" label="NoBilling" align="left" class="PageHeading"/>
            </WTROW>
            <WTROW margin-bottom="12">
              <WTBUTTON col="1" merge="2" action="7" value="CONST(AddBilling)" align="center"/>
              <WTBUTTON col="1" merge="2" value="CONST(Close)">
                <WTCLICK>window.close()</WTCLICK>
              </WTBUTTON>
            </WTROW>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)"/>
            <WTROW margin-bottom="6">
              <WTSTATIC col="1" merge="2" label="AdPackOrderText" align="left" class="prompt"/>
            </WTROW>
            <WTROW margin-bottom="6">
              <WTCHECK col="1" merge="2" value="PARAM(AutoOrder)" align="left"/>
            </WTROW>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" merge="2" tag="AffiliatePack" align="center"/>
              <WTCOMBO col="1" merge="2" value="PARAM(Package)" prespace="false">
                <WTOPTION id="101" label="AffiliatePack10"/>
                <WTOPTION id="102" label="AffiliatePack25"/>
                <WTOPTION id="103" label="AffiliatePack50"/>
                <WTOPTION id="106" label="AdPack10"/>
                <WTOPTION id="107" label="AdPack25"/>
                <WTOPTION id="108" label="AdPack50"/>
                <WTOPTION id="0" label="RemovePack"/>
                <WTCHANGE>UpdateTotal()</WTCHANGE>
              </WTCOMBO>
            </WTROW>

            <WTROW margin-top="6" margin-bottom="6">
              <WTSTATIC col="1" merge="2" align="center" class="PageHeading">
                <WTSTATIC tag="TotalDue"/>
                <WTCODEGROUP>
                  <WTTEXT name="Total" value="CONST($10.00)" disabled="true" size="30" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>
            <WTROW>
              <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
              <WTSTATIC col="1" merge="2" label="ProcessingFee" align="center" class="Prompt"/>
            </WTROW>

            <WTROW margin-top="12" margin-bottom="12">
              <WTSTATIC col="1" tag="WalletBalance"/>
              <WTSTATIC col="2" value="PARAM(Wallet)"/>
            </WTROW>

            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
              <WTROW>
                <WTSTATIC col="1" tag="CardType"/>
                <WTSTATIC col="2">
                  <WTSTATIC label="Visa">
                    <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(1)"/>
                  </WTSTATIC>
                  <WTSTATIC label="MasterCard">
                    <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(2)"/>
                  </WTSTATIC>
                  <WTSTATIC label="Discover">
                    <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(3)"/>
                  </WTSTATIC>
                  <WTSTATIC label="Amex">
                    <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(4)"/>
                  </WTSTATIC>
                </WTSTATIC>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" tag="CardNumber"/>
                <WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" tag="CardDate"/>
                <WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
                <WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" tag="CardName"/>
                <WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" tag="CardCode"/>
                <WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
              </WTROW>
            </WTCODEGROUP>

            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(4)"/>
              <WTROW>
                <WTSTATIC col="1" tag="Cryptocurrency"/>
                <WTSTATIC col="2">
                  <WTSTATIC label="BitCoin">
                    <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(14)"/>
                  </WTSTATIC>
                  <WTSTATIC label="Nexxus">
                    <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(16)"/>
                  </WTSTATIC>
                </WTSTATIC>
              </WTROW>
            </WTCODEGROUP>
            
            <WTROW margin-top="12" margin-bottom="12">
              <WTBUTTON col="1" merge="2" value="CONST(Purchase)" align="center" msg="ConfirmPurchase">
                <WTCLICK escape="false"> this.disabled = true; doSubmit(1,'&lt;xsl:value-of select="/DATA/LANGUAGE/LABEL[@name='ConfirmPurchase']"/&gt;');</WTCLICK>
              </WTBUTTON>
              <WTBUTTON col="1" merge="2" action="5" value="CONST(EditBilling)" align="center"/>
              <WTBUTTON col="1" merge="2" value="CONST(Close)">
                <WTCLICK>window.close()</WTCLICK>
              </WTBUTTON>
            </WTROW>

          </WTCODEGROUP>
        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Ad Package Affiliate Order Form -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusAd" caption="Barter Package" navbar="false" footer="false" header="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusAd" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="BillingID" datatype="number"/>
      <WTPARAM name="Qty" datatype="number"/>
      <WTPARAM name="PV" datatype="number"/>
      <WTPARAM name="Option" datatype="number"/>
      <WTPARAM name="Wallet" datatype="currency"/>
      <WTPARAM name="WalletNumber" datatype="currency"/>

      <WTPARAM name="PayType" datatype="number"/>
      <WTPARAM name="PayDesc" datatype="text"/>

      <WTINCLUDE name="Billing.asp"/>
      <WTINCLUDE name="Payment.asp"/>
      <WTINCLUDE name="IP.asp"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="GetBilling">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
        </WTOBJECT>
        <WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
          <WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
          <WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
            <WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
            <WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
            <WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlBilling" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="GetWallet">
        <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
          <WTMETHOD name="WalletTotal">
            <WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
            <WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            a = Split(Result, ";")
            reqWalletNumber = a(0)
            reqWallet = FormatCurrency(a(0),2)
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="AddOrder">
        <WTCALLSUB name="GetWallet"/>
        <WTSETATTRIBUTE name="PARAM(Qty)" value="FORM(Qty)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="FORM(PV)"/>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;106&quot;)">
          <WTCONDITION expr="PARAM(PV)" oper="equal" value="CONST(10)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;107&quot;)">
          <WTCONDITION expr="PARAM(PV)" oper="equal" value="CONST(25)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;108&quot;)">
          <WTCONDITION expr="PARAM(PV)" oper="equal" value="CONST(50)"/>
        </WTSETATTRIBUTE>

        <!-- PROCESS WALLET PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="greater-equal" value="CONST(CCUR(reqQty * reqPV))"/>
          <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV)"/>
          <!-- DEBIT WALLET -->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTCUSTOM>
              IP = Request.ServerVariables("REMOTE_ADDR")
              tmpLocation = GetIPCity( IP )
            </WTCUSTOM>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(5)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice * -1)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(Left(&quot;Barter Package &quot; + IP + &quot; &quot; + tmpLocation, 500) )"/>
            <WTMETHOD name="Add">
              <WTPARAM name="PayoutID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- CREATE PAYMENT -->
          <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(90)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(3)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Total)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(Purpose)"/>
            <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(&quot;Barter Package&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PayoutID)"/>
            <WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(Retail)" value="PARAM(Qty)"/>
            <WTMETHOD name="Add">
              <WTPARAM name="PaymentID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- UPDATE WALLET PAYOUT REFERENCE-->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(PayoutID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PaymentID)"/>
            <WTMETHOD name="Save">
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- Custom Company Payment Post Processing -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <!-- PROCESS CREDIT CARD PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="less" value="CONST(CCUR(reqQty * reqPV))"/>
          <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV * 1.05)"/>
          <WTCALLSUB name="GetBilling"/>

          <!-- get company options -->
          <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
            <WTMETHOD name="FetchCompany">
              <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
            </WTMETHOD>
            <WTMETHOD name="Load">
              <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
            <WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
            <WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
            <WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
            <WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
            <WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
            <WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
            <WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
          </WTOBJECT>

          <!-- Get Payment -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
            <WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
            <WTCUSTOM>
              tmpProcessor = 0
              tmpAcct = ""
              Select Case reqPayType
              Case 1, 2, 3, 4	'Process Credit Cards
              tmpProcessor = tmpCardProcessor
              tmpAcct = tmpCardAcct
              Case 5 'Process Electronic Checks
              tmpProcessor = tmpCheckProcessor
              tmpAcct = tmpCheckAcct
              Case 11, 12, 13 'Process Wallets
              tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
              End Select
            </WTCUSTOM>

            <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>

            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
              <WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
            </WTCODEGROUP>

            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
              <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
                <WTMETHOD name="Load">
                  <WTPARAM name="PaymentID" direction="input" value="CONST(PaymentID)"/>
                  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
                </WTMETHOD>
                <WTSETATTRIBUTE name="ATTR(Retail)" value="PARAM(Qty)"/>
                <WTMETHOD name="Save">
                  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
                </WTMETHOD>
              </WTOBJECT>
              <!-- Custom Company Payment Post Processing -->
              <WTCODEGROUP>
                <WTCONDITION expr="NoErrors"/>
                <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
                  <WTMETHOD name="Custom">
                    <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                    <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                    <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                    <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
                    <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                    <WTPARAM name="Count" direction="return" datatype="number"/>
                  </WTMETHOD>
                </WTOBJECT>
              </WTCODEGROUP>
            </WTCODEGROUP>

          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Qty)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="CONST(10)"/>
        <WTCALLSUB name="GetBilling"/>
        <WTCALLSUB name="GetWallet"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="AddOrder"/>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <WTACTION id="5" name="Billing" type="Update">
        <WTRETURN>
          <WTLINK name="2903" nolocaldata="true">
            <WTPARAM name="MemberID" value="PARAM(MemberID)"/>
            <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
            <WTPARAM name="BillingID" value="PARAM(BillingID)"/>
            <WTPARAM name="contentpage" value="CONST(3)"/>
          </WTLINK>
          <!-- FIX SSL					
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
        </WTRETURN>
      </WTACTION>

      <WTACTION id="7" name="AddBilling" type="Update">
        <WTRETURN>
          <WTLINK name="2902" nolocaldata="true">
            <WTPARAM name="MemberID" value="PARAM(MemberID)"/>
            <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
            <WTPARAM name="contentpage" value="CONST(3)"/>
          </WTLINK>
          <!-- FIX SSL					
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
        </WTRETURN>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="200" align="right"/>
        <WTCOLUMN width="500" align="left"/>

        <WTFUNCTION name="UpdateTotal()">
          var qty = parseInt(document.getElementById('Qty').value);
          var pv = parseInt(document.getElementById('PV').value);
          var wallet = document.getElementById('Wallet').value;
          var msg;
          var number = Number( wallet.replace(/[^0-9\.]+/g,""));
          if( number >= qty * pv ) {
          msg = formatCurrency( qty * pv ) + ' from Wallet'
          }
          else {
          msg = formatCurrency( qty * pv * 1.05 ) + ' from Credit Card'
          }
          document.getElementById('Total').value = msg;
        </WTFUNCTION>

        <WTFUNCTION name="formatCurrency(num)">
          num = num.toString().replace(/\$|\,/g,'');
          if(isNaN(num))
          num = "0";
          sign = (num == (num = Math.abs(num)));
          num = Math.floor(num*100+0.50000000001);
          cents = num%100;
          num = Math.floor(num/100).toString();
          if(cents&lt;10)
          cents = "0" + cents;
          for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
          num = num.substring(0,num.length-(4*i+3))+','+
          num.substring(num.length-(4*i+3));
          return (((sign)?'':'-') + '$' + num + '.' + cents);
          //return (((sign)?'':'-') + '$' + num);
        </WTFUNCTION>

        <WTLOAD>UpdateTotal()</WTLOAD>

        <WTROW>
          <WTHIDDEN value="PARAM(BillingID)"/>
          <WTHIDDEN value="PARAM(Wallet)"/>
        </WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" label="AdPackOrder" class="PageHeading" align="left"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="NoBilling" align="left" class="PageHeading"/>
          </WTROW>
          <WTROW>
            <WTBUTTON col="1" merge="2" action="7" value="CONST(AddBilling)" align="center"/>
            <WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center" btnclass="smbutton"/>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" label="AdPackOrderText" align="left" class="prompt"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" merge="2" tag="Quantity" align="center"/>
            <WTTEXT col="1" value="PARAM(Qty)" size="3">
              <WTKEY>UpdateTotal()</WTKEY>
            </WTTEXT>
            <WTSTATIC col="1" tag="AdPack"/>
            <WTCOMBO col="1" value="PARAM(PV)" prespace="false">
              <WTOPTION id="10" label="AdPack10"/>
              <WTOPTION id="25" label="AdPack25"/>
              <WTOPTION id="50" label="AdPack50"/>
              <WTCHANGE>UpdateTotal()</WTCHANGE>
            </WTCOMBO>
          </WTROW>

          <WTROW margin-top="6" margin-bottom="6">
            <WTSTATIC col="1" merge="2" align="center" class="PageHeading">
              <WTSTATIC tag="TotalDue"/>
              <WTCODEGROUP>
                <WTTEXT name="Total" value="CONST($10.00)" disabled="true" size="30" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTSTATIC col="1" merge="2" label="ProcessingFee" align="center" class="Prompt"/>
          </WTROW>

          <WTROW margin-bottom="12">
            <WTSTATIC col="1" tag="WalletBalance"/>
            <WTSTATIC col="2" value="PARAM(Wallet)"/>
          </WTROW>

          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
            <WTROW>
              <WTSTATIC col="1" tag="CardType"/>
              <WTSTATIC col="2">
                <WTSTATIC label="Visa">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(1)"/>
                </WTSTATIC>
                <WTSTATIC label="MasterCard">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(2)"/>
                </WTSTATIC>
                <WTSTATIC label="Discover">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(3)"/>
                </WTSTATIC>
                <WTSTATIC label="Amex">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(4)"/>
                </WTSTATIC>
              </WTSTATIC>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" tag="CardNumber"/>
              <WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" tag="CardDate"/>
              <WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
              <WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" tag="CardName"/>
              <WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" tag="CardCode"/>
              <WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
            </WTROW>
          </WTCODEGROUP>

          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="2" value="CONST(Purchase)" align="center" msg="ConfirmPurchase">
              <WTCLICK escape="false"> this.disabled = true; doSubmit(1,'&lt;xsl:value-of select="/DATA/LANGUAGE/LABEL[@name='ConfirmPurchase']"/&gt;');</WTCLICK>
            </WTBUTTON>
            <WTBUTTON col="1" merge="2" action="5" value="CONST(EditBilling)" align="center"/>
            <WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
          </WTROW>

        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!-- Nexxus Barter Package Consumer Order Form -->
    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusAd2" caption="Barter Package" navbar="false" footer="false" header="false"
    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="NexxusAd2">
      <!--============================================================================================-->
      <WTPARAM name="ConsumerID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Qty" datatype="number"/>
      <WTPARAM name="PV" datatype="number"/>
      <WTPARAM name="PayType" datatype="number"/>
      <WTPARAM name="PayDesc" datatype="text"/>

      <WTINCLUDE name="Billing.asp"/>
      <WTINCLUDE name="PaymentConsumer.asp"/>
      <WTINCLUDE name="IP.asp"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)"/>
      </WTCODEGROUP>

      <WTSUB name="AddOrder">
        <WTSETATTRIBUTE name="PARAM(Qty)" value="FORM(Qty)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="FORM(PV)"/>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;116&quot;)">
          <WTCONDITION expr="PARAM(PV)" oper="equal" value="CONST(10)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;117&quot;)">
          <WTCONDITION expr="PARAM(PV)" oper="equal" value="CONST(25)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;118&quot;)">
          <WTCONDITION expr="PARAM(PV)" oper="equal" value="CONST(50)"/>
        </WTSETATTRIBUTE>

        <!-- PROCESS CREDIT CARD PAYMENT ***********************************************************-->
        <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(reqQty * reqPV * 1.05)"/>

        <!-- Get Billing Info -->
        <WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="ATTR(PayType)" value="PARAM(PayType)"/>
          <WTSETATTRIBUTE name="ATTR(CardType)" value="FORM(CardType)"/>
          <WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)"/>
          <WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)"/>
          <WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)"/>
          <WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)"/>
          <WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)"/>
          <WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
        </WTOBJECT>

        <!-- get company options -->
        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
          <WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
          <WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
          <WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
          <WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
          <WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
          <WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
          <WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
        </WTOBJECT>

        <!-- Get Payment -->
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
          <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
          <WTCUSTOM>
            tmpProcessor = 0
            tmpAcct = ""
            Select Case reqPayType
            Case 1, 2, 3, 4	'Process Credit Cards
            tmpProcessor = tmpCardProcessor
            tmpAcct = tmpCardAcct
            Case 5 'Process Electronic Checks
            tmpProcessor = tmpCheckProcessor
            tmpAcct = tmpCheckAcct
            End Select
          </WTCUSTOM>

          <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqConsumerID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>

          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
            <WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
            <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
              <WTMETHOD name="Load">
                <WTPARAM name="PaymentID" direction="input" value="CONST(PaymentID)"/>
                <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="ATTR(Retail)" value="PARAM(Qty)"/>
              <WTMETHOD name="Save">
                <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
              </WTMETHOD>
            </WTOBJECT>
            <!-- Custom Company Payment Post Processing -->
            <WTCODEGROUP>
              <WTCONDITION expr="NoErrors"/>
              <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
                <WTMETHOD name="Custom">
                  <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                  <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                  <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                  <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
                  <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                  <WTPARAM name="Count" direction="return" datatype="number"/>
                </WTMETHOD>
              </WTOBJECT>
            </WTCODEGROUP>
          </WTCODEGROUP>

        </WTCODEGROUP>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Qty)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(PV)" value="CONST(10)"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="AddOrder"/>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="200" align="right"/>
        <WTCOLUMN width="500" align="left"/>

        <WTFUNCTION name="UpdateTotal()">
          var qty = parseInt(document.getElementById('Qty').value);
          var pv = parseInt(document.getElementById('PV').value);
          document.getElementById('Total').value = formatCurrency( qty * pv * 1.05 ) + ' from Credit Card'
        </WTFUNCTION>

        <WTFUNCTION name="formatCurrency(num)">
          num = num.toString().replace(/\$|\,/g,'');
          if(isNaN(num))
          num = "0";
          sign = (num == (num = Math.abs(num)));
          num = Math.floor(num*100+0.50000000001);
          cents = num%100;
          num = Math.floor(num/100).toString();
          if(cents&lt;10)
          cents = "0" + cents;
          for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
          num = num.substring(0,num.length-(4*i+3))+','+
          num.substring(num.length-(4*i+3));
          return (((sign)?'':'-') + '$' + num + '.' + cents);
          //return (((sign)?'':'-') + '$' + num);
        </WTFUNCTION>

        <WTLOAD>UpdateTotal()</WTLOAD>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" label="AdPackOrder" class="PageHeading" align="left"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" label="AdPackOrderText" align="left" class="prompt"/>
        </WTROW>
        <WTROW>
          <WTSTATIC col="1" merge="2" tag="Quantity" align="center"/>
          <WTTEXT col="1" value="PARAM(Qty)" size="3">
            <WTKEY>UpdateTotal()</WTKEY>
          </WTTEXT>
          <WTSTATIC col="1" tag="AdPack"/>
          <WTCOMBO col="1" value="PARAM(PV)" prespace="false">
            <WTOPTION id="10" label="AdPack10"/>
            <WTOPTION id="25" label="AdPack25"/>
            <WTOPTION id="50" label="AdPack50"/>
            <WTCHANGE>UpdateTotal()</WTCHANGE>
          </WTCOMBO>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTSTATIC col="1" merge="2" align="center" class="PageHeading">
            <WTSTATIC tag="TotalDue"/>
            <WTCODEGROUP>
              <WTTEXT name="Total" value="CONST($10.00)" disabled="true" size="30" style="BORDER:none; COLOR:black; BACKGROUND:#eaeaea; TEXT-ALIGN:left; font-size:18px;"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
        <WTROW>
          <WTSTATIC col="1" merge="2" label="ProcessingFee" align="center" class="Prompt"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="6">
          <WTSTATIC col="1" tag="CardType"/>
          <WTCOMBO col="2" value="ATTR(Billing.CardType)">
            <WTOPTION id="1" label="Visa"/>
            <WTOPTION id="2" label="MasterCard"/>
            <WTOPTION id="3" label="Discover"/>
            <WTOPTION id="4" label="Amex"/>
          </WTCOMBO>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="CardNumber"/>
          <WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="30"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="CardDate"/>
          <WTTEXT col="2" value="ATTR(Billing.CardMo)" size="5"/>
          <WTSTATIC col="2" tag="Year"/>
          <WTTEXT col="2" value="ATTR(Billing.CardYr)" size="5" prespace="false"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="CardName"/>
          <WTTEXT col="2" value="ATTR(Billing.CardName)" size="30"/>
        </WTROW>
        <WTROW>
          <WTSTATIC col="1" tag="CardCode"/>
          <WTTEXT col="2" value="ATTR(Billing.CardCode)" size="5"/>
        </WTROW>
          
        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" value="CONST(Purchase)" align="center" msg="ConfirmPurchase">
            <WTCLICK escape="false"> this.disabled = true; doSubmit(1,'&lt;xsl:value-of select="/DATA/LANGUAGE/LABEL[@name='ConfirmPurchase']"/&gt;');</WTCLICK>
          </WTBUTTON>
          <WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
      <WTWEBPAGE name="CrowdFund" caption="Nexxus Crowd Funding" header="false" navbar="false" footer="false" wrapper="wrapper1000"
        page-color="#777777" margin-width="0" navbar-width="0" content-width="1000"
        aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
        <!--============================================================================================-->

      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;crowdfund.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/21&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="1000" align="left" />

        <WTROW>
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="NexxusPaymentPortal" caption="Nexxus Payments" header="false" footer="false" navbar="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="NexxusPaymentPortal" secure="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="PaymentID" datatype="number"/>
      <WTPARAM name="Status" datatype="number"/>
      <WTPARAM name="Member2FA" datatype="number"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(Is2FA(reqSysUserID))"/>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(500)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            a = Split(Result, "|")
            reqStatus = a(0)
            reqPaymentID = a(1)
            tmpAmount = a(2)
          </WTCUSTOM>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;PaymentPortal.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
          <WTCUSTOM>
            If reqMember2FA = 0 Then str2FA = "Disabled" Else str2FA = "Enabled"
            If reqStatus = 1 Then strPayment = "First" Else strPayment = "Next"
            strAmount = FormatCurrency(tmpAmount)
            xmlHTMLFile = Replace( xmlHTMLFile, "{mid}", CStr(reqMemberID) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{pid}", CStr(reqPaymentID) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{2fa}", str2FA )
            xmlHTMLFile = Replace( xmlHTMLFile, "{amount}", strAmount )
            xmlHTMLFile = Replace( xmlHTMLFile, "{payment}", strPayment )
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="600" align="left"/>

        <WTROW margin-bottom="6">
          <WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
          <WTSTATIC col="1" label="NoPaymentDue" align="center" class="PageHeading"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" action="3" value="Return" align="center"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

  </WTWEBPAGES>
</WTROOT>