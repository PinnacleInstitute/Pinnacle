<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="75" name="Project" alias="pj" audit="false">
		<!--Identity-->
		<WTATTRIBUTE id="7501" name="ProjectID" type="number" identity="true" min="1" required="true" source="entity" title="true" />
		<!--Foreign Keys-->
		<WTATTRIBUTE id="7502" name="CompanyID" type="number" min="1" source="entity" />
		<WTATTRIBUTE id="7503" name="MemberID" type="number" min="1" source="entity" />
		<WTATTRIBUTE id="7504" name="ParentID" type="number" min="1" source="entity" />
		<WTATTRIBUTE id="7505" name="ForumID" type="number" source="entity" />
		<WTATTRIBUTE id="7506" name="ProjectTypeID" type="number" source="entity" />
		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="7510" name="NameLast" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="Member" name="NameLast" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7511" name="NameFirst" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="Member" name="NameFirst" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7512" name="MemberName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameFirst" />
			<WTCOMPUTE text=" " />
			<WTCOMPUTE name="NameLast" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7513" name="ProjectTypeName" type="text" length="40" min="1" max="40" source="join">
			<WTJOIN entity="ProjectType" name="ProjectTypeName" />
		</WTATTRIBUTE>
		<!--Attributes-->
		<WTATTRIBUTE id="7520" name="ProjectName" type="text" length="60" min="1" max="60" required="true" source="entity" />
		<WTATTRIBUTE id="7521" name="Description" type="text" length="1000" min="1" max="1000" source="entity" />
		<WTATTRIBUTE id="7522" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Started" />
			<WTENUM id="2" name="Completed" />
			<WTENUM id="3" name="Cancelled" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7523" name="Seq" type="number" source="entity" />
		<WTATTRIBUTE id="7524" name="IsChat" type="yesno" source="entity" />
		<WTATTRIBUTE id="7525" name="IsForum" type="yesno" source="entity" />
		<WTATTRIBUTE id="7526" name="Secure" type="number" source="entity" />
		<WTATTRIBUTE id="7530" name="EstStartDate" type="date" source="entity" />
		<WTATTRIBUTE id="7531" name="ActStartDate" type="date" source="entity" />
		<WTATTRIBUTE id="7532" name="VarStartDate" type="number" source="entity" />
		<WTATTRIBUTE id="7533" name="EstEndDate" type="date" source="entity" />
		<WTATTRIBUTE id="7534" name="ActEndDate" type="date" source="entity" />
		<WTATTRIBUTE id="7535" name="VarEndDate" type="number" source="entity" />
		<WTATTRIBUTE id="7536" name="EstCost" type="currency" source="entity" />
		<WTATTRIBUTE id="7537" name="TotCost" type="currency" source="entity" />
		<WTATTRIBUTE id="7538" name="VarCost" type="currency" source="entity" />
		<WTATTRIBUTE id="7539" name="Cost" type="currency" source="entity" />
		<WTATTRIBUTE id="7540" name="Hrs" type="currency" min="0" max="999999.9999" source="entity">
			<WTFORMAT value="###,##0.00" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7541" name="TotHrs" type="currency" min="0" max="999999.9999" source="entity">
			<WTFORMAT value="###,##0.00" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7542" name="Hierarchy" type="text" length="30" min="1" max="30" source="entity" language="false"/>
		<WTATTRIBUTE id="7543" name="ChangeDate" type="date" source="entity">
			<WTFORMAT value="m-d-yy h:mmam/pm"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7544" name="RefType" type="number" source="entity">
			<WTENUM id="81" name="Customer" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="7545" name="RefID" type="number" source="entity" />

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="7590" name="FromDate" type="date" source="entity" persist="false" />
		<WTATTRIBUTE id="7591" name="ToDate" type="date" source="entity" persist="false" />
		<WTATTRIBUTE id="7592" name="Notes" type="number" source="entity" persist="false" />
		<WTATTRIBUTE id="7593" name="Documents" type="number" source="entity" persist="false" />
		<WTATTRIBUTE id="7594" name="Messages" type="number" source="entity" persist="false" />
		<!--Indexes-->
		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID" />
		</WTINDEX>
		<WTINDEX name="ParentID">
			<WTATTRIBUTE name="ParentID" />
		</WTINDEX>
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID" />
			<WTATTRIBUTE name="Hierarchy" />
		</WTINDEX>
		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Project" entity="Project" alias="pj" />
			<WTRELATIONSHIP name="Common" entity="Project" alias="pj">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="pj" name="MemberID" relalias="me" relname="MemberID" />
				</WTENTITY>
				<WTENTITY name="ProjectType" entity="ProjectType" alias="pjt">
					<WTATTRIBUTE alias="pj" name="ProjectTypeID" relalias="pjt" relname="ProjectTypeID" />
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Member" entity="Project" alias="pj">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="pj" name="MemberID" relalias="me" relname="MemberID" />
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Assigned" entity="Project" alias="pj">
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="pj" name="MemberID" relalias="me" relname="MemberID" />
				</WTENTITY>
				<WTENTITY name="ProjectType" entity="ProjectType" alias="pjt">
					<WTATTRIBUTE alias="pj" name="ProjectTypeID" relalias="pjt" relname="ProjectTypeID" />
				</WTENTITY>
				<WTENTITY name="ProjectMember" entity="ProjectMember" alias="pjm">
					<WTATTRIBUTE alias="pj" name="ProjectID" relalias="pjm" relname="ProjectID" />
					<WTATTRIBUTE name="@MemberID" relalias="pjm" relname="MemberID" connector="and" validate="false" />
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>
		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="ProjectName" default="true" contains="true" />
			<WTATTRIBUTE name="Description" contains="true" />
			<WTATTRIBUTE name="ProjectID" />
		</WTENUM>
		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="PROJECT-STATUS-STARTED" value="1" />
			<WTSYSCON name="PROJECT-STATUS-COMPLETED" value="2" />
			<WTSYSCON name="PROJECT-STATUS-CANCELLED" value="3" />
			<WTSYSCON name="TASK-STATUS-STARTED" value="1" />
			<WTSYSCON name="TASK-STATUS-COMPLETED" value="2" />
			<WTSYSCON name="TASK-STATUS-CANCELLED" value="3" />
		</WTSYSCONS>
	</WTENTITY>
	<WTPROCEDURES>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date" />
			<WTDECLARE name="NewID" datatype="number" />
			<WTDECLARE name="ForumID" datatype="number" />
			<WTDECLARE name="BoardUserID" datatype="number" />
			<WTDECLARE name="ForumModeratorID" datatype="number" />
			<WTSETVALUE name="Now" value="SYS(timestamp)" />
			<WTSETVALUE name="ForumID" value="CONST(0)" />
			<WTCODEGROUP>
				<WTPROCEDURE name="Forum_Add">
					<WTPARAM name="ForumID" direction="output" />
					<WTPARAM name="ATTR(ParentID)" direction="input" value="CONST(0)" />
					<WTPARAM name="ATTR(ForumName)" direction="input" value="PARAM(ProjectName)" />
					<WTPARAM name="ATTR(Seq)" direction="input" value="CONST(0)" />
					<WTPARAM name="ATTR(Description)" direction="input" value="CONST('')" />
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)" />
				</WTPROCEDURE>
				<WTSETVALUE name="PARAM(ForumID)" value="ForumID" null="0" />
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTINSERT />
			</WTCODEGROUP>
			<WTSETVALUE name="NewID" value="CONST(@@IDENTITY)" />
			<WTSETVALUE name="PARAM(ProjectID)" value="NewID" />
			<WTSETVALUE name="PARAM(ForumID)" value="ForumID" />
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE name="Count" type="Count" style="GenerateDataProc.xsl" />
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTCODEGROUP>
				<WTPROCEDURE name="Shortcut_DeleteItem">
					<WTPARAM name="EntityID" direction="input" value="ENTITY(Project)" />
					<WTPARAM name="ItemID" direction="input" value="PARAM(ProjectID)" />
				</WTPROCEDURE>
				<WTPROCEDURE name="ProjectMember_DeleteMembers">
					<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
				</WTPROCEDURE>
				<WTPROCEDURE name="Task_DeleteTasks">
					<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					<WTPARAM name="ParentID" direction="input" value="CONST(0)" />
				</WTPROCEDURE>
				<WTPROCEDURE name="Project_DeleteProjects">
					<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
				</WTPROCEDURE>
				<WTDELETE>
					<WTJOIN name="Project" lock="true" />
					<WTCONDITION expr="ATTR(ProjectID)" oper="equal" value="PARAM(ProjectID)" />
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="EnumXML" name="EnumMember" enumname="EnumUserMember" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(Project.ProjectID)" direction="input"/>
			<WTPARAM name="ATTR(Project.MemberID)" direction="input"/>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Enum" name="EnumUserMember" style="GenerateDataProc.xsl" column="ProjectName" template="new" passthru="true">
			<WTPARAM name="ATTR(Project.ProjectID)" direction="input"/>
			<WTPARAM name="ATTR(Project.MemberID)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Project.ProjectID)"/>
					<WTATTRIBUTE alias="Name" value="CONST(pj.ProjectName + ' (#' + CAST(pj.ProjectID AS VARCHAR(10)) + ')' AS 'Name')"/>
					<WTJOIN name="Project"/>
					<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Project.ProjectID)" oper="not-equal" value="PARAM(ProjectID)" connector="and"/>
					<WTCONDITION expr="ATTR(Project.Status)" oper="less" value="CONST(2)" connector="and"/>
					<WTORDER name="ATTR(Project.ProjectName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindSecure" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(Secure)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Secure)" oper="less-equal" value="PARAM(Secure)" connector="and" paren="start" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindAssigned" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Assigned" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and" paren="start" />
			<WTCONDITION expr="CONST(pjm.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="PARAM(Status)" connector="and" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindSecureStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(Secure)" direction="input" required="false" />
			<WTPARAM name="ATTR(Status)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="PARAM(Status)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Secure)" oper="less-equal" value="PARAM(Secure)" connector="and" paren="start" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindAssignedStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(Status)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Assigned" />
			<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="PARAM(Status)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and" paren="start" />
			<WTCONDITION expr="CONST(pjm.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindType" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(ProjectTypeID)" direction="input" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ProjectTypeID)" oper="equal" value="PARAM(ProjectTypeID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindSecureType" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(ProjectTypeID)" direction="input" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(Secure)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ProjectTypeID)" oper="equal" value="PARAM(ProjectTypeID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Secure)" oper="less-equal" value="PARAM(Secure)" connector="and" paren="start" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindAssignedType" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(ProjectTypeID)" direction="input" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Assigned" />
			<WTCONDITION expr="ATTR(Project.ProjectTypeID)" oper="equal" value="PARAM(ProjectTypeID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and" paren="start" />
			<WTCONDITION expr="CONST(pjm.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindStatusType" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(ProjectTypeID)" direction="input" />
			<WTPARAM name="ATTR(Status)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="PARAM(Status)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ProjectTypeID)" oper="equal" value="PARAM(ProjectTypeID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindSecureStatusType" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(ProjectTypeID)" direction="input" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(Secure)" direction="input" required="false" />
			<WTPARAM name="ATTR(Status)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Common" />
			<WTCONDITION expr="ATTR(Prospect.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="PARAM(Status)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ProjectTypeID)" oper="equal" value="PARAM(ProjectTypeID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.Secure)" oper="less-equal" value="PARAM(Secure)" connector="and" paren="start" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindAssignedStatusType" style="GenerateDataProc.xsl">
			<WTBOOKMARK name="" />
			<WTPARAM name="ATTR(ProjectTypeID)" direction="input" />
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(Status)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTJOIN name="Assigned" />
			<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="PARAM(Status)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ProjectTypeID)" oper="equal" value="PARAM(ProjectTypeID)" connector="and" />
			<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" connector="and" />
			<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and" paren="start" />
			<WTCONDITION expr="CONST(pjm.MemberID)" oper="equal" value="PARAM(MemberID)" connector="or" paren="end" />
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" />
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListParent" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<!--==================================================================================================================-->
			<WTPARAM name="ATTR(ParentID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.ParentID)" />
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName" />
					<WTATTRIBUTE value="ATTR(ProjectType.ProjectTypeName)" alias="ProjectTypeName" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.EstStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstCost)" />
					<WTATTRIBUTE value="ATTR(Project.TotCost)" />
					<WTATTRIBUTE value="ATTR(Project.ForumID)" />
					<WTATTRIBUTE value="ATTR(Project.IsChat)" />
					<WTATTRIBUTE value="ATTR(Project.IsForum)" />
					<WTATTRIBUTE value="ATTR(Project.Secure)" />
					<WTJOIN name="Common" />
					<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="PARAM(ParentID)" />
					<WTORDER name="ATTR(Project.Seq)" />
					<WTORDER name="ATTR(Project.ProjectName)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Copy" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(ProjectID)" direction="input" />
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false" />
			<WTPARAM name="ATTR(ProjectName)" direction="input" required="false" />
			<WTPARAM name="ATTR(Description)" direction="input" />
			<WTPARAM name="ATTR(ParentID)" direction="input" required="false" />
			<WTPARAM name="SYS(userid)" direction="input" />
			<WTPARAM name="NewProjectID" direction="output" datatype="number" />
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="ComputeTotalCost" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(ProjectID)" direction="input" />
			<WTPARAM name="Result" direction="output" datatype="number" />
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="UpdateHierarchy" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(ProjectID)" direction="input" />
			<WTPARAM name="Result" direction="output" datatype="number" />
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Change" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(ProjectID)" direction="input" />
			<WTPARAM name="Result" direction="output" datatype="number" />
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="Projects" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(ProjectID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.ParentID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Project.Seq)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListCompanyPending" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.MemberID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.EstStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstCost)" />
					<WTATTRIBUTE value="ATTR(Project.TotCost)" />
					<WTJOIN name="Member" />
					<WTCONDITION expr="ATTR(Project.CompanyID)" oper="equal" value="PARAM(CompanyID)" />
					<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="CONST(0)" connector="and" />
					<WTORDER name="ATTR(Project.ProjectID)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListCompanyStarted" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.MemberID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.EstStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstCost)" />
					<WTATTRIBUTE value="ATTR(Project.TotCost)" />
					<WTJOIN name="Member" />
					<WTCONDITION expr="ATTR(Project.CompanyID)" oper="equal" value="PARAM(CompanyID)" />
					<WTCONDITION expr="ATTR(Project.ActStartDate)" oper="greater-equal" value="PARAM(FromDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.ActStartDate)" oper="less-equal" value="PARAM(ToDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="CONST(1)" connector="and" />
					<WTORDER name="ATTR(Project.ActStartDate)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListCompanyCompleted" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.MemberID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.EstStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstCost)" />
					<WTATTRIBUTE value="ATTR(Project.TotCost)" />
					<WTJOIN name="Member" />
					<WTCONDITION expr="ATTR(Project.CompanyID)" oper="equal" value="PARAM(CompanyID)" />
					<WTCONDITION expr="ATTR(Project.ActEndDate)" oper="greater-equal" value="PARAM(FromDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.ActEndDate)" oper="less-equal" value="PARAM(ToDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="CONST(2)" connector="and" />
					<WTORDER name="ATTR(Project.ActEndDate)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListMemberPending" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.MemberID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.EstStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstCost)" />
					<WTATTRIBUTE value="ATTR(Project.TotCost)" />
					<WTJOIN name="Member" />
					<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" />
					<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="CONST(0)" connector="and" />
					<WTORDER name="ATTR(Project.ProjectID)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListMemberStarted" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.MemberID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.EstStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstCost)" />
					<WTATTRIBUTE value="ATTR(Project.TotCost)" />
					<WTJOIN name="Member" />
					<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" />
					<WTCONDITION expr="ATTR(Project.ActStartDate)" oper="greater-equal" value="PARAM(FromDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.ActStartDate)" oper="less-equal" value="PARAM(ToDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="CONST(1)" connector="and" />
					<WTORDER name="ATTR(Project.ActStartDate)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListMemberCompleted" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.MemberID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Member.MemberName)" alias="MemberName" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.EstStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.EstCost)" />
					<WTATTRIBUTE value="ATTR(Project.TotCost)" />
					<WTJOIN name="Member" />
					<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="PARAM(MemberID)" />
					<WTCONDITION expr="ATTR(Project.ActEndDate)" oper="greater-equal" value="PARAM(FromDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.ActEndDate)" oper="less-equal" value="PARAM(ToDate)" connector="and" />
					<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="CONST(2)" connector="and" />
					<WTORDER name="ATTR(Project.ActEndDate)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="WhatsNewOwn" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Project.MemberName)" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.Notes)" />
					<WTATTRIBUTE value="ATTR(Project.Documents)" />
					<WTATTRIBUTE value="ATTR(Project.Messages)" />
					<WTATTRIBUTE value="ATTR(Project.ForumID)" />
					<WTATTRIBUTE value="ATTR(Project.IsForum)" />
					<WTATTRIBUTE value="ATTR(Project.IsChat)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="WhatsNewBelong" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Project.MemberName)" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.Notes)" />
					<WTATTRIBUTE value="ATTR(Project.Documents)" />
					<WTATTRIBUTE value="ATTR(Project.Messages)" />
					<WTATTRIBUTE value="ATTR(Project.ForumID)" />
					<WTATTRIBUTE value="ATTR(Project.IsForum)" />
					<WTATTRIBUTE value="ATTR(Project.IsChat)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="WhatsNewAccess" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" />
			<WTPARAM name="ATTR(Secure)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Project.MemberName)" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.Notes)" />
					<WTATTRIBUTE value="ATTR(Project.Documents)" />
					<WTATTRIBUTE value="ATTR(Project.Messages)" />
					<WTATTRIBUTE value="ATTR(Project.ForumID)" />
					<WTATTRIBUTE value="ATTR(Project.IsForum)" />
					<WTATTRIBUTE value="ATTR(Project.IsChat)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="WhatsNew" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(ProjectID)" direction="input" />
			<WTPARAM name="ATTR(FromDate)" direction="input" />
			<WTPARAM name="ATTR(ToDate)" direction="input" />
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Project.ProjectID)" />
					<WTATTRIBUTE value="ATTR(Project.ProjectName)" />
					<WTATTRIBUTE value="ATTR(Project.MemberName)" />
					<WTATTRIBUTE value="ATTR(Project.Description)" />
					<WTATTRIBUTE value="ATTR(Project.Status)" />
					<WTATTRIBUTE value="ATTR(Project.ActStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarStartDate)" />
					<WTATTRIBUTE value="ATTR(Project.ActEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.VarEndDate)" />
					<WTATTRIBUTE value="ATTR(Project.Notes)" />
					<WTATTRIBUTE value="ATTR(Project.Documents)" />
					<WTATTRIBUTE value="ATTR(Project.Messages)" />
					<WTATTRIBUTE value="ATTR(Project.ForumID)" />
					<WTATTRIBUTE value="ATTR(Project.IsForum)" />
					<WTATTRIBUTE value="ATTR(Project.IsChat)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<WTPROCEDURE name="Access" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(ProjectID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--============================================================================================-->
		<WTWEBPAGE name="7501" caption="Find" action="5" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="61">
			<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text" />
			<WTPARAM name="FindTypeID" datatype="number" />
			<WTPARAM name="Bookmark" datatype="text" />
			<WTPARAM name="Direction" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="SecurityLevel" datatype="number" />
			<WTPARAM name="Status" datatype="number" />
			<WTPARAM name="ProjectTypeID" datatype="number" />
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTINCLUDE name="CompanyMember.asp" />
			<WTINCLUDE name="MemberOptions.asp" />

			<WTDATATXN name="ProjectTypes"/>

			<WTCODEGROUP>
				<WTSETCACHE name="SYS(CompanyID)" value="PARAM(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETCACHE>
				<WTGETCACHE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTGETCACHE>

				<WTSETCACHE name="SYS(MemberID)" value="PARAM(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTCONDITION expr="SYS(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETCACHE>
				<WTGETCACHE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTGETCACHE>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotProjects" connector="and"/>
				<WTCONDITION expr="NotSecureProjects" connector="and"/>
				<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(ProjectName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)" />
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="PARAM(SecurityLevel)" value="CONST(-1)" />
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
				<WTCALLSUB name="GetCompanyMember reqCompanyID, reqMemberID" />
				<WTCALLSUB name="reqSecurityLevel = GetMemberOptions(&quot;S&quot;)">
					<WTCONDITION expr="CONST(InStr(reqSysUserOptions, &quot;f&quot;))" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="NotMemberOnly"/>
				<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)" connector="or"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(SecurityLevel)" value="ATTR(Secure)">
						<WTCONDITION expr="CONST(InStr(.Options, &quot;f&quot;))" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
				</WTOBJECT>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<!-- SAVE MEMBERID BEING MENTORED -->
				<WTSETCACHE name="MentoringID" value="PARAM(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTSETCACHE>
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(reqMemberID))" oper="not-equal" value="CONST(CLng(reqSysMemberID))"/>
						<WTCONDITION expr="CONST(CLng(reqMemberID))" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(reqCompanyID))" oper="not-equal" value="CONST(CLng(reqSysCompanyID))"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(-1)" /> 
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)" />
				<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProjects" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(14)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark" />
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>
			
			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)" />
			</WTACTION>
			
			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)" />
			</WTACTION>
			
			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)" />
			</WTACTION>
			
			<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(-1)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ProjectTypeID)" oper="equal" value="CONST(0)" />
						<WTMETHOD name="Find">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
							<WTPARAM name="reqBookmark" direction="return" datatype="text" />
							<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
							<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
							<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="FindSecure">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="greater-equal" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="Secure" direction="input" value="PARAM(SecurityLevel)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
							<WTMETHOD name="FindAssigned">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="less" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ProjectTypeID)" oper="not-equal" value="CONST(0)" />
						<WTMETHOD name="FindType">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
							<WTPARAM name="reqBookmark" direction="return" datatype="text" />
							<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
							<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
							<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="ProjectTypeID" direction="input" value="PARAM(ProjectTypeID)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="FindSecureType">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="greater-equal" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
								<WTPARAM name="ProjectTypeID" direction="input" value="PARAM(ProjectTypeID)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="Secure" direction="input" value="PARAM(SecurityLevel)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
							<WTMETHOD name="FindAssignedType">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="less" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="ProjectTypeID" direction="input" value="PARAM(ProjectTypeID)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(-1)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ProjectTypeID)" oper="equal" value="CONST(0)" />
						<WTMETHOD name="FindStatus">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
							<WTPARAM name="reqBookmark" direction="return" datatype="text" />
							<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
							<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
							<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="Status" direction="input" value="PARAM(Status)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="FindSecureStatus">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="greater-equal" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="Secure" direction="input" value="PARAM(SecurityLevel)" />
								<WTPARAM name="Status" direction="input" value="PARAM(Status)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
							<WTMETHOD name="FindAssignedStatus">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="less" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="Status" direction="input" value="PARAM(Status)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ProjectTypeID)" oper="not-equal" value="CONST(0)" />
						<WTMETHOD name="FindStatusType">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
							<WTPARAM name="reqBookmark" direction="return" datatype="text" />
							<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
							<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
							<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="ProjectTypeID" direction="input" value="PARAM(ProjectTypeID)" />
							<WTPARAM name="Status" direction="input" value="PARAM(Status)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="FindSecureStatusType">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="greater-equal" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
								<WTPARAM name="ProjectTypeID" direction="input" value="PARAM(ProjectTypeID)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="Secure" direction="input" value="PARAM(SecurityLevel)" />
								<WTPARAM name="Status" direction="input" value="PARAM(Status)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
							<WTMETHOD name="FindAssignedStatusType">
								<WTCONDITION expr="PARAM(SecurityLevel)" oper="less" value="CONST(0)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text" />
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)" />
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)" />
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)" />
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)" />
								<WTPARAM name="ProjectTypeID" direction="input" value="PARAM(ProjectTypeID)" />
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
								<WTPARAM name="Status" direction="input" value="PARAM(Status)" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlProjects" direction="return" datatype="text" />
					<WTPARAM name="Option" direction="input" value="CONST(15)" />
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)" />
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text" />
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="ProjectTypes" project="ptsProjectTypeUser" class="CProjectTypes">
				<WTMETHOD name="EnumCompany">
					<WTPARAM name="xmlProjectTypes" direction="return" concat="true" datatype="text" />
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
					<WTPARAM name="ItemID" direction="input" value="CONST()" />
					<WTPARAM name="Element" direction="input" value="CONST()" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
			</WTOBJECT>
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left" />

				<WTSTATIC label="PreviewProject"/>
				<WTSTATIC label="ProjectsReport"/>

				<WTMENU name="ProjectMenu" type="bar" menuwidth="110">
					<WTITEM label="Project">
						<WTIMAGE name="Project.gif"/>
						<WTITEM label="NewProject"><WTLINK name="7502" nodata="true">
							<WTPARAM name="MemberID" value="PARAM(MemberID)" />
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						</WTLINK></WTITEM>
						<WTITEM label="ProjectTypes">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							<WTLINK name="7311" nodata="true"><WTPARAM name="CompanyID" value="PARAM(CompanyID)" /></WTLINK>
						</WTITEM>
						<WTITEM label="Help"><WTLINK name="Page" target="Help"><WTPARAM name="Page" value="HelpPCSUser"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Reports">
						<WTIMAGE name="Report.gif"/>
						<WTITEM label="WhatsNew"><WTLINK name="7524" nodata="true" target="WhatsNew">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
							<WTPARAM name="MemberID" value="PARAM(MemberID)" />
							<WTPARAM name="SecurityLevel" value="PARAM(SecurityLevel)" />
						</WTLINK></WTITEM>
						<WTITEM label="Projects"><WTLINK name="7525" nodata="true" target="Projects">
							<WTPARAM name="MemberID" value="PARAM(MemberID)" />
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						</WTLINK></WTITEM>
						<WTITEM label="Tasks"><WTLINK name="7426" nodata="true" target="Tasks">
							<WTPARAM name="MemberID" value="PARAM(MemberID)" />
						</WTLINK></WTITEM>
						<WTITEM label="Notes"><WTLINK name="7526" target="Notes"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="75" align="center"/>
						<WTCOLUMN width="325" align="center"/>
						<WTCOLUMN width="200" align="right"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(Project.gif)" imgwidth="50" imgheight="45"/>
							<WTSTATIC col="2" label="FindProject" class="PageHeading"/>
							<WTSTATIC col="3" align="right" valign="top">
								<WTCODEGROUP><WTSTARTMENU name="ProjectMenu" type="bar"/></WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="ProjectFindText" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)" />
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center" />
					<WTCOMBO col="1" value="ATTR(Projects.FindTypeID)" translate="true" />
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader" />
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true" />
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true" />
					<WTBUTTON col="1" action="3" value="CONST(Return)">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="greater" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="ShowStatus" class="ColumnHeader" align="center" />
					<WTCOMBO col="1" value="PARAM(Status)" prespace="false">
						<WTOPTION id="-1" label="All" />
						<WTOPTION id="0" label="Pending" />
						<WTOPTION id="1" label="Started" />
						<WTOPTION id="2" label="Completed" />
						<WTOPTION id="3" label="Cancelled" />
					</WTCOMBO>
					<WTSTATIC col="1" tag="ProjectTypeName" class="ColumnHeader" align="center" />
					<WTCOMBO col="1" value="PARAM(ProjectTypeID)" datapath="/DATA/TXN/PTSPROJECTTYPES/ENUM" prespace="false" setselected="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Project">
						<WTCOLUMN width="35" align="left" valign="top" label="ProjectName" />
						<WTCOLUMN width="20" align="left" valign="top" label="MemberName" />
						<WTCOLUMN width="20" align="left" valign="top" label="ProjectTypeName" />
						<WTCOLUMN width="12" align="left" valign="top" label="Status" />
						<WTCOLUMN width="13" align="left" valign="top" label="Date" />
						<WTROW>
							<WTSTATIC col="1" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GreenChecksm.gif)">
											<WTCONDITION expr="DATA(Project.Variance)" oper="less-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(RedChecksm.gif)">
											<WTCONDITION expr="DATA(Project.Variance)" oper="greater" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(RedX.gif)">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-CANCELLED)" />
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Project.ProjectName)"/>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(ProjectPreview.gif)" alt="PreviewProject" imgalign="absmiddle">
										<WTLINK name="7503">
											<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)" />
											<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@projectid&quot;/&gt;))" fontcolor="purple" />
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Project.MemberName)" valign="top" fontcolor="purple" />
							<WTSTATIC col="3" value="DATA(Project.ProjectTypeName)" valign="top" />
							<WTSTATIC col="4" valign="top">
								<WTSTATIC label="Pending" fontcolor="gray" bold="true">
									<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="CONST(0)" />
								</WTSTATIC>
								<WTSTATIC value="DATA(Project.Status)" fontcolor="green" bold="true">
									<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-STARTED)" />
								</WTSTATIC>
								<WTSTATIC value="DATA(Project.Status)" fontcolor="blue" bold="true">
									<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
								</WTSTATIC>
								<WTSTATIC value="DATA(Project.Status)" fontcolor="red" bold="true">
									<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-CANCELLED)" />
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="5" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-STARTED)" />
									<WTSTATIC value="DATA(Project.ActStartDate)">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActStartDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActStartDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
									<WTSTATIC value="DATA(Project.ActEndDate)">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActEndDate)" fontcolor="blue">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActEndDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="5">
								<WTSTATIC value="DATA(Project.Description)" fontcolor="gray" />
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Project.Secure)" oper="greater" value="CONST(0)" />
									<WTSTATIC space="1" />
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat('(',@secure,')')&quot;/&gt;)" fontcolor="blue"/>
								</WTCODEGROUP>
								<WTSTATIC value="CONST([&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='WhatsNew']&quot;/&gt;])">
									<WTLINK name="7524" class="PageHeadingLink" target="WhatsNew">
										<WTPARAM name="ProjectID" value="DATA(ProjectID)" />
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--==================================================================-->
		<WTWEBPAGE name="7502" caption="New Project" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" secured="61">
			<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="ParentID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="ContentPage" datatype="number"/>
			
			<WTSUB name="NewProject">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)" />
					<WTSETATTRIBUTE name="ATTR(ParentID)" value="PARAM(ParentID)" />
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists" />
			</WTSUB>
			<WTSUB name="LoadLists">
				<WTOBJECT name="ProjectTypes" project="ptsProjectTypeUser" class="CProjectTypes">
					<WTCONDITION expr="PARAM(ParentID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlProjectTypes" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST(tmpProjectTypeID)" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewProject" />
			</WTACTION>
			<WTACTION id="2" name="Add" type="Add">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ParentID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpHierarchy)" value="ATTR(Hierarchy)" />
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTES />
					<WTMETHOD name="Add">
						<WTPARAM name="ProjectID" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Hierarchy)" value="CONST(tmpHierarchy &amp; ProjectID &amp; &quot;/&quot;)" />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors" />
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
				</WTRETURN>
			</WTACTION>
			<WTACTION id="4" name="Copy" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpProjectID)" value="FORM(ProjectID)" />
				<WTRETURN>
					<WTLINK name="7505" return="false">
						<WTPARAM name="ProjectID" value="CONST(tmpProjectID)" />
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						<WTPARAM name="MemberID" value="PARAM(MemberID)" />
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right" />
				<WTCOLUMN width="460" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC label="New" space="1"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" />
							<WTSTATIC label="Project"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Project.ParentID)" oper="not-equal" value="CONST(0)" />
							<WTSTATIC label="Phase" />
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" valign="top">
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(ParentID)" oper="equal" value="CONST(0)" />
							<WTIMAGE value="CONST(Project.gif)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(ParentID)" oper="not-equal" value="CONST(0)" />
							<WTIMAGE value="CONST(subproject.gif)" />
						</WTCODEGROUP>
					</WTSTATIC>
					<WTSTATIC col="2" align="left" label="AddInstructions" class="prompt" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="CopyProject" align="left" class="prompt" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CopyProjectID" />
					<WTTEXT col="2" value="ATTR(Project.ProjectID)" size="5" />
					<WTBUTTON col="2" action="4" value="CONST(Copy)" align="center">
						<WTCONDITION expr="IsActive" />
					</WTBUTTON>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee" />
					<WTROW>
						<WTSTATIC col="1" tag="CompanyID" />
						<WTTEXT col="2" value="ATTR(Project.CompanyID)" size="5" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="MemberID" />
						<WTTEXT col="2" value="ATTR(Project.MemberID)" size="5" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ParentID" />
						<WTTEXT col="2" value="ATTR(Project.ParentID)" size="5" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ForumID" />
						<WTTEXT col="2" value="ATTR(Project.ForumID)" size="5" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Status" />
						<WTCOMBO col="2" value="ATTR(Project.Status)" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="NotEmployee" />
					<WTHIDDEN value="ATTR(Project.CompanyID)" />
					<WTHIDDEN value="ATTR(Project.MemberID)" />
					<WTHIDDEN value="ATTR(Project.ParentID)" />
					<WTHIDDEN value="ATTR(Project.ForumID)" />
					<WTHIDDEN value="ATTR(Project.Status)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="ProjectName" />
					<WTTEXT col="2" value="ATTR(Project.ProjectName)" size="60" focus="true" />
				</WTROW>

				<WTROW>
					<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="ProjectTypeID"/>
					<WTCOMBO col="2" value="ATTR(Project.ProjectTypeID)" datapath="/DATA/TXN/PTSPROJECTTYPES/ENUM"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Project.ParentID)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="Seq"/>
					<WTTEXT col="2" value="ATTR(Project.Seq)" size="2"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left" />
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Project.Description)" cols="72" rows="4" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="DatesText" class="prompt" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC label="Projected" space="1" bold="true" />
						<WTSTATIC tag="StartDate" />
					</WTSTATIC>
					<WTTEXT col="2" value="ATTR(Project.EstStartDate)" />
					<WTSTATIC col="2" tag="EndDate" />
					<WTTEXT col="2" value="ATTR(Project.EstEndDate)" prespace="false" />
					<WTSTATIC col="2" tag="Cost" />
					<WTTEXT col="2" value="ATTR(Project.EstCost)" prespace="false" size="8" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC label="Actual" space="1" bold="true" />
						<WTSTATIC tag="StartDate" />
					</WTSTATIC>
					<WTTEXT col="2" value="ATTR(Project.ActStartDate)" />
					<WTSTATIC col="2" tag="EndDate" />
					<WTTEXT col="2" value="ATTR(Project.ActEndDate)" prespace="false" />
					<WTSTATIC col="2" tag="Cost" />
					<WTTEXT col="2" value="ATTR(Task.Cost)" prespace="false" size="8" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="ChatForumText" class="prompt" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTCHECK col="2" value="ATTR(Project.IsChat)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTCHECK col="2" value="ATTR(Project.IsForum)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ParentID)" oper="equal" value="CONST(0)" />
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" label="SecureText" class="prompt" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Secure" />
						<WTTEXT col="2" value="ATTR(Project.Secure)" size="2" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center">
						<WTCONDITION expr="IsActive" />
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7503" caption="View Project" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="61">
		<!--==================================================================-->
			<WTPARAM name="ProjectID" datatype="number" />
			<WTPARAM name="ProjectCount" datatype="number" />
			<WTPARAM name="TaskCount" datatype="number" />
			<WTPARAM name="AttachmentCount" datatype="number" />
			<WTPARAM name="Title" datatype="text" />
			<WTPARAM name="ParentTitle" datatype="text" />
			<WTPARAM name="ParentID" datatype="number" />
			<WTPARAM name="ProjectMemberID" datatype="number" />
			<WTPARAM name="VarCost" datatype="number" />
			<WTPARAM name="UpdateTaskID" datatype="number" />
			<WTPARAM name="ClearTask" datatype="number" />
			<WTPARAM name="Popup" datatype="number" />
			<WTPARAM name="ContentPage" datatype="number"/>

			<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="0" />
			<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="0" />
			<WTSETATTRIBUTE name="CONST(tmpForumID)" value="0" />
			<WTSETATTRIBUTE name="CONST(tmpIsForum)" value="0" />
			<WTSETATTRIBUTE name="CONST(tmpIsChat)" value="0" />

			<WTSUB name="LoadProject">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Change">
						<WTCONDITION expr="PARAM(UpdateTaskID)" oper="not-equal" value="CONST(0)" />
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="Result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(ProjectName)" />
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(ParentID)" />
					<WTSETATTRIBUTE name="PARAM(VarCost)" value="CONST(CCUR(.VarCost))" />
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)" />
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="CONST(tmpForumID)" value="ATTR(ForumID)" />
					<WTSETATTRIBUTE name="CONST(tmpIsForum)" value="ATTR(IsForum)" />
					<WTSETATTRIBUTE name="CONST(tmpIsChat)" value="ATTR(IsChat)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>

				<!-- lookup the parent memberid for editing the current sub-project memberid -->
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ParentID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ProjectMemberID)" value="ATTR(MemberID)" />
					<WTSETATTRIBUTE name="PARAM(ParentTitle)" value="ATTR(ProjectName)" />
				</WTOBJECT>
				
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="CONST(CLng(tmpMemberID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTCONDITION expr="CONST(CLng(tmpMemberID))" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
					<WTCONDITION expr="PARAM(ProjectMemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTCONDITION expr="PARAM(ProjectMemberID)" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
					<WTMETHOD name="Access">
						<WTCONDITION expr="CONST(tmpMentoringID)" oper="greater" value="CONST(-1)"/>
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)"/>
						<WTPARAM name="MemberID" direction="input" value="CONST(CLng(tmpMentoringID))"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="Access">
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)"/>
						<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
				</WTOBJECT>
				
				<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
					<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="ListParent">
						<WTPARAM name="ParentID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProjects" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqProjectCount" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Tasks" project="ptsTaskUser" class="CTasks">
					<WTMETHOD name="ListProject">
						<WTPARAM name="ParentID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlTasks" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqTaskCount" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Attachments" project="ptsAttachmentUser" class="CAttachments">
					<WTMETHOD name="ListAttachments">
						<WTPARAM name="ParentID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="ParentType" direction="input" value="ENTITY(Project)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqAttachmentCount" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAttachments" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			<WTSUB function="ReturnProject(prmParentID, prmMemberID)">
				<!-- If we don't know the parent, look it up -->
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="CONST(prmParentID)" oper="equal" value="CONST(-1)" />
					<WTCONDITION expr="CONST(prmMemberID)" oper="equal" value="CONST(-1)" connector="or" />
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(prmParentID)" value="ATTR(ParentID)" />
				</WTOBJECT>
				<!-- If we don't have a parent, return to the project list -->
				<WTRETURN>
					<WTCONDITION expr="CONST(prmParentID)" oper="equal" value="CONST(0)" />
					<WTLINK name="7501" return="false">
						<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
						<WTPARAM name="Popup" value="PARAM(Popup)"/>
					</WTLINK>
				</WTRETURN>
				<!-- If we have a parent, return to the parent detail page -->
				<WTRETURN>
					<WTCONDITION expr="CONST(prmParentID)" oper="not-equal" value="CONST(0)" />
					<WTLINK name="7503" nolocaldata="true">
						<WTPARAM name="ProjectID" value="CONST(prmParentID)" />
						<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
					</WTLINK>
				</WTRETURN>
			</WTSUB>

			<WTSUB name="UpdateTask">
				<WTOBJECT name="Task" project="ptsTaskUser" class="CTask">
					<WTCONDITION expr="PARAM(UpdateTaskID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="TaskID" direction="input" value="PARAM(UpdateTaskID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpProjectID)" value="ATTR(ProjectID)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ClearTask)" oper="equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(TASK-STATUS-STARTED)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(TASK-STATUS-COMPLETED)"/>
							<WTSETATTRIBUTE name="ATTR(ActEndDate)" value="SYS(Date)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(TASK-STATUS-STARTED)"/>
							<WTSETATTRIBUTE name="ATTR(ActStartDate)" value="SYS(Date)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ClearTask)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(ActStartDate)" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(ActEndDate)" value="CONST(&quot;&quot;)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Change">
						<WTPARAM name="ProjectID" direction="input" value="CONST(tmpProjectID)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="7503" return="false">
						<WTPARAM name="ProjectID" value="PARAM(ProjectID)"/>
					</WTLINK>
				</WTRETURN>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="UpdateTask">
					<WTCONDITION expr="PARAM(UpdateTaskID)" oper="greater" value="CONST(0)"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadProject"/>
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTRETURN>
					<WTLINK name="7504" nolocaldata="true">
						<WTPARAM name="ProjectID" value="PARAM(ProjectID)" />
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCALLSUB name="ReturnProject -1, -1" />
				</WTCODEGROUP>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right" />
				<WTCOLUMN width="500" align="left" />

				<WTSTATIC label="PreviewTask"/>
				<WTSTATIC label="StartTask"/>
				<WTSTATIC label="CompleteTask"/>
				<WTSTATIC label="ClearTask"/>

				<WTMENU name="ProjectMenu" type="bar" menuwidth="125">
					<WTITEM label="New">
						<WTIMAGE name="New.gif"/>
						<WTITEM label="NewTask">
							<WTLINK name="7402" nodata="true">
								<WTPARAM name="ProjectID" value="PARAM(ProjectID)"/>
								<WTPARAM name="MemberID" value="VALUE(tmpMemberID)"/>
							</WTLINK>
						</WTITEM>
						<WTITEM label="NewAttachment">
							<WTLINK name="8002" nodata="true">
								<WTPARAM name="ParentID" value="PARAM(ProjectID)"/>
								<WTPARAM name="ParentType" value="ENTITY(Project)"/>
								<WTPARAM name="Mini" value="CONST(1)"/>
							</WTLINK>
						</WTITEM>
						<WTITEM label="NewPhase">
							<WTCONDITION expr="PARAM(ParentID)" oper="equal" value="CONST(0)"/>
							<WTLINK name="7502" nodata="true">
								<WTPARAM name="CompanyID" value="VALUE(tmpCompanyID)"/>
								<WTPARAM name="ParentID" value="PARAM(ProjectID)"/>
								<WTPARAM name="MemberID" value="VALUE(tmpMemberID)"/>
							</WTLINK>
						</WTITEM>
						<WTITEM label="NewSubPhase">
							<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)" />
							<WTLINK name="7502" nodata="true">
								<WTPARAM name="CompanyID" value="VALUE(tmpCompanyID)"/>
								<WTPARAM name="ParentID" value="PARAM(ProjectID)"/>
								<WTPARAM name="MemberID" value="VALUE(tmpMemberID)"/>
							</WTLINK>
						</WTITEM>
					</WTITEM>
					<WTITEM label="Tools">
						<WTIMAGE name="Tools.gif"/>
						<WTITEM label="Forum">
							<WTCONDITION expr="CONST(tmpIsForum)" oper="not-equal" value="CONST(0)" />
							<WTLINK name="8411" target="blank" nodata="true">
								<WTPARAM name="ForumID" value="VALUE(tmpForumID)"/>
								<WTPARAM name="IsChat" value="VALUE(tmpIsChat)"/>
							</WTLINK>
						</WTITEM>
						<WTITEM label="ConferenceRoom">
							<WTCONDITION expr="CONST(tmpIsChat)" oper="not-equal" value="CONST(0)" />
							<WTLINK name="8420" target="blank" nodata="true">
								<WTPARAM name="ForumID" value="VALUE(tmpForumID)" />
								<WTPARAM name="IsForum" value="VALUE(tmpIsForum)" />
							</WTLINK>
						</WTITEM>
						<WTITEM label="Members">
							<WTLINK name="7611" target="blank" nodata="true">
								<WTPARAM name="ProjectID" value="PARAM(ProjectID)" />
								<WTPARAM name="CompanyID" value="VALUE(tmpCompanyID)"/>
								<WTPARAM name="MemberID" value="VALUE(tmpMemberID)"/>
								<WTPARAM name="ParentID" value="PARAM(ParentID)"/>
							</WTLINK>
						</WTITEM>
						<WTITEM label="Help"><WTLINK name="Page" target="help" nodata="true"><WTPARAM name="Page" value="CONST(HelpPCSUser)"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Reports">
						<WTIMAGE name="Report.gif"/>
						<WTITEM label="WhatsNew"><WTLINK name="7524" nodata="true" target="WhatsNew">
							<WTPARAM name="ProjectID" value="PARAM(ProjectID)" />
						</WTLINK></WTITEM>
						<WTITEM label="Tasks"><WTLINK name="7426" nodata="true" target="Tasks">
							<WTPARAM name="ProjectID" value="PARAM(ProjectID)" />
						</WTLINK></WTITEM>
						<WTITEM label="Notes"><WTLINK name="7526" target="Notes"><WTPARAM name="ProjectID" value="PARAM(ProjectID)"/></WTLINK></WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW>
					<WTSTATIC col="1" value="PARAM(ParentTitle)" align="left" width="300" bold="true"/>
					<WTSTATIC col="2" align="right" valign="top" width="300">
						<WTCODEGROUP><WTSTARTMENU name="ProjectMenu" type="bar"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="450" align="left"/>
						<WTCOLUMN width="150" align="right"/>
						<WTROW>
							<WTSTATIC col="1" align="left" class="PageHeading">
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)" />
									<WTSTATIC label="ProjectID" />
									<WTSTATIC value="ATTR(Project.ProjectID)" bold="true" space="2"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Project.ParentID)" oper="not-equal" value="CONST(0)" />
									<WTSTATIC label="PhaseID"/>
									<WTSTATIC value="ATTR(Project.ProjectID)" bold="true" space="2"/>
								</WTCODEGROUP>
								<WTSTATIC value="ATTR(Project.ProjectName)" />
							</WTSTATIC>
							<WTIMAGE col="1" value="CONST(Shortcut.gif)">
								<WTCONDITION expr="NotMemberOnly"/>
								<WTCONDITION expr="_IsShortcuts" connector="or"/>
								<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
									<WTPARAM name="EntityID" value="ENTITY(Project)" />
									<WTPARAM name="ItemID" value="ATTR(Project.ProjectID)" />
									<WTPARAM name="Name" value="ATTR(Project.ProjectName)" clean="true" />
									<WTPARAM name="URL" value="SYS(PageURL)" />
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC col="2" tag="ChangeDate" value="ATTR(Project.ChangeDate)" fontcolor="blue">
								<WTCONDITION expr="ATTR(Project.ChangeDate)" oper="not-equal" value="CONST('')" />
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-top="2">
					<WTSTATIC col="1" align="center" valign="center">
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(ParentID)" oper="equal" value="CONST(0)" />
							<WTIMAGE value="CONST(Project.gif)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(ParentID)" oper="not-equal" value="CONST(0)" />
							<WTIMAGE value="CONST(subproject.gif)" />
						</WTCODEGROUP>
					</WTSTATIC>
					<WTSTATIC col="2" align="center">
						<WTSTATIC tag="MemberName" />
						<WTSTATIC value="ATTR(Project.MemberName)" fontcolor="purple" bold="true" space="2" />
						<WTSTATIC tag="Status" />
						<WTSTATIC label="Pending" fontcolor="gray" bold="true">
							<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="CONST(0)" />
						</WTSTATIC>
						<WTSTATIC value="ATTR(Project.Status)" fontcolor="green" bold="true">
							<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-STARTED)" />
						</WTSTATIC>
						<WTSTATIC value="ATTR(Project.Status)" fontcolor="blue" bold="true">
							<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
						</WTSTATIC>
						<WTSTATIC value="ATTR(Project.Status)" fontcolor="red" bold="true">
							<WTCONDITION expr="ATTR(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-CANCELLED)" />
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(ParentID)" oper="equal" value="CONST(0)" />
							<WTSTATIC space="2" />
							<WTSTATIC tag="ProjectTypeName" />
							<WTSTATIC value="ATTR(Project.ProjectTypeName)" bold="true" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(TotHrs)" oper="not-equal" value="CONST(0)" />
							<WTSTATIC space="2" />
							<WTSTATIC tag="Hrs" />
							<WTSTATIC value="ATTR(Project.TotHrs)" bold="true" />
						</WTCODEGROUP>
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Project.RefType)" oper="not-equal" value="CONST(0)" />
<!--							<WTSTATIC newline="1"/>-->
							<WTSTATIC space="2" />
							<WTSTATIC tag="RefType"/>
							<WTSTATIC label="Customer" bold="true">
								<WTCONDITION expr="ATTR(Project.RefType)" oper="equal" value="ENTITY(Prospect)" />
								<WTLINK name="8153" target="Customer">
									<WTPARAM name="ProspectID" value="ATTR(Project.RefID)" />
									<WTPARAM name="PopUp" value="CONST(1)"/>
								</WTLINK>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC newline="1" />
						<WTSTATIC tag="EstDates" />
						<WTSTATIC value="ATTR(Project.EstStartDate)" bold="true">
							<WTCONDITION expr="ATTR(Project.EstStartDate)" oper="not-equal" value="CONST('')" />
						</WTSTATIC>
						<WTSTATIC label="???" bold="true">
							<WTCONDITION expr="ATTR(Project.EstStartDate)" oper="not-exist" />
						</WTSTATIC>
						<WTSTATIC value="CONST( - )" />
						<WTSTATIC value="ATTR(Project.EstEndDate)" bold="true">
							<WTCONDITION expr="ATTR(Project.EstEndDate)" oper="not-equal" value="CONST('')" />
						</WTSTATIC>
						<WTSTATIC label="???" bold="true">
							<WTCONDITION expr="ATTR(Project.EstEndDate)" oper="not-exist" />
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Project.EstCost)" oper="not-equal" value="CONST('$0.00')" />
							<WTSTATIC space="1" />
							<WTSTATIC value="ATTR(Project.EstCost)" fontcolor="green" bold="true" />
						</WTCODEGROUP>
						<WTSTATIC space="3" />
						<WTSTATIC tag="ActDates" />
						<WTSTATIC value="ATTR(Project.ActStartDate)" bold="true">
							<WTCONDITION expr="ATTR(Project.ActStartDate)" oper="not-equal" value="CONST('')" />
						</WTSTATIC>
						<WTSTATIC label="???" bold="true">
							<WTCONDITION expr="ATTR(Project.ActStartDate)" oper="not-exist" />
						</WTSTATIC>
						<WTSTATIC value="CONST( - )" />
						<WTSTATIC value="ATTR(Project.ActEndDate)" bold="true">
							<WTCONDITION expr="ATTR(Project.ActEndDate)" oper="not-equal" value="CONST('')" />
						</WTSTATIC>
						<WTSTATIC label="???" bold="true">
							<WTCONDITION expr="ATTR(Project.ActEndDate)" oper="not-exist" />
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Project.TotCost)" oper="not-equal" value="CONST('$0.00')" />
							<WTSTATIC space="1" />
							<WTSTATIC value="ATTR(Project.TotCost)" fontcolor="green" bold="true" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Project.VarStartDate)" oper="not-equal" value="CONST(0)" />
							<WTCONDITION expr="ATTR(Project.VarEndDate)" oper="not-equal" value="CONST(0)" connector="or" />
							<WTCONDITION expr="PARAM(VarCost)" oper="not-equal" value="CONST(0)" connector="or" />
							<WTSTATIC newline="1" />
							<WTSTATIC label="Variance" space="1" />
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Project.VarStartDate)" oper="not-equal" value="CONST(0)" />
								<WTSTATIC tag="StartDate" />
								<WTSTATIC value="ATTR(Project.VarStartDate)" bold="true" fontcolor="blue">
									<WTCONDITION expr="ATTR(Project.VarStartDate)" oper="less" value="CONST(0)" />
								</WTSTATIC>
								<WTSTATIC value="ATTR(Project.VarStartDate)" bold="true" fontcolor="red">
									<WTCONDITION expr="ATTR(Project.VarStartDate)" oper="greater" value="CONST(0)" />
								</WTSTATIC>
								<WTSTATIC space="1" />
								<WTSTATIC label="days" />
								<WTSTATIC space="3" />
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Project.VarEndDate)" oper="not-equal" value="CONST(0)" />
								<WTSTATIC tag="EndDate" />
								<WTSTATIC value="ATTR(Project.VarEndDate)" bold="true" fontcolor="blue">
									<WTCONDITION expr="ATTR(Project.VarEndDate)" oper="less" value="CONST(0)" />
								</WTSTATIC>
								<WTSTATIC value="ATTR(Project.VarEndDate)" bold="true" fontcolor="red">
									<WTCONDITION expr="ATTR(Project.VarEndDate)" oper="greater" value="CONST(0)" />
								</WTSTATIC>
								<WTSTATIC space="1" />
								<WTSTATIC label="days" />
								<WTSTATIC space="3" />
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(VarCost)" oper="not-equal" value="CONST(0)" />
								<WTSTATIC tag="Cost" />
								<WTSTATIC value="ATTR(Project.VarCost)" bold="true" fontcolor="blue">
									<WTCONDITION expr="PARAM(VarCost)" oper="less" value="CONST(0)" />
								</WTSTATIC>
								<WTSTATIC value="ATTR(Project.VarCost)" bold="true" fontcolor="red">
									<WTCONDITION expr="PARAM(VarCost)" oper="greater" value="CONST(0)" />
								</WTSTATIC>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Project.Description)" oper="not-equal" value="CONST('')" />
					<WTROW margin-top="3" margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" value="ATTR(Project.Description)" align="left" fontcolor="darkblue" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="3" margin-bottom="3">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectCount)" oper="not-equal" value="CONST(0)" />
					<WTROW>
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="100" align="center" />
							<WTCOLUMN width="100" align="center" />
							<WTCOLUMN width="100" align="center" />
							<WTCOLUMN width="100" align="center" />
							<WTCOLUMN width="100" align="center" />
							<WTCOLUMN width="100" align="center" />
							<WTREPEAT xpath="/DATA/TXN/PTSPROJECTS/PTSPROJECT[position() mod 6 = 1]">
								<WTROW margin-top="3">
									<WTREPEAT xpath=".|following-sibling::PTSPROJECT[position() &amp;lt; 6]">
										<WTIMAGE col="1" value="CONST(Subproject.gif)" align="center" valign="top">
											<WTLINK name="7503">
												<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)" />
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											</WTLINK>
										</WTIMAGE>
									</WTREPEAT>
								</WTROW>
								<WTROW>
									<WTREPEAT xpath=".|following-sibling::PTSPROJECT[position() &amp;lt; 6]">
										<WTSTATIC col="1" valign="top">
											<WTSTATIC value="DATA(Project.ProjectName)">
												<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(0)" />
												<WTLINK name="7503">
													<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												</WTLINK>
											</WTSTATIC>
											<WTSTATIC value="DATA(Project.ProjectName)" fontcolor="green">
												<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(PROJECT-STATUS-STARTED)" />
												<WTLINK name="7503">
													<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												</WTLINK>
											</WTSTATIC>
											<WTSTATIC value="DATA(Project.ProjectName)" fontcolor="blue">
												<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
												<WTLINK name="7503">
													<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												</WTLINK>
											</WTSTATIC>
											<WTSTATIC value="DATA(Project.ProjectName)" fontcolor="red">
												<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(PROJECT-STATUS-CANCELLED)" />
												<WTLINK name="7503">
													<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												</WTLINK>
											</WTSTATIC>
										</WTSTATIC>
									</WTREPEAT>
								</WTROW>
							</WTREPEAT>
						</WTTABLE>
					</WTROW>
					<WTROW margin-top="3" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Edit)" align="center">
						<WTCONDITION expr="IsEmployee" />
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="SYS(MemberID)" connector="or" />
						<WTCONDITION expr="PARAM(ProjectMemberID)" oper="equal" value="SYS(MemberID)" connector="or" />
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<!-- TASKS ******************************************************************************* -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(TaskCount)" oper="not-equal" value="CONST(0)" />
					<WTROW margin-top="6" margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Task">
							<WTCOLUMN width="40" align="left" valign="top" label="Tasks" />
							<WTCOLUMN width="24" align="left" valign="top" label="MemberName" />
							<WTCOLUMN width="12" align="left" valign="top" label="Status" />
							<WTCOLUMN width="12" align="center" valign="top" label="StartDate" />
							<WTCOLUMN width="12" align="center" valign="top" label="EndDate" />
							<WTROW>
								<WTSTATIC col="1" valign="top">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Task.IsMilestone)" oper="not-equal" value="CONST(0)" />
										<WTIMAGE value="CONST(milestone.gif)" />
										<WTSTATIC space="1" />
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-COMPLETED)" />
										<WTCODEGROUP>
											<WTIMAGE value="CONST(GreenChecksm.gif)">
												<WTCONDITION expr="DATA(Task.Variance)" oper="less-equal" value="CONST(0)" />
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(RedChecksm.gif)">
												<WTCONDITION expr="DATA(Task.Variance)" oper="greater" value="CONST(0)" />
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(RedX.gif)">
											<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-CANCELLED)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTSTATIC value="CONST(#&lt;xsl:value-of select=&quot;@seq&quot;/&gt;)" space="1">
											<WTCONDITION expr="DATA(Task.Seq)" oper="not-equal" value="CONST(0)" />
										</WTSTATIC>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Task.TaskName)"/>
									<WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(TaskPreview.gif)" alt="PreviewTask" imgalign="absmiddle">
											<WTLINK name="7403">
												<WTPARAM name="TaskID" value="DATA(Task.TaskID)" />
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(0)" />
										<WTIMAGE value="CONST(GoalStart.gif)" alt="StartTask" imgalign="absmiddle">
											<WTLINK name="7503" skipreturn="true">
												<WTPARAM name="ProjectID" value="ATTR(ProjectID)" />
												<WTPARAM name="UpdateTaskID" value="DATA(TaskID)" />
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(TASK-STATUS-STARTED)" />
										<WTIMAGE value="CONST(GoalComplete.gif)" alt="CompleteTask" imgalign="absmiddle">
											<WTLINK name="7503" skipreturn="true">
												<WTPARAM name="ProjectID" value="ATTR(ProjectID)" />
												<WTPARAM name="UpdateTaskID" value="DATA(TaskID)" />
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)" />
										<WTIMAGE value="CONST(GoalClear.gif)" alt="ClearTask" imgalign="absmiddle">
											<WTLINK name="7503" skipreturn="true">
												<WTPARAM name="ProjectID" value="ATTR(ProjectID)" />
												<WTPARAM name="UpdateTaskID" value="DATA(TaskID)" />
												<WTPARAM name="ClearTask" value="CONST(1)" />
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(Task.MemberName)" fontcolor="purple" valign="top" />
								<WTSTATIC col="3" valign="top">
									<WTSTATIC label="Pending" fontcolor="gray">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.Status)" fontcolor="green">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-STARTED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.Status)" fontcolor="blue">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-COMPLETED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.Status)" fontcolor="red">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-CANCELLED)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="4" valign="top">
									<WTSTATIC value="DATA(Task.ActStartDate)">
										<WTCONDITION expr="DATA(Task.VarStartDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActStartDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Task.VarStartDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActStartDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Task.VarStartDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="5" valign="top">
									<WTSTATIC value="DATA(Task.ActEndDate)">
										<WTCONDITION expr="DATA(Task.VarEndDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActEndDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Task.VarEndDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActEndDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Task.VarEndDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="5">
									<WTSTATIC value="DATA(Task.Description)" fontcolor="gray" />
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" tag="TotalTasks" value="PARAM(TaskCount)" bold="true" />
					</WTROW>
				</WTCODEGROUP>
				<!-- ATTACHMENTS ************************************************************************* -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(AttachmentCount)" oper="not-equal" value="CONST(0)" />
					<WTROW margin-top="6" margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(AttachmentCount)" oper="greater" value="CONST(0)" />
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Attachment">
							<WTCOLUMN width="44" align="left" valign="top" label="AttachName" />
							<WTCOLUMN width="22" align="left" valign="top" label="File" />
							<WTCOLUMN width="12" align="left" valign="top" label="Status" />
							<WTCOLUMN width="10" align="left" valign="top" label="AttachSize" />
							<WTCOLUMN width="12" align="left" valign="top" label="AttachDate" />
							<WTROW>
								<WTSTATIC col="1">
									<WTSTATIC value="DATA(Attachment.AttachName)" bold="true">
										<WTCONDITION expr="IsEmployee" />
										<WTCONDITION expr="DATA(Attachment.AuthUserID)" oper="equal" value="SYS(UserID)" connector="or" />
										<WTCONDITION expr="ATTR(Project.MemberID)" oper="equal" value="SYS(MemberID)" connector="or" />
										<WTLINK name="8003">
											<WTPARAM name="AttachmentID" value="DATA(Attachment.AttachmentID)" />
											<WTPARAM name="Mini" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Attachment.AttachName)">
										<WTCONDITION expr="NotEmployee" />
										<WTCONDITION expr="DATA(Attachment.AuthUserID)" oper="not-equal" value="SYS(UserID)" connector="and" />
										<WTCONDITION expr="ATTR(Project.MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTSTATIC value="DATA(Attachment.FileName)">
										<WTCONDITION expr="DATA(Attachment.IsLink)" oper="not-equal" value="CONST(0)" />
										<WTLINK name="CONST(&lt;xsl:value-of select=&quot;@filename&quot;/&gt;)" type="anchor" target="blank" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Attachment.FileName)">
										<WTCONDITION expr="DATA(Attachment.IsLink)" oper="equal" value="CONST(0)" />
										<WTLINK name="CONST(Attachments/75/&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@projectid,'/',@filename)&quot;/&gt;)" type="anchor" target="blank" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTSTATIC label="Active">
										<WTCONDITION expr="DATA(Attachment.Status)" oper="less-equal" value="CONST(1)" />
									</WTSTATIC>
									<WTSTATIC label="Inactive" fontcolor="red">
										<WTCONDITION expr="DATA(Attachment.Status)" oper="equal" value="CONST(2)" />
									</WTSTATIC>
									<WTSTATIC label="Private" fontcolor="purple">
										<WTCONDITION expr="DATA(Attachment.Status)" oper="equal" value="CONST(3)" />
									</WTSTATIC>
									<WTSTATIC space="1" />
									<WTSTATIC value="DATA(Attachment.Secure)" fontcolor="blue"/>
								</WTSTATIC>
								<WTSTATIC col="4">
									<WTSTATIC value="DATA(Attachment.AttachSize)">
										<WTCONDITION expr="DATA(Attachment.IsLink)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="5" value="DATA(Attachment.AttachDate)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="5" value="DATA(Attachment.Description)" fontcolor="gray" />
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(AttachmentCount)" oper="greater" value="CONST(0)" />
						<WTSTATIC col="1" merge="2" align="left" class="prompt">
							<WTSTATIC value="PARAM(AttachmentCount)" space="1" />
							<WTSTATIC label="Attachments" />
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTFRAME col="1" merge="2" src="CONST(9011.asp?Height=150&amp;amp;OwnerType=75&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@projectid&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;)" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="500" label="NoFrameSupport" border="0" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--==================================================================-->
		<WTWEBPAGE name="7504" caption="Edit Project" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="61">
			<!--==================================================================-->
			<WTPARAM name="ProjectID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="ParentID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="ProjectMemberID" datatype="number"/>
			<WTPARAM name="ProjectTypeID" datatype="number"/>
			<WTPARAM name="ParentName" datatype="text"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			
			<WTSUB function="AddNote(prmNotes)">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="SYS(UserID)" />
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Project)" />
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(ProjectID)" />
					<WTSETATTRIBUTE name="ATTR(IsLocked)" value="CONST(1)" />
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(prmNotes)" />
					<WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="LoadProject">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="PARAM(ProjectTypeID)" value="ATTR(ProjectTypeID)" />
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(ParentID)" />
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>

				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="CONST(CLng(tmpMemberID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTCONDITION expr="CONST(CLng(tmpMemberID))" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
					<WTMETHOD name="Access">
						<WTCONDITION expr="CONST(tmpMentoringID)" oper="greater" value="CONST(0)"/>
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)"/>
						<WTPARAM name="MemberID" direction="input" value="CONST(CLng(tmpMentoringID))"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="Access">
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)"/>
						<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists" />
			</WTSUB>

			<WTSUB name="LoadLists">
				<WTOBJECT name="ProjectTypes" project="ptsProjectTypeUser" class="CProjectTypes">
					<WTCONDITION expr="PARAM(ParentID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlProjectTypes" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="PARAM(ProjectTypeID)" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="ProjectMembers" project="ptsProjectMemberUser" class="CProjectMembers">
					<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="EnumMember">
						<WTPARAM name="xmlProjectMembers" direction="return" concat="true" datatype="text" />
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ParentID)" />
						<WTPARAM name="ItemID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<!-- lookup the parent memberid for editing the current sub-project memberid -->
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ParentID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ProjectMemberID)" value="ATTR(MemberID)" />
					<WTSETATTRIBUTE name="PARAM(ParentName)" value="ATTR(ProjectName)" />
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="UpdateProject">
				<WTSETATTRIBUTE name="CONST(tmpStatusChange)" value="CONST(0)"/>
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="PARAM(ProjectTypeID)" value="ATTR(ProjectTypeID)" />
					<WTSETATTRIBUTE name="CONST(tmpEstStartDate)" value="ATTR(EstStartDate)" />
					<WTSETATTRIBUTE name="CONST(tmpEstEndDate)" value="ATTR(EstEndDate)" />
					<WTSETATTRIBUTE name="CONST(tmpEstCost)" value="ATTR(EstCost)" />
					<WTSETATTRIBUTE name="CONST(tmpCost)" value="ATTR(Cost)" />
					<WTSETATTRIBUTE name="CONST(tmpHrs)" value="ATTR(Hrs)" />
					<WTSETATTRIBUTE name="CONST(oldProjectName)" value="ATTR(ProjectName)" />
					<WTSETATTRIBUTE name="CONST(tmpForumID)" value="ATTR(ForumID)" />
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTES />
					<WTSETATTRIBUTE name="CONST(newProjectName)" value="ATTR(ProjectName)" />
					<WTSETATTRIBUTE name="CONST(tmpParentID)" value="ATTR(ParentID)" />
<WTCUSTOM>
				If .Status &lt; 3 Then
					If IsDate(.ActEndDate) Then
						.Status = 2
					Else	
						If IsDate(.ActStartDate) Then .Status = 1
					End If
				End If
				If tmpStatus &lt;&gt; .Status Then
					 tmpStatusChange = 1
					 .ChangeDate = Now()
				End If	 
				.VarStartDate = ""
				.VarEndDate = ""
				If IsDate(.EstStartDate) AND IsDate(.ActStartDate) Then .VarStartDate = DATEDIFF("d", .EstStartDate, .ActStartDate)
				If IsDate(.EstEndDate) AND IsDate(.ActEndDate) Then .VarEndDate = DATEDIFF("d", .EstEndDate, .ActEndDate)
</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="Change">
						<WTCONDITION expr="CONST(tmpParentID)" oper="not-equal" value="CONST(0)" />
						<WTCONDITION expr="CONST(tmpStatusChange)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="ProjectID" direction="input" value="CONST(tmpParentID)" />
						<WTPARAM name="Result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors" />
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpEstStartDate)" oper="not-equal" value="CONST(&quot;0&quot;)" />
							<WTCONDITION expr="CONST(tmpEstStartDate)" oper="not-equal" value="ATTR(EstStartDate)" connector="and" />
							<WTCALLSUB name="AddNote(&quot;Projected Start Date Changed from &quot; + tmpEstStartDate + &quot; to &quot; + .EstStartDate)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpEstEndDate)" oper="not-equal" value="CONST(&quot;0&quot;)" />
							<WTCONDITION expr="CONST(tmpEstEndDate)" oper="not-equal" value="ATTR(EstEndDate)" connector="and" />
							<WTCALLSUB name="AddNote(&quot;Projected End Date Changed from &quot; + tmpEstEndDate + &quot; to &quot; + .EstEndDate)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpEstCost)" oper="not-equal" value="CONST(&quot;$0.00&quot;)" />
							<WTCONDITION expr="CONST(CCUR(tmpEstCost))" oper="not-equal" value="CONST(CCUR(.EstCost))" connector="and" />
							<WTCALLSUB name="AddNote(&quot;Projected Cost Changed from &quot; + tmpEstCost + &quot; to &quot; + .EstCost)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCUR(tmpCost))" oper="not-equal" value="CONST(CCUR(.Cost))" />
							<WTCONDITION expr="CONST(CCUR(tmpEstCost))" oper="not-equal" value="CONST(CCUR(.EstCost))" connector="or" />
							<WTCONDITION expr="CONST(CCUR(tmpHrs))" oper="not-equal" value="CONST(CCUR(.Hrs))" connector="or" />
							<WTMETHOD name="ComputeTotalCost">
								<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
								<WTPARAM name="Result" direction="return" datatype="number" />
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors" />
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
					<WTHTTP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" connector="and"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" connector="and"/>
						<WTLINK name="0418">
							<WTPARAM name="MemberID" value="ATTR(MemberID)"/>
							<WTPARAM name="Notify" value="SYSCON(NOTIFYMENTOR-PROJECT)"/>
							<WTPARAM name="ID" value="ATTR(ProjectID)"/>
						</WTLINK>
					</WTHTTP>
				</WTOBJECT>
				<WTOBJECT name="Forum" project="ptsForumUser" class="CForum">
					<WTCONDITION expr="CONST(newProjectName)" oper="not-equal" value="CONST(oldProjectName)" />
					<WTMETHOD name="Load">
						<WTPARAM name="ForumID" direction="input" value="CONST(tmpForumID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(ForumName)" value="CONST(newProjectName)" />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadProject" />
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateProject"/>
				<WTCALLSUB name="LoadLists">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			
			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(prmParentID)" value="ATTR(ParentID)" />
					<WTMETHOD name="Delete">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="ComputeTotalCost">
						<WTPARAM name="ProjectID" direction="input" value="CONST(prmParentID)" />
						<WTPARAM name="Result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCALLSUB name="LoadProject">
						<WTCONDITION expr="IsErrors" />
					</WTCALLSUB>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<!-- If we don't have a parent, return to the project list -->
					<WTRETURN>
						<WTCONDITION expr="CONST(prmParentID)" oper="equal" value="CONST(0)" />
						<WTLINK name="7501" nolocaldata="true" />
					</WTRETURN>
					<!-- If we have a parent, return to the parent detail page -->
					<WTRETURN>
						<WTCONDITION expr="CONST(prmParentID)" oper="not-equal" value="CONST(0)" />
						<WTLINK name="7503" nolocaldata="true">
							<WTPARAM name="ProjectID" value="CONST(prmParentID)" />
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="5" name="NewOwner" type="Update">
				<WTCALLSUB name="UpdateProject"/>
				<WTCALLSUB name="LoadLists">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
					<WTLINK name="7506" nolocaldata="true">
						<WTPARAM name="ProjectID" value="PARAM(ProjectID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="6" name="NewParent" type="Update">
				<WTCALLSUB name="UpdateProject"/>
				<WTCALLSUB name="LoadLists">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
					<WTLINK name="7507" nolocaldata="true">
						<WTPARAM name="ProjectID" value="PARAM(ProjectID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right" />
				<WTCOLUMN width="460" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC tag="Project">
							<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Project.ProjectName)"/>
					</WTSTATIC>
					<WTIMAGE col="1" merge="2" value="CONST(Shortcut.gif)">
						<WTCONDITION expr="NotMemberOnly"/>
						<WTCONDITION expr="_IsShortcuts" connector="or"/>
						<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
							<WTPARAM name="EntityID" value="ENTITY(Project)" />
							<WTPARAM name="ItemID" value="ATTR(Project.ProjectID)" />
							<WTPARAM name="Name" value="ATTR(Project.ProjectName)" clean="true" />
							<WTPARAM name="URL" value="SYS(PageURL)" />
						</WTLINK>
					</WTIMAGE>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(Project.gif)" align="center" valign="top" />
					<WTSTATIC col="2" align="left" label="EditInstructions" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee" />
					<WTROW>
						<WTSTATIC col="1" tag="CompanyID" />
						<WTTEXT col="2" value="ATTR(Project.CompanyID)" size="5" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ForumID" />
						<WTTEXT col="2" value="ATTR(Project.ForumID)" size="5" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Status" />
						<WTCOMBO col="2" value="ATTR(Project.Status)" />
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee" />
					<WTROW>
						<WTHIDDEN value="ATTR(Project.CompanyID)" />
						<WTHIDDEN value="ATTR(Project.ForumID)" />
						<WTHIDDEN value="ATTR(Project.Status)" />
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTCONDITION expr="IsEmployee" />
					<WTSTATIC col="1" tag="ParentID" />
					<WTTEXT col="2" value="ATTR(Project.ParentID)" size="5"/>
					<WTSTATIC col="2" value="PARAM(ParentName)" fontcolor="purple" bold="true"/>
					<WTBUTTON col="2" action="6" value="CONST(Move)" btnclass="smbutton"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee" />
					<WTROW>
						<WTSTATIC col="1" tag="ParentName" />
						<WTSTATIC col="2" value="PARAM(ParentName)" fontcolor="purple" bold="true"/>
						<WTBUTTON col="2" action="6" value="CONST(NewParent)" btnclass="smbutton"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Project.ParentID)" />
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTCONDITION expr="IsEmployee" />
					<WTSTATIC col="1" tag="MemberID" />
					<WTTEXT col="2" value="ATTR(Project.MemberID)" size="5"/>
					<WTSTATIC col="2" value="ATTR(Project.MemberName)" fontcolor="purple" bold="true"/>
					<WTBUTTON col="2" action="5" value="CONST(NewOwner)" btnclass="smbutton"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee" />
					<WTROW>
						<WTSTATIC col="1" tag="MemberID" />
						<WTSTATIC col="2" value="ATTR(Project.MemberName)" fontcolor="purple" bold="true"/>
						<WTBUTTON col="2" action="5" value="CONST(NewOwner)" btnclass="smbutton"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Project.MemberID)" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTSTATIC col="1" tag="ProjectName" />
					<WTTEXT col="2" value="ATTR(Project.ProjectName)" size="60" focus="true"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="ProjectTypeID"/>
					<WTCOMBO col="2" value="ATTR(Project.ProjectTypeID)" datapath="/DATA/TXN/PTSPROJECTTYPES/ENUM"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Project.ParentID)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="Seq"/>
					<WTTEXT col="2" value="ATTR(Project.Seq)" size="2"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left" />
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Project.Description)" cols="72" rows="4" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="DatesText" class="prompt" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC label="Projected" space="1" bold="true" />
						<WTSTATIC tag="StartDate" />
					</WTSTATIC>
					<WTTEXT col="2" value="ATTR(Project.EstStartDate)" />
					<WTSTATIC col="2" tag="EndDate" />
					<WTTEXT col="2" value="ATTR(Project.EstEndDate)" prespace="false" />
					<WTSTATIC col="2" tag="Cost" />
					<WTTEXT col="2" value="ATTR(Project.EstCost)" prespace="false" size="8" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC label="Actual" space="1" bold="true" />
						<WTSTATIC tag="StartDate" />
					</WTSTATIC>
					<WTTEXT col="2" value="ATTR(Project.ActStartDate)" />
					<WTSTATIC col="2" tag="EndDate" />
					<WTTEXT col="2" value="ATTR(Project.ActEndDate)" prespace="false" />
					<WTSTATIC col="2" tag="Cost" />
					<WTTEXT col="2" value="ATTR(Project.Cost)" prespace="false" size="8" />
					<WTSTATIC col="2" value="ATTR(Project.TotCost)" fontcolor="green" bold="true">
						<WTCONDITION expr="ATTR(Project.TotCost)" oper="not-equal" value="CONST('$0.00')" />
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Hrs" />
					<WTTEXT col="2" value="ATTR(Project.Hrs)" size="4" />
					<WTSTATIC col="2" tag="TotHrs" />
					<WTSTATIC col="2" value="ATTR(Project.TotHrs)" prespace="false" bold="true" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="ChatForumText" class="prompt" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTCHECK col="2" value="ATTR(Project.IsChat)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTCHECK col="2" value="ATTR(Project.IsForum)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" label="SecureText" class="prompt" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Secure" />
						<WTTEXT col="2" value="ATTR(Project.Secure)" size="2" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="RefType"/>
						<WTCOMBO col="2" value="ATTR(Project.RefType)"/>
						<WTSTATIC col="2" tag="RefID"/>
						<WTTEXT col="2" value="ATTR(Project.RefID)" size="3" prespace="false"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive" />
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center" />
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" align="center" msg="ConfirmDelete" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--============================================================================================-->
		<WTWEBPAGE name="7505" caption="Copy Project" aspstyle="GenerateWebASP.xsl" secured="61">
			<!--============================================================================================-->
			<WTPARAM name="ProjectID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="ProjectMembers" project="ptsProjectMemberUser" class="CProjectMembers">
					<WTMETHOD name="ListMember">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProjectMembers" direction="return" concat="true" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
					<WTMETHOD name="Projects">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProjects" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Tasks" project="ptsTaskUser" class="CTasks">
					<WTMETHOD name="Projects">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlTasks" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="1" name="Copy" type="Add">
				<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
					<WTMETHOD name="Projects">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
<WTCUSTOM>
					tmpExclude = "~"
					For Each oProject in oProjects
						tmpID = "P" &amp; oProject.ProjectID
						If Request.Form.Item(tmpID) &lt;&gt; "on" Then
							tmpExclude = tmpExclude + tmpID &amp; "~"
						End If
					Next
</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Tasks" project="ptsTaskUser" class="CTasks">
					<WTMETHOD name="Projects">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
<WTCUSTOM>
					For Each oTask in oTasks
						tmpID = "T" &amp; oTask.TaskID
						If Request.Form.Item(tmpID) &lt;&gt; "on" Then
							tmpExclude = tmpExclude + tmpID &amp; "~"
						End If
					Next
</WTCUSTOM>
				</WTOBJECT>
<!-- Check if only one member is included for assigning tasks -->
				<WTOBJECT name="ProjectMembers" project="ptsProjectMemberUser" class="CProjectMembers">
					<WTMETHOD name="ListMember">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
<WTCUSTOM>
				tmpAssignID = -1
				For Each oPM in oProjectMembers
					With oPM
						tmpID = "M" &amp; .ProjectMemberID
						If Request.Form.Item(tmpID) = "on" Then
							If tmpAssignID &gt; 0 Then tmpAssignID = 0
							If tmpAssignID = -1 Then tmpAssignID = .MemberID
						End If
					End With
				Next
				If tmpAssignID = -1 Then tmpAssignID = reqMemberID
</WTCUSTOM>
				</WTOBJECT>
				<WTSETATTRIBUTE name="CONST(tmpProjectName)" value="FORM(ProjectName)" />
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Copy">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="ProjectName" direction="input" value="CONST(tmpProjectName)" />
						<WTPARAM name="Description" direction="input" value="CONST(tmpExclude)" />
						<WTPARAM name="AssignID" direction="input" value="CONST(tmpAssignID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						<WTPARAM name="NewProjectID" direction="return" datatype="number" />
					</WTMETHOD>
					<WTMETHOD name="UpdateHierarchy">
						<WTPARAM name="ProjectID" direction="input" value="CONST(NewProjectID)" />
						<WTPARAM name="Result" direction="return" datatype="number" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="ProjectMembers" project="ptsProjectMemberUser" class="CProjectMembers">
					<WTMETHOD name="ListMember">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					</WTMETHOD>
<WTCUSTOM>
				Set oProjectMember = server.CreateObject("ptsProjectMemberUser.CProjectMember")
				If oProjectMember Is Nothing Then
					DoError Err.Number, Err.Source, "Unable to Create Object - ptsProjectMemberUser.CProjectMember"
				Else
					oProjectMember.ProjectID = NewProjectID
					oProjectMember.Status = 1
               For Each oPM in oProjectMembers
                  tmpID = "M" &amp; oPM.ProjectMemberID
                  If Request.Form.Item(tmpID) = "on" Then
                     oProjectMember.MemberID = oPM.MemberID
							oProjectMemberID = oProjectMember.Add (CLng(reqSysUserID))
							If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
						End If
					Next
				End If
				Set oProjectMember = Nothing
</WTCUSTOM>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
					<WTLINK name="7503" skipreturn="true">
						<WTPARAM name="ProjectID" value="CONST(NewProjectID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left" />
				<WTROW>
					<WTSTATIC col="1" tag="ProjectCopy" value="ATTR(Project.ProjectName)" class="PageHeading" align="left" />
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="2">
					<WTSTATIC col="1" value="ATTR(Project.Description)" align="left" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="ProjectCopyText" align="left" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="NewName" align="left" />
					<WTTEXT col="1" value="ATTR(Project.ProjectName)" align="left" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="IncludeMembers" align="left" class="prompt" />
				</WTROW>
				<WTREPEAT entity="ProjectMember">
					<WTROW>
						<WTSTATIC col="1">
							<WTCODEGROUP>
								<WTCHECK name="M&lt;xsl:value-of select=&quot;@projectmemberid&quot;/&gt;" check="true" />
							</WTCODEGROUP>
							<WTSTATIC space="1" />
							<WTSTATIC value="DATA(MemberName)" />
						</WTSTATIC>
					</WTROW>
				</WTREPEAT>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" action="1" value="CONST(Copy)" default="true" align="center" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="IncludeTasks" align="left" class="prompt" />
				</WTROW>
				<WTREPEAT entity="Task">
					<WTFILTER name="DATA(Task.ProjectID)" oper="equal" value="PARAM(ProjectID)" />
					<WTFILTER name="DATA(Task.ParentID)" oper="equal" value="CONST(0)" connector="and" />
					<WTROW>
						<WTSTATIC col="1">
							<WTCODEGROUP>
								<WTCHECK name="&lt;xsl:value-of select=&quot;@taskid&quot;/&gt;" check="true" />
							</WTCODEGROUP>
							<WTSTATIC space="1" />
							<WTSTATIC value="DATA(Task.TaskName)" />
						</WTSTATIC>
					</WTROW>
					<WTREPEAT entity="Task">
						<WTFILTER name="DATA(Task.ParentID)" oper="equal" value="DATA(Current.TaskID)" />
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC space="5" />
								<WTCODEGROUP>
									<WTCHECK name="&lt;xsl:value-of select=&quot;@taskid&quot;/&gt;" check="true" />
								</WTCODEGROUP>
								<WTSTATIC space="1" />
								<WTSTATIC value="DATA(Task.TaskName)" />
							</WTSTATIC>
						</WTROW>
						<WTREPEAT entity="Task">
							<WTFILTER name="DATA(Task.ParentID)" oper="equal" value="DATA(Current.TaskID)" />
							<WTROW>
								<WTSTATIC col="1">
									<WTSTATIC space="5" />
									<WTSTATIC space="5" />
									<WTCODEGROUP>
										<WTCHECK name="&lt;xsl:value-of select=&quot;@taskid&quot;/&gt;" check="true" />
									</WTCODEGROUP>
									<WTSTATIC space="1" />
									<WTSTATIC value="DATA(Task.TaskName)" />
								</WTSTATIC>
							</WTROW>
							<WTREPEAT entity="Task">
								<WTFILTER name="DATA(Task.ParentID)" oper="equal" value="DATA(Current.TaskID)" />
								<WTROW>
									<WTSTATIC col="1">
										<WTSTATIC space="5" />
										<WTSTATIC space="5" />
										<WTSTATIC space="5" />
										<WTCODEGROUP>
											<WTCHECK name="&lt;xsl:value-of select=&quot;@taskid&quot;/&gt;" check="true" />
										</WTCODEGROUP>
										<WTSTATIC space="1" />
										<WTSTATIC value="DATA(Task.TaskName)" />
									</WTSTATIC>
								</WTROW>
							</WTREPEAT>
						</WTREPEAT>
					</WTREPEAT>
				</WTREPEAT>
				<WTREPEAT entity="Project">
					<WTFILTER name="DATA(Project.ParentID)" oper="equal" value="PARAM(ProjectID)" />
					<WTROW class="graybar">
						<WTSTATIC col="1" bold="true">
							<WTCODEGROUP>
								<WTCHECK name="&lt;xsl:value-of select=&quot;@projectid&quot;/&gt;" check="true" />
							</WTCODEGROUP>
							<WTSTATIC space="1" />
							<WTSTATIC value="DATA(Project.ProjectName)" />
						</WTSTATIC>
					</WTROW>
					<WTREPEAT entity="Project">
						<WTFILTER name="DATA(Project.ParentID)" oper="equal" value="DATA(Current.ProjectID)" />
						<WTROW>
							<WTSTATIC col="1" bold="true">
								<WTCODEGROUP>
									<WTCHECK name="&lt;xsl:value-of select=&quot;@projectid&quot;/&gt;" check="true" />
								</WTCODEGROUP>
								<WTSTATIC space="1" />
								<WTSTATIC value="DATA(Project.ProjectName)" />
							</WTSTATIC>
						</WTROW>
						<WTREPEAT entity="Project">
							<WTFILTER name="DATA(Project.ParentID)" oper="equal" value="DATA(Current.ProjectID)" />
							<WTROW>
								<WTSTATIC col="1" bold="true">
									<WTCODEGROUP>
										<WTCHECK name="&lt;xsl:value-of select=&quot;@projectid&quot;/&gt;" check="true" />
									</WTCODEGROUP>
									<WTSTATIC space="1" />
									<WTSTATIC value="DATA(Project.ProjectName)" />
								</WTSTATIC>
							</WTROW>
							<WTREPEAT entity="Project">
								<WTFILTER name="DATA(Project.ParentID)" oper="equal" value="DATA(Current.ProjectID)" />
								<WTROW>
									<WTSTATIC col="1" bold="true">
										<WTCODEGROUP>
											<WTCHECK name="&lt;xsl:value-of select=&quot;@projectid&quot;/&gt;" check="true" />
										</WTCODEGROUP>
										<WTSTATIC space="1" />
										<WTSTATIC value="DATA(Project.ProjectName)" />
									</WTSTATIC>
								</WTROW>
							</WTREPEAT>
						</WTREPEAT>
					</WTREPEAT>
				</WTREPEAT>
				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" action="1" value="CONST(Copy)" align="center" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7506" caption="Change Owner" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="61">
			<!--==================================================================-->
			<WTPARAM name="ProjectID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			
			<WTSUB name="LoadProject">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists" />
			</WTSUB>
			<WTSUB name="LoadLists">
				<WTOBJECT name="ProjectMembers" project="ptsProjectMemberUser" class="CProjectMembers">
					<WTMETHOD name="EnumMember">
						<WTPARAM name="xmlProjectMembers" direction="return" datatype="text" />
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="ItemID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadProject" />
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTES />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors" />
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right" />
				<WTCOLUMN width="460" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC tag="Project">
							<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Project.ProjectName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROJECTMEMBERS/ENUM))" oper="greater" value="CONST(1)"/>
					<WTSTATIC col="1" tag="NewOwner"/>
					<WTCOMBO col="2" value="ATTR(Project.MemberID)" datapath="/DATA/TXN/PTSPROJECTMEMBERS/ENUM"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROJECTMEMBERS/ENUM))" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="NoNewOwner" align="center" class="PageHeading" fontcolor="red"/>
				</WTROW>

				<WTROW margin-top="18" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive" />
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROJECTMEMBERS/ENUM))" oper="greater" value="CONST(1)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="7507" caption="Change Parent" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="61">
			<!--==================================================================-->
			<WTPARAM name="ProjectID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			
			<WTSUB name="LoadProject">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists" />
			</WTSUB>
			<WTSUB name="LoadLists">
				<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
					<WTMETHOD name="EnumMember">
						<WTPARAM name="xmlProjects" direction="return" datatype="text" />
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadProject" />
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="UpdateHierarchy">
						<WTCONDITION expr="ATTR(ParentID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="ProjectID" direction="input" value="ATTR(ParentID)" />
						<WTPARAM name="Result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTMETHOD name="UpdateHierarchy">
						<WTCONDITION expr="ATTR(ParentID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="ProjectID" direction="input" value="ATTR(ProjectID)" />
						<WTPARAM name="Result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors" />
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="140" align="right" />
				<WTCOLUMN width="460" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC tag="Project">
							<WTCONDITION expr="ATTR(Project.ParentID)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Project.ProjectName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROJECTS/ENUM))" oper="greater" value="CONST(1)"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" label="TopParent"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="NewParent"/>
						<WTCOMBO col="2" value="ATTR(Project.ParentID)" datapath="/DATA/TXN/PTSPROJECTS/ENUM"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROJECTS/ENUM))" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="NoNewParent" align="center" class="PageHeading" fontcolor="red"/>
				</WTROW>

				<WTROW margin-top="18" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive" />
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROJECTS/ENUM))" oper="greater" value="CONST(1)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==========================================================================================-->
		<WTWEBPAGE name="7524" caption="Whats New" navbar="false" action="5" form="Report" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="7524" language="false" secured="61">
			<!--==========================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="SecurityLevel" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="ProjectID" datatype="number" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Rpt" datatype="number" />
			<WTPARAM name="VisitDate" datatype="text" />
			<WTPARAM name="ProjectCount" datatype="number" />
			<WTPARAM name="TaskCount" datatype="number" />
			<WTDATATXN name="Projects" />
			<WTDATATXN name="Tasks" />
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETATTRIBUTE>
				<!-- if we have no member and no project, get all projects for the company -->
				<WTSETATTRIBUTE name="PARAM(SecurityLevel)" value="CONST(99)">
					<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTGETCACHE name="PARAM(VisitDate)" value="PARAM(VisitDate)" />
				<WTSETATTRIBUTE name="PARAM(VisitDate)" value="SYS(Date)">
					<WTCONDITION expr="PARAM(VisitDate)" oper="equal" value="CONST(&quot;&quot;)" />
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Rpt)" value="CONST(1)" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(VisitDate)" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(Date())" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Rpt)" value="CONST(3)" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(Date)" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(Date)" />
				</WTCODEGROUP>
				<WTCALLSUB name="LoadMember" />
			</WTACTION>
			<WTACTION id="3" name="Report" type="Report">
				<WTCALLSUB name="LoadMember" />
			</WTACTION>
			<!-- Add a day to account for the minutes of the day -->
			<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="WhatsNewOwn">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
					<WTMETHOD name="WhatsNewBelong">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
					<WTMETHOD name="WhatsNewAccess">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(3)" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="SecurityLevel" direction="input" value="PARAM(SecurityLevel)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="WhatsNew">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
				</WTCODEGROUP>
				<WTMETHOD name="Count">
					<WTPARAM name="reqProjectCount" direction="return" datatype="number" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlProjects" direction="return" datatype="text" />
					<WTPARAM name="Option" direction="input" value="CONST(13)" />
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Tasks" project="ptsTaskUser" class="CTasks">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="WhatsNewOwn">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
					<WTMETHOD name="WhatsNewBelong">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
					<WTMETHOD name="WhatsNewAccess">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(3)" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="SecurityLevel" direction="input" value="PARAM(SecurityLevel)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="WhatsNew">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
				</WTCODEGROUP>
				<WTMETHOD name="Count">
					<WTPARAM name="reqTaskCount" direction="return" datatype="number" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlTasks" direction="return" datatype="text" />
					<WTPARAM name="Option" direction="input" value="CONST(13)" />
				</WTMETHOD>
			</WTOBJECT>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTSTATIC label="WhatsNew"/>
				<WTROW>
					<WTHIDDEN value="PARAM(VisitDate)" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" class="PageHeading" align="center">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
								<WTSTATIC label="WhatsNewAll" />
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
								<WTSTATIC label="WhatsNewMember" space="1" />
								<WTSTATIC value="ATTR(Member.NameFirst)" space="1" />
								<WTSTATIC value="ATTR(Member.NameLast)" />
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
							<WTSTATIC label="WhatsNewProject" space="1" />
							<WTSTATIC value="ATTR(Project.ProjectName)" />
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="0" label="LastVisit">
							<WTCONDITION expr="PARAM(VisitDate)" oper="not-equal" value="CONST('')" />
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and" />
						</WTOPTION>
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="UptoToday" />
						<WTOPTION id="4" label="PrevWeek" />
						<WTOPTION id="5" label="PrevMonth" />
						<WTOPTION id="6" label="PrevYear" />
						<WTOPTION id="7" label="WeekToDate" />
						<WTOPTION id="8" label="MonthToDate" />
						<WTOPTION id="9" label="YearToDate" />
						<!--
						<WTOPTION id="10" label="Tomorrow"/>
						<WTOPTION id="11" label="Next7Days"/>
						<WTOPTION id="12" label="Next14Days"/>
						<WTOPTION id="13" label="Next30Days"/>
-->
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('VisitDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('toDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" prespace="false" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" prespace="false" />
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Report)" default="true" />
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and" />
					<WTSTATIC col="1" tag="ReportProjects" align="center" bold="true" />
					<WTRADIO col="1" group="Rpt" name="3" datapathx="/DATA/PARAM[@rpt=3]" label="AccessProjects">
						<WTCONDITION expr="PARAM(SecurityLevel)" oper="greater-equal" value="CONST(0)" />
					</WTRADIO>
					<WTRADIO col="1" group="Rpt" name="1" datapathx="/DATA/PARAM[@rpt=1]" label="OwnProjects">
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					</WTRADIO>
					<WTRADIO col="1" group="Rpt" name="2" datapathx="/DATA/PARAM[@rpt=2]" label="BelongProjects">
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					</WTRADIO>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
					<WTHIDDEN value="PARAM(Rpt)" />
				</WTROW>
				<WTROW margin-bottom="3">
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(ProjectCount)" oper="equal" value="CONST(0)" />
					<WTSTATIC col="1" label="NoProjects" bold="true" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectCount)" oper="not-equal" value="CONST(0)" />
					<WTROW>
						<WTRECORDSET col="1" graybar="true" entity="Project">
							<WTCOLUMN width="40" align="left" valign="top" label="Projects" />
							<WTCOLUMN width="10" align="left" valign="top" label="Status" />
							<WTCOLUMN width="10" align="left" valign="top" label="ActStartDate" />
							<WTCOLUMN width="10" align="left" valign="top" label="ActEndDate" />
							<WTCOLUMN width="10" align="center" valign="top" label="Notes" />
							<WTCOLUMN width="10" align="center" valign="top" label="Documents" />
							<WTCOLUMN width="10" align="center" valign="top" label="Messages" />
							<WTROW>
								<WTSTATIC col="1" valign="top">
									<WTSTATIC value="DATA(Project.ProjectName)">
										<WTLINK name="7503" target="project">
											<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@projectid&quot;/&gt;))" fontcolor="gray" />
									<WTSTATIC value="CONST([&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='WhatsNew']&quot;/&gt;])">
										<WTCONDITION expr="DATA(ProjectID)" oper="not-equal" value="PARAM(ProjectID)" />
										<WTLINK name="7524" class="PageHeadingLink" target="WhatsNew2">
											<WTPARAM name="ProjectID" value="DATA(ProjectID)" />
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2" valign="top">
									<WTSTATIC label="Pending" fontcolor="gray">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.Status)" fontcolor="green">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-STARTED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.Status)" fontcolor="blue">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.Status)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-CANCELLED)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="3" valign="top">
									<WTSTATIC value="DATA(Project.ActStartDate)">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActStartDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActStartDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="4" valign="top">
									<WTSTATIC value="DATA(Project.ActEndDate)">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActEndDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActEndDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="5" value="DATA(Project.Notes)" valign="top" />
								<WTSTATIC col="6" value="DATA(Project.Documents)" valign="top" />
								<WTSTATIC col="7" valign="top">
									<WTSTATIC value="DATA(Project.Messages)">
										<WTCONDITION expr="DATA(IsForum)" oper="not-equal" value="CONST(0)" />
										<WTLINK name="8411" target="_blank">
											<WTPARAM name="ForumID" value="DATA(ForumID)" />
											<WTPARAM name="IsChat" value="DATA(IsChat)" />
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="7">
									<WTSTATIC value="DATA(Project.MemberName)" fontcolor="purple" space="1"/>
									<WTSTATIC value="DATA(Project.Description)" fontcolor="gray"/>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1">
							<WTSTATIC tag="TotalProjects" space="1" />
							<WTSTATIC value="PARAM(ProjectCount)" />
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(TaskCount)" oper="equal" value="CONST(0)" />
					<WTSTATIC col="1" label="NoTasks" bold="true" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(TaskCount)" oper="not-equal" value="CONST(0)" />
					<WTROW>
						<WTRECORDSET col="1" graybar="true" entity="Task">
							<WTCOLUMN width="40" align="left" valign="top" label="Tasks" />
							<WTCOLUMN width="10" align="left" valign="top" label="Status" />
							<WTCOLUMN width="10" align="left" valign="top" label="ActStartDate" />
							<WTCOLUMN width="10" align="left" valign="top" label="ActEndDate" />
							<WTCOLUMN width="10" align="center" valign="top" label="Notes" />
							<WTCOLUMN width="10" align="center" valign="top" label="Documents" />
							<WTCOLUMN width="10" />
							<WTROW>
								<WTSTATIC col="1" valign="top">
									<WTSTATIC value="DATA(Task.TaskName)">
										<WTLINK name="7403" target="task">
											<WTPARAM name="TaskID" value="DATA(Task.TaskID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@taskid&quot;/&gt;))" fontcolor="gray" />
								</WTSTATIC>
								<WTSTATIC col="2" valign="top">
									<WTSTATIC label="Pending" fontcolor="gray">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.Status)" fontcolor="green">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-STARTED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.Status)" fontcolor="blue">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-COMPLETED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.Status)" fontcolor="red">
										<WTCONDITION expr="DATA(Task.Status)" oper="equal" value="SYSCON(TASK-STATUS-CANCELLED)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="3" valign="top">
									<WTSTATIC value="DATA(Task.ActStartDate)">
										<WTCONDITION expr="DATA(Task.VarStartDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActStartDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Task.VarStartDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActStartDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Task.VarStartDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="4" valign="top">
									<WTSTATIC value="DATA(Task.ActEndDate)">
										<WTCONDITION expr="DATA(Task.VarEndDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActEndDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Task.VarEndDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Task.ActEndDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Task.VarEndDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="5" value="DATA(Task.Notes)" valign="top" />
								<WTSTATIC col="6" value="DATA(Task.Documents)" valign="top" />
								<WTSTATIC col="7" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="7">
									<WTSTATIC value="DATA(Task.MemberName)" fontcolor="purple" space="1"/>
									<WTSTATIC value="DATA(Task.Description)" fontcolor="gray"/>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1">
							<WTSTATIC tag="TotalTasks" space="1" />
							<WTSTATIC value="PARAM(TaskCount)" />
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--==========================================================================================-->
		<WTWEBPAGE name="7525" caption="Project Report" navbar="false" action="5" form="Report" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="7525" language="false" secured="61">
			<!--==========================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Report" datatype="number" />
			<WTPARAM name="Count" datatype="number" />
			<WTPARAM name="IsMember" datatype="text" />
			<WTDATATXN name="Member" />
			<WTDATATXN name="Projects" />
			
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(IsMember)" value="CONST(1)" />
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)" />
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(date)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(Date())" />
			</WTACTION>
			<WTACTION id="3" name="Pending" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)" />
			</WTACTION>
			<WTACTION id="4" name="Started" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(2)" />
			</WTACTION>
			<WTACTION id="5" name="Completed" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(3)" />
			</WTACTION>
			<WTACTION id="6" name="Unassigned" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(4)" />
			</WTACTION>
			<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
				<WTMETHOD name="Load">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMember" direction="return" datatype="text" />
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Projects" project="ptsProjectUser" class="CProjects">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)" />
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="ListCompanyPending">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
					</WTMETHOD>
					<WTMETHOD name="ListCompanyStarted">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
					<WTMETHOD name="ListCompanyCompleted">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="ListMemberPending">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					</WTMETHOD>
					<WTMETHOD name="ListMemberStarted">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
					<WTMETHOD name="ListMemberCompleted">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
				</WTCODEGROUP>
				<WTMETHOD name="Count">
					<WTPARAM name="reqCount" direction="return" datatype="number" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlProjects" direction="return" datatype="text" />
					<WTPARAM name="Option" direction="input" value="CONST(13)" />
				</WTMETHOD>
			</WTOBJECT>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" class="PageHeading" align="center">
						<WTSTATIC label="ProjectsReport" />
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTSTATIC col="1" class="PageHeading" align="center">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1" />
						<WTSTATIC value="ATTR(Member.NameLast)" />
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="UptoToday" />
						<WTOPTION id="4" label="PrevWeek" />
						<WTOPTION id="5" label="PrevMonth" />
						<WTOPTION id="6" label="PrevYear" />
						<WTOPTION id="7" label="WeekToDate" />
						<WTOPTION id="8" label="MonthToDate" />
						<WTOPTION id="9" label="YearToDate" />
						<WTOPTION id="10" label="Tomorrow" />
						<WTOPTION id="11" label="Next7Days" />
						<WTOPTION id="12" label="Next14Days" />
						<WTOPTION id="13" label="Next30Days" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" prespace="false" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" prespace="false" />
					<WTSTATIC col="1" space="3" />
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" action="3" value="CONST(ViewPending)" align="center" default="true" />
					<WTBUTTON col="1" action="4" value="CONST(ViewStarted)" />
					<WTBUTTON col="1" action="5" value="CONST(ViewCompleted)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(ActionCode)" oper="not-equal" value="CONST(0)" />
					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" bold="true">
							<WTSTATIC tag="TotalPending">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalStarted">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalCompleted">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalUnassigned">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
							</WTSTATIC>
							<WTSTATIC space="1" />
							<WTSTATIC value="PARAM(Count)" />
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTRECORDSET col="1" graybar="true" entity="Project">
							<WTCOLUMN width="40" align="left" valign="top" label="Projects" />
							<WTCOLUMN width="24" align="left" valign="top" label="MemberName" />
							<WTCOLUMN width="12" align="left" valign="top" label="Status" />
							<WTCOLUMN width="12" align="center" valign="top" label="StartDate" />
							<WTCOLUMN width="12" align="center" valign="top" label="EndDate" />
							<WTROW>
								<WTSTATIC col="1" valign="top">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
										<WTCODEGROUP>
											<WTIMAGE value="CONST(GreenChecksm.gif)">
												<WTCONDITION expr="DATA(Project.VarEndDate)" oper="less-equal" value="CONST(0)" />
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(RedChecksm.gif)">
												<WTCONDITION expr="DATA(Project.VarEndDate)" oper="greater" value="CONST(0)" />
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(RedX.gif)">
											<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-CANCELLED)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Project.ProjectName)">
										<WTLINK name="7503" target="task">
											<WTPARAM name="ProjectID" value="DATA(Project.ProjectID)" />
											<WTPARAM name="ProjectMemberID" value="ATTR(Project.MemberID)" />
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(Project.MemberName)" fontcolor="purple" valign="top" />
								<WTSTATIC col="3" valign="top">
									<WTSTATIC label="Pending" fontcolor="gray">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.Status)" fontcolor="green">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-STARTED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.Status)" fontcolor="blue">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-COMPLETED)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.Status)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.Status)" oper="equal" value="SYSCON(PROJECT-STATUS-CANCELLED)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="4" valign="top">
									<WTSTATIC value="DATA(Project.ActStartDate)">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActStartDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActStartDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.VarStartDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="5" valign="top">
									<WTSTATIC value="DATA(Project.ActEndDate)">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="equal" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActEndDate)" fontcolor="green">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="less" value="CONST(0)" />
									</WTSTATIC>
									<WTSTATIC value="DATA(Project.ActEndDate)" fontcolor="red">
										<WTCONDITION expr="DATA(Project.VarEndDate)" oper="greater" value="CONST(0)" />
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="5" value="DATA(Project.Description)" fontcolor="gray" />
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTSTATIC col="1" bold="true">
							<WTSTATIC tag="TotalPending">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalStarted">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalCompleted">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalUnassigned">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
							</WTSTATIC>
							<WTSTATIC space="1" />
							<WTSTATIC value="PARAM(Count)" />
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--==========================================================================================-->
		<WTWEBPAGE name="7526" caption="Project Notes Report" navbar="false" action="5" form="Report" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="7526" language="false" secured="61">
			<!--==========================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="ProjectID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="AuthUserID" datatype="number" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Search" datatype="number" />
			<WTPARAM name="Report" datatype="number" />
			<WTPARAM name="SearchText" datatype="text" />
			<WTPARAM name="Count" datatype="number" />
			<WTPARAM name="IsMember" datatype="text" />
			<WTDATATXN name="Member" />
			<WTDATATXN name="Project" />
			<WTDATATXN name="Notes" />
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(Search)" value="CONST(3)" />
				<WTSETATTRIBUTE name="PARAM(IsMember)" value="CONST(1)" />
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(date)" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(Date())" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(&quot;1/1/2000&quot;)" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(Date())" />
				</WTCODEGROUP>
			</WTACTION>
			<WTACTION id="5" name="Activity" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(2)" />
			</WTACTION>
			<WTACTION id="6" name="Reminder" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)" />
			</WTACTION>
			<WTACTION id="7" name="Search" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="PARAM(Search)" />
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="CONST(reqActionCode)" value="CONST(0)" />
					<WTERROR number="0" message="Oops, Please enter text to search for." />
				</WTCODEGROUP>
			</WTACTION>
			<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
				<WTMETHOD name="Load">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTSETATTRIBUTE name="PARAM(AuthUserID)" value="ATTR(AuthUserID)" />
				<WTSETATTRIBUTE name="CONST(tmpAuthUser)" value="CONST(&quot;C&quot; &amp; .CompanyID)" />
				<WTSETATTRIBUTE name="CONST(tmpAuthUser)" value="ATTR(AuthUserID)">
					<WTCONDITION expr="PARAM(IsMember)" oper="equal" value="CONST(1)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpMember)" value="CONST(.MemberID &amp; &quot;-&quot; &amp; .Secure)">
					<WTCONDITION expr="IsSecureProjects"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpMember)" value="ATTR(MemberID)">
					<WTCONDITION expr="NotSecureProjects"/>
				</WTSETATTRIBUTE>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMember" direction="return" datatype="text" />
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
				<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
				<WTMETHOD name="Load">
					<WTPARAM name="ProjectID" direction="input" value="PARAM(ProjectID)" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlProject" direction="return" datatype="text" />
				</WTMETHOD>
			</WTOBJECT>
			<!-- ********************************************************************************* -->
			<!-- If No ProjectID                                                                   -->
			<!--    If No MemberID                                                                 -->
			<!--       View All Notes for All Company Projects (CompanyID)                         -->
			<!--    If MemberID                                                                    -->
			<!--       If Not IsMember                                                             -->
			<!--		     View All Notes for Member's Projects (MemberID, Secure)                  -->
			<!--       If IsMember                                                                 -->
			<!--          View Member's Notes for Member's Projects (AuthUserID, MemberID, Secure) -->
			<!-- If ProjectID                                                                      -->
			<!--    If No MemberID OR Not IsMember                                                 -->
			<!--       View All Notes for specified Project (ProjectID)                            -->
			<!--    If IsMember AND IsMember                                                       -->
			<!--       View Member's Notes for specified Project (ProjectID, AuthUserID)           -->
			<!-- ********************************************************************************* -->
			<!-- Add a day to account for the minutes of the day -->
			<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DATEADD(&quot;d&quot;,1,CDate(reqToDate)))" />
			<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)" />
				<!-- If we don't have a Project, report on all projects for the company -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
					<!-- If we don't have a Member, report on all projects for the company -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							<WTPARAM name="" direction="input" value="CONST(11)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							<WTPARAM name="" direction="input" value="CONST(12)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
							<WTPARAM name="" direction="input" value="CONST(13)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
							<WTPARAM name="" direction="input" value="CONST(14)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(CompanyID)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
					</WTCODEGROUP>
					<!-- If we have a Member, report on all projects for the member -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							<WTPARAM name="" direction="input" value="CONST(15)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpAuthUser)" />
							<WTPARAM name="" direction="input" value="CONST(tmpMember)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							<WTPARAM name="" direction="input" value="CONST(16)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpAuthUser)" />
							<WTPARAM name="" direction="input" value="CONST(tmpMember)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
							<WTPARAM name="" direction="input" value="CONST(17)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpAuthUser)" />
							<WTPARAM name="" direction="input" value="CONST(tmpMember)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
							<WTPARAM name="" direction="input" value="CONST(18)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpAuthUser)" />
							<WTPARAM name="" direction="input" value="CONST(tmpMember)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
						</WTMETHOD>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<!-- If we have a Project, report on the project -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
					<!-- If we don't have a Member, report on the project -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsMember)" oper="not-equal" value="CONST(1)" />
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							<WTPARAM name="" direction="input" value="CONST(21)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							<WTPARAM name="" direction="input" value="CONST(22)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
							<WTPARAM name="" direction="input" value="CONST(23)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
							<WTPARAM name="" direction="input" value="CONST(24)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
					</WTCODEGROUP>
					<!-- If we have a Member, report on the member for this project -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsMember)" oper="equal" value="CONST(1)" />
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							<WTPARAM name="" direction="input" value="CONST(25)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							<WTPARAM name="" direction="input" value="CONST(26)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
							<WTPARAM name="" direction="input" value="CONST(&quot;&quot;)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
							<WTPARAM name="" direction="input" value="CONST(27)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
						</WTMETHOD>
						<WTMETHOD name="ListCustom">
							<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
							<WTPARAM name="" direction="input" value="CONST(28)" />
							<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
							<WTPARAM name="" direction="input" value="PARAM(ProjectID)" />
							<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
							<WTPARAM name="" direction="input" value="PARAM(SearchText)" />
						</WTMETHOD>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTMETHOD name="Count">
					<WTPARAM name="reqCount" direction="return" datatype="number" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlNotes" direction="return" datatype="text" />
					<WTPARAM name="Option" direction="input" value="CONST(13)" />
				</WTMETHOD>
			</WTOBJECT>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />
				<WTSTATIC label="editnote" />
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" class="PageHeading" align="center">
						<WTSTATIC label="ViewAll">
							<WTCONDITION expr="PARAM(ProjectID)" oper="equal" value="CONST(0)" />
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ProjectID)" oper="not-equal" value="CONST(0)" />
							<WTSTATIC label="ViewProject" space="1" />
							<WTSTATIC value="ATTR(Project.ProjectName)" />
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTSTATIC col="1" class="PageHeading" align="center">
						<WTCODEGROUP>
							<WTCODEGROUP>
								<WTCHECK value="PARAM(IsMember)" />
							</WTCODEGROUP>
							<WTSTATIC space="1" />
							<WTSTATIC label="ViewOnlyNotes" space="1" />
							<WTSTATIC value="ATTR(Member.NameFirst)" space="1" />
							<WTSTATIC value="ATTR(Member.NameLast)" />
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="UptoToday" />
						<WTOPTION id="4" label="PrevWeek" />
						<WTOPTION id="5" label="PrevMonth" />
						<WTOPTION id="6" label="PrevYear" />
						<WTOPTION id="7" label="WeekToDate" />
						<WTOPTION id="8" label="MonthToDate" />
						<WTOPTION id="9" label="YearToDate" />
						<WTOPTION id="10" label="Tomorrow" />
						<WTOPTION id="11" label="Next7Days" />
						<WTOPTION id="12" label="Next14Days" />
						<WTOPTION id="13" label="Next30Days" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" action="5" value="CONST(Activities)" align="center" default="true" />
					<WTBUTTON col="1" action="6" value="CONST(Reminders)" />
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchFor" align="center" />
					<WTRADIO col="1" group="Search" name="3" datapathx="/DATA/PARAM[@search=3]" label="StartsWith" prespace="false" />
					<WTRADIO col="1" group="Search" name="4" datapathx="/DATA/PARAM[@search=4]" label="Contains" />
					<WTTEXT col="1" value="PARAM(SearchText)" name="SearchText" />
					<WTBUTTON col="1" action="7" value="CONST(Search)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(ActionCode)" oper="not-equal" value="CONST(0)" />
					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" bold="true">
							<WTSTATIC tag="TotalActivities">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalReminders">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
								<WTSTATIC label="TotalStartingWith" space="1" />
								<WTSTATIC value="PARAM(SearchText)" />
								<WTSTATIC value="CONST(:)" space="1" />
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
								<WTSTATIC label="TotalContaining" space="1" />
								<WTSTATIC value="PARAM(SearchText)" />
								<WTSTATIC value="CONST(:)" space="1" />
							</WTCODEGROUP>
							<WTSTATIC space="1" />
							<WTSTATIC value="PARAM(Count)" />
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTRECORDSET col="1" graybar="true" entity="Note">
							<WTCOLUMN width="100" align="left" valign="top" />
							<WTROW>
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsReminder.gif)">
											<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsFrozen.gif)">
											<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsLocked.gif)">
											<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple" />
									<WTSTATIC value="DATA(Note.UserName)" space="2" fontcolor="blue" />
									<WTSTATIC value="DATA(Note.Data1)">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="ENTITY(Project)" />
										<WTLINK name="7503" class="NavBar" target="Project">
											<WTPARAM name="ProjectID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="ENTITY(Task)" />
										<WTSTATIC value="DATA(Note.Data2)">
											<WTLINK name="7403" class="NavBar" target="Task">
												<WTPARAM name="TaskID" value="DATA(OwnerID)" />
											</WTLINK>
										</WTSTATIC>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(' (', @data1,')')&quot;/&gt;)" />
									</WTCODEGROUP>
									<WTSTATIC value="CONST( - )" />
									<WTSTATIC value="ATTR(Data3)" space="1" />
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='editnote']&quot;/&gt;))">
										<WTCONDITION expr="IsManager" />
										<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start" />
										<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end" />
										<WTLINK name="9003" class="NavBar" target="EditNote">
											<WTPARAM name="NoteID" value="DATA(NoteID)" />
											<WTPARAM name="Popup" value="CONST(1)" />
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" value="DATA(Note.Notes)" />
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTSTATIC col="1" bold="true">
							<WTSTATIC tag="TotalActivities">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
							</WTSTATIC>
							<WTSTATIC tag="TotalReminders">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" />
								<WTSTATIC label="TotalStartingWith" space="1" />
								<WTSTATIC value="PARAM(SearchText)" />
								<WTSTATIC value="CONST(:)" space="1" />
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)" />
								<WTSTATIC label="TotalContaining" space="1" />
								<WTSTATIC value="PARAM(SearchText)" />
								<WTSTATIC value="CONST(:)" space="1" />
							</WTCODEGROUP>
							<WTSTATIC space="1" />
							<WTSTATIC value="PARAM(Count)" />
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>
	</WTWEBPAGES>
</WTROOT>