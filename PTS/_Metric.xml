<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="117" name="Metric" alias="met" audit="false">
 
		<!--Identity-->
		<WTATTRIBUTE id="11701" name="MetricID" type="number" identity="true" min="1" required="true" title="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="11703" name="MemberID" type="number" required="true" source="entity"/>
		<WTATTRIBUTE id="11704" name="MetricTypeID" type="number" source="entity"/>

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="11705" name="MetricTypeName" type="text" length="40" min="1" max="40" source="join">
			<WTJOIN entity="MetricType" name="MetricTypeName" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="11706" name="InputOptions" type="text" length="1000" min="1" max="1000" source="join">
			<WTJOIN entity="MetricType" name="InputOptions"/>
			<WTINPUTOPTIONS name="InputOptions" values="InputValues"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="11707" name="IsGoal" type="yesno" source="entity"/>
		<WTATTRIBUTE id="11708" name="MetricDate" type="date" source="entity"/>
		<WTATTRIBUTE id="11709" name="Qty" type="number" source="entity"/>
		<WTATTRIBUTE id="11710" name="Note" type="text" length="100" source="entity"/>
		<WTATTRIBUTE id="11711" name="InputValues" type="text" length="100" min="1" max="100" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="11781" name="Custom1" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11782" name="Custom2" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11783" name="Custom3" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11784" name="Custom4" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11785" name="Custom5" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11790" name="MemberName" type="text" length="60" source="entity" persist="false"/>
		<WTATTRIBUTE id="11791" name="Points" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="11792" name="FromDate" type="date" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11793" name="ToDate" type="date" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11794" name="CompanyID" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11795" name="GroupID" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11796" name="Rpt" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11797" name="ContestID" type="number" source="entity" persist="false" xml="false"/>
		<WTATTRIBUTE id="11798" name="Unit" type="text" length="40" source="entity" persist="false"/>
		<WTATTRIBUTE id="11799" name="AutoEvent" type="number" source="entity" persist="false" xml="false"/>

		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="IsGoal"/>
			<WTATTRIBUTE name="MetricTypeID"/>
			<WTATTRIBUTE name="MetricDate"/>
		</WTINDEX>
		<WTINDEX name="MetricDate">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="IsGoal"/>
			<WTATTRIBUTE name="MetricDate"/>
			<WTATTRIBUTE name="MetricTypeID"/>
		</WTINDEX>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Metric" entity="Metric" alias="met"/>
			<WTRELATIONSHIP name="Common" entity="Metric" alias="met">
				<WTENTITY name="MetricType" entity="MetricType" alias="mtt">
					<WTATTRIBUTE alias="met" name="MetricTypeID" relalias="mtt" relname="MetricTypeID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="Points" default="true"/>
		</WTENUM>

		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="GOAL_PERSONAL_RESULTS" value="-1"/>
			<WTSYSCON name="GOAL_PERSONAL_ACTIVITIES" value="-2"/>
			<WTSYSCON name="GOAL_LEADERSHIP_RESULTS" value="-3"/>
			<WTSYSCON name="GOAL_LEADERSHIP_ACTIVITIES" value="-4"/>
			<WTSYSCON name="GOAL_TOTAL_POINTS" value="-5"/>
		</WTSYSCONS>

	</WTENTITY>

	<WTPROCEDURES>
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common" />
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderCompany" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderGroup" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(GroupID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderMentor" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderPrivate" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(ContestID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderCompanyCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderGroupCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(GroupID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderMentorCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ExpLeaderPrivateCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(ContestID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.InputOptions)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderCompany" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderGroup" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(GroupID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderMentor" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderPrivate" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(ContestID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderCompanyCustom" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderGroupCustom" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(GroupID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderMentorCustom" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="LeaderPrivateCustom" style="GenerateDataProc.xsl" noedit="true" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(ContestID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTATTRIBUTE name="MetricID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Points"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="ListMember" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(ToDate)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MetricTypeID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeName)"/>
					<WTATTRIBUTE value="ATTR(Metric.MetricDate)"/>
					<WTATTRIBUTE value="ATTR(Metric.Qty)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.Note)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="ListGoal" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MetricTypeID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeName)"/>
					<WTATTRIBUTE value="ATTR(Metric.MetricDate)"/>
					<WTATTRIBUTE value="ATTR(Metric.Qty)"/>
					<WTATTRIBUTE value="ATTR(Metric.Note)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--================================================================================================-->
		<WTPROCEDURE type="Fetch" name="MemberTotal" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(ToDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Qty)" direction="output"/>
			<WTPARAM name="ATTR(Points)" direction="output"/>
			<WTPARAM name="ATTR(MetricTypeID)" direction="output"/> <!-- Rank -->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="Qty" value="ATTR(Member.Qty)"/>
					<WTATTRIBUTE name="Points" value="ATTR(Member.Points)"/>
					<WTATTRIBUTE name="MetricTypeID" value="ATTR(Member.MetricTypeID)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="MemberSummary" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(ToDate)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Qty)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="MemberDetail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MetricTypeID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(ToDate)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MetricDate)"/>
					<WTATTRIBUTE value="ATTR(Metric.Qty)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
					<WTATTRIBUTE value="ATTR(Metric.Note)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="LeaderSummary" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(ToDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Rpt)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Qty)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="List" name="LeaderSummaryCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(ToDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom1)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom2)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom3)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom4)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Custom5)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeID)"/>
					<WTATTRIBUTE value="ATTR(MetricType.MetricTypeName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Qty)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="Report" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Rpt)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Unit)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.Qty)"/>
					<WTATTRIBUTE value="ATTR(Metric.Note)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberCompany" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberGroup" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(GroupID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberMentor" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberPrivate" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(ContestID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberCompanyCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input"/>
			<WTPARAM name="ATTR(Custom2)" direction="input"/>
			<WTPARAM name="ATTR(Custom3)" direction="input"/>
			<WTPARAM name="ATTR(Custom4)" direction="input"/>
			<WTPARAM name="ATTR(Custom5)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberGroupCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(GroupID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input"/>
			<WTPARAM name="ATTR(Custom2)" direction="input"/>
			<WTPARAM name="ATTR(Custom3)" direction="input"/>
			<WTPARAM name="ATTR(Custom4)" direction="input"/>
			<WTPARAM name="ATTR(Custom5)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberMentorCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input"/>
			<WTPARAM name="ATTR(Custom2)" direction="input"/>
			<WTPARAM name="ATTR(Custom3)" direction="input"/>
			<WTPARAM name="ATTR(Custom4)" direction="input"/>
			<WTPARAM name="ATTR(Custom5)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="MemberPrivateCustom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(ContestID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(MemberName)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Custom1)" direction="input"/>
			<WTPARAM name="ATTR(Custom2)" direction="input"/>
			<WTPARAM name="ATTR(Custom3)" direction="input"/>
			<WTPARAM name="ATTR(Custom4)" direction="input"/>
			<WTPARAM name="ATTR(Custom5)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Metric.MetricID)"/>
					<WTATTRIBUTE value="ATTR(Metric.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Metric.Points)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="AutoAdd" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(AutoEvent)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Note)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>

	</WTPROCEDURES>

	<WTWEBPAGES>
      <!--============================================================================================-->
		<WTWEBPAGE name="m_11702" caption="Add Activity" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" mobile="MobileHome.asp" secured="98" track="0">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MetricTypeID" datatype="number"/>
			<WTPARAM name="Required" datatype="text"/>
			<WTPARAM name="IsResult" datatype="number"/>
			<WTPARAM name="InputOptions" datatype="text"/>

			<WTINCLUDE name="Resources.asp"/>
			<WTINCLUDE name="Share.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LockedContestDate">
				<WTSETATTRIBUTE name="CONST(tmpDate)" value="FORM(MetricDate)"/>
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Locked">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="StartDate" direction="input" value="CONST(tmpDate)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="ContestID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCUSTOM>
							DoError 0, "Contest", "Activity date not allowed by locked contest: " + .ContestName
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadList">
				<!-- Get The Group, Shared or Company Activity List -->
				<WTGETCACHE name="CONST(tmpGroupID)" value="GROUPID" datatype="number"/>
				<!-- Custom Handling for Jefferson, make sure they have shared resources loaded -->
				<WTCUSTOM>
					If tmpGroupID = 6528 Then
						tmpResources = GetCache("RESOURCES")
						If tmpRespources = "" Then GetResources tmpGroupID
					End If
				</WTCUSTOM>
				<WTCALLSUB name="tmpGroupID = GetSharedActivities( tmpGroupID, tmpTracks, tmpTheme )">
					<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>
				<WTOBJECT name="MetricTypes" project="ptsMetricTypeUser" class="CMetricTypes">
					<!-- If we didn't find a shared activity group, get the company Activity List -->
					<WTMETHOD name="EnumCompany">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="xmlMetricTypes" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="Element" direction="input" value="CONST()"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- If we found a shared activity group, get the group Activity List -->
					<WTMETHOD name="EnumGroup">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="xmlMetricTypes" direction="return" datatype="text"/>
						<WTPARAM name="GroupID" direction="input" value="CONST(tmpGroupID)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="Element" direction="input" value="CONST()"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MetricTypeID)" value="PARAM(MetricTypeID)"/>
					<WTSETATTRIBUTE name="ATTR(MetricDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(Qty)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(InputOptions)" value="PARAM(InputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetricType">
				<WTOBJECT name="MetricType" project="ptsMetricTypeUser" class="CMetricType">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Required)" value="ATTR(Required)"/>
					<WTSETATTRIBUTE name="PARAM(IsResult)" value="ATTR(IsResult)"/>
					<WTSETATTRIBUTE name="PARAM(InputOptions)" value="ATTR(InputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetricType" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="AddMetric">
				<WTCALLSUB name="LoadMetricType"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Required)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNote)" value="FORM(Note)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpNote)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10133" message="Oops, Please enter the required information." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="LockedContestDate"/>
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(InputOptions)" value="PARAM(InputOptions)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpMetricTypeID)" value="ATTR(MetricTypeID)"/>
					<WTINPUTOPTIONS name="PARAM(InputOptions)" values="ATTR(InputValues)" secure="0"/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="MetricID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNotify)" value="SYSCON(NOTIFYMENTOR-ACTIVITY)">
							<WTCONDITION expr="PARAM(IsResult)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="CONST(tmpNotify)" value="SYSCON(NOTIFYMENTOR-RESULT)">
							<WTCONDITION expr="PARAM(IsResult)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTHTTP>
							<WTLINK name="0418">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								<WTPARAM name="Notify" value="CONST(tmpNotify)"/>
								<WTPARAM name="ID" value="CONST(MetricID)"/>
							</WTLINK>
						</WTHTTP>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMetric"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="1" name="Load" type="Edit">
				<WTCALLSUB name="LoadMetricType"/>
				<WTCALLSUB name="LoadMetric"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTCALLSUB name="AddMetric"/>
				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="m_11711" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="Another" type="Add">
				<WTCALLSUB name="AddMetric"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(MetricTypeID)" value="CONST(0)"/>
					<WTCALLSUB name="LoadMetricType"/>
					<WTCALLSUB name="LoadMetric"/>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTLINK name="m_11711" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(IsResult)"/>
				</WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" label="NewMetric" class="PageHeading" align="left"/>
				</WTROW>

        <WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="MetricTypeID" />
					<WTCOMBO col="2" value="ATTR(Metric.MetricTypeID)" datapath="/DATA/TXN/PTSMETRICTYPES/ENUM">
						<WTCHANGE>doSubmit(1,&quot;&quot;);</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Metric.MetricTypeID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="ATTR(MetricType.Pts)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" class="prompt" align="center">
							<WTSTATIC value="ATTR(MetricType.Description)"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="equal" value="CONST(0)"/>
						<WTHIDDEN value="ATTR(Metric.Qty)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" tag="Qty"/>
						<WTTEXT col="2" value="ATTR(Metric.Qty)" size="2"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="MetricDate"/>
						<WTTEXT col="2" value="ATTR(Metric.MetricDate)"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Metric.InputOptions)" oper="not-equal" value="CONST('')"/>
						<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="0"/>
					</WTCODEGROUP>
					<WTROW>
						<WTCONDITION expr="ATTR(MetricType.Required)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="2" value="ATTR(MetricType.Required)" align="center" fontcolor="blue"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(not()" value="CONST(/DATA/TXN/PTSMETRICTYPE/@required))"/>
						<WTSTATIC col="1" merge="2" tag="Note" align="center" />
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="center" value="ATTR(Metric.Note)" rows="2" cols="35" />
					</WTROW>
				</WTCODEGROUP>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="2" value="CONST(LogActivity)" align="center" btnclass="bigbutton">
            <WTCONDITION expr="ATTR(Metric.MetricTypeID)" oper="not-equal" value="CONST(0)"/>
            <WTCONDITION expr="ATTR(MetricType.Pts)" oper="not-equal" value="CONST(0)" connector="and"/>
          </WTBUTTON>
          <WTBUTTON col="1" merge="2" action="4" value="CONST(LogAnother)" align="center" btnclass="bigbutton">
            <WTCONDITION expr="ATTR(Metric.MetricTypeID)" oper="not-equal" value="CONST(0)"/>
            <WTCONDITION expr="ATTR(MetricType.Pts)" oper="not-equal" value="CONST(0)" connector="and"/>
          </WTBUTTON>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="3" value="CONST(LoggedActivities)" btnclass="bigbutton" align="center"/>
        </WTROW>

      </WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_11703" caption="Marketing System" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="MetricID" datatype="number"/>
			<WTPARAM name="MetricTypeID" datatype="number"/>
			<WTPARAM name="Required" datatype="number"/>
			<WTPARAM name="InputOptions" datatype="text"/>
			<WTPARAM name="MemberID" datatype="number"/>

			<WTSUB name="LockedContestDate">
				<WTSETATTRIBUTE name="CONST(tmpDate)" value="FORM(MetricDate)"/>
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Locked">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="StartDate" direction="input" value="CONST(tmpDate)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="ContestID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCUSTOM>
							DoError 0, "Contest", "Activity date not allowed by locked contest: " + .ContestName
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(oldMetricDate)" value="ATTR(MetricDate)"/>
					<WTSETATTRIBUTES/>
					<WTCALLSUB name="LockedContestDate">
						<WTCONDITION expr="CONST(oldMetricDate)" oper="not-equal" value="ATTR(MetricDate)"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="PARAM(MetricTypeID)" value="ATTR(MetricTypeID)"/>
					<WTINPUTOPTIONS name="PARAM(InputOptions)" values="ATTR(InputValues)" secure="0"/>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MetricTypeID)" value="ATTR(MetricTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="LoadMetricType">
				<WTOBJECT name="MetricType" project="ptsMetricTypeUser" class="CMetricType">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Required)" value="ATTR(Required)"/>
					<WTSETATTRIBUTE name="PARAM(InputOptions)" value="ATTR(InputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetricType" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMetric"/>
				<WTCALLSUB name="LoadMetricType"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="LoadMetricType"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Required)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNote)" value="FORM(Note)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpNote)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10133" message="Oops, Please enter the required information." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="UpdateMetric"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Delete">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Metric.MemberID)"/>
					<WTHIDDEN value="PARAM(MetricTypeID)"/>
				</WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" label="Metric" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="MetricTypeName"/>
					<WTSTATIC col="2" value="ATTR(Metric.MetricTypeName)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" class="prompt" align="center">
						<WTSTATIC value="ATTR(MetricType.Description)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="equal" value="CONST(0)"/>
					<WTHIDDEN value="ATTR(Metric.Qty)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="Qty"/>
					<WTTEXT col="2" value="ATTR(Metric.Qty)" size="2"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="MetricDate"/>
					<WTTEXT col="2" value="ATTR(Metric.MetricDate)"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Metric.InputOptions)" oper="not-equal" value="CONST('')"/>
					<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="0"/>
				</WTCODEGROUP>

				<WTROW>
					<WTCONDITION expr="ATTR(MetricType.Required)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" merge="2" value="ATTR(MetricType.Required)" align="center" fontcolor="blue"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(not()" value="CONST(/DATA/TXN/PTSMETRICTYPE/@required))"/>
					<WTSTATIC col="1" merge="2" tag="Note" align="center" />
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="center" value="ATTR(Metric.Note)" rows="2" cols="35" />
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center" btnclass="bigbutton"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" btnclass="bigbutton"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete" btnclass="bigbutton"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_11723" caption="Marketing System" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="MetricID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Term" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(MetricID)" oper="equal" value="CONST(0)"/>
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(IsGoal)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(MetricDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(MetricTypeID)" value="SYSCON(GOAL_PERSONAL_RESULTS)"/>
					<WTSETATTRIBUTE name="ATTR(Note)" value="CONST(2)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMetricID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB name="UpdateMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Note)" value="PARAM(Term)"/>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Term)" value="ATTR(Note)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMetric"/>
			</WTACTION>

			<WTACTION id="1" name="UpdateExit" type="Update">
				<WTCALLSUB name="UpdateMetric"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Delete">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Metric.MemberID)"/>
				</WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" label="Goal" class="PageHeading" align="left"/>
				</WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Goal"/>
					<WTCOMBO col="2" value="ATTR(Metric.MetricTypeID)">
						<WTOPTION id="-1" label="GoalPersonalResults"/>
						<WTOPTION id="-2" label="GoalPersonalActivities"/>
						<WTOPTION id="-3" label="GoalLeadershipResults"/>
						<WTOPTION id="-4" label="GoalLeadershipActivities"/>
						<WTOPTION id="-5" label="GoalTotalPoints"/>
					</WTCOMBO>
				</WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Points"/>
					<WTTEXT col="2" value="ATTR(Metric.Qty)" size="3"/>
					<WTCOMBO col="2" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Weekly"/>
						<WTOPTION id="2" label="Monthly"/>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="GoalDate"/>
					<WTTEXT col="2" value="ATTR(Metric.MetricDate)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center" btnclass="bigbutton">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" btnclass="bigbutton"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete" btnclass="bigbutton">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_11710" caption="Leader Board" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" action="5" viewport="width=device-width"
	 	    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="52" track="0">
			<!--==================================================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="Scope" datatype="number"/>
			<WTPARAM name="Rpt" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="ContestID" datatype="number"/>
			<WTPARAM name="Private" datatype="number"/>
			<WTPARAM name="NoDates" datatype="number"/>
			<WTPARAM name="EnrollDate" datatype="date"/>
			<WTPARAM name="SearchMember" datatype="text"/>
			<WTPARAM name="OwnerContestID" datatype="number"/>
			<WTPARAM name="ContestName" datatype="text"/>
			<WTPARAM name="Custom1" datatype="number"/>
			<WTPARAM name="Custom2" datatype="number"/>
			<WTPARAM name="Custom3" datatype="number"/>
			<WTPARAM name="Custom4" datatype="number"/>
			<WTPARAM name="Custom5" datatype="number"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(Points)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(EnrollDate)" oper="equal" value="CONST(&quot;&quot;)" />
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="CONST(DateValue(.EnrollDate))" />
				</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB name="LoadContests">
				<WTOBJECT name="Contests" project="ptsContestUser" class="CContests">
					<WTMETHOD name="EnumContest">
						<WTPARAM name="xmlContests" direction="return" datatype="text"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						xmlContests = Replace(xmlContests, CHR(34) + " " + CHR(34), CHR(34) + "Show All" + CHR(34))
					</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)" />
				<WTCONDITION expr="CONST(reqActionCode)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Active">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ContestID" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ContestID)" value="CONST(ContestID)">
						<WTCONDITION expr="CONST(ContestID)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(ContestID)" oper="not-equal" value="CONST(0)" />
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Load">
						<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Private)" value="ATTR(IsPrivate)"/>
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(2)">
						<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Rpt)" value="ATTR(Metric)"/>
					<WTSETATTRIBUTE name="PARAM(Custom1)" value="ATTR(Custom1)"/>
					<WTSETATTRIBUTE name="PARAM(Custom2)" value="ATTR(Custom2)"/>
					<WTSETATTRIBUTE name="PARAM(Custom3)" value="ATTR(Custom3)"/>
					<WTSETATTRIBUTE name="PARAM(Custom4)" value="ATTR(Custom4)"/>
					<WTSETATTRIBUTE name="PARAM(Custom5)" value="ATTR(Custom5)"/>
					<WTSETATTRIBUTE name="PARAM(ContestName)" value="ATTR(ContestName)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(StartDate)" oper="not-equal" value="CONST(&quot;0&quot;)"/>
						<WTSETATTRIBUTE name="PARAM(FromDate)" value="ATTR(StartDate)"/>
						<WTSETATTRIBUTE name="PARAM(ToDate)" value="ATTR(EndDate)"/>
						<WTSETATTRIBUTE name="PARAM(NoDates)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(0)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(StartDate)" oper="equal" value="CONST(&quot;0&quot;)"/>
						<WTSETATTRIBUTE name="PARAM(NoDates)" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Term)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
							<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)" />
				<WTCONDITION expr="PARAM(Term)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID" datatype="number">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)" />
				</WTGETCACHE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(2)">
						<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Rpt)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="SYS(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(SearchMember)" value="CONST(&quot;&quot;)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(reqPos - 20)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(reqPos + 20)"/>
			</WTACTION>

			<WTACTION id="8" name="SearchMember" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(0)"/>
			</WTACTION>

			<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Rpt)" oper="not-equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="LeaderCompany">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderGroup">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderMentor">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="LeaderPrivate">
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="not-equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="MemberCompany">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberGroup">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberMentor">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="MemberPrivate">
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="LeaderCompanyCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderGroupCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderMentorCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="LeaderPrivateCustom">
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="not-equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="MemberCompanyCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberGroupCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberMentorCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="MemberPrivateCustom">
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<WTCODEGROUP post="true">
				<WTCALLSUB name="LoadContests"/>
			</WTCODEGROUP>


			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(GroupID)"/>
					<WTHIDDEN value="PARAM(Pos)"/>
					<WTHIDDEN value="PARAM(EnrollDate)" />
					<WTHIDDEN value="PARAM(Custom1)" />
					<WTHIDDEN value="PARAM(Custom2)" />
					<WTHIDDEN value="PARAM(Custom3)" />
					<WTHIDDEN value="PARAM(Custom4)" />
					<WTHIDDEN value="PARAM(Custom5)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(ContestID)" oper="not-equal" value="CONST(0)"/>
					<WTHIDDEN value="PARAM(Scope)"/>
					<WTHIDDEN value="PARAM(Rpt)"/>
				</WTROW>

        <WTROW margin-top="6" margin-bottom="6">
            <WTSTATIC col="1" align="center">
						<WTSTATIC label="LeaderBoard" fontcolor="#000070" fontsize="3" bold="true"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)"/>
							<WTSTATIC space="2"/>
							<WTCOMBO name="Scope" value="PARAM(Scope)">
								<WTOPTION id="1" label="CompanyID"/>
								<WTOPTION id="2" label="GroupID">
									<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
								</WTOPTION>
								<WTOPTION id="3" label="Mentor">
									<WTCONDITION expr="SYS(MemberID)" oper="not-equal" value="CONST(0)"/>
								</WTOPTION>
							</WTCOMBO>
							<WTSTATIC space="1"/>
							<WTCOMBO name="Rpt" value="PARAM(Rpt)">
								<WTOPTION id="1" label="Results"/>
								<WTOPTION id="2" label="Activities"/>
								<WTOPTION id="3" label="All"/>
							</WTCOMBO>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

        <WTROW margin-bottom="6">
          <WTCONDITION expr="CONST(count(/DATA/TXN/PTSCONTESTS/ENUM))" oper="greater" value="CONST(1)"/>
					<WTCONDITION expr="PARAM(OwnerContestID)" oper="not-equal" value="CONST(0)" connector="or"/>
					<WTSTATIC col="1" align="center">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(OwnerContestID)" oper="equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(contest.gif)" imgalign="absmiddle"/>
							<WTCOMBO value="PARAM(ContestID)" datapath="/DATA/TXN/PTSCONTESTS/ENUM" setselected="true">
								<WTCHANGE>doSubmit(5,"")</WTCHANGE>
							</WTCOMBO>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(OwnerContestID)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(contest.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="PARAM(ContestName)" bold="true"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
        <WTROW margin-bottom="6">
          <WTCONDITION expr="PARAM(NoDates)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" align="center">
						<WTSTATIC label="from" value="PARAM(FromDate)" align="center" bold="true" space="2"/>
						<WTSTATIC label="to" value="PARAM(ToDate)" bold="true"/>
					</WTSTATIC>
				</WTROW>

        <WTROW margin-bottom="6">
          <WTCONDITION expr="PARAM(NoDates)" oper="not-equal" value="CONST(0)"/>
					<WTHIDDEN value="PARAM(Term)"/>
					<WTHIDDEN value="PARAM(FromDate)"/>
					<WTHIDDEN value="PARAM(ToDate)"/>
				</WTROW>
        <WTROW margin-bottom="6">
          <WTCONDITION expr="PARAM(NoDates)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="LeadersFor" class="ColumnHeader"/>
					<WTCOMBO col="1" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Membership" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="Yesterday" />
						<WTOPTION id="9" label="Prev7" />
						<WTOPTION id="10" label="Prev30" />
						<WTOPTION id="4" label="ThisWeek" />
						<WTOPTION id="5" label="ThisMonth" />
						<WTOPTION id="6" label="ThisYear" />
						<WTOPTION id="7" label="LastWeek" />
						<WTOPTION id="8" label="LastMonth" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							term = document.getElementById('Term').value;
							switch(term) {
							case "1":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "2":
							break;
							case "3":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "4":
							var d = fromdate.getDay()
							if( d == 0 ) { d = 7 }
							fromdate.setTime(fromdate.getTime() - ( (d-1) * ONE_DAY ) );
							break;
							case "5":
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							var d = todate.getDay()
							if( d == 0 ) { d = 7 }
							todate.setTime(todate.getTime() - ( d * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "8":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setTime(fromdate.getTime() - ( 6 * ONE_DAY) );
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() - ( 30 * ONE_DAY) );
							break;
							}
							if(term!=1){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="from"/>
					<WTTEXT col="1" value="PARAM(FromDate)" size="8" focus="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="to"/>
					<WTTEXT col="1" value="PARAM(ToDate)" size="8" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(View)" default="true" btnclass="bigbutton"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="true" entity="Metric">
						<WTCOLUMN width="15" align="center" valign="top" label="#" />
						<WTCOLUMN width="55" align="left" valign="top" label="MemberName" />
						<WTCOLUMN width="15" align="left" valign="top" label="Points" />
						<WTCOLUMN width="15" align="left" valign="top"/>
						<WTROW height="30">
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()+/DATA/PARAM/@pos&quot;/&gt;)"/>
							<WTSTATIC col="2" value="DATA(Metric.MemberName)"/>
							<WTSTATIC col="3" value="DATA(Metric.Points)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview24.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="m_11714">
											<WTPARAM name="MemberID" value="DATA(MetricID)"/>
											<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
											<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
											<WTPARAM name="Rpt" value="PARAM(Rpt)"/>
											<WTPARAM name="OwnerContestID" value="PARAM(OwnerContestID)"/>
											<WTPARAM name="Custom1" value="PARAM(Custom1)"/>
											<WTPARAM name="Custom2" value="PARAM(Custom2)"/>
											<WTPARAM name="Custom3" value="PARAM(Custom3)"/>
											<WTPARAM name="Custom4" value="PARAM(Custom4)"/>
											<WTPARAM name="Custom5" value="PARAM(Custom5)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchMember" align="center"/>
					<WTTEXT col="1" value="PARAM(SearchMember)" size="8" prespace="false"/>
					<WTBUTTON col="1" action="8" value="CONST(Search)" btnclass="bigbutton"/>
					<WTBUTTON col="1" action="5" value="CONST(All)" btnclass="bigbutton"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_11711" caption="Member Metrics" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="EnrollDate" datatype="date"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(EnrollDate)" oper="equal" value="CONST(&quot;&quot;)" />
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="CONST(DateValue(.EnrollDate))" />
				</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB name="ViewMetrics">
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="ListMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="View" type="View" id="1">
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="Add" type="Add" id="2">
				<WTRETURN>
					<WTLINK name="m_11702" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="40" align="right"/>
				<WTCOLUMN width="60" align="left"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" class="PageHeading" align="center">
						<WTSTATIC label="Metrics" space="5" fontsize="4"/>
						<WTCODEGROUP>
							<WTBUTTON action="2" value="CONST(NewMetric)" btnclass="bigbutton"/>
						</WTCODEGROUP>
<!--            
						<WTCODEGROUP>
							<WTSTATIC space="5"/>
							<WTIMAGE value="CONST(stats.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Stats">
								<WTLINK name="m_11712">
									<WTPARAM name="MemberID" value="PARAM(MemberID)" />
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
-->            
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="MetricsFor" class="ColumnHeader"/>
					<WTCOMBO col="2" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Membership" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="Yesterday" />
						<WTOPTION id="9" label="Prev7" />
						<WTOPTION id="10" label="Prev30" />
						<WTOPTION id="4" label="ThisWeek" />
						<WTOPTION id="5" label="ThisMonth" />
						<WTOPTION id="6" label="ThisYear" />
						<WTOPTION id="7" label="LastWeek" />
						<WTOPTION id="8" label="LastMonth" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							term = document.getElementById('Term').value;
							switch(term) {
							case "1":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "2":
							break;
							case "3":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "4":
							var d = fromdate.getDay()
							if( d == 0 ) { d = 7 }
							fromdate.setTime(fromdate.getTime() - ( (d-1) * ONE_DAY ) );
							break;
							case "5":
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							var d = todate.getDay()
							if( d == 0 ) { d = 7 }
							todate.setTime(todate.getTime() - ( d * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "8":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setTime(fromdate.getTime() - ( 6 * ONE_DAY) );
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() - ( 30 * ONE_DAY) );
							break;
							}
							if(term!=1){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="from"/>
					<WTTEXT col="2" value="PARAM(FromDate)" size="8" focus="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="to"/>
					<WTTEXT col="2" value="PARAM(ToDate)" size="8" focus="true"/>
					<WTBUTTON col="2" action="1" value="CONST(View)" default="true" btnclass="bigbutton"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Metric">
						<WTCOLUMN width="10" align="center" valign="top" label="MetricDate"/>
						<WTCOLUMN width="10" align="center" valign="top" label="qty"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Pts"/>
						<WTCOLUMN width="70" align="left" valign="top" label="MetricTypeName"/>
						<WTROW height="30">
							<WTSTATIC col="1" value="DATA(MetricDate)"/>
							<WTSTATIC col="2" value="DATA(Qty)"/>
							<WTSTATIC col="3" value="DATA(Points)"/>
							<WTSTATIC col="4">
								<WTSTATIC value="DATA(MetricTypeName)"/>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="m_11703">
											<WTPARAM name="MetricID" value="DATA(MetricID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Note)" oper="not-equal" value="CONST('')"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Note)" fontcolor="gray"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_11721" caption="Activity Goals" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98" track="0">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="ViewMetrics">
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="ListGoal">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="Add" type="Add" id="2">
				<WTRETURN>
					<WTLINK name="m_11723" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" class="PageHeading" align="center">
						<WTSTATIC label="ActivityGoals" space="5"/>
					  <WTCODEGROUP>
						  <WTBUTTON action="2" value="CONST(NewGoal)" btnclass="bigbutton" align="right"/>
					  </WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

        <WTROW margin-bottom="6">
          <WTRECORDSET col="1" merge="2" graybar="true" entity="Metric">
						<WTCOLUMN width="100" align="left" valign="top" label="Goal"/>
						<WTROW height="30">
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(MetricDate)" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="m_11723">
											<WTPARAM name="MetricID" value="DATA(MetricID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Qty)" space="1"/>
								<WTSTATIC label="Weekly">
									<WTCONDITION expr="DATA(Note)" oper="equal" value="CONST('1')"/>
								</WTSTATIC>
								<WTSTATIC label="Monthly">
									<WTCONDITION expr="DATA(Note)" oper="equal" value="CONST('2')"/>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTSTATIC label="GoalPersonalResults">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_PERSONAL_RESULTS)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalPersonalActivities">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_PERSONAL_ACTIVITIES)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalLeadershipResults">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_LEADERSHIP_RESULTS)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalLeadershipActivities">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_LEADERSHIP_ACTIVITIES)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalTotalPoints">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_TOTAL_POINTS)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>


		<!--============================================================================================-->
		<WTWEBPAGE name="m_11712" caption="Activity Statistics" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="52" track="0">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Total" datatype="number"/>
			<WTPARAM name="Days" datatype="number"/>
			<WTPARAM name="Days30" datatype="number"/>
			<WTPARAM name="Track" datatype="number"/>
			<WTPARAM name="Theme" datatype="number"/>
			<WTPARAM name="Rank" datatype="number"/>
			<WTPARAM name="EnrollDate" datatype="date"/>

			<WTPARAM name="FromPts1" datatype="number"/>
			<WTPARAM name="FromPts2" datatype="number"/>
			<WTPARAM name="FromPts3" datatype="number"/>
			<WTPARAM name="FromPts4" datatype="number"/>
			<WTPARAM name="FromPts5" datatype="number"/>
			<WTPARAM name="ToPts1" datatype="number"/>
			<WTPARAM name="ToPts2" datatype="number"/>
			<WTPARAM name="ToPts3" datatype="number"/>
			<WTPARAM name="ToPts4" datatype="number"/>

			<WTINCLUDE name="Resources.asp"/>
			<WTINCLUDE name="Share.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="CONST(DateValue(.EnrollDate))" />
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)" />
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ViewMetrics">
				<!-- If we found an activity group, we also get the Activity Tracks -->
				<WTCALLSUB name="reqGroupID = GetSharedActivities( reqGroupID, tmpTracks, reqTheme )">
					<WTCONDITION expr="CONST(reqGroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>
				<!-- If we didn't find a shared activity group, get the company Activity Tracks -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="CONST(reqGroupID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTracks)" value="ATTR(UploadURL)"/>
				</WTOBJECT>
				
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="MemberTotal">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Rank)" value="ATTR(MetricTypeID)"/>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="MemberSummary">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTCUSTOM>
						Default = "10,100,250,500"
						If tmpTracks = "" Then tmpTracks = Default
						pts = Split(tmpTracks, ",")
						If UBOUND(pts) &lt; 3 Then
						tmpTracks = Default
						pts = Split(tmpTracks, ",")
						End If

						reqFromPts1 = 1
						reqToPts1 =   pts(0)
						reqFromPts2 = pts(0) + 1
						reqToPts2 =   pts(1)
						reqFromPts3 = pts(1) + 1
						reqToPts3 =   pts(2)
						reqFromPts4 = pts(2) + 1
						reqToPts4 =   pts(3)
						reqFromPts5 = pts(3) + 1

						reqTotal = 0
						For Each oItem in oMetrics
						reqTotal = reqTotal + oItem.Points
						Next
						reqDays = DateDiff( &quot;d&quot;, reqFromDate, reqToDate ) + 1
						If reqDays &gt; 0 Then
						avg = ROUND( reqTotal / reqDays, 1)
						reqDays30 = avg * 30
						If reqDays30 &lt;= reqToPts1 Then reqTrack = 1
						If reqDays30 &gt;= reqFromPts2 And reqDays30 &lt;= reqToPts2 Then reqTrack = 2
						If reqDays30 &gt;= reqFromPts3 And reqDays30 &lt;= reqToPts3 Then reqTrack = 3
						If reqDays30 &gt;= reqFromPts4 And reqDays30 &lt;= reqToPts4 Then reqTrack = 4
						If reqDays30 &gt;= reqFromPts5 Then reqTrack = 5
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="LoadMember"/>
				<!-- Start with membership -->
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)" />
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="View" type="View" id="1">
				<WTCALLSUB name="LoadMember"/>
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN>
					<WTLINK name="m_11711" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(EnrollDate)" />
				</WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="MemberSummary" class="PageHeading" align="left"/>
				</WTROW>

        <WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="MetricsFor" class="ColumnHeader"/>
					<WTCOMBO col="1" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Membership" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="Yesterday" />
						<WTOPTION id="9" label="Prev7" />
						<WTOPTION id="10" label="Prev30" />
						<WTOPTION id="4" label="ThisWeek" />
						<WTOPTION id="5" label="ThisMonth" />
						<WTOPTION id="6" label="ThisYear" />
						<WTOPTION id="7" label="LastWeek" />
						<WTOPTION id="8" label="LastMonth" />
						<WTOPTION id="11" label="Prev60" />
						<WTOPTION id="12" label="Prev90" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							term = document.getElementById('Term').value;
							switch(term) {
							case "1":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "2":
							break;
							case "3":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "4":
							var d = fromdate.getDay()
							if( d == 0 ) { d = 7 }
							fromdate.setTime(fromdate.getTime() - ( (d-1) * ONE_DAY ) );
							break;
							case "5":
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							var d = todate.getDay()
							if( d == 0 ) { d = 7 }
							todate.setTime(todate.getTime() - ( d * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "8":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setTime(fromdate.getTime() - ( 6 * ONE_DAY) );
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() - ( 30 * ONE_DAY) );
							break;
							case "11":
							fromdate.setTime(fromdate.getTime() - ( 60 * ONE_DAY) );
							break;
							case "12":
							fromdate.setTime(fromdate.getTime() - ( 90 * ONE_DAY) );
							break;
							}
							if(term!=1){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="from"/>
					<WTTEXT col="1" value="PARAM(FromDate)" size="8" focus="true"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" tag="to"/>
					<WTTEXT col="1" value="PARAM(ToDate)" size="8" focus="true"/>
					<WTBUTTON col="1" action="1" value="CONST(View)" default="true" btnclass="bigbutton"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="80" align="center"/>
						<WTCOLUMN width="10" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTABLE col="2" valign="top" padding="0" style="border: 1px #7589a6 solid">
								<WTCOLUMN width="80" align="center"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#7589a6">
										<WTSTATIC label="CurrentTrack" fontcolor="white" bold="true"/>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" align="center" fontsize="3" fontcolor="purple" backcolor="white">
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(0)"/>
											<WTSTATIC label="Track1">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(1)"/>
											</WTSTATIC>
											<WTSTATIC label="Track2">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(2)"/>
											</WTSTATIC>
											<WTSTATIC label="Track3">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(3)"/>
											</WTSTATIC>
											<WTSTATIC label="Track4">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(4)"/>
											</WTSTATIC>
											<WTSTATIC label="Track5">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(5)"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(1)"/>
											<WTSTATIC label="Track1a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(1)"/>
											</WTSTATIC>
											<WTSTATIC label="Track2a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(2)"/>
											</WTSTATIC>
											<WTSTATIC label="Track3a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(3)"/>
											</WTSTATIC>
											<WTSTATIC label="Track4a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(4)"/>
											</WTSTATIC>
											<WTSTATIC label="Track5a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(5)"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTSTATIC space="3"/>
										<WTSTATIC label="Ranking"/>
										<WTSTATIC value="PARAM(Rank)"/>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
							<WTSTATIC col="3"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
        <WTROW margin-bottom="6">
          <WTRECORDSET col="1" merge="2" graybar="true" entity="Metric" align="left">
						<WTCOLUMN width="15" align="center" valign="top" label="qty"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Pts"/>
						<WTCOLUMN width="70" align="left" valign="top" label="MetricTypeName"/>
						<WTROW height="30">
							<WTSTATIC col="1" value="DATA(Qty)"/>
							<WTSTATIC col="2" value="DATA(Points)"/>
							<WTSTATIC col="3">
								<WTSTATIC value="DATA(MetricTypeName)"/>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview24.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="m_11713">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="MetricTypeID" value="DATA(MetricTypeID)"/>
											<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
											<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
        <WTROW>
          <WTTABLE col="1" merge="2" align="left">
						<WTCOLUMN width="15" align="right"/>
						<WTCOLUMN width="15" align="center"/>
						<WTCOLUMN width="70" align="left"/>
						<WTROW>
							<WTSTATIC col="1" tag="Total" bold="true" valign="top"/>
							<WTSTATIC col="2" value="PARAM(Total)" bold="true" valign="top"/>
							<WTSTATIC col="3" bold="true">
								<WTSTATIC label="in" space="1"/>
								<WTSTATIC value="PARAM(Days)" space="1"/>
								<WTSTATIC label="days" space="1"/>
								<WTSTATIC label="ontrack" newline="1"/>
								<WTSTATIC value="PARAM(Days30)" space="1"/>
								<WTSTATIC label="in30Days"/>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="3" value="CONST(LoggedActivities)" align="center" btnclass="bigbutton"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTTABLE col="1" merge="2" align="left">
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="80" align="center"/>
						<WTCOLUMN width="10" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTABLE col="2" valign="top" padding="0" style="border: 1px #7589a6 solid">
								<WTCOLUMN width="35" align="center"/>
								<WTCOLUMN width="45" align="left"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#7589a6">
										<WTSTATIC label="MonthlyTracks" fontcolor="white" bold="true"/>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" align="center" fontcolor="004080" backcolor="#ffffff">
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts1,'-',/DATA/PARAM/@topts1,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts2,'-',/DATA/PARAM/@topts2,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts3,'-',/DATA/PARAM/@topts3,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts4,'-',/DATA/PARAM/@topts4,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts5,'+ pts.')&quot;/&gt;)"/>
									</WTSTATIC>
									<WTSTATIC col="2" align="left" fontcolor="004080" backcolor="#ffffff">
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(0)"/>
											<WTSTATIC label="Track1" newline="1"/>
											<WTSTATIC label="Track2" newline="1"/>
											<WTSTATIC label="Track3" newline="1"/>
											<WTSTATIC label="Track4" newline="1"/>
											<WTSTATIC label="Track5"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(1)"/>
											<WTSTATIC label="Track1a" newline="1"/>
											<WTSTATIC label="Track2a" newline="1"/>
											<WTSTATIC label="Track3a" newline="1"/>
											<WTSTATIC label="Track4a" newline="1"/>
											<WTSTATIC label="Track5a"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
							<WTSTATIC col="3"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_11713" caption="Member Metrics" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MetricTypeID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Total" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID" datatype="number"/>
				<WTOBJECT name="MetricType" project="ptsMetricTypeUser" class="CMetricType">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetricType" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="MemberDetail">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTCUSTOM>
						reqTotal = 0
						For Each oItem in oMetrics
						reqTotal = reqTotal + oItem.Points
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW>
					<WTSTATIC col="1" tag="MemberDetail" value="ATTR(MetricType.MetricTypeName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" class="PageHeading" align="center">
						<WTSTATIC value="PARAM(FromDate)" space="1"/>
						<WTSTATIC label="to" space="1"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Metric">
						<WTCOLUMN width="15" align="center" valign="top" label="MetricDate"/>
						<WTCOLUMN width="15" align="center" valign="top" label="qty"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Pts"/>
						<WTCOLUMN width="55" align="left" valign="top"/>
						<WTROW height="30">
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(MetricDate)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="SYS(MemberID)" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="m_11703">
											<WTPARAM name="MetricID" value="DATA(MetricID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Qty)"/>
							<WTSTATIC col="3" value="DATA(Points)"/>
							<WTSTATIC col="4" value="DATA(Note)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTTABLE col="1">
						<WTCOLUMN width="96" align="right"/>
						<WTCOLUMN width="48" align="center"/>
						<WTCOLUMN width="176" align="left"/>
						<WTROW>
							<WTSTATIC col="1" tag="TotalPoints" bold="true"/>
							<WTSTATIC col="2" value="PARAM(Total)" bold="true"/>
							<WTSTATIC col="3"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center" btnclass="bigbutton"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_11714" caption="Member Metrics" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Rpt" datatype="number"/>
			<WTPARAM name="Qty" datatype="number"/>
			<WTPARAM name="Points" datatype="number"/>
			<WTPARAM name="Days" datatype="number"/>
			<WTPARAM name="Days30" datatype="number"/>
			<WTPARAM name="Name" datatype="text"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="OwnerContestID" datatype="number"/>
			<WTPARAM name="Custom1" datatype="number"/>
			<WTPARAM name="Custom2" datatype="number"/>
			<WTPARAM name="Custom3" datatype="number"/>
			<WTPARAM name="Custom4" datatype="number"/>
			<WTPARAM name="Custom5" datatype="number"/>

			<WTSUB name="ViewMetrics">
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID" datatype="number"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Name)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="LeaderSummary">
						<WTCONDITION expr="PARAM(Rpt)" oper="not-equal" value="CONST(0)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
					</WTMETHOD>
					<WTMETHOD name="LeaderSummaryCustom">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
						<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
						<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
						<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
						<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
					</WTMETHOD>
					<WTCUSTOM>
						reqQty = 0
						reqPoints = 0
						For Each oItem in oMetrics
						With oItem
						reqQty = reqQty + .Qty
						reqPoints = reqPoints + .Points
						End With
						Next
						reqDays = DateDiff( &quot;d&quot;, reqFromDate, reqToDate ) + 1
						If reqDays &gt; 0 Then
						avg = ROUND( reqPoints / reqDays, 1)
						reqDays30 = avg * 30
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW>
					<WTSTATIC col="1" tag="LeaderSummary" value="PARAM(Name)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" class="ColumnHeader" align="center">
						<WTSTATIC label="View" space="1"/>
						<WTSTATIC label="Custom">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="Results">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="Activities">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="ResultsActivities">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC space="1"/>
						<WTSTATIC label="from" space="1"/>
						<WTSTATIC value="PARAM(FromDate)" space="1"/>
						<WTSTATIC label="to" space="1"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Metric">
						<WTCOLUMN width="15" align="center" valign="top" label="qty"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Pts"/>
						<WTCOLUMN width="55" align="left" valign="top" label="MetricTypeName"/>
						<WTCOLUMN width="15" align="left" valign="top"/>
						<WTROW height="30">
							<WTSTATIC col="1" value="DATA(Qty)"/>
							<WTSTATIC col="2" value="DATA(Points)"/>
							<WTSTATIC col="3" value="DATA(MetricTypeName)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="SYS(MemberID)" connector="or"/>
									<WTCONDITION expr="PARAM(OwnerContestID)" oper="not-equal" value="CONST(0)" connector="or"/>
									<WTIMAGE value="CONST(Preview24.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="m_11713">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="MetricTypeID" value="DATA(MetricTypeID)"/>
											<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
											<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTTABLE col="1">
						<WTCOLUMN width="15" align="center"/>
						<WTCOLUMN width="15" align="center"/>
						<WTCOLUMN width="70" align="left"/>
						<WTROW>
							<WTSTATIC col="1" value="PARAM(Qty)" bold="true"/>
							<WTSTATIC col="2" value="PARAM(Points)" bold="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center" btnclass="bigbutton"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="11702" caption="Add Contact" header="false" footer="false" navbar="false" wrapper="wrapper600"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" track="0">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MetricTypeID" datatype="number"/>
			<WTPARAM name="Required" datatype="text"/>
			<WTPARAM name="IsResult" datatype="number"/>
			<WTPARAM name="InputOptions" datatype="text"/>

			<WTINCLUDE name="Resources.asp"/>
			<WTINCLUDE name="Share.asp"/>
<!--
			<WTCODEGROUP>
				<WTCONDITION expr="CONST(reqReturnURL)" oper="equal" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(reqReturnURL)" value="CONST(&quot;11711.asp?memberid=&quot; + CStr(reqMemberID))"/>
				<WTSETCACHE name="11702URL" value="CONST(reqReturnURL)"/>
			</WTCODEGROUP>
-->
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LockedContestDate">
				<WTSETATTRIBUTE name="CONST(tmpDate)" value="FORM(MetricDate)"/>
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Locked">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="StartDate" direction="input" value="CONST(tmpDate)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="ContestID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCUSTOM>
							DoError 0, "Contest", "Activity date not allowed by locked contest: " + .ContestName
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadList">
				<!-- Get The Group, Shared or Company Activity List -->
				<WTGETCACHE name="CONST(tmpGroupID)" value="GROUPID" datatype="number"/>
				<WTCALLSUB name="tmpGroupID = GetSharedActivities( tmpGroupID, tmpTracks, tmpTheme )">
					<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>
				<WTOBJECT name="MetricTypes" project="ptsMetricTypeUser" class="CMetricTypes">
					<!-- If we didn't find a shared activity group, get the company Activity List -->
					<WTMETHOD name="EnumCompany">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="xmlMetricTypes" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="Element" direction="input" value="CONST()"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- If we found a shared activity group, get the group Activity List -->
					<WTMETHOD name="EnumGroup">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="xmlMetricTypes" direction="return" datatype="text"/>
						<WTPARAM name="GroupID" direction="input" value="CONST(tmpGroupID)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="Element" direction="input" value="CONST()"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MetricTypeID)" value="PARAM(MetricTypeID)"/>
					<WTSETATTRIBUTE name="ATTR(MetricDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(Qty)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(InputOptions)" value="PARAM(InputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetricType">
				<WTOBJECT name="MetricType" project="ptsMetricTypeUser" class="CMetricType">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Required)" value="ATTR(Required)"/>
					<WTSETATTRIBUTE name="PARAM(IsResult)" value="ATTR(IsResult)"/>
					<WTSETATTRIBUTE name="PARAM(InputOptions)" value="ATTR(InputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetricType" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="AddMetric">
				<WTCALLSUB name="LoadMetricType"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Required)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNote)" value="FORM(Note)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpNote)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10133" message="Oops, Please enter the required information." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="LockedContestDate"/>
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(InputOptions)" value="PARAM(InputOptions)"/>
					<WTSETATTRIBUTES/>
					<WTINPUTOPTIONS name="PARAM(InputOptions)" values="ATTR(InputValues)" secure="0"/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="MetricID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNotify)" value="SYSCON(NOTIFYMENTOR-ACTIVITY)">
							<WTCONDITION expr="PARAM(IsResult)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="CONST(tmpNotify)" value="SYSCON(NOTIFYMENTOR-RESULT)">
							<WTCONDITION expr="PARAM(IsResult)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTHTTP>
							<WTLINK name="0418">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								<WTPARAM name="Notify" value="CONST(tmpNotify)"/>
								<WTPARAM name="ID" value="CONST(MetricID)"/>
							</WTLINK>
						</WTHTTP>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMetric"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="1" name="Load" type="Edit">
				<WTCALLSUB name="LoadMetricType"/>
				<WTCALLSUB name="LoadMetric"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTCALLSUB name="AddMetric"/>
			    <WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="11711" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="Another" type="Add">
				<WTCALLSUB name="AddMetric"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(MetricTypeID)" value="CONST(0)"/>
					<WTCALLSUB name="LoadMetricType"/>
					<WTCALLSUB name="LoadMetric"/>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTLINK name="11711" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(IsResult)"/>
				</WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" label="NewMetric" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="MetricTypeID" />
					<WTCOMBO col="2" value="ATTR(Metric.MetricTypeID)" datapath="/DATA/TXN/PTSMETRICTYPES/ENUM">
						<WTCHANGE>doSubmit(1,&quot;&quot;);</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Metric.MetricTypeID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="ATTR(MetricType.Pts)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" class="prompt">
							<WTSTATIC value="ATTR(MetricType.Description)"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="equal" value="CONST(0)"/>
						<WTHIDDEN value="ATTR(Metric.Qty)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" tag="Qty"/>
						<WTTEXT col="2" value="ATTR(Metric.Qty)" size="2"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="MetricDate"/>
						<WTTEXT col="2" value="ATTR(Metric.MetricDate)"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Metric.InputOptions)" oper="not-equal" value="CONST('')"/>
						<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="0"/>
					</WTCODEGROUP>
					<WTROW margin-top="6">
						<WTCONDITION expr="ATTR(MetricType.Required)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="2" value="ATTR(MetricType.Required)" fontcolor="blue" align="center"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1">
							<WTSTATIC tag="Note">
								<WTCONDITION expr="CONST(not()" value="CONST(/DATA/TXN/PTSMETRICTYPE/@required))"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTMEMO col="2" value="ATTR(Metric.Note)" rows="2" cols="35" />
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(LogActivity)" align="center">
						<WTCONDITION expr="ATTR(Metric.MetricTypeID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(MetricType.Pts)" oper="not-equal" value="CONST(0)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(LogAnother)" align="center">
						<WTCONDITION expr="ATTR(Metric.MetricTypeID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(MetricType.Pts)" oper="not-equal" value="CONST(0)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(Cancel)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="11703" header="false" footer="false" navbar="false"  wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" >
		<!--============================================================================================-->
			<WTPARAM name="MetricID" datatype="number"/>
			<WTPARAM name="MetricTypeID" datatype="number"/>
			<WTPARAM name="Required" datatype="number"/>
			<WTPARAM name="InputOptions" datatype="text"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Goal" datatype="number"/>
			<WTPARAM name="Term" datatype="number"/>

			<WTSUB name="LockedContestDate">
				<WTSETATTRIBUTE name="CONST(tmpDate)" value="FORM(MetricDate)"/>
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Locked">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="StartDate" direction="input" value="CONST(tmpDate)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="ContestID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCUSTOM>
							DoError 0, "Contest", "Activity date not allowed by locked contest: " + .ContestName
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Goal)" value="ATTR(IsGoal)"/>
					<WTSETATTRIBUTE name="PARAM(Term)" value="ATTR(Note)">
						<WTCONDITION expr="PARAM(Goal)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(oldMetricDate)" value="ATTR(MetricDate)"/>
					<WTSETATTRIBUTES/>
					<WTCALLSUB name="LockedContestDate">
						<WTCONDITION expr="PARAM(Goal)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(oldMetricDate)" oper="not-equal" value="ATTR(MetricDate)" connector="and"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="PARAM(MetricTypeID)" value="ATTR(MetricTypeID)"/>
					<WTINPUTOPTIONS name="ATTR(InputOptions)" values="ATTR(InputValues)" secure="0" />
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MetricTypeID)" value="ATTR(MetricTypeID)"/>
					<WTSETATTRIBUTE name="PARAM(Goal)" value="ATTR(IsGoal)"/>
					<WTSETATTRIBUTE name="PARAM(Term)" value="ATTR(Note)">
						<WTCONDITION expr="PARAM(Goal)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetricType">
				<WTOBJECT name="MetricType" project="ptsMetricTypeUser" class="CMetricType">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Required)" value="ATTR(Required)"/>
					<WTSETATTRIBUTE name="PARAM(InputOptions)" value="ATTR(InputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetricType" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMetric"/>
				<WTCALLSUB name="LoadMetricType"/>
			</WTACTION>

			<WTACTION id="1" name="UpdateExit" type="Update">
				<WTCALLSUB name="LoadMetricType"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Required)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNote)" value="FORM(Note)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpNote)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10133" message="Oops, Please enter the required information." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="UpdateMetric"/>
				<WTCALLSUB name="LoadMetricType">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Delete">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Metric.MemberID)"/>
				</WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" label="Metric" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="MetricTypeName"/>
					<WTSTATIC col="2" value="ATTR(Metric.MetricTypeName)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" class="prompt" align="center">
						<WTSTATIC value="ATTR(MetricType.Description)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="equal" value="CONST(0)"/>
					<WTHIDDEN value="ATTR(Metric.Qty)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(MetricType.IsQty)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="Qty"/>
					<WTTEXT col="2" value="ATTR(Metric.Qty)" size="2"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="MetricDate"/>
					<WTTEXT col="2" value="ATTR(Metric.MetricDate)"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Metric.InputOptions)" oper="not-equal" value="CONST('')"/>
					<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="0"/>
				</WTCODEGROUP>

				<WTROW margin-top="6">
					<WTCONDITION expr="ATTR(MetricType.Required)" oper="not-equal" value="CONST('')"/>
          <WTSTATIC col="1" merge="2" value="ATTR(MetricType.Required)" fontcolor="blue" align="center"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC tag="Note">
							<WTCONDITION expr="CONST(not()" value="CONST(/DATA/TXN/PTSMETRICTYPE/@required))"/>
						</WTSTATIC>
					</WTSTATIC>
					<WTMEMO col="2" value="ATTR(Metric.Note)" rows="2" cols="35" />
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="11723" header="false" footer="false" navbar="false"  wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" >
			<!--============================================================================================-->
			<WTPARAM name="MetricID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Term" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(MetricID)" oper="equal" value="CONST(0)"/>
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(IsGoal)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(MetricDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(MetricTypeID)" value="SYSCON(GOAL_PERSONAL_RESULTS)"/>
					<WTSETATTRIBUTE name="ATTR(Note)" value="CONST(2)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMetricID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>
			
			<WTSUB name="UpdateMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Note)" value="PARAM(Term)"/>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMetric">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Term)" value="ATTR(Note)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMetric"/>
			</WTACTION>

			<WTACTION id="1" name="UpdateExit" type="Update">
				<WTCALLSUB name="UpdateMetric"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="Delete">
						<WTPARAM name="MetricID" direction="input" value="PARAM(MetricID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Metric.MetricID)"/>
				</WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" label="Goal" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="Goal"/>
					<WTCOMBO col="2" value="ATTR(Metric.MetricTypeID)">
						<WTOPTION id="-1" label="GoalPersonalResults"/>
						<WTOPTION id="-2" label="GoalPersonalActivities"/>
						<WTOPTION id="-3" label="GoalLeadershipResults"/>
						<WTOPTION id="-4" label="GoalLeadershipActivities"/>
						<WTOPTION id="-5" label="GoalTotalPoints"/>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Points"/>
					<WTTEXT col="2" value="ATTR(Metric.Qty)" size="3"/>
					<WTCOMBO col="2" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Weekly"/>
						<WTOPTION id="2" label="Monthly"/>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="GoalDate"/>
					<WTTEXT col="2" value="ATTR(Metric.MetricDate)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================================-->
		<WTWEBPAGE name="11710" caption="Leader Board" action="5" header="false" footer="false" navbar="false" wrapper="wrapper800"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0" secured="52">
		<!--==================================================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="Scope" datatype="number"/>
			<WTPARAM name="Rpt" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="ContestID" datatype="number"/>
			<WTPARAM name="Private" datatype="number"/>
			<WTPARAM name="NoDates" datatype="number"/>
			<WTPARAM name="EnrollDate" datatype="date"/>
			<WTPARAM name="SearchMember" datatype="text"/>
			<WTPARAM name="OwnerContestID" datatype="number"/>
			<WTPARAM name="ContestName" datatype="text"/>
			<WTPARAM name="Custom1" datatype="number"/>
			<WTPARAM name="Custom2" datatype="number"/>
			<WTPARAM name="Custom3" datatype="number"/>
			<WTPARAM name="Custom4" datatype="number"/>
			<WTPARAM name="Custom5" datatype="number"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(Points)"/>
				<WTSETATTRIBUTE name="PARAM(ContestID)" value="PARAM(OwnerContestID)">
					<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(EnrollDate)" oper="equal" value="CONST(&quot;&quot;)" />
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="CONST(DateValue(.EnrollDate))" />
				</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB name="LoadContests">
				<WTOBJECT name="Contests" project="ptsContestUser" class="CContests">
					<WTMETHOD name="EnumContest">
						<WTPARAM name="xmlContests" direction="return" datatype="text"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						xmlContests = Replace(xmlContests, CHR(34) + " " + CHR(34), CHR(34) + "Show All" + CHR(34))
					</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)" />
				<WTCONDITION expr="CONST(reqActionCode)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Active">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ContestID" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ContestID)" value="CONST(ContestID)">
						<WTCONDITION expr="CONST(ContestID)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(ContestID)" oper="not-equal" value="CONST(0)" />
				<WTOBJECT name="Contest" project="ptsContestUser" class="CContest">
					<WTMETHOD name="Load">
						<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Private)" value="ATTR(IsPrivate)"/>
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(2)">
						<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Rpt)" value="ATTR(Metric)"/>
					<WTSETATTRIBUTE name="PARAM(Custom1)" value="ATTR(Custom1)"/>
					<WTSETATTRIBUTE name="PARAM(Custom2)" value="ATTR(Custom2)"/>
					<WTSETATTRIBUTE name="PARAM(Custom3)" value="ATTR(Custom3)"/>
					<WTSETATTRIBUTE name="PARAM(Custom4)" value="ATTR(Custom4)"/>
					<WTSETATTRIBUTE name="PARAM(Custom5)" value="ATTR(Custom5)"/>
					<WTSETATTRIBUTE name="PARAM(ContestName)" value="ATTR(ContestName)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(StartDate)" oper="not-equal" value="CONST(&quot;0&quot;)"/>
						<WTSETATTRIBUTE name="PARAM(FromDate)" value="ATTR(StartDate)"/>
						<WTSETATTRIBUTE name="PARAM(ToDate)" value="ATTR(EndDate)"/>
						<WTSETATTRIBUTE name="PARAM(NoDates)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(0)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(StartDate)" oper="equal" value="CONST(&quot;0&quot;)"/>
						<WTSETATTRIBUTE name="PARAM(NoDates)" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Term)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
							<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)" />
				<WTCONDITION expr="PARAM(Term)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID" datatype="number">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)" />
				</WTGETCACHE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Scope)" value="CONST(2)">
						<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Rpt)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(SearchMember)" value="CONST(&quot;&quot;)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(reqPos - 20)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(reqPos + 20)"/>
			</WTACTION>

			<WTACTION id="8" name="SearchMember" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Pos)" value="CONST(0)"/>
			</WTACTION>

			<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Rpt)" oper="not-equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="LeaderCompany">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderGroup">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderMentor">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="LeaderPrivate">
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="not-equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="MemberCompany">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberGroup">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberMentor">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="MemberPrivate">
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="LeaderCompanyCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderGroupCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="LeaderMentorCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="LeaderPrivateCustom">
								<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
								<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
								<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
								<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
								<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(SearchMember)" oper="not-equal" value="CONST(&quot;&quot;)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTMETHOD name="MemberCompanyCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberGroupCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
							<WTMETHOD name="MemberMentorCustom">
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="MemberPrivateCustom">
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="MemberName" direction="input" value="PARAM(SearchMember)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<WTCODEGROUP post="true">
				<WTCALLSUB name="LoadContests"/>
			</WTCODEGROUP>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTFUNCTION name="Export()">
					var url, win;
					var companyid = document.getElementById('CompanyID').value;
					var groupid = document.getElementById('GroupID').value;
					var memberid = document.getElementById('MemberID').value;
					var contestid = document.getElementById('ContestID').value;
					var fromdate = document.getElementById('FromDate').value;
					var todate = document.getElementById('ToDate').value;
					var scope = document.getElementById('Scope').value;
					var rpt = document.getElementById('Rpt').value;
					var custom1 = document.getElementById('Custom1').value;
					var custom2 = document.getElementById('Custom2').value;
					var custom3 = document.getElementById('Custom3').value;
					var custom4 = document.getElementById('Custom4').value;
					var custom5 = document.getElementById('Custom5').value;
					url = "11770.asp?companyid=" + companyid + "&amp;groupid=" + groupid + "&amp;memberid=" + memberid + "&amp;contestid=" + contestid;
					url = url + "&amp;fromdate=" + fromdate + "&amp;todate=" + todate + "&amp;scope=" + scope + "&amp;rpt=" + rpt;
					url = url + "&amp;custom1=" + custom1 + "&amp;custom2=" + custom2 + "&amp;custom3=" + custom3 + "&amp;custom4=" + custom4 + "&amp;custom5=" + custom5;
					win = window.open(url,"Export");
					win.focus();
				</WTFUNCTION>
				
				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(GroupID)"/>
					<WTHIDDEN value="PARAM(Pos)"/>
					<WTHIDDEN value="PARAM(EnrollDate)" />
					<WTHIDDEN value="PARAM(Private)" />
					<WTHIDDEN value="PARAM(Custom1)" />
					<WTHIDDEN value="PARAM(Custom2)" />
					<WTHIDDEN value="PARAM(Custom3)" />
					<WTHIDDEN value="PARAM(Custom4)" />
					<WTHIDDEN value="PARAM(Custom5)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(ContestID)" oper="not-equal" value="CONST(0)"/>
					<WTHIDDEN value="PARAM(Scope)"/>
					<WTHIDDEN value="PARAM(Rpt)"/>
				</WTROW>

        <WTROW margin-top="6" margin-bottom="12">
          <WTSTATIC col="1" align="center">
						<WTSTATIC label="LeaderBoard" fontcolor="#000070" fontsize="3" bold="true"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ContestID)" oper="equal" value="CONST(0)"/>
							<WTSTATIC space="2"/>
							<WTCOMBO name="Scope" value="PARAM(Scope)">
								<WTOPTION id="1" label="CompanyID"/>
								<WTOPTION id="2" label="GroupID">
									<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
								</WTOPTION>
								<WTOPTION id="3" label="Mentor">
									<WTCONDITION expr="SYS(MemberID)" oper="not-equal" value="CONST(0)"/>
								</WTOPTION>
							</WTCOMBO>
							<WTSTATIC space="1"/>
							<WTCOMBO name="Rpt" value="PARAM(Rpt)">
								<WTOPTION id="1" label="Results"/>
								<WTOPTION id="2" label="Activities"/>
								<WTOPTION id="3" label="All"/>
							</WTCOMBO>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCONTESTS/ENUM))" oper="greater" value="CONST(1)"/>
							<WTCONDITION expr="PARAM(OwnerContestID)" oper="not-equal" value="CONST(0)" connector="or"/>
							<WTSTATIC space="2"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(OwnerContestID)" oper="equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(contest.gif)" imgalign="absmiddle"/>
								<WTCOMBO value="PARAM(ContestID)" datapath="/DATA/TXN/PTSCONTESTS/ENUM" setselected="true">
									<WTCHANGE>doSubmit(5,"")</WTCHANGE>
								</WTCOMBO>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(OwnerContestID)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(contest.gif)" imgalign="absmiddle"/>
								<WTSTATIC value="PARAM(ContestName)" bold="true"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(NoDates)" oper="not-equal" value="CONST(0)"/>
								<WTSTATIC space="2"/>
								<WTSTATIC label="from" value="PARAM(FromDate)" align="center" bold="true" space="2"/>
								<WTSTATIC label="to" value="PARAM(ToDate)" bold="true"/>
							</WTCODEGROUP>
							
							<WTCODEGROUP>
								<WTCONDITION expr="_IsGrpMembers"/>
								<WTCONDITION expr="PARAM(OwnerContestID)" oper="not-equal" value="CONST(0)" connector="or"/>
								<WTSTATIC space="2"/>
								<WTIMAGE value="CONST(export.gif)" imgalign="absmiddle">
									<WTLINK name="Export()" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(NoDates)" oper="not-equal" value="CONST(0)"/>
					<WTHIDDEN value="PARAM(Term)"/>
					<WTHIDDEN value="PARAM(FromDate)"/>
					<WTHIDDEN value="PARAM(ToDate)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(NoDates)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="LeadersFor" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Membership" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="Yesterday" />
						<WTOPTION id="9" label="Prev7" />
						<WTOPTION id="10" label="Prev30" />
						<WTOPTION id="4" label="ThisWeek" />
						<WTOPTION id="5" label="ThisMonth" />
						<WTOPTION id="6" label="ThisYear" />
						<WTOPTION id="7" label="LastWeek" />
						<WTOPTION id="8" label="LastMonth" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							term = document.getElementById('Term').value;
							switch(term) {
							case "1":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "2":
							break;
							case "3":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "4":
							var d = fromdate.getDay()
							if( d == 0 ) { d = 7 }
							fromdate.setTime(fromdate.getTime() - ( (d-1) * ONE_DAY ) );
							break;
							case "5":
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							var d = todate.getDay()
							if( d == 0 ) { d = 7 }
							todate.setTime(todate.getTime() - ( d * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "8":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setTime(fromdate.getTime() - ( 6 * ONE_DAY) );
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() - ( 30 * ONE_DAY) );
							break;
							}
							if(term!=1){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" label="from"/>
					<WTTEXT col="1" value="PARAM(FromDate)" size="8" focus="true"/>
					<WTSTATIC col="1" label="to"/>
					<WTTEXT col="1" value="PARAM(ToDate)" size="8" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(View)" default="true"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Metric">
						<WTCOLUMN width="20" align="center" valign="top" label="#" />
						<WTCOLUMN width="60" align="left" valign="top" label="MemberName" />
						<WTCOLUMN width="15" align="center" valign="top" label="Points" />
						<WTCOLUMN width="5" align="center" valign="top" />
						<WTROW height="30">
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()+/DATA/PARAM/@pos&quot;/&gt;)"/>
							<WTSTATIC col="2" value="DATA(Metric.MemberName)"/>
							<WTSTATIC col="3" value="DATA(Metric.Points)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview24.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="11714">
											<WTPARAM name="MemberID" value="DATA(MetricID)"/>
											<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
											<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
											<WTPARAM name="Rpt" value="PARAM(Rpt)"/>
											<WTPARAM name="OwnerContestID" value="PARAM(OwnerContestID)"/>
											<WTPARAM name="Custom1" value="PARAM(Custom1)"/>
											<WTPARAM name="Custom2" value="PARAM(Custom2)"/>
											<WTPARAM name="Custom3" value="PARAM(Custom3)"/>
											<WTPARAM name="Custom4" value="PARAM(Custom4)"/>
											<WTPARAM name="Custom5" value="PARAM(Custom5)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchMember" align="center"/>
					<WTTEXT col="1" value="PARAM(SearchMember)" size="10" prespace="false"/>
					<WTBUTTON col="1" action="8" value="CONST(Search)"/>
					<WTBUTTON col="1" action="5" value="CONST(All)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="11711" caption="Member Metrics" header="false" footer="false" navbar="false" wrapper="wrapper800"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="EnrollDate" datatype="date"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(EnrollDate)" oper="equal" value="CONST(&quot;&quot;)" />
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="CONST(DateValue(.EnrollDate))" />
				</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB name="ViewMetrics">
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="ListMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="View" type="View" id="1">
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="Add" type="Add" id="2">
				<WTRETURN>
					<WTLINK name="11702" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>
				<WTCOLUMN width="400" align="right"/>

				<WTROW>
					<WTHIDDEN value="PARAM(EnrollDate)" />
				</WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" class="PageHeading" align="left">
						<WTSTATIC label="Metrics" space="2" fontsize="4"/>
						<WTCODEGROUP><WTBUTTON action="2" value="CONST(NewMetric)" btnclass="bigbutton"/></WTCODEGROUP>
					</WTSTATIC>
					<WTSTATIC col="2" class="PageHeader" align="right">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(stats.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Stats" bold="true">
								<WTLINK name="11712">
									<WTPARAM name="MemberID" value="PARAM(MemberID)" />
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="MetricsFor" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Membership" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="Yesterday" />
						<WTOPTION id="9" label="Prev7" />
						<WTOPTION id="10" label="Prev30" />
						<WTOPTION id="4" label="ThisWeek" />
						<WTOPTION id="5" label="ThisMonth" />
						<WTOPTION id="6" label="ThisYear" />
						<WTOPTION id="7" label="LastWeek" />
						<WTOPTION id="8" label="LastMonth" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							term = document.getElementById('Term').value;
							switch(term) {
							case "1":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "2":
							break;
							case "3":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "4":
							var d = fromdate.getDay()
							if( d == 0 ) { d = 7 }
							fromdate.setTime(fromdate.getTime() - ( (d-1) * ONE_DAY ) );
							break;
							case "5":
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							var d = todate.getDay()
							if( d == 0 ) { d = 7 }
							todate.setTime(todate.getTime() - ( d * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "8":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setTime(fromdate.getTime() - ( 6 * ONE_DAY) );
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() - ( 30 * ONE_DAY) );
							break;
							}
							if(term!=1){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" label="from"/>
					<WTTEXT col="1" value="PARAM(FromDate)" size="8" focus="true"/>
					<WTSTATIC col="1" label="to"/>
					<WTTEXT col="1" value="PARAM(ToDate)" size="8" focus="true"/>
					<WTBUTTON col="1" action="1" value="CONST(View)" default="true"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Metric">
						<WTCOLUMN width="10" align="left" valign="top" label="MetricDate"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Qty"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Points"/>
						<WTCOLUMN width="70" align="left" valign="top" label="MetricTypeName"/>
						<WTROW height="30">
							<WTSTATIC col="1" value="DATA(MetricDate)"/>
							<WTSTATIC col="2" value="DATA(Qty)"/>
							<WTSTATIC col="3" value="DATA(Points)"/>
							<WTSTATIC col="4">
								<WTSTATIC value="DATA(MetricTypeName)"/>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="11703">
											<WTPARAM name="MetricID" value="DATA(MetricID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Note)" oper="not-equal" value="CONST('')"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Note)" fontcolor="gray"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="11721" caption="Activity Goals" header="false" footer="false" navbar="false" wrapper="wrapper800"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="ViewMetrics">
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="ListGoal">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="Add" type="Add" id="2">
				<WTRETURN>
					<WTLINK name="11723" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>
				<WTCOLUMN width="400" align="right"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" class="PageHeading" align="left">
						<WTSTATIC label="ActivityGoals" space="2"/>
					</WTSTATIC>
					<WTSTATIC col="2" class="PageHeader">
						<WTCODEGROUP>
							<WTBUTTON action="2" value="CONST(NewGoal)" btnclass="smbutton" align="right"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

        <WTROW margin-bottom="6">
          <WTRECORDSET col="1" merge="2" graybar="true" entity="Metric">
						<WTCOLUMN width="15" align="left" valign="top" label="Start"/>
						<WTCOLUMN width="10" align="center" valign="top" label="Points"/>
						<WTCOLUMN width="15" align="center" valign="top" label="When"/>
						<WTCOLUMN width="60" align="left" valign="top" label="Goal"/>
						<WTROW height="30">
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(MetricDate)" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="11723">
											<WTPARAM name="MetricID" value="DATA(MetricID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Qty)"/>
							<WTSTATIC col="3">
								<WTSTATIC label="Weekly">
									<WTCONDITION expr="DATA(Note)" oper="equal" value="CONST('1')"/>
								</WTSTATIC>
								<WTSTATIC label="Monthly">
									<WTCONDITION expr="DATA(Note)" oper="equal" value="CONST('2')"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="4">
								<WTSTATIC label="GoalPersonalResults">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_PERSONAL_RESULTS)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalPersonalActivities">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_PERSONAL_ACTIVITIES)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalLeadershipResults">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_LEADERSHIP_RESULTS)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalLeadershipActivities">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_LEADERSHIP_ACTIVITIES)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalTotalPoints">
									<WTCONDITION expr="DATA(MetricTypeID)" oper="equal" value="SYSCON(GOAL_TOTAL_POINTS)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="11712" caption="Activity Statistics" header="false" footer="false" navbar="false"  wrapper="wrapper800"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Total" datatype="number"/>
			<WTPARAM name="Days" datatype="number"/>
			<WTPARAM name="Days30" datatype="number"/>
			<WTPARAM name="Track" datatype="number"/>
			<WTPARAM name="Theme" datatype="number"/>
			<WTPARAM name="Rank" datatype="number"/>
			<WTPARAM name="EnrollDate" datatype="date"/>

			<WTPARAM name="FromPts1" datatype="number"/>
			<WTPARAM name="FromPts2" datatype="number"/>
			<WTPARAM name="FromPts3" datatype="number"/>
			<WTPARAM name="FromPts4" datatype="number"/>
			<WTPARAM name="FromPts5" datatype="number"/>
			<WTPARAM name="ToPts1" datatype="number"/>
			<WTPARAM name="ToPts2" datatype="number"/>
			<WTPARAM name="ToPts3" datatype="number"/>
			<WTPARAM name="ToPts4" datatype="number"/>

			<WTINCLUDE name="Resources.asp"/>
			<WTINCLUDE name="Share.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="CONST(DateValue(.EnrollDate))" />
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)" />
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ViewMetrics">
				<!-- If we found an activity group, we also get the Activity Tracks -->
				<WTCALLSUB name="reqGroupID = GetSharedActivities( reqGroupID, tmpTracks, reqTheme )">
					<WTCONDITION expr="CONST(reqGroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>
				<!-- If we didn't find a shared activity group, get the company Activity Tracks -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="CONST(reqGroupID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTracks)" value="ATTR(UploadURL)"/>
				</WTOBJECT>
				
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTMETHOD name="MemberTotal">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Rank)" value="ATTR(MetricTypeID)"/>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="MemberSummary">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
<WTCUSTOM>
	Default = "10,100,250,500"
	If tmpTracks = "" Then tmpTracks = Default
	pts = Split(tmpTracks, ",")
	If UBOUND(pts) &lt; 3 Then
		tmpTracks = Default
		pts = Split(tmpTracks, ",")
	End If

	reqFromPts1 = 1
	reqToPts1 =   pts(0)
	reqFromPts2 = pts(0) + 1
	reqToPts2 =   pts(1)
	reqFromPts3 = pts(1) + 1
	reqToPts3 =   pts(2)
	reqFromPts4 = pts(2) + 1
	reqToPts4 =   pts(3)
	reqFromPts5 = pts(3) + 1

	reqTotal = 0
	For Each oItem in oMetrics
	reqTotal = reqTotal + oItem.Points
	Next
	reqDays = DateDiff( &quot;d&quot;, reqFromDate, reqToDate ) + 1
			If reqDays &gt; 0 Then
				avg = ROUND( reqTotal / reqDays, 1)
				reqDays30 = avg * 30
				If reqDays30 &lt;= reqToPts1 Then reqTrack = 1
				If reqDays30 &gt;= reqFromPts2 And reqDays30 &lt;= reqToPts2 Then reqTrack = 2
				If reqDays30 &gt;= reqFromPts3 And reqDays30 &lt;= reqToPts3 Then reqTrack = 3
				If reqDays30 &gt;= reqFromPts4 And reqDays30 &lt;= reqToPts4 Then reqTrack = 4
				If reqDays30 &gt;= reqFromPts5 Then reqTrack = 5
			End If
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="LoadMember"/>
				<!-- Start with membership -->
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)" />
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION name="View" type="View" id="1">
				<WTCALLSUB name="LoadMember"/>
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN>
					<WTLINK name="11711" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(EnrollDate)" />
				</WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="MemberSummary" class="PageHeading" align="left"/>
				</WTROW>

        <WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="MetricsFor" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" name="Term" value="PARAM(Term)">
						<WTOPTION id="1" label="Membership" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="Yesterday" />
						<WTOPTION id="9" label="Prev7" />
						<WTOPTION id="10" label="Prev30" />
						<WTOPTION id="4" label="ThisWeek" />
						<WTOPTION id="5" label="ThisMonth" />
						<WTOPTION id="6" label="ThisYear" />
						<WTOPTION id="7" label="LastWeek" />
						<WTOPTION id="8" label="LastMonth" />
						<WTOPTION id="11" label="Prev60" />
						<WTOPTION id="12" label="Prev90" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							term = document.getElementById('Term').value;
							switch(term) {
							case "1":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "2":
							break;
							case "3":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "4":
							var d = fromdate.getDay()
							if( d == 0 ) { d = 7 }
							fromdate.setTime(fromdate.getTime() - ( (d-1) * ONE_DAY ) );
							break;
							case "5":
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							var d = todate.getDay()
							if( d == 0 ) { d = 7 }
							todate.setTime(todate.getTime() - ( d * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "8":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setTime(fromdate.getTime() - ( 6 * ONE_DAY) );
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() - ( 30 * ONE_DAY) );
							break;
							case "11":
							fromdate.setTime(fromdate.getTime() - ( 60 * ONE_DAY) );
							break;
							case "12":
							fromdate.setTime(fromdate.getTime() - ( 90 * ONE_DAY) );
							break;
							}
							if(term!=1){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" label="from"/>
					<WTTEXT col="1" value="PARAM(FromDate)" size="8" focus="true"/>
					<WTSTATIC col="1" label="to"/>
					<WTTEXT col="1" value="PARAM(ToDate)" size="8" focus="true"/>
					<WTBUTTON col="1" action="1" value="CONST(View)" default="true"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTTABLE col="1">
						<WTCOLUMN width="250" align="center"/>
						<WTCOLUMN width="300" align="center"/>
						<WTCOLUMN width="250" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTABLE col="2" valign="top" padding="0" style="border: 1px #7589a6 solid">
								<WTCOLUMN width="300" align="center"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#7589a6">
										<WTSTATIC label="CurrentTrack" fontcolor="white" bold="true"/>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" align="center" fontsize="3" fontcolor="purple" backcolor="white">
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(0)"/>
											<WTSTATIC label="Track1">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(1)"/>
											</WTSTATIC>
											<WTSTATIC label="Track2">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(2)"/>
											</WTSTATIC>
											<WTSTATIC label="Track3">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(3)"/>
											</WTSTATIC>
											<WTSTATIC label="Track4">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(4)"/>
											</WTSTATIC>
											<WTSTATIC label="Track5">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(5)"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(1)"/>
											<WTSTATIC label="Track1a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(1)"/>
											</WTSTATIC>
											<WTSTATIC label="Track2a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(2)"/>
											</WTSTATIC>
											<WTSTATIC label="Track3a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(3)"/>
											</WTSTATIC>
											<WTSTATIC label="Track4a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(4)"/>
											</WTSTATIC>
											<WTSTATIC label="Track5a">
												<WTCONDITION expr="PARAM(Track)" oper="equal" value="CONST(5)"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTSTATIC space="3"/>
										<WTSTATIC label="Ranking"/>
										<WTSTATIC value="PARAM(Rank)"/>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
							<WTSTATIC col="3"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Metric">
						<WTCOLUMN width="15" align="center" valign="top" label="Qty"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Points"/>
						<WTCOLUMN width="70" align="left" valign="top" label="MetricTypeName"/>
						<WTROW height="30">
							<WTSTATIC col="1" value="DATA(Qty)"/>
							<WTSTATIC col="2" value="DATA(Points)"/>
							<WTSTATIC col="3">
								<WTSTATIC value="DATA(MetricTypeName)"/>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview24.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="11713">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="MetricTypeID" value="DATA(MetricTypeID)"/>
											<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
											<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTTABLE col="1">
						<WTCOLUMN width="90" align="right"/>
						<WTCOLUMN width="90" align="center"/>
						<WTCOLUMN width="420" align="left"/>
						<WTROW>
							<WTSTATIC col="1" tag="TotalPoints" bold="true"/>
							<WTSTATIC col="2" value="PARAM(Total)" bold="true"/>
							<WTSTATIC col="3" bold="true">
								<WTSTATIC label="in" space="1"/>
								<WTSTATIC value="PARAM(Days)" space="1"/>
								<WTSTATIC label="days" space="1"/>
								<WTSTATIC label="ontrack" space="1"/>
								<WTSTATIC value="PARAM(Days30)" space="1"/>
								<WTSTATIC label="in30Days"/>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(LoggedActivities)" align="center"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTTABLE col="1">
						<WTCOLUMN width="295" align="center"/>
						<WTCOLUMN width="210" align="center"/>
						<WTCOLUMN width="295" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTABLE col="2" valign="top" padding="0" style="border: 1px #7589a6 solid">
								<WTCOLUMN width="90" align="center"/>
								<WTCOLUMN width="120" align="left"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#7589a6">
										<WTSTATIC label="MonthlyTracks" fontcolor="white" bold="true"/>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" align="center" fontcolor="004080" backcolor="#ffffff">
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts1,'-',/DATA/PARAM/@topts1,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts2,'-',/DATA/PARAM/@topts2,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts3,'-',/DATA/PARAM/@topts3,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts4,'-',/DATA/PARAM/@topts4,' pts.')&quot;/&gt;)" newline="1"/>
										<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@frompts5,'+ pts.')&quot;/&gt;)"/>
									</WTSTATIC>
									<WTSTATIC col="2" align="left" fontcolor="004080" backcolor="#ffffff">
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(0)"/>
											<WTSTATIC label="Track1" newline="1"/>
											<WTSTATIC label="Track2" newline="1"/>
											<WTSTATIC label="Track3" newline="1"/>
											<WTSTATIC label="Track4" newline="1"/>
											<WTSTATIC label="Track5"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Theme)" oper="equal" value="CONST(1)"/>
											<WTSTATIC label="Track1a" newline="1"/>
											<WTSTATIC label="Track2a" newline="1"/>
											<WTSTATIC label="Track3a" newline="1"/>
											<WTSTATIC label="Track4a" newline="1"/>
											<WTSTATIC label="Track5a"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
							<WTSTATIC col="3"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="11713" caption="Member Metrics" header="false" footer="false" navbar="false" wrapper="wrapper800"
			   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MetricTypeID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Qty" datatype="number"/>
			<WTPARAM name="Points" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID" datatype="number"/>
				<WTOBJECT name="MetricType" project="ptsMetricTypeUser" class="CMetricType">
					<WTMETHOD name="Load">
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetricType" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="MemberDetail">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="MetricTypeID" direction="input" value="PARAM(MetricTypeID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
<WTCUSTOM>
	reqQty = 0
	reqPoints = 0
	For Each oItem in oMetrics
	With oItem
		reqQty = reqQty + .Qty
		reqPoints = reqPoints + .Points
	End With
	Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="MemberDetail" value="ATTR(MetricType.MetricTypeName)" class="PageHeading" align="left"/>
				</WTROW>

        <WTROW margin-bottom="6">
					<WTSTATIC col="1" class="PageHeading" align="center">
						<WTSTATIC value="PARAM(FromDate)" space="1"/>
						<WTSTATIC label="to" space="1"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Metric">
						<WTCOLUMN width="15" align="left" valign="top" label="MetricDate"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Qty"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Points"/>
						<WTCOLUMN width="55" align="left" valign="top"/>
						<WTROW height="30">
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(MetricDate)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="SYS(MemberID)" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="11703">
											<WTPARAM name="MetricID" value="DATA(MetricID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Qty)"/>
							<WTSTATIC col="3" value="DATA(Points)"/>
							<WTSTATIC col="4" value="DATA(Note)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTTABLE col="1">
						<WTCOLUMN width="180" align="right"/>
						<WTCOLUMN width="90" align="center"/>
						<WTCOLUMN width="330" align="left"/>
						<WTROW>
							<WTSTATIC col="1" tag="TotalPoints" bold="true"/>
							<WTSTATIC col="2" value="PARAM(Points)" bold="true"/>
							<WTSTATIC col="3"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="11714" caption="Member Metrics" header="false" footer="false" navbar="false" wrapper="wrapper800"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Rpt" datatype="number"/>
			<WTPARAM name="Qty" datatype="number"/>
			<WTPARAM name="Points" datatype="number"/>
			<WTPARAM name="Days" datatype="number"/>
			<WTPARAM name="Days30" datatype="number"/>
			<WTPARAM name="Name" datatype="text"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="OwnerContestID" datatype="number"/>
			<WTPARAM name="Custom1" datatype="number"/>
			<WTPARAM name="Custom2" datatype="number"/>
			<WTPARAM name="Custom3" datatype="number"/>
			<WTPARAM name="Custom4" datatype="number"/>
			<WTPARAM name="Custom5" datatype="number"/>

			<WTSUB name="ViewMetrics">
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID" datatype="number"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Name)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="LeaderSummary">
						<WTCONDITION expr="PARAM(Rpt)" oper="not-equal" value="CONST(0)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
					</WTMETHOD>
					<WTMETHOD name="LeaderSummaryCustom">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
						<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
						<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
						<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
						<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
					</WTMETHOD>
					<WTCUSTOM>
						reqQty = 0
						reqPoints = 0
						For Each oItem in oMetrics
						With oItem
							reqQty = reqQty + .Qty
							reqPoints = reqPoints + .Points
						End With
						Next
						reqDays = DateDiff( &quot;d&quot;, reqFromDate, reqToDate ) + 1
						If reqDays &gt; 0 Then
						avg = ROUND( reqPoints / reqDays, 1)
						reqDays30 = avg * 30
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="ViewMetrics"/>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="LeaderSummary" value="PARAM(Name)" class="PageHeading" align="left"/>
				</WTROW>

        <WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" class="ColumnHeader" align="center">
						<WTSTATIC label="View" space="1"/>
						<WTSTATIC label="Custom">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="Results">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="Activities">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="ResultsActivities">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC space="1"/>
						<WTSTATIC label="from" space="1"/>
						<WTSTATIC value="PARAM(FromDate)" space="1"/>
						<WTSTATIC label="to" space="1"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Metric">
						<WTCOLUMN width="15" align="center" valign="top" label="Qty"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Points"/>
						<WTCOLUMN width="55" align="left" valign="top" label="MetricTypeName"/>
						<WTCOLUMN width="15" align="left" valign="top"/>
						<WTROW height="30">
							<WTSTATIC col="1" value="DATA(Qty)"/>
							<WTSTATIC col="2" value="DATA(Points)"/>
							<WTSTATIC col="3" value="DATA(MetricTypeName)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="SYS(MemberID)" connector="or"/>
									<WTCONDITION expr="PARAM(OwnerContestID)" oper="not-equal" value="CONST(0)" connector="or"/>
									<WTIMAGE value="CONST(Preview24.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="11713">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="MetricTypeID" value="DATA(MetricTypeID)"/>
											<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
											<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTTABLE col="1">
						<WTCOLUMN width="90" align="center"/>
						<WTCOLUMN width="90" align="center"/>
						<WTCOLUMN width="420" align="left"/>
						<WTROW>
							<WTSTATIC col="1" value="PARAM(Qty)" bold="true"/>
							<WTSTATIC col="2" value="PARAM(Points)" bold="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="11760" caption="Activity Reports" form="Report" navbar="false" header="false" footer="false" wrapper="wrapper750b"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="11760" track="0">
			<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="ChartSource" datatype="text"/>
			<WTPARAM name="Unit" datatype="text"/>
			<WTPARAM name="Tracks" datatype="text"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="EnrollDate" datatype="date"/>
			<WTPARAM name="Total1" datatype="text"/>
			<WTPARAM name="Total2" datatype="text"/>
			<WTPARAM name="Total3" datatype="text"/>
			<WTPARAM name="Track1" datatype="number"/>
			<WTPARAM name="Track2" datatype="number"/>
			<WTPARAM name="Track3" datatype="number"/>
			<WTPARAM name="Track4" datatype="number"/>
			<WTPARAM name="Theme" datatype="number"/>
			<WTPARAM name="Test" datatype="number"/>
			<WTPARAM name="Mobile" datatype="number"/>
			<WTPARAM name="Goal" datatype="text"/>

			<WTINCLUDE name="ChartURL.asp"/>
			<WTINCLUDE name="Resources.asp"/>
			<WTINCLUDE name="Share.asp"/>

			<!-- REPORTS ***********************************-->
			<!-- 20 Track Meter -->
			<!-- 1 Activity Summary -->
			<!-- 2 Personal Summary -->
			<!-- 3 Leadership Summary -->
			<!-- 4 Personal Progress -->
			<!-- 5 Leadership Progress -->
			<!-- 10 System Tracks -->
			<!-- 11 System Activity Summary -->
			<!-- 12 System Personal Summary -->
			<!-- 13 System Leadership Summary -->
			<!-- 14 System Personal Progress -->
			<!-- 15 System Leadership Progress -->
			<!-- 30 Team Tracks -->
			<!-- 31 Team Activity Summary -->
			<!-- 32 Team Personal Summary -->
			<!-- 33 Team Leadership Summary -->
			<!-- 34 Team Personal Progress -->
			<!-- 35 Team Leadership Progress -->
			<!-- 41 Goal Personal Results -->
			<!-- 42 Goal Personal Activities -->
			<!-- 43 Goal Leadership Results -->
			<!-- 44 Goal Leadership Activities -->
			<!-- 45 Goal Total Points -->
			<!-- *******************************************-->

			<!-- Get Goal Report Options -->
			<WTCODEGROUP>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTMETHOD name="ListGoal">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						reqGoal = ""
						For Each oItem in oMetrics
							With oItem
								Select Case .MetricTypeID
									Case "-1": reqGoal = reqGoal + "41,"
									Case "-2": reqGoal = reqGoal + "42,"
									Case "-3": reqGoal = reqGoal + "43,"
									Case "-4": reqGoal = reqGoal + "44,"
									Case "-5": reqGoal = reqGoal + "45,"
								End Select
							End With
						Next
					</WTCUSTOM>
				</WTOBJECT>
			</WTCODEGROUP>
			
			<WTSUB function="FillDataLabels( byVal bvFromDate, byVal bvToDate, byVal bvUnit, byRef brLabels, byRef brData, byRef brLabels2, byRef brData2 )">
				<WTCUSTOM>
					tmpLabels = ""
					tmpData = ""
					tmpData2 = ""
					tmpPart = "d"

					'Build Master Label List ******************
					Select Case bvUnit
					Case "day": tmpPart = "d"
					Case "week": tmpPart = "ww"
					Case "month": tmpPart = "m"
					Case "quarter": tmpPart = "q"
					End Select

					total = DateDiff( tmpPart, bvFromDate, bvToDate )

					While total &gt;= 0
						tmpLabels = tmpLabels + CStr( DatePart( tmpPart, bvFromDate ) ) + "|"
						bvFromDate = DateAdd( tmpPart, 1, bvFromDate )
						total = total - 1
					Wend
					If tmpLabels &lt;&gt; "" Then tmpLabels = Left(tmpLabels, Len(tmpLabels)-1 )

					'Update Data Lists ******************
					aMasterLabels = Split(tmpLabels, "|")
					aLabels = Split(brLabels, "|")
					aLabels2 = Split(brLabels2, "|")
					aData = Split(brData, "|")
					aData2 = Split(brData2, "|")

					tmpData = ""
					tmpData2 = ""
					For x = 0 to UBound(aMasterLabels)
						label = aMasterLabels(x)
						val = 0
						For y = 0 to UBound(aLabels)
							If label = aLabels(y) Then
								val = aData(y)
								Exit For
							End If
						Next
						tmpData = tmpData + CStr(val) + "|"
						val = 0
						For y = 0 to UBound(aLabels2)
							If label = aLabels2(y) Then
								val = aData2(y)
								Exit For
							End If
						Next
						tmpData2 = tmpData2 + CStr(val) + "|"
					Next
					If tmpData &lt;&gt; "" Then tmpData = Left(tmpData, Len(tmpData)-1 )
					If tmpData2 &lt;&gt; "" Then tmpData2 = Left(tmpData2, Len(tmpData2)-1 )

					brLabels = tmpLabels
					brData = tmpData
					brData2 = tmpData2
				</WTCUSTOM>
			</WTSUB>

			<WTSUB function="FillGoalData(byRef brData )">
				<WTCUSTOM>
					tmpData = ""
					aData = Split(brData, "|")
					Points = 0
					total = UBOUND(aData)
					For x = 0 to total
						pts = CInt(aData(x))
						If pts = 0 Then pts = Points Else Points = pts
						tmpData = tmpData + CStr(pts)
						If x &lt; total Then tmpData = tmpData + "|"
					Next
					brData = tmpData
				</WTCUSTOM>
			</WTSUB>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="CONST(DateValue(.EnrollDate))" />
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadReport">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(10)" />
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(20)" connector="or"/>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(30)" connector="or"/>
					<WTCALLSUB name="GetResources reqGroupID">
						<WTCONDITION expr="NotMemberOnly" />
					</WTCALLSUB>
					<WTCALLSUB name="tmpGroupID = GetSharedActivities( reqGroupID, tmpTracks, reqTheme )">
						<WTCONDITION expr="CONST(reqGroupID)" oper="not-equal" value="CONST(0)"/>
					</WTCALLSUB>
					<!-- If we didn't find a shared activity group, get the company Activity Tracks -->
					<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
						<WTCONDITION expr="CONST(reqGroupID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="FetchCompany">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						</WTMETHOD>
						<WTMETHOD name="Load">
							<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpTracks)" value="ATTR(UploadURL)"/>
					</WTOBJECT>
					<WTSETATTRIBUTE name="CONST(tmpTracks)" value="CONST(&quot;10,100,250,500&quot;)">
						<WTCONDITION expr="CONST(tmpTracks)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Unit)" value="CONST(tmpTracks)"/>
				</WTCODEGROUP>
				<WTCUSTOM>
					'validate all parameters
					If reqReport &lt; 1 OR reqReport &gt; 45 Then reqReport = 20
					If reqReport &lt;&gt; 10 And reqReport &lt;&gt; 30 Then
						If IsDate(reqFromDate) AND IsDate(reqToDate) Then
							tmpDays = DateDiff("d", reqFromDate, reqToDate )
							If tmpDays &lt;= 31 Then reqUnit = "day"
							If tmpDays &gt; 31 AND tmpDays &lt;= 180 Then reqUnit = "week"
							If tmpDays &gt; 180 AND tmpDays &lt;= 365 Then reqUnit = "month"
							If tmpDays &gt; 365 Then reqUnit = "quarter"
						Else
							reqFromDate = CDate( DateAdd("d", -1, Date()) )
							reqToDate = CDate( Date() )
							reqUnit = "day"
						End If
					End If

					If reqReport = 10 Or reqReport = 30 Then
						If reqUnit = "" Then reqUnit = "10,100,250,500"
						a = Split(reqUnit,",")
						If ubound(a) = 3 Then
							reqTrack1 = a(0)
							reqTrack2 = a(1)
							reqTrack3 = a(2)
							reqTrack4 = a(3)
						End If
					End If
				</WTCUSTOM>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTCONDITION expr="PARAM(Report)" oper="not-equal" value="CONST(20)"/>
					<WTMETHOD name="Report">
						<WTPARAM name="Rpt" direction="input" value="PARAM(Report)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Unit" direction="input" value="PARAM(Unit)"/>
					</WTMETHOD>
					<WTCUSTOM>
						If reqTest &gt; 0 Then response.write "&lt;BR&gt;" + CStr(reqReport) + " - " + CStr(reqMemberID) + " - " + CStr(reqFromDate) + " - " + CStr(reqToDate) + " - " + CStr(reqUnit)
						tmpData = ""
						tmpLabels = ""
						tmpData2 = ""
						tmpLabels2 = ""
						reqCount = 0
						tmp1 = 0
						tmp2 = 0
						Dim extraData
						ReDim extraData(oMetrics.Count)
						counter = LBound(extraData)
						For Each oMetric in oMetrics
							reqCount = reqCount + 1
							With oMetric
								Select Case reqReport
								Case 1,11,31:
									tmpLabels = tmpLabels + .Note + "|"
									tmpData = tmpData + .Points + "|"
									If .MetricID &lt;= 2 Then tmp1 = tmp1 + .Points
									If .MetricID &gt;= 3 Then tmp2 = tmp2 + .Points
								Case 2,12,32,3,13,33:
									tmp = .Note
									If Len(tmp) &gt; 30 Then tmp = Left(tmp,30) + "..."
									If .Qty &lt;&gt; 0 Then tmp = "**" + tmp
									tmpLabels = tmpLabels + tmp + "|"
									tmpData = tmpData + .Points + "|"
									If .Qty &lt;&gt; 0 Then tmp1 = tmp1 + .Points
									If .Qty = 0 Then tmp2 = tmp2 + .Points
								Case 4,14,34,5,15,35:
									If .Qty = 0 Then
										tmpLabels2 = tmpLabels2 + .Note + "|"
										tmpData2 = tmpData2 + .Points + "|"
									Else
										tmpLabels = tmpLabels + .Note + "|"
										tmpData = tmpData + .Points + "|"
									End If
								Case 41,42,43,44,45:
									If .Qty = 0 Then  'Goal
										tmpLabels = tmpLabels + .Note + "|"
										tmpData = tmpData + .Points + "|"
									Else
										tmpLabels2 = tmpLabels2 + .Note + "|"
										tmpData2 = tmpData2 + .Points + "|"
									End If
								Case 10,30:
									tmpLabels = tmpLabels + .Note + "|"
									tmpData = tmpData + .Points + "|"
								End Select
							End With
							counter = counter + 1
						Next
						If reqCount = 0 Then reqCount = -1

						'Remove last | delimiter
						If tmpData &lt;&gt; "" And Right(tmpData,1) = "|" Then tmpData = Left(tmpData, Len(tmpData)-1 )
						If tmpData2 &lt;&gt; "" And Right(tmpData2,1) = "|" Then tmpData2 = Left(tmpData2, Len(tmpData2)-1 )
						'If tmpData3 &lt;&gt; "" And Right(tmpData3,1) = "|" Then tmpData3 = Left(tmpData3, Len(tmpData3)-1 )
						If tmpLabels &lt;&gt; "" And Right(tmpLabels,1) = "|" Then tmpLabels = Left(tmpLabels, Len(tmpLabels)-1 )
						If tmpLabels2 &lt;&gt; "" And Right(tmpLabels2,1) = "|" Then tmpLabels2 = Left(tmpLabels2, Len(tmpLabels2)-1 )
					</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(20)"/>
					<WTMETHOD name="MemberSummary">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTCUSTOM>
						reqTotal = 0
						Points = 0
						For Each oItem in oMetrics
							reqTotal = reqTotal + oItem.Points
						Next
						reqDays = DateDiff( &quot;d&quot;, reqFromDate, reqToDate ) + 1
						If reqDays &gt; 0 Then
						avg = ROUND( reqTotal / reqDays, 1)
						Points = avg * 30
						End If
						a = Split( tmpTracks, ",")
						val = a(3)
						'Create 5th Track pts. rounded up to 100x
						val = Round( ((val*1.25)+50) /100 ) * 100
						If Points &gt; val Then Points = val
						tmpData = CStr(Points) + "|" + Replace(tmpTracks, ",", "|") + "|" + CStr(val)
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCUSTOM>
					Select Case reqReport
					Case 1,11,31:
					tmpResult = tmp1 / (tmp1+tmp2)
					tmpActivity = tmp2 / (tmp1+tmp2)
					reqTotal1 = FormatPercent( tmpResult, 0)
					reqTotal2 = FormatPercent( tmpActivity, 0)
					reqTotal3 = FormatPercent( tmpResult / tmpActivity, 0)
					ChartLabels "11760Chart", tmpLabels, "", "", "", ""
					reqChartSource = "Chart.asp?type=pie&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;labels=" + tmpLabels

					Case 2,12,32,3,13,33:
					tmpResult = tmp1 / (tmp1+tmp2)
					tmpActivity = tmp2 / (tmp1+tmp2)
					reqTotal1 = FormatPercent( tmpResult, 0)
					reqTotal2 = FormatPercent( tmpActivity, 0)
					reqTotal3 = FormatPercent( tmpResult / tmpActivity, 0)
					reqChartSource = "Chart.asp?type=hbar&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;labels=" + tmpLabels

					Case 4,14,34,5,15,35:
					tmpLegend = "Results|Activities"
					ChartLabels "11760Chart", "", tmpLegend, "", "", ""
					FillDataLabels reqFromDate, reqToDate, reqUnit, tmpLabels, tmpData, tmpLabels2, tmpData2
					reqChartSource = "Chart.asp?type=line&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;data2=" + tmpData2 + "&amp;labels=" + tmpLabels + "&amp;legend=" + tmpLegend

					Case 41,42,43,44,45:
					tmpLegend = "Goal|Actual"
					ChartLabels "11760Chart", "", tmpLegend, "", "", ""
					FillDataLabels reqFromDate, reqToDate, reqUnit, tmpLabels, tmpData, tmpLabels2, tmpData2
					FillGoalData tmpData
					reqChartSource = "Chart.asp?type=line&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;data2=" + tmpData2 + "&amp;labels=" + tmpLabels + "&amp;legend=" + tmpLegend

					Case 10,30:
					If reqTheme = 1 Then
					tmpLabels = Replace(tmpLabels, "2-1", "2-1a")
					tmpLabels = Replace(tmpLabels, "2-2", "2-2a")
					tmpLabels = Replace(tmpLabels, "2-3", "2-3a")
					tmpLabels = Replace(tmpLabels, "2-4", "2-4a")
					tmpLabels = Replace(tmpLabels, "2-5", "2-5a")
					End If
					ChartLabels "11760Chart", tmpLabels, "", "", "", ""
					reqChartSource = "Chart.asp?type=pie&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;labels=" + tmpLabels + "&amp;unit=" + reqUnit

					Case 20:
					reqCount = 1
					If reqTheme = 0 Then tmpLabels="2-1|2-2|2-3|2-4|2-5"
					If reqTheme = 1 Then tmpLabels="2-1a|2-2a|2-3a|2-4a|2-5a"
					ChartLabels "11760Chart", tmpLabels, "", "", "", ""
					reqChartSource = "Chart.asp?type=meter&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;labels=" + tmpLabels

					End Select
					If reqTest &gt; 0 Then response.write "&lt;BR&gt;" + reqChartSource
				</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(20)" />
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(1)" />
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>

			<WTACTION id="1" name="Report" type="Update">
				<WTCALLSUB name="LoadMember"/>
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)" />
					<WTHIDDEN value="PARAM(EnrollDate)" />
				</WTROW>

				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" class="PageHeading" align="center" fontsize="4">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC label="TrackerReports"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Report" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="PARAM(Report)" prespace="false">
						<WTOPTION id="20" label="TrackMeter"/>
						<WTOPTION id="1" label="ActivitySummary"/>
						<WTOPTION id="2" label="PersonalSummary"/>
						<WTOPTION id="3" label="LeadershipSummary"/>
						<WTOPTION id="4" label="PersonalProgress"/>
						<WTOPTION id="5" label="LeadershipProgress"/>

						<WTOPTION id="41" label="GoalPersonalResults">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@goal, '41'))"/>
						</WTOPTION>
						<WTOPTION id="42" label="GoalPersonalActivities">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@goal, '42'))"/>
						</WTOPTION>
						<WTOPTION id="43" label="GoalLeadershipResults">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@goal, '43'))"/>
						</WTOPTION>
						<WTOPTION id="44" label="GoalLeadershipActivities">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@goal, '44'))"/>
						</WTOPTION>
						<WTOPTION id="45" label="GoalTotalPoints">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@goal, '45'))"/>
						</WTOPTION>

						<WTOPTION id="30" label="TeamTracks">
							<WTCONDITION expr="_IsContestCreater"/>
						</WTOPTION>
						<WTOPTION id="31" label="TeamActivitySummary">
							<WTCONDITION expr="_IsContestCreater"/>
						</WTOPTION>
						<WTOPTION id="32" label="TeamPersonalSummary">
							<WTCONDITION expr="_IsContestCreater"/>
						</WTOPTION>
						<WTOPTION id="33" label="TeamLeadershipSummary">
							<WTCONDITION expr="_IsContestCreater"/>
						</WTOPTION>
						<WTOPTION id="34" label="TeamPersonalProgress">
							<WTCONDITION expr="_IsContestCreater"/>
						</WTOPTION>
						<WTOPTION id="35" label="TeamLeadershipProgress">
							<WTCONDITION expr="_IsContestCreater"/>
						</WTOPTION>

						<WTOPTION id="10" label="SystemTracks">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="PARAM(GroupID)"/>
						</WTOPTION>
						<WTOPTION id="11" label="SystemActivitySummary">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="PARAM(GroupID)"/>
						</WTOPTION>
						<WTOPTION id="12" label="SystemPersonalSummary">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="PARAM(GroupID)"/>
						</WTOPTION>
						<WTOPTION id="13" label="SystemLeadershipSummary">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="PARAM(GroupID)"/>
						</WTOPTION>
						<WTOPTION id="14" label="SystemPersonalProgress">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="PARAM(GroupID)"/>
						</WTOPTION>
						<WTOPTION id="15" label="SystemLeadershipProgress">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="PARAM(GroupID)"/>
						</WTOPTION>
					</WTCOMBO>
					<WTBUTTON col="1" value="CONST(View)" action="1"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" align="center" label="For" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="0" label="Membership" />
						<!--						<WTOPTION id="1" label="Yesterday" />-->
						<!--						<WTOPTION id="2" label="Today" />-->
						<WTOPTION id="9" label="Prev7" />
						<WTOPTION id="10" label="Prev30" />
						<WTOPTION id="6" label="WeekToDate" />
						<WTOPTION id="7" label="MonthToDate" />
						<WTOPTION id="8" label="YearToDate" />
						<WTOPTION id="3" label="PrevWeek" />
						<WTOPTION id="4" label="PrevMonth" />
						<WTOPTION id="5" label="PrevYear" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "4":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "5":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "7":
							fromdate.setDate(1);
							break;
							case "8":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setTime(fromdate.getTime() - ( 6 * ONE_DAY) );
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() - ( 30 * ONE_DAY) );
							break;
							}
							if(term!=0){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" label="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" />
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>

				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Count)" oper="less" value="CONST(0)"/>
					<WTSTATIC col="1" label="NoReportData" class="PageHeading" align="center"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Count)" oper="greater" value="CONST(0)"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC fontsize="5">
								<WTSTATIC label="TrackMeter">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(20)"/>
								</WTSTATIC>
								<WTSTATIC label="ActivitySummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="PersonalSummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="LeadershipSummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="PersonalProgress">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
								<WTSTATIC label="LeadershipProgress">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
								</WTSTATIC>
								<WTSTATIC label="SystemTracks">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(10)"/>
								</WTSTATIC>
								<WTSTATIC label="SystemActivitySummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(11)"/>
								</WTSTATIC>
								<WTSTATIC label="SystemPersonalSummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(12)"/>
								</WTSTATIC>
								<WTSTATIC label="SystemLeadershipSummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(13)"/>
								</WTSTATIC>
								<WTSTATIC label="SystemPersonalProgress">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(14)"/>
								</WTSTATIC>
								<WTSTATIC label="SystemLeadershipProgress">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(15)"/>
								</WTSTATIC>

								<WTSTATIC label="TeamTracks">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(30)"/>
								</WTSTATIC>
								<WTSTATIC label="TeamActivitySummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(31)"/>
								</WTSTATIC>
								<WTSTATIC label="TeamPersonalSummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(32)"/>
								</WTSTATIC>
								<WTSTATIC label="TeamLeadershipSummary">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(33)"/>
								</WTSTATIC>
								<WTSTATIC label="TeamPersonalProgress">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(34)"/>
								</WTSTATIC>
								<WTSTATIC label="TeamLeadershipProgress">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(35)"/>
								</WTSTATIC>

								<WTSTATIC label="GoalPersonalResults">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(41)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalPersonalActivities">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(42)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalLeadershipResults">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(43)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalLeadershipActivities">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(44)"/>
								</WTSTATIC>
								<WTSTATIC label="GoalTotalPoints">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(45)"/>
								</WTSTATIC>
							</WTSTATIC>

							<WTCODEGROUP>
								<WTSTATIC newline="1"/>
								<WTSTATIC value="PARAM(FromDate)"/>
								<WTSTATIC value="CONST( - )"/>
								<WTSTATIC value="PARAM(ToDate)"/>
							</WTCODEGROUP>

							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(11)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(31)" connector="or"/>
								<WTSTATIC newline="1"/>
								<WTSTATIC value="PARAM(Total1)" space="1" fontcolor="blue"/>
								<WTSTATIC label="ResultsText" newline="1"/>
								<WTSTATIC value="PARAM(Total2)" space="1" fontcolor="blue"/>
								<WTSTATIC label="ActivitiesText" newline="1"/>
								<WTSTATIC label="RatioText" space="1"/>
								<WTSTATIC value="PARAM(Total3)" fontcolor="blue"/>
							</WTCODEGROUP>

							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(12)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(13)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(32)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(33)" connector="or"/>
								<WTSTATIC newline="1"/>
								<WTSTATIC value="PARAM(Total1)" space="1" fontcolor="blue"/>
								<WTSTATIC label="ResultsText" newline="1"/>
								<WTSTATIC value="PARAM(Total2)" space="1" fontcolor="blue"/>
								<WTSTATIC label="ActivitiesText" newline="1"/>
								<WTSTATIC label="RatioText" space="1"/>
								<WTSTATIC value="PARAM(Total3)" fontcolor="blue"/>
							</WTCODEGROUP>

							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(14)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(15)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(34)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(35)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(41)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(42)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(43)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(44)" connector="or"/>
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(45)" connector="or"/>
								<WTSTATIC space="1"/>
								<WTSTATIC label="Daily">
									<WTCONDITION expr="PARAM(Unit)" oper="equal" value="CONST('day')"/>
								</WTSTATIC>
								<WTSTATIC label="Weekly">
									<WTCONDITION expr="PARAM(Unit)" oper="equal" value="CONST('week')"/>
								</WTSTATIC>
								<WTSTATIC label="Monthly">
									<WTCONDITION expr="PARAM(Unit)" oper="equal" value="CONST('month')"/>
								</WTSTATIC>
								<WTSTATIC label="Quarterly">
									<WTCONDITION expr="PARAM(Unit)" oper="equal" value="CONST('quarter')"/>
								</WTSTATIC>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTIMAGE col="1" align="center" value="PARAM(ChartSource)" path="../.."/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(Mobile)" oper="equal" value="CONST(0)"/>
						<WTSTATIC col="1" class="prompt" align="left">
							<WTSTATIC label="TrackMeterText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(20)"/>
							</WTSTATIC>
							<WTSTATIC label="ActivitySummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="PersonalSummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
							<WTSTATIC label="LeadershipSummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
							<WTSTATIC label="PersonalProgressText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
							</WTSTATIC>
							<WTSTATIC label="LeadershipProgressText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
							</WTSTATIC>
							<WTSTATIC label="SystemTracksText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(10)"/>
							</WTSTATIC>
							<WTSTATIC label="SystemActivitySummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(11)"/>
							</WTSTATIC>
							<WTSTATIC label="SystemPersonalSummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(12)"/>
							</WTSTATIC>
							<WTSTATIC label="SystemLeadershipSummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(13)"/>
							</WTSTATIC>
							<WTSTATIC label="SystemPersonalProgressText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(14)"/>
							</WTSTATIC>
							<WTSTATIC label="SystemLeadershipProgressText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(15)"/>
							</WTSTATIC>

							<WTSTATIC label="TeamTracksText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(30)"/>
							</WTSTATIC>
							<WTSTATIC label="TeamActivitySummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(31)"/>
							</WTSTATIC>
							<WTSTATIC label="TeamPersonalSummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(32)"/>
							</WTSTATIC>
							<WTSTATIC label="TeamLeadershipSummaryText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(33)"/>
							</WTSTATIC>
							<WTSTATIC label="TeamPersonalProgressText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(34)"/>
							</WTSTATIC>
							<WTSTATIC label="TeamLeadershipProgressText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(35)"/>
							</WTSTATIC>

							<WTSTATIC label="GoalPersonalResultsText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(41)"/>
							</WTSTATIC>
							<WTSTATIC label="GoalPersonalActivitiesText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(42)"/>
							</WTSTATIC>
							<WTSTATIC label="GoalLeadershipResultsText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(43)"/>
							</WTSTATIC>
							<WTSTATIC label="GoalLeadershipActivitiesText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(44)"/>
							</WTSTATIC>
							<WTSTATIC label="GoalTotalPointsText">
								<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(45)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(Mobile)" oper="not-equal" value="CONST(0)"/>
						<WTTABLE col="1">
							<WTCOLUMN width="200" align="left"/>
							<WTCOLUMN width="350" align="left"/>
							<WTCOLUMN width="200" align="left"/>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" class="prompt" align="left">
									<WTSTATIC label="TrackMeterText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(20)"/>
									</WTSTATIC>
									<WTSTATIC label="ActivitySummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC label="PersonalSummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
									<WTSTATIC label="LeadershipSummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
									</WTSTATIC>
									<WTSTATIC label="PersonalProgressText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
									</WTSTATIC>
									<WTSTATIC label="LeadershipProgressText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
									</WTSTATIC>
									<WTSTATIC label="SystemTracksText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(10)"/>
									</WTSTATIC>
									<WTSTATIC label="SystemActivitySummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(11)"/>
									</WTSTATIC>
									<WTSTATIC label="SystemPersonalSummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(12)"/>
									</WTSTATIC>
									<WTSTATIC label="SystemLeadershipSummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(13)"/>
									</WTSTATIC>
									<WTSTATIC label="SystemPersonalProgressText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(14)"/>
									</WTSTATIC>
									<WTSTATIC label="SystemLeadershipProgressText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(15)"/>
									</WTSTATIC>
									
									<WTSTATIC label="TeamTracksText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(30)"/>
									</WTSTATIC>
									<WTSTATIC label="TeamActivitySummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(31)"/>
									</WTSTATIC>
									<WTSTATIC label="TeamPersonalSummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(32)"/>
									</WTSTATIC>
									<WTSTATIC label="TeamLeadershipSummaryText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(33)"/>
									</WTSTATIC>
									<WTSTATIC label="TeamPersonalProgressText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(34)"/>
									</WTSTATIC>
									<WTSTATIC label="TeamLeadershipProgressText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(35)"/>
									</WTSTATIC>

									<WTSTATIC label="GoalPersonalResultsText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(41)"/>
									</WTSTATIC>
									<WTSTATIC label="GoalPersonalActivitiesText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(42)"/>
									</WTSTATIC>
									<WTSTATIC label="GoalLeadershipResultsText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(43)"/>
									</WTSTATIC>
									<WTSTATIC label="GoalLeadershipActivitiesText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(44)"/>
									</WTSTATIC>
									<WTSTATIC label="GoalTotalPointsText">
										<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(45)"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================================-->
		<WTWEBPAGE name="11770" caption="Export Leader Board" header="false" footer="false" navbar="false" wrapper="wrapper800"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--==================================================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ContestID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Scope" datatype="number"/>
			<WTPARAM name="Rpt" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="Private" datatype="number"/>
			<WTPARAM name="URL" datatype="text"/>
			<WTPARAM name="Custom1" datatype="number"/>
			<WTPARAM name="Custom2" datatype="number"/>
			<WTPARAM name="Custom3" datatype="number"/>
			<WTPARAM name="Custom4" datatype="number"/>
			<WTPARAM name="Custom5" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Metrics" project="ptsMetricUser" class="CMetrics">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Rpt)" oper="not-equal" value="CONST(0)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTMETHOD name="ExpLeaderCompany">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
									<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTMETHOD name="ExpLeaderGroup">
									<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
									<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
									<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTMETHOD name="ExpLeaderMentor">
									<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
									<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
									<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="ExpLeaderPrivate">
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Rpt" direction="input" value="PARAM(Rpt)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTMETHOD name="ExpLeaderCompanyCustom">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
									<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
									<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
									<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
									<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
									<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTMETHOD name="ExpLeaderGroupCustom">
									<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
									<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
									<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
									<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
									<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
									<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
									<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTMETHOD name="ExpLeaderMentorCustom">
									<WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
									<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
									<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
									<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
									<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
									<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
									<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTMETHOD name="ExpLeaderPrivateCustom">
								<WTPARAM name="ContestID" direction="input" value="PARAM(ContestID)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Custom1" direction="input" value="PARAM(Custom1)"/>
								<WTPARAM name="Custom2" direction="input" value="PARAM(Custom2)"/>
								<WTPARAM name="Custom3" direction="input" value="PARAM(Custom3)"/>
								<WTPARAM name="Custom4" direction="input" value="PARAM(Custom4)"/>
								<WTPARAM name="Custom5" direction="input" value="PARAM(Custom5)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetrics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
<WTCUSTOM>
	Dim oFileSys, oFile, Rec

	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	If oFileSys Is Nothing Then
	Response.Write "Scripting.FileSystemObject failed to load"
	Response.End
	End If

	Path = Request.ServerVariables("APPL_PHYSICAL_PATH") + "Export\Metrics\"
	reqFile = CSTR(reqSysUserID) + ".csv"
	reqURL = "http://" + reqSysServerName + reqSysServerPath + "Export\Metrics\" + reqFile

	Set oFile = oFileSys.CreateTextFile(Path + reqFile, True)
	If oFile Is Nothing Then
	Response.Write "Couldn't create Export file: " + Path + reqFile
	Response.End
	End If

	'Create Header
	Rec = CHR(34) + "#" + CHR(34) + "," + CHR(34) + "Name" + CHR(34) + "," + CHR(34) + "Phone" + CHR(34) + "," + CHR(34) + "Email" + CHR(34) + "," + CHR(34) + "Member #" + CHR(34) + "," + CHR(34) + "Points" + CHR(34)
	oFile.WriteLine( Rec )

	cnt = 0
	For Each oItem in oMetrics
	With oItem
	cnt = cnt + 1
	aMember = Split(.InputOptions, ",")
	name = aMember(0)
	phone = aMember(1)
	email = aMember(2)
	Rec = CHR(34) + CSTR(cnt) + CHR(34) + "," + CHR(34) + name + CHR(34) + "," + CHR(34) + phone + CHR(34) + "," + CHR(34) + email + CHR(34) + "," + CHR(34) + .MetricID + CHR(34) + "," + CHR(34) + .Points + CHR(34)
	oFile.WriteLine( Rec )
	End With
	Next

	oFile.Close
	Set oFile = Nothing
	Set oFileSys = Nothing
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTROW>
					<WTSTATIC col="1" fontcolor="#000070" fontsize="3" bold="true">
						<WTSTATIC tag="Export"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="equal" value="CONST(0)" />
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(1)" />
								<WTSTATIC label="CompanyID" value="PARAM(CompanyID)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(2)" />
								<WTSTATIC label="GroupID" value="PARAM(GroupID)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Scope)" oper="equal" value="CONST(3)" />
								<WTSTATIC label="Mentor" value="PARAM(MemberID)"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Private)" oper="not-equal" value="CONST(0)" />
							<WTSTATIC label="ContestID" value="PARAM(ContestID)"/>
						</WTCODEGROUP>
						<WTSTATIC space="2"/>
						<WTSTATIC label="from" value="PARAM(FromDate)" space="1"/>
						<WTSTATIC label="to" value="PARAM(ToDate)" space="1"/>
						<WTSTATIC space="2"/>
						<WTSTATIC label="Custom">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(0)" />
						</WTSTATIC>
						<WTSTATIC label="Results">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)" />
						</WTSTATIC>
						<WTSTATIC label="Activities">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)" />
						</WTSTATIC>
						<WTSTATIC label="All">
							<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(3)" />
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="PARAM(URL)" align="center" bold="true">
						<WTLINK name="&lt;xsl:value-of select=&quot;/DATA/PARAM/@url&quot;/&gt;" type="anchor" target="ExportFile"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Metric">
						<WTCOLUMN width="10" align="center" valign="top" label="#" />
						<WTCOLUMN width="70" align="left" valign="top" label="MemberName" />
						<WTCOLUMN width="10" align="center" valign="top" label="MemberID" />
						<WTCOLUMN width="10" align="center" valign="top" label="Points" />
						<WTROW height="30">
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()+/DATA/PARAM/@pos&quot;/&gt;)"/>
							<WTSTATIC col="2" value="DATA(Metric.InputOptions)"/>
							<WTSTATIC col="3" value="DATA(Metric.MetricID)"/>
							<WTSTATIC col="4" value="DATA(Metric.Points)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>