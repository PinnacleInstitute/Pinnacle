<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="93" name="Page" alias="pg" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="9301" name="PageID" type="number" identity="true" min="1" required="true" source="entity"/>
	
		<!--Foreign Keys-->
		<WTATTRIBUTE id="9302" name="CompanyID" type="number" source="entity"/>
		<WTATTRIBUTE id="9303" name="MemberID" type="number" source="entity"/>

		<!--Foreign Table Fields-->

		<!--Attributes-->
		<WTATTRIBUTE id="9305" name="PageName" type="text" length="60" min="1" max="60" source="entity" required="true" title="true"/>
		<WTATTRIBUTE id="9306" name="Category" type="text" length="20" min="1" max="20" source="entity"/>
		<WTATTRIBUTE id="9307" name="PageType" type="number" source="entity"/>
		<WTATTRIBUTE id="9308" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Active"/>
			<WTENUM id="2" name="InActive"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9309" name="Language" type="text" length="6" min="1" max="6" source="entity" language="false"/>				
		<WTATTRIBUTE id="9310" name="IsPrivate" type="yesno" source="entity"/>
		<WTATTRIBUTE id="9311" name="Form" type="number" source="entity">
			<WTENUM id="1" name="Member"/>
			<WTENUM id="2" name="Prospect"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9312" name="Fields" type="text" length="1000" source="entity" language="false"/>
		<WTATTRIBUTE id="9313" name="IsShare" type="yesno" source="entity" />
		<WTATTRIBUTE id="9314" name="Subject" type="text" length="80" min="1" max="80" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="9391" name="GroupID1" type="number" source="entity" persist="false" />
		<WTATTRIBUTE id="9392" name="GroupID2" type="number" source="entity" persist="false" />
		<WTATTRIBUTE id="9393" name="GroupID3" type="number" source="entity" persist="false" />

		<!--Indexes-->
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="PageType"/>
		</WTINDEX>
		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="PageType"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Page" entity="Page" alias="pg"/>
			<WTRELATIONSHIP name="Common" entity="Page" alias="pg"/>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="PageName" default="true"/>
			<WTATTRIBUTE name="Category"/>
			<WTATTRIBUTE name="PageID"/>
			<WTATTRIBUTE name="Language"/>
		</WTENUM>

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="STATUS-ACTIVE" value="1"/>
			<WTSYSCON name="STATUS-INACTIVE" value="2"/>
			<WTSYSCON name="FORM-MEMBER" value="1"/>
			<WTSYSCON name="FORM-PROSPECT" value="2"/>
		</WTSYSCONS>
	</WTENTITY>

	<WTPROCEDURES>
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Count" name="Count" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindCompany" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Page.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="PARAM(PageType)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindCompanyCategory" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="ATTR(Category)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Page.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="PARAM(PageType)" connector="and"/>
			<WTCONDITION expr="ATTR(Page.Category)" oper="equal" value="PARAM(Category)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindMember" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Page.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
			<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="PARAM(PageType)" connector="and"/>
		</WTPROCEDURE>

		<!--================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--================================================================================================-->
		<WTPROCEDURE type="EnumXML" name="EnumPage" enumname="EnumPageList" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(GroupID1)" direction="input"/>
			<WTPARAM name="ATTR(GroupID2)" direction="input"/>
			<WTPARAM name="ATTR(GroupID3)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Enum" name="EnumPageList" style="GenerateDataProc.xsl" column="PageName" template="new" passthru="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(GroupID1)" direction="input"/>
			<WTPARAM name="ATTR(GroupID2)" direction="input"/>
			<WTPARAM name="ATTR(GroupID3)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE alias="Name" value="CONST(CASE WHEN pg.Category!='' THEN pg.Category + ': ' ELSE '' END + pg.PageName)"/>
					<WTJOIN name="Page"/>
					<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="PARAM(CompanyID)" />
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and" />
					<WTCONDITION expr="ATTR(PageType)" oper="equal" value="PARAM(PageType)" connector="and" />
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)" connector="or"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID1)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID2)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID3)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end2"/>
					<WTORDER name="ATTR(Page.Category)"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="EnumXML" name="EnumPageCategory" enumname="EnumPageCategoryList" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(GroupID1)" direction="input"/>
			<WTPARAM name="ATTR(GroupID2)" direction="input"/>
			<WTPARAM name="ATTR(GroupID3)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Enum" name="EnumPageCategoryList" style="GenerateDataProc.xsl" column="PageName" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(GroupID1)" direction="input"/>
			<WTPARAM name="ATTR(GroupID2)" direction="input"/>
			<WTPARAM name="ATTR(GroupID3)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE alias="Name" value="ATTR(Page.Category)"/>
					<WTJOIN name="Page"/>
					<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="PARAM(CompanyID)" />
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and" />
					<WTCONDITION expr="ATTR(PageType)" oper="equal" value="PARAM(PageType)" connector="and" />
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)" connector="or"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID1)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID2)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID3)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end2"/>
					<WTORDER name="ATTR(Page.Category)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--		
		<WTPROCEDURE type="EnumXML" name="EnumCompany" enumname="EnumUserCompany" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Enum" name="EnumUserCompany" style="GenerateDataProc.xsl" column="PageName" template="new" passthru="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE alias="Name" value="ATTR(Page.PageName)"/>
					<WTJOIN name="Page"/>
					<WTCONDITION expr="ATTR(Page.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="PARAM(PageType)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<WTPROCEDURE type="EnumXML" name="EnumCompanyCategory" enumname="EnumUserCompanyCategory" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="ATTR(Category)" direction="input"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Enum" name="EnumUserCompanyCategory" style="GenerateDataProc.xsl" column="PageName" template="new" passthru="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="ATTR(Category)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE alias="Name" value="ATTR(Page.PageName)"/>
					<WTJOIN name="Page"/>
					<WTCONDITION expr="ATTR(Page.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="PARAM(PageType)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.Category)" oper="equal" value="PARAM(Category)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<WTPROCEDURE type="EnumXML" name="EnumMember" enumname="EnumUserMember" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Enum" name="EnumUserMember" style="GenerateDataProc.xsl" column="PageName" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE alias="Name" value="ATTR(Page.PageName)"/>
					<WTJOIN name="Page"/>
					<WTCONDITION expr="ATTR(Page.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="PARAM(PageType)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
-->		
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ListForm" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Form)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE value="ATTR(Page.PageName)"/>
					<WTATTRIBUTE value="ATTR(Page.Category)"/>
					<WTJOIN name="Page" lock="false"/>
					<WTCONDITION expr="ATTR(Page.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Page.Form)" oper="equal" value="PARAM(Form)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and"/>
					<WTORDER name="ATTR(Page.Category)"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ListFormPublic" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Form)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE value="ATTR(Page.PageName)"/>
					<WTATTRIBUTE value="ATTR(Page.Category)"/>
					<WTJOIN name="Page" lock="false"/>
					<WTCONDITION expr="ATTR(Page.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Page.Form)" oper="equal" value="PARAM(Form)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.IsPrivate)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and"/>
					<WTORDER name="ATTR(Page.Category)"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ListPage" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(GroupID1)" direction="input"/>
			<WTPARAM name="ATTR(GroupID2)" direction="input"/>
			<WTPARAM name="ATTR(GroupID3)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE value="ATTR(Page.PageName)"/>
					<WTATTRIBUTE value="ATTR(Page.Category)"/>
					<WTATTRIBUTE value="ATTR(Page.Subject)"/>
					<WTATTRIBUTE value="ATTR(Page.Fields)"/>
					<WTJOIN name="Page"/>
					<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="PARAM(CompanyID)" />
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and" />
					<WTCONDITION expr="ATTR(PageType)" oper="equal" value="PARAM(PageType)" connector="and" />
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)" connector="or"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID1)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID2)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID3)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end2"/>
					<WTORDER name="ATTR(Page.Category)"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="ListPageCategory" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(GroupID1)" direction="input"/>
			<WTPARAM name="ATTR(GroupID2)" direction="input"/>
			<WTPARAM name="ATTR(GroupID3)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTPARAM name="ATTR(Category)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE value="ATTR(Page.PageName)"/>
					<WTATTRIBUTE value="ATTR(Page.Category)"/>
					<WTATTRIBUTE value="ATTR(Page.Subject)"/>
					<WTATTRIBUTE value="ATTR(Page.Fields)"/>
					<WTJOIN name="Page"/>
					<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="PARAM(CompanyID)" />
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(STATUS-ACTIVE)" connector="and" />
					<WTCONDITION expr="ATTR(PageType)" oper="equal" value="PARAM(PageType)" connector="and" />
					<WTCONDITION expr="ATTR(Category)" oper="equal" value="PARAM(Category)" connector="and" />
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)" connector="or"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID1)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID2)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(GroupID3)" connector="or" paren="start"/>
					<WTCONDITION expr="ATTR(IsShare)" oper="not-equal" value="CONST(0)" connector="and" paren="end2"/>
					<WTORDER name="ATTR(Page.PageName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE name="Search" type="Find" style="GenerateDataProc.xsl" template="new" searchlength="200" bookmarklength="14" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(GroupID1)" direction="input"/>
			<WTPARAM name="ATTR(GroupID2)" direction="input"/>
			<WTPARAM name="ATTR(GroupID3)" direction="input"/>
			<WTPARAM name="ATTR(PageType)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Page.PageID)"/>
					<WTATTRIBUTE value="ATTR(Page.PageName)"/>
					<WTATTRIBUTE value="ATTR(Page.Category)"/>
					<WTATTRIBUTE value="ATTR(Page.Subject)"/>
					<WTATTRIBUTE value="ATTR(Page.Fields)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE name="UpdateFT" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" novalidate="true" nodata="true">
			<WTPARAM name="ATTR(PageID)" direction="input"/>
			<WTPARAM name="ATTR(PageName)" direction="input"/>
			<WTPARAM name="ATTR(Fields)" direction="input"/>
			<WTPARAM name="Result" datatype="number" direction="output"/>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
	    <!--============================================================================================-->
		<WTWEBPAGE name="9301" caption="Find" contentpage="true" action="5" wrapper="wrapper750" 
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="PageType" datatype="number"/>
			<WTPARAM name="Category" datatype="text"/>
			<WTPARAM name="ContentPage" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(PageName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
				<WTMETHOD name="FindCompany">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Category)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="PageType" direction="input" value="PARAM(PageType)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindCompanyCategory">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Category)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="PageType" direction="input" value="PARAM(PageType)"/>
					<WTPARAM name="Category" direction="input" value="PARAM(Category)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="PageType" direction="input" value="PARAM(PageType)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTFUNCTION name="UploadPage(id)">
					var url, win; 
					url = "9320.asp?PageID=" + id
		            win = window.open(url,"UploadFile","top=100,left=100,height=200,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

        <WTROW margin-bottom="6">
					<WTTABLE col="1">
						<WTCOLUMN width="375" align="left"/>
						<WTCOLUMN width="375" align="right"/>
						<WTROW>
							<WTSTATIC col="1" class="PageHeading" align="left">
								<WTSTATIC label="LeadEmailTemplates">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
								</WTSTATIC>
								<WTSTATIC label="PresentationEmailTemplates">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)"/>
								</WTSTATIC>
								<WTSTATIC label="ProspectEmailTemplates">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
								</WTSTATIC>
								<WTSTATIC label="ContactEmailTemplates">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)"/>
								</WTSTATIC>
								<WTSTATIC label="CustomerEmailTemplates">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)"/>
								</WTSTATIC>
								<WTSTATIC label="InfoPages">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
								</WTSTATIC>
								<WTSTATIC label="TrainingPages">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPinnacleTutorial"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
										<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
										<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)" connector="or"/>
										<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)" connector="or"/>
										<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)" connector="or"/>
										<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)" connector="or"/>
										<WTLINK name="Tutorial" target="Tutorial">
											<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-CUSTOMEMAIL)"/>
											<WTPARAM name="contentpage" value="CONST(3)"/>
											<WTPARAM name="popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
									<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
										<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
										<WTLINK name="Tutorial" target="Tutorial">
											<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-CUSTOMPAGES)"/>
											<WTPARAM name="contentpage" value="CONST(3)"/>
											<WTPARAM name="popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" class="PageHeader" align="right">
								<WTCONDITION expr="IsActive"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC label="NewEmailTemplate">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)" connector="or"/>
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)" connector="or"/>
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)" connector="or"/>
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)" connector="or"/>
									<WTLINK name="9302">
										<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="PageType" value="PARAM(PageType)"/>
										<WTPARAM name="Category" value="PARAM(Category)"/>
										<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC label="NewInfo">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
									<WTLINK name="9302">
										<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="PageType" value="PARAM(PageType)"/>
										<WTPARAM name="Category" value="PARAM(Category)"/>
										<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC label="NewTraining">
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
									<WTLINK name="9302">
										<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="PageType" value="PARAM(PageType)"/>
										<WTPARAM name="Category" value="PARAM(Category)"/>
										<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
									</WTLINK>
								</WTSTATIC>
								<WTCODEGROUP>
					 				<WTCONDITION expr="IsEmployee"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(import.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="Import">
										<WTLINK name="93Import" target="Import">
											<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
<!--
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
-->        
				<WTROW>
					<WTSTATIC col="1" class="prompt" align="left">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
							<WTSTATIC label="LeadEmailTemplateText" newline="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)"/>
							<WTSTATIC label="PresentationEmailTemplateText" newline="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
							<WTSTATIC label="ProspectEmailTemplateText" newline="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)"/>
							<WTSTATIC label="ContactEmailTemplateText" newline="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)"/>
							<WTSTATIC label="CustomerEmailTemplateText" newline="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
							<WTSTATIC label="InfoPageText"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
							<WTSTATIC label="TrainingText"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Pages.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
<!--					<WTBUTTON col="1" action="3" value="CONST(Return)"/>-->

				</WTROW>
				
				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Page">
						<WTCOLUMN width="20" align="left" label="Category"/>
						<WTCOLUMN width="60" align="left" label="PageName"/>
						<WTCOLUMN width="10" align="center" label="Status"/>
						<WTCOLUMN width="10" align="center" label="Language"/>
						<WTROW height="24">
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Page.Category)">
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Page.Category)" fontcolor="gray">
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
									<WTCONDITION expr="DATA(Subject)" oper="not-equal" value="CONST('')" connector="and"/>
									<WTIMAGE value="CONST(Images.gif)" alt="HasImage" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Page.PageName)">
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Page.PageName)" fontcolor="gray">
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="9303">
											<WTPARAM name="PageID" value="DATA(PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="P" target="Preview">
											<WTPARAM name="P" value="DATA(Page.PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
									<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)" connector="or"/>
									<WTSTATIC fontcolor="purple">
										<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@pageid&quot;/&gt;))"/>
									</WTSTATIC>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Upload.gif)" alt="UploadPage" imgalign="absmiddle">
											<WTLINK name="UploadPage(&lt;xsl:value-of select=&quot;@pageid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Page.Form)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(Entity74.gif)" alt="Export" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
							 		<WTCONDITION expr="IsEmployee"/>
									<WTIMAGE value="CONST(ArrowDown.gif)" alt="Export" imgalign="absmiddle">
										<WTLINK name="ExportPage" target="Export">
											<WTPARAM name="PageID" value="DATA(Page.PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" fontcolor="blue"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTSTATIC value="DATA(Page.Status)">
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Page.Status)" fontcolor="gray">
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(Page.Language)"/>
						</WTROW>

						<WTROW>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)" connector="or"/>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)" connector="or"/>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)" connector="or"/>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)" connector="or"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="4" value="DATA(Page.Subject)" fontcolor="gray"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
							<WTCONDITION expr="DATA(Fields)" oper="not-equal" value="CONST('')" connector="and"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="4" value="DATA(Page.Fields)" fontcolor="gray"/>
						</WTROW>

					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="93Import" caption="Import Page" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="Cnt" datatype="number"/>

			<WTACTION id="1" name="Update" type="Update">
				<WTRETURN>
					<WTLINK name="ImportPage" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="ImportPage"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="prompt" align="center">
							<WTSTATIC label="ImportPageText"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC tag="Company" value="PARAM(CompanyID)" newline="1"/>
							<WTSTATIC tag="Member" value="PARAM(MemberID)" newline="1"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC value="PARAM(Cnt)" space="1"/>
							<WTSTATIC label="ImportSuccess"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Import)" align="center">
				 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>


		<!--==================================================================-->
		<WTWEBPAGE name="9302" caption="New Page" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="PageType" datatype="number"/>
			<WTPARAM name="Category" datatype="text"/>
			<WTPARAM name="ContentPage" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTMETHOD name="Load">
						<WTPARAM name="PageID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(STATUS-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(&quot;en&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Category)" value="PARAM(Category)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPage" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTMETHOD name="Load">
						<WTPARAM name="PageID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(PageType)" value="PARAM(PageType)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpLang)" value="ATTR(Language)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="PageID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="UpdateFT">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(1)" connector="and"/>
						<WTCONDITION expr="ATTR(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)" connector="and"/>
						<WTPARAM name="PageID" direction="input" value="CONST(PageID)"/>
						<WTPARAM name="PageName" direction="input" value="ATTR(PageName)"/>
						<WTPARAM name="Fields" direction="input" value="ATTR(Fields)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlPage" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="9303" skipreturn="true">
						<WTPARAM name="PageID" value="CONST(PageID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" class="PageHeading">
						<WTSTATIC label="NewEmailLead">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
						</WTSTATIC>
						<WTSTATIC label="NewEmailPresentation">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)"/>
						</WTSTATIC>
						<WTSTATIC label="NewEmailProspect">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
						</WTSTATIC>
						<WTSTATIC label="NewEmailContact">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)"/>
						</WTSTATIC>
						<WTSTATIC label="NewEmailCustomer">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)"/>
						</WTSTATIC>
						<WTSTATIC label="NewInfo">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
						</WTSTATIC>
						<WTSTATIC label="NewTraining">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
						<WTSTATIC col="1" merge="2" label="ProspectCategory" align="left" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)"/>
						<WTSTATIC col="1" merge="2" label="ContactCategory" align="left" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)"/>
						<WTSTATIC col="1" merge="2" label="CustomerCategory" align="left" class="prompt"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTSTATIC col="1" tag="Category"/>
					<WTTEXT col="2" value="ATTR(Page.Category)"/>
					<WTCHECK col="2" value="ATTR(Page.IsShare)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PageName"/>
					<WTTEXT col="2" value="ATTR(Page.PageName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status"/>
					<WTCOMBO col="2" value="ATTR(Page.Status)"/>
					<WTSTATIC col="2" tag="Language"/>
					<WTTEXT col="2" value="ATTR(Page.Language)" prespace="false"/>
				</WTROW>

				<WTROW margin-top="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9303" caption="Page" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="PageID" datatype="number"/>
			<WTPARAM name="URL" datatype="text"/>
			<WTPARAM name="UploadImage" datatype="text"/>

			<WTCODEGROUP>
<WTCUSTOM>
	reqURL = "http://" + reqSysServerName + reqSysServerPath + "P.asp?p=" &amp; reqPageID
</WTCUSTOM>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadImage)" oper="not-equal" value="&quot;&quot;"/>
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTMETHOD name="Load">
						<WTPARAM name="PageID" direction="input" value="PARAM(PageID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Subject)" value="PARAM(UploadImage)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB name="LoadPage">
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTMETHOD name="Load">
						<WTPARAM name="PageID" direction="input" value="PARAM(PageID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpLang)" value="ATTR(Language)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPage" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPageID &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Pages\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(tmpLang)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdatePage">
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTMETHOD name="Load">
						<WTPARAM name="PageID" direction="input" value="PARAM(PageID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="UpdateFT">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(1)" connector="and"/>
						<WTCONDITION expr="ATTR(PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)" connector="and"/>
						<WTPARAM name="PageID" direction="input" value="ATTR(PageID)"/>
						<WTPARAM name="PageName" direction="input" value="ATTR(PageName)"/>
						<WTPARAM name="Fields" direction="input" value="ATTR(Fields)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlPage" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPageID &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Pages\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="FORM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadPage"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdatePage"/>
				<WTCALLSUB name="LoadPage">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTMETHOD name="Delete">
						<WTPARAM name="PageID" direction="input" value="PARAM(PageID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadPage">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="6" name="UploadImage" type="Upload">
				<WTCALLSUB name="UpdatePage"/>
				<WTCALLSUB name="LoadPage">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="9321" return="false">
						<WTPARAM name="PageID" value="PARAM(PageID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="590" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC tag="LeadEmailTemplate">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
						</WTSTATIC>
						<WTSTATIC tag="PresentationEmailTemplate">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)"/>
						</WTSTATIC>
						<WTSTATIC tag="ProspectEmailTemplate">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
						</WTSTATIC>
						<WTSTATIC tag="ContactEmailTemplate">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)"/>
						</WTSTATIC>
						<WTSTATIC tag="CustomerEmailTemplate">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)"/>
						</WTSTATIC>
						<WTSTATIC tag="InfoPage">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
						</WTSTATIC>
						<WTSTATIC tag="TrainingPage">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Page.PageName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" class="prompt">
						<WTSTATIC label="tags">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)" connector="or"/>
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)" connector="or"/>
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)" connector="or"/>
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)" connector="or"/>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-INFO)"/>
							<WTSTATIC label="Infotext" space="1"/>
							<WTSTATIC value="PARAM(URL)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
							<WTSTATIC label="Traintext" space="1"/>
							<WTSTATIC value="PARAM(URL)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
<!--				
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="left" class="prompt">
						<WTSTATIC label="PageEditorHelp" space="1"/>
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(HelpPageEditor)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
-->						
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1" tag="CompanyID"/>
						<WTTEXT col="2" value="ATTR(Page.CompanyID)" size="5"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="MemberID"/>
						<WTTEXT col="2" value="ATTR(Page.MemberID)" size="5"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTHIDDEN value="ATTR(Page.CompanyID)"/>
					<WTHIDDEN value="ATTR(Page.MemberID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="Category"/>
					<WTTEXT col="2" value="ATTR(Page.Category)"/>
					<WTCHECK col="2" value="ATTR(Page.IsShare)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PageName"/>
					<WTTEXT col="2" value="ATTR(Page.PageName)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)" connector="or"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)" connector="or"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)" connector="or"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)" connector="or"/>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)" connector="or"/>
					<WTSTATIC col="1">
						<WTSTATIC tag="Subject">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="not-equal" value="SYSCON(PAGETYPE-TRAINING)"/>
						</WTSTATIC>
						<WTSTATIC tag="Image">
							<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
						</WTSTATIC>
					</WTSTATIC>
					<WTTEXT col="2" value="ATTR(Page.Subject)" class="prompt"/>
					<WTBUTTON col="2" action="6" value="CONST(Upload)">
						<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status"/>
					<WTCOMBO col="2" value="ATTR(Page.Status)"/>
					<WTSTATIC col="2" tag="Language"/>
					<WTTEXT col="2" value="ATTR(Page.Language)" prespace="false"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="equal" value="SYSCON(PAGETYPE-TRAINING)"/>
					<WTROW>
						<WTSTATIC col="1" tag="Description" align="left" />
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Page.Fields)" rows="4" cols="72" />
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>

				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" cols="90" rows="30" htmleditor="true" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Page.PageType)" oper="not-equal" value="SYSCON(PAGETYPE-TRAINING)"/>
					<WTCONDITION expr="ATTR(Page.CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Page.MemberID)" oper="equal" value="CONST(0)" connector="and"/>

					<WTROW margin-top="12">
						<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
					</WTROW>

					<WTROW margin-top="12">
						<WTSTATIC col="1" tag="Form"/>
						<WTCOMBO col="2" value="ATTR(Page.Form)"/>
						<WTCHECK col="2" value="ATTR(Page.IsPrivate)"/>
					</WTROW>
					<WTROW>
						<WTIMAGE col="1" value="CONST(LearnMore.gif)" valign="top">
							<WTLINK name="Page" target="Help">
								<WTPARAM name="Page" value="CONST(FormFields)"/>
							</WTLINK>
						</WTIMAGE>
						<WTSTATIC col="1" tag="Fields"/>
						<WTMEMO col="2" align="left" value="ATTR(Page.Fields)" cols="50" rows="15"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9304" caption="ResourceCenter" contentpage="true" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ParentType" datatype="number"/>
			<WTPARAM name="ParentID" datatype="number"/>
			<WTPARAM name="Edit" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="GrpCompanyID" datatype="number"/> <!-- CompanyID for Group Admin -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(GrpCompanyID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(GrpCompanyID)" value="SYS(CompanyID)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)"/>
					<WTGETCACHE name="CONST(tmpGroupID)" value="GROUPID"/>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="CONST(tmpGroupID)">
						<WTCONDITION expr="CONST(CSTR(reqSysMemberID))" oper="equal" value="CONST(tmpGroupID)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(ParentType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="PARAM(MemberID)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(ParentType)" value="ENTITY(Company)"/>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="PARAM(CompanyID)"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" class="PageHeading" fontsize="4">
						<WTCODEGROUP>
							<WTIMAGE valign="center" value="CONST(Resource.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="2"/>
						<WTSTATIC label="ResourceCenter"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" label="ResourceText" class="prompt"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
					<WTCONDITION expr="_IsSuccessTracks" connector="or"/>
					<WTTABLE col="1">
						<WTCOLUMN width="100" align="center"/>
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="100" align="center"/>

						<WTROW>
							<WTSTATIC col="1"/>
							<WTIMAGE col="2" value="CONST(MemberSuccessTrack.gif)">
								<WTLINK name="7014">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="Template" value="CONST(1)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(CustomerSuccessTrack.gif)">
								<WTLINK name="7014">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="Template" value="CONST(2)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTIMAGE>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="MemberSuccessTracks" bold="true">
								<WTLINK name="7014">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="Template" value="CONST(1)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="3" label="CustomerSuccessTracks" bold="true">
								<WTLINK name="7014">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="Template" value="CONST(2)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="24">
					<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
					<WTCONDITION expr="_IsEmailTemplates" connector="or"/>
					<WTTABLE col="1">
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="200" align="center"/>

						<WTROW>
							<WTIMAGE col="1" value="CONST(LeadEmailTemplate.gif)">
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(PresentationEmailTemplate.gif)">
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(ProspectEmailTemplate.gif)">
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTIMAGE>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="LeadEmailTemplates" bold="true">
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" label="PresentationEmailTemplates" bold="true">
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="3" label="ProspectEmailTemplates" bold="true">
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="24">
					<WTTABLE col="1">
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="200" align="center"/>

						<WTROW>
							<WTIMAGE col="1" value="CONST(InfoPages.gif)">
								<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="_IsInfoPages" connector="or"/>
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-INFO)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(Documents.gif)">
								<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="_IsDocuments" connector="or"/>
								<WTLINK name="8017" target="upload">
									<WTPARAM name="ParentType" value="PARAM(ParentType)"/>
									<WTPARAM name="ParentID" value="PARAM(ParentID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(Newspaper.gif)">
								<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="_IsPublishNewsletter" connector="or"/>
								<WTLINK name="1811">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTIMAGE>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="InfoPages" bold="true">
								<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="_IsInfoPages" connector="or"/>
								<WTLINK name="9301">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="PageType" value="SYSCON(PAGETYPE-INFO)"/>
									<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" label="UploadedDocuments" bold="true">
								<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="_IsDocuments" connector="or"/>
								<WTLINK name="8017" target="upload">
									<WTPARAM name="ParentType" value="PARAM(ParentType)"/>
									<WTPARAM name="ParentID" value="PARAM(ParentID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="3" label="PublishNewletters" bold="true">
								<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="_IsPublishNewsletter" connector="or"/>
								<WTLINK name="1811">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
						<WTCONDITION expr="_IsGrpMembers" connector="or"/>
						<WTCONDITION expr="_IsGrpOptions" connector="or"/>
						<WTCONDITION expr="_IsGrpSalesCampaign" connector="or"/>
						<WTCONDITION expr="_IsGrpLeadPage" connector="or"/>
						<WTCONDITION expr="_IsGrpPresentation" connector="or"/>
						<WTROW margin-top="24">
							<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-top="12">
							<WTSTATIC col="1" label="GrpAdmin" class="PageHeading" align="center"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="center" class="prompt">
								<WTSTATIC value="PARAM(GroupID)" space="1" fontcolor="blue" bold="true"/>
								<WTSTATIC label="GrpAdminText"/>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-top="12">
							<WTTABLE col="1">
								<WTCOLUMN width="120" align="center"/>
								<WTCOLUMN width="120" align="center"/>
								<WTCOLUMN width="120" align="center"/>
								<WTCOLUMN width="120" align="center"/>
								<WTCOLUMN width="120" align="center"/>

								<WTROW>
									<WTIMAGE col="1" value="CONST(GroupMembers.gif)">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpMembers" connector="or"/>
										<WTLINK name="0451" target="GroupMembers">
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
										</WTLINK>
									</WTIMAGE>
									<WTIMAGE col="2" value="CONST(GroupOptions.gif)">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpOptions" connector="or"/>
										<WTLINK name="3854">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
										</WTLINK>
									</WTIMAGE>
									<WTIMAGE col="3" value="CONST(Lead Pages.gif)">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpLeadPage" connector="or"/>
										<WTLINK name="1411">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
											<WTPARAM name="PageType" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
									<WTIMAGE col="4" value="CONST(Presentation Sites.gif)">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpPresentation" connector="or"/>
										<WTLINK name="1411">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
											<WTPARAM name="PageType" value="CONST(2)"/>
										</WTLINK>
									</WTIMAGE>
									<WTIMAGE col="5" value="CONST(SalesCampaign.gif)">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpSalesCampaign" connector="or"/>
										<WTLINK name="7711">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" label="GrpMembers" bold="true">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpMembers" connector="or"/>
										<WTLINK name="0451">
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="2" label="CoBrand" bold="true">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpOptions" connector="or"/>
										<WTLINK name="3854">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="3" label="LeadPages" bold="true">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpLeadPage" connector="or"/>
										<WTLINK name="1411">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
											<WTPARAM name="PageType" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="4" label="Presentations" bold="true">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpPresentation" connector="or"/>
										<WTLINK name="1411">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
											<WTPARAM name="PageType" value="CONST(2)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="5" label="SalesCampaigns" bold="true">
										<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="_IsGrpSalesCampaign" connector="or"/>
										<WTLINK name="7711">
											<WTPARAM name="CompanyID" value="PARAM(GrpCompanyID)"/>
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-top="12">
							<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-top="24" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>

				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9311" caption="List" navbar="false" header="false" footer="false"  
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ProspectID" datatype="number"/>
			<WTPARAM name="Form" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Form)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(Form)" value="SYSCON(FORM-PROSPECT)">
						<WTCONDITION expr="PARAM(ProspectID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Form)" value="SYSCON(FORM-MEMBER)">
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="ListForm">
						<WTCONDITION expr="NotMemberOnly"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Form" direction="input" value="PARAM(Form)"/>
					</WTMETHOD>
					<WTMETHOD name="ListFormPublic">
						<WTCONDITION expr="IsMemberOnly"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Form" direction="input" value="PARAM(Form)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPages" direction="return" concat="true" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>
				<WTCOLUMN width="300" align="right"/>

				<WTROW>
					<WTSTATIC col="1" label="Forms" class="PageHeading" align="left"/>
					<WTSTATIC col="2" align="left" label="FormText" class="Prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Page">
						<WTCOLUMN width="20" align="left" valign="top" label="Category"/>
						<WTCOLUMN width="80" align="left" valign="top" label="PageName"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Page.Category)"/>
							<WTSTATIC col="2" value="DATA(Page.PageName)">
								<WTLINK name="PF" target="Form">
									<WTPARAM name="P" value="DATA(Page.PageID)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="ProspectID" value="PARAM(ProspectID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
    <WTWEBPAGE name="p" caption="Info Page" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="P" datatype="number"/>
			<WTPARAM name="L" datatype="text"/>
			<WTPARAM name="NC" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(L)" value="SYS(language)"/>
				</WTCODEGROUP>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqP &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Pages\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(L)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NC)" oper="equal" value="CONST(0)"/>
					<WTSTATIC newline="2" />
					<WTBUTTON value="CONST(CloseWindow)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--==================================================================-->
		<WTWEBPAGE name="PF" caption="Page Form" page-left="5" page-top="5" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="P" datatype="number"/>
			<WTPARAM name="L" datatype="text"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ProspectID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTMETHOD name="Load">
						<WTPARAM name="PageID" direction="input" value="PARAM(P)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpFields)" value="ATTR(Fields)"/>
					<WTSETATTRIBUTE name="CONST(tmpLang)" value="ATTR(Language)"/>
					<WTSETATTRIBUTE name="CONST(tmpLang)" value="PARAM(L)">
						<WTCONDITION expr="PARAM(L)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqP &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Pages\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(tmpLang)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
<WTCUSTOM>
	'Create all the objects
	Set oProspect = server.CreateObject("ptsProspectUser.CProspect")
	Set oMember = server.CreateObject("ptsMemberUser.CMember")
	Set oProspectOptions = server.CreateObject("wtSystem.CInputOptions")
	Set oMemberOptions = server.CreateObject("wtSystem.CInputOptions")

	ProspectOptionTotal = 0
	MemberOptionTotal = 0
	
	'If we have a prospect, load the prospect and its extra data
	If reqProspectID &lt;&gt; 0 Then
		With oProspect
			.SysCurrentLanguage = reqSysLanguage
			.Load CLng(reqProspectID), 1
			If reqMemberID = 0 Then reqMemberID = .MemberID 
			tmpProspectTypeID = .ProspectTypeID
			tmpInputValues = .InputValues
		End With
		'load the prospects extra data from its prospect type
		If tmpProspectTypeID &lt;&gt; 0 Then
			Set oProspectType = server.CreateObject("ptsProspectTypeUser.CProspectType")
			With oProspectType
				.SysCurrentLanguage = reqSysLanguage
				.Load tmpProspectTypeID, 1
				If .InputOptions  &lt;&gt; "" Then
					oProspectOptions.Load .InputOptions, tmpInputValues
					ProspectOptionTotal = oProspectOptions.Count
				End If
			End With
			Set oProspectType = Nothing
		End If
	End If

	'If we have a member, load the member and its extra data
	If reqMemberID &lt;&gt; 0 Then
		With oMember
			.SysCurrentLanguage = reqSysLanguage
			.Load CLng(reqMemberID), 1
			tmpCompanyID = .CompanyID
			tmpInputValues = .InputValues
		End With
		'load the members extra data from its company
		If tmpCompanyID &lt;&gt; 0 Then
			Set oCoption = server.CreateObject("ptsCoptionUser.CCoption")
			If oCoption Is Nothing Then
				DoError Err.Number, Err.Source, "Unable to Create Object - ptsCoptionUser.CCoption"
			Else
				With oCoption
					.SysCurrentLanguage = reqSysLanguage
					.FetchCompany CLng(tmpCompanyID)
					.Load .CoptionID, 1
					If .InputOptions  &lt;&gt; "" Then
						oMemberOptions.Load .InputOptions, tmpInputValues
						MemberOptionTotal = oMemberOptions.Count
					End If
				End With
			End If
			Set oCoption = Nothing
		End If
	End If

	'create an array of all the field definitions for this form
	aFields = Split(tmpFields, VBCrLf)
	reqTotal = UBOUND(aFields)
	'walk through the list of field definitions
	For x = 0 to reqTotal
		'If the field definition includes an equal sign, process it
		If InStr( aFields(x), "=" ) &gt; 0 Then
			'Get the field name and the data reference
			aField = Split(aFields(x), "=")
			tmpName = aField(0)
			tmpData = aField(1)
			tmpValue = ""

			'Get the data reference parts (Member.NameLast)
			aData = Split(tmpData, ".")
			'Process The Entity part of the data reference
			Select Case UCase(aData(0))
				Case "MEMBER"
					'Get the Member data by examining the Field part of the data reference
					With oMember
						Select Case UCase(aData(1))
							Case "COMPANYNAME": tmpValue = .CompanyName
							Case "NAMELAST": tmpValue = .NameLast
							Case "NAMEFIRST": tmpValue = .NameFirst
							Case "STREET": tmpValue = .Street
							Case "UNIT": tmpValue = .Unit
							Case "CITY": tmpValue = .City
							Case "STATE": tmpValue = .State
							Case "ZIP": tmpValue = .Zip
							Case "COUNTRY": tmpValue = .Country
							Case "EMAIL": tmpValue = .Email
							Case "PHONE1": tmpValue = .Phone1
							Case "PHONE2": tmpValue = .Phone2
							Case "FAX": tmpValue = .Fax
							Case "REFERENCE": tmpValue = .Reference
							Case "VISITDATE": tmpValue = .VisitDate
							Case "GRP": tmpValue = .GroupID
							Case "ROLE": tmpValue = .Role
							Case "SIGNATURE": tmpValue = .Signature
							Case "TITLE": tmpValue = .Title
							Case "EXTRA"
								'Look in the Members extra data for the specified field (Member.Extra.DOB)
								tmpExtra = UCase(aData(2))
								If MemberOptionTotal &gt; 0 Then
									With oMemberOptions
										For z = 1 To MemberOptionTotal
											If tmpExtra = UCase(.Item(z).Name) Then
												tmpValue = .Item(z).Value
												Exit For
											End If	
										Next
									End With
								End If
 						End Select
					End With
				
				Case "PROSPECT"
					'Get the Prospect data by examining the Field part of the data reference
					With oProspect
						Select Case UCase(aData(1))
							Case "PROSPECTNAME": tmpValue = .ProspectName
							Case "SALESCAMPAIGN": tmpValue = .SalesCampaignName
							Case "PROSPECTTYPE": tmpValue = .ProspectTypeName
							Case "WEBSITE": tmpValue = .Website
							Case "DESCRIPTION": tmpValue = .Description
							Case "REPRESENTING": tmpValue = .Representing
							Case "POTENTIAL": tmpValue = .Potential
							Case "NAMELAST": tmpValue = .NameLast
							Case "NAMEFIRST": tmpValue = .NameFirst
							Case "TITLE": tmpValue = .TitleID
							Case "EMAIL": tmpValue = .Email
							Case "PHONE1": tmpValue = .Phone1
							Case "PHONE2": tmpValue = .Phone2
							Case "STREET": tmpValue = .Street
							Case "UNIT": tmpValue = .Unit
							Case "CITY": tmpValue = .City
							Case "STATE": tmpValue = .State
							Case "ZIP": tmpValue = .Zip
							Case "COUNTRY": tmpValue = .Country
							Case "STATUS": tmpValue = .Status
							Case "PRIORITY": tmpValue = .Priority
							Case "NEXTEVENT": tmpValue = .NextEvent
							Case "NEXTDATE": tmpValue = .NextDate
							Case "NEXTTIME": tmpValue = .NextTime
							Case "CREATEDATE": tmpValue = .CreateDate
							Case "CLOSEDATE": tmpValue = .CloseDate
							Case "FBDATE": tmpValue = .FBDate
							Case "DEADDATE": tmpValue = .DeadDate
							Case "DATE1": tmpValue = .Date1
							Case "DATE2": tmpValue = .Date2
							Case "DATE3": tmpValue = .Date3
							Case "DATE4": tmpValue = .Date4
							Case "DATE5": tmpValue = .Date5
							Case "DATE6": tmpValue = .Date6
							Case "DATE7": tmpValue = .Date7
							Case "DATE8": tmpValue = .Date8
							Case "DATE9": tmpValue = .Date9
							Case "DATE10": tmpValue = .Date10
							Case "EXTRA"
								'Look in the Prospects extra data for the specified field (Prospect.Extra.DOB)
								tmpExtra = UCase(aData(2))
								If ProspectOptionTotal &gt; 0 Then
									With oProspectOptions
										For z = 1 To ProspectOptionTotal
											If tmpExtra = UCase(.Item(z).Name) Then
												tmpValue = .Item(z).Value
												Exit For
											End If	
										Next
									End With
								End If
 						End Select
					End With

			End Select
		End If
    Next
	
	Set oProspect = Nothing
	Set oMember = Nothing
	Set oProspectOptions = Nothing
	Set oMemberOptions = Nothing

</WTCUSTOM>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9305" caption="Email Templates" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="PageType" datatype="number"/>
			<WTPARAM name="Category" datatype="number"/>
			<WTPARAM name="TList" datatype="number"/>
			<WTPARAM name="TMemberID" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="CONST(tmpTList)" value="FORM(TList)"/>
				<WTSETATTRIBUTE name="PARAM(TList)" value="CONST(tmpTList)">
					<WTCONDITION expr="CONST(tmpTList)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="EnumCompany">
						<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Category)" oper="equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="PageType" direction="input" value="PARAM(PageType)"/>
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumCompanyCategory">
						<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Category)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="PageType" direction="input" value="PARAM(PageType)"/>
						<WTPARAM name="Category" direction="input" value="PARAM(Category)"/>
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumMember">
						<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="PageType" direction="input" value="PARAM(PageType)"/>
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumMember">
						<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(TMemberID)"/>
						<WTPARAM name="PageType" direction="input" value="PARAM(PageType)"/>
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(TMemberID)" value="ATTR(GroupID)"/>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>

				<WTROW>
					<WTSTATIC col="1" class="PageHeading" align="left">
						<WTSTATIC label="LeadEmailTemplates">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-LEAD)"/>
						</WTSTATIC>
						<WTSTATIC label="PresentationEmailTemplates">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PRESENTATION)"/>
						</WTSTATIC>
						<WTSTATIC label="ProspectEmailTemplates">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-PROSPECT)"/>
						</WTSTATIC>
						<WTSTATIC label="ContactEmailTemplates">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CONTACT)"/>
						</WTSTATIC>
						<WTSTATIC label="CustomerEmailTemplates">
							<WTCONDITION expr="PARAM(PageType)" oper="equal" value="SYSCON(PAGETYPE-EMAIL-CUSTOMER)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="SelectTemplates" align="center" bold="true"/>
				</WTROW>

				<WTROW margin-bottom="6">
				 	<WTRADIO col="1" group="TList" name="0" align="center" check="/DATA/PARAM/@tlist=0">
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTRADIO>
					<WTSTATIC col="1" label="CompanySelect" prespace="false"/>
				 	<WTRADIO col="1" group="TList" name="1" check="/DATA/PARAM/@tlist=1">
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTRADIO>
					<WTSTATIC col="1" label="MemberSelect" prespace="false"/>
				 	<WTRADIO col="1" group="TList" name="2" check="/DATA/PARAM/@tlist=2">
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTRADIO>
					<WTSTATIC col="1" label="TMemberSelect" prespace="false"/>
					<WTTEXT col="1" value="PARAM(TMemberID)" size="3"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTSTATIC label="SelectFrom" space="1"/>
						<WTSTATIC label="CompanyTemplates">
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="MemberTemplates">
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(TList)" oper="equal" value="CONST(2)"/>
							<WTSTATIC label="TMemberTemplates"/>
							<WTSTATIC value="PARAM(TMemberID)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPAGES/ENUM))" oper="not-equal" value="CONST(1)" />
					<WTSTATIC col="1" tag="EmailTemplate" align="center"/>
					<WTCOMBO col="1" value="CONST(0)" datapath="/DATA/TXN/PTSPAGES/ENUM" prespace="false">
						<WTCHANGE>
							var t;
							t = this.value;
							if (t &gt; 0 ) {
								window.opener.document.forms[0].TemplateID.value = t; 
								window.opener.doSubmit(0,"");
								window.close();
							}
						</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPAGES/ENUM))" oper="equal" value="CONST(1)" />
					<WTSTATIC col="1" label="NoTemplates" fontcolor="red" bold="true" align="center"/>
				</WTROW>
<!--
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(CloseWindow)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
-->
			</WTCONTENT>

		</WTWEBPAGE>

	    <!--============================================================================================-->
		<WTWEBPAGE name="9310" action="5" page-width="380" page-left="10" margin-width="0" navbar="false" header="false" footer="false" 
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Path" datatype="text"/>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(PageName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
<WTCODEGROUP>
<WTCUSTOM>
	reqPath = "http://" + reqSysServerName + reqSysServerPath + "p.asp?nc=1&amp;p="
</WTCUSTOM>
</WTCODEGROUP>
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
				<WTMETHOD name="FindCompany">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="PageType" direction="input" value="SYSCON(PAGETYPE-INFO)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
<WTCUSTOM>
				For Each oItem In oPages
					With oItem
						pos = InStr(.PageName, "'")
						If pos &gt; 0 Then .PageName = Replace(.PageName, "'","")
					End With
				Next
</WTCUSTOM>
				
				<WTMETHOD name="XML">
					<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="380" align="left"/>

				<WTFUNCTION name="SelectPage(id,nam)">
					window.opener.News.Title.value = nam; 
					window.opener.News.Link.value = document.getElementById('Path').value + id; 
					window.close();
			    </WTFUNCTION>  
				<WTROW>
					<WTHIDDEN value="PARAM(Path)"/>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" label="SelectRSSPage" class="prompt" align="left"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Search" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Pages.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Page">
						<WTCOLUMN width="95" align="left" label="PageName"/>
						<WTCOLUMN width="5" align="center"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Page.Status)" oper="not-equal" value="CONST(1)"/>
									<WTIMAGE value="CONST(redx.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Page.PageName)" bold="true" space="2">
									<WTLINK click="true" name="CONST(SelectPage(&lt;xsl:value-of select=&quot;@pageid&quot;/&gt;,'&lt;xsl:value-of select=&quot;@pagename&quot;/&gt;'))"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Page.Category)" fontcolor="purple" space="2"/>
								<WTSTATIC value="DATA(Page.Language)" fontcolor="darkgreen"/>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="P" target="Preview">
											<WTPARAM name="P" value="DATA(Page.PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9312" caption="Pages" header="false" footer="false" navbar="false" wrapper="wrapper800"
			   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="PageType" datatype="number"/>

			<WTINCLUDE name="Resources.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(PageType)" value="SYSCON(PAGETYPE-TRAINING)">
					<WTCONDITION expr="PARAM(PageType)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<!-- Get The Group, Shared or Company Resources -->
				<WTGETCACHE name="CONST(tmpGroupID)" value="GROUPID"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID)" value="CONST(0)">
					<WTCONDITION expr="CONST(tmpGroupID)" oper="equal" value="CONST(&quot;&quot;)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpResource)" value="SYSCON(RESOURCE-TRAINING)"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID1)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID2)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID3)" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NotMemberOnly" />
					<WTSETATTRIBUTE name="CONST(tmpGroupID)" value="PARAM(MemberID)"/>
					<WTCALLSUB name="GetResources tmpGroupID"/>
				</WTCODEGROUP>
				<WTCALLSUB name="GetResource tmpResource, tmpGroupID1, tmpGroupID2, tmpGroupID3">
					<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTitle)" value="ATTR(Title)"/>
				</WTOBJECT>
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="ListPage">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpGroupID)" />
						<WTPARAM name="GroupID1" direction="input" value="CONST(tmpGroupID1)" />
						<WTPARAM name="GroupID2" direction="input" value="CONST(tmpGroupID2)" />
						<WTPARAM name="GroupID3" direction="input" value="CONST(tmpGroupID3)" />
						<WTPARAM name="PageType" direction="input" value="PARAM(PageType)" />
					</WTMETHOD>
					<WTCUSTOM>
						Category = ""
						For Each oItem in oPages
							With oItem
								If .Category = Category Then .Category = "" Else Category = .Category
							End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPages" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN />
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left" />
				<WTCOLUMN width="400" align="right" />

				<WTROW>
					<WTSTATIC col="1" merge="2" label="TrainingPages" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="TrainingPagesText" class="prompt" align="left"/>
				</WTROW>

				<!-- Training Page Image is in Subject, Description is in Fields -->
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Page">
						<WTCOLUMN width="25" align="left" valign="top"/>
						<WTCOLUMN width="65" align="left" valign="top"/>
						<WTCOLUMN width="10" align="center" valign="top"/>
						<WTCODEGROUP>
							<WTCONDITION expr="DATA(Category)" oper="not-equal" value="CONST('')"/>
							<WTROW height="30" margin-top="3" margin-bottom="3">
								<WTSTATIC col="1" merge="3" value="DATA(Category)" bold="true" align="center" backcolor="#7c8a9c" fontsize="3" fontcolor="white"/>
							</WTROW>
						</WTCODEGROUP>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Subject)" oper="not-equal" value="CONST('')" />
									<WTIMAGE value="DATA(Subject)" align="left" imgalign="absmiddle" imgwidth="190" path="Page">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTSTATIC value="DATA(Page.PageName)" space="1" bold="true">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Fields)" oper="not-equal" value="CONST('')" />
									<WTSTATIC newline="1" />
									<WTSTATIC value="DATA(Fields)" fontcolor="gray" />
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview32.gif)" alt="Preview">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_9312" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="PageType" datatype="number"/>

			<WTINCLUDE name="Resources.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(PageType)" value="SYSCON(PAGETYPE-TRAINING)">
					<WTCONDITION expr="PARAM(PageType)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<!-- Get The Group, Shared or Company Resources -->
				<WTGETCACHE name="CONST(tmpGroupID)" value="GROUPID"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID)" value="CONST(0)">
					<WTCONDITION expr="CONST(tmpGroupID)" oper="equal" value="CONST(&quot;&quot;)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpResource)" value="SYSCON(RESOURCE-TRAINING)"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID1)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID2)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpGroupID3)" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NotMemberOnly" />
					<WTSETATTRIBUTE name="CONST(tmpGroupID)" value="PARAM(MemberID)"/>
					<WTCALLSUB name="GetResources tmpGroupID"/>
				</WTCODEGROUP>
				<WTCALLSUB name="GetResource tmpResource, tmpGroupID1, tmpGroupID2, tmpGroupID3">
					<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTitle)" value="ATTR(Title)"/>
				</WTOBJECT>
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="ListPage">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpGroupID)" />
						<WTPARAM name="GroupID1" direction="input" value="CONST(tmpGroupID1)" />
						<WTPARAM name="GroupID2" direction="input" value="CONST(tmpGroupID2)" />
						<WTPARAM name="GroupID3" direction="input" value="CONST(tmpGroupID3)" />
						<WTPARAM name="PageType" direction="input" value="PARAM(PageType)" />
					</WTMETHOD>
					<WTCUSTOM>
						Category = ""
						For Each oItem in oPages
							With oItem
								If .Category = Category Then .Category = "" Else Category = .Category
							End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPages" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN />
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left" />

				<WTLOAD>
					window.location.hash = 'top';
				</WTLOAD>

				<WTROW margin-bottom="2">
					<WTSTATIC col="1" label="TrainingPages" class="prompt" align="center"/>
				</WTROW>

				<!-- Training Page Image is in Subject, Description is in Fields -->
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Page">
						<WTCOLUMN width="40" align="left" valign="top"/>
						<WTCOLUMN width="60" align="left" valign="top"/>
						<WTCODEGROUP>
							<WTCONDITION expr="DATA(Category)" oper="not-equal" value="CONST('')"/>
							<WTROW height="30" margin-top="3" margin-bottom="3">
								<WTSTATIC col="1" merge="2" value="DATA(Category)" bold="true" align="center" backcolor="#7c8a9c" fontsize="3" fontcolor="white"/>
							</WTROW>
						</WTCODEGROUP>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Subject)" oper="not-equal" value="CONST('')" />
									<WTIMAGE value="DATA(Subject)" align="left" imgalign="absmiddle" imgwidth="110" path="Page">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(preview24.gif)" alt="Preview" imgalign="absmiddle">
											<WTLINK name="p" class="PageHeadingLink" target="training">
												<WTPARAM name="p" value="DATA(PageID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC newline="1"/>
									<WTSTATIC value="DATA(Page.PageName)" bold="true">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" value="DATA(Fields)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9313" caption="Training Pages" action="5" header="false" footer="false" navbar="false" wrapper="wrapper800"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" focus="false" track="0">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="IsSearch" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="GroupID1" datatype="number"/>
			<WTPARAM name="GroupID2" datatype="number"/>
			<WTPARAM name="GroupID3" datatype="number"/>
			<WTPARAM name="CategoryID" datatype="number"/>
			<WTPARAM name="PageType" datatype="number"/>
			<WTPARAM name="Category" datatype="text"/>

			<WTINCLUDE name="Search.asp" />
			<WTINCLUDE name="Resources.asp"/>

			<WTDATATXN name="Categorys"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(PageType)" value="SYSCON(PAGETYPE-TRAINING)">
					<WTCONDITION expr="PARAM(PageType)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadCategories">
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="EnumPageCategory">
						<WTPARAM name="xmlCategorys" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(GroupID)"/>
						<WTPARAM name="GroupID1" direction="input" value="PARAM(GroupID1)"/>
						<WTPARAM name="GroupID2" direction="input" value="PARAM(GroupID2)"/>
						<WTPARAM name="GroupID3" direction="input" value="PARAM(GroupID3)"/>
						<WTPARAM name="PageType" direction="input" value="SYSCON(PAGETYPE-TRAINING)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(CategoryID)"/>
						<WTPARAM name="Element" direction="input" value="CONST(&quot;Category&quot;)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadPages">
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="ListPageCategory">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(GroupID)"/>
						<WTPARAM name="GroupID1" direction="input" value="PARAM(GroupID1)"/>
						<WTPARAM name="GroupID2" direction="input" value="PARAM(GroupID2)"/>
						<WTPARAM name="GroupID3" direction="input" value="PARAM(GroupID3)"/>
						<WTPARAM name="PageType" direction="input" value="SYSCON(PAGETYPE-TRAINING)"/>
						<WTPARAM name="Category" direction="input" value="PARAM(Category)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>

				<!-- Get The Group, Shared or Company Resources -->
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID"/>
				<WTSETATTRIBUTE name="PARAM(GroupID)" value="CONST(0)">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(&quot;&quot;)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpResource)" value="SYSCON(RESOURCE-TRAINING)"/>
				<WTSETATTRIBUTE name="PARAM(GroupID1)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(GroupID2)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(GroupID3)" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NotMemberOnly" />
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="PARAM(MemberID)"/>
					<WTCALLSUB name="GetResources reqGroupID"/>
				</WTCODEGROUP>
				<WTCALLSUB name="GetResource tmpResource, reqGroupID1, reqGroupID2, reqGroupID3">
					<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>

				<WTCALLSUB name="LoadCategories"/>
				<!-- Get the first category id -->
				<WTCUSTOM>
					Set oCat = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
					oCat.loadXML xmlCategorys
					Set oItems = oCat.selectNodes("PTSCATEGORYS/ENUM")
					x = 0
					For Each oItem In oItems
						x = x + 1
						If x = 2 Then
							reqCategoryID = oItem.getAttribute("id")
							reqCategory = oItem.getAttribute("name")
							break
						End If
					Next
					Set oItems = Nothing
					Set oCat = Nothing
				</WTCUSTOM>
				<WTCALLSUB name="LoadPages">
					<WTCONDITION expr="PARAM(CategoryID)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="1" name="List" type="New">
				<WTSETATTRIBUTE name="PARAM(Category)" value="FORM(Category)"/>
				<WTCALLSUB name="LoadCategories"/>
				<WTCALLSUB name="LoadPages">
					<WTCONDITION expr="PARAM(CategoryID)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTCALLSUB name="LoadCategories"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10004" message="Oops, Please enter text to search for."/>
					<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(0)"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTCALLSUB name="LoadPageTopics"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTCALLSUB name="LoadPageTopics"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
				<WTCONDITION expr="PARAM(IsSearch)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>
					tmpSearchText = Trim(reqSearchText)
					If InStr(tmpSearchText, " " ) &gt; 0 Then
					If InStr(tmpSearchText, chr(34) ) = 0 Then tmpSearchText = chr(34) + tmpSearchText + chr(34)
					End If

					reqBookmark = .Search(reqBookmark, tmpSearchText, reqDirection, CLng(reqCompanyID), CLng(reqGroupID), CLng(reqGroupID1), CLng(reqGroupID2), CLng(reqGroupID3), 7)

					'Check for error for Noise Words only
					If Err.Number = -2147217900 Then
					Err.Number = 0
					reqSearchText = ""
					End If
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
				</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlPages" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTFUNCTION name="GetCategory()">
					var obj = document.getElementById('CategoryID');
					var cat = obj.options[obj.selectedIndex].text;
					document.getElementById('Category').value = cat;
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(GroupID)"/>
					<WTHIDDEN value="PARAM(GroupID1)"/>
					<WTHIDDEN value="PARAM(GroupID2)"/>
					<WTHIDDEN value="PARAM(GroupID3)"/>
					<WTHIDDEN value="PARAM(Category)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="SearchTraining" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="SearchTrainingText" class="prompt" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="BrowseCategory" align="center" class="ColumnHeader"/>
					<WTCOMBO col="1" value="PARAM(CategoryID)" datapath="/DATA/TXN/PTSCATEGORYS/ENUM" prespace="false" setselected="true">
						<WTCHANGE>GetCategory(); doSubmit(1,"")</WTCHANGE>
					</WTCOMBO>
					<WTTEXT col="1" value="PARAM(SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
					<WTIMAGE  col="1" value="CONST(LearnMore.gif)" imgalign="absmiddle">
						<WTLINK name="pagex" target="Help">
							<WTPARAM name="Page" value="CONST(SearchHelp)"/>
						</WTLINK>
					</WTIMAGE>
				</WTROW>

				<!-- Training Page Image is in Subject, Description is in Fields -->
				<WTROW margin-bottom="12">
					<WTCONDITION expr="PARAM(CategoryID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(SearchText)" oper="not-equal" value="CONST('')" connector="or"/>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Page">
						<WTCOLUMN width="25" align="left" valign="top"/>
						<WTCOLUMN width="65" align="left" valign="top"/>
						<WTCOLUMN width="10" align="center" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Subject)" oper="not-equal" value="CONST('')" />
									<WTIMAGE value="DATA(Subject)" align="left" imgalign="absmiddle" imgwidth="190" path="Page">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTSTATIC value="DATA(Page.PageName)" space="1" bold="true">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@category&quot;/&gt;))" fontcolor="blue"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Fields)" oper="not-equal" value="CONST('')" />
									<WTSTATIC newline="1" />
									<WTSTATIC value="DATA(Fields)" fontcolor="gray" />
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview32.gif)" alt="Preview">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_9313" caption="Training Pages" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98" track="0">
			<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="IsSearch" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="GroupID1" datatype="number"/>
			<WTPARAM name="GroupID2" datatype="number"/>
			<WTPARAM name="GroupID3" datatype="number"/>
			<WTPARAM name="CategoryID" datatype="number"/>
			<WTPARAM name="PageType" datatype="number"/>
			<WTPARAM name="Category" datatype="text"/>

			<WTINCLUDE name="Search.asp" />
			<WTINCLUDE name="Resources.asp"/>

			<WTDATATXN name="Categorys"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(PageType)" value="SYSCON(PAGETYPE-TRAINING)">
					<WTCONDITION expr="PARAM(PageType)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadCategories">
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="EnumPageCategory">
						<WTPARAM name="xmlCategorys" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(GroupID)"/>
						<WTPARAM name="GroupID1" direction="input" value="PARAM(GroupID1)"/>
						<WTPARAM name="GroupID2" direction="input" value="PARAM(GroupID2)"/>
						<WTPARAM name="GroupID3" direction="input" value="PARAM(GroupID3)"/>
						<WTPARAM name="PageType" direction="input" value="SYSCON(PAGETYPE-TRAINING)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(CategoryID)"/>
						<WTPARAM name="Element" direction="input" value="CONST(&quot;Category&quot;)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadPages">
				<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
					<WTMETHOD name="ListPageCategory">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(GroupID)"/>
						<WTPARAM name="GroupID1" direction="input" value="PARAM(GroupID1)"/>
						<WTPARAM name="GroupID2" direction="input" value="PARAM(GroupID2)"/>
						<WTPARAM name="GroupID3" direction="input" value="PARAM(GroupID3)"/>
						<WTPARAM name="PageType" direction="input" value="SYSCON(PAGETYPE-TRAINING)"/>
						<WTPARAM name="Category" direction="input" value="PARAM(Category)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPages" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>

				<!-- Get The Group, Shared or Company Resources -->
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID"/>
				<WTSETATTRIBUTE name="PARAM(GroupID)" value="CONST(0)">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(&quot;&quot;)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpResource)" value="SYSCON(RESOURCE-TRAINING)"/>
				<WTSETATTRIBUTE name="PARAM(GroupID1)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(GroupID2)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(GroupID3)" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NotMemberOnly" />
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="PARAM(MemberID)"/>
					<WTCALLSUB name="GetResources reqGroupID"/>
				</WTCODEGROUP>
				<WTCALLSUB name="GetResource tmpResource, reqGroupID1, reqGroupID2, reqGroupID3">
					<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)" />
				</WTCALLSUB>

				<WTCALLSUB name="LoadCategories"/>
				<!-- Get the first category id -->
				<WTCUSTOM>
					Set oCat = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
					oCat.loadXML xmlCategorys
					Set oItems = oCat.selectNodes("PTSCATEGORYS/ENUM")
					x = 0
					For Each oItem In oItems
					x = x + 1
					If x = 2 Then
					reqCategoryID = oItem.getAttribute("id")
					reqCategory = oItem.getAttribute("name")
					break
					End If
					Next
					Set oItems = Nothing
					Set oCat = Nothing
				</WTCUSTOM>
				<WTCALLSUB name="LoadPages">
					<WTCONDITION expr="PARAM(CategoryID)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="1" name="List" type="New">
				<WTSETATTRIBUTE name="PARAM(Category)" value="FORM(Category)"/>
				<WTCALLSUB name="LoadCategories"/>
				<WTCALLSUB name="LoadPages">
					<WTCONDITION expr="PARAM(CategoryID)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTCALLSUB name="LoadCategories"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10004" message="Oops, Please enter text to search for."/>
					<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(0)"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTCALLSUB name="LoadPageTopics"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTCALLSUB name="LoadPageTopics"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Pages" project="ptsPageUser" class="CPages">
				<WTCONDITION expr="PARAM(IsSearch)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>
					tmpSearchText = Trim(reqSearchText)
					If InStr(tmpSearchText, " " ) &gt; 0 Then
					If InStr(tmpSearchText, chr(34) ) = 0 Then tmpSearchText = chr(34) + tmpSearchText + chr(34)
					End If

					reqBookmark = .Search(reqBookmark, tmpSearchText, reqDirection, CLng(reqCompanyID), CLng(reqGroupID), CLng(reqGroupID1), CLng(reqGroupID2), CLng(reqGroupID3), 7)

					'Check for error for Noise Words only
					If Err.Number = -2147217900 Then
					Err.Number = 0
					reqSearchText = ""
					End If
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
				</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlPages" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left" />

				<WTFUNCTION name="GetCategory()">
					var obj = document.getElementById('CategoryID');
					var cat = obj.options[obj.selectedIndex].text;
					document.getElementById('Category').value = cat;
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(GroupID)"/>
					<WTHIDDEN value="PARAM(GroupID1)"/>
					<WTHIDDEN value="PARAM(GroupID2)"/>
					<WTHIDDEN value="PARAM(GroupID3)"/>
					<WTHIDDEN value="PARAM(Category)"/>
				</WTROW>

				<WTLOAD>
					window.location.hash = 'top';
				</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="SearchTraining" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="SearchTrainingText" class="prompt" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="BrowseCategory" align="center" class="ColumnHeader"/>
					<WTCOMBO col="1" value="PARAM(CategoryID)" datapath="/DATA/TXN/PTSCATEGORYS/ENUM" prespace="false" setselected="true">
						<WTCHANGE>GetCategory(); doSubmit(1,"")</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTTEXT col="1" value="PARAM(SearchText)" align="center" size="15" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
					<WTIMAGE  col="1" value="CONST(LearnMore.gif)" imgalign="absmiddle">
						<WTLINK name="pagex" target="Help">
							<WTPARAM name="Page" value="CONST(SearchHelp)"/>
						</WTLINK>
					</WTIMAGE>
				</WTROW>

				<!-- Training Page Image is in Subject, Description is in Fields -->
				<WTROW margin-bottom="12">
					<WTCONDITION expr="PARAM(CategoryID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(SearchText)" oper="not-equal" value="CONST('')" connector="or"/>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Page">
						<WTCOLUMN width="40" align="left" valign="top"/>
						<WTCOLUMN width="60" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Subject)" oper="not-equal" value="CONST('')" />
									<WTIMAGE value="DATA(Subject)" align="left" imgalign="absmiddle" imgwidth="110" path="Page">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(preview24.gif)" alt="Preview" imgalign="absmiddle">
											<WTLINK name="p" class="PageHeadingLink" target="training">
												<WTPARAM name="p" value="DATA(PageID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC newline="1"/>
									<WTSTATIC value="DATA(Page.PageName)" bold="true">
										<WTLINK name="p" class="PageHeadingLink" target="training">
											<WTPARAM name="p" value="DATA(PageID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@category&quot;/&gt;))" fontcolor="blue"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" value="DATA(Fields)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="9320" caption="Upload File" action="false" submit="9320Upload.asp" type="multi" 
			navbar="false" header="false" footer="false" page-left="0" margin="false" 
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="PageID" datatype="number"/>
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			<WTPARAM name="FileName" datatype="text"/>
			<WTPARAM name="Status" datatype="number"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>DoError reqUploadError, "Upload", reqUploadErrorDesc</WTCUSTOM>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Page" project="ptsPageUser" class="CPage">
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PageID" direction="input" value="PARAM(PageID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpLang)" value="ATTR(Language)"/>
					<WTCUSTOM>If Len(reqFileName) = 0 Then reqFileName = CSTR(reqPageID) + "[" + tmpLang + "]"</WTCUSTOM>			
					<WTSETCACHE name="FILENAME" value="PARAM(FileName)"/>
				</WTOBJECT>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" label="UploadPage" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(FileName)" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" label="UploadPageText" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="18">
						<WTFILE col="1" align="center" value="upload" accept="*.htm" size="30"/>
						<WTBUTTON col="1" align="center" default="true" action="1" value="CONST(Submit)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(1)"/>
					<WTROW margin-top="36" margin-bottom="12">
						<WTSTATIC col="1" label="UploadPageSuccessful" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="24">
						<WTSTATIC col="1" value="PARAM(FileName)" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW>
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--**************************************Image Upload Page**************************************-->
		<!--===========================================================================================-->
		<WTWEBPAGE name="9321" caption="Upload File" action="false" header="false" footer="false" navbar="false" wrapper="wrapper600"
		   submit="9321Upload.asp" type="multi" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--===========================================================================================-->
			<WTPARAM name="PageID" datatype="number"/>
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>
					DoError reqUploadError, "Upload", reqUploadErrorDesc
				</WTCUSTOM>
			</WTCODEGROUP>
			<WTACTION id="0" name="New" type="New">
				<WTSETCACHE name="PAGEID" value="PARAM(PageID)"/>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="150" align="left"/>

				<WTROW margin-top="19">
					<WTSTATIC col="1" merge="3" label="UploadImageHeader" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="3" label="UploadImageText" class="Prompt"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTFILE col="2" align="center" value="upload" accept="*.gif, *.jpg, *.png"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" align="center" default="true" value="CONST(Submit)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>