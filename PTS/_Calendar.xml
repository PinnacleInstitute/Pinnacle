<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="47" name="Calendar" alias="cal" audit="false">
		<!--Identity-->
		<WTATTRIBUTE id="4701" name="CalendarID" type="number" identity="true" min="1" source="entity" />
		<!--Foreign Keys-->
		<WTATTRIBUTE id="4702" name="CompanyID" type="number" source="entity" />
		<WTATTRIBUTE id="4703" name="MemberID" type="number" source="entity" />
		<!--Foreign Table Fields-->
		<!--Attributes-->
		<WTATTRIBUTE id="4705" name="CalendarName" type="text" length="60" min="1" max="60" source="entity" title="true" required="true" />
		<WTATTRIBUTE id="4706" name="Description" type="text" length="500" min="1" max="500" source="entity" />
		<WTATTRIBUTE id="4707" name="Layout" type="number" source="entity">
			<WTENUM id="1" name="Day" />
			<WTENUM id="2" name="Week" />
			<WTENUM id="3" name="Month" />
			<WTENUM id="4" name="List" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="4708" name="IsPrivate" type="yesno" source="entity" />
		<WTATTRIBUTE id="4709" name="IsAppt" type="yesno" source="entity" />
		<WTATTRIBUTE id="4710" name="IsClass" type="yesno" source="entity" />
		<WTATTRIBUTE id="4711" name="IsAssess" type="yesno" source="entity" />
		<WTATTRIBUTE id="4713" name="IsGoal" type="yesno" source="entity" />
		<WTATTRIBUTE id="4714" name="IsProject" type="yesno" source="entity" />
		<WTATTRIBUTE id="4715" name="IsTask" type="yesno" source="entity" />
		<WTATTRIBUTE id="4716" name="IsSales" type="yesno" source="entity" />
		<WTATTRIBUTE id="4717" name="IsActivities" type="yesno" source="entity" />
		<WTATTRIBUTE id="4718" name="IsEvents" type="yesno" source="entity" />
		<WTATTRIBUTE id="4719" name="IsService" type="yesno" source="entity" />
		<WTATTRIBUTE id="4720" name="IsLead" type="yesno" source="entity" />
		<WTATTRIBUTE id="4722" name="Timezone" type="number" source="entity">
			<WTENUM id="-4" name="GMTm4" />
			<WTENUM id="-5" name="GMTm5" />
			<WTENUM id="-6" name="GMTm6" />
			<WTENUM id="-7" name="GMTm7" />
			<WTENUM id="-8" name="GMTm8" />
			<WTENUM id="-9" name="GMTm9" />
			<WTENUM id="-10" name="GMTm10" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="4723" name="Seq" type="number" min="1" source="entity" seq="10"/>

		<!--Indexes-->
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID" />
			<WTATTRIBUTE name="MemberID" />
		</WTINDEX>
		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID" />
		</WTINDEX>
		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Calendar" entity="Calendar" alias="cal" />
			<WTRELATIONSHIP name="Common" entity="Calendar" alias="cal" />
		</WTRELATIONSHIPS>
		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="LAYOUT-DAY" value="1" />
			<WTSYSCON name="LAYOUT-WEEK" value="2" />
			<WTSYSCON name="LAYOUT-MONTH" value="3" />
			<WTSYSCON name="LAYOUT-LIST" value="4" />
			<WTSYSCON name="TYPE-APPT" value="1" />
			<WTSYSCON name="TYPE-CLASS" value="-13" />
			<WTSYSCON name="TYPE-ASSESS" value="-31" />
			<WTSYSCON name="TYPE-GOAL" value="-70" />
			<WTSYSCON name="TYPE-PROJECT" value="-75" />
			<WTSYSCON name="TYPE-TASK" value="-74" />
			<WTSYSCON name="TYPE-SALES" value="-81" />
			<WTSYSCON name="TYPE-ACTIVITIES" value="-90" />
			<WTSYSCON name="TYPE-EVENTS" value="-96" />
			<WTSYSCON name="TYPE-SERVICE" value="-701" />
			<WTSYSCON name="TYPE-LEAD" value="-22" />
		</WTSYSCONS>
	</WTENTITY>
	<WTPROCEDURES>
		<!--============================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" />
		<!--============================================================================================-->
		<WTPROCEDURE type="Count" name="Count" style="GenerateDataProc.xsl" />
		<!--============================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" />
		<!--============================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common" />
		</WTPROCEDURE>
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" />
		<!--============================================================================================-->
		<WTPROCEDURE type="List" name="ListMember" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Calendar.CalendarID)"/>
					<WTATTRIBUTE value="ATTR(Calendar.CalendarName)"/>
					<WTJOIN name="Calendar" lock="false"/>
					<WTCONDITION expr="ATTR(Calendar.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTORDER name="ATTR(Calendar.Seq)"/>
					<WTORDER name="ATTR(Calendar.CalendarName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="List" name="ListCompany" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Calendar.CalendarID)"/>
					<WTATTRIBUTE value="ATTR(Calendar.CalendarName)"/>
					<WTJOIN name="Calendar" lock="false"/>
					<WTCONDITION expr="ATTR(Calendar.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Calendar.MemberID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Calendar.Seq)"/>
					<WTORDER name="ATTR(Calendar.CalendarName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="List" name="ListCompanyPublic" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Calendar.CalendarID)"/>
					<WTATTRIBUTE value="ATTR(Calendar.CalendarName)"/>
					<WTJOIN name="Calendar" lock="false"/>
					<WTCONDITION expr="ATTR(Calendar.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Calendar.MemberID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Calendar.IsPrivate)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Calendar.Seq)"/>
					<WTORDER name="ATTR(Calendar.CalendarName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--===============================================================================-->
		<WTWEBPAGE name="4702" caption="New Calendar" navbar="false" header="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--===============================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="Options" datatype="text" />

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly" />
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Load">
						<WTPARAM name="CalendarID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Calendar.CompanyID)" value="PARAM(CompanyID)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.MemberID)" value="PARAM(MemberID)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.CalendarName)" value="CONST(&quot;Calendar&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.Layout)" value="SYSCON(LAYOUT-MONTH)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.IsAppt)" value="SYSCON(YES)" />
<!--
					<WTSETATTRIBUTE name="ATTR(Calendar.IsGoal)" value="SYSCON(YES)">
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
-->
					<WTSETATTRIBUTE name="ATTR(Calendar.Timezone)" value="CONST(-6)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCalendar" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
			Select Case tmpLevel
				Case 0: reqOptions = .FreeOptions + tmpOptions
				Case 1: reqOptions = .Options + tmpOptions
				Case 2: reqOptions = .Options2 + tmpOptions
				Case 3: reqOptions = .Options3 + tmpOptions
			End Select	
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>
			<WTACTION name="Add" type="Add" id="1">
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Load">
						<WTPARAM name="CalendarID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Calendar.Layout)" value="SYSCON(LAYOUT-MONTH)" />
					<WTSETATTRIBUTES />
					<WTMETHOD name="Add">
						<WTPARAM name="CalendarID" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors" />
						<WTPARAM name="xmlCalendar" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors" />
					<WTLINK name="4703" return="false">
						<WTPARAM name="CalendarID" value="CONST(CalendarID)" />
						<WTPARAM name="Updated" value="CONST(3)" />
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="80" align="right" />
				<WTCOLUMN width="420" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" label="NewCalendar" class="PageHeading" align="left" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="IsEmployee" />
					<WTSTATIC col="1" tag="CompanyID" />
					<WTTEXT col="2" value="ATTR(Calendar.CompanyID)" size="4" />
					<WTSTATIC col="2" tag="MemberID" />
					<WTTEXT col="2" value="ATTR(Calendar.MemberID)" size="4" prespace="false" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="NotEmployee" />
					<WTHIDDEN value="ATTR(Calendar.CompanyID)" />
					<WTHIDDEN value="ATTR(Calendar.MemberID)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CalendarName" />
					<WTTEXT col="2" value="ATTR(Calendar.CalendarName)" size="60" focus="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Seq" />
					<WTTEXT col="2" value="ATTR(Calendar.Seq)" size="2"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Timezone" />
					<WTCOMBO col="2" value="ATTR(Calendar.Timezone)" />
					<WTCHECK col="2" value="ATTR(Calendar.IsPrivate)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left" />
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Calendar.Description)" cols="60" rows="4" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsAppt)"/>
						<WTIMAGE col="2" value="CONST(Appt1.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'H'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsGoal)"/>
						<WTIMAGE col="2" value="CONST(Appt-70.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'h'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsLead)"/>
						<WTIMAGE col="2" value="CONST(Appt-22.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsSales)"/>
						<WTIMAGE col="2" value="CONST(Appt-81.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsActivities)"/>
						<WTIMAGE col="2" value="CONST(Appt-90.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, '6'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsService)"/>
						<WTIMAGE col="2" value="CONST(Appt-701.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsEvents)"/>
						<WTIMAGE col="2" value="CONST(Appt-96.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'K'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsClass)"/>
						<WTIMAGE col="2" value="CONST(Appt-13.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'L'))"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsAssess)"/>
						<WTIMAGE col="2" value="CONST(Appt-31.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'F'))"/>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'f'))" connector="or"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsProject)"/>
						<WTIMAGE col="2" value="CONST(Appt-75.gif)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'F'))"/>
						<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'f'))" connector="or"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Calendar.IsTask)"/>
						<WTIMAGE col="2" value="CONST(Appt-74.gif)" imgalign="absmiddle"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>

				<WTROW margin-top="12" margin-bottom="24">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Add)" align="center" />
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--===============================================================================-->
		<WTWEBPAGE name="4703" caption="Calendar" navbar="false" header="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--===============================================================================-->
			<WTPARAM name="CalendarID" datatype="number" />
			<WTPARAM name="Updated" datatype="number" />
			<WTPARAM name="Options" datatype="text" />

			<WTSUB name="LoadCalendar">
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Load">
						<WTPARAM name="CalendarID" direction="input" value="PARAM(CalendarID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCalendar" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(tmpMemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
			Select Case tmpLevel
				Case 0: reqOptions = .FreeOptions + tmpOptions
				Case 1: reqOptions = .Options + tmpOptions
				Case 2: reqOptions = .Options2 + tmpOptions
				Case 3: reqOptions = .Options3 + tmpOptions
			End Select	
</WTCUSTOM>
				</WTOBJECT>

			</WTSUB>

			<WTSUB name="UpdateCalendar">
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Load">
						<WTPARAM name="CalendarID" direction="input" value="PARAM(CalendarID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTES />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCalendar" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTSETATTRIBUTE name="PARAM(Updated)" value="CONST(1)">
					<WTCONDITION expr="NoErrors" />
				</WTSETATTRIBUTE>
			</WTSUB>
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadCalendar" />
			</WTACTION>
			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateCalendar" />
				<WTCALLSUB name="LoadCalendar" />
			</WTACTION>
			<WTACTION id="2" name="Delete" type="Delete">
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Delete">
						<WTPARAM name="CalendarID" direction="input" value="PARAM(CalendarID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadCalendar">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(Updated)" value="CONST(2)">
					<WTCONDITION expr="NoErrors" />
				</WTSETATTRIBUTE>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="80" align="right" />
				<WTCOLUMN width="420" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Calendar" value="ATTR(Calendar.CalendarName)" class="PageHeading" align="left" />
					<WTSTATIC col="1" merge="2" fontcolor="red">
						<WTSTATIC label="Updated">
							<WTCONDITION expr="PARAM(Updated)" oper="equal" value="CONST(1)" />
						</WTSTATIC>
						<WTSTATIC label="Deleted">
							<WTCONDITION expr="PARAM(Updated)" oper="equal" value="CONST(2)" />
						</WTSTATIC>
						<WTSTATIC label="Added">
							<WTCONDITION expr="PARAM(Updated)" oper="equal" value="CONST(3)" />
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Updated)" oper="not-equal" value="CONST(2)" />
					<WTROW>
						<WTSTATIC col="1" label="CalendarID" class="BoldText" height="18" />
						<WTSTATIC col="2" value="ATTR(Calendar.CalendarID)" class="BoldText" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="IsEmployee" />
						<WTSTATIC col="1" tag="CompanyID" />
						<WTTEXT col="2" value="ATTR(Calendar.CompanyID)" size="4" />
						<WTSTATIC col="2" tag="MemberID" />
						<WTTEXT col="2" value="ATTR(Calendar.MemberID)" size="4" prespace="false" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="NotEmployee" />
						<WTHIDDEN value="ATTR(Calendar.CompanyID)" />
						<WTHIDDEN value="ATTR(Calendar.MemberID)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CalendarName" />
						<WTTEXT col="2" value="ATTR(Calendar.CalendarName)" size="60" focus="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Seq" />
						<WTTEXT col="2" value="ATTR(Calendar.Seq)" size="2"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Timezone" />
						<WTCOMBO col="2" value="ATTR(Calendar.Timezone)" />
						<WTCHECK col="2" value="ATTR(Calendar.IsPrivate)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" tag="Description" align="left" />
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Calendar.Description)" cols="60" rows="4" />
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsAppt)"/>
							<WTIMAGE col="2" value="CONST(Appt1.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'H'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsGoal)"/>
							<WTIMAGE col="2" value="CONST(Appt-70.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'h'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsLead)"/>
							<WTIMAGE col="2" value="CONST(Appt-22.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsSales)"/>
							<WTIMAGE col="2" value="CONST(Appt-81.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsActivities)"/>
							<WTIMAGE col="2" value="CONST(Appt-90.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, '6'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsService)"/>
							<WTIMAGE col="2" value="CONST(Appt-701.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsEvents)"/>
							<WTIMAGE col="2" value="CONST(Appt-96.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'K'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsClass)"/>
							<WTIMAGE col="2" value="CONST(Appt-13.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'L'))"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsAssess)"/>
							<WTIMAGE col="2" value="CONST(Appt-31.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'F'))"/>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'f'))" connector="or"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsProject)"/>
							<WTIMAGE col="2" value="CONST(Appt-75.gif)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'F'))"/>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'f'))" connector="or"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" value="ATTR(Calendar.IsTask)"/>
							<WTIMAGE col="2" value="CONST(Appt-74.gif)" imgalign="absmiddle"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center" />
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Delete)" align="center" msg="ConfirmDelete">
							<WTCONDITION expr="IsEmployee" />
							<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="SYS(MemberID)" connector="or"/>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(Updated)" oper="equal" value="CONST(2)"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		<!--===============================================================================-->
		<WTWEBPAGE name="Calendar" caption="Member Calendar" contentpage="true" navbar="false" focus="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0">
			<!--===============================================================================-->
			<WTPARAM name="C" datatype="number" />
			<WTPARAM name="M" datatype="number" />
			<WTPARAM name="NewC" datatype="number" />      <!--Internal-->
			<WTPARAM name="MemberID" datatype="number" />  <!--Internal-->
			<WTPARAM name="CompanyID" datatype="number" /> <!--Internal-->
			<WTPARAM name="FromDate" datatype="date" />    <!--Internal-->
			<WTPARAM name="ToDate" datatype="date" />      <!--Internal-->
			<WTPARAM name="Title" datatype="text" />       <!--Internal-->
			<WTPARAM name="Edit" datatype="number" />      <!--Internal-->
			<WTPARAM name="Options" datatype="text" />     <!--Internal-->
			<WTPARAM name="URL" datatype="text" />     <!--Internal-->
			<WTPARAM name="Popup" datatype="number" />
			<WTPARAM name="ContentPage" datatype="number"/>

			<WTINCLUDE name="CompanyHeader.asp" />
			<WTDATATXN name="Cell" />

			<WTCODEGROUP>
<WTCUSTOM>
	reqURL = "http://" + reqSysServerName + reqSysServerPath + "calendar.asp?c=" &amp; reqC
</WTCUSTOM>
			</WTCODEGROUP>
			
			<WTSUB name="GetCalendars">
				<WTOBJECT name="Calendars" project="ptsCalendarUser" class="CCalendars">
					<WTMETHOD name="ListCompanyPublic">
						<WTCONDITION expr="IsMemberOnly"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
					</WTMETHOD>
					<WTMETHOD name="ListCompany">
						<WTCONDITION expr="NotMemberOnly"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
					</WTMETHOD>
<WTCUSTOM>
			tmpCnt = 0
			xmlCalendars = "&lt;PTSCALENDARS&gt;"
			If reqCompanyID &lt;&gt; 0 Then
				For Each oCalendar in oCalendars
					With oCalendar
						tmpCnt = tmpCnt + 1
						If tmpCnt = 1 AND reqC = 0 Then reqC = .CalendarID
						xmlCalendars = xmlCalendars + "&lt;ENUM id=""" + .CalendarID + """ name=""" + "**" + CleanXML(.CalendarName) + ""
						If reqC = CLng(.CalendarID) Then xmlCalendars = xmlCalendars + """ selected=""1"
						xmlCalendars = xmlCalendars + """/&gt;"
					End With
				Next		
			End If
</WTCUSTOM>
					<WTMETHOD name="ListMember">
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					</WTMETHOD>
<WTCUSTOM>
			If reqMemberID &lt;&gt; 0 Then
				For Each oCalendar in oCalendars
					With oCalendar
						tmpCnt = tmpCnt + 1
						If tmpCnt = 1 AND reqC = 0 Then reqC = .CalendarID
						xmlCalendars = xmlCalendars + "&lt;ENUM id=""" + .CalendarID + """ name=""" + CleanXML(.CalendarName) + ""
						If reqC = CLng(.CalendarID) Then xmlCalendars = xmlCalendars + """ selected=""1"
						xmlCalendars = xmlCalendars + """/&gt;"
					End With
				Next		
			End If
			xmlCalendars = xmlCalendars + "&lt;/PTSCALENDARS&gt;"
</WTCUSTOM>
					<WTCALLSUB name="NewCalendar">
						<WTCONDITION expr="CONST(tmpCnt)" oper="equal" value="CONST(0)"/>
					</WTCALLSUB>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewCalendar">
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>			
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="CONST(tmpCalendarName)" value="CONST(.CompanyName + &quot; Calendar&quot;)" />
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>			
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="CONST(tmpTimezone)" value="ATTR(Timezone)" />
					<WTSETATTRIBUTE name="CONST(tmpCalendarName)" value="CONST(.CompanyName + &quot; Calendar&quot;)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpCalendarName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; Calendar&quot;)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Load">
						<WTPARAM name="CalendarID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Calendar.CompanyID)" value="CONST(tmpCompanyID)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.MemberID)" value="PARAM(MemberID)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.Layout)" value="SYSCON(LAYOUT-MONTH)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.CalendarName)" value="CONST(tmpCalendarName)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.Timezone)" value="CONST(tmpTimezone)" />
					<WTSETATTRIBUTE name="ATTR(Calendar.IsAppt)" value="SYSCON(YES)" />
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberOnly"/>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsClass)" value="SYSCON(YES)">
							<WTCONDITION expr="IsClasses"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsAssess)" value="SYSCON(YES)">
							<WTCONDITION expr="IsAssessments"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsGoal)" value="SYSCON(YES)">
							<WTCONDITION expr="IsGoals"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsSales)" value="SYSCON(YES)">
							<WTCONDITION expr="IsSales"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsActivities)" value="SYSCON(YES)">
							<WTCONDITION expr="IsSales"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsEvents)" value="SYSCON(YES)">
							<WTCONDITION expr="IsSales"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsService)" value="SYSCON(YES)">
							<WTCONDITION expr="IsService"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Calendar.IsLead)" value="SYSCON(YES)">
							<WTCONDITION expr="IsSuspect"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTPARAM name="reqC" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadCalendar">
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Load">
						<WTPARAM name="CalendarID" direction="input" value="PARAM(C)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTCODEGROUP>
						<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)" />
						<WTCALLSUB name="SetCompanyHeader reqCompanyID, reqSysLanguage"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)">
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<!-- Mentor editing Member's Calendar -->
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(1)">
						<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(0)" oper="not-equal" value="CONST(CLng(.MemberID))" connector="and"/>
					</WTSETATTRIBUTE>
					<!-- Member editing their own Calendar -->
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(1)">
						<WTCONDITION expr="IsMemberOnly"/>
						<WTCONDITION expr="SYS(MemberID)" oper="equal" value="CONST(CLng(.MemberID))" connector="and"/>
					</WTSETATTRIBUTE>
					<!-- Employee editing any calendar -->
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(1)">
						<WTCONDITION expr="IsEmployee"/>
					</WTSETATTRIBUTE>
					<!-- Company Administrator editing calendar -->
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(1)">
						<WTCONDITION expr="IsOrgAdminOnly"/>
					</WTSETATTRIBUTE>
					<!-- non-editable public calendar -->
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(-1)">
						<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(IsPrivate)" oper="not-equal" value="CONST(0)" connector="and"/>
					</WTSETATTRIBUTE>

					<WTSETATTRIBUTE name="CONST(tmpLayout)" value="ATTR(Layout)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCalendar" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
<WTCUSTOM>
			If reqMemberID = 0 Then
				reqOptions = "1"
			Else
				reqOptions = ""
				If .IsAppt = 1 Then reqOptions = reqOptions + "1"
				If .IsClass = 1 Then reqOptions = reqOptions + "C"
				If .IsAssess = 1 Then reqOptions = reqOptions + "A"
				If .IsGoal = 1 Then reqOptions = reqOptions + "G"
				If .IsProject = 1 Then reqOptions = reqOptions + "P"
				If .IsTask = 1 Then reqOptions = reqOptions + "T"
				If .IsLead = 1 Then reqOptions = reqOptions + "L"
				If .IsSales = 1 Then reqOptions = reqOptions + "S"
				If .IsActivities = 1 Then reqOptions = reqOptions + "N"
				If .IsEvents = 1 Then reqOptions = reqOptions + "E"
				If .IsService = 1 Then reqOptions = reqOptions + "V"
				If reqOptions = "" Then reqOptions = "1"
			End If
</WTCUSTOM>
				</WTOBJECT>
				<WTCALLSUB name="GetCalendars">
					<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
				</WTCALLSUB>
<WTCUSTOM>
	If reqFromDate = "" Then
		reqFromDate = Date()
		Select Case tmpLayout
			Case 1  'Day - today
			Case 2  'Week
				reqFromDate = DateAdd( "d", (WeekDay(reqFromDate, 2)-1) * -1, reqFromDate) 
			Case 3  'Month
				reqFromDate = DateSerial(Year(reqFromDate), Month(reqFromDate), 1)
			Case 4  'List - today
		End Select
	End If		
	If reqToDate = "" Then
		reqToDate = Date()
		Select Case tmpLayout
			Case 1  'Day - today
			Case 2  'Week
				reqToDate = DateAdd( "d", 7, reqFromDate) 
			Case 3  'Month
				reqToDate = DateAdd("d", -1, DateAdd( "m", 1, reqFromDate))
			Case 4  'List - today
		End Select
	End If		
</WTCUSTOM>
				<WTOBJECT name="Appts" project="ptsApptUser" class="CAppts">
					<WTCONDITION expr="PARAM(Edit)" oper="not-equal" value="CONST(-1)"/>
					<WTMETHOD name="ListCalendar">
						<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="CalendarID" direction="input" value="PARAM(C)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
						<WTMETHOD name="ListCalendarAll">
							<WTCONDITION expr="PARAM(Options)" oper="equal" value="CONST(&quot;1&quot;)"/>
							<WTPARAM name="CalendarID" direction="input" value="PARAM(C)" />
							<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
						</WTMETHOD>
						<WTMETHOD name="ListCalendarOptions">
							<WTCONDITION expr="PARAM(Options)" oper="not-equal" value="CONST(&quot;1&quot;)"/>
							<WTPARAM name="CalendarID" direction="input" value="PARAM(C)" />
							<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)" />
							<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)" />
							<WTPARAM name="Options" direction="input" value="PARAM(Options)" />
						</WTMETHOD>
					</WTCODEGROUP>
<WTCUSTOM>
			'calculate and store day and time
			For Each oAppt in oAppts
				With oAppt
					.Opt = 0
					'Create a list of days this appt spans this month
					'If this is a weekly recurring appt. get all days
					If .Recur = 1 Then
						tmpDay1 = Day(reqFromDate)
						tmpDay2 = Day(reqToDate)
						If CDate(.StartDate) &gt; CDate(reqFromDate) Then tmpDay1 = Day(.StartDate)
						If IsDate(.RecurDate) Then
							If CDate(.RecurDate) &lt; CDate(reqToDate) Then tmpDay2 = Day(.RecurDate)
						End If
						tmpStr = "~"
						FromDay = WeekDay(reqFromDate)
						StartDay = WeekDay(.StartDate)
						If StartDay = FromDay Then x = 1
						If StartDay &gt; FromDay Then x = (StartDay - FromDay) + 1
						If StartDay &lt; FromDay Then x = (StartDay + 8) - FromDay
						While x &lt;= 31 
							If x &gt;= tmpDay1 And x &lt;= tmpDay2 Then
								tmpStr = tmpStr + CStr(x) + "~"
							End If	
							x = x + 7
						Wend
						.Email = tmpStr
					Else
						If .StartDate = .EndDate Then
							.Email = "~" + CStr(Day(.StartDate)) + "~"
						Else
							tmpStartDate = .StartDate
							tmpEndDate = .EndDate
							tmpMonth = Month(reqFromDate)
							tmpStr = "~"
							days = DATEDIFF("d", tmpStartDate, tmpEndDate)
							For x = 0 to days 
								dte = DATEADD("d", x, tmpStartDate)
								If Month(dte) = tmpMonth Then
									tmpStr = tmpStr + CStr(Day(dte)) + "~"
								End If	
							Next
							.Email = tmpStr
							.Opt = 1
						End If
						If .IsEdit &lt;&gt; "0" Then .Opt = 2	
					End If	
					If reqEdit = 0 AND .Show = 3 Then .ApptName = "Busy"
					If .IsAllDay = 0 Then .ApptName = .StartTime + " " + .ApptName
					'convert ApptID for other types
					Select Case .ApptType
						Case "-70" 
							.ApptID = CLng(.ApptID) mod 700000000 'Goals 
							'If the goal date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "3" Then .Status = 0
						Case "-701" 
							.ApptID = CLng(.ApptID) mod 700000000 'Service Goals 
							'If the goal date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "3" Then .Status = 0
						Case "-22" 
							.ApptID = CLng(.ApptID) mod 220000000 'Leads 
							If CDate(.StartDate) &lt; Date() Then .CalendarID = 1 Else .CalendarID = 0
						Case "-81" 
							.ApptID = CLng(.ApptID) mod 810000000 'Sales 
							If CDate(.StartDate) &lt; Date() Then .CalendarID = 1 Else .CalendarID = 0
						Case "-90" 
							.ApptID = CLng(.ApptID) mod 900000000 'Notes
						Case "-96" 
							.ApptID = CLng(.ApptID) mod 960000000 'Events
						Case "-13" 
							.ApptID = CLng(.ApptID) mod 130000000 'Classes
						Case "-31" 
							.ApptID = CLng(.ApptID) mod 310000000 'Assessments
						Case "-75" 
							.ApptID = CLng(.ApptID) mod 750000000 'Projects 
							'If the project date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "2" Then .Status = 0
						Case "-74" 
							.ApptID = CLng(.ApptID) mod 740000000 'Tasks 
							'If the task date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "2" Then .Status = 0
					End Select
					'Calculate the Military Time for sorting the appts 
					If .StartTime = "" Then 
						.Reminder = 0
					Else
						tmpTime = .StartTime
						newTime = "0"
						length = Len(tmpTime)
						For x = 1 to length
							c = Mid(tmpTime, x, 1)
							If IsNumeric(c) Then newTime = newTime + c
						Next
						If Left(newTime,3) = "012" Then
							If InStr(UCase(tmpTime), "A") Then 
								newTime = "0" + Mid(tmpTime, 3,2)
							End If
						Else
							If InStr(UCase(tmpTime), "P") Then 
								newTime = (Clng(newTime) + 1200)
							End If
						End If
						.Reminder = newTime
					End If	
				End With
			Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAppts" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
-->
<WTCUSTOM>
If reqEdit &lt;&gt; - 1 Then
	If tmpLayout = 1 Then  'Day
		xmlCell = "&lt;PTSCELLS&gt;"
		x = tmpDailyStart
		while x &lt; tmpDailyEnd
			xmlCell = xmlCell + "&lt;PTSCELL " + "time=" + chr(34) &amp; (x*100) &amp; chr(34) + "/&gt;"
			xmlCell = xmlCell + "&lt;PTSCELL " + "time=" + chr(34) &amp; (x*100)+30 &amp; chr(34) + "/&gt;"
			x = x + 1
		wend
		xmlCell = xmlCell + "&lt;/PTSCELLS&gt;"
	End If
	If tmpLayout = 2 Then  'Week
		xmlCell = "&lt;PTSCELLS&gt;"
		x = 0
		while x &lt; 7
			xmlCell = xmlCell + "&lt;PTSCELL " + "day=" + chr(34) &amp; (x+1) &amp; chr(34) + "/&gt;"
			x = x + 1
		wend
		xmlCell = xmlCell + "&lt;/PTSCELLS&gt;"
	End If
	If tmpLayout = 3 Then  'Month
		Dim Dte, FirstDayNo, WeekNo, DayNo
	    reqTitle = MonthName(Month(reqFromDate)) + " " &amp; Year(reqFromDate)
		xmlCell = "&lt;PTSCELLS&gt;"
		Y = Year(reqFromDate)
		M = Month(reqFromDate)
		DayNo = Weekday(DateSerial(Y, M, 1),2)
		If DayNo &gt; 1 Then
			For D = 1 To DayNo - 1
				xmlCell = xmlCell + "&lt;PTSCELL " + "day=""""/&gt;"
			Next
		End If
		Today = Date()
		For D = 1 To 31
			Dte = DateSerial(Y, M, D)
			If D = 1 Then FirstDayNo = Weekday(Dte,2)
			If M = Month(Dte) And D = Day(Dte) Then
				xmlCell = xmlCell + "&lt;PTSCELL " + "day=""" &amp; D &amp; """"
				If Dte = Today Then xmlCell = xmlCell + " today=""" &amp; 1 &amp; """"
				xmlCell = xmlCell + "/&gt;"
				DayNo = Weekday(Dte,2)
			End If
		Next
		If DayNo &lt;&gt; 7 Then
			For D = DayNo + 1 To 7
				xmlCell = xmlCell + "&lt;PTSCELL " + "day=""""/&gt;"
			Next
		End If
		xmlCell = xmlCell + "&lt;/PTSCELLS&gt;"
	End If
	reqNewC = reqC
End If
</WTCUSTOM>
			</WTSUB>

			<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION name="New" id="0" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
					<WTCALLSUB name="GetCalendars"/>
					<WTRETURN>
						<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="Calendar" return="false">
							<WTPARAM name="C" value="PARAM(C)"/>
							<WTPARAM name="M" value="PARAM(M)"/>
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadCalendar">
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION name="PrevYear" id="1" type="New">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(DateAdd(&quot;yyyy&quot;, -1, reqFromDate))" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(&quot;&quot;)" />
				<WTCALLSUB name="LoadCalendar" />
			</WTACTION>
			<WTACTION name="PrevMonth" id="2" type="New">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(DateAdd(&quot;m&quot;, -1, reqFromDate))" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(&quot;&quot;)" />
				<WTCALLSUB name="LoadCalendar" />
			</WTACTION>
			<WTACTION name="NextMonth" id="3" type="New">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(DateAdd(&quot;m&quot;, 1, reqFromDate))" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(&quot;&quot;)" />
				<WTCALLSUB name="LoadCalendar" />
			</WTACTION>
			<WTACTION name="NextYear" id="4" type="New">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(DateAdd(&quot;yyyy&quot;, 1, reqFromDate))" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(&quot;&quot;)" />
				<WTCALLSUB name="LoadCalendar" />
			</WTACTION>

			<WTACTION name="Calendar" id="5" type="New">
				<WTSETATTRIBUTE name="PARAM(NewC)" value="FORM(NewC)"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="Calendar" return="false">
						<WTPARAM name="C" value="PARAM(NewC)"/>
						<WTPARAM name="M" value="PARAM(M)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTFUNCTION name="ViewAppt(id)">
					var url, win;
					url = "4804.asp?apptid=" + id
		            win = window.open(url,"vAppt","top=100,left=100,height=150,width=430,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="EditAppt(id, edit)">
					var url, win;
					if( edit == 0 )
					{
						url = "4803.asp?apptid=" + id
						win = window.open(url,"Appt","top=100,left=100,height=400,width=550,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
						win.focus();
					}
					else
					{
						url = "4805.asp?apptid=" + id + "&amp;memberid=" + document.getElementById('MemberID').value;
						win = window.open(url,"Appt","top=100,left=100,height=250,width=550,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
						win.focus();
					}
				</WTFUNCTION>
				<WTFUNCTION name="AddAppt()">
					var url, win;
					url = "4802.asp?calendarid=" + document.getElementById('C').value
		            win = window.open(url,"Appt","top=100,left=100,height=400,width=550,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="EditCalendar()">
					var url, win;
					url = "4703.asp?calendarid=" + document.getElementById('C').value
		            win = window.open(url,"EditCalendar","top=100,left=100,height=520,width=550,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="AddCalendar()">
					var url, win;
					url = "4702.asp?memberid=" + document.getElementById('MemberID').value + "&amp;companyid=" + document.getElementById('CompanyID').value
		            win = window.open(url,"AddCalendar","top=100,left=100,height=520,width=550,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="EditOther(typ,id)">
					var url, win, style;
					style = ""
					switch (typ)
					{
					case -70:
						url = "7003.asp?goalid=" + id + " &amp;contentpage=3&amp;popup=1"
						break
					case -22:
						url = "2203.asp?leadid=" + id + " &amp;contentpage=3&amp;popup=1"
						break
					case -81:
						url = "8103.asp?prospectid=" + id + " &amp;contentpage=3&amp;popup=1"
						break
					case -90:
						url = "9003.asp?noteid=" + id + " &amp;popup=1"
						style = "top=100,left=100,height=175,width=600,resizable=yes"
						break
					case -96:
						url = "9603.asp?eventid=" + id + " &amp;popup=1"
						break
					case -13:
						url = "1330.asp?sessionid=" + id + " &amp;contentpage=3&amp;popup=1"
						break
					case -31:
						url = "3460.asp?memberassessid=" + id + " &amp;popup=1"
						break
					case -75:
						url = "7503.asp?projectid=" + id + " &amp;contentpage=3&amp;popup=1"
						break
					case -74:
						url = "7403.asp?taskid=" + id + " &amp;contentpage=3&amp;popup=1"
						break
					}
		            win = window.open(url,null, style);
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewDay(dy)">
					var url, win, dte, strdate
					dte = new Date(document.getElementById('FromDate').value );
					dte.setDate(dy);
					strdate = (dte.getMonth()+1) + "/" + dte.getDate() + "/" + dte.getFullYear()
					url = "4711.asp?c=" + document.getElementById('C').value + "&amp;date=" + strdate
					win = window.open(url,"DayView");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(C)"/>
					<WTHIDDEN value="PARAM(FromDate)" />
					<WTHIDDEN value="PARAM(MemberID)" />
					<WTHIDDEN value="PARAM(CompanyID)" />
					<WTHIDDEN value="ATTR(Calendar.MemberID)" name="CalendarMemberID"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Edit)" oper="less-equal" value="CONST(0)"/>

					<WTTABLE col="1">
						<WTCOLUMN width="450" />
						<WTCOLUMN width="300" />
						<WTROW>
							<WTSTATIC col="1" align="left" class="PageHeading">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(calendarsm.gif)" alt="calendar" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="ATTR(Calendar.CalendarName)" space="1"/>
								<WTSTATIC fontcolor="gray">
									<WTSTATIC value="CONST(()"/>
									<WTSTATIC value="ATTR(Calendar.Timezone)" space="1"/>
									<WTSTATIC label="Time"/>
									<WTSTATIC value="CONST())"/>
								</WTSTATIC>
							</WTSTATIC>
<!--
							<WTSTATIC col="2" align="right">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(CalendarRefresh.gif)" alt="CalendarRefresh" imgalign="absmiddle">
										<WTLINK click="true" name="CONST(doSubmit(0,&quot;&quot;))"/>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
-->
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTSTATIC label="CalendarAppt"/>
				<WTSTATIC label="CalendarRefresh"/>
				<WTSTATIC label="CalendarConfig"/>
				<WTSTATIC label="CalendarAdd"/>
				<WTROW>
					<WTCONDITION expr="PARAM(Edit)" oper="greater" value="CONST(0)"/>
					<WTTABLE col="1">
						<WTCOLUMN width="450" />
						<WTCOLUMN width="300" />
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" align="left" class="PageHeading">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(calendar32.gif)" alt="calendar" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="ATTR(Calendar.CalendarName)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="_IsPinnacleTutorial"/>
									<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
										<WTLINK name="Tutorial" target="Tutorial">
											<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-CALENDAR)"/>
											<WTPARAM name="contentpage" value="CONST(3)"/>
											<WTPARAM name="popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC fontcolor="gray">
									<WTSTATIC value="CONST(()"/>
									<WTSTATIC value="ATTR(Calendar.Timezone)" space="1"/>
									<WTSTATIC label="Time"/>
									<WTSTATIC value="CONST())"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2" align="right">
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Calendar.MemberID)" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="NotMemberOnly" connector="or"/>
									<WTIMAGE value="CONST(CalendarAppt.gif)" alt="CalendarAppt" imgalign="absmiddle">
										<WTLINK click="true" name="CONST(AddAppt())"/>
									</WTIMAGE>
									<WTSTATIC space="2"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(CalendarRefresh.gif)" alt="CalendarRefresh" imgalign="absmiddle">
										<WTLINK click="true" name="CONST(doSubmit(0,&quot;&quot;))"/>
									</WTIMAGE>
									<WTSTATIC space="2"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Calendar.MemberID)" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="NotMemberOnly" connector="or"/>
									<WTIMAGE value="CONST(CalendarConfig.gif)" alt="CalendarConfig" imgalign="absmiddle">
										<WTLINK click="true" name="CONST(EditCalendar())"/>
									</WTIMAGE>
									<WTSTATIC space="2"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(CalendarAdd.gif)" alt="CalendarAdd" imgalign="absmiddle">
										<WTLINK click="true" name="CONST(AddCalendar())"/>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTCODEGROUP>
							<WTCONDITION expr="NotAnonymous"/>
							<WTROW>
								<WTSTATIC col="1" align="left" class="prompt">
									<WTSTATIC label="ClickHelp"/>
								</WTSTATIC>
								<WTCOMBO col="2" align="right" value="PARAM(NewC)" datapath="/DATA/TXN/PTSCALENDARS/ENUM">
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCALENDARS/ENUM))" oper="greater" value="CONST(1)"/>
									<WTCHANGE>doSubmit(5,"");</WTCHANGE>
								</WTCOMBO>
							</WTROW>
						</WTCODEGROUP>
						
					</WTTABLE>
				</WTROW>
				
				<WTSTATIC label="PrevYear" />
				<WTSTATIC label="PrevMonth" />
				<WTSTATIC label="NextMonth" />
				<WTSTATIC label="NextYear" />
				<WTSTATIC label="ImportanceLow" />
				<WTSTATIC label="ImportanceHigh" />
				<WTSTATIC label="ShowPrivate" />
				<WTSTATIC label="ShowBusy" />
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Edit)" oper="not-equal" value="CONST(-1)"/>
					<WTROW>
						<WTSTATIC col="1" align="center" class="PageHeading">
							<WTCODEGROUP>
								<WTIMAGE value="CONST(PrevYear.gif)" imgalign="absmiddle" alt="PrevYear">
									<WTLINK name="doSubmit(1,&quot;&quot;)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(PrevMonth.gif)" imgalign="absmiddle" alt="PrevMonth">
									<WTLINK name="doSubmit(2,&quot;&quot;)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTSTATIC space="3" />
							<WTSTATIC value="PARAM(Title)" space="3" />
							<WTCODEGROUP>
								<WTIMAGE value="CONST(NextMonth.gif)" imgalign="absmiddle" alt="NextMonth">
									<WTLINK name="doSubmit(3,&quot;&quot;)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(NextYear.gif)" imgalign="absmiddle" alt="NextYear">
									<WTLINK name="doSubmit(4,&quot;&quot;)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTTABLE col="1" padding="0" spacing="0" tableclass="Calendar">
							<WTCOLUMN width="107" align="left" />
							<WTCOLUMN width="107" align="left" />
							<WTCOLUMN width="107" align="left" />
							<WTCOLUMN width="107" align="left" />
							<WTCOLUMN width="107" align="left" />
							<WTCOLUMN width="107" align="left" />
							<WTCOLUMN width="107" align="left" />
							<WTROW>
								<WTSTATIC col="1" label="Mon" backcolor="lightblue" bold="true" align="center"/>
								<WTSTATIC col="2" label="Tue" backcolor="lightblue" bold="true" align="center"/>
								<WTSTATIC col="3" label="Wed" backcolor="lightblue" bold="true" align="center"/>
								<WTSTATIC col="4" label="Thu" backcolor="lightblue" bold="true" align="center"/>
								<WTSTATIC col="5" label="Fri" backcolor="lightblue" bold="true" align="center"/>
								<WTSTATIC col="6" label="Sat" backcolor="lightblue" bold="true" align="center"/>
								<WTSTATIC col="7" label="Sun" backcolor="lightblue" bold="true" align="center"/>
							</WTROW>
							<WTREPEAT xpath="/DATA/TXN/PTSCELLS/PTSCELL[position() mod 7 = 1]">
								<WTROW>
									<WTREPEAT xpath=".|following-sibling::PTSCELL[position() &amp;lt; 7]">
										<WTSTATIC col="1" valign="top" class="CalendarDay">
											<WTCODEGROUP>
												<WTCONDITION expr="CONST(@today)" value="CONST( )" />
												<WTSTATIC value="CONST(&lt;xsl:attribute name=&quot;bgcolor&quot;&gt;honeydew&lt;/xsl:attribute&gt;)" />
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Day)" oper="not-equal" value="CONST('')" />
												<WTSTATIC division="1" align="right">
													<WTSTATIC value="DATA(Day)" bold="true" underline="true" space="1" newline="1">
														<WTCONDITION expr="PARAM(Edit)" oper="not-equal" value="CONST(0)"/>
														<WTLINK name="ViewDay(&lt;xsl:value-of select=&quot;@day&quot;/&gt;)" click="true"/>
													</WTSTATIC>
													<WTSTATIC value="DATA(Day)" bold="true" newline="1">
														<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(0)"/>
													</WTSTATIC>
												</WTSTATIC>

												<WTREPEAT xpath="/DATA/TXN/PTSAPPTS/PTSAPPT[ contains(@email,concat('~',current()/@day,'~')) ]">
													<WTSORT name="@reminder" datatype="number"/>
													<WTSORT name="@apptname"/>
													<!-- Display Appt Icon -->
													<WTIMAGE value="CONST(appt&lt;xsl:value-of select=&quot;@appttype&quot;/&gt;.gif)" valign="top" imgalign="absmiddle"/>
													<!-- Display Meeting Planner Icon -->
													<WTIMAGE value="CONST(plan.gif)" valign="top" imgalign="absmiddle">
														<WTCONDITION expr="DATA(IsPlan)" oper="not-equal" value="CONST(0)"/>
													</WTIMAGE>
													<!-- Display Recurring Appt Icon -->
													<WTIMAGE value="CONST(recur.gif)" valign="top" imgalign="absmiddle">
														<WTCONDITION expr="DATA(Recur)" oper="not-equal" value="CONST(0)"/>
													</WTIMAGE>
													<WTSTATIC space="1" />
													<!-- Display Low Priority Icon -->
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Importance)" oper="equal" value="CONST(1)"/>
														<WTIMAGE value="CONST(apptlow.gif)" valign="top" alt="ImportanceLow" imgalign="absmiddle"/>
													</WTCODEGROUP>
													<!-- Display High Priority Icon -->
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(Importance)" oper="equal" value="CONST(3)"/>
														<WTIMAGE value="CONST(appthigh.gif)" valign="top" alt="ImportanceHigh" imgalign="absmiddle"/>
													</WTCODEGROUP>
													<!-- If User can edit the Calendar -->
													<WTCODEGROUP>
														<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
														<!-- Display Private Appt Icon -->
														<WTCODEGROUP>
															<WTCONDITION expr="DATA(Show)" oper="equal" value="CONST(2)"/>
															<WTIMAGE value="CONST(apptprivate.gif)" valign="top" alt="ShowPrivate" imgalign="absmiddle"/>
														</WTCODEGROUP>
														<!-- Display Busy Appt Icon -->
														<WTCODEGROUP>
															<WTCONDITION expr="DATA(Show)" oper="equal" value="CONST(3)"/>
															<WTIMAGE value="CONST(apptbusy.gif)" valign="top" alt="ShowBusy" imgalign="absmiddle"/>
														</WTCODEGROUP>
													</WTCODEGROUP>

<WTSTATIC fontsize="1">
	<!-- If User cannot edit the Calendar AND a Busy Appt -->
	<WTCODEGROUP>
		<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(0)"/>
		<WTCONDITION expr="DATA(Show)" oper="equal" value="CONST(3)" connector="and"/>
		<!-- If Not Recurring Appt AND Not Public Appt -->
		<WTSTATIC value="DATA(ApptName)">
			<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('0')"/>
		</WTSTATIC>
		<!-- If Recurring Appt -->
		<WTSTATIC value="DATA(ApptName)" fontcolor="purple" bold="true">
			<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('1')"/>
		</WTSTATIC>
		<!-- If Public Appt -->
		<WTSTATIC value="DATA(ApptName)" fontcolor="red" bold="true">
			<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('2')"/>
		</WTSTATIC>
	</WTCODEGROUP>
	<!-- If User can edit the Calendar OR Not a Busy Appt -->
	<WTCODEGROUP>
		<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
		<WTCONDITION expr="DATA(Show)" oper="not-equal" value="CONST(3)" connector="or"/>
		<!-- If User cannot edit the Calendar AND Not Mentoring -->
		<WTCODEGROUP>
			<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(0)"/>
			<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and" />
			<!-- If Not Recurring Appt AND Not Public Appt -->
			<WTSTATIC value="DATA(ApptName)">
				<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('0')"/>
				<WTLINK name="ViewAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true" />
			</WTSTATIC>
			<!-- If Recurring Appt -->
			<WTSTATIC value="DATA(ApptName)" fontcolor="purple" bold="true">
				<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('1')"/>
				<WTLINK name="ViewAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true" />
			</WTSTATIC>
			<!-- If Public Appt -->
			<WTCODEGROUP>
				<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('2')"/>
				<!-- If User Logged In -->
				<WTSTATIC value="DATA(ApptName)" fontcolor="red" bold="true">
<!--					<WTCONDITION expr="SYS(MemberID)" oper="not-equal" value="CONST(0)"/>-->
					<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;,1)" click="true" />
				</WTSTATIC>
				<!-- If User Not Logged In -->
<!--				
				<WTSTATIC value="DATA(ApptName)" fontcolor="red" bold="true">
					<WTCONDITION expr="SYS(MemberID)" oper="equal" value="CONST(0)"/>
					<WTLINK name="ViewAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true" />
				</WTSTATIC>
-->				
			</WTCODEGROUP>		
		</WTCODEGROUP>		
		<!-- If User can edit the Calendar OR Mentoring -->
		<WTCODEGROUP>
			<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
			<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)" connector="or" />
			<!-- If Regular Appt -->
			<WTCODEGROUP>
				<WTCONDITION expr="DATA(ApptType)" oper="greater-equal" value="CONST(0)"/>
				<!-- If Not Recurring Appt AND Not Public Appt -->
				<WTSTATIC value="DATA(ApptName)">
					<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('0')"/>
					<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;, 0)" click="true"/>
				</WTSTATIC>
				<!-- If Recurring Appt -->
				<WTSTATIC value="DATA(ApptName)" fontcolor="purple" bold="true">
					<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('1')"/>
					<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;, 0)" click="true"/>
				</WTSTATIC>
				<!-- If Public Appt -->
				<WTSTATIC value="DATA(ApptName)" fontcolor="red" bold="true">
					<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('2')"/>
					<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;, 0)" click="true"/>
				</WTSTATIC>
			</WTCODEGROUP>		
			<!-- If Dynamic Item -->
			<WTCODEGROUP>
				<WTCONDITION expr="DATA(ApptType)" oper="less" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-GOAL)"/>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-SERVICE)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(3)"/>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)" connector="and"/>
						<WTSTATIC value="DATA(ApptName)">
							<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(3)"/><!--Complete-->
						<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="darkgreen">
							<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Incomplete-->
						<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="red">
							<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
				</WTCODEGROUP>		
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-LEAD)"/>
					<WTCODEGROUP>
						<WTIMAGE value="CONST(Appt2.gif)" valign="top"/>
					</WTCODEGROUP>
					<WTSTATIC value="DATA(ApptName)">
						<WTCONDITION expr="DATA(CalendarID)" oper="not-equal" value="CONST('1')"/>
						<WTLINK name="EditOther(-22, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
					</WTSTATIC>
					<WTSTATIC value="DATA(ApptName)" fontcolor="red">
						<WTCONDITION expr="DATA(CalendarID)" oper="equal" value="CONST('1')"/>
						<WTLINK name="EditOther(-22, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
					</WTSTATIC>
				</WTCODEGROUP>		
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-SALES)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
						<WTIMAGE value="CONST(Appt2.gif)" valign="top"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/>
						<WTIMAGE value="CONST(Appt3.gif)" valign="top"/>
					</WTCODEGROUP>
					<WTSTATIC value="DATA(ApptName)">
						<WTCONDITION expr="DATA(CalendarID)" oper="not-equal" value="CONST('1')"/>
						<WTLINK name="EditOther(-81, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
					</WTSTATIC>
					<WTSTATIC value="DATA(ApptName)" fontcolor="red">
						<WTCONDITION expr="DATA(CalendarID)" oper="equal" value="CONST('1')"/>
						<WTLINK name="EditOther(-81, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
					</WTSTATIC>
				</WTCODEGROUP>		
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-ACTIVITIES)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/><!--Reminder-->
						<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
					</WTCODEGROUP>
					<WTSTATIC value="DATA(ApptName)">
						<WTLINK name="EditOther(-90, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
					</WTSTATIC>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-EVENTS)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/>
						<WTIMAGE value="CONST(event&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" valign="top" />
					</WTCODEGROUP>
					<WTSTATIC value="DATA(ApptName)">
						<WTLINK name="EditOther(-96, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
					</WTSTATIC>
				</WTCODEGROUP>		
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-CLASS)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(6)"/>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(7)" connector="and"/>
						<WTSTATIC value="DATA(ApptName)">
							<WTLINK name="EditOther(-13, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(6)"/><!--Pass-->
						<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="darkgreen">
							<WTLINK name="EditOther(-13, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(7)"/><!--Fail-->
						<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="red">
							<WTLINK name="EditOther(-13, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
				</WTCODEGROUP>		
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-ASSESS)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)" connector="and"/>
						<WTSTATIC value="DATA(ApptName)">
							<WTLINK name="EditOther(-31, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Pass-->
						<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="darkgreen">
							<WTLINK name="EditOther(-31, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Fail-->
						<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="red">
							<WTLINK name="EditOther(-31, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
				</WTCODEGROUP>		
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-PROJECT)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)" connector="and"/>
						<WTSTATIC value="DATA(ApptName)">
							<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Complete-->
						<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="darkgreen">
							<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Incomplete-->
						<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="red">
							<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
				</WTCODEGROUP>		
				<WTCODEGROUP>
					<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-TASK)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/>
						<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)" connector="and"/>
						<WTSTATIC value="DATA(ApptName)">
							<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Complete-->
						<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="darkgreen">
							<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Incomplete-->
						<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
						<WTSTATIC value="DATA(ApptName)" fontcolor="red">
							<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
						</WTSTATIC>
					</WTCODEGROUP>
				</WTCODEGROUP>		
			</WTCODEGROUP>		
		</WTCODEGROUP>		
		<WTSTATIC value="CONST(...)" bold="true">
			<WTCONDITION expr="DATA(Location)" oper="not-equal" value="CONST('')"/>
			<WTCONDITION expr="DATA(Note)" oper="not-equal" value="CONST('')" connector="or"/>
		</WTSTATIC>
	</WTCODEGROUP>
</WTSTATIC>
													<WTSTATIC newline="1" />
												</WTREPEAT>
												<WTSTATIC newline="1" />
											</WTCODEGROUP>
										</WTSTATIC>
									</WTREPEAT>
								</WTROW>
							</WTREPEAT>
						</WTTABLE>
					</WTROW>
				</WTCODEGROUP>
				
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" align="center">
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsGoal)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-70.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Goals" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsLead)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-22.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Lead" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsSales)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-81.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Sales" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsActivities)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-90.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Notes" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsService)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-701.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Service" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsEvents)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-96.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Events" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsClass)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-13.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Classes" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsAssess)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-31.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Assessments" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsProject)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-75.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Apt-Projects" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsTask)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-74.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Tasks" space="2"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
<!--
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Refresh)" align="center">
						<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="greater-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
-->				
				<WTROW margin-bottom="12">
					<WTCONDITION expr="ATTR(Calendar.IsPrivate)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)" connector="and"/>
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTSTATIC tag="public" align="center" space="1" fontcolor="red" />
						<WTSTATIC value="PARAM(URL)" align="center" />
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(-1)"/>
					<WTSTATIC col="1" label="IsPrivate" align="center" fontcolor="red" class="PageHeading"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="4711" caption="Day View" navbar="false" focus="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
			<!--===============================================================================-->
			<WTPARAM name="C" datatype="number" />
			<WTPARAM name="Date" datatype="date" />
			<WTPARAM name="MemberID" datatype="number" />   <!--Internal-->
			<WTPARAM name="CompanyID" datatype="number" />  <!--Internal-->
			<WTPARAM name="Title" datatype="text" />		<!--Internal-->
			<WTPARAM name="Options" datatype="text" />      <!--Internal-->
			<WTPARAM name="Edit" datatype="number" />       <!--Internal-->
			
			<WTINCLUDE name="CompanyHeader.asp" />

			<WTSUB name="LoadCalendar">
				<WTOBJECT name="Calendar" project="ptsCalendarUser" class="CCalendar">
					<WTMETHOD name="Load">
						<WTPARAM name="CalendarID" direction="input" value="PARAM(C)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)" />
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(1)">
						<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="IsEmployee" connector="or"/>
					</WTSETATTRIBUTE>
					<!-- Company Administrator editing calendar -->
					<WTSETATTRIBUTE name="PARAM(Edit)" value="CONST(1)">
						<WTCONDITION expr="IsOrgAdminOnly"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCalendar" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
<WTCUSTOM>
		    reqTitle = WeekdayName(Weekday(reqDate)) + ", " + MonthName(Month(reqDate)) + " " &amp; Day(reqDate) &amp;  + ", " &amp; Year(reqDate)
			If reqMemberID = 0 Then
				reqOptions = "1"
			Else
				reqOptions = ""
				If .IsAppt = 1 Then reqOptions = reqOptions + "1"
				If .IsClass = 1 Then reqOptions = reqOptions + "C"
				If .IsAssess = 1 Then reqOptions = reqOptions + "A"
				If .IsGoal = 1 Then reqOptions = reqOptions + "G"
				If .IsProject = 1 Then reqOptions = reqOptions + "P"
				If .IsTask = 1 Then reqOptions = reqOptions + "T"
				If .IsLead = 1 Then reqOptions = reqOptions + "L"
				If .IsSales = 1 Then reqOptions = reqOptions + "S"
				If .IsActivities = 1 Then reqOptions = reqOptions + "N"
				If .IsEvents = 1 Then reqOptions = reqOptions + "E"
				If .IsService = 1 Then reqOptions = reqOptions + "V"
				If reqOptions = "" Then reqOptions = "1"
			End If
</WTCUSTOM>
				</WTOBJECT>
				<WTCALLSUB name="SetCompanyHeader tmpCompanyID, reqSysLanguage">
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)" />
				</WTCALLSUB>
				<WTOBJECT name="Appts" project="ptsApptUser" class="CAppts">
					<WTMETHOD name="ListCalendarAll">
						<WTCONDITION expr="PARAM(Options)" oper="equal" value="CONST(&quot;1&quot;)"/>
						<WTPARAM name="CalendarID" direction="input" value="PARAM(C)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(Date)" />
						<WTPARAM name="ToDate" direction="input" value="PARAM(Date)" />
					</WTMETHOD>
					<WTMETHOD name="ListDayOptions">
						<WTCONDITION expr="PARAM(Options)" oper="not-equal" value="CONST(&quot;1&quot;)"/>
						<WTPARAM name="CalendarID" direction="input" value="PARAM(C)" />
						<WTPARAM name="FromDate" direction="input" value="PARAM(Date)" />
						<WTPARAM name="Options" direction="input" value="PARAM(Options)" />
					</WTMETHOD>
<WTCUSTOM>
			'calculate and store day and time
			For Each oAppt in oAppts
				With oAppt
					.Opt = "0"
					If .StartDate &lt;&gt; .EndDate Then .Opt = "1"
					If .IsEdit &lt;&gt; "0" Then .Opt = "2"
					If .IsAllDay = 0 Then .ApptName = .StartTime + " " + .ApptName
					'convert ApptID for other types
					Select Case .ApptType
						Case "-70" 
							.ApptID = CLng(.ApptID) mod 700000000 'Goals 
							'If the goal date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "3" Then .Status = 0
						Case "-701" 
							.ApptID = CLng(.ApptID) mod 700000000 'Service Goals 
							'If the goal date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "3" Then .Status = 0
						Case "-22" 
							.ApptID = CLng(.ApptID) mod 220000000 'Leads 
							If CDate(.StartDate) &lt; Date() Then .CalendarID = 1 Else .CalendarID = 0
						Case "-81" 
							.ApptID = CLng(.ApptID) mod 810000000 'Sales 
							If CDate(.StartDate) &lt; Date() Then .CalendarID = 1 Else .CalendarID = 0
						Case "-90" 
							.ApptID = CLng(.ApptID) mod 900000000 'Notes
						Case "-96" 
							.ApptID = CLng(.ApptID) mod 960000000 'Events
						Case "-13" 
							.ApptID = CLng(.ApptID) mod 130000000 'Classes
						Case "-31" 
							.ApptID = CLng(.ApptID) mod 310000000 'Assessments
						Case "-75" 
							.ApptID = CLng(.ApptID) mod 750000000 'Projects 
							'If the project date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "2" Then .Status = 0
						Case "-74" 
							.ApptID = CLng(.ApptID) mod 740000000 'Tasks 
							'If the task date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "2" Then .Status = 0
					End Select
					'Calculate the Military Time for sorting the appts 
					If .StartTime = "" Then 
						.Reminder = 0
					Else
						tmpTime = .StartTime
						newTime = "0"
						length = Len(tmpTime)
						For x = 1 to length
							c = Mid(tmpTime, x, 1)
							If IsNumeric(c) Then newTime = newTime + c
						Next
						If Left(newTime,3) = "012" Then
							If InStr(UCase(tmpTime), "A") Then 
								newTime = "0" + Mid(tmpTime, 3,2)
							End If
						Else
							If InStr(UCase(tmpTime), "P") Then 
								newTime = (Clng(newTime) + 1200)
							End If
						End If
						.Reminder = newTime
					End If	
				End With
			Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAppts" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" id="0" type="New">
				<WTCALLSUB name="LoadCalendar"/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTFUNCTION name="EditAppt(id)">
					var url, win;
					url = "4803.asp?apptid=" + id
					win = window.open(url,"Appt","top=100,left=100,height=400,width=550,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="EditOther(typ,id)">
					var url, win;
					switch (typ)
					{
					case -70:
						url = "7003.asp?goalid=" + id + " &amp;popup=1"
						break
					case -22:
						url = "2203.asp?leadid=" + id + " &amp;popup=1"
						break
					case -81:
						url = "8103.asp?prospectid=" + id + " &amp;popup=1"
						break
					case -90:
						url = "9003.asp?noteid=" + id + " &amp;popup=1"
						break
					case -96:
						url = "9603.asp?eventid=" + id + " &amp;popup=1"
						break
					case -13:
						url = "1330.asp?sessionid=" + id + " &amp;popup=1"
						break
					case -31:
						url = "3460.asp?memberassessid=" + id + " &amp;popup=1"
						break
					case -75:
						url = "7503.asp?projectid=" + id + " &amp;popup=1"
						break
					case -74:
						url = "7403.asp?taskid=" + id + " &amp;popup=1"
						break
					}
		            win = window.open(url,null);
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(C)"/>
					<WTHIDDEN value="PARAM(Date)" />
					<WTHIDDEN value="PARAM(MemberID)" />
					<WTHIDDEN value="PARAM(CompanyID)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" align="left" class="PageHeading">
						<WTSTATIC value="ATTR(Calendar.CalendarName)" space="1"/>
						<WTSTATIC fontcolor="gray">
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC value="ATTR(Calendar.Timezone)" space="1"/>
							<WTSTATIC label="Time"/>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" value="PARAM(Title)" align="center" class="PageHeading"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Appt">
						<WTCOLUMN width="100" align="left" valign="top" />
						<WTSORT name="@reminder" datatype="number"/>
						<WTSORT name="@apptname"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(appt&lt;xsl:value-of select=&quot;@appttype&quot;/&gt;.gif)" valign="top" />
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsPlan)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(plan.gif)" imgalign="top"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Recur)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(recur.gif)" imgalign="top"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Importance)" oper="equal" value="CONST(1)"/>
									<WTIMAGE value="CONST(apptlow.gif)" imgalign="top" alt="ImportanceLow"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Importance)" oper="equal" value="CONST(3)"/>
									<WTIMAGE value="CONST(appthigh.gif)" imgalign="top" alt="ImportanceHigh" />
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Show)" oper="equal" value="CONST(2)"/>
									<WTIMAGE value="CONST(apptprivate.gif)" imgalign="top" alt="ShowPrivate"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Show)" oper="equal" value="CONST(3)"/>
									<WTIMAGE value="CONST(apptbusy.gif)" imgalign="top" alt="ShowBusy"/>
								</WTCODEGROUP>
								<WTSTATIC bold="true">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="greater-equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(0)"/>
											<WTSTATIC value="DATA(ApptName)">
												<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('0')"/>
											</WTSTATIC>
											<WTSTATIC value="DATA(ApptName)" fontcolor="purple">
												<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('1')"/>
											</WTSTATIC>
											<WTSTATIC value="DATA(ApptName)" fontcolor="red">
												<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('2')"/>
											</WTSTATIC>
										</WTCODEGROUP>		
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Edit)" oper="equal" value="CONST(1)"/>
											<WTSTATIC value="DATA(ApptName)">
												<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('0')"/>
												<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
											<WTSTATIC value="DATA(ApptName)" fontcolor="purple">
												<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('1')"/>
												<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
											<WTSTATIC value="DATA(ApptName)" fontcolor="red">
												<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('2')"/>
												<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>		
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-GOAL)"/>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-SERVICE)" connector="or"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/><!--Complete-->
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(3)" connector="and"/><!--Complete-->
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)">
												<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(3)"/><!--Complete-->
											<WTIMAGE value="CONST(greenchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="green">
												<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Incomplete-->
											<WTIMAGE value="CONST(redchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="red">
												<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-LEAD)"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(Appt2.gif)" imgalign="top"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(ApptName)">
											<WTCONDITION expr="DATA(CalendarID)" oper="not-equal" value="CONST('1')"/>
											<WTLINK name="EditOther(-22, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
										</WTSTATIC>
										<WTSTATIC value="DATA(ApptName)" fontcolor="red">
											<WTCONDITION expr="DATA(CalendarID)" oper="equal" value="CONST('1')"/>
											<WTLINK name="EditOther(-22, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
										</WTSTATIC>
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-SALES)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
											<WTIMAGE value="CONST(Appt2.gif)" imgalign="top"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/>
											<WTIMAGE value="CONST(Appt3.gif)" imgalign="top"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(ApptName)">
											<WTCONDITION expr="DATA(CalendarID)" oper="not-equal" value="CONST('1')"/>
											<WTLINK name="EditOther(-81, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
										</WTSTATIC>
										<WTSTATIC value="DATA(ApptName)" fontcolor="red">
											<WTCONDITION expr="DATA(CalendarID)" oper="equal" value="CONST('1')"/>
											<WTLINK name="EditOther(-81, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
										</WTSTATIC>
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-ACTIVITIES)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/><!--Reminder-->
											<WTIMAGE value="CONST(greenchecksm.gif)" imgalign="top"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(ApptName)">
											<WTLINK name="EditOther(-90, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-EVENTS)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/>
											<WTIMAGE value="CONST(event&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" valign="top" />
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(ApptName)">
											<WTLINK name="EditOther(-96, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
										</WTSTATIC>
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-CLASS)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(6)"/>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(7)" connector="and"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)">
												<WTLINK name="EditOther(-13, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(6)"/><!--Pass-->
											<WTIMAGE value="CONST(greenchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="green">
												<WTLINK name="EditOther(-13, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(7)"/><!--Fail-->
											<WTIMAGE value="CONST(redchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="red">
												<WTLINK name="EditOther(-13, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-ASSESS)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)" connector="and"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)">
												<WTLINK name="EditOther(-31, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Pass-->
											<WTIMAGE value="CONST(greenchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="green">
												<WTLINK name="EditOther(-31, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Fail-->
											<WTIMAGE value="CONST(redchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="red">
												<WTLINK name="EditOther(-31, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-PROJECT)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)" connector="and"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)">
												<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Complete-->
											<WTIMAGE value="CONST(greenchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="green">
												<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Incomplete-->
											<WTIMAGE value="CONST(redchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="red">
												<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
									</WTCODEGROUP>		
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-TASK)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)" connector="and"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)">
												<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Complete-->
											<WTIMAGE value="CONST(greenchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="green">
												<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Incomplete-->
											<WTIMAGE value="CONST(redchecksm.gif)" imgalign="top"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(ApptName)" fontcolor="red">
												<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
											</WTSTATIC>
										</WTCODEGROUP>
									</WTCODEGROUP>		
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(Location)" oper="not-equal" value="CONST('')"/>
							<WTCONDITION expr="DATA(Note)" oper="not-equal" value="CONST('')" connector="or"/>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Appt.Location)" space="1"/>
								<WTSTATIC value="DATA(Appt.Note)" escape="false"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" align="center">
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsGoal)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-70.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Goals" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsLead)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-22.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Lead" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsSales)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-81.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Sales" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsActivities)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-90.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Notes" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsService)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-701.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Service" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsEvents)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-96.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Events" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsClass)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-13.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Classes" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsAssess)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-31.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Assessments" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsProject)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-75.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Apt-Projects" space="2"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Calendar.IsTask)" oper="not-equal" value="CONST(0)"/>
							<WTIMAGE value="CONST(Appt-74.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Appt-Tasks" space="2"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Refresh)" align="center">
						<WTCLICK>doSubmit(0,"")</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>