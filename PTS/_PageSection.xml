<WTROOT prefix="pts" color="Green" dbo="dbo" system="Pinnacle" language="false">
	<WTENTITY id="91" name="PageSection" alias="ps">

		<!--Identity-->
		<WTATTRIBUTE id="9101" name="PageSectionID" type="number" identity="true" min="1" required="true" source="entity"/>
	
		<!--Foreign Keys-->
		<WTATTRIBUTE id="9102" name="CompanyID" type="number" source="entity"/>

		<!--Foreign Table Fields-->

		<!--Attributes-->
		<WTATTRIBUTE id="9105" name="PageSectionName" type="text" length="40" min="1" max="40" source="entity" required="true" title="true"/>
		<WTATTRIBUTE id="9106" name="FileName" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="9107" name="Path" type="text" length="128" min="1" max="128" source="entity"/>
		<WTATTRIBUTE id="9108" name="Language" type="text" length="6" min="1" max="6" source="entity"/>				
		<WTATTRIBUTE id="9109" name="Width" type="number" min="50" source="entity"/>
		<WTATTRIBUTE id="9110" name="Custom" type="number" source="entity">
			<WTENUM id="1" name="Standard"/>
			<WTENUM id="2" name="Wide"/>
			<WTENUM id="3" name="Full"/>
		</WTATTRIBUTE>

		<!--Indexes-->
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="PageSection" entity="PageSection" alias="ps"/>
			<WTRELATIONSHIP name="Common" entity="PageSection" alias="ps"/>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="PageSectionName" default="true"/>
			<WTATTRIBUTE name="FileName"/>
			<WTATTRIBUTE name="Language"/>
		</WTENUM>

	</WTENTITY>

	<WTPROCEDURES>
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTCODEGROUP>
				<WTPROCEDURE name="Shortcut_DeleteItem">
					<WTPARAM name="EntityID" direction="input" value="ENTITY(PageSection)"/>
					<WTPARAM name="ItemID" direction="input" value="PARAM(PageSectionID)"/>
				</WTPROCEDURE>
				<WTDELETE>
					<WTJOIN name="PageSection" lock="true"/>
					<WTCONDITION expr="ATTR(PageSectionID)" oper="equal" value="PARAM(PageSectionID)"/>
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<WTPROCEDURE type="Count" name="Count" style="GenerateDataProc.xsl"/>

		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--==================================================================-->
		<WTWEBPAGE name="9101" caption="Find" header="false" footer="false" navbar="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(PageSectionName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="PageSections" project="ptsPageSectionUser" class="CPageSections"/>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="8" name="ImageManager" type="Add">
				<WTRETURN>
					<WTLINK name="3840">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="9" name="FileManager" type="Add">
				<WTRETURN>
					<WTLINK name="3841">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTOBJECT name="PageSections" project="ptsPageSectionUser" class="CPageSections">
				<WTMETHOD name="Find">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlPageSections" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(14)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTFUNCTION name="UploadPage(id)">
					var url, win;
					url = "9120.asp?PageSectionID=" + id
		            win = window.open(url,"UploadFile","top=100,left=100,height=200,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="DownloadPage(file,lang)">
					var url, win;
					var company = document.getElementById('CompanyID').value;
					var pos = file.indexOf('.htm')
					if(pos != 0) { file = file.substring(0,pos) }
					url = 'sections/company/' + company + '/' + file
					if(lang != '') { url = url + '[' + lang + ']' }
					url = url + '.htm'
		            win = window.open(url,"DownloadFile");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTSTATIC label="DownloadPage"/>
				<WTSTATIC label="UploadPage"/>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="100" align="left"/>
						<WTCOLUMN width="500" align="right"/>
						<WTROW>
							<WTSTATIC col="1" label="FindPageSection" class="PageHeading"/>
							<WTLINKGROUP  col="2" align="right" >
<!--
								<WTLINK name="3803" label="Company" class="PageHeadingLink">
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
								<WTLINK name="2809" label="Folders" class="PageHeadingLink">
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
-->								
								<WTLINK name="9102" label="NewPageSection" class="PageHeadingLink">
									<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
								<WTLINK name="91Import" label="Import" target="Import">
					 				<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
								<WTLINK name="9199" label="LanguageManager" return="false" class="PageHeadingLink" target="LanguageManager">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
							</WTLINKGROUP>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="PageFindText" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader"/>
					<WTCOMBO col="1" value="ATTR(PageSections.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)"/>
<!--					<WTBUTTON col="1" action="3" value="CONST(Return)"/>-->
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="true" entity="PageSection">
						<WTCOLUMN width="40" align="left" valign="top" label="PageSectionName"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Language"/>
						<WTCOLUMN width="35" align="left" valign="top" label="FileName"/>
						<WTCOLUMN width="10" align="right" valign="top"/>

						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(PageSection.PageSectionName)" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="9103">
											<WTPARAM name="PageSectionID" value="DATA(PageSection.PageSectionID)"/>
											<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
							 		<WTCONDITION expr="IsEmployee"/>
									<WTIMAGE value="CONST(ArrowDown.gif)" alt="Export" imgalign="absmiddle">
										<WTLINK name="ExportPageSection" target="Export">
											<WTPARAM name="PageSectionID" value="DATA(PageSection.PageSectionID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(PageSection.Language)">
								<WTLINK name="9103">
									<WTPARAM name="PageSectionID" value="DATA(PageSection.PageSectionID)"/>
									<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(PageSection.FileName)">
								<WTLINK name="9103">
									<WTPARAM name="PageSectionID" value="DATA(PageSection.PageSectionID)"/>
									<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Download.gif)" alt="DownloadPage">
										<WTLINK name="DownloadPage(&lt;xsl:value-of select=&quot;concat('&amp;quot;', @filename, '&amp;quot;,&amp;quot;', @language, '&amp;quot;')&quot;/&gt;)" click="true"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Upload.gif)" alt="UploadPage">
										<WTLINK name="UploadPage(&lt;xsl:value-of select=&quot;@pagesectionid&quot;/&gt;)" click="true"/>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" align="center" label="ImageManager" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" align="left" label="ImageManagerText" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" action="8" value="CONST(ImageManager)" align="center"/>
					</WTROW>
<!--
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" align="center" label="FileManager" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" align="left" label="FileManagerText" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" action="9" value="CONST(FileManager)" align="center"/>
					</WTROW>
-->
				</WTCODEGROUP>


			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="91Import" caption="Import PageSection" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="Cnt" datatype="number"/>

			<WTACTION id="1" name="Update" type="Update">
				<WTRETURN>
					<WTLINK name="ImportPageSection" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="ImportPageSection"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="prompt" align="center">
							<WTSTATIC label="ImportPageSectionText"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC tag="Company" value="PARAM(CompanyID)" newline="1"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC value="PARAM(Cnt)" space="1"/>
							<WTSTATIC label="ImportSuccess"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Import)" align="center">
				 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9102" caption="NewPageSection" contentpage="true"  wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" secured="52" focus="false">
		<!--==================================================================-->
			<WTPARAM name="EditWidth" datatype="number"/>
			<WTPARAM name="EditData" datatype="text"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="PageSection" project="ptsPageSectionUser" class="CPageSection">
					<WTMETHOD name="Load">
						<WTPARAM name="PageSectionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EditWidth)" value="72"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(&quot;en&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Width)" value="CONST(600)"/>
					<WTSETATTRIBUTE name="ATTR(Custom)" value="CONST(1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPageSection" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTOBJECT name="PageSection" project="ptsPageSectionUser" class="CPageSection">
					<WTMETHOD name="Load">
						<WTPARAM name="PageSectionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(.PageSectionName + &quot;.htm&quot;)">
						<WTCONDITION expr="ATTR(Filename)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpFile)" value="ATTR(Filename)"/>
					<WTSETATTRIBUTE name="CONST(tmpLang)" value="ATTR(Language)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="PageSectionID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlPageSection" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTSETATTRIBUTE name="CONST(tmpData)" value="FORM(Data)"/>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpData)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpFile)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))">
						<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(tmpLang)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" label="NewPageSection" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="18">
					<WTMEMO col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" cols="PARAM(EditWidth)" rows="30" htmleditor="true" embedhtml="true"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PageSectionName"/>
					<WTTEXT col="2" value="ATTR(PageSection.PageSectionName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Language"/>
					<WTTEXT col="2" value="ATTR(PageSection.Language)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Custom"/>
					<WTCOMBO col="2" value="ATTR(PageSection.Custom)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="FileName"/>
					<WTTEXT col="2" value="ATTR(PageSection.FileName)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsSysAdmin"/>
					<WTROW>
						<WTSTATIC col="1" tag="Width"/>
						<WTTEXT col="2" value="ATTR(PageSection.Width)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="NotSysAdmin"/>
					<WTHIDDEN value="ATTR(PageSection.Width)"/>
				</WTROW>

				<WTROW margin-bottom="12" margin-top="12">
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" action="2" value="CONST(Add)">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)"/>
				</WTROW>
				
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9103" caption="PageSection" contentpage="true"  wrapper="wrapper600"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52" focus="false">
		<!--==================================================================-->
			<WTPARAM name="PageSectionID" datatype="number"/>
			<WTPARAM name="EditWidth" datatype="number"/>
			<WTPARAM name="Empty" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>

			<WTSUB name="SavePageSection">
				<WTOBJECT name="PageSection" project="ptsPageSectionUser" class="CPageSection">
					<WTMETHOD name="Load">
						<WTPARAM name="PageSectionID" direction="input" value="PARAM(PageSectionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(.PageSectionName + &quot;.htm&quot;)">
						<WTCONDITION expr="ATTR(Filename)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlPageSection" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTSETATTRIBUTE name="CONST(tmpData)" value="FORM(Data)"/>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpData)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="FORM(FileName)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID))">
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="FORM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">

				<WTOBJECT name="PageSection" project="ptsPageSectionUser" class="CPageSection">
					<WTMETHOD name="Load">
						<WTPARAM name="PageSectionID" direction="input" value="PARAM(PageSectionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Custom)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(EditWidth)" value="72">
							<WTCONDITION expr="ATTR(Width)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(EditWidth)" value="CONST( CInt(.Width/8.3333) )">
							<WTCONDITION expr="ATTR(Width)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Custom)" oper="not-equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Custom)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="PARAM(EditWidth)" value="CONST(72)"/>
							<WTSETATTRIBUTE name="ATTR(PageSection.Width)" value="CONST(600)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Custom)" oper="equal" value="CONST(2)"/>
							<WTCONDITION expr="ATTR(Custom)" oper="equal" value="CONST(3)" connector="or"/>
							<WTSETATTRIBUTE name="PARAM(EditWidth)" value="CONST(89)"/>
							<WTSETATTRIBUTE name="ATTR(PageSection.Width)" value="CONST(740)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpFile)" value="ATTR(Filename)"/>
					<WTSETATTRIBUTE name="CONST(tmpLang)" value="ATTR(Language)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPageSection" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(Empty)" oper="equal" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpFile)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID))">
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(tmpLang)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="&quot; &quot;"/>
					<WTMETHOD name="Save"/>
				</WTOBJECT>

				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpFile)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID))">
						<WTCONDITION expr="CONST(tmpCompanyID)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(tmpLang)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="SavePageSection"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTCONDITION expr="IsEmployee"/>
				<WTOBJECT name="PageSection" project="ptsPageSectionUser" class="CPageSection">
					<WTMETHOD name="Delete">
						<WTPARAM name="PageSectionID" direction="input" value="PARAM(PageSectionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="PageSection" project="ptsPageSectionUser" class="CPageSection">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PageSectionID" direction="input" value="PARAM(PageSectionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPageSection" direction="return" datatype="text"/>
						<WTPARAM name="Options" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="5" name="Preview" type="Update">
				<WTCALLSUB name="SavePageSection"/>
				<WTSETATTRIBUTE name="CONST(tmpCustom)" value="FORM(Custom)"/>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;tmpPageSection.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="FORM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTRETURN>
						<WTCONDITION expr="CONST(tmpCustom)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpCustom)" oper="equal" value="CONST(1)" connector="or"/>
						<WTLINK name="Page" skipreturn="true">
							<WTPARAM name="Page" value="CONST(&quot;tmpPageSection&quot;)"/>
							<WTPARAM name="PageSectionID" value="PARAM(PageSectionID)"/>
						</WTLINK>
					</WTRETURN>
					<WTRETURN>
						<WTCONDITION expr="CONST(tmpCustom)" oper="equal" value="CONST(2)"/>
						<WTLINK name="PageWide" skipreturn="true">
							<WTPARAM name="Page" value="CONST(&quot;tmpPageSection&quot;)"/>
							<WTPARAM name="PageSectionID" value="PARAM(PageSectionID)"/>
						</WTLINK>
					</WTRETURN>
					<WTRETURN>
						<WTCONDITION expr="CONST(tmpCustom)" oper="equal" value="CONST(3)"/>
						<WTLINK name="PageFull" skipreturn="true">
							<WTPARAM name="Page" value="CONST(&quot;tmpPageSection&quot;)"/>
							<WTPARAM name="PageSectionID" value="PARAM(PageSectionID)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" tag="PageSection" value="ATTR(PageSection.PageSectionName)" class="PageHeading"/>
					<WTIMAGE col="1" merge="2" value="CONST(Shortcut.gif)">
						<WTCONDITION expr="NotMemberOnly"/>
						<WTCONDITION expr="_IsShortcuts" connector="or"/>
						<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
							<WTPARAM name="EntityID" value="ENTITY(PageSection)"/>
							<WTPARAM name="ItemID" value="ATTR(PageSection.PageSectionID)"/>
							<WTPARAM name="Name" value="ATTR(PageSection.PageSectionName)" clean="true"/>
							<WTPARAM name="URL" value="SYS(PageURL)"/>
						</WTLINK>
					</WTIMAGE>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="5" value="CONST(Preview)" align="center"/>
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>
				<WTROW margin-bottom="18">
					<WTMEMO col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" cols="PARAM(EditWidth)" rows="30" htmleditor="true" embedhtml="true"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PageSectionName"/>
					<WTTEXT col="2" value="ATTR(PageSection.PageSectionName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Language"/>
					<WTTEXT col="2" value="ATTR(PageSection.Language)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="ATTR(PageSection.Custom)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="CustomText" class="prompt" newline="1">
						<WTSTATIC newline="1"/>
						<WTSTATIC label="Custom1Link"/>
						<WTSTATIC value="ATTR(PageSection.PageSectionName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="ATTR(PageSection.Custom)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="CustomText" class="prompt">
						<WTSTATIC newline="1"/>
						<WTSTATIC label="Custom2Link"/>
						<WTSTATIC value="ATTR(PageSection.PageSectionName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="ATTR(PageSection.Custom)" oper="equal" value="CONST(3)"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="CustomText" class="prompt" newline="1">
						<WTSTATIC newline="1"/>
						<WTSTATIC label="Custom3Link"/>
						<WTSTATIC value="ATTR(PageSection.PageSectionName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Custom"/>
					<WTCOMBO col="2" value="ATTR(PageSection.Custom)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="FileName"/>
					<WTTEXT col="2" value="ATTR(PageSection.FileName)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsSysAdmin"/>
<!--
					<WTROW>
						<WTSTATIC col="1" tag="Path"/>
						<WTTEXT col="2" value="ATTR(PageSection.Path)"/>
					</WTROW>
-->
					<WTROW>
						<WTSTATIC col="1" tag="Width"/>
						<WTTEXT col="2" value="ATTR(PageSection.Width)"/>
					</WTROW>
				</WTCODEGROUP>
			
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="5" value="CONST(Preview)" align="center"/>
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
				</WTROW>
				
				<WTROW>
					<WTCONDITION expr="NotSysAdmin"/>
<!--					<WTHIDDEN value="ATTR(PageSection.Path)"/>-->
					<WTHIDDEN value="ATTR(PageSection.Width)"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="9120" caption="Upload File" action="false" submit="9120Upload.asp" type="multi" wrapper="wrapper400"
			navbar="false" header="false" footer="false" page-left="0" margin="false" 
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="PageSectionID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			<WTPARAM name="DeleteFile" datatype="text"/>
			<WTPARAM name="FileName" datatype="text"/>
			<WTPARAM name="Status" datatype="number"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>DoError reqUploadError, "Upload", reqUploadErrorDesc</WTCUSTOM>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="PageSection" project="ptsPageSectionUser" class="CPageSection">
					<WTMETHOD name="Load">
						<WTPARAM name="PageSectionID" direction="input" value="PARAM(PageSectionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
<WTCUSTOM>
	reqFilename = .Filename
	pos = InStr(reqFilename, ".htm")
	If pos &gt; 0 Then reqFileName = Left(reqFilename, pos-1)
	If .Language &lt;&gt; "" Then reqFileName = reqFileName + "[" + .Language + "]"
</WTCUSTOM>			
				</WTOBJECT>
				<WTSETCACHE name="PAGESECTIONID" value="PARAM(PageSectionID)"/>
				<WTSETCACHE name="COMPANYID" value="PARAM(CompanyID)"/>
				<WTSETCACHE name="FILENAME" value="PARAM(FileName)"/>
			</WTACTION>			

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" label="UploadPage" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(FileName)" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" label="UploadPageText" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="18">
						<WTFILE col="1" align="center" value="upload" accept="*.htm" size="30"/>
						<WTBUTTON col="1" align="center" default="true" action="1" value="CONST(Submit)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(1)"/>
					<WTROW margin-top="36" margin-bottom="12">
						<WTSTATIC col="1" label="UploadPageSuccessful" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="24">
						<WTSTATIC col="1" value="PARAM(FileName)" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW>
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>	

		<!--==================================================================-->
		<WTWEBPAGE name="Page" caption="Info Page" navbar="false" header="false" footer="false" wrapper="wrapper750"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="Page" datatype="text"/>
			<WTPARAM name="Language" datatype="text"/>
			<WTPARAM name="PageSectionID" datatype="number"/>
			<WTPARAM name="Company" datatype="number"/>

			<WTINCLUDE name="Company.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Language)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Language)" value="SYS(language)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTCALLSUB name="GetCompany(reqCompany)"/>
				</WTCODEGROUP>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPage + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="PARAM(Company)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; &amp; reqCompany )">
						<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN>
					<WTLINK name="9103" skipreturn="true">
						<WTPARAM name="PageSectionID" value="PARAM(PageSectionID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="24" margin-bottom="12">
					<WTCONDITION expr="PARAM(PageSectionID)" oper="greater" value="CONST(0)"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_Page" caption="Info Page" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp" secured="98">
			<!--==================================================================-->
			<WTPARAM name="Page" datatype="text"/>
			<WTPARAM name="Language" datatype="text"/>
			<WTPARAM name="PageSectionID" datatype="number"/>
			<WTPARAM name="Company" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Return" datatype="number"/>

			<WTINCLUDE name="Company.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Language)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Language)" value="SYS(language)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTCALLSUB name="GetCompany(reqCompany)"/>
				</WTCODEGROUP>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPage + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="PARAM(Company)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; &amp; reqCompany )">
						<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTCUSTOM>
							xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqMemberID )
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="24" margin-bottom="12">
					<WTCONDITION expr="PARAM(Return)" oper="greater" value="CONST(0)"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================================-->
    <WTWEBPAGE name="Pagez" caption="Info Page" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--===============================================================================================-->
			<WTPARAM name="Page" datatype="text"/>
			<WTPARAM name="Language" datatype="text"/>
			<WTPARAM name="Company" datatype="number"/>

			<WTINCLUDE name="Company.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Language)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Language)" value="SYS(language)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTCALLSUB name="GetCompany(reqCompany)"/>
				</WTCODEGROUP>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPage + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="PARAM(Company)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; &amp; reqCompany )">
						<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="PageSys" caption="Info Page" navbar="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="Page" datatype="text"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPage + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="24" margin-bottom="12">
					<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="Pagex" caption="Info Page" navbar="false" header="false" footer="false" page-left="10" wrapper="wrapper750"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="Page" datatype="text"/>
			<WTPARAM name="Company" datatype="number"/>

			<WTINCLUDE name="Company.asp"/>
			
			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTCALLSUB name="GetCompany(reqCompany)"/>
				</WTCODEGROUP>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPage + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="PARAM(Company)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; &amp; reqCompany )">
						<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE  name="PageWide" caption="Info Page" wrapper="wrapper750"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" navbar="false">
		<!--==================================================================-->
			<WTPARAM name="Page" datatype="text"/>
			<WTPARAM name="PageSectionID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPage + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN>
					<WTLINK name="9103" skipreturn="true">
						<WTPARAM name="PageSectionID" value="PARAM(PageSectionID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="740" align="left"/>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="24" margin-bottom="12">
					<WTCONDITION expr="PARAM(PageSectionID)" oper="greater" value="CONST(0)"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--==================================================================-->
		<WTWEBPAGE  name="PageFull" caption="Info Page" wrapper="wrapper750"
			aspstyle="GenerateWebASP.xsl" navbar="false" footer="false" header="false" xslstyle="GenerateWebXSLItem.xsl">
		<!--==================================================================-->
			<WTPARAM name="Page" datatype="text"/>
			<WTPARAM name="PageSectionID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqPage + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN>
					<WTLINK name="9103" skipreturn="true">
						<WTPARAM name="PageSectionID" value="PARAM(PageSectionID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="740" align="left"/>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="24" margin-bottom="12">
					<WTCONDITION expr="PARAM(PageSectionID)" oper="greater" value="CONST(0)"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="9198" caption="Language Page" navbar="false" langfile="9198" wrapper="wrapper750"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="52">
			<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="File" datatype="text" />
			<WTPARAM name="Language" datatype="text" />

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
	tmpLanguage = "en"
	'---check if language file exists
	'---if the selected language doesn't exist, initialize with english
	If reqLanguage &lt;&gt; "en" Then
      If (reqCompanyID = 0) Then
         path = "Sections"
      Else
         path = "Sections\Company\" + CStr(reqCompanyID) 
      End If

		filename = path + "\" + reqFile + "[" + reqLanguage + "].htm"

		Set oFileSys = CreateObject("Scripting.FileSystemObject")
		If oFileSys Is Nothing Then
			Response.Write "Scripting.FileSystemObject failed to load"
			Response.End
		End If

		'---check if file exists, if not, initialize with the english version
		If oFileSys.FileExists(reqSysWebDirectory + filename) Then
			tmpLanguage = reqLanguage
		End If
	End If
</WTCUSTOM>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqFile + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))">
						<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(tmpLanguage)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="3" name="Update" type="Update">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqFile + &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))">
						<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTSTATIC label="Changes" />
				<WTROW margin-top="3">
					<WTSTATIC col="1" align="left" tag="CustomPage" class="PageHeading" space="3">
						<WTSTATIC value="PARAM(File)" />
						<WTSTATIC value="CONST( - )" />
						<WTSTATIC value="PARAM(Language)" />
					</WTSTATIC>
					<WTBUTTON col="1" action="3" value="CONST(Update)"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTSTATIC col="1" class="PageHeading">
						<WTCONDITION expr="PARAM(Language)" oper="not-equal" value="CONST('en')" />
						<WTSTATIC space="3"/>
						<WTSTATIC label="BabelFish"/>
	 					<WTLINK name="CONST(http://babelfish.altavista.com)" return="false" type="Anchor" target="BabelFish"/>
					</WTSTATIC>
					<WTSTATIC col="1" class="PageHeading">
						<WTCONDITION expr="PARAM(Language)" oper="not-equal" value="CONST('en')" />
						<WTSTATIC space="3"/>
						<WTSTATIC label="EnglishVersion"/>
	 					<WTLINK name="Page" return="false" target="EnglishVersion">
							<WTPARAM name="Company" value="PARAM(CompanyID)"/>
							<WTPARAM name="Page" value="PARAM(File)"/>
	 					</WTLINK>
					</WTSTATIC>
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC space="3"/>
						<WTSTATIC label="Preview"/>
	 					<WTLINK name="Page" return="false" target="Preview">
							<WTPARAM name="Company" value="PARAM(CompanyID)"/>
							<WTPARAM name="Page" value="PARAM(File)"/>
							<WTPARAM name="Language" value="PARAM(Language)"/>
	 					</WTLINK>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3">
					<WTCONDITION expr="PARAM(Language)" oper="not-equal" value="CONST('en')" />
					<WTSTATIC col="1" align="right" bold="true">
						<WTSTATIC tag="TranslateURL"/>
						<WTSTATIC value="CONST(http://&lt;xsl:value-of select=&quot;/DATA/SYSTEM/@servername&quot;/&gt;&lt;xsl:value-of select=&quot;/DATA/SYSTEM/@serverpath&quot;/&gt;pagex.asp?page=&lt;xsl:value-of select=&quot;/DATA/PARAM/@file&quot;/&gt;)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="6">
					<WTDIVIDER col="1" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				
				<WTROW>
					<WTMEMO col="1" align="center" value="ATTR(HTMLFile.Data)" cols="89" rows="30" htmleditor="true" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="9199" caption="Language Manager" navbar="false" langfile="9199" wrapper="wrapper750"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="52">
			<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="Language" datatype="text" />
			<WTPARAM name="Changes" datatype="number" />
			<WTDATATXN name="Lang" />
			<WTDATATXN name="File" />
			<WTINCLUDE name="XML.asp" />
			
<!-- ********************************************************************************* -->
			<WTSUB name="LoadLanguages">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpLanguages)" value="ATTR(Languages)" />
<WTCUSTOM>
	xmlLang = "&lt;PTSLANG&gt;"
	Do While Len(tmpLanguages) &lt;&gt; 0
		pos = InStr(tmpLanguages, ";")
		If pos = 0 Then
			Language = tmpLanguages
			tmpLanguages = ""
		Else
			Language = Left(tmpLanguages, pos - 1)
			tmpLanguages = mID(tmpLanguages, pos + 1)
		End If
		pos = InStr(Language, ",")
		If pos &gt; 0 Then
			id = Left(Language, pos - 1)
			name = mID(Language, pos + 1)
			'Only the system administrator can edit the English (Master) Language Labels
			If (id &lt;&gt; "en") or (reqSysUserGroup=1) Then
				xmlLang = xmlLang + "&lt;ENUM id=""" + id + """ name=""" + name + """"
				If id = reqLanguage Then xmlLang = xmlLang + " selected=""true"""
				xmlLang = xmlLang + "/&gt;"
			End If
		End If
	Loop
	xmlLang = xmlLang + "&lt;/PTSLANG&gt;"
</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>

<!-- ********************************************************************************* -->
			<WTSUB name="LoadFiles">
<WTCUSTOM>
	Path = "Sections"
	filename = "Sections\Translate.xml"
	Set oMaster = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oMaster.load server.MapPath(filename)
	If oMaster.parseError &lt;&gt; 0 Then
		Response.Write "Custom Pages Load file failed with error code " + CStr(oMaster.parseError)
		Response.End
	End If
	
	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	If oFileSys Is Nothing Then
		Response.Write "Scripting.FileSystemObject failed to load"
		Response.End
	End If

	xmlFile = "&lt;PTSFILES&gt;"
   Set oPages = oMaster.selectNodes("PTSFILES/PTSFILE")
   For Each oPage In oPages
      sName = oPage.getAttribute("name")

		'---check if the english file exists, if so, add it to our list and lookup dates
		Filename = sName + "[en].htm"
		If oFileSys.FileExists(reqSysWebDirectory + Path + "\" + Filename) Then
			Set oFile = oFileSys.GetFile(reqSysWebDirectory + Path + "\" + Filename)
			sDate = oFile.DateLastModified

			xmlFile = xmlFile + "&lt;PTSFILE name=""" + sName + """ date=""" &amp; sDate &amp; """"

			If reqLanguage &lt;&gt; "en" Then
				'get the current language version of this file
				Filename = sName + "[" + reqLanguage + "].htm"
				'---check if the language file exists
				If oFileSys.FileExists(reqSysWebDirectory + Path + "\" + Filename) Then
					Set oFileLang = oFileSys.GetFile(reqSysWebDirectory + Path + "\" + Filename)
					sLangDate = oFileLang.DateLastModified

					xmlFile = xmlFile + " langdate=""" &amp; sLangDate &amp; """"

					'-----if language file is older than English File, it needs to be updated
					If CDate(sDate) &gt; CDate(sLangDate) Then
						xmlFile = xmlFile + " update=""True"""
					End If                  

					Set oFileLang = Nothing
				Else	
					xmlFile = xmlFile + " update=""True"""
				End If
			End If

			xmlFile = xmlFile + "/&gt;"
		End If
   Next
	xmlFile = xmlFile + "&lt;/PTSFILES&gt;"
   Set oPages = Nothing
	Set oFileSys = Nothing
	Set oMaster = Nothing
</WTCUSTOM>
			</WTSUB>

<!-- ********************************************************************************* -->
			<WTSUB name="LoadCompanyFiles">
<WTCUSTOM>
	Path = "Sections\Company\" &amp; reqCompanyID
	
	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	If oFileSys Is Nothing Then
		Response.Write "Scripting.FileSystemObject failed to load"
		Response.End
	End If

	'---get list of english files [en] from the directory
   Set Folder = oFileSys.GetFolder(reqSysWebDirectory + Path)
   Set Files = Folder.Files

	'---walk through list of english files to build file list
	xmlFile = "&lt;PTSFILES&gt;"
   For Each File In Files
      sName = File.Name
      pos = 0 
      'Skip Msg Files
      If Left(sName, 3) &lt;&gt; "Msg" Then 
	      pos = InStr( sName, "[en].htm" )
	   End If   
		If pos &gt; 0 Then
			sName = Left( sName, pos-1 )
			sDate = File.DateLastModified

			xmlFile = xmlFile + "&lt;PTSFILE name=""" + sName + """ date=""" &amp; sDate &amp; """"
			
			'get the current language version of this file
			LangFile = Replace( File.Name, "[en]", "[" + reqLanguage + "]" )

			If reqLanguage &lt;&gt; "en" Then
				'---check if file exists
				If oFileSys.FileExists(reqSysWebDirectory + Path + "\" + LangFile) Then
					Set oFile = oFileSys.GetFile(reqSysWebDirectory + Path + "\" + LangFile)

					sLangDate = oFile.DateLastModified
					xmlFile = xmlFile + " langdate=""" &amp; sLangDate &amp; """"

					'-----if language file is older than English File, it needs to be updated
					If CDate(sDate) &gt; CDate(sLangDate) Then
						xmlFile = xmlFile + " update=""True"""
					End If                  

					Set oFile = Nothing
				Else	
					xmlFile = xmlFile + " update=""True"""
				End If
			End If

			xmlFile = xmlFile + "/&gt;"
		End If
   Next
	xmlFile = xmlFile + "&lt;/PTSFILES&gt;"
   Set Files = Nothing
   Set Folder = Nothing
	Set oFileSys = Nothing
</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Changes)" value="CONST(0)"/>
				<WTCALLSUB name="LoadLanguages"/>
			</WTACTION>

			<WTACTION id="5" name="Go" type="Update">
				<WTCALLSUB name="LoadLanguages"/>
				<WTCALLSUB name="LoadFiles">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadCompanyFiles">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left" />
				<WTCOLUMN width="450" align="left" />
				<WTCOLUMN width="150" align="left" />
				<WTSTATIC label="Changes" />
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1" merge="3" align="left" label="LanguageManager" class="PageHeading" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" label="LanguageManagerText" align="left" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" tag="Language" class="ColumnHeader" align="center" />
					<WTCOMBO col="1" merge="3" name="Language" datapath="DATA/TXN/PTSLANG/ENUM" />
					<WTBUTTON col="1" merge="3" action="5" value="CONST(Go)" default="true" />
					<WTCHECK col="1" merge="3" value="PARAM(Changes)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(count(DATA/TXN/PTSFILES/PTSFILE))" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" />
					<WTRECORDSET col="2" graybar="true" entity="File">
						<WTCOLUMN width="30" align="left" valign="top" label="File" />
						<WTCOLUMN width="35" align="center" valign="top" label="English" />
						<WTCOLUMN width="35" align="center" valign="top" label="Language" />
						<WTROW>
							<WTCONDITION expr="CONST(@)" value="CONST(update)" />
							<WTSTATIC col="1" value="DATA(Name)" bold="true">
								<WTLINK name="9198" target="blank">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
									<WTPARAM name="File" value="DATA(Name)" />
									<WTPARAM name="Language" value="PARAM(Language)" />
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Date)" bold="true" />
							<WTSTATIC col="3" value="DATA(Langdate)" bold="true" />
						</WTROW>
						<WTROW>
							<WTCONDITION expr="PARAM(Language)" oper="equal" value="CONST('en')" />
							<WTCONDITION expr="CONST(not(@)" value="CONST(update))" connector="or" paren="start" />
							<WTCONDITION expr="PARAM(Changes)" oper="equal" value="CONST(0)" connector="and" paren="end" />
							<WTSTATIC col="1" value="DATA(Name)">
								<WTLINK name="9198" target="blank">
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
									<WTPARAM name="File" value="DATA(Name)" />
									<WTPARAM name="Language" value="PARAM(Language)" />
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Date)" />
							<WTSTATIC col="3" value="DATA(Langdate)" />
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTROW margin-bottom="12"/>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>