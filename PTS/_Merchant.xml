<WTROOT prefix="pts" system="Pinnacle">
	<WTENTITY id="150" name="Merchant" alias="mer">

		<!--Identity-->
		<WTATTRIBUTE id="15001" name="MerchantID" type="number" identity="true" min="1" title="true" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="15002" name="MemberID" type="number" source="entity"/>
		<WTATTRIBUTE id="15003" name="BillingID" type="number" source="entity"/>
		<WTATTRIBUTE id="15004" name="PayoutID" type="number" source="entity"/>
    <WTATTRIBUTE id="15005" name="CountryID" type="number" source="entity"/>
    <WTATTRIBUTE id="15006" name="SweepID" type="number" source="entity"/>

    <!--Foreign Table Fields-->
    <WTATTRIBUTE id="15007" name="MemberNameLast" type="text" length="30" source="join">
      <WTJOIN entity="Member" name="NameLast"/>
    </WTATTRIBUTE>
    <WTATTRIBUTE id="15008" name="MemberNameFirst" type="text" length="30" source="join">
      <WTJOIN entity="Member" name="NameFirst"/>
    </WTATTRIBUTE>
    <WTATTRIBUTE id="15009" name="MemberName" type="text" length="61" min="1" max="61" source="entity">
      <WTCOMPUTE name="MemberNameFirst"/>
      <WTCOMPUTE text=" "/>
      <WTCOMPUTE name="MemberNameLast"/>
    </WTATTRIBUTE>
    <WTATTRIBUTE id="15010" name="CountryName" type="text" length="50" source="join">
			<WTJOIN entity="Country" name="CountryName"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="15011" name="MerchantName" type="text" length="80" min="1" max="80" source="entity" required="true"/>
		<WTATTRIBUTE id="15012" name="NameLast" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="15013" name="NameFirst" type="text" length="30" min="1" max="30" required="true" source="entity"/>
		<WTATTRIBUTE id="15014" name="Email" type="text" length="80" min="1" max="80" required="true" source="entity"/>
    <WTATTRIBUTE id="15015" name="Email2" type="text" length="80" min="1" max="80" source="entity"/>
    <WTATTRIBUTE id="15016" name="Email3" type="text" length="80" min="1" max="80" source="entity"/>
    <WTATTRIBUTE id="15017" name="Phone" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="15018" name="Phone2" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="15019" name="Password" type="text" length="20" min="1" max="20" required="true" source="entity"/>
		<WTATTRIBUTE id="15020" name="Password2" type="text" length="20" min="1" max="20" required="true" source="entity"/>
		<WTATTRIBUTE id="15021" name="Password3" type="text" length="20" min="1" max="20" source="entity"/>
		<WTATTRIBUTE id="15022" name="Password4" type="text" length="20" min="1" max="20" source="entity"/>
		<WTATTRIBUTE id="15023" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Prelaunch"/>
			<WTENUM id="2" name="Setup"/>
			<WTENUM id="3" name="Active"/>
			<WTENUM id="4" name="Cancelled"/>
      <WTENUM id="5" name="Removed"/>
      <WTENUM id="6" name="Demo"/>
    </WTATTRIBUTE>
		<WTATTRIBUTE id="15024" name="Street1" type="text" length="60" min="1" max="60" source="entity" required="true"/>
		<WTATTRIBUTE id="15025" name="Street2" type="text" length="60" min="1" max="60" source="entity"/>
		<WTATTRIBUTE id="15026" name="City" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="15027" name="State" type="text" length="30" min="1"  max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="15028" name="Zip" type="text" length="20" min="1"  max="20" source="entity" required="true"/>
		<WTATTRIBUTE id="15029" name="Referrals" type="number" source="entity"/>
		<WTATTRIBUTE id="15030" name="Referrals2" type="number" source="entity"/>
		<WTATTRIBUTE id="15031" name="VisitDate" type="date" source="entity">
			<WTFORMAT value="m-d-yy h:mm am/pm"/>
		</WTATTRIBUTE>
    <WTATTRIBUTE id="15032" name="IsOrg" type="yesno" source="entity"/>
    <WTATTRIBUTE id="15033" name="IsAwards" type="yesno" source="entity"/>
		<WTATTRIBUTE id="15034" name="EnrollDate" type="date" source="entity">
			<WTFORMAT value="m-d-yy h:mm am/pm"/>
		</WTATTRIBUTE>
    <WTATTRIBUTE id="15035" name="BillDate" type="date" source="entity"/>
    <WTATTRIBUTE id="15036" name="BillDays" type="number" source="entity"/>

    <WTATTRIBUTE id="15037" name="Image" type="text" length="40" min="1" max="40" source="entity"/>
    <WTATTRIBUTE id="15038" name="Description" type="text" length="2000" min="1" max="2000" source="entity" embedhtml="true"/>
    <WTATTRIBUTE id="15039" name="Terms" type="text" length="100" min="1" max="100" source="entity"/>
    <WTATTRIBUTE id="15040" name="Options" type="text" length="20" source="entity" language="false"/>
    <WTATTRIBUTE id="15041" name="StoreOptions" type="text" length="20" source="entity" language="false"/>
    <WTATTRIBUTE id="15042" name="Colors" type="text" length="100" source="entity" language="false"/>
    <WTATTRIBUTE id="15043" name="Rating" type="number" source="entity"/>
    <WTATTRIBUTE id="15044" name="CurrencyCode" type="text" length="3" min="1" max="3" source="entity" language="false"/>
    <WTATTRIBUTE id="15045" name="Processor" type="number" source="entity"/>
    <WTATTRIBUTE id="15046" name="Payment" type="text" length="1000" source="entity" language="false"/>
    <!--Security Fields -->
    <WTATTRIBUTE id="15047" name="UserKey" type="text" length="40" min="1" max="40" source="entity" language="false"/>
    <WTATTRIBUTE id="15048" name="UserKey3" type="text" length="40" min="1" max="40" source="entity" language="false"/>
    <WTATTRIBUTE id="15049" name="UserKey4" type="text" length="40" min="1" max="40" source="entity" language="false"/>
    <WTATTRIBUTE id="15050" name="UserCode" type="text" length="10" min="1" max="10" source="entity" language="false"/>
    <WTATTRIBUTE id="15051" name="Access" type="text" length="80" min="1" max="80" source="entity" language="false"/>
    <WTATTRIBUTE id="15052" name="PromoLimit" type="number" source="entity"/>
    <WTATTRIBUTE id="15053" name="SweepRate" type="number" source="entity"/>
    <WTATTRIBUTE id="15054" name="TimeZone" type="number" source="entity"/>
    <WTATTRIBUTE id="15055" name="GeoCode" type="text" length="30" min="1" max="30" source="entity" language="false"/>
    <WTATTRIBUTE id="15056" name="ReferRate" type="number" source="entity"/>

    <!-- Non Persist Fields -->
    <WTATTRIBUTE id="15090" name="Target" type="text" length="200" min="1"  max="200" source="entity" persist="false"/>
    <WTATTRIBUTE id="15091" name="RewardAmt" type="currency" source="entity" persist="false">
      <WTFORMAT value="##,###.00" />
    </WTATTRIBUTE>
    <WTATTRIBUTE id="15092" name="RewardDesc" type="text" length="100" min="1" max="100" source="entity" persist="false"/>
    <WTATTRIBUTE id="15093" name="RewardCap" type="currency" source="entity" persist="false"/>

    <WTINDEX name="MemberID">
      <WTATTRIBUTE name="MemberID"/>
    </WTINDEX>
    <WTINDEX name="Email">
      <WTATTRIBUTE name="Email"/>
    </WTINDEX>
    <WTINDEX name="Zip">
			<WTATTRIBUTE name="CountryID"/>
			<WTATTRIBUTE name="Zip"/>
		</WTINDEX>
		<WTINDEX name="State">
			<WTATTRIBUTE name="State"/>
		</WTINDEX>
		<WTINDEX name="City">
			<WTATTRIBUTE name="City"/>
		</WTINDEX>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Merchant" entity="Merchant" alias="mer"/>
			<WTRELATIONSHIP name="Common" entity="Merchant" alias="mer">
        <WTENTITY name="Member" entity="Member" alias="me">
          <WTATTRIBUTE alias="mer" name="MemberID" relalias="me" relname="MemberID"/>
        </WTENTITY>
        <WTENTITY name="Country" entity="Country" alias="cou">
          <WTATTRIBUTE alias="mer" name="CountryID" relalias="cou" relname="CountryID"/>
        </WTENTITY>
      </WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="MerchantName" default="true"/>
      <WTATTRIBUTE name="MerchantID"/>
      <WTATTRIBUTE name="NameLast"/>
      <WTATTRIBUTE name="NameFirst"/>
      <WTATTRIBUTE name="Email"/>
      <WTATTRIBUTE name="Zip"/>
      <WTATTRIBUTE name="City"/>
      <WTATTRIBUTE name="State"/>
      <WTATTRIBUTE name="MemberID"/>
    </WTENUM>

  <WTCONDITIONS>
      <WTCONDITION name="IsPinNumber"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;A&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="IsTicketNumber"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;B&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="IsOrderEmail"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;C&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="IsApproveOrder"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;D&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="IsShopperOrder"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;E&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>

      <WTCONDITION name="NotPinNumber"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;A&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="NotTicketNumber"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;B&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="NotOrderEmail"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;C&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="NotApproveOrder"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;D&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="NotShopperOrder"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;E&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
      
      <WTCONDITION name="_IsPinNumber"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@Options, 'A'))"/></WTCONDITION>
      <WTCONDITION name="_IsTicketNumber"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@Options, 'B'))"/></WTCONDITION>
      <WTCONDITION name="_IsOrderEmail"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@Options, 'C'))"/></WTCONDITION>
      <WTCONDITION name="_IsApproveOrder"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@Options, 'D'))"/></WTCONDITION>
      <WTCONDITION name="_IsShopperOrder"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@Options, 'E'))"/></WTCONDITION>

      <WTCONDITION name="__IsPinNumber"><WTCONDITION expr="CONST(contains)" value="CONST((@Options, 'A'))"/></WTCONDITION>
      <WTCONDITION name="__IsTicketNumber"><WTCONDITION expr="CONST(contains)" value="CONST((@Options, 'B'))"/></WTCONDITION>
      <WTCONDITION name="__IsOrderEmail"><WTCONDITION expr="CONST(contains)" value="CONST((@Options, 'C'))"/></WTCONDITION>

  		<WTCONDITION name="IsStore3DBox"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;A&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="IsStoreImageRight"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;B&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="IsStoreShowAddress"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;C&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="IsStoreShowEmail"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;D&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="IsStoreShowPhone"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;E&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="IsStoreShowContact"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;F&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="IsStoreNoBackground"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;G&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="IsStoreShowMap"><WTCONDITION expr="CONST(InStr(reqOptions,&quot;H&quot;))" oper="not-equal" value="CONST(0)"/></WTCONDITION>

      <WTCONDITION name="NotStoreImageRight"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;B&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="NotStoreShowAddress"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;C&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="NotStoreShowEmail"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;D&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="NotStoreShowPhone"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;E&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
  		<WTCONDITION name="NotStoreShowContact"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;F&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="NotStoreNoBackground"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;G&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>
      <WTCONDITION name="NotStoreShowMap"><WTCONDITION expr="CONST(InStr(reqStoreOptions,&quot;H&quot;))" oper="equal" value="CONST(0)"/></WTCONDITION>

      <WTCONDITION name="_IsStoreImageRight"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'B'))"/></WTCONDITION>
  		<WTCONDITION name="_IsStoreShowAddress"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'C'))"/></WTCONDITION>
  		<WTCONDITION name="_IsStoreShowEmail"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'D'))"/></WTCONDITION>
  		<WTCONDITION name="_IsStoreShowPhone"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'E'))"/></WTCONDITION>
  		<WTCONDITION name="_IsStoreShowContact"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'F'))"/></WTCONDITION>
  		<WTCONDITION name="_IsStoreNoBackground"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'G'))"/></WTCONDITION>
  		<WTCONDITION name="_IsStoreShowMap"><WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'H'))"/></WTCONDITION>

      <WTCONDITION name="_NotStoreImageRight"><WTCONDITION expr="CONST(not(contains)" value="CONST((/DATA/PARAM/@storeoptions, 'B')))"/></WTCONDITION>

    	<WTCONDITION name="__IsStoreShowAddress"><WTCONDITION expr="CONST(contains)" value="CONST((@storeoptions, 'C'))"/></WTCONDITION>
  		<WTCONDITION name="__IsStoreShowEmail"><WTCONDITION expr="CONST(contains)" value="CONST((@storeoptions, 'D'))"/></WTCONDITION>
  		<WTCONDITION name="__IsStoreShowPhone"><WTCONDITION expr="CONST(contains)" value="CONST((@storeoptions, 'E'))"/></WTCONDITION>
  		<WTCONDITION name="__IsStoreShowContact"><WTCONDITION expr="CONST(contains)" value="CONST((@storeoptions, 'F'))"/></WTCONDITION>
  		<WTCONDITION name="__IsStoreShowMap"><WTCONDITION expr="CONST(contains)" value="CONST((@storeoptions, 'H'))"/></WTCONDITION>

  </WTCONDITIONS>

	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchEmail" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(Email)" direction="input"/>
			<WTPARAM name="ATTR(MerchantID)" direction="output"/>
			<WTDECLARE name="MerchantID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="MerchantID" value="ATTR(Merchant.MerchantID)"/>
					<WTJOIN name="Merchant" lock="false"/>
					<WTCONDITION expr="ATTR(Merchant.Email)" oper="equal" value="PARAM(Email)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(MerchantID)" value="MerchantID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
    <!--================================================================================================-->
    <WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
      <WTBOOKMARK name=""/>
      <WTPARAM name="SYS(userid)" direction="input"/>
      <WTJOIN name="Common"/>
    </WTPROCEDURE>
    <!--==================================================================================================================-->
    <WTPROCEDURE type="Find" name="FindMember" style="GenerateDataProc.xsl">
      <WTBOOKMARK name=""/>
      <WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
      <WTPARAM name="SYS(userid)" direction="input"/>
      <WTJOIN name="Common"/>
      <WTCONDITION expr="ATTR(Merchant.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
    </WTPROCEDURE>
    <!--==================================================================================================================-->
    <WTPROCEDURE type="Find" name="FindOrg" style="GenerateDataProc.xsl">
      <WTBOOKMARK name=""/>
      <WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
      <WTPARAM name="SYS(userid)" direction="input"/>
      <WTJOIN name="Common"/>
      <WTCONDITION expr="ATTR(Merchant.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
    </WTPROCEDURE>
    <!--==========================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--===================================================================================-->
		<WTPROCEDURE name="Logon" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(Email)" direction="input"/>
			<WTPARAM name="ATTR(Password)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE name="Logon2" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(Email)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
 		<!--============================================================================================-->
		<WTPROCEDURE name="Search" type="Find" style="GenerateDataProc.xsl" template="new" searchlength="200" bookmarklength="14" nodata="true">
			<WTBOOKMARK name=""/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Merchant.MerchantID)"/>
					<WTATTRIBUTE value="ATTR(Merchant.MerchantName)"/>
					<WTATTRIBUTE value="ATTR(Merchant.NameLast)"/>
					<WTATTRIBUTE value="ATTR(Merchant.NameFirst)"/>
					<WTATTRIBUTE value="ATTR(Merchant.Email2)"/>
					<WTATTRIBUTE value="ATTR(Merchant.Phone2)"/>
					<WTATTRIBUTE value="ATTR(Merchant.Street1)"/>
					<WTATTRIBUTE value="ATTR(Merchant.Street2)"/>
					<WTATTRIBUTE value="ATTR(Merchant.City)"/>
					<WTATTRIBUTE value="ATTR(Merchant.State)"/>
					<WTATTRIBUTE value="ATTR(Merchant.Zip)"/>
					<WTATTRIBUTE value="ATTR(Merchant.EnrollDate)"/>
					<WTATTRIBUTE value="ATTR(Merchant.CountryName)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Description)"/>
          <WTATTRIBUTE value="ATTR(Merchant.StoreOptions)"/>
					<WTATTRIBUTE value="ATTR(Merchant.Colors)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Rating)"/>
          <WTATTRIBUTE value="ATTR(Merchant.CurrencyCode)"/>
        </WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE name="UpdateFT" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" novalidate="true" nodata="true">
			<WTPARAM name="ATTR(MerchantID)" direction="input"/>
			<WTPARAM name="ATTR(MerchantName)" direction="input"/>
			<WTPARAM name="ATTR(City)" direction="input"/>
			<WTPARAM name="ATTR(State)" direction="input"/>
			<WTPARAM name="ATTR(Zip)" direction="input"/>
			<WTPARAM name="ATTR(CountryName)" direction="input"/>
			<WTPARAM name="ATTR(Description)" direction="input"/>
			<WTPARAM name="Result" datatype="number" direction="output"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MerchantID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(BillingID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(EnrollDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Access)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
    <!--==================================================================================================-->
    <WTPROCEDURE type="List" name="ListMarket" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
      <WTPARAM name="ATTR(Target)" direction="input"/>
      <WTPARAM name="ATTR(CountryID)" direction="input"/>
      <WTCODEGROUP>
        <WTSELECT>
          <WTATTRIBUTE value="ATTR(Merchant.MerchantID)"/>
          <WTATTRIBUTE value="ATTR(Merchant.MerchantName)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Phone)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Email)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Street1)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Street2)"/>
          <WTATTRIBUTE value="ATTR(Merchant.City)"/>
          <WTATTRIBUTE value="ATTR(Merchant.State)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Zip)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Description)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Rating)"/>
          <WTATTRIBUTE value="ATTR(Merchant.CurrencyCode)"/>
          <WTATTRIBUTE value="ATTR(Merchant.EnrollDate)"/>
          <WTATTRIBUTE value="ATTR(Merchant.IsOrg)"/>
          <WTATTRIBUTE value="ATTR(Merchant.Options)"/>
          <WTATTRIBUTE value="ATTR(Merchant.StoreOptions)"/>
          <WTATTRIBUTE value="ATTR(Merchant.GeoCode)"/>
          <WTATTRIBUTE value="ATTR(Merchant.RewardAmt)"/>
          <WTATTRIBUTE value="ATTR(Merchant.RewardDesc)"/>
          <WTATTRIBUTE value="ATTR(Merchant.RewardCap)"/>
          <WTJOIN name="Merchant" lock="false"/>
        </WTSELECT>
      </WTCODEGROUP>
    </WTPROCEDURE>
    <!--===================================================================================-->
    <WTPROCEDURE name="CountMarket" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
      <WTPARAM name="ATTR(Target)" direction="input"/>
      <WTPARAM name="ATTR(CountryID)" direction="input"/>
      <WTPARAM name="Result" direction="output" datatype="text" length="100"/>
    </WTPROCEDURE>
  </WTPROCEDURES>
    
	<WTWEBPAGES>
		<!--============================================================================================-->
    <WTWEBPAGE name="15001" caption="FindMerchant" action="5" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" focus="false" track="0" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
      <WTPARAM name="Direction" datatype="number"/>
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Title" datatype="text"/>

      <!-- CHECK FOR ILLEGAL ACCESS -->
      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
        <WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
        <WTCONDITION expr="NotMemberOnly" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>
      <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="or"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(MerchantName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
        <WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Title)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
        </WTOBJECT>
      </WTCODEGROUP>
      
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMerchants" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants">
        <WTMETHOD name="Find">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          <WTPARAM name="reqBookmark" direction="return" datatype="text"/>
          <WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
          <WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
          <WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
          <WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
          <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
        </WTMETHOD>
        <WTMETHOD name="FindMember">
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
          <WTPARAM name="reqBookmark" direction="return" datatype="text"/>
          <WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
          <WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
          <WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
          <WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
          <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
          <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
        </WTMETHOD>
        <WTMETHOD name="XML">
					<WTPARAM name="xmlMerchants" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left"/>

				<WTFUNCTION name="ViewAwards(typ,id)">
					var url, win;
					url = "15311.asp?merchantid=" + id + "&amp;awardtype=" + typ 
					win = window.open(url,"Awards","top=100,left=100,height=300,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
        <WTFUNCTION name="NewMerchant(org)">
          var ret = '15001.asp'
          var mid = document.getElementById('MemberID').value
          window.location = "15002.asp?memberid=" + mid + "&amp;org=" + org + "&amp;returnurl=" + ret;
        </WTFUNCTION>
        <WTFUNCTION name="LookupMerchant()">
          window.open("15011.asp");
        </WTFUNCTION>

        <WTROW>
          <WTHIDDEN value="PARAM(Title)"/>
          <WTHIDDEN value="PARAM(MemberID)"/>
        </WTROW>

        <WTROW margin-top="12">
          <WTTABLE col="1">
            <WTCOLUMN width="200" align="left"/>
            <WTCOLUMN width="800" align="left"/>
            <WTROW>
              <WTIMAGE col="1" value="CONST(Merchant48.gif)" align="center"/>
              <WTSTATIC col="2" align="left" fontsize="5">
                <WTSTATIC label="FindMerchant">
                  <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
                </WTSTATIC>
                <WTSTATIC tag="FindMerchant" value="PARAM(Title)">
                  <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
                </WTSTATIC>
              </WTSTATIC>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Merchants.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
          <WTBUTTON col="1" value="CONST(NewMerchant)" align="center">
            <WTCLICK>NewMerchant(0)</WTCLICK>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(NewOrg)" align="center">
            <WTCLICK>NewMerchant(1)</WTCLICK>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(Lookup)" align="center">
            <WTCLICK>LookupMerchant()</WTCLICK>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(Close)">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

				<WTSTATIC label="Rewards"/>
				<WTSTATIC label="Awards"/>
        <WTSTATIC label="Promotions"/>
        <WTSTATIC label="Staff"/>
        <WTSTATIC label="Coins"/>
        <WTSTATIC label="Txns"/>
        <WTSTATIC label="Billing"/>
        <WTSTATIC label="Store"/>
        <WTSTATIC label="StoreDesigner"/>

        <WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Merchant">
						<WTCOLUMN width="35" align="left" valign="top" label="MerchantName"/>
						<WTCOLUMN width="20" align="left" valign="top" label="ContactName"/>
						<WTCOLUMN width="30" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="15" align="right" valign="top"/>
						<WTROW height="30">
							<WTSTATIC col="1">
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(IsOrg)" oper="equal" value="CONST(0)"/>
                  <WTIMAGE value="CONST(Merchant24.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(IsOrg)" oper="not-equal" value="CONST(0)"/>
                  <WTIMAGE value="CONST(Church24.png)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTSTATIC space="1"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(MerchantStatus&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTSTATIC space="1"/>
                <WTSTATIC value="DATA(MerchantName)" space="1"/>
                <WTSTATIC value="CONST(#&lt;xsl:value-of select=&quot;@merchantid&quot;/&gt;)" space="1" fontcolor="blue"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="IsEmployee"/>
                  <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
                  <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
                  <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="15003">
                      <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                      <WTPARAM name="Return" value="CONST(1)"/>
                    </WTLINK>
									</WTIMAGE>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="DATA(IsOrg)" oper="equal" value="CONST(0)"/>
                    <WTIMAGE value="CONST(Window.gif)" imgalign="absmiddle">
                      <WTLINK name="15000" return="false" target="_blank">
                        <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="DATA(IsOrg)" oper="not-equal" value="CONST(0)"/>
                    <WTIMAGE value="CONST(Window.gif)" imgalign="absmiddle">
                      <WTLINK name="15030" return="false" target="_blank">
                        <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                </WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(NameFirst)" space="1"/>
								<WTSTATIC value="DATA(NameLast)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Email)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
                  <WTCONDITION expr="IsEmployee"/>
                  <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
                  <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
                  <WTSTATIC space="1"/>
                  <WTIMAGE value="CONST(mSales.gif)" alt="Billing" imgalign="absmiddle">
                    <WTLINK name="15008">
                      <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                      <WTPARAM name="Return" value="CONST(1)"/>
                    </WTLINK>
                  </WTIMAGE>
                  <WTCODEGROUP>
                    <WTCONDITION expr="DATA(IsOrg)" oper="equal" value="CONST(0)"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(mNXC.gif)" alt="Txns" imgalign="absmiddle">
                      <WTLINK name="15201" return="false" target="Txns">
                        <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(mPromo.gif)" alt="Promotions" imgalign="absmiddle">
                      <WTLINK name="15401" return="false" target="Promotions">
                        <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(mMember.gif)" alt="Staff" imgalign="absmiddle">
                      <WTLINK name="16211" return="false" target="Staff">
                        <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                      </WTLINK>
                    </WTIMAGE>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(mCoin.gif)" alt="Coins" imgalign="absmiddle">
                      <WTLINK name="16411" return="false" target="Coins">
                        <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                      </WTLINK>
                    </WTIMAGE>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(mCashback.gif)" alt="Rewards" imgalign="absmiddle">
                      <WTLINK name="ViewAwards(1,&lt;xsl:value-of select=&quot;@merchantid&quot;/&gt;)" click="true" />
                    </WTIMAGE>
                    <WTSTATIC space="1"/>
                    <WTCODEGROUP>
                      <WTCONDITION expr="DATA(IsAwards)" oper="equal" value="CONST(0)"/>
                      <WTIMAGE value="CONST(mContest2.gif)" alt="Awards" imgalign="absmiddle">
                        <WTLINK name="ViewAwards(2,&lt;xsl:value-of select=&quot;@merchantid&quot;/&gt;)" click="true" />
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="DATA(IsAwards)" oper="not-equal" value="CONST(0)"/>
                      <WTIMAGE value="CONST(mContest.gif)" alt="Awards" imgalign="absmiddle">
                        <WTLINK name="ViewAwards(2,&lt;xsl:value-of select=&quot;@merchantid&quot;/&gt;)" click="true" />
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(mHome.gif)" alt="StoreDesigner" imgalign="absmiddle">
                        <WTLINK name="15004" return="false" target="Store">
                          <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                        </WTLINK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(mHome.gif)" alt="Store" imgalign="absmiddle">
                        <WTLINK name="15050" return="false" target="Store">
                          <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                          <WTPARAM name="Preview" value="CONST(1)"/>
                        </WTLINK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                  </WTCODEGROUP>
                </WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="4" fontcolor="gray">
								<WTSTATIC space="5"/>
								<WTSTATIC value="DATA(Street1)" space="1"/>
								<WTSTATIC value="DATA(Street2)" space="1"/>
								<WTSTATIC value="DATA(City)" space="1"/>
								<WTSTATIC value="DATA(State)" space="1"/>
								<WTSTATIC value="DATA(Zip)" space="1"/>
								<WTSTATIC value="DATA(CountryName)" space="1"/>
                <WTSTATIC value="DATA(VisitDate)" fontcolor="purple"/>
                <WTSTATIC fontcolor="blue">
                  <WTSTATIC value="DATA(MemberName)" space="1"/>
                  <WTSTATIC value="CONST(#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)"/>
                </WTSTATIC>
              </WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="15011" caption="Merchant Lookup" action="5" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" focus="false" track="0" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="SearchText" datatype="text"/>
      <WTPARAM name="FindTypeID" datatype="number"/>
      <WTPARAM name="Bookmark" datatype="text"/>
      <WTPARAM name="Direction" datatype="number"/>

      <WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(Zip)">
        <WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
      </WTSETATTRIBUTE>

      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
        <WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants">
          <WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMerchants" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(14)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
      </WTACTION>

      <WTACTION id="5" name="Find" type="New">
        <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
      </WTACTION>

      <WTACTION id="6" name="Previous" type="New">
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
      </WTACTION>

      <WTACTION id="7" name="Next" type="New">
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
      </WTACTION>

      <WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants">
        <WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
        <WTMETHOD name="Find">
          <WTPARAM name="reqBookmark" direction="return" datatype="text"/>
          <WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
          <WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
          <WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
          <WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
          <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
        </WTMETHOD>
        <WTMETHOD name="XML">
          <WTPARAM name="xmlMerchants" direction="return" datatype="text"/>
          <WTPARAM name="Option" direction="input" value="CONST(15)"/>
        </WTMETHOD>
      </WTOBJECT>
      <WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
        <WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
        <WTMETHOD name="XML">
          <WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
        </WTMETHOD>
      </WTOBJECT>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="1000" align="left"/>

        <WTFUNCTION name="ViewAwards(typ,id)">
          var url, win;
          url = "15311.asp?merchantid=" + id + "&amp;awardtype=" + typ
          win = window.open(url,"Awards","top=100,left=100,height=300,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
          win.focus();
        </WTFUNCTION>

        <WTROW margin-top="12">
          <WTTABLE col="1">
            <WTCOLUMN width="200" align="left"/>
            <WTCOLUMN width="800" align="left"/>
            <WTROW>
              <WTIMAGE col="1" value="CONST(Merchant48.gif)" align="center"/>
              <WTSTATIC col="2" label="LookupMerchant" align="left" fontsize="5"/>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-top="6" margin-bottom="6">
          <WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
          <WTCOMBO col="1" value="ATTR(Merchants.FindTypeID)" translate="true"/>
          <WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
          <WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
          <WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
          <WTBUTTON col="1" value="CONST(Close)">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

        <WTROW>
          <WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
          <WTRECORDSET col="1" graybar="true" prevnext="top" entity="Merchant">
            <WTCOLUMN width="35" align="left" valign="top" label="MerchantName"/>
            <WTCOLUMN width="30" align="left" valign="top" label="ContactName"/>
            <WTCOLUMN width="30" align="left" valign="top" label="MemberName"/>
            <WTCOLUMN width="15" align="right" valign="top"/>
            <WTROW height="30">
              <WTSTATIC col="1">
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(IsOrg)" oper="equal" value="CONST(0)"/>
                  <WTIMAGE value="CONST(Merchant24.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(IsOrg)" oper="not-equal" value="CONST(0)"/>
                  <WTIMAGE value="CONST(Church24.png)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTSTATIC space="1"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(MerchantStatus&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTSTATIC space="1"/>
                <WTSTATIC value="DATA(MerchantName)"/>
              </WTSTATIC>
              <WTSTATIC col="2">
                <WTSTATIC value="DATA(NameFirst)" space="1"/>
                <WTSTATIC value="DATA(NameLast)"/>
              </WTSTATIC>
              <WTSTATIC col="3">
                <WTSTATIC value="DATA(MemberName)" space="1"/>
                <WTSTATIC value="CONST(#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)"/>
              </WTSTATIC>
              <WTSTATIC col="4"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" merge="4" fontcolor="gray">
                <WTSTATIC space="5"/>
                <WTSTATIC value="DATA(Street1)" space="1"/>
                <WTSTATIC value="DATA(Street2)" space="1"/>
                <WTSTATIC value="DATA(City)" space="1"/>
                <WTSTATIC value="DATA(State)" space="1"/>
                <WTSTATIC value="DATA(Zip)" space="1"/>
                <WTSTATIC value="DATA(CountryName)" space="1"/>
              </WTSTATIC>
            </WTROW>
          </WTRECORDSET>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
		<WTWEBPAGE name="15002" caption="Merchant" header="false" footer="false" navbar="false" wrapper="wrapper600"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" secured="52">
      <!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Org" datatype="number"/>

      <WTINCLUDE name="Email.asp"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMerchant">
				<WTCALLSUB name="LoadList"/>
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MERCHANT-STATUS-PRELAUNCH)"/>
          <WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
          <WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="AddMerchant">
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
          <WTSETATTRIBUTE name="ATTR(BillDate)" value="SYS(Date)"/>
          <WTSETATTRIBUTE name="ATTR(BillDays)" value="CONST(7)"/>
          <WTSETATTRIBUTE name="ATTR(Processor)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="ATTR(IsOrg)" value="PARAM(Org)"/>
          <!--          <WTSETATTRIBUTE name="ATTR(IsAwards)" value="CONST(1)"/>-->
          <WTSETATTRIBUTES/>
          <WTSETATTRIBUTE name="ATTR(Email2)" value="ATTR(Email)"/>
          <WTSETATTRIBUTE name="ATTR(Email3)" value="ATTR(Email)"/>
          <WTSETATTRIBUTE name="ATTR(Phone2)" value="ATTR(Phone)"/>
          <WTSETATTRIBUTE name="ATTR(Options)" value="CONST(&quot;ACDE&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(StoreOptions)" value="CONST(&quot;ABCDEFH&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Colors)" value="CONST(&quot;000000,FFFFFF,,FFFFFF,&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(CurrencyCode)" value="CONST(&quot;USD&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Terms)" value="CONST(&quot;Rewards are earned on pre-tax and pre-tip amounts. Redeemable for total bill only.&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(ReferRate)" value="CONST(10)"/>
          <WTCUSTOM>
						If ValidEmail( .Email ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
					</WTCUSTOM>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Password2)" oper="equal" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Password2)" value="CONST(&quot;staff&quot;)"/>
          </WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="FetchEmail">
							<WTPARAM name="Email" direction="input" value="ATTR(Email)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CLng(.MerchantID))" oper="not-equal" value="CONST(0)"/>
							<WTERROR number="10123" message="Oops, This email address is already assigned to another merchant."/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(LEN(.Password))" oper="less" value="CONST(6)"/>
							<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="MerchantID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
						<WTCALLSUB name="LoadList"/>
					</WTCODEGROUP>
				</WTOBJECT>
        <!-- Setup for Merchants Only -->
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(Org)" oper="equal" value="CONST(0)" connector="and"/>
          <!-- Create default 10% Cash Back Reward -->
          <WTOBJECT name="Award" project="ptsAwardUser" class="CAward">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="AwardID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(MerchantID)" value="CONST(MerchantID)"/>
            <WTSETATTRIBUTE name="ATTR(AwardType)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(10)"/>
            <WTSETATTRIBUTE name="ATTR(Award)" value="CONST(10)"/>
            <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(&quot;Cash Back&quot;)"/>
            <WTMETHOD name="Add">
              <WTPARAM name="AwardID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- Create store folder -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTCUSTOM>
              Set oFileSys = server.CreateObject("Scripting.FileSystemObject")
              oFileSys.CreateFolder reqSysWebDirectory + "Images\Store\" + CStr(MerchantID)
              Set oFileSys = Nothing
            </WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMerchant"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTCALLSUB name="AddMerchant"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="TitleCase(obj)">	
					var val = obj.value;
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
				</WTFUNCTION>

				<WTROW>
          <WTSTATIC col="1" merge="2" fontcolor="red" fontsize="4" align="center">
            <WTSTATIC label="NewMerchantOnly">
              <WTCONDITION expr="PARAM(Org)" oper="equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC label="NewOrgOnly">
              <WTCONDITION expr="PARAM(Org)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
          </WTSTATIC>
      </WTROW>
				<WTROW margin-bottom="3">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
          <WTHIDDEN value="ATTR(Merchant.MemberID)"/>
          <WTHIDDEN value="ATTR(Merchant.Status)"/>
        </WTROW>
        <WTCODEGROUP>
          <WTCONDITION expr="IsEmployee"/>
          <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
          <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="MemberID"/>
            <WTTEXT col="2" value="ATTR(Merchant.MemberID)" required="false"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="Status"/>
            <WTCOMBO col="2" value="ATTR(Merchant.Status)"/>
          </WTROW>
        </WTCODEGROUP>
				<WTROW margin-bottom="3">
          <WTSTATIC col="1">
            <WTSTATIC tag="MerchantName">
              <WTCONDITION expr="PARAM(Org)" oper="equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC tag="OrgName">
              <WTCONDITION expr="PARAM(Org)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
          </WTSTATIC>
          <WTTEXT col="2" value="ATTR(Merchant.MerchantName)" size="60" required="false">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="ContactName"/>
					<WTTEXT col="2" value="ATTR(Merchant.NameFirst)" width="200" label="NameFirst" size="25" required="false">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Merchant.NameLast)" width="240" label="NameLast" size="25" required="false">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Merchant.Email)" required="false" class="prompt"/>
					<WTSTATIC col="2" label="Unique"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Phone"/>
					<WTTEXT col="2" value="ATTR(Merchant.Phone)" required="false" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Passwordx"/>
					<WTTEXT col="2" value="ATTR(Merchant.Password)" required="false" class="prompt"/>
					<WTSTATIC col="2" label="PasswordText"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Merchant.Street1)" size="60">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Merchant.Street2)" size="60">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Merchant.City)" width="200" label="City" size="25">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Merchant.State)" width="240" label="State" size="25">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Merchant.Zip)" width="100" label="Zip" size="8"/>
					<WTCOMBO col="2" value="ATTR(Merchant.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="15003" caption="Merchant" header="false" footer="false" navbar="false" wrapper="wrapper600"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="MerchantID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="ShowPassword" datatype="number"/>
      <WTPARAM name="Return" datatype="number"/>
      <WTPARAM name="Txn" datatype="number"/>
      <WTPARAM name="IsPin" datatype="number"/>
      <WTPARAM name="IsTicket" datatype="number"/>
      <WTPARAM name="IsOrderEmail" datatype="number"/>
      <WTPARAM name="IsApproveOrder" datatype="number"/>
      <WTPARAM name="IsShopperOrder" datatype="number"/>
      <WTPARAM name="IsFeature" datatype="number"/>
      <WTPARAM name="IsCommissioned" datatype="number"/>
      <WTPARAM name="Sweep" datatype="number"/>
      <WTPARAM name="SweepTitle" datatype="text"/>

      <WTINCLUDE name="Email.asp"/>
      <WTINCLUDE name="StripHTML.asp"/>
      <WTINCLUDE name="2FA.asp"/>
      <WTINCLUDE name="GeoCode.asp"/>
      <WTCODEGROUP><WTCALLSUB name="Check2FAMerchant reqMerchantID"/></WTCODEGROUP>


			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTCODEGROUP>
				<WTCONDITION expr="IsSysAdmin"/>
				<WTSETATTRIBUTE name="PARAM(ShowPassword)" value="CONST(1)"/>
			</WTCODEGROUP>

      <WTSUB name="LoadList">
        <WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
          <WTMETHOD name="EnumCompany">
            <WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
            <WTPARAM name="ItemID" direction="input" value="CONST()" />
            <WTPARAM name="Element" direction="input" value="CONST()" />
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTSUB function="GetOptions(bvOptions)">
        <WTCODEGROUP>
          <WTCUSTOM>
            If InStr(bvOptions, "*") &gt; 0 Then reqIsCommissioned = 1
            If InStr(bvOptions, "A") &gt; 0 Then reqIsPin = 1
            If InStr(bvOptions, "B") &gt; 0 Then reqIsTicket = 1
            If InStr(bvOptions, "C") &gt; 0 Then reqIsOrderEmail = 1
            If InStr(bvOptions, "D") &gt; 0 Then reqIsApproveOrder = 1
            If InStr(bvOptions, "E") &gt; 0 Then reqIsShopperOrder = 1
            If InStr(bvOptions, "F") &gt; 0 Then reqIsFeature = 1
          </WTCUSTOM>
        </WTCODEGROUP>
      </WTSUB>
      
      <WTSUB function="SetOptions()">
        <WTCODEGROUP>
          <WTCUSTOM>
            tmp = ""
            If reqIsCommissioned = 1 Then tmp = tmp + "*"
            If reqIsPin = 1 Then tmp = tmp + "A"
            If reqIsTicket = 1 Then tmp = tmp + "B"
            If reqIsOrderEmail = 1 Then tmp = tmp + "C"
            If reqIsApproveOrder = 1 Then tmp = tmp + "D"
            If reqIsShopperOrder = 1 Then tmp = tmp + "E"
            If reqIsFeature = 1 Then tmp = tmp + "F"
            SetOptions = tmp
          </WTCUSTOM>
        </WTCODEGROUP>
      </WTSUB>
      
      <WTSUB function="GetSweep(bvSweepID, bvSweepRate)">
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(bvSweepRate)" oper="greater-equal" value="CONST(0)"/>
          <WTSETATTRIBUTE name="PARAM(Sweep)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="CONST(GetSweep)" value="CONST(bvSweepRate)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(bvSweepRate)" oper="less" value="CONST(0)"/>
          <WTSETATTRIBUTE name="PARAM(Sweep)" value="CONST(2)"/>
          <WTSETATTRIBUTE name="CONST(GetSweep)" value="CONST(0)"/>
        </WTCODEGROUP>
        <WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
          <WTCONDITION expr="CONST(bvSweepID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="ConsumerID" direction="input" value="CONST(bvSweepID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(SweepTitle)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)">
            <WTCONDITION expr="ATTR(NameFirst)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="PARAM(SweepTitle)" value="CONST(&quot;Invalid Shopper!&quot;)">
            <WTCONDITION expr="ATTR(NameFirst)" oper="equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
        </WTOBJECT>
      </WTSUB>
      
      <WTSUB function="SetSweep(brSweepRate)">
        <WTSETATTRIBUTE name="CONST(SetSweep)" value="CONST(brSweepRate)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Sweep)" oper="equal" value="CONST(1)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(brSweepRate)" oper="less" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(SetSweep)" value="CONST(0)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(brSweepRate)" oper="greater" value="CONST(100)"/>
            <WTSETATTRIBUTE name="CONST(SetSweep)" value="CONST(100)"/>
          </WTCODEGROUP>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Sweep)" oper="equal" value="CONST(2)"/>
          <WTSETATTRIBUTE name="CONST(SetSweep)" value="CONST(-1)"/>
        </WTCODEGROUP>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadList"/>
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
          <WTSETATTRIBUTE name="ATTR(SweepRate)" value="CONST(GetSweep(.SweepID, .SweepRate))"/>
          <WTCALLSUB name="GetOptions .Options"/>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
        </WTOBJECT>
      </WTACTION>
      
      <WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
<WTCUSTOM>
			If ValidEmail( .Email ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="FetchEmail">
							<WTPARAM name="Email" direction="input" value="ATTR(Email)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CLng(.MerchantID))" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="CONST(CLng(.MerchantID))" oper="not-equal" value="PARAM(MerchantID)" connector="and"/>
							<WTERROR number="10123" message="Oops, This email address is already assigned to another merchant."/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="ATTR(Password)" value="FORM(Password)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(LEN(.Password))" oper="less" value="CONST(6)"/>
							<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="CONST(OldIsOrg)" value="ATTR(IsOrg)"/>
          <WTSETATTRIBUTE name="CONST(tmpStreet1)" value="ATTR(Street1)"/>
          <WTSETATTRIBUTE name="CONST(tmpStreet2)" value="ATTR(Street2)"/>
          <WTSETATTRIBUTE name="CONST(tmpCity)" value="ATTR(City)"/>
          <WTSETATTRIBUTE name="CONST(tmpState)" value="ATTR(State)"/>
          <WTSETATTRIBUTE name="CONST(tmpZip)" value="ATTR(Zip)"/>
          <WTSETATTRIBUTES/>
          <WTSETATTRIBUTE name="ATTR(Options)" value="CONST(SetOptions())"/>
          <WTSETATTRIBUTE name="ATTR(SweepRate)" value="CONST(SetSweep(.SweepRate))"/>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Password2)" oper="equal" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Password2)" value="CONST(&quot;staff&quot;)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(ReferRate)" oper="less" value="CONST(10)"/>
            <WTCONDITION expr="ATTR(ReferRate)" oper="greater" value="CONST(20)" connector="or"/>
            <WTSETATTRIBUTE name="ATTR(ReferRate)" value="CONST(10)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(OldIsOrg)" oper="equal" value="CONST(&quot;1&quot;)"/>
            <WTCONDITION expr="ATTR(IsOrg)" oper="not-equal" value="CONST(&quot;1&quot;)" connector="and"/>
            <WTSETATTRIBUTE name="ATTR(Options)" value="CONST(&quot;AB&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Terms)" value="CONST(&quot;Rewards are earned on pre-tax and pre-tip amounts.&quot;)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(3)"/>
            <WTCONDITION expr="ATTR(IsOrg)" oper="not-equal" value="CONST(&quot;1&quot;)" connector="and"/>
            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(GeoCode)" oper="equal" value="CONST(&quot;&quot;)"/>
              <WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(tmpStreet1)" connector="or"/>
              <WTCONDITION expr="ATTR(Street2)" oper="not-equal" value="CONST(tmpStreet2)" connector="or"/>
              <WTCONDITION expr="ATTR(City)" oper="not-equal" value="CONST(tmpCity)" connector="or"/>
              <WTCONDITION expr="ATTR(State)" oper="not-equal" value="CONST(tmpState)" connector="or"/>
              <WTCONDITION expr="ATTR(Zip)" oper="not-equal" value="CONST(tmpZip)" connector="or"/>
              <WTCUSTOM>
                .GeoCode = GM_GeoCode(.Street1 + "+" + .Street2 + "+" + .City + "+" + .State + "+" + .Zip)
              </WTCUSTOM>
            </WTCODEGROUP>
          </WTCODEGROUP>
          <WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
            <WTCONDITION expr="PARAM(Return)" oper="equal" value="CONST(0)" connector="or"/>
            <WTCALLSUB name="LoadList"/>
            <WTCALLSUB name="GetOptions .Options"/>
            <WTSETATTRIBUTE name="ATTR(SweepRate)" value="CONST(GetSweep(.SweepID, .SweepRate))"/>
            <WTMETHOD name="XML">
							<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
          </WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="ATTR(IsOrg)" oper="equal" value="CONST(0)" connector="and"/>
            <WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
       			<WTSETATTRIBUTE name="CONST(tmpDescription)" value="CONST(StripHTML(.Description))"/>
            <WTMETHOD name="UpdateFT">
						  <WTPARAM name="MerchantID" direction="input" value="ATTR(MerchantID)"/>
						  <WTPARAM name="MerchantName" direction="input" value="ATTR(MerchantName)"/>
						  <WTPARAM name="City" direction="input" value="ATTR(City)"/>
						  <WTPARAM name="State" direction="input" value="ATTR(State)"/>
						  <WTPARAM name="Zip" direction="input" value="ATTR(Zip)"/>
						  <WTPARAM name="CountryName" direction="input" value="ATTR(CountryName)"/>
						  <WTPARAM name="Description" direction="input" value="CONST(tmpDescription)"/>
						  <WTPARAM name="Result" direction="return" datatype="number"/>
					  </WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(Return)" oper="not-equal" value="CONST(0)" connector="and"/>
        </WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Delete">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="LoadList"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
				</WTFUNCTION>

        <WTROW>
          <WTHIDDEN value="PARAM(Return)"/>
        </WTROW>

        <WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="left">
            <WTSTATIC tag="Merchant">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC tag="OrgName">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC value="ATTR(Merchant.MerchantName)" space="1"/>
						<WTSTATIC value="ATTR(Merchant.VisitDate)" fontcolor="purple"/>
            <WTCODEGROUP>
       				<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
					    <WTSTATIC space="1"/>
					    <WTSTATIC label="Updated" fontcolor="red"/>
            </WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

        <WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
				  <WTROW margin-bottom="3">
					  <WTSTATIC col="1" tag="MemberID"/>
					  <WTTEXT col="2" value="ATTR(Merchant.MemberID)" required="false"/>
				  </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="EnrollDate"/>
            <WTTEXT col="2" value="ATTR(Merchant.EnrollDate)" required="false" size="15"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="PromoLimit"/>
            <WTTEXT col="2" value="ATTR(Merchant.PromoLimit)" size="5"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="Status"/>
            <WTCOMBO col="2" value="ATTR(Merchant.Status)"/>
            <WTSTATIC col="2" tag="CurrencyCode"/>
            <WTTEXT col="2" value="ATTR(Merchant.CurrencyCode)" size="3" prespace="false"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTCHECK col="2" value="ATTR(Merchant.IsOrg)" label="IsOrg" align="left"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="ReferRate"/>
            <WTTEXT col="2" value="ATTR(Merchant.ReferRate)" size="2"/>
          </WTROW>
          <WTROW margin-top="6" margin-bottom="6">
            <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
          </WTROW>
        </WTCODEGROUP>  
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Merchant.MemberID)"/>
          <WTHIDDEN value="ATTR(Merchant.EnrollDate)"/>
          <WTHIDDEN value="ATTR(Merchant.PromoLimit)"/>
          <WTHIDDEN value="ATTR(Merchant.Status)"/>
          <WTHIDDEN value="ATTR(Merchant.CurrencyCode)"/>
          <WTHIDDEN value="ATTR(Merchant.IsOrg)"/>
          <WTHIDDEN value="ATTR(Merchant.ReferRate)"/>
        </WTROW>
				
				<WTROW margin-bottom="3">
					<WTSTATIC col="1">
            <WTSTATIC tag="Merchant">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC tag="OrgName">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
          </WTSTATIC>
          <WTTEXT col="2" value="ATTR(Merchant.MerchantName)" required="false" size="40">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
          <WTIMAGE col="2" value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMERCHANT/@rating&quot;/&gt;.gif)" imgalign="absmiddle">
            <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
          </WTIMAGE>
        </WTROW>

        <WTROW margin-bottom="3">
          <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
          <WTSTATIC col="1" tag="DescriptionOrg"/>
          <WTMEMO col="2" value="ATTR(Merchant.Description)" cols="60" rows="5" wordcount="showParagraphs:false,showCharCount:true,countSpacesAsChars:true,countHTML:true,maxCharCount:2000"/>
        </WTROW>
        <WTROW>
          <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
          <WTHIDDEN value="ATTR(Merchant.Description)"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
          <WTROW margin-bottom="3">
            <WTCONDITION expr="IsSysAdmin"/>
            <WTSTATIC col="1" tag="Rating"/>
            <WTTEXT col="2" value="ATTR(Merchant.Rating)" size="2"/>
          </WTROW>
          <WTROW>
            <WTCONDITION expr="NotSysAdmin"/>
            <WTHIDDEN value="ATTR(Merchant.Rating)"/>
          </WTROW>
        </WTCODEGROUP>
        <WTROW margin-bottom="3">
          <WTSTATIC col="1" tag="ReferRate"/>
          <WTSTATIC col="2" bold="true">
            <WTSTATIC value="ATTR(Merchant.ReferRate)"/>
            <WTSTATIC value="CONST(%)"/>
          </WTSTATIC>
        </WTROW>

        <WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="ContactName"/>
					<WTTEXT col="2" value="ATTR(Merchant.NameFirst)" width="200" label="NameFirst" size="20" required="false">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Merchant.NameLast)" width="240" label="NameLast" size="20" required="false">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Merchant.Email)" required="false" class="prompt" size="30"/>
					<WTSTATIC col="2" label="Unique"/>
				</WTROW>
        <WTROW margin-bottom="3">
          <WTSTATIC col="1" tag="Phone"/>
          <WTTEXT col="2" value="ATTR(Merchant.Phone)" required="false" class="prompt" size="15"/>
        </WTROW>
        <WTROW margin-bottom="3">
          <WTSTATIC col="1" tag="TimeZone"/>
          <WTCOMBO col="2" value="ATTR(Merchant.TimeZone)">
            <WTOPTION id="-99" label="blank"/>
            <WTOPTION id="-12" label="GMT-12"/>
            <WTOPTION id="-11" label="GMT-11"/>
            <WTOPTION id="-10" label="GMT-10"/>
            <WTOPTION id="-9" label="GMT-9"/>
            <WTOPTION id="-8" label="GMT-8"/>
            <WTOPTION id="-7" label="GMT-7"/>
            <WTOPTION id="-6" label="GMT-6"/>
            <WTOPTION id="-5" label="GMT-5"/>
            <WTOPTION id="-4" label="GMT-4"/>
            <WTOPTION id="-3" label="GMT-3"/>
            <WTOPTION id="-2" label="GMT-2"/>
            <WTOPTION id="-1" label="GMT-1"/>
            <WTOPTION id="0" label="GMT"/>
            <WTOPTION id="1" label="GMT+1"/>
            <WTOPTION id="2" label="GMT+2"/>
            <WTOPTION id="3" label="GMT+3"/>
            <WTOPTION id="4" label="GMT+4"/>
            <WTOPTION id="5" label="GMT+5"/>
            <WTOPTION id="6" label="GMT+6"/>
            <WTOPTION id="7" label="GMT+7"/>
            <WTOPTION id="8" label="GMT+8"/>
            <WTOPTION id="9" label="GMT+9"/>
            <WTOPTION id="10" label="GMT+10"/>
            <WTOPTION id="11" label="GMT+11"/>
            <WTOPTION id="12" label="GMT+12"/>
          </WTCOMBO>
        </WTROW>
        
        <WTROW>
            <WTCONDITION expr="NotEmployee"/>
            <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
            <WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
            <WTHIDDEN value="ATTR(UserKey)"/>
            <WTHIDDEN value="ATTR(UserKey3)"/>
            <WTHIDDEN value="ATTR(UserKey4)"/>
        </WTROW>
          
        <WTROW margin-bottom="3">
          <WTSTATIC col="1">
            <WTSTATIC tag="Password">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC tag="Passwordx">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
          </WTSTATIC>
          <WTTEXT col="2" value="ATTR(Merchant.Password)" required="false" class="prompt"/>
					<WTSTATIC col="2" label="PasswordText"/>
          <WTTEXT col="2" value="ATTR(Merchant.UserKey)" size="5">
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
          </WTTEXT>
        </WTROW>
        <WTROW margin-bottom="3">
          <WTSTATIC col="1">
            <WTSTATIC tag="Password3">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC tag="Passwordx3">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
          </WTSTATIC>
          <WTTEXT col="2" value="ATTR(Merchant.Password3)" class="prompt"/>
					<WTSTATIC col="2" label="PasswordText"/>
          <WTTEXT col="2" value="ATTR(Merchant.UserKey3)" size="5">
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
          </WTTEXT>
				</WTROW>
        <WTROW margin-bottom="3">
          <WTSTATIC col="1">
            <WTSTATIC tag="Password4">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC tag="Passwordx4">
              <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
          </WTSTATIC>
          <WTTEXT col="2" value="ATTR(Merchant.Password4)" class="prompt"/>
					<WTSTATIC col="2" label="PasswordText"/>
          <WTTEXT col="2" value="ATTR(Merchant.UserKey4)" size="5">
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
          </WTTEXT>
				</WTROW>
        <WTCODEGROUP>
          <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="Password2"/>
            <WTTEXT col="2" value="ATTR(Merchant.Password2)" required="false" class="prompt"/>
            <WTSTATIC col="2" label="PasswordText"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTCHECK col="2" value="ATTR(Merchant.IsAwards)" align="left" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTCHECK col="2" value="PARAM(IsPin)" label="IsPinNumber" align="left" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTCHECK col="2" value="PARAM(IsTicket)" label="IsTicketNumber" align="left" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTCHECK col="2" value="PARAM(IsOrderEmail)" label="IsOrderEmail" align="left" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTCHECK col="2" value="PARAM(IsApproveOrder)" label="IsApproveOrder" align="left" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTCHECK col="2" value="PARAM(IsShopperOrder)" label="IsShopperOrder" align="left" bold="true"/>
          </WTROW>
          <WTCODEGROUP>
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1"/>
              <WTCHECK col="2" value="PARAM(IsFeature)" label="IsFeature" align="left" bold="true"/>
            </WTROW>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1"/>
              <WTCHECK col="2" value="PARAM(IsCommissioned)" label="IsCommissioned" align="left" bold="true"/>
            </WTROW>
          </WTCODEGROUP>
          <WTROW>
            <WTCONDITION expr="NotEmployee"/>
            <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
            <WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
            <WTHIDDEN value="PARAM(IsFeature)"/>
            <WTHIDDEN value="PARAM(IsCommissioned)"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1"/>
            <WTSTATIC col="2" space="5"/>
            <WTSTATIC col="2" tag="Email3"/>
            <WTTEXT col="2" value="ATTR(Merchant.Email3)" required="false" prespace="false" size="30"/>
          </WTROW>
          <WTROW margin-top="6" margin-bottom="6">
            <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
          </WTROW>
          <WTROW>
            <WTSTATIC col="1" tag="Terms"/>
            <WTMEMO col="2" value="ATTR(Merchant.Terms)" cols="50" rows="2"/>
          </WTROW>
          <WTROW margin-top="6" margin-bottom="6">
            <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" merge="2" label="SweepText" class="prompt" align="left"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="Sweep"/>
            <WTCOMBO col="2" value="PARAM(Sweep)">
              <WTOPTION id="1" label="Sweep1"/>
              <WTOPTION id="2" label="Sweep2"/>
            </WTCOMBO>
            <WTSTATIC col="2" tag="SweepRate"/>
            <WTTEXT col="2" value="ATTR(Merchant.SweepRate)" size="2" prespace="false"/>
            <WTSTATIC col="2" label="%" prespace="false"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="SweepID"/>
            <WTTEXT col="2" value="ATTR(Merchant.SweepID)" size="5" class="prompt"/>
            <WTSTATIC col="2" value="PARAM(SweepTitle)" bold="true"/>
          </WTROW>
        </WTCODEGROUP>

        <WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Merchant.Street1)" size="40">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Merchant.Street2)" size="40">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Merchant.City)" width="200" label="City" size="20">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Merchant.State)" width="240" label="State" size="20">
						<WTEXIT>TitleCase(this);</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Merchant.Zip)" width="100" label="Zip" size="5"/>
					<WTCOMBO col="2" value="ATTR(Merchant.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>
-        
        <WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)">
            <WTCONDITION expr="PARAM(Return)" oper="not-equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" align="center" msg="ConfirmDelete">
						<WTCONDITION expr="IsSysAdmin"/>
					</WTBUTTON>
          <WTBUTTON col="1" merge="2" value="CONST(Home)" align="center">
            <WTCONDITION expr="PARAM(Return)" oper="equal" value="CONST(0)"/>
            <WTCLICK>window.parent.ShowTab('TabDashboard',1)</WTCLICK>
          </WTBUTTON>
        </WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="15008" caption="Merchant Payment" header="false" footer="false" navbar="false" wrapper="wrapper600"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
      <!--============================================================================================-->
      <WTPARAM name="MerchantID" datatype="number"/>
      <WTPARAM name="Txn" datatype="number"/>
      <WTPARAM name="Return" datatype="number"/>
      <WTPARAM name="CanEdit" datatype="number"/>

      <!-- ACH Payment Fields -->
      <WTPARAM name="CheckBank" datatype="text"/>
      <WTPARAM name="CheckName" datatype="text"/>
      <WTPARAM name="CheckRoute" datatype="text"/>
      <WTPARAM name="CheckAccount" datatype="text"/>
      <WTPARAM name="CheckAcctType" datatype="text"/>
      <WTPARAM name="CheckNumber" datatype="text"/>

      <WTINCLUDE name="BillingMerchant.asp"/>
      <WTINCLUDE name="2FA.asp"/>
      <WTCODEGROUP>
        <WTCALLSUB name="Check2FAMerchant reqMerchantID"/>
      </WTCODEGROUP>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(CanEdit)" value="CONST(1)"/>
      </WTCODEGROUP>
      
      
      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTMETHOD name="Load">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCUSTOM>
              GetMerchantACH .Payment, reqCheckBank, reqCheckName, reqCheckRoute, reqCheckAccount, reqCheckAcctType, reqCheckNumber
            </WTCUSTOM>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(CanEdit)" oper="equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(CheckRoute)" value="CONST(&quot;*****&quot; + Right(reqCheckRoute,4))"/>
              <WTSETATTRIBUTE name="PARAM(CheckAccount)" value="CONST(&quot;*****&quot; + Right(reqCheckAccount,4))"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTCONDITION expr="PARAM(CanEdit)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(BillDate)" value="FORM(BillDate)"/>
          <WTSETATTRIBUTE name="ATTR(BillDays)" value="FORM(BillDays)"/>
          <WTSETATTRIBUTE name="ATTR(Processor)" value="FORM(Processor)"/>
          <WTSETATTRIBUTE name="ATTR(Payment)" value="CONST(SetMerchantACH( reqCheckBank, reqCheckName, reqCheckRoute, reqCheckAccount, reqCheckAcctType, reqCheckNumber ))"/>
          <WTMETHOD name="Save">
            <WTCONDITION expr="NoErrors"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsErrors"/>
            <WTCONDITION expr="PARAM(Return)" oper="equal" value="CONST(0)" connector="or"/>
            <WTMETHOD name="XML">
              <WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
              <WTPARAM name="Option" direction="input" value="CONST(2)"/>
            </WTMETHOD>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Return" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="160" align="right"/>
        <WTCOLUMN width="440" align="left"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" class="PageHeading" align="left">
            <WTSTATIC label="Merchant" value="ATTR(Merchant.MerchantName)" space="1"/>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
              <WTSTATIC label="Updated" fontcolor="red"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="IsEmployee"/>
          <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" tag="BillDate"/>
              <WTTEXT col="2" value="ATTR(Merchant.BillDate)"/>
              <WTSTATIC col="2" tag="BillDays"/>
              <WTCOMBO col="2" value="ATTR(Merchant.BillDays)" prespace="false">
                <WTOPTION id="1" label="Bill1"/>
                <WTOPTION id="2" label="Bill2"/>
                <WTOPTION id="3" label="Bill3"/>
                <WTOPTION id="4" label="Bill4"/>
                <WTOPTION id="5" label="Bill5"/>
                <WTOPTION id="6" label="Bill6"/>
                <WTOPTION id="7" label="Bill7"/>
              </WTCOMBO>
            </WTROW>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" tag="Processor"/>
              <WTCOMBO col="2" value="ATTR(Merchant.Processor)">
                <WTOPTION id="1" label="Processor1"/>
                <WTOPTION id="2" label="Processor2"/>
                <WTOPTION id="3" label="Processor3"/>
              </WTCOMBO>
            </WTROW>
            <WTROW margin-top="6" margin-bottom="6">
              <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
            </WTROW>
          </WTCODEGROUP>
        </WTCODEGROUP>
        <WTROW>
          <WTCONDITION expr="NotEmployee"/>
          <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
          <WTHIDDEN value="ATTR(Merchant.BillDate)"/>
          <WTHIDDEN value="ATTR(Merchant.BillDays)"/>
          <WTHIDDEN value="ATTR(Merchant.Processor)"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CanEdit)" oper="not-equal" value="CONST(0)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" merge="2" label="PaymentText" align="left" class="prompt"/>
            </WTROW>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" merge="2" label="PaymentTextOrg" align="left" class="prompt"/>
            </WTROW>
          </WTCODEGROUP>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckBank"/>
            <WTTEXT col="2" value="PARAM(CheckBank)" required="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckName"/>
            <WTTEXT col="2" value="PARAM(CheckName)" required="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckRoute"/>
            <WTTEXT col="2" value="PARAM(CheckRoute)" required="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckAccount"/>
            <WTTEXT col="2" value="PARAM(CheckAccount)" required="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckAcctType"/>
            <WTCOMBO col="2" value="PARAM(CheckAcctType)" required="true">
              <WTOPTION id="1" label="Checking"/>
              <WTOPTION id="2" label="Savings"/>
              <WTOPTION id="3" label="BusinessChecking"/>
            </WTCOMBO>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckNumber"/>
            <WTTEXT col="2" value="PARAM(CheckNumber)" required="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTIMAGE col="1" merge="2" align="center" value="CONST(checkref.gif)"/>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CanEdit)" oper="equal" value="CONST(0)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="equal" value="CONST(0)"/>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" tag="BillDate"/>
              <WTSTATIC col="2" value="ATTR(Merchant.BillDate)" bold="true"/>
              <WTSTATIC col="2" tag="BillDays"/>
              <WTSTATIC col="2" value="ATTR(Merchant.BillDays)" bold="true" prespace="false"/>
            </WTROW>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" tag="Processor"/>
              <WTSTATIC col="2" value="ATTR(Merchant.Processor)" bold="true"/>
            </WTROW>
            <WTROW margin-top="6" margin-bottom="6">
              <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
            </WTROW>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" merge="2" label="PaymentText" align="left" class="prompt"/>
            </WTROW>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Merchant.IsOrg)" oper="not-equal" value="CONST(0)"/>
            <WTROW margin-bottom="3">
              <WTSTATIC col="1" merge="2" label="PaymentTextOrg" align="left" class="prompt"/>
            </WTROW>
          </WTCODEGROUP>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckBank"/>
            <WTSTATIC col="2" value="PARAM(CheckBank)" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckName"/>
            <WTSTATIC col="2" value="PARAM(CheckName)" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckRoute"/>
            <WTSTATIC col="2" value="PARAM(CheckRoute)" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckAccount"/>
            <WTSTATIC col="2" value="PARAM(CheckAccount)" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckAcctType"/>
            <WTSTATIC col="2" value="PARAM(CheckAcctType)" bold="true"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="CheckNumber"/>
            <WTSTATIC col="2" value="PARAM(CheckNumber)" bold="true"/>
          </WTROW>
        </WTCODEGROUP>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
            <WTCONDITION expr="PARAM(CanEdit)" oper="not-equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center">
            <WTCONDITION expr="PARAM(Return)" oper="not-equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" merge="2" value="CONST(Home)" align="center">
            <WTCONDITION expr="PARAM(Return)" oper="equal" value="CONST(0)"/>
            <WTCLICK>window.parent.ShowTab('TabDashboard',1)</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
		<WTWEBPAGE name="15004" caption="MerchantStoreSetup" header="false" footer="false" navbar="false" wrapper="wrapper1000"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="MerchantID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="UploadImage" datatype="text"/>
			<WTPARAM name="TextColor" datatype="text"/>
			<WTPARAM name="BackColor" datatype="text"/>
			<WTPARAM name="BackImage" datatype="text"/>
			<WTPARAM name="PageColor" datatype="text"/>
			<WTPARAM name="PageImage" datatype="text"/>
			<WTPARAM name="A" datatype="number"/>
			<WTPARAM name="B" datatype="number"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="D" datatype="number"/>
			<WTPARAM name="E" datatype="number"/>
			<WTPARAM name="F" datatype="number"/>
			<WTPARAM name="G" datatype="number"/>
      <WTPARAM name="H" datatype="number"/>

      <WTJAVASCRIPT name="jscolor.js"/>
      <WTINCLUDE name="StripHTML.asp"/>
      <WTINCLUDE name="2FA.asp"/>
      <WTCODEGROUP><WTCALLSUB name="Check2FAMerchant reqMerchantID"/></WTCODEGROUP>


			<WTCODEGROUP>
				<WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
				<WTGETCACHE name="CONST(SysMerchantID)" value="MERCHANT" datatype="number"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MerchantID)" oper="not-equal" value="CONST(SysMerchantID)"/>
					<WTCUSTOM>AbortUser()</WTCUSTOM>
				</WTCODEGROUP>
			</WTCODEGROUP>

      <WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadImage)" oper="not-equal" value="&quot;&quot;"/>
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Image)" value="PARAM(UploadImage)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

      <WTSUB name="LoadStore">
        <WTSETCACHE name="IMAGEPATH" value="CONST(&quot;/Images/Store/&quot; + CSTR(reqMerchantID) + &quot;/&quot;)"/>
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTCODEGROUP>
				  <WTCUSTOM>
            If Len(.Colors) &gt; 0 Then
              a = Split(.Colors, ",")
              reqTextColor = a(0)
              reqBackColor = a(1)
              reqBackImage = a(2)
              reqPageColor = a(3)
              reqPageImage = a(4)
            End If
					  tmp = .StoreOptions
					  If InStr(tmp, "A") &gt; 0 Then reqA = 1
					  If InStr(tmp, "B") &gt; 0 Then reqB = 1
					  If InStr(tmp, "C") &gt; 0 Then reqC = 1
					  If InStr(tmp, "D") &gt; 0 Then reqD = 1
					  If InStr(tmp, "E") &gt; 0 Then reqE = 1
					  If InStr(tmp, "F") &gt; 0 Then reqF = 1
					  If InStr(tmp, "G") &gt; 0 Then reqG = 1
            If InStr(tmp, "H") &gt; 0 Then reqH = 1
          </WTCUSTOM>
          </WTCODEGROUP>          
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqMerchantID)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Store&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="FORM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="SaveStore">
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
         <WTCODEGROUP>
				    <WTCUSTOM>
              .Colors = reqTextColor + "," + reqBackColor + "," + reqBackImage + "," + reqPageColor + "," + reqPageImage
              tmp = ""
              If reqA = 1 Then tmp = tmp + "A"
              If reqB = 1 Then tmp = tmp + "B"
              If reqC = 1 Then tmp = tmp + "C"
              If reqD = 1 Then tmp = tmp + "D"
              If reqE = 1 Then tmp = tmp + "E"
              If reqF = 1 Then tmp = tmp + "F"
              If reqG = 1 Then tmp = tmp + "G"
              If reqH = 1 Then tmp = tmp + "H"
              .StoreOptions = tmp
            </WTCUSTOM>
          </WTCODEGROUP>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)">
						<WTCONDITION expr="NoErrors"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="ATTR(IsOrg)" oper="equal" value="CONST(0)" connector="and"/>
            <WTSETATTRIBUTE name="CONST(tmpDescription)" value="CONST(StripHTML(.Description))"/>
            <WTMETHOD name="UpdateFT">
						  <WTPARAM name="MerchantID" direction="input" value="ATTR(MerchantID)"/>
						  <WTPARAM name="MerchantName" direction="input" value="ATTR(MerchantName)"/>
						  <WTPARAM name="City" direction="input" value="ATTR(City)"/>
						  <WTPARAM name="State" direction="input" value="ATTR(State)"/>
						  <WTPARAM name="Zip" direction="input" value="ATTR(Zip)"/>
						  <WTPARAM name="CountryName" direction="input" value="ATTR(CountryName)"/>
						  <WTPARAM name="Description" direction="input" value="CONST(tmpDescription)"/>
						  <WTPARAM name="Result" direction="return" datatype="number"/>
					  </WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqMerchantID)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Store&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="FORM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
  			<WTCALLSUB name="LoadStore"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
  			<WTCALLSUB name="SaveStore"/>
  			<WTCALLSUB name="LoadStore"/>
			</WTACTION>

			<WTACTION id="6" name="UploadImage" type="Update">
  			<WTCALLSUB name="SaveStore"/>
					<WTCALLSUB name="LoadStore">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="15020" return="false">
						<WTPARAM name="MerchantID" value="PARAM(MerchantID)"/>
					</WTLINK>
				</WTRETURN>			
		</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="right"/>
				<WTCOLUMN width="800" align="left"/>

				<WTFUNCTION name="ImageManager()">
					var url, win;
					url = "15021.asp?merchantid=" + document.getElementById('MerchantID').value
		      win = window.open(url,"ImageManager");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="Preview()">
					var url, win;
					url = "15050.asp?preview=1&amp;merchantid=" + document.getElementById('MerchantID').value
		      win = window.open(url,"StorePreview");
					win.focus();
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="PARAM(MerchantID)"/>
				</WTROW>

          <WTROW margin-bottom="12">
          <WTTABLE col="1" merge="2" align="left">
						<WTCOLUMN width="100" align="center"/>
						<WTCOLUMN width="650" align="left"/>
						<WTCOLUMN width="250" align="center"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(Merchant48.gif)" class="PageHeader"/>
					    <WTSTATIC col="2" tag="MerchantStoreSetup" value="ATTR(Merchant.MerchantName)" class="PageHeading" align="left"/>
					    <WTSTATIC col="2" label="Updated" fontcolor="red">
        				<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
					    </WTSTATIC>
    					<WTBUTTON col="3" action="1" value="CONST(Update)" class="PageHeader"/>
    					<WTBUTTON col="3" value="CONST(Preview)" class="PageHeader">
						    <WTCLICK>Preview()</WTCLICK>
					    </WTBUTTON>
              <WTBUTTON col="3" value="CONST(Close)">
                <WTCLICK>window.close()</WTCLICK>
              </WTBUTTON>
            </WTROW>
					</WTTABLE>
				</WTROW>

 				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left" fontsize="4"/>
				</WTROW>
 				<WTROW margin-bottom="3">
					<WTSTATIC col="1" merge="2" label="DescriptionText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Merchant.Description)" cols="100" rows="10" htmleditor="true" wordcount="showParagraphs:false,showCharCount:true,countSpacesAsChars:true,countHTML:true,maxCharCount:2000"/>
				</WTROW>
        
				<WTROW>
					<WTSTATIC col="1" tag="Image"/>
					<WTTEXT col="2" value="ATTR(Merchant.Image)" class="prompt"/>
					<WTBUTTON col="2" action="6" value="CONST(Upload)"/>
					<WTSTATIC col="2" label="ImageText"/>
				</WTROW>
 				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(B)" label="RightImage" align="left" bold="true"/>
				</WTROW>
        
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Email2"/>
					<WTTEXT col="2" value="ATTR(Merchant.Email2)" required="false"/>
					<WTCHECK col="2" value="PARAM(D)" label="ShowEmail" align="left" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Phone2"/>
					<WTTEXT col="2" value="ATTR(Merchant.Phone2)" required="false"/>
					<WTCHECK col="2" value="PARAM(E)" label="ShowPhone" align="left" bold="true"/>
				</WTROW>
        
 				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(F)" label="ShowContact" align="left" bold="true"/>
					<WTSTATIC col="2" fontcolor="blue">
					  <WTSTATIC value="ATTR(Merchant.NameFirst)" space="1"/>
					  <WTSTATIC value="ATTR(Merchant.NameLast)"/>
					</WTSTATIC>
				</WTROW>
 				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(C)" label="ShowAddress" align="left" bold="true"/>
					<WTSTATIC col="2" fontcolor="blue">
					  <WTSTATIC value="ATTR(Merchant.Street1)" space="1"/>
					  <WTSTATIC value="ATTR(Merchant.Street2)" space="1"/>
					  <WTSTATIC value="ATTR(Merchant.City)" space="1"/>
					  <WTSTATIC value="ATTR(Merchant.State)" space="1"/>
					  <WTSTATIC value="ATTR(Merchant.Zip)" space="1"/>
					  <WTSTATIC value="ATTR(Merchant.CountryName)"/>
					</WTSTATIC>
				</WTROW>
 				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(H)" label="ShowMap" align="left" bold="true"/>
				</WTROW>

				<WTROW margin-top="18">
					<WTSTATIC col="1" merge="2" tag="StoreTextColor" align="center"/>
					<WTTEXT col="1" value="PARAM(TextColor)" size="10" textclass="color" prespace="false"/>
					<WTSTATIC col="1" tag="StoreBackColor"/>
					<WTTEXT col="1" value="PARAM(BackColor)" size="10" textclass="color" prespace="false"/>
					<WTSTATIC col="1" tag="StoreBackImage"/>
					<WTCOMBO col="1" value="PARAM(BackImage)" prespace="false">
						<WTOPTION id="CONST()" value="CONST()"/>
						<WTOPTION id="CONST(circles.png)" value="CONST(Circles.png)"/>
						<WTOPTION id="CONST(crossed_stripes.png)" value="CONST(crossed_stripes.png)"/>
						<WTOPTION id="CONST(crosses.png)" value="CONST(crosses.png)"/>
						<WTOPTION id="CONST(dark_circles.png)" value="CONST(dark_circles.png)"/>
						<WTOPTION id="CONST(dark_matter.png)" value="CONST(dark_matter.png)"/>
						<WTOPTION id="CONST(diamonds.png)" value="CONST(diamonds.png)"/>
						<WTOPTION id="CONST(foil.png)" value="CONST(foil.png)"/>
						<WTOPTION id="CONST(gun_metal.png)" value="CONST(gun_metal.png)"/>
						<WTOPTION id="CONST(knitted-netting.png)" value="CONST(knitted_netting.png)"/>
						<WTOPTION id="CONST(littleknobs.png)" value="CONST(littleknobs.png)"/>
						<WTOPTION id="CONST(merely_cubed.png)" value="CONST(merely_cubed.png)"/>
						<WTOPTION id="CONST(micro_carbon.png)" value="CONST(micro_carbon.png)"/>
						<WTOPTION id="CONST(small-crackle.png)" value="CONST(small_crackle.png)"/>
						<WTOPTION id="CONST(soft_pad.png)" value="CONST(soft_pad.png)"/>
						<WTOPTION id="CONST(white_carbon.png)" value="CONST(white_carbon.png)"/>
						<WTOPTION id="CONST(zigzag.png)" value="CONST(zigzag.png)"/>
					</WTCOMBO>
				</WTROW>
 				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(G)" label="NoStoreBack" align="left" bold="true"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(A)" label="Store3DBox" align="left" bold="true"/>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" tag="StorePageColor" align="center"/>
					<WTTEXT col="1" value="PARAM(PageColor)" size="10" textclass="color" prespace="false"/>
					<WTSTATIC col="1" tag="StorePageImage"/>
					<WTCOMBO col="1" value="PARAM(PageImage)" prespace="false">
						<WTOPTION id="CONST()" value="CONST()"/>
						<WTOPTION id="CONST(circles.png)" value="CONST(Circles.png)"/>
						<WTOPTION id="CONST(crossed_stripes.png)" value="CONST(crossed_stripes.png)"/>
						<WTOPTION id="CONST(crosses.png)" value="CONST(crosses.png)"/>
						<WTOPTION id="CONST(dark_circles.png)" value="CONST(dark_circles.png)"/>
						<WTOPTION id="CONST(dark_matter.png)" value="CONST(dark_matter.png)"/>
						<WTOPTION id="CONST(diamonds.png)" value="CONST(diamonds.png)"/>
						<WTOPTION id="CONST(foil.png)" value="CONST(foil.png)"/>
						<WTOPTION id="CONST(gun_metal.png)" value="CONST(gun_metal.png)"/>
						<WTOPTION id="CONST(knitted-netting.png)" value="CONST(knitted_netting.png)"/>
						<WTOPTION id="CONST(littleknobs.png)" value="CONST(littleknobs.png)"/>
						<WTOPTION id="CONST(merely_cubed.png)" value="CONST(merely_cubed.png)"/>
						<WTOPTION id="CONST(micro_carbon.png)" value="CONST(micro_carbon.png)"/>
						<WTOPTION id="CONST(small-crackle.png)" value="CONST(small_crackle.png)"/>
						<WTOPTION id="CONST(soft_pad.png)" value="CONST(soft_pad.png)"/>
						<WTOPTION id="CONST(white_carbon.png)" value="CONST(white_carbon.png)"/>
						<WTOPTION id="CONST(zigzag.png)" value="CONST(zigzag.png)"/>
					</WTCOMBO>
				</WTROW>

 				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Details" align="left" fontsize="4"/>
				</WTROW>
 				<WTROW margin-bottom="3">
					<WTSTATIC col="1" merge="2" label="DetailsText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" cols="100" rows="80" htmleditor="editor2" editortemplates="CKEditor/templates_store.js" embedhtml="true" wordcount="showCharCount:true"/>
				</WTROW>

        <WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
<!--					<WTBUTTON col="1" merge="2" action="5" value="CONST(Preview)" align="center"/>-->
					<WTBUTTON col="1" merge="2" value="CONST(StoreImageManager)" align="center">
						<WTCLICK>ImageManager()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--**************************************Image Upload Page**************************************-->
		<!--===========================================================================================-->
		<WTWEBPAGE name="15020" caption="Upload File" action="false" header="false" footer="false" submit="15020Upload.asp" type="multi" wrapper="wrapper600" 
               aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--===========================================================================================-->
			<WTPARAM name="MerchantID" datatype="number"/>
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
				<WTGETCACHE name="CONST(SysMerchantID)" value="MERCHANT" datatype="number"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MerchantID)" oper="not-equal" value="CONST(SysMerchantID)"/>
					<WTCUSTOM>AbortUser()</WTCUSTOM>
				</WTCODEGROUP>
			</WTCODEGROUP>

      <WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
        <WTCUSTOM>
					        DoError reqUploadError, "Upload", reqUploadErrorDesc
        </WTCUSTOM>
			</WTCODEGROUP>
      
			<WTACTION id="0" name="New" type="New">
				<WTSETCACHE name="MERCHANTID" value="PARAM(MerchantID)"/>
			</WTACTION>
				
	
	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="150" align="left"/>

				<WTROW margin-top="19">
					<WTSTATIC col="1" merge="3" label="UploadImageHeader" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="19">
					<WTSTATIC col="1" merge="3" label="UploadImageText" class="Prompt"/>
				</WTROW>
				
				<WTROW margin-bottom="19">
					<WTSTATIC col="1"/>
					<WTFILE col="2" align="center" value="upload" accept="*.gif, *.jpg, *.png, *.bmp"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" align="center" default="true" value="CONST(Submit)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="15021" caption="Upload Images" header="false" footer="false" navbar="false" wrapper="wrapper750"
		   action="false" submit="15021Upload.asp" type="multi" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			<WTPARAM name="UploadImageFile" datatype="text"/>
			<WTPARAM name="DeleteFile" datatype="text"/>
			<WTPARAM name="MerchantID" datatype="number"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
				<WTGETCACHE name="CONST(SysMerchantID)" value="MERCHANT" datatype="number"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MerchantID)" oper="not-equal" value="CONST(SysMerchantID)"/>
					<WTCUSTOM>AbortUser()</WTCUSTOM>
				</WTCODEGROUP>
			</WTCODEGROUP>

      <WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
        <WTCUSTOM>
					        DoError reqUploadError, "Upload", reqUploadErrorDesc
        </WTCUSTOM>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadImageFile)" oper="not-equal" value="CONST(&quot;&quot;)"/>
        <WTCUSTOM>
					        DoError reqUploadError, "Upload", reqUploadImageFile + " Successfully Uploaded!"
        </WTCUSTOM>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<WTSETCACHE name="MERCHANTID" value="PARAM(MerchantID)"/>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;images\store\&quot; &amp; reqMerchantID &amp; &quot;\&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(DeleteFile)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Filename)" value="PARAM(DeleteFile)"/>
						<WTMETHOD name="Delete"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Ext)" value="CONST(&quot;gif,jpg,png&quot;)"/>
					<WTMETHOD name="XMLFiles">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>			
			</WTACTION>
	
	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="left"/>
				<WTCOLUMN width="550" align="left"/>
				
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="StoreImageManager" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="UploadImagesText" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTFILE col="1" merge="2" value="upload" align="center" size="40"/>
					<WTBUTTON col="1" merge="2" align="center" default="true" action="1" value="CONST(Submit)"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#777777"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTIMAGE col="1" merge="2" id="PreviewImage" name="PreviewImage" value="CONST(imgpreview.gif)" align="center" valign="center">
<!--						<WTSPAN style="BORDER-RIGHT: gray 1px solid; BORDER-TOP: threeddarkshadow 1px solid; OVERFLOW: auto; BORDER-LEFT: threeddarkshadow 1px solid; WIDTH: 350px; BORDER-BOTTOM: gray 1px solid; HEIGHT: 200px; BACKGROUND-COLOR: white"/>-->
					</WTIMAGE>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="UploadedImages" class="prompt" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#777777"/>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="2">
<!--						<WTSPAN style="BORDER-RIGHT: gray 1px solid; BORDER-TOP: threeddarkshadow 1px solid; OVERFLOW: auto; BORDER-LEFT: threeddarkshadow 1px solid; WIDTH: 600px; BORDER-BOTTOM: gray 1px solid; HEIGHT: 400px; BACKGROUND-COLOR: white"/>-->
						<WTCOLUMN width="150" align="left"/>
						<WTCOLUMN width="200" align="left"/>
						<WTCOLUMN width="100" align="left"/>
						<WTCOLUMN width="150" align="left"/>
						<WTCOLUMN width="150" align="left"/>

						<WTREPEAT xpath="/DATA/TXN/FILES/FILE">
							<WTROW height="20">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" value="DATA(name)">
									<WTLINK click="true" name="CONST(document.PreviewImage.src='images/store/&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@merchantid,'/',@name)&quot;/&gt;')"/>
								</WTSTATIC>
								<WTSTATIC col="3" value="DATA(size)"/>
								<WTSTATIC col="4" value="DATA(date)"/>
								<WTLINKGROUP col="5" >
									<WTLINK name="15021" label="Delete" class="SelectLink">
										<WTPARAM name="DeleteFile" value="DATA(name)"/>
										<WTPARAM name="MerchantID" value="PARAM(MerchantID)"/>
									</WTLINK>
								</WTLINKGROUP>
							</WTROW>
						</WTREPEAT>
					</WTTABLE>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="15050" caption="Store" header="false" footer="false" navbar="false" wrapper="wrapper-store" 
     wrapper-style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@wrapperstyle&quot;/&gt;"
		 page-color="&lt;xsl:value-of select=&quot;/DATA/PARAM/@pagecolor&quot;/&gt;" 
		 page-image="&lt;xsl:value-of select=&quot;/DATA/PARAM/@pageimage&quot;/&gt;" 
      aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="S" datatype="number"/>
			<WTPARAM name="MerchantID" datatype="number"/>
			<WTPARAM name="StoreOptions" datatype="text"/>
			<WTPARAM name="TextColor" datatype="text"/>
			<WTPARAM name="BackColor" datatype="text"/>
			<WTPARAM name="BackImage" datatype="text"/>
			<WTPARAM name="PageColor" datatype="text"/>
			<WTPARAM name="PageImage" datatype="text"/>
			<WTPARAM name="TextStyle" datatype="text"/>
			<WTPARAM name="WrapperStyle" datatype="text"/>
      <WTPARAM name="AcceptedCoins" datatype="text"/>
      <WTPARAM name="Preview" datatype="number"/>

      <WTCODEGROUP>
 			  <WTSETATTRIBUTE name="PARAM(MerchantID)" value="PARAM(S)">
				  <WTCONDITION expr="PARAM(MerchantID)" oper="equal" value="CONST(0)"/>
				  <WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(0)" connector="and"/>
			  </WTSETATTRIBUTE>
      </WTCODEGROUP>
			<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MerchantID)" oper="equal" value="CONST(0)"/>
					<WTCUSTOM>AbortUser()</WTCUSTOM>
			</WTCODEGROUP>
      
      <WTSUB name="LoadStore">
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
			    <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Preview)" oper="equal" value="CONST(0)"/>
            <WTCONDITION expr="ATTR(Status)" oper="not-equal" value="SYSCON(MERCHANT-STATUS-ACTIVE)" connector="and"/>
            <WTCUSTOM>
						  Response.write "Store Closed"
						  Response.End
					  </WTCUSTOM>
			    </WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(StoreOptions)" value="ATTR(StoreOptions)"/>
          <WTCODEGROUP>
				  <WTCUSTOM>
            If Len(.Colors) &gt; 0 Then
              a = Split(.Colors, ",")
              reqTextColor = a(0)
              reqBackColor = a(1)
              reqBackImage = a(2)
              reqPageColor = a(3)
              reqPageImage = a(4)
            End If
            reqTextStyle = "font-family:'Open Sans', Arial, sans-serif; font-size:16pt; font-weight:bold; color:" + reqTextColor
				  </WTCUSTOM>
          </WTCODEGROUP>      
          <WTCODEGROUP>
            <WTCONDITION expr="NotStoreNoBackground"/>
				  <WTCUSTOM>
            reqWrapperStyle = "background-color:" + reqBackColor + ";" 
            If Len(reqBackImage) &gt; 0 Then reqWrapperStyle = reqWrapperStyle + "background-repeat:repeat; background-image:url(images/" + reqBackImage + ");"
          </WTCUSTOM>
          </WTCODEGROUP>      
          <WTCODEGROUP>
            <WTCONDITION expr="IsStore3DBox"/>
				  <WTCUSTOM>
            reqWrapperStyle = reqWrapperStyle + "border: 2px solid #ccc; border-radius: 8px; box-shadow: 5px 5px 5px #666; -moz-box-shadow: 5px 5px 5px #666; -webkit-box-shadow: 5px 5px 5px #666;"
          </WTCUSTOM>
          </WTCODEGROUP>      
          
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
          <WTMETHOD name="Custom">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="Status" direction="input" value="CONST(1)"/>
            <WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
            <WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
            <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Access" direction="input" value="CONST(&quot;&quot;)"/>
            <WTPARAM name="reqAcceptedCoins" direction="return" datatype="text"/>
          </WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqMerchantID)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Store&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="FORM(Language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Awards" project="ptsAwardUser" class="CAwards">
					<WTMETHOD name="ListAwards">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="AwardType" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAwards" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
  			<WTCALLSUB name="LoadStore"/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left"/>

				<WTFUNCTION name="ViewMap(address)">
					var url, win;
					url = "http://maps.google.com/?q=" + address
		      win = window.open(url,"Map");
					win.focus();
				</WTFUNCTION>
        <WTFUNCTION name="ViewAwards()">
          var mid = document.getElementById('MerchantID').value;
          var  url = "15312.asp?merchantid=" + mid
          var win = window.open(url,"Awards","top=100,left=100,height=400,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
          win.focus();
        </WTFUNCTION>

        <WTROW>
					<WTHIDDEN value="PARAM(MerchantID)"/>
				</WTROW>

        <WTSTATIC label="ViewMap"/>
        
        <WTROW margin-bottom="12">
           <WTCONDITION expr="_NotStoreImageRight"/>
           <WTTABLE col="1" merge="2" align="left" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
						<WTCOLUMN width="300" align="center"/>
						<WTCOLUMN width="700" align="left"/>
						<WTROW>
						<WTIMAGE col="1" value="ATTR(Merchant.Image)" align="center" valign="top" path="CONST(Store/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMERCHANT/@merchantid&quot;/&gt;)" imgwidth="300">
							<WTCONDITION expr="ATTR(Merchant.Image)" oper="not-equal" value="''"/>
						</WTIMAGE>
					    <WTSTATIC col="2" align="center" valign="top" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
                <WTSTATIC newline="1"/>
                <WTSTATIC value="ATTR(Merchant.MerchantName)" space="1"/>
                  <WTCODEGROUP>
          					<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMERCHANT/@rating&quot;/&gt;.gif)" imgalign="absmiddle"/>
                  </WTCODEGROUP>
                <WTCODEGROUP>
  		            <WTCONDITION expr="_IsStoreShowEmail"/>
  		            <WTCONDITION expr="_IsStoreShowPhone" connector="or"/>
  		            <WTCONDITION expr="_IsStoreShowContact" connector="or"/>
                  <WTSTATIC newline="1"/>
                  <WTCODEGROUP>
  		              <WTCONDITION expr="_IsStoreShowContact"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC fontsize="3">
                      <WTSTATIC value="ATTR(Merchant.NameFirst)" space="1"/>
                      <WTSTATIC value="ATTR(Merchant.NameLast)"/>
                    </WTSTATIC>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
  		              <WTCONDITION expr="_IsStoreShowEmail"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Email2)" fontsize="3"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
  		              <WTCONDITION expr="_IsStoreShowPhone"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Phone2)" fontsize="3"/>
                  </WTCODEGROUP>
                </WTCODEGROUP>
                <WTCODEGROUP>
  		            <WTCONDITION expr="_IsStoreShowAddress"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC fontsize="3">
                    <WTSTATIC value="ATTR(Merchant.Street1)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Street2)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.City)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.State)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Zip)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.CountryName)"/>
                    <WTCODEGROUP>
    		              <WTCONDITION expr="_IsStoreShowMap"/>
                      <WTSTATIC space="1"/>
									    <WTIMAGE value="CONST(GoogleMaps.png)" alt="ViewMap" imgalign="absmiddle">
                        <WTLINK name="ViewMap(&quot;&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMERCHANT/@street1, ' ', /DATA/TXN/PTSMERCHANT/@street2, ' ', /DATA/TXN/PTSMERCHANT/@city, ' ', /DATA/TXN/PTSMERCHANT/@state, ' ', /DATA/TXN/PTSMERCHANT/@zip, ' ', /DATA/TXN/PTSMERCHANT/@countryname)&quot;/&gt;&quot;)" click="true" />
									    </WTIMAGE>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTCODEGROUP>
								<WTREPEAT entity="Award">
                  <WTSTATIC newline="1"/>
                  <WTSTATIC value="DATA(Amount)"/>
  								<WTSTATIC label="%" space="1"/>
                  <WTSTATIC value="DATA(description)"/>
                  <WTSTATIC>
                    <WTCONDITION expr="DATA(Cap)" oper="not-equal" value="CONST('$0.00')"/>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="upto" space="1"/>
                    <WTSTATIC value="DATA(Cap)"/>
                  </WTSTATIC>
                </WTREPEAT>
                <WTCODEGROUP>
                  <WTCONDITION expr="ATTR(Merchant.IsAwards)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC label="IsAwards" fontsize="3" space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(gift24.png)" imgalign="absmiddle">
                      <WTLINK name="ViewAwards()" click="true" />
                    </WTIMAGE>
                  </WTCODEGROUP>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="ATTR(Merchant.Terms)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC value="ATTR(Merchant.Terms)" fontsize="3"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(AcceptedCoins)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC newline="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',1,'))"/>
      							<WTIMAGE value="CONST(coin1.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',2,'))"/>
      							<WTIMAGE value="CONST(coin2.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',3,'))"/>
      							<WTIMAGE value="CONST(coin3.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',4,'))"/>
      							<WTIMAGE value="CONST(coin4.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',5,'))"/>
      							<WTIMAGE value="CONST(coin5.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',6,'))"/>
      							<WTIMAGE value="CONST(coin6.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',7,'))"/>
      							<WTIMAGE value="CONST(coin7.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',8,'))"/>
      							<WTIMAGE value="CONST(coin8.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',9,'))"/>
      							<WTIMAGE value="CONST(coin9.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',10,'))"/>
      							<WTIMAGE value="CONST(coin10.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                </WTCODEGROUP>
					    </WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
        
        <WTROW margin-bottom="12">
           <WTCONDITION expr="_IsStoreImageRight"/>
           <WTTABLE col="1" merge="2" align="left" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
						<WTCOLUMN width="700" align="left"/>
						<WTCOLUMN width="300" align="center"/>
						<WTROW>
					    <WTSTATIC col="1" align="center" valign="top" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
                <WTSTATIC newline="1"/>
                <WTSTATIC value="ATTR(Merchant.MerchantName)"/>
                <WTCODEGROUP>
  		            <WTCONDITION expr="_IsStoreShowEmail"/>
  		            <WTCONDITION expr="_IsStoreShowPhone" connector="or"/>
  		            <WTCONDITION expr="_IsStoreShowContact" connector="or"/>
                  <WTSTATIC newline="1"/>
                  <WTCODEGROUP>
  		              <WTCONDITION expr="_IsStoreShowEmail"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Email2)" fontsize="3"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
  		              <WTCONDITION expr="_IsStoreShowPhone"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Phone2)" fontsize="3"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
  		              <WTCONDITION expr="_IsStoreShowContact"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC fontsize="3">
                      <WTSTATIC value="ATTR(Merchant.NameFirst)" space="1"/>
                      <WTSTATIC value="ATTR(Merchant.NameLast)"/>
                    </WTSTATIC>
                  </WTCODEGROUP>
                </WTCODEGROUP>
                <WTCODEGROUP>
  		            <WTCONDITION expr="_IsStoreShowAddress"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC fontsize="3">
                    <WTSTATIC value="ATTR(Merchant.Street1)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Street2)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.City)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.State)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Zip)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.CountryName)"/>
                    <WTCODEGROUP>
    		              <WTCONDITION expr="_IsStoreShowMap"/>
                      <WTSTATIC space="1"/>
									    <WTIMAGE value="CONST(GoogleMaps.png)" alt="ViewMap" imgalign="absmiddle">
                        <WTLINK name="ViewMap(&quot;&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMERCHANT/@street1, ' ', /DATA/TXN/PTSMERCHANT/@street2, ' ', /DATA/TXN/PTSMERCHANT/@city, ' ', /DATA/TXN/PTSMERCHANT/@state, ' ', /DATA/TXN/PTSMERCHANT/@zip, ' ', /DATA/TXN/PTSMERCHANT/@countryname)&quot;/&gt;&quot;)" click="true" />
									    </WTIMAGE>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTCODEGROUP>
								<WTREPEAT entity="Award">
                  <WTSTATIC newline="1"/>
                  <WTSTATIC value="DATA(Amount)"/>
  								<WTSTATIC label="%" space="1"/>
                  <WTSTATIC value="DATA(description)"/>
                  <WTSTATIC>
                    <WTCONDITION expr="DATA(Cap)" oper="not-equal" value="CONST('$0.00')"/>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="upto" space="1"/>
                    <WTSTATIC value="DATA(Cap)"/>
                  </WTSTATIC>
                  <WTCODEGROUP>
                    <WTCONDITION expr="ATTR(Merchant.IsAwards)" oper="not-equal" value="CONST(0)"/>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC label="IsAwards" fontsize="3" space="1"/>
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(gift24.png)" imgalign="absmiddle">
                        <WTLINK name="ViewAwards()" click="true" />
                      </WTIMAGE>
                    </WTCODEGROUP>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="ATTR(Merchant.Terms)" oper="not-equal" value="CONST('')"/>
                    <WTSTATIC newline="1"/>
                    <WTSTATIC value="ATTR(Merchant.Terms)" fontsize="3"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(AcceptedCoins)" oper="not-equal" value="CONST('')"/>
                    <WTSTATIC newline="1"/>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',1,'))"/>
                      <WTIMAGE value="CONST(coin1.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',2,'))"/>
                      <WTIMAGE value="CONST(coin2.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',3,'))"/>
                      <WTIMAGE value="CONST(coin3.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',4,'))"/>
                      <WTIMAGE value="CONST(coin4.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',5,'))"/>
                      <WTIMAGE value="CONST(coin5.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',6,'))"/>
                      <WTIMAGE value="CONST(coin6.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',7,'))"/>
                      <WTIMAGE value="CONST(coin7.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',8,'))"/>
                      <WTIMAGE value="CONST(coin8.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',9,'))"/>
                      <WTIMAGE value="CONST(coin9.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',10,'))"/>
                      <WTIMAGE value="CONST(coin10.gif)" imgalign="absmiddle"/>
                      <WTSTATIC space="1"/>
                    </WTCODEGROUP>
                  </WTCODEGROUP>
                </WTREPEAT>
					    </WTSTATIC>
						<WTIMAGE col="2" value="ATTR(Merchant.Image)" align="center" valign="top" path="CONST(Store/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMERCHANT/@merchantid&quot;/&gt;)" imgwidth="300">
							<WTCONDITION expr="ATTR(Merchant.Image)" oper="not-equal" value="''"/>
						</WTIMAGE>
						</WTROW>
					</WTTABLE>
				</WTROW>
        
				<WTROW margin-bottom="24">
					<WTSTATIC col="1" value="ATTR(Merchant.Description)" embedhtml="true"/>
				</WTROW>
        
				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
        
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

      <!--============================================================================================-->
    <WTWEBPAGE name="m_15050" caption="Store" page-left="3" page-top="0"  header="false" footer="false" navbar="false" wrapper="false"
     page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
     wrapper-style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@wrapperstyle&quot;/&gt;"
		 page-color="&lt;xsl:value-of select=&quot;/DATA/PARAM/@pagecolor&quot;/&gt;"
		 page-image="&lt;xsl:value-of select=&quot;/DATA/PARAM/@pageimage&quot;/&gt;"
      aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
      <!--============================================================================================-->
      <WTPARAM name="S" datatype="number"/>
      <WTPARAM name="MerchantID" datatype="number"/>
      <WTPARAM name="StoreOptions" datatype="text"/>
      <WTPARAM name="TextColor" datatype="text"/>
      <WTPARAM name="BackColor" datatype="text"/>
      <WTPARAM name="BackImage" datatype="text"/>
      <WTPARAM name="PageColor" datatype="text"/>
      <WTPARAM name="PageImage" datatype="text"/>
      <WTPARAM name="TextStyle" datatype="text"/>
      <WTPARAM name="WrapperStyle" datatype="text"/>
      <WTPARAM name="AcceptedCoins" datatype="text"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(MerchantID)" value="PARAM(S)">
          <WTCONDITION expr="PARAM(MerchantID)" oper="equal" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(0)" connector="and"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(MerchantID)" oper="equal" value="CONST(0)"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTSUB name="LoadStore">
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTMETHOD name="Load">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Status)" oper="not-equal" value="SYSCON(MERCHANT-STATUS-ACTIVE)"/>
            <WTCUSTOM>
              Response.write "Store Closed"
              Response.End
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="PARAM(StoreOptions)" value="ATTR(StoreOptions)"/>
          <WTCODEGROUP>
            <WTCUSTOM>
              If Len(.Colors) &gt; 0 Then
              a = Split(.Colors, ",")
              reqTextColor = a(0)
              reqBackColor = a(1)
              reqBackImage = a(2)
              reqPageColor = a(3)
              reqPageImage = a(4)
              End If
              reqTextStyle = "font-family:'Open Sans', Arial, sans-serif; font-size:16pt; font-weight:bold; color:" + reqTextColor
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="NotStoreNoBackground"/>
            <WTCUSTOM>
              reqWrapperStyle = "background-color:" + reqBackColor + ";"
              If Len(reqBackImage) &gt; 0 Then reqWrapperStyle = reqWrapperStyle + "background-repeat:repeat; background-image:url(images/" + reqBackImage + ");"
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="IsStore3DBox"/>
            <WTCUSTOM>
              reqWrapperStyle = reqWrapperStyle + "border: 2px solid #ccc; border-radius: 8px; box-shadow: 5px 5px 5px #666; -moz-box-shadow: 5px 5px 5px #666; -webkit-box-shadow: 5px 5px 5px #666;"
            </WTCUSTOM>
          </WTCODEGROUP>

          <WTMETHOD name="XML">
            <WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
          <WTMETHOD name="Custom">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="Status" direction="input" value="CONST(1)"/>
            <WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
            <WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
            <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Access" direction="input" value="CONST(&quot;&quot;)"/>
            <WTPARAM name="reqAcceptedCoins" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(reqMerchantID)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Store&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="FORM(Language)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Awards" project="ptsAwardUser" class="CAwards">
          <WTMETHOD name="ListAwards">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="AwardType" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlAwards" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadStore"/>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="100" align="left"/>

        <WTFUNCTION name="ViewMap(address)">
          var url, win;
          url = "http://maps.google.com/?q=" + address
          win = window.open(url,"Map");
          win.focus();
        </WTFUNCTION>
        <WTFUNCTION name="ViewAwards()">
          var mid = document.getElementById('MerchantID').value;
          var  url = "m_15312.asp?merchantid=" + mid
          var win = window.open(url);
          win.focus();
        </WTFUNCTION>

        <WTROW>
          <WTHIDDEN value="PARAM(MerchantID)"/>
        </WTROW>

        <WTSTATIC label="ViewMap"/>

        <WTROW margin-bottom="12">
          <WTCONDITION expr="_NotStoreImageRight"/>
          <WTTABLE col="1" merge="2" align="left" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
            <WTCOLUMN width="30" align="center"/>
            <WTCOLUMN width="70" align="left"/>
            <WTROW>
              <WTIMAGE col="1" value="ATTR(Merchant.Image)" align="center" valign="top" path="CONST(Store/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMERCHANT/@merchantid&quot;/&gt;)" imgwidth="300">
                <WTCONDITION expr="ATTR(Merchant.Image)" oper="not-equal" value="''"/>
              </WTIMAGE>
              <WTSTATIC col="2" align="center" valign="top" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
                <WTSTATIC newline="1"/>
                <WTSTATIC value="ATTR(Merchant.MerchantName)" space="1"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMERCHANT/@rating&quot;/&gt;.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="_IsStoreShowEmail"/>
                  <WTCONDITION expr="_IsStoreShowPhone" connector="or"/>
                  <WTCONDITION expr="_IsStoreShowContact" connector="or"/>
                  <WTSTATIC newline="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="_IsStoreShowContact"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC fontsize="3">
                      <WTSTATIC value="ATTR(Merchant.NameFirst)" space="1"/>
                      <WTSTATIC value="ATTR(Merchant.NameLast)"/>
                    </WTSTATIC>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="_IsStoreShowEmail"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Email2)" fontsize="3"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="_IsStoreShowPhone"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Phone2)" fontsize="3"/>
                  </WTCODEGROUP>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="_IsStoreShowAddress"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC fontsize="3">
                    <WTSTATIC value="ATTR(Merchant.Street1)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Street2)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.City)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.State)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Zip)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.CountryName)"/>
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsStoreShowMap"/>
                      <WTSTATIC space="1"/>
                      <WTIMAGE value="CONST(GoogleMaps.png)" alt="ViewMap" imgalign="absmiddle">
                        <WTLINK name="ViewMap(&quot;&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMERCHANT/@street1, ' ', /DATA/TXN/PTSMERCHANT/@street2, ' ', /DATA/TXN/PTSMERCHANT/@city, ' ', /DATA/TXN/PTSMERCHANT/@state, ' ', /DATA/TXN/PTSMERCHANT/@zip, ' ', /DATA/TXN/PTSMERCHANT/@countryname)&quot;/&gt;&quot;)" click="true" />
                      </WTIMAGE>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTREPEAT entity="Award">
                  <WTSTATIC newline="1"/>
                  <WTSTATIC value="DATA(Amount)"/>
                  <WTSTATIC label="%" space="1"/>
                  <WTSTATIC value="DATA(description)"/>
                  <WTSTATIC>
                    <WTCONDITION expr="DATA(Cap)" oper="not-equal" value="CONST('$0.00')"/>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="upto" space="1"/>
                    <WTSTATIC value="DATA(Cap)"/>
                  </WTSTATIC>
                </WTREPEAT>
                <WTCODEGROUP>
                  <WTCONDITION expr="ATTR(Merchant.IsAwards)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC label="IsAwards" fontsize="3" space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(gift24.png)" imgalign="absmiddle">
                      <WTLINK name="ViewAwards()" click="true" />
                    </WTIMAGE>
                  </WTCODEGROUP>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="ATTR(Merchant.Terms)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC value="ATTR(Merchant.Terms)" fontsize="3"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(AcceptedCoins)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC newline="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',1,'))"/>
                    <WTIMAGE value="CONST(coin1.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',2,'))"/>
                    <WTIMAGE value="CONST(coin2.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',3,'))"/>
                    <WTIMAGE value="CONST(coin3.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',4,'))"/>
                    <WTIMAGE value="CONST(coin4.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',5,'))"/>
                    <WTIMAGE value="CONST(coin5.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',6,'))"/>
                    <WTIMAGE value="CONST(coin6.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',7,'))"/>
                    <WTIMAGE value="CONST(coin7.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',8,'))"/>
                    <WTIMAGE value="CONST(coin8.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',9,'))"/>
                    <WTIMAGE value="CONST(coin9.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@acceptedcoins, ',10,'))"/>
                    <WTIMAGE value="CONST(coin10.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTCONDITION expr="_IsStoreImageRight"/>
          <WTTABLE col="1" merge="2" align="left" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
            <WTCOLUMN width="70" align="left"/>
            <WTCOLUMN width="30" align="center"/>
            <WTROW>
              <WTSTATIC col="1" align="center" valign="top" style="&lt;xsl:value-of select=&quot;/DATA/PARAM/@textstyle&quot;/&gt;">
                <WTSTATIC newline="1"/>
                <WTSTATIC value="ATTR(Merchant.MerchantName)"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="_IsStoreShowEmail"/>
                  <WTCONDITION expr="_IsStoreShowPhone" connector="or"/>
                  <WTCONDITION expr="_IsStoreShowContact" connector="or"/>
                  <WTSTATIC newline="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="_IsStoreShowEmail"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Email2)" fontsize="3"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="_IsStoreShowPhone"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC value="ATTR(Merchant.Phone2)" fontsize="3"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="_IsStoreShowContact"/>
                    <WTSTATIC space="3"/>
                    <WTSTATIC fontsize="3">
                      <WTSTATIC value="ATTR(Merchant.NameFirst)" space="1"/>
                      <WTSTATIC value="ATTR(Merchant.NameLast)"/>
                    </WTSTATIC>
                  </WTCODEGROUP>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="_IsStoreShowAddress"/>
                  <WTSTATIC newline="1"/>
                  <WTSTATIC fontsize="3">
                    <WTSTATIC value="ATTR(Merchant.Street1)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Street2)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.City)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.State)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.Zip)" space="1"/>
                    <WTSTATIC value="ATTR(Merchant.CountryName)"/>
                    <WTCODEGROUP>
                      <WTCONDITION expr="_IsStoreShowMap"/>
                      <WTSTATIC space="1"/>
                      <WTIMAGE value="CONST(GoogleMaps.png)" alt="ViewMap" imgalign="absmiddle">
                        <WTLINK name="ViewMap(&quot;&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMERCHANT/@street1, ' ', /DATA/TXN/PTSMERCHANT/@street2, ' ', /DATA/TXN/PTSMERCHANT/@city, ' ', /DATA/TXN/PTSMERCHANT/@state, ' ', /DATA/TXN/PTSMERCHANT/@zip, ' ', /DATA/TXN/PTSMERCHANT/@countryname)&quot;/&gt;&quot;)" click="true" />
                      </WTIMAGE>
                    </WTCODEGROUP>
                  </WTSTATIC>
                </WTCODEGROUP>
                <WTREPEAT entity="Award">
                  <WTSTATIC newline="1"/>
                  <WTSTATIC value="DATA(Amount)"/>
                  <WTSTATIC label="%" space="1"/>
                  <WTSTATIC value="DATA(description)"/>
                  <WTSTATIC>
                    <WTCONDITION expr="DATA(Cap)" oper="not-equal" value="CONST('$0.00')"/>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="upto" space="1"/>
                    <WTSTATIC value="DATA(Cap)"/>
                  </WTSTATIC>
                </WTREPEAT>
              </WTSTATIC>
              <WTIMAGE col="2" value="ATTR(Merchant.Image)" align="center" valign="top" path="CONST(Store/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMERCHANT/@merchantid&quot;/&gt;)" imgwidth="300">
                <WTCONDITION expr="ATTR(Merchant.Image)" oper="not-equal" value="''"/>
              </WTIMAGE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-bottom="24">
          <WTSTATIC col="1" value="ATTR(Merchant.Description)" embedhtml="true"/>
        </WTROW>

        <WTROW>
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
		<WTWEBPAGE name="15005" caption="Nexxus Rewards" header="false" footer="false" navbar="false" wrapper="wrapper600"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="15005">
		<!--============================================================================================-->
			<WTPARAM name="C" datatype="number"/>	<!-- CompanyID -->
			<WTPARAM name="Logon" datatype="text"/>
			<WTPARAM name="Password" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="LogonMerchant" datatype="text"/>
			<WTPARAM name="PasswordMerchant" datatype="text"/>
			<WTPARAM name="RememberMerchant" datatype="number"/>
			<WTPARAM name="LogonConsumer" datatype="text"/>
			<WTPARAM name="PasswordConsumer" datatype="text"/>
			<WTPARAM name="RememberConsumer" datatype="number"/>
      <WTPARAM name="UserKey" datatype="text"/>
      <WTPARAM name="SecurityCode" datatype="text"/>
      <WTPARAM name="UserAction" datatype="number"/>

      <WTINCLUDE name="Company.asp"/>
      <WTINCLUDE name="Google2FA.asp"/>
      <WTINCLUDE name="LimitedAccess.asp"/>
      <WTINCLUDE name="Comm.asp"/>
      <WTINCLUDE name="MobileBrowser.asp"/>

      <!-- Check for mobile device and redirect to mobile login page -->
      <WTCODEGROUP>
        <WTSETATTRIBUTE name="CONST(tmpMobile)" value="CONST(IsMobileBrowser())"/>
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(tmpMobile)" oper="not-equal" value="CONST(0)"/>
          <WTRETURN><WTLINK name="m_15005" return="false"/></WTRETURN>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSETATTRIBUTE name="PARAM(C)" value="SYSCON(NEXXUS)">
        <WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
      </WTSETATTRIBUTE>
      <WTSETATTRIBUTE name="CONST(reqActionCode)" value="PARAM(UserAction)">
        <WTCONDITION expr="PARAM(UserAction)" oper="not-equal" value="CONST(0)"/>
      </WTSETATTRIBUTE>

      <WTSUB function="SendPassword( bvMerchantID, bvConsumerID )">
        <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
          <WTMETHOD name="Load">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Forgot Nexxus Rewards Password&quot;)"/>
        </WTOBJECT>
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTCONDITION expr="CONST(bvMerchantID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MerchantID" direction="input" value="CONST(bvMerchantID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Merchant.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(&quot;Merchant: &quot; + .MerchantName + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Merchant #: &quot; + CStr(.MerchantID) + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Email: &quot; + .Email + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Admin Password: &quot; + .Password + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Staff Password: &quot; + .Password2 )"/>
        </WTOBJECT>
        <WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
          <WTCONDITION expr="CONST(bvConsumerID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="ConsumerID" direction="input" value="CONST(bvConsumerID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Consumer.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(&quot;Shopper: &quot; + .NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Phone: &quot; + .Phone + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Email: &quot; + .Email + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Password: &quot; + .Password )"/>
        </WTOBJECT>
        <WTCUSTOM>
          If InStr(tmpTo, "@") &gt; 0 Then
            If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
            SendEmail reqC, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
          End If
        </WTCUSTOM>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTSETCACHE name="MERCHANT" value="CONST(&quot;&quot;)"/>
        <WTSETCACHE name="CONSUMER" value="CONST(&quot;&quot;)"/>
        <WTCALLSUB name="GetCompany(reqC)"/>
				<WTGETCOOKIE name="PARAM(Logon)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Password)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTGETCOOKIE name="PARAM(LogonMerchant)" value="CONST(LGN2)"/>
				<WTGETCOOKIE name="PARAM(PasswordMerchant)" value="CONST(PWD2)"/>
				<WTSETATTRIBUTE name="PARAM(RememberMerchant)" value="CONST(1)">
					<WTCONDITION expr="PARAM(LogonMerchant)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTGETCOOKIE name="PARAM(LogonConsumer)" value="CONST(LGN3)"/>
				<WTGETCOOKIE name="PARAM(PasswordConsumer)" value="CONST(PWD3)"/>
				<WTSETATTRIBUTE name="PARAM(RememberConsumer)" value="CONST(1)">
					<WTCONDITION expr="PARAM(LogonConsumer)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<!-- Affiliate Logon -->	
			<WTACTION id="1" name="Logon" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="PARAM(Logon)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="PARAM(Password)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="0101" >
						<WTPARAM name="Lgn" value="PARAM(Logon)"/>
						<WTPARAM name="Pwd" value="PARAM(Password)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!-- Merchant Logon -->
			<WTACTION id="2" name="LogonMerchant" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberMerchant)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN2)" value="PARAM(LogonMerchant)"/>
					<WTSETCOOKIE name="CONST(PWD2)" value="PARAM(PasswordMerchant)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberMerchant)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN2)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD2)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>

				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Logon">
						<WTPARAM name="Email" direction="input" value="PARAM(LogonMerchant)"/>
						<WTPARAM name="Password" direction="input" value="PARAM(PasswordMerchant)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
						<WTERROR number="10129" message="Oops, The Email Address could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
						<WTERROR number="10135" message="Oops, The Account Number could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000004)"/>
						<WTERROR number="10130" message="Oops, Your Password is incorrect."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MerchantID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
            <WTSETATTRIBUTE name="CONST(IsDemo)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(IsDemo)" value="CONST(1)">
              <WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MERCHANT-STATUS-DEMO)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="CONST(IsOrg)" value="ATTR(IsOrg)"/>
            <WTSETATTRIBUTE name="CONST(StaffAccess)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(StaffAccess)" value="CONST(1)">
              <WTCONDITION expr="PARAM(PasswordMerchant)" oper="equal" value="ATTR(Password2)"/>
            </WTSETATTRIBUTE>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsDemo)" oper="equal" value="CONST(0)"/>
              <WTCONDITION expr="ATTR(Access)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
              <WTCALLSUB name="tmpAccess = LimitedAccess( .Access )"/>
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(tmpAccess)" oper="not-equal" value="CONST(1)"/>
                <WTERROR number="-2147220514" message="Oops, Your access to the system has been limited - Access Denied."/>
              </WTCODEGROUP>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="NoErrors"/>
  						<WTSETCACHE name="MERCHANT" value="CONST(Result)"/>
              <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey)"/>
  						<WTSETCACHE name="MERCHACCT" value="CONST(1)"/>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(PasswordMerchant)" oper="equal" value="ATTR(Password3)"/>
    						<WTSETCACHE name="MERCHACCT" value="CONST(3)"/>
                <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey3)"/>
              </WTCODEGROUP>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(PasswordMerchant)" oper="equal" value="ATTR(Password4)"/>
                <WTSETCACHE name="MERCHACCT" value="CONST(4)"/>
                <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey4)"/>
              </WTCODEGROUP>

              <!-- TEMPORARILY DISABLE 2FA FOR STAFF POS -->              
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(StaffAccess)" oper="not-equal" value="CONST(0)"/>
                <WTSETATTRIBUTE name="PARAM(UserKey)" value="CONST(&quot;&quot;)"/>
              </WTCODEGROUP>

              <WTSETATTRIBUTE name="PARAM(UserAction)" value="CONST(reqActionCode)">
                <WTCONDITION expr="PARAM(UserKey)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(VisitDate)" value="SYS(Now)"/>
              <WTMETHOD name="Save">
							  <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						  </WTMETHOD>
            </WTCODEGROUP>            
          </WTCODEGROUP>
				</WTOBJECT>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsDemo)" oper="equal" value="CONST(0)"/>
            <WTCONDITION expr="PARAM(SecurityCode)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
            <!--VERIFY GOOGLE AUTHENTICATOR SECURITY CODE -->
            <WTCUSTOM>
              If Verify2FAUser( reqUserKey, reqSecurityCode ) Then
              reqUserKey = ""
              Else
              reqSecurityCode = ""
              DoError 10138, "", "Oops, Invalid Security Code"
              End If
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsDemo)" oper="not-equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(UserKey)" value="CONST(&quot;&quot;)"/>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(UserKey)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsOrg)" oper="equal" value="CONST(0)"/>
            <WTRETURN>
              <WTCONDITION expr="CONST(StaffAccess)" oper="equal" value="CONST(0)"/>
              <WTLINK name="15000" >
                <WTPARAM name="MerchantID" value="CONST(Result)"/>
              </WTLINK>
            </WTRETURN>
            <WTRETURN>
              <WTCONDITION expr="CONST(StaffAccess)" oper="not-equal" value="CONST(0)"/>
              <WTLINK name="15212" >
                <WTPARAM name="MerchantID" value="CONST(Result)"/>
                <WTPARAM name="Popup" value="CONST(2)"/>
              </WTLINK>
            </WTRETURN>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsOrg)" oper="not-equal" value="CONST(0)"/>
            <WTRETURN>
              <WTLINK name="15030" >
                <WTPARAM name="MerchantID" value="CONST(Result)"/>
              </WTLINK>
            </WTRETURN>
          </WTCODEGROUP>
        </WTCODEGROUP>
			</WTACTION>

			<!-- Consumer Logon -->
			<WTACTION id="3" name="LogonConsumer" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberConsumer)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN3)" value="PARAM(LogonConsumer)"/>
					<WTSETCOOKIE name="CONST(PWD3)" value="PARAM(PasswordConsumer)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberConsumer)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN3)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD3)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>

				<WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
					<WTMETHOD name="Logon">
						<WTPARAM name="Email" direction="input" value="PARAM(LogonConsumer)"/>
						<WTPARAM name="Password" direction="input" value="PARAM(PasswordConsumer)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
						<WTERROR number="10129" message="Oops, The Email Address could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
						<WTERROR number="10134" message="Oops, The Phone Number could not be found."/>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000004)"/>
            <WTERROR number="10130" message="Oops, Your Password is incorrect."/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000005)"/>
            <WTERROR number="10156" message="Oops, The Shopper Account is Inactive. Contact support@NexxusRewards.com"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETCACHE name="CONSUMER" value="CONST(Result)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="ConsumerID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
            <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey)"/>
            <WTSETATTRIBUTE name="ATTR(VisitDate)" value="SYS(Now)"/>
            <WTSETATTRIBUTE name="PARAM(UserAction)" value="CONST(reqActionCode)">
              <WTCONDITION expr="PARAM(UserKey)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(SecurityCode)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
          <!--VERIFY GOOGLE AUTHENTICATOR SECURITY CODE -->
          <WTCUSTOM>
            If Verify2FAUser( reqUserKey, reqSecurityCode ) Then
            reqUserKey = ""
            Else
            reqSecurityCode = ""
            DoError 10138, "", "Oops, Invalid Security Code"
            End If
          </WTCUSTOM>
        </WTCODEGROUP>

        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(UserKey)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTRETURN>
						<WTLINK name="15100" >
							<WTPARAM name="ConsumerID" value="CONST(Result)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

			<!-- Forgot Affiliate Password -->
			<WTACTION id="4" name="ForgotPassword" type="Update">
				<WTRETURN>
					<WTLINK name="0102"/>
				</WTRETURN>
			</WTACTION>

			<!-- Forgot Merchant Password -->
			<WTACTION id="5" name="ForgotPasswordMerchant" type="Update">
				<WTSETATTRIBUTE name="CONST(tmpMerchantID)" value="CONST(0)" />
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Logon2">
						<WTPARAM name="Email" direction="input" value="PARAM(LogonMerchant)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMerchantID)" value="CONST(Result)" >
						<WTCONDITION expr="CONST(Result)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
						<WTERROR number="10129" message="Oops, The Email could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
						<WTERROR number="10135" message="Oops, The Account Number could not be found."/>
					</WTCODEGROUP>
				</WTOBJECT>
        <WTCALLSUB name="SendPassword tmpMerchantID, 0">
          <WTCONDITION expr="CONST(tmpMerchantID)" oper="not-equal" value="CONST(0)"/>
        </WTCALLSUB>
			</WTACTION>

			<!-- Forgot Consumer Password -->
			<WTACTION id="6" name="ForgotPasswordConsumer" type="Update">
				<WTSETATTRIBUTE name="CONST(tmpConsumerID)" value="CONST(0)" />
				<WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
					<WTMETHOD name="Logon2">
						<WTPARAM name="Email" direction="input" value="PARAM(LogonConsumer)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpConsumerID)" value="CONST(Result)" >
						<WTCONDITION expr="CONST(Result)" oper="greater" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
						<WTERROR number="10129" message="Oops, The Email could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
						<WTERROR number="10135" message="Oops, The Phone Number could not be found."/>
					</WTCODEGROUP>
				</WTOBJECT>
        <WTCALLSUB name="SendPassword 0, tmpConsumerID">
          <WTCONDITION expr="CONST(tmpConsumerID)" oper="not-equal" value="CONST(0)"/>
        </WTCALLSUB>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="center"/>
				<WTCOLUMN width="450" align="left"/>

				<!-- Convert input to digits only if no @ sign for an email -->
				<WTFUNCTION name="DigitsOnly(obj)">
					var val = obj.value;
					if(val.indexOf('@') === -1)
					{
						obj.value = val.replace(/\D/g,'');
					}
				</WTFUNCTION>

        <WTROW>
          <WTHIDDEN  value="PARAM(UserAction)"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTIMAGE col="1" merge="2" value="CONST(NexxusRewards.png)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;" align="center"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(UserKey)" oper="equal" value="CONST('')"/>
          <WTROW margin-top="24">
            <WTIMAGE col="1" value="CONST(LogonConsumer.png)" align="right"/>
            <WTTABLE col="2" valign="top" padding="0" style="border:1px solid; border-radius:10px; border-color:#cccccc; padding:10px; BACKGROUND-COLOR: #d1fa99">
              <WTCOLUMN width="150" align="right"/>
              <WTCOLUMN width="250" align="left"/>
              <WTROW>
                <WTSTATIC col="1" merge="2" label="aConsumer" align="center" fontsize="4"/>
              </WTROW>
              <WTROW margin-top="12" margin-bottom="6">
                <WTSTATIC col="1" tag="EmailPhone" align="right"/>
                <WTTEXT col="2"  value="PARAM(LogonConsumer)" align="left" size="20">
                  <WTEXIT>DigitsOnly(this);</WTEXIT>
                </WTTEXT>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" tag="Password" align="right"/>
                <WTTEXT col="2" value="PARAM(PasswordConsumer)" align="left" size="20" required="false" secure="true"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTCHECK col="2" value="PARAM(RememberConsumer)" label="Remember" align="left"/>
              </WTROW>
              <WTROW margin-top="12" margin-bottom="12">
                <WTBUTTON col="1" merge="2" action="3" value="CONST(LogonConsumer)" align="center"/>
                <WTBUTTON col="1" merge="2" action="6" value="CONST(ForgotPassword)" align="center" msg="msgForgotPassword" btnclass="smbutton"/>
              </WTROW>
            </WTTABLE>
          </WTROW>

          <WTROW margin-top="24">
            <WTIMAGE col="1" value="CONST(mobile.png)" align="right">
              <WTLINK name="m_15005" return="false"/>
            </WTIMAGE>
            <WTIMAGE col="1" value="CONST(LogonMerchant.png)" align="right"/>
            <WTTABLE col="2" valign="top" padding="0" style="border:1px solid; border-radius:10px; border-color:#cccccc; padding:10px; BACKGROUND-COLOR: #d1fa99">
              <WTCOLUMN width="150" align="right"/>
              <WTCOLUMN width="250" align="left"/>
              <WTROW margin-top="12">
                <WTSTATIC col="1" merge="2" label="aMerchant" align="center" fontsize="4"/>
              </WTROW>
              <WTROW margin-top="12" margin-bottom="6">
                <WTSTATIC col="1" tag="EmailMerchant" align="right"/>
                <WTTEXT col="2"  value="PARAM(LogonMerchant)" align="left" size="20">
                  <WTEXIT>DigitsOnly(this);</WTEXIT>
                </WTTEXT>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" tag="Password" align="right"/>
                <WTTEXT col="2" value="PARAM(PasswordMerchant)" align="left" size="20" required="false" secure="true"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTCHECK col="2" value="PARAM(RememberMerchant)" label="Remember" align="left"/>
              </WTROW>
              <WTROW margin-top="12" margin-bottom="12">
                <WTBUTTON col="1" merge="2" action="2" value="CONST(LogonMerchant)" align="center"/>
                <WTBUTTON col="1" merge="2" action="5" value="CONST(ForgotPassword)" align="center" msg="msgForgotPassword" btnclass="smbutton"/>
              </WTROW>
            </WTTABLE>
          </WTROW>

          <WTROW margin-top="24" margin-bottom="24">
            <WTIMAGE col="1" value="CONST(LogonAffiliate.png)" align="right"/>
            <WTTABLE col="2" valign="top" padding="0" style="border:1px solid; border-radius:10px; border-color:#cccccc; padding:10px; BACKGROUND-COLOR: #d1fa99">
              <WTCOLUMN width="150" align="right"/>
              <WTCOLUMN width="250" align="left"/>
              <WTROW margin-top="12">
                <WTSTATIC col="1" merge="2" label="aAffiliate" align="center" fontsize="4"/>
              </WTROW>
              <WTROW margin-top="12" margin-bottom="6">
                <WTSTATIC col="1" tag="Logon" align="right"/>
                <WTTEXT col="2"  value="PARAM(Logon)" align="left" size="20"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1" tag="Password" align="right"/>
                <WTTEXT col="2" value="PARAM(Password)" align="left" size="20" required="false" secure="true"/>
              </WTROW>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTCHECK col="2" value="PARAM(Remember)" label="Remember" align="left"/>
              </WTROW>
              <WTROW margin-top="12" margin-bottom="12">
                <WTBUTTON col="1" merge="2" action="1" value="CONST(LogonAffiliate)" align="center"/>
<!--                <WTBUTTON col="1" merge="2" action="4" value="CONST(ForgotPassword)" align="center" msg="msgForgotPassword" btnclass="smbutton"/>-->
              </WTROW>
            </WTTABLE>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(UserKey)" oper="not-equal" value="CONST('')"/>
          <WTROW>
            <WTHIDDEN  value="PARAM(LogonConsumer)"/>
            <WTHIDDEN  value="PARAM(PasswordConsumer)"/>
            <WTHIDDEN  value="PARAM(RememberConsumer)"/>
            <WTHIDDEN  value="PARAM(LogonMerchant)"/>
            <WTHIDDEN  value="PARAM(PasswordMerchant)"/>
            <WTHIDDEN  value="PARAM(RememberMerchant)"/>
            <WTHIDDEN  value="PARAM(Logon)"/>
            <WTHIDDEN  value="PARAM(Password)"/>
            <WTHIDDEN  value="PARAM(Remember)"/>
          </WTROW>
          <WTROW margin-top="24">
            <WTSTATIC col="1" merge="2" tag="SecurityCode" align="center" fontsize="4"/>
            <WTTEXT col="1" value="PARAM(SecurityCode)" size="10"/>
          </WTROW>
          <WTROW margin-top="12" margin-bottom="24">
            <WTBUTTON col="1" merge="2" action="0" value="CONST(SignIn)" align="center"/>
          </WTROW>
        </WTCODEGROUP>

        <WTROW>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
        <WTROW margin-bottom="24">
          <WTSTATIC col="1" merge="2" align="right">
            <WTCODEGROUP>
              <WTTRANSLATE/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

      </WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_15005" caption="Nexxus Rewards" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="wrapperMobile"
			page-image="bg.jpg" page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" checksecurity="false" langfile="m_15005">
			<!--=============================================================================================-->
			<WTPARAM name="C" datatype="number"/>			<!-- CompanyID -->
			<WTPARAM name="Logon" datatype="text"/>
			<WTPARAM name="Password" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="LogonMerchant" datatype="text"/>
			<WTPARAM name="PasswordMerchant" datatype="text"/>
			<WTPARAM name="RememberMerchant" datatype="number"/>
			<WTPARAM name="LogonConsumer" datatype="text"/>
			<WTPARAM name="PasswordConsumer" datatype="text"/>
			<WTPARAM name="RememberConsumer" datatype="number"/>
      <WTPARAM name="UserKey" datatype="text"/>
      <WTPARAM name="SecurityCode" datatype="text"/>
      <WTPARAM name="UserAction" datatype="number"/>

			<WTINCLUDE name="Company.asp"/>
      <WTINCLUDE name="Google2FA.asp"/>
      <WTINCLUDE name="LimitedAccess.asp"/>
      <WTINCLUDE name="Comm.asp"/>

      <WTSETATTRIBUTE name="PARAM(C)" value="SYSCON(NEXXUS)">
				<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
      <WTSETATTRIBUTE name="CONST(reqActionCode)" value="PARAM(UserAction)">
        <WTCONDITION expr="PARAM(UserAction)" oper="not-equal" value="CONST(0)"/>
      </WTSETATTRIBUTE>

			<!-- Logon = Affiliate -->
			<!-- LogonMerchant = Merchant -->
			<!-- LogonConsumer = Consumer -->

      <WTSUB function="SendPassword( bvMerchantID, bvConsumerID )">
        <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
          <WTMETHOD name="Load">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Forgot Nexxus Rewards Password&quot;)"/>
        </WTOBJECT>
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTCONDITION expr="CONST(bvMerchantID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MerchantID" direction="input" value="CONST(bvMerchantID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Merchant.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(&quot;Merchant: &quot; + .MerchantName + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Merchant #: &quot; + CStr(.MerchantID) + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Email: &quot; + .Email + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Admin Password: &quot; + .Password + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Staff Password: &quot; + .Password2 )"/>
        </WTOBJECT>
        <WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
          <WTCONDITION expr="CONST(bvConsumerID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="ConsumerID" direction="input" value="CONST(bvConsumerID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Consumer.Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(&quot;Shopper: &quot; + .NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Phone: &quot; + .Phone + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Email: &quot; + .Email + &quot;&lt;BR&gt;&quot; )"/>
          <WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpBody + &quot;Password: &quot; + .Password )"/>
        </WTOBJECT>
        <WTCUSTOM>
          If InStr(tmpTo, "@") &gt; 0 Then
          If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
          SendEmail reqC, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
          End If
        </WTCUSTOM>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="GetCompany(reqC)"/>
				<WTGETCOOKIE name="PARAM(Logon)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Password)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTGETCOOKIE name="PARAM(LogonMerchant)" value="CONST(LGN2)"/>
				<WTGETCOOKIE name="PARAM(PasswordMerchant)" value="CONST(PWD2)"/>
				<WTSETATTRIBUTE name="PARAM(RememberMerchant)" value="CONST(1)">
					<WTCONDITION expr="PARAM(LogonMerchant)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTGETCOOKIE name="PARAM(LogonConsumer)" value="CONST(LGN3)"/>
				<WTGETCOOKIE name="PARAM(PasswordConsumer)" value="CONST(PWD3)"/>
				<WTSETATTRIBUTE name="PARAM(RememberConsumer)" value="CONST(1)">
					<WTCONDITION expr="PARAM(LogonConsumer)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<!-- Affiliate Logon -->
			<WTACTION id="1" name="Logon" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="PARAM(Logon)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="PARAM(Password)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Remember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="m_0101" >
						<WTPARAM name="Lgn" value="PARAM(Logon)"/>
            <WTPARAM name="Pwd" value="PARAM(Password)"/>
            <WTPARAM name="Page" value="CONST(&quot;m_MemberHome.asp&quot;)"/>
          </WTLINK>
				</WTRETURN>
			</WTACTION>

			<!-- Merchant Logon -->
			<WTACTION id="2" name="LogonMerchant" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberMerchant)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN2)" value="PARAM(LogonMerchant)"/>
					<WTSETCOOKIE name="CONST(PWD2)" value="PARAM(PasswordMerchant)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberMerchant)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN2)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD2)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>

				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Logon">
						<WTPARAM name="Email" direction="input" value="PARAM(LogonMerchant)"/>
						<WTPARAM name="Password" direction="input" value="PARAM(PasswordMerchant)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
						<WTERROR number="10129" message="Oops, The Email Address could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
						<WTERROR number="10135" message="Oops, The Account Number could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000004)"/>
						<WTERROR number="10130" message="Oops, Your Password is incorrect."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETCACHE name="MERCHANT" value="CONST(Result)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MerchantID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
            <WTSETATTRIBUTE name="CONST(IsOrg)" value="ATTR(IsOrg)"/>
            <WTSETATTRIBUTE name="CONST(IsDemo)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(IsDemo)" value="CONST(1)">
              <WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MERCHANT-STATUS-DEMO)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="CONST(StaffAccess)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(StaffAccess)" value="CONST(1)">
              <WTCONDITION expr="PARAM(PasswordMerchant)" oper="equal" value="ATTR(Password2)"/>
            </WTSETATTRIBUTE>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(IsDemo)" oper="equal" value="CONST(0)"/>
              <WTCONDITION expr="ATTR(Access)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
              <WTCALLSUB name="tmpAccess = LimitedAccess( .Access )"/>
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(tmpAccess)" oper="not-equal" value="CONST(1)"/>
                <WTERROR number="-2147220514" message="Oops, Your access to the system has been limited - Access Denied."/>
              </WTCODEGROUP>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="NoErrors"/>
  						<WTSETCACHE name="MERCHANT" value="CONST(Result)"/>
              <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey)"/>
  						<WTSETCACHE name="MERCHAACT" value="CONST(1)"/>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(PasswordMerchant)" oper="equal" value="ATTR(Password3)"/>
    						<WTSETCACHE name="MERCHACCT" value="CONST(3)"/>
                <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey3)"/>
              </WTCODEGROUP>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(PasswordMerchant)" oper="equal" value="ATTR(Password4)"/>
    						<WTSETCACHE name="MERCHACCT" value="CONST(4)"/>
                <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey4)"/>
              </WTCODEGROUP>

              <!-- TEMPORARILY DISABLE 2FA FOR STAFF POS -->
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(StaffAccess)" oper="not-equal" value="CONST(0)"/>
                <WTSETATTRIBUTE name="PARAM(UserKey)" value="CONST(&quot;&quot;)"/>
              </WTCODEGROUP>

              <WTSETATTRIBUTE name="PARAM(UserAction)" value="CONST(reqActionCode)">
                <WTCONDITION expr="PARAM(UserKey)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="ATTR(VisitDate)" value="SYS(Now)"/>
              <WTMETHOD name="Save">
							  <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						  </WTMETHOD>
            </WTCODEGROUP>            
          </WTCODEGROUP>
				</WTOBJECT>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsDemo)" oper="equal" value="CONST(0)"/>
            <WTCONDITION expr="PARAM(SecurityCode)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
            <!--VERIFY GOOGLE AUTHENTICATOR SECURITY CODE -->
            <WTCUSTOM>
              If Verify2FAUser( reqUserKey, reqSecurityCode ) Then
              reqUserKey = ""
              Else
              reqSecurityCode = ""
              DoError 10138, "", "Oops, Invalid Security Code"
              End If
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsDemo)" oper="not-equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(UserKey)" value="CONST(&quot;&quot;)"/>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(UserKey)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsOrg)" oper="equal" value="CONST(0)"/>
            <WTRETURN>
              <WTCONDITION expr="CONST(StaffAccess)" oper="equal" value="CONST(0)"/>
              <WTLINK name="15000" >
                <WTPARAM name="MerchantID" value="CONST(Result)"/>
              </WTLINK>
            </WTRETURN>
            <WTRETURN>
              <WTCONDITION expr="CONST(StaffAccess)" oper="not-equal" value="CONST(0)"/>
              <WTLINK name="m_15212" >
                <WTPARAM name="MerchantID" value="CONST(Result)"/>
                <WTPARAM name="Popup" value="CONST(2)"/>
              </WTLINK>
            </WTRETURN>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsOrg)" oper="not-equal" value="CONST(0)"/>
            <WTRETURN>
              <WTLINK name="15030" >
                <WTPARAM name="MerchantID" value="CONST(Result)"/>
              </WTLINK>
            </WTRETURN>
          </WTCODEGROUP>
        </WTCODEGROUP>
			</WTACTION>

			<!-- Consumer Logon -->
			<WTACTION id="3" name="LogonConsumer" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberConsumer)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN3)" value="PARAM(LogonConsumer)"/>
					<WTSETCOOKIE name="CONST(PWD3)" value="PARAM(PasswordConsumer)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RememberConsumer)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN3)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD3)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>

				<WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
					<WTMETHOD name="Logon">
						<WTPARAM name="Email" direction="input" value="PARAM(LogonConsumer)"/>
						<WTPARAM name="Password" direction="input" value="PARAM(PasswordConsumer)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
						<WTERROR number="10129" message="Oops, The Email Address could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
						<WTERROR number="10134" message="Oops, The Phone Number could not be found."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000004)"/>
						<WTERROR number="10130" message="Oops, Your Password is incorrect."/>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000005)"/>
            <WTERROR number="10156" message="Oops, The Shopper Account is Inactive. Contact support@NexxusRewards.com"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETCACHE name="CONSUMER" value="CONST(Result)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="ConsumerID" direction="input" value="CONST(Result)"/>
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
            <WTSETATTRIBUTE name="PARAM(UserKey)" value="ATTR(UserKey)"/>
            <WTSETATTRIBUTE name="ATTR(VisitDate)" value="SYS(Now)"/>
            <WTSETATTRIBUTE name="PARAM(UserAction)" value="CONST(reqActionCode)">
              <WTCONDITION expr="PARAM(UserKey)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
        
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(SecurityCode)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
          <!--VERIFY GOOGLE AUTHENTICATOR SECURITY CODE -->
          <WTCUSTOM>
            If Verify2FAUser( reqUserKey, reqSecurityCode ) Then
            reqUserKey = ""
            Else
            reqSecurityCode = ""
            DoError 10138, "", "Oops, Invalid Security Code"
            End If
          </WTCUSTOM>
        </WTCODEGROUP>
        
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(UserKey)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTRETURN>
						<WTLINK name="m_15100" >
							<WTPARAM name="ConsumerID" value="CONST(Result)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

			<!-- Forgot Affiliate Password -->
			<WTACTION id="4" name="ForgotPassword" type="Update">
				<WTRETURN>
					<WTLINK name="0102"/>
				</WTRETURN>
			</WTACTION>

      <!-- Forgot Merchant Password -->
      <WTACTION id="5" name="ForgotPasswordMerchant" type="Update">
        <WTSETATTRIBUTE name="CONST(tmpMerchantID)" value="CONST(0)" />
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTMETHOD name="Logon2">
            <WTPARAM name="Email" direction="input" value="PARAM(LogonMerchant)"/>
            <WTPARAM name="Result" direction="return" datatype="number"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpMerchantID)" value="CONST(Result)" >
            <WTCONDITION expr="CONST(Result)" oper="greater" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
            <WTERROR number="10129" message="Oops, The Email could not be found."/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
            <WTERROR number="10135" message="Oops, The Account Number could not be found."/>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTCALLSUB name="SendPassword tmpMerchantID, 0">
          <WTCONDITION expr="CONST(tmpMerchantID)" oper="not-equal" value="CONST(0)"/>
        </WTCALLSUB>
      </WTACTION>

      <!-- Forgot Consumer Password -->
      <WTACTION id="6" name="ForgotPasswordConsumer" type="Update">
        <WTSETATTRIBUTE name="CONST(tmpConsumerID)" value="CONST(0)" />
        <WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
          <WTMETHOD name="Logon2">
            <WTPARAM name="Email" direction="input" value="PARAM(LogonConsumer)"/>
            <WTPARAM name="Result" direction="return" datatype="number"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpConsumerID)" value="CONST(Result)" >
            <WTCONDITION expr="CONST(Result)" oper="greater" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000002)"/>
            <WTERROR number="10129" message="Oops, The Email could not be found."/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(-1000003)"/>
            <WTERROR number="10135" message="Oops, The Phone Number could not be found."/>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTCALLSUB name="SendPassword 0, tmpConsumerID">
          <WTCONDITION expr="CONST(tmpConsumerID)" oper="not-equal" value="CONST(0)"/>
        </WTCALLSUB>
      </WTACTION>

      <!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>

				<!-- Convert input to digits only if no @ sign for an email -->
				<WTFUNCTION name="DigitsOnly(obj)">
					var val = obj.value;
					if(val.indexOf('@') === -1)
					{
					obj.value = val.replace(/\D/g,'');
					}
				</WTFUNCTION>

        <WTROW>
          <WTHIDDEN  value="PARAM(UserAction)"/>
        </WTROW>

        <WTROW margin-top="6">
          <WTIMAGE col="1" value="CONST(NexxusRewardsMobile.png)" path="Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;"/>
				</WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(UserKey)" oper="equal" value="CONST('')"/>
				  <WTROW margin-top="6">
					  <WTTABLE col="1" valign="top" padding="0" style="border:1px solid; border-radius:10px; border-color:#cccccc; padding:10px; BACKGROUND-COLOR: #d1fa99">
						  <WTCOLUMN width="90" align="center"/>
						  <WTROW>
							  <WTIMAGE col="1" value="CONST(LogonConsumer.png)" imgwidth="50"/>
						  </WTROW>
						  <WTROW>
							  <WTSTATIC col="1" label="aConsumer" fontsize="5"/>
						  </WTROW>
						  <WTROW margin-top="12" margin-bottom="3">
							  <WTSTATIC col="1" label="EmailPhone" fontsize="4"/>
						  </WTROW>
						  <WTROW margin-bottom="6">
							  <WTTEXT col="1" value="PARAM(LogonConsumer)" size="15" textclass="bigtext">
								  <WTEXIT>DigitsOnly(this);</WTEXIT>
							  </WTTEXT>
						  </WTROW>
						  <WTROW margin-bottom="3">
							  <WTSTATIC col="1" label="Password" fontsize="4"/>
						  </WTROW>
						  <WTROW>
							  <WTTEXT col="1" value="PARAM(PasswordConsumer)" size="15" required="false" secure="true" textclass="bigtext"/>
						  </WTROW>
						  <WTROW>
							  <WTCHECK col="1" value="PARAM(RememberConsumer)" label="Remember"/>
						  </WTROW>
						  <WTROW margin-top="12" margin-bottom="12">
							  <WTBUTTON col="1" action="3" value="CONST(LogonConsumer)" align="center" btnclass="bigbutton"/>
						  </WTROW>
						  <WTROW margin-bottom="6">
							  <WTBUTTON col="1" action="6" value="CONST(ForgotPassword)" align="center" msg="msgForgotPassword"/>
						  </WTROW>
					  </WTTABLE>
				  </WTROW>

				  <WTROW margin-top="12">
					  <WTTABLE col="1" valign="top" padding="0" style="border:1px solid; border-radius:10px; border-color:#cccccc; padding:10px; BACKGROUND-COLOR: #d1fa99">
						  <WTCOLUMN width="90" align="center"/>
						  <WTROW>
							  <WTIMAGE col="1"  value="CONST(LogonMerchant.png)" imgwidth="50"/>
						  </WTROW>
						  <WTROW>
							  <WTSTATIC col="1" label="aMerchant" fontsize="5"/>
						  </WTROW>
						  <WTROW margin-top="12" margin-bottom="3">
							  <WTSTATIC col="1" label="EmailMerchant" fontsize="4"/>
						  </WTROW>
						  <WTROW margin-bottom="6">
							  <WTTEXT col="1" value="PARAM(LogonMerchant)" size="15" textclass="bigtext">
								  <WTEXIT>DigitsOnly(this);</WTEXIT>
							  </WTTEXT>
						  </WTROW>
						  <WTROW margin-bottom="3">
							  <WTSTATIC col="1" label="Password" fontsize="4"/>
						  </WTROW>
						  <WTROW>
							  <WTTEXT col="1" value="PARAM(PasswordMerchant)" size="15" required="false" secure="true" textclass="bigtext"/>
						  </WTROW>
						  <WTROW>
							  <WTCHECK col="1" value="PARAM(RememberMerchant)" label="Remember"/>
						  </WTROW>
						  <WTROW margin-top="12" margin-bottom="12">
							  <WTBUTTON col="1" action="2" value="CONST(LogonMerchant)" align="center" btnclass="bigbutton"/>
						  </WTROW>
						  <WTROW margin-bottom="6">
							  <WTBUTTON col="1" action="5" value="CONST(ForgotPassword)" align="center" msg="msgForgotPassword"/>
						  </WTROW>
					  </WTTABLE>
				  </WTROW>

				  <WTROW margin-top="12" margin-bottom="12">
					  <WTTABLE col="1" valign="top" padding="0" style="border:1px solid; border-radius:10px; border-color:#cccccc; padding:10px; BACKGROUND-COLOR: #d1fa99">
						  <WTCOLUMN width="90" align="center"/>
						  <WTROW>
							  <WTIMAGE col="1"  value="CONST(LogonAffiliate.png)" imgwidth="50"/>
						  </WTROW>
						  <WTROW margin-top="12">
							  <WTSTATIC col="1" label="aAffiliate" align="center" fontsize="5"/>
						  </WTROW>

						  <WTROW margin-top="12" margin-bottom="3">
							  <WTSTATIC col="1" label="Logon" fontsize="4"/>
						  </WTROW>
						  <WTROW margin-bottom="6">
							  <WTTEXT col="1" value="PARAM(Logon)" size="15" textclass="bigtext"/>
						  </WTROW>
						  <WTROW margin-bottom="3">
							  <WTSTATIC col="1" label="Password" fontsize="4"/>
						  </WTROW>
						  <WTROW>
							  <WTTEXT col="1" value="PARAM(Password)" size="15" required="false" secure="true" textclass="bigtext"/>
						  </WTROW>
						  <WTROW>
							  <WTCHECK col="1" value="PARAM(Remember)" label="Remember"/>
						  </WTROW>

						  <WTROW margin-top="12" margin-bottom="12">
							  <WTBUTTON col="1" action="1" value="CONST(LogonAffiliate)" align="center" btnclass="bigbutton"/>
						  </WTROW>
<!--              
						  <WTROW margin-bottom="6">
							  <WTBUTTON col="1" action="4" value="CONST(ForgotPassword)" align="center" msg="msgForgotPassword"/>
						  </WTROW>
-->              
					  </WTTABLE>
				  </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(UserKey)" oper="not-equal" value="CONST('')"/>
          <WTROW>
            <WTHIDDEN  value="PARAM(LogonConsumer)"/>
            <WTHIDDEN  value="PARAM(PasswordConsumer)"/>
            <WTHIDDEN  value="PARAM(RememberConsumer)"/>
            <WTHIDDEN  value="PARAM(LogonMerchant)"/>
            <WTHIDDEN  value="PARAM(PasswordMerchant)"/>
            <WTHIDDEN  value="PARAM(RememberMerchant)"/>
            <WTHIDDEN  value="PARAM(Logon)"/>
            <WTHIDDEN  value="PARAM(Password)"/>
            <WTHIDDEN  value="PARAM(Remember)"/>
          </WTROW>
					<WTROW margin-top="12" margin-bottom="3">
						<WTSTATIC col="1" label="SecurityCode" fontsize="4"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTTEXT col="1" value="PARAM(SecurityCode)" size="10" textclass="bigtext"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" action="0" value="CONST(SignIn)" align="center" btnclass="bigbutton"/>
					</WTROW>
        </WTCODEGROUP>
          
        <WTROW>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" align="right">
            <WTCODEGROUP>
              <WTTRANSLATE/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

      </WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="15000" caption="Nexxus Merchant" header="false" navbar="false" footer="false" wrapper="wrapper1000"
			page-color="#777777" margin-width="0" navbar-width="0" content-width="1000"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="15000" track="0">
			<!--=============================================================================================-->
			<WTPARAM name="MerchantID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Header" datatype="text"/>
			<WTPARAM name="MenuBehindColor" datatype="text"/>
			<WTPARAM name="MenuBehindImage" datatype="text"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="PageImage" datatype="text"/>
			<WTPARAM name="M" datatype="number"/>
      <WTPARAM name="MenuLogo" datatype="text"/>
      <WTPARAM name="User2FA" datatype="number"/>
      <WTPARAM name="IsDemo" datatype="number"/>

      <WTPARAM name="HeaderPosition" datatype="number"/>
			<WTPARAM name="HeaderAlign" datatype="number"/>
			<WTPARAM name="MenuAlign" datatype="number"/>
			<WTPARAM name="MenuBackground" datatype="number"/>

<!--			<WTINCLUDE name="CompanyHeader.asp"/>-->
			<WTINCLUDE name="Portal.asp"/>
			<WTINCLUDE name="MenuColors.asp"/>
      <WTINCLUDE name="2FA.asp"/>

      <!-- Security Checks -->
      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
        <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(Is2FAMerchant(reqMerchantID))"/>
        <WTGETCACHE name="CONST(SysMerchantID)" value="MERCHANT" datatype="number"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MerchantID)" oper="not-equal" value="CONST(SysMerchantID)"/>
          <WTSETCACHE name="MERCHANT" value="CONST(&quot;&quot;)"/>
          <WTRETURN><WTLINK name="15005" return="false"/></WTRETURN>
        </WTCODEGROUP>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsEmployee"/>
				<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
        <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(1)"/>
      </WTCODEGROUP>
      
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MerchantID)">
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
<!--				<WTCALLSUB name="reqHeader = GetCompanyHeader( reqCompanyID, &quot;en&quot; )"/>-->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTSETATTRIBUTE name="PARAM(MenuLogo)" value="CONST(&quot;MenuLogo2.png&quot;)"/>
        </WTCODEGROUP>
      </WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(IsDemo)" value="CONST(1)">
            <WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MERCHANT-STATUS-DEMO)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(1)">
            <WTCONDITION expr="ATTR(Status)" oper="less" value="CONST(3)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="PARAM(Title)" value="CONST(CleanXML(.NameFirst + &quot; &quot; + .NameLast))"/>
          <WTSETCACHE name="MERCHANTSEARCH" value="ATTR(City)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCALLSUB name="GetPortal reqCompanyID, GroupID, reqHeaderPosition, reqHeaderAlign, reqMenuAlign, reqMenuBackground"/>
				<WTCALLSUB name="GetMenuColors reqCompanyID, GroupID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left" />

				<WTFUNCTION name="ShowTab(tab, shw)">
          var mid = document.getElementById('MerchantID').value;
          var cid = document.getElementById('CompanyID').value;
          var isdemo = document.getElementById('IsDemo').value;
          var frame, url, frm, src, page, target='', style='', compare=0, load=0, msg=0;

          switch(tab) {
          case 'TabDashboard':
          frame = 'DashboardFrame';
          switch(shw) {
          case 1: url = '15010.asp?merchantid=' + mid + "&amp;companyid=" + cid; load=1; break;
          case 2: url = 'm_15212.asp?merchantid=' + mid; target='Mobile'; style='top=100,left=100,height=492,width=322,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no'; break;
          } break;
          case 'TabSales':
          frame = 'SalesFrame';
          switch(shw) {
          case 1: url = '16501.asp?merchantid=' + mid; target="Orders"; break;
          case 2: url = '15201.asp?merchantid=' + mid; break;
          case 3: url = '15401.asp?merchantid=' + mid; break;
          case 4: url = '15101.asp?merchantid=' + mid; target="Shopper"; break;
          case 5: url = '15013.asp'; target='MerchantSearch'; break;
          case 6: url = '16301.asp?merchantid=' + mid; target="Statements"; break;
          case 7: url = '0922.asp?merchantid=' + mid; target="Bonuses"; break;
          case 8: url = 'xxxxx.asp?merchantid=' + mid; msg=1; break;
          } break;
          case 'TabSetup':
          frame = 'SetupFrame';
          switch(shw) {
          case 1: url = '15311.asp?merchantid=' + mid + "&amp;awardtype=1"; target='Awards'; style='top=100,left=200,height=350,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1'; break;
          case 2: url = '15311.asp?merchantid=' + mid + "&amp;awardtype=2"; target='Awards'; style='top=100,left=200,height=350,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1'; break;
          case 3: url = '16211.asp?merchantid=' + mid; target='Staff'; break;
          case 4: url = '16411.asp?merchantid=' + mid; target='Coins'; break;
          case 5: url = '15004.asp?merchantid=' + mid; target='StoreSetup'; break;
          } break;
          case 'TabAccount':
          frame = 'AccountFrame';
          if(isdemo==1){msg=2};
          switch(shw) {
          case 1: url = '15003.asp?merchantid=' + mid; load=1; break;
          case 2: url = '15008.asp?merchantid=' + mid; break;
          case 3: url = '0108.asp?popup=1&amp;merchantid=' + mid; load=1; break;
          case 4: url = '0109.asp?merchantid=' + mid; target='AccessLimits'; load=1; break;
          } break;
          case 'TabHelp':
          frame = 'HelpFrame';
          switch(shw) {
          case 1: url = '1713.asp?contentpage=3&amp;popup=1&amp;companyid=' + cid; target="AdminGuide"; break;
          case 2: url = '9506.asp?contentpage=3&amp;popup=1&amp;companyid=' + cid; target="AdminTicket"; break;
          } break;
          }
          if(msg != 0) {
            if(msg == 1) { alert('Coming Soon...'); }
            if(msg == 2) { alert('Disabled in Demo!'); }
          }
          else {
          if( target.length &gt; 0 ) {
					win = window.open(url,target,style);
					win.focus();
					}
					else {
					if( tab == 'TabDashboard')
					document.getElementById('TopMargin').style.display = 'none';
					else
					document.getElementById('TopMargin').style.display = '';

					frm = document.getElementById(frame);
					src = frm.src;
					if( compare == 0 ) { compare = url.indexOf('.') }
					page = url.substring(0,compare);
					if (load == 1 &amp;&amp; src.indexOf(page) &gt;= 0 ) {frm.src = ''}
					if (load == 1 || src.indexOf(page) &lt; 0 ) {frm.src = url} else {ShowFrame(tab)}
					}
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowFrame(tab)">
          document.getElementById('TabDashboard').style.display = 'none';
          document.getElementById('TabSales').style.display = 'none';
          document.getElementById('TabSetup').style.display = 'none';
          document.getElementById('TabAccount').style.display = 'none';
          document.getElementById('TabHelp').style.display = 'none';
          document.getElementById(tab).style.display = '';
        </WTFUNCTION>

				<WTLOAD>
					ShowTab('TabDashboard',1);
				</WTLOAD>

				<WTMENU name="UserMenu" type="bar" menuwidth="125" height="30" top-color="CONST(MenuTopColor)" top-bgcolor="CONST(MenuTopBGColor)"
						color="CONST(MenuColor)" bgcolor="CONST(MenuBGColor)" shadow-color="CONST(MenuShadowColor)" bdcolor="CONST(MenuBDColor)"
						over-color="CONST(MenuOverColor)" over-bgcolor="CONST(MenuOverBGColor)" divider-color="CONST(MenuDividerColor)" top-bgimg="CONST(MenuTopImage)" bgimg="CONST(MenuImage)">

          <WTITEM label="mDashboard" width="75" menuwidth="175" height="30" menuheight="30">
            <WTIMAGE name="Home.gif" width="18" height="18"/>
            <WTLINK name="JAVA(ShowTab('TabDashboard',1))"/>
<!--
						<WTITEM value="PARAM(Title)"><WTIMAGE name="Home.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabDashboard',1))"/></WTITEM>
						<WTITEM label="mMobile">
              <WTCONDITION expr="IsEmployee"/>
              <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
              <WTIMAGE name="Mobile.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabDashboard',2))"/></WTITEM>
-->              
					</WTITEM>

          <WTITEM label="mSales" width="75" menuwidth="125" height="30" menuheight="30">
    				<WTCONDITION expr="IsUser2FA"/>
            <WTIMAGE name="Finance.gif" width="18" height="18"/>
            <WTITEM label="mPurchases" width="100" menuwidth="125"><WTIMAGE name="Finance.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',1))"/></WTITEM>
            <WTITEM label="mRewards" width="100" menuwidth="125"><WTIMAGE name="mNXC.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',2))"/></WTITEM>
            <WTITEM label="mPromotions" width="125" menuwidth="125"><WTIMAGE name="Promo.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',3))"/></WTITEM>
						<WTDIVIDER/>
            <WTITEM label="mConsumers" width="125" menuwidth="125"><WTIMAGE name="Prospect.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',4))"/></WTITEM>
            <WTITEM label="mSearch"><WTIMAGE name="Search.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',5))"/></WTITEM>
						<WTDIVIDER/>
            <WTITEM label="mStatements"><WTIMAGE name="Finance.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',6))"/></WTITEM>
            <WTITEM label="mBonuses"><WTIMAGE name="Finance.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',7))"/></WTITEM>
            <WTDIVIDER/>
            <WTITEM label="mReports"><WTIMAGE name="Report.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSales',8))"/></WTITEM>
          </WTITEM>
          <WTITEM label="mAccount" width="100" menuwidth="150" height="30" menuheight="30">
    				<WTCONDITION expr="IsUser2FA"/>
            <WTIMAGE name="MyInfo.gif" width="18" height="18"/>
            <WTITEM label="mProfile"><WTIMAGE name="Prospect.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabAccount',1))"/></WTITEM>
            <WTITEM label="mBilling"><WTIMAGE name="Finance.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabAccount',2))"/></WTITEM>
            <WTDIVIDER/>
            <WTITEM label="m2FA"><WTIMAGE name="logon.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabAccount',3))"/></WTITEM>
            <WTITEM label="mAccess"><WTIMAGE name="logon.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabAccount',4))"/></WTITEM>
          </WTITEM>
					<WTITEM label="mSetup" width="75" menuwidth="150" height="30" menuheight="30">
    				<WTCONDITION expr="IsUser2FA"/>
						<WTIMAGE name="Setup.gif" width="18" height="18"/>
            <WTITEM label="mCashBack"><WTIMAGE name="mNXC.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSetup',1))"/></WTITEM>
            <WTITEM label="mPoints"><WTIMAGE name="Contest.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSetup',2))"/></WTITEM>
						<WTDIVIDER/>
            <WTITEM label="mStaff"><WTIMAGE name="Prospect.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSetup',3))"/></WTITEM>
            <WTITEM label="mCoin"><WTIMAGE name="mCoin.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSetup',4))"/></WTITEM>
            <WTITEM label="mStore"><WTIMAGE name="ShoppingCart.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabSetup',5))"/></WTITEM>
					</WTITEM>
          <WTITEM label="mHelp" width="100" menuwidth="175" height="30" menuheight="30">
						<WTIMAGE name="Help.gif" width="18" height="18"/>
						<WTITEM label="mFAQ"><WTIMAGE name="Question.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabHelp',1))"/></WTITEM>
						<WTITEM label="mTickets"><WTIMAGE name="SupportTicket.gif" width="18" height="18"/><WTLINK name="JAVA(ShowTab('TabHelp',2))"/></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="mSignout"><WTIMAGE name="close.gif" width="18" height="18"/><WTLINK name="15005" nodata="true"/></WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW>
					<WTHIDDEN value="PARAM(MerchantID)"/>
          <WTHIDDEN value="PARAM(CompanyID)"/>
          <WTHIDDEN value="PARAM(IsDemo)"/>
        </WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(HeaderPosition)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" align="left" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(1)"/>
						<WTIMAGE col="1" align="center" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(2)"/>
						<WTIMAGE col="1" align="right" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MenuBackground)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="PARAM(MenuBehindColor)" />
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(0)"/>
						<WTSTATIC col="1" align="left" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
							<WTCODEGROUP>
								<WTSTARTMENU name="UserMenu" type="bar"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(1)"/>
						<WTSTATIC col="1" align="center" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
							<WTCODEGROUP>
								<WTSTARTMENU name="UserMenu" type="bar"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(2)"/>
						<WTSTATIC col="1" align="right" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(MenuLogo)" oper="not-equal" value="CONST('')"/>
                <WTDIVISION style="float:left; margin-left:20px;">
                  <WTIMAGE value="PARAM(MenuLogo)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
                    <WTLINK name="ShowTab('TabDashboard',1)" click="true" />
                  </WTIMAGE>
                </WTDIVISION>
                <WTDIVISION style="float:right">
                  <WTSTARTMENU name="UserMenu" type="bar"/>
                </WTDIVISION>
              </WTCODEGROUP>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(MenuLogo)" oper="equal" value="CONST('')"/>
                <WTSTARTMENU name="UserMenu" type="bar"/>
              </WTCODEGROUP>
            </WTSTATIC>
					</WTROW>
					<WTROW>
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="PARAM(MenuBehindColor)" />
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MenuBackground)" oper="not-equal" value="CONST(0)"/>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(0)"/>
						<WTSTATIC col="1" align="left" valign="top">
							<WTCODEGROUP>
								<WTSTARTMENU name="UserMenu" type="bar"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(1)"/>
						<WTSTATIC col="1" align="center" valign="top">
							<WTCODEGROUP>
								<WTSTARTMENU name="UserMenu" type="bar"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(2)"/>
						<WTSTATIC col="1" align="right" valign="top">
							<WTCODEGROUP>
								<WTSTARTMENU name="UserMenu" type="bar"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(HeaderPosition)" oper="equal" value="CONST(1)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" align="left" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(1)"/>
						<WTIMAGE col="1" align="center" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(2)"/>
						<WTIMAGE col="1" align="right" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW id="TopMargin" height="6"/>

				<!-- ======================================================================= -->
				<WTROW id="TabDashboard">
					<WTFRAME col="1" src="" name="DashboardFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabDashboard')" frmwidth="1000" frmheight="600" scrolling="no" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabSales">
					<WTFRAME col="1" src="" name="SalesFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabSales')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
        <!-- ======================================================================= -->
        <WTROW id="TabSetup">
          <WTFRAME col="1" src="" name="SetupFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabSetup')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->
        <WTROW id="TabAccount">
          <WTFRAME col="1" src="" name="AccountFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabAccount')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" src="" name="HelpFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabHelp')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

				<WTROW>
					<WTSTATIC col="1" align="right">
						<WTCODEGROUP>
							<WTTRANSLATE/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_15000" caption="Nexxus Rewards" page-left="0" page-top="0" navbar="false" header="false" footer="false"
			page-image="bg.jpg" page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="m_15000" mobile="m_15000.asp" track="0">
			<!--==================================================================-->
			<WTPARAM name="MerchantID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Header" datatype="text"/>
			<WTPARAM name="MenuBehindColor" datatype="text"/>
			<WTPARAM name="MenuBehindImage" datatype="text"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="PageImage" datatype="text"/>
      <WTPARAM name="User2FA" datatype="number"/>

			<WTPARAM name="HeaderPosition" datatype="number"/>
			<WTPARAM name="HeaderAlign" datatype="number"/>
			<WTPARAM name="MenuAlign" datatype="number"/>
			<WTPARAM name="MenuBackground" datatype="number"/>

			<WTINCLUDE name="CompanyHeader.asp"/>
			<WTINCLUDE name="Portal.asp"/>
			<WTINCLUDE name="MenuColors.asp"/>
      <WTINCLUDE name="2FA.asp"/>

      <!-- Security Checks -->
      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
        <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(Is2FAMerchant(reqMerchantID))"/>
        <WTGETCACHE name="CONST(SysMerchantID)" value="MERCHANT" datatype="number"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MerchantID)" oper="not-equal" value="CONST(SysMerchantID)"/>
          <WTSETCACHE name="MERCHANT" value="CONST(&quot;&quot;)"/>
          <WTRETURN><WTLINK name="15005" return="false"/></WTRETURN>
        </WTCODEGROUP>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsEmployee"/>
        <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
        <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(1)"/>
      </WTCODEGROUP>

      <WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
				<WTGETCACHE name="CONST(tmpMerchantID)" value="MERCHANT" datatype="number"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MerchantID)" oper="not-equal" value="CONST(tmpMerchantID)"/>
					<WTCUSTOM>AbortUser()</WTCUSTOM>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCUSTOM>
          reqHeader = GetHeader( reqCompanyID, 0, "MobileHeader", "" )
          If reqCompanyID = 21 Then reqHeader = "NexxusRewardsMobile.png"
          reqHeader = "company/" + CStr(reqCompanyID) + "/" + reqHeader
        </WTCUSTOM>
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(MerchantName)" value="ATTR(MerchantName)"/>
          <WTSETCACHE name="MERCHANTSEARCH" value="ATTR(City)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="GetMenuColors reqCompanyID, GroupID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>

			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTFUNCTION name="ShowTab(tab, shw)">
					var mid = document.getElementById('MerchantID').value;
					var cid = document.getElementById('CompanyID').value;
					var frame, url, frm, src, page, target='', style='', compare=0, load=0, comingsoon=0;

					switch(tab) {
					case 'TabHome':
					frame = 'HomeFrame';
					switch(shw) {
					case 1: url = 'm_15220.asp?merchantid=' + mid; load=1; break;
					} break;
					case 'TabRewards':
					frame = 'RewardsFrame';
					switch(shw) {
					case 1: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					case 2: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					} break;
					case 'TabConsumers':
					frame = 'ConsumersFrame';
					switch(shw) {
					case 1: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					} break;
					case 'TabPromotions':
					frame = 'PromotionsFrame';
					switch(shw) {
					case 1: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					} break;
					case 'TabAccount':
					frame = 'AccountFrame';
					switch(shw) {
					case 1: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					case 2: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					case 3: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					} break;
					case 'TabHelp':
					frame = 'HelpFrame';
					switch(shw) {
					case 1: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					case 2: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					case 3: url = 'xxxxx.asp?merchantid=' + mid; comingsoon=1; break;
					} break;
					}
					if(comingsoon == 1) {
					alert('Coming Soon...');
					}
					else {
					if( target.length &gt; 0 ) {
							win = window.open(url,target,style);
							win.focus();
						}
						else {
							frm = document.getElementById(frame);
							src = frm.src;
							if( compare == 0 ) { compare = url.indexOf('.') }
							page = url.substring(0,compare);
							if (load == 1 || src.indexOf(page) &lt; 0 ) {frm.src = url} else {ShowFrame(tab)}
						}
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowFrame(tab)">
					document.getElementById('TabHome').style.display = 'none';
					document.getElementById('TabRewards').style.display = 'none';
					document.getElementById('TabConsumers').style.display = 'none';
					document.getElementById('TabPromotions').style.display = 'none';
					document.getElementById('TabAccount').style.display = 'none';
					document.getElementById('TabHelp').style.display = 'none';
					document.getElementById(tab).style.display = '';
				</WTFUNCTION>

				<WTLOAD>
					ShowTab('TabHome',1);
				</WTLOAD>

				<WTMENU name="UserMenu" type="bar" menuwidth="125" height="30" top-color="CONST(MenuTopColor)" top-bgcolor="CONST(MenuTopBGColor)"
						color="CONST(MenuColor)" bgcolor="CONST(MenuBGColor)" shadow-color="CONST(MenuShadowColor)" bdcolor="CONST(MenuBDColor)"
						over-color="CONST(MenuOverColor)" over-bgcolor="CONST(MenuOverBGColor)" divider-color="CONST(MenuDividerColor)" top-bgimg="CONST(MenuTopImage)" bgimg="CONST(MenuImage)">
					<WTITEM width="40" menuwidth="150">
						<WTIMAGE name="Menu2.png" width="29" height="30"/>
						<WTITEM label="mHome" width="100" menuwidth="100">
							<WTIMAGE name="Home.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabHome',1))"/>
						</WTITEM>
						<WTITEM label="mPromotions" width="125" menuwidth="125">
							<WTIMAGE name="Promo.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabPromotions',1))"/>
						</WTITEM>
						<WTITEM label="mConsumers" width="125" menuwidth="125">
							<WTIMAGE name="Prospect.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabConsumers',1))"/>
						</WTITEM>
						<WTITEM label="mRewards" width="125" menuwidth="125">
							<WTIMAGE name="Activity.gif" width="18" height="18"/>
							<WTITEM label="mCashBack">
								<WTIMAGE name="Activity.gif" width="18" height="18"/>
								<WTLINK name="JAVA(ShowTab('TabRewards',1))"/>
							</WTITEM>
							<WTITEM label="mPoints">
								<WTIMAGE name="Contest.gif" width="18" height="18"/>
								<WTLINK name="JAVA(ShowTab('TabRewards',2))"/>
							</WTITEM>
						</WTITEM>
						<WTITEM label="mAccount" width="100" menuwidth="125">
							<WTIMAGE name="MyInfo.gif" width="18" height="18"/>
							<WTITEM label="mProfile">
								<WTIMAGE name="MyInfo.gif" width="18" height="18"/>
								<WTLINK name="JAVA(ShowTab('TabAccount',1))"/>
							</WTITEM>
							<WTITEM label="mStore">
								<WTIMAGE name="Finance.gif" width="18" height="18"/>
								<WTLINK name="JAVA(ShowTab('TabAccount',2))"/>
							</WTITEM>
							<WTITEM label="mReports">
								<WTIMAGE name="Finance.gif" width="18" height="18"/>
								<WTLINK name="JAVA(ShowTab('TabAccount',3))"/>
							</WTITEM>
						</WTITEM>
						<WTITEM label="mHelp" width="100" menuwidth="175">
							<WTIMAGE name="Help.gif" width="18" height="18"/>
							<WTITEM label="mFAQ">
								<WTIMAGE name="Question.gif" width="18" height="18"/>
								<WTLINK name="JAVA(ShowTab('TabHelp',1))"/>
							</WTITEM>
							<WTITEM label="mTickets">
								<WTIMAGE name="SupportTicket.gif" width="18" height="18"/>
								<WTLINK name="JAVA(ShowTab('TabHelp',2))"/>
							</WTITEM>
							<WTDIVIDER/>
							<WTITEM label="mSignout">
								<WTIMAGE name="close.gif" width="18" height="18"/>
								<WTLINK name="m_15005" nodata="true"/>
							</WTITEM>
						</WTITEM>
					</WTITEM>
					<WTITEM value="CONST(MerchantName)" width="220" align="center"/>
					<WTITEM width="40">
						<WTIMAGE name="Refresh2.png" width="29" height="30"/>
						<WTLINK name="JAVA(doSubmit(0,''))"/>
					</WTITEM>
				</WTMENU>

				<WTROW>
					<WTHIDDEN value="PARAM(MerchantID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTIMAGE col="1" align="center" value="PARAM(Header)"/>
				</WTROW>
				<WTROW height="36">
					<WTSTATIC col="1" align="left" valign="top" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
						<WTCODEGROUP>
							<WTSTARTMENU name="UserMenu" type="bar"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW id="TabHome">
					<WTFRAME col="1" src="" name="HomeFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabHome')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabRewards">
					<WTFRAME col="1" src="" name="RewardsFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabRewards')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabConsumers">
					<WTFRAME col="1" src="" name="ConsumersFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabConsumers')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabPromotions">
					<WTFRAME col="1" src="" name="PromotionsFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabPromotions')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabAccount">
					<WTFRAME col="1" src="" name="AccountFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabAccount')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" src="" name="HelpFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabHelp')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

        <WTROW>
          <WTSTATIC col="1" align="right">
            <WTCODEGROUP>
              <WTTRANSLATE/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

      </WTCONTENT>
		</WTWEBPAGE>

    <!--=============================================================================================-->
    <WTWEBPAGE name="15030" caption="Nexxus Rewards" header="false" navbar="false" footer="false" wrapper="wrapper1000"
			page-color="#777777" margin-width="0" navbar-width="0" content-width="1000"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="15030" track="0">
      <!--=============================================================================================-->
      <WTPARAM name="MerchantID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Header" datatype="text"/>
      <WTPARAM name="MenuBehindColor" datatype="text"/>
      <WTPARAM name="MenuBehindImage" datatype="text"/>
      <WTPARAM name="Title" datatype="text"/>
      <WTPARAM name="PageImage" datatype="text"/>
      <WTPARAM name="M" datatype="number"/>
      <WTPARAM name="MenuLogo" datatype="text"/>

      <WTPARAM name="HeaderPosition" datatype="number"/>
      <WTPARAM name="HeaderAlign" datatype="number"/>
      <WTPARAM name="MenuAlign" datatype="number"/>
      <WTPARAM name="MenuBackground" datatype="number"/>

      <!--			<WTINCLUDE name="CompanyHeader.asp"/>-->
      <WTINCLUDE name="Portal.asp"/>
      <WTINCLUDE name="MenuColors.asp"/>

      <!-- Security Checks -->
      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
        <WTGETCACHE name="CONST(SysMerchantID)" value="MERCHANT" datatype="number"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MerchantID)" oper="not-equal" value="CONST(SysMerchantID)"/>
          <WTSETCACHE name="MERCHANT" value="CONST(&quot;&quot;)"/>
          <WTRETURN>
            <WTLINK name="15005" return="false"/>
          </WTRETURN>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MerchantID)">
          <WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)">
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <!--				<WTCALLSUB name="reqHeader = GetCompanyHeader( reqCompanyID, &quot;en&quot; )"/>-->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTSETATTRIBUTE name="PARAM(MenuLogo)" value="CONST(&quot;MenuLogo2.png&quot;)"/>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTMETHOD name="Load">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Title)" value="CONST(CleanXML(.NameFirst + &quot; &quot; + .NameLast))"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>

        <WTCALLSUB name="GetPortal reqCompanyID, GroupID, reqHeaderPosition, reqHeaderAlign, reqMenuAlign, reqMenuBackground"/>
        <WTCALLSUB name="GetMenuColors reqCompanyID, GroupID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>
      </WTACTION>
      <!--*******************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="1000" align="left" />

        <WTFUNCTION name="ShowTab(tab, shw)">
          var mid = document.getElementById('MerchantID').value;
          var cid = document.getElementById('CompanyID').value;
          var frame, url, frm, src, page, target='', style='', compare=0, load=0, comingsoon=0;

          switch(tab) {
          case 'TabDashboard':
          frame = 'DashboardFrame';
          switch(shw) {
          case 1: url = '15031.asp?merchantid=' + mid + "&amp;companyid=" + cid; load=1; break;
          case 2: url = 'm_15031.asp?merchantid=' + mid; target='Mobile'; style='top=100,left=100,height=492,width=322,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no'; break;
          } break;
          case 'TabReward':
          frame = 'RewardFrame';
          switch(shw) {
          case 1: url = '15101.asp?merchantid=' + mid; target="Shoppers"; break;
          case 2: url = '0922.asp?merchantid=' + mid; target="Bonuses"; break;
          case 3: url = '16301.asp?merchantid=' + mid; target="Statements"; break;
          } break;
          case 'TabAccount':
          frame = 'AccountFrame';
          switch(shw) {
          case 1: url = '15003.asp?merchantid=' + mid; break;
          case 2: url = '15008.asp?merchantid=' + mid; break;
          case 3: url = '0108.asp?popup=1&amp;merchantid=' + mid; load=1; break;
          } break;
          case 'TabHelp':
          frame = 'HelpFrame';
          switch(shw) {
          case 1: url = '1713.asp?contentpage=3&amp;popup=1&amp;companyid=' + cid; target="AdminGuide"; break;
          case 2: url = '9506.asp?contentpage=3&amp;popup=1&amp;companyid=' + cid; target="AdminTicket"; break;
          } break;
          }
          if(comingsoon == 1) {
          alert('Coming Soon...');
          }
          else {
          if( target.length &gt; 0 ) {
          win = window.open(url,target,style);
          win.focus();
          }
          else {
          if( tab == 'TabDashboard')
          document.getElementById('TopMargin').style.display = 'none';
          else
          document.getElementById('TopMargin').style.display = '';

          frm = document.getElementById(frame);
          src = frm.src;
          if( compare == 0 ) { compare = url.indexOf('.') }
          page = url.substring(0,compare);
          if (load == 1 || src.indexOf(page) &lt; 0 ) {frm.src = url} else {ShowFrame(tab)}
          }
          }
        </WTFUNCTION>

        <WTFUNCTION name="ShowFrame(tab)">
          document.getElementById('TabDashboard').style.display = 'none';
          document.getElementById('TabReward').style.display = 'none';
          document.getElementById('TabAccount').style.display = 'none';
          document.getElementById('TabHelp').style.display = 'none';
          document.getElementById(tab).style.display = '';
        </WTFUNCTION>

        <WTLOAD>
          ShowTab('TabDashboard',1);
        </WTLOAD>

        <WTMENU name="UserMenu" type="bar" menuwidth="125" height="30" top-color="CONST(MenuTopColor)" top-bgcolor="CONST(MenuTopBGColor)"
						color="CONST(MenuColor)" bgcolor="CONST(MenuBGColor)" shadow-color="CONST(MenuShadowColor)" bdcolor="CONST(MenuBDColor)"
						over-color="CONST(MenuOverColor)" over-bgcolor="CONST(MenuOverBGColor)" divider-color="CONST(MenuDividerColor)" top-bgimg="CONST(MenuTopImage)" bgimg="CONST(MenuImage)">

          <WTITEM label="mDashboard" width="75" menuwidth="175" height="30" menuheight="30">
            <WTIMAGE name="Home.gif" width="18" height="18"/>
            <WTLINK name="JAVA(ShowTab('TabDashboard',1))"/>
          </WTITEM>
          <WTITEM label="mRewards" width="100" menuwidth="125" height="30" menuheight="30">
            <WTIMAGE name="Finance.gif" width="18" height="18"/>
            <WTITEM label="mConsumers" width="125" menuwidth="125">
              <WTIMAGE name="Prospect.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabReward',1))"/>
            </WTITEM>
            <WTDIVIDER/>
            <WTITEM label="mBonuses">
              <WTIMAGE name="Finance.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabReward',2))"/>
            </WTITEM>
            <WTITEM label="mStatements">
              <WTIMAGE name="Finance.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabReward',3))"/>
            </WTITEM>
          </WTITEM>
          <WTITEM label="mAccount" width="100" menuwidth="150" height="30" menuheight="30">
            <WTIMAGE name="MyInfo.gif" width="18" height="18"/>
            <WTITEM label="mProfile">
              <WTIMAGE name="Prospect.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabAccount',1))"/>
            </WTITEM>
            <WTITEM label="mPayment">
              <WTIMAGE name="Finance.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabAccount',2))"/>
            </WTITEM>
            <WTDIVIDER/>
            <WTITEM label="m2FA">
              <WTIMAGE name="logon.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabAccount',3))"/>
            </WTITEM>
          </WTITEM>
          <WTITEM label="mHelp" width="100" menuwidth="175" height="30" menuheight="30">
            <WTIMAGE name="Help.gif" width="18" height="18"/>
            <WTITEM label="mFAQ">
              <WTIMAGE name="Question.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabHelp',1))"/>
            </WTITEM>
            <WTITEM label="mTickets">
              <WTIMAGE name="SupportTicket.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabHelp',2))"/>
            </WTITEM>
            <WTDIVIDER/>
            <WTITEM label="mSignout">
              <WTIMAGE name="close.gif" width="18" height="18"/>
              <WTLINK name="15005" nodata="true"/>
            </WTITEM>
          </WTITEM>
        </WTMENU>

        <WTROW>
          <WTHIDDEN value="PARAM(MerchantID)"/>
          <WTHIDDEN value="PARAM(CompanyID)"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(HeaderPosition)" oper="equal" value="CONST(0)"/>
          <WTROW>
            <WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(0)"/>
            <WTIMAGE col="1" align="left" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
          </WTROW>
          <WTROW>
            <WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(1)"/>
            <WTIMAGE col="1" align="center" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
          </WTROW>
          <WTROW>
            <WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(2)"/>
            <WTIMAGE col="1" align="right" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MenuBackground)" oper="equal" value="CONST(0)"/>
          <WTROW>
            <WTDIVIDER col="1" merge="2" align="left" height="1" color="PARAM(MenuBehindColor)" />
          </WTROW>
          <WTROW height="65">
            <WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(0)"/>
            <WTSTATIC col="1" align="left" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
              <WTCODEGROUP>
                <WTSTARTMENU name="UserMenu" type="bar"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW height="65">
            <WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(1)"/>
            <WTSTATIC col="1" align="center" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
              <WTCODEGROUP>
                <WTSTARTMENU name="UserMenu" type="bar"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW height="65">
            <WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(2)"/>
            <WTSTATIC col="1" align="right" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(MenuLogo)" oper="not-equal" value="CONST('')"/>
                <WTDIVISION style="float:left; margin-left:20px;">
                  <WTIMAGE value="PARAM(MenuLogo)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
                    <WTLINK name="ShowTab('TabDashboard',1)" click="true" />
                  </WTIMAGE>
                </WTDIVISION>
                <WTDIVISION style="float:right">
                  <WTSTARTMENU name="UserMenu" type="bar"/>
                </WTDIVISION>
              </WTCODEGROUP>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(MenuLogo)" oper="equal" value="CONST('')"/>
                <WTSTARTMENU name="UserMenu" type="bar"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW>
            <WTDIVIDER col="1" merge="2" align="left" height="1" color="PARAM(MenuBehindColor)" />
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MenuBackground)" oper="not-equal" value="CONST(0)"/>
          <WTROW height="65">
            <WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(0)"/>
            <WTSTATIC col="1" align="left" valign="top">
              <WTCODEGROUP>
                <WTSTARTMENU name="UserMenu" type="bar"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW height="65">
            <WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(1)"/>
            <WTSTATIC col="1" align="center" valign="top">
              <WTCODEGROUP>
                <WTSTARTMENU name="UserMenu" type="bar"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
          <WTROW height="65">
            <WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(2)"/>
            <WTSTATIC col="1" align="right" valign="top">
              <WTCODEGROUP>
                <WTSTARTMENU name="UserMenu" type="bar"/>
              </WTCODEGROUP>
            </WTSTATIC>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(HeaderPosition)" oper="equal" value="CONST(1)"/>
          <WTROW>
            <WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(0)"/>
            <WTIMAGE col="1" align="left" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
          </WTROW>
          <WTROW>
            <WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(1)"/>
            <WTIMAGE col="1" align="center" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
          </WTROW>
          <WTROW>
            <WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(2)"/>
            <WTIMAGE col="1" align="right" valign="top" value="PARAM(Header)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)"/>
          </WTROW>
        </WTCODEGROUP>

        <WTROW id="TopMargin" height="6"/>

        <!-- ======================================================================= -->
        <WTROW id="TabDashboard">
          <WTFRAME col="1" src="" name="DashboardFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabDashboard')" frmwidth="1000" frmheight="600" scrolling="no" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->
        <WTROW id="TabReward">
          <WTFRAME col="1" src="" name="RewardFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabReward')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->
        <WTROW id="TabAccount">
          <WTFRAME col="1" src="" name="AccountFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabAccount')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->
        <WTROW id="TabHelp">
          <WTFRAME col="1" src="" name="HelpFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabHelp')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->

        <WTROW>
          <WTSTATIC col="1" align="right">
            <WTCODEGROUP>
              <WTTRANSLATE/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
		<WTWEBPAGE name="15010" caption="Merchant Dashboard" navbar="false" header="false" footer="false" wrapper="false"
			page-left="0" margin-width="0" navbar-width="0"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="15010">
			<!--============================================================================================-->
			<WTPARAM name="MerchantID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="User2FA" datatype="number"/>

      <WTINCLUDE name="2FA.asp"/>

      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
        <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(Is2FAMerchant(reqMerchantID))"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="IsEmployee"/>
				<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
        <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(1)"/>
      </WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
					<WTMETHOD name="Load">
						<WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(User2FA)" value="CONST(1)">
            <WTCONDITION expr="ATTR(Status)" oper="less" value="CONST(3)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(tmpMerchant)" value="ATTR(MerchantName)"/>
          <WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpEnrollDate)" value="ATTR(EnrollDate)"/>
          <WTSETATTRIBUTE name="CONST(tmpBillDate)" value="ATTR(BillDate)"/>
          <WTSETATTRIBUTE name="CONST(tmpBillDays)" value="ATTR(BillDays)"/>
          <WTSETATTRIBUTE name="CONST(tmpAccess)" value="ATTR(Access)"/>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections/Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Merchant.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqMerchantID )
            xmlHTMLFile = Replace( xmlHTMLFile, "{merchant}", tmpMerchant )
            xmlHTMLFile = Replace( xmlHTMLFile, "{name}", tmpName )
            xmlHTMLFile = Replace( xmlHTMLFile, "{email}", tmpEmail )
            xmlHTMLFile = Replace( xmlHTMLFile, "{enrolldate}", tmpEnrollDate )
          </WTCUSTOM>
				</WTOBJECT>
      
        <!-- Company Customizations -->          
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
            <!-- Get the merchant's pending orders -->
            <WTMETHOD name="Custom">
              <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
              <WTPARAM name="Status" direction="input" value="CONST(2)"/>
              <WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
              <WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
              <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
              <WTPARAM name="Access" direction="input" value="CONST(&quot;&quot;)"/>
              <WTPARAM name="PendingOrders" direction="return" datatype="number"/>
            </WTMETHOD>
          </WTOBJECT>
          <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
            <WTMETHOD name="Custom">
              <WTPARAM name="Status" direction="input" value="CONST(28)"/>
              <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
              <WTPARAM name="Quantity" direction="input" value="PARAM(MerchantID)"/>
              <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
              <WTPARAM name="Result" direction="return" datatype="text"/>
            </WTMETHOD>
          </WTOBJECT>
          <WTCUSTOM>
            strDisplayOrders = "show"
            If PendingOrders = 0 Then strDisplayOrders = "none"
            If reqUser2FA = 0 Then
            strDisplay2FA = "show"
            strDisplayButtons = "none"
            Else
            strDisplay2FA = "none"
            strDisplayButtons = "show"
            End If
            xmlHTMLFile = Replace( xmlHTMLFile, "{display2FA}", strDisplay2FA )
            xmlHTMLFile = Replace( xmlHTMLFile, "{DisplayButtons}", strDisplayButtons )
            xmlHTMLFile = Replace( xmlHTMLFile, "{displayOrders}", strDisplayOrders )
            xmlHTMLFile = Replace( xmlHTMLFile, "{pendingorders}", PendingOrders )

            tmpToday = FormatDateTime(reqSysDate,1)
            aSection = Split( Result, "|")
            a1 = Split( aSection(0), "^")
            a2 = Split( aSection(1), "^")
            a3 = Split( aSection(2), "^")
            a4 = Split( aSection(3), "^")
            a5 = Split( aSection(4), "^")
            tmpSales1 = FormatCurrency(a1(0))
            tmpSales2 = FormatCurrency(a1(1))
            tmpSales3 = FormatCurrency(a1(2))
            tmpSales4 = FormatCurrency(a1(3))
            If a2(0) = "" Then a2(0) = "No Promotions Done Yet!"
            If a3(0) = "" Then a3(0) = "No Rewards Defined Yet!"
            If tmpAccess = "" Then tmpAccess = "Anytime"
            tmpBill2 = FormatCurrency(a5(1))
            tmpBill4 = FormatCurrency(a5(3))
            tmpBill6 = FormatCurrency(a5(5))
            tmpBill8 = FormatCurrency(a5(7))
            tmpBillAmount = FormatCurrency( CCUR(a5(3)) - ( CCUR(a5(5)) + CCUR(a5(7)) ) )

            xmlHTMLFile = Replace( xmlHTMLFile, "{today}", tmpToday )
            xmlHTMLFile = Replace( xmlHTMLFile, "{sales1}", tmpSales1 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{sales2}", tmpSales2 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{sales3}", tmpSales3 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{sales4}", tmpSales4 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{promo1}", a2(0) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{promo2}", a2(1) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{promo3}", a2(2) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{promo4}", a2(3) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{reward1}", a3(0) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{reward2}", a3(1) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{reward3}", a3(2) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{reward4}", a3(3) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer1}", a4(0) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer2}", a4(1) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer3}", a4(2) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer4}", a4(3) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{access}", tmpAccess )
            xmlHTMLFile = Replace( xmlHTMLFile, "{billdays}", tmpBillDays )
            xmlHTMLFile = Replace( xmlHTMLFile, "{billdate}", tmpBillDate )
            xmlHTMLFile = Replace( xmlHTMLFile, "{billamount}", tmpBillAmount )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill1}", a5(0) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill2}", tmpBill2 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill3}", a5(2) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill4}", tmpBill4 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill5}", a5(4) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill6}", tmpBill6 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill7}", a5(6) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bill8}", tmpBill8 )
          </WTCUSTOM>
        </WTCODEGROUP>
      
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="center"/>

				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="15031" caption="Organization Dashboard" navbar="false" header="false" footer="false" wrapper="false"
			page-left="0" margin-width="0" navbar-width="0"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="15031">
      <!--============================================================================================-->
      <WTPARAM name="MerchantID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>

      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="Merchant" project="ptsMerchantUser" class="CMerchant">
          <WTMETHOD name="Load">
            <WTPARAM name="MerchantID" direction="input" value="PARAM(MerchantID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpMerchant)" value="ATTR(MerchantName)"/>
          <WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpEnrollDate)" value="ATTR(EnrollDate)"/>
          <WTSETATTRIBUTE name="CONST(tmpBillDate)" value="ATTR(BillDate)"/>
          <WTSETATTRIBUTE name="CONST(tmpBillDays)" value="ATTR(BillDays)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMerchant" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections/Company/&quot; + CStr(reqCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Org.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqMerchantID )
            xmlHTMLFile = Replace( xmlHTMLFile, "{merchant}", tmpMerchant )
            xmlHTMLFile = Replace( xmlHTMLFile, "{name}", tmpName )
            xmlHTMLFile = Replace( xmlHTMLFile, "{email}", tmpEmail )
            xmlHTMLFile = Replace( xmlHTMLFile, "{enrolldate}", tmpEnrollDate )
          </WTCUSTOM>
        </WTOBJECT>

        <!-- Company Customizations -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
            <WTMETHOD name="Custom">
              <WTPARAM name="Status" direction="input" value="CONST(29)"/>
              <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
              <WTPARAM name="Quantity" direction="input" value="PARAM(MerchantID)"/>
              <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
              <WTPARAM name="Result" direction="return" datatype="text"/>
            </WTMETHOD>
          </WTOBJECT>
          <WTCUSTOM>
            tmpToday = FormatDateTime(reqSysDate,1)
            aSection = Split( Result, "|")
            a1 = Split( aSection(0), "^")
            a2 = Split( aSection(1), "^")
            tmpBonus1 = FormatCurrency(a1(0))
            tmpBonus2 = FormatCurrency(a1(1))
            tmpBonus3 = FormatCurrency(a1(2))
            tmpBonus4 = FormatCurrency(a1(3))
            tmpBonus5 = FormatCurrency(a1(4))

            xmlHTMLFile = Replace( xmlHTMLFile, "{today}", tmpToday )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bonus1}", tmpBonus1 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bonus2}", tmpBonus2 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bonus3}", tmpBonus3 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bonus4}", tmpBonus4 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{bonus5}", tmpBonus5 )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer1}", a2(0) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer2}", a2(1) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer3}", a2(2) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{refer4}", a2(3) )
          </WTCUSTOM>
        </WTCODEGROUP>

      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="1000" align="center"/>

        <WTROW>
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
		<WTWEBPAGE name="15013" caption="Search Merchants" action="5" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" focus="false" track="0">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="IsSearch" datatype="number"/>

			<WTINCLUDE name="Search.asp" />

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants"/>
				<WTGETCACHE name="PARAM(SearchText)" value="MERCHANTSEARCH"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(SearchText)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
        </WTCODEGROUP>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10004" message="Oops, Please enter text to search for."/>
					<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(0)"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants">
				<WTCONDITION expr="PARAM(IsSearch)" oper="equal" value="CONST(1)"/>
<WTCUSTOM>
	tmpSearchText = SearchText(Trim(reqSearchText))

	reqBookmark = .Search(reqBookmark, tmpSearchText, reqDirection)

	'Check for error for Noise Words only
	If Err.Number = -2147217900 Then
		Err.Number = 0
		reqSearchText = ""
	End If
	If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMerchants" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left"/>

				<WTFUNCTION name="ViewHelp()">
					var url, win;
					url = "pagex.asp?page=SearchHelp"
		      win = window.open(url,"SearchHelp");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewMap(address)">
					var url, win;
					url = "http://maps.google.com/?q=" + address
		      win = window.open(url,"Map");
					win.focus();
				</WTFUNCTION>

        <WTROW margin-top="12" margin-bottom="6">
					<WTTABLE col="1">
						<WTCOLUMN width="150" align="left"/>
						<WTCOLUMN width="850" align="left"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(store.png)" align="center"/>
							<WTTABLE col="2">
								<WTCOLUMN width="850" align="left"/>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" label="MerchantSearch" align="center" fontsize="4"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" label="MerchantSearchText" class="Prompt"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTTEXT col="1" value="PARAM(SearchText)" align="center" size="60" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
					<WTBUTTON col="1" value="CONST(Help)">
						<WTCLICK>ViewHelp()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

 				<WTSTATIC label="ViewStore"/>
 				<WTSTATIC label="ViewMap"/>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(SearchText)" oper="not-equal" value="CONST('')"/>
					 <WTRECORDSET col="1" graybar="true" prevnext="top" entity="Merchant">
						  <WTCOLUMN width="95" align="left" />
						  <WTCOLUMN width="5" align="center" />
				      <WTROW>
					      <WTDIVIDER col="1" merge="2" align="left" height="1" color="gray"/>
				      </WTROW>
						  <WTROW height="24">
								<WTSTATIC col="1">
									<WTSTATIC value="DATA(MerchantName)" space="2" fontsize="3"/>
								  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
          					<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" imgalign="absmiddle"/>
                  </WTCODEGROUP>
								  <WTSTATIC space="1"/>
                    <WTCODEGROUP>
  		                <WTCONDITION expr="__IsStoreShowContact"/>
                      <WTSTATIC space="3"/>
                      <WTSTATIC value="DATA(NameFirst)" space="1"/>
                      <WTSTATIC value="DATA(NameLast)"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
  		                <WTCONDITION expr="__IsStoreShowEmail"/>
                      <WTSTATIC space="3"/>
                      <WTSTATIC value="DATA(Email2)"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
  		                <WTCONDITION expr="__IsStoreShowPhone"/>
                      <WTSTATIC space="3"/>
                      <WTSTATIC value="DATA(Phone2)"/>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
  		                <WTCONDITION expr="__IsStoreShowAddress"/>
                      <WTSTATIC space="3"/>
                      <WTSTATIC value="DATA(Street1)" space="1"/>
                      <WTSTATIC value="DATA(Street2)" space="1"/>
                      <WTSTATIC value="DATA(City)" space="1"/>
                      <WTSTATIC value="DATA(State)" space="1"/>
                      <WTSTATIC value="DATA(Zip)" space="1"/>
                      <WTSTATIC value="DATA(CountryName)"/>
                      <WTCODEGROUP>
    		                <WTCONDITION expr="__IsStoreShowMap"/>
                        <WTSTATIC space="1"/>
									      <WTIMAGE value="CONST(GoogleMaps.png)" alt="ViewMap" imgalign="absmiddle">
                          <WTLINK name="ViewMap(&quot;&lt;xsl:value-of select=&quot;concat(@street1, ' ', @street2, ' ', @city, ' ', @state, ' ', @zip, ' ', @countryname)&quot;/&gt;&quot;)" click="true" />
									      </WTIMAGE>
                      </WTCODEGROUP>
                    </WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2">
								  <WTCODEGROUP>
									  <WTIMAGE value="CONST(Merchant24.gif)" alt="ViewStore" imgalign="absmiddle">
										  <WTLINK name="15050" return="false" target="MerchantStore">
											  <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
										  </WTLINK>
									  </WTIMAGE>
								  </WTCODEGROUP>
								</WTSTATIC>
						  </WTROW>
				      <WTROW>
					      <WTDIVIDER col="1" merge="2" align="left" height="1" color="gray"/>
				      </WTROW>
						  <WTROW>
								<WTSTATIC col="1" merge="2" value="DATA(Description)" embedhtml="true"/>
						  </WTROW>
					 </WTRECORDSET>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(SearchText)" oper="not-equal" value="CONST('')"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="m_15013" caption="Search Merchants" action="5" page-left="3" page-top="0" navbar="false" header="false" footer="false" 
		      page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
          aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" focus="false" mobile="m_15013.asp" track="0">
    <!--==================================================================-->
      <WTPARAM name="SearchText" datatype="text"/>
      <WTPARAM name="FindTypeID" datatype="number"/>
      <WTPARAM name="Bookmark" datatype="text"/>
      <WTPARAM name="Direction" datatype="number"/>
      <WTPARAM name="IsSearch" datatype="number"/>

      <WTINCLUDE name="Search.asp" />

      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
        <WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants"/>
				<WTGETCACHE name="PARAM(SearchText)" value="MERCHANTSEARCH"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(SearchText)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
        </WTCODEGROUP>
      </WTACTION>

      <WTACTION id="5" name="Find" type="New">
        <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)"/>
          <WTERROR number="10004" message="Oops, Please enter text to search for."/>
          <WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(0)"/>
        </WTCODEGROUP>
      </WTACTION>

      <WTACTION id="6" name="Previous" type="New">
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
        <WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
      </WTACTION>

      <WTACTION id="7" name="Next" type="New">
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
      </WTACTION>

      <WTOBJECT name="Merchants" project="ptsMerchantUser" class="CMerchants">
        <WTCONDITION expr="PARAM(IsSearch)" oper="equal" value="CONST(1)"/>
        <WTCUSTOM>
          tmpSearchText = SearchText(Trim(reqSearchText))

          reqBookmark = .Search(reqBookmark, tmpSearchText, reqDirection)

          'Check for error for Noise Words only
          If Err.Number = -2147217900 Then
          Err.Number = 0
          reqSearchText = ""
          End If
          If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
        </WTCUSTOM>
        <WTMETHOD name="XML">
          <WTPARAM name="xmlMerchants" direction="return" datatype="text"/>
        </WTMETHOD>
      </WTOBJECT>
      <WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
        <WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
        <WTMETHOD name="XML">
          <WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
        </WTMETHOD>
      </WTOBJECT>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="100" align="left"/>

        <WTFUNCTION name="ViewHelp()">
          var url, win;
          url = "pagex.asp?page=SearchHelp"
          win = window.open(url,"SearchHelp");
          win.focus();
        </WTFUNCTION>
        <WTFUNCTION name="ViewMap(address)">
          var url, win;
          url = "http://maps.google.com/?q=" + address
          win = window.open(url,"Map");
          win.focus();
        </WTFUNCTION>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="MerchantSearch" class="PageHeading" align="center"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="MerchantSearchText" class="Prompt"/>
        </WTROW>

        <WTROW margin-bottom="6">
          <WTTEXT col="1" value="PARAM(SearchText)" align="center" size="30" focus="true"/>
          <WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
          <WTBUTTON col="1" value="CONST(Help)">
            <WTCLICK>ViewHelp()</WTCLICK>
          </WTBUTTON>
        </WTROW>

        <WTSTATIC label="ViewStore"/>
        <WTSTATIC label="ViewMap"/>

        <WTROW margin-bottom="6">
          <WTCONDITION expr="PARAM(SearchText)" oper="not-equal" value="CONST('')"/>
          <WTRECORDSET col="1" graybar="true" prevnext="top" entity="Merchant">
            <WTCOLUMN width="95" align="left" />
            <WTCOLUMN width="5" align="center" />
            <WTROW>
              <WTDIVIDER col="1" align="left" height="1" color="gray"/>
            </WTROW>
            <WTROW height="24">
              <WTSTATIC col="1">
                <WTSTATIC value="DATA(MerchantName)" space="2" fontsize="3"/>
                <WTSTATIC space="1"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTSTATIC space="1"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="__IsStoreShowContact"/>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(NameFirst)" space="1"/>
                  <WTSTATIC value="DATA(NameLast)"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="__IsStoreShowEmail"/>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(Email2)"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="__IsStoreShowPhone"/>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(Phone2)"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="__IsStoreShowAddress"/>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(Street1)" space="1"/>
                  <WTSTATIC value="DATA(Street2)" space="1"/>
                  <WTSTATIC value="DATA(City)" space="1"/>
                  <WTSTATIC value="DATA(State)" space="1"/>
                  <WTSTATIC value="DATA(Zip)" space="1"/>
                  <WTSTATIC value="DATA(CountryName)"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="__IsStoreShowMap"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(GoogleMaps.png)" alt="ViewMap" imgalign="absmiddle">
                      <WTLINK name="ViewMap(&quot;&lt;xsl:value-of select=&quot;concat(@street1, ' ', @street2, ' ', @city, ' ', @state, ' ', @zip, ' ', @countryname)&quot;/&gt;&quot;)" click="true" />
                    </WTIMAGE>
                  </WTCODEGROUP>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="2">
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(Merchant24.gif)" alt="ViewStore" imgalign="absmiddle">
                    <WTLINK name="m_15050" return="false" target="MerchantStore">
                      <WTPARAM name="MerchantID" value="DATA(MerchantID)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>
            <WTROW>
              <WTDIVIDER col="1" merge="2" align="left" height="1" color="gray"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" merge="2" value="DATA(Description)" embedhtml="true"/>
            </WTROW>
          </WTRECORDSET>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

  </WTWEBPAGES>
</WTROOT>