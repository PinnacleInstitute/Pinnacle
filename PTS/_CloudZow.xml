<WTROOT prefix="pts" system="Pinnacle">

	<WTENTITY id="108" name="CloudZow" alias="cz">
		<!--Identity-->
		<WTATTRIBUTE id="10801" name="CloudZowID" type="number" identity="true" title="true" min="1" required="true" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="10895" name="Result" type="text" length="1000" source="entity" persist="false"/>
		<WTATTRIBUTE id="10896" name="Status" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="10897" name="czDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="10898" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="10899" name="Amount" type="number" source="entity" persist="false"/>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="CloudZow" entity="CloudZow" alias="cz"/>
		</WTRELATIONSHIPS>
	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="CustomList" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(CloudZow.CloudZowID)"/>
					<WTATTRIBUTE value="ATTR(CloudZow.Result)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
<!-- Processing - Admin Page -->
		<!--==================================================================-->
		<WTWEBPAGE name="10800" caption="CloudZow Processing" header="false" footer="false" navbar="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="10800" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Process" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Result" datatype="text"/>

			<WTDATATXN name="Members"/>
			<WTDATATXN name="CloudZows"/>

			<WTINCLUDE name="Payout.asp"/>
			<WTINCLUDE name="BillingProcess.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
				<!-- Set this page to not timeout for 4 hours -->
				<WTCUSTOM>Server.ScriptTimeout = 14400</WTCUSTOM>				
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
			<!-- Disable Certain Features based on User Type -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsManagerOnly"/>
				<WTCUSTOM>If InStr( ",11,12,13,21,22,23,24,25,26,27,28,29,30,31,32,33,34,", CSTR(reqProcess)+"," ) = 0 Then reqProcess = 0</WTCUSTOM>
			</WTCODEGROUP>
<WTCUSTOM>
'Set date range to previous month
If reqOption = 0 Then
	reqFromDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqToDate = DateAdd( "d", -1, reqFromDate ) 
	reqFromDate = DateAdd( "m", -1, reqFromDate ) 
End If	
'Set date range to current date
If reqOption = 1 Then
	reqToDate = reqSysDate
	reqFromDate = DateAdd( "m", -1, reqSysDate ) 
End If	
'Set date range to previous month
If reqOption = 2 Then
	reqToDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqFromDate = DateAdd( "m", -1, reqToDate ) 
	reqToDate = DateAdd( "d", -1, reqToDate ) 
End If	
'Set date range to one month back from last Sunday
If reqOption = 3 Then
	reqToDate = DateAdd( "d", -5, reqSysDate ) 
	reqFromDate = DateAdd( "m", -1, reqToDate ) 
End If	
'Set date range to one week back
If reqOption = 4 Then
	reqToDate = DateAdd( "d", -1, reqSysDate ) 
	reqFromDate = DateAdd( "d", -7, reqToDate ) 
End If	
</WTCUSTOM>
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>

					<!-- Create Billing Tokens -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						<WTCUSTOM>
							Result = BillingTokens()
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " New Billing Tokens Successfully Created! (" + aResult(1) + " bad)"
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Create Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(200)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payments Successfully Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Process Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						<WTCUSTOM>
							Result = ProcessPayments()
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " Payments Successfully Processed! (" + aResult(1) + " bad)"
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- List Declined Token -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Tokens!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Declined Paments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(100)"/>
								<WTPARAM name="Level" direction="input" value="CONST(4)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Declined Payments Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Verify Bonus Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Earn Bonuses!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Calculate Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						<WTOBJECT name="Commission" project="ptsCommissionUser" class="CCommission">
							<WTMETHOD name="CustomCommissions">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="CommType" direction="input" value="CONST(1)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Bonuses Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Display Hidden Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(202)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Bonuses Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Create Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyPayouts">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payouts Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Payout Credits -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(4)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payment Credits Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Verify Payout Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(6)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Receive a Bonus Check!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Create Payout Files -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						<WTCALLSUB name="ExportACH reqCompanyID, reqToDate, 0, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; ACHs (&quot; &amp; tmpAmount &amp; &quot;) Exported to &quot; + tmpFile + &quot;&lt;br&gt;&quot;)"/>
						<WTCALLSUB name="ExportCheck reqCompanyID, reqToDate, 0, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult &amp; tmpTotal &amp; &quot; Checks (&quot; &amp; tmpAmount &amp; &quot;) Exported to &quot; + tmpFile + &quot;&lt;br&gt;&quot;)"/>
						<WTCALLSUB name="ExportWallet reqCompanyID, reqToDate, 0, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult &amp; tmpTotal &amp; &quot; eWallets (&quot; &amp; tmpAmount &amp; &quot;) Exported to &quot; + tmpFile)"/>
					</WTCODEGROUP>

					<!-- Mark Payous Paid -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyStatus2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="PaidDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Reference" direction="input" value="CONST(&quot;123&quot;)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Pending Payouts Marked Paid!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Display Hidden Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(203)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Payouts Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Recalculate Group Sales Volume and Promotions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(1)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Group Sales Volumes and Promotions Recalculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Post sales summary -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(2)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Sales Summary Postings!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- List Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All New eWallets to be Created -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTOBJECT name="CloudZows" project="ptsCloudZowUser" class="CCloudZows">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlCloudZows" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;New eWallets to be imported to iPayout in a .CSV file!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Assign New eWallets to Payout Method -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New eWallets Assigned!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Mark GCC Payment Orders Pending (in process)-->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All New Global Cash Card orders marked pending!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Set All Member Alerts-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Member Alerts Set!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Clean up Data -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Data Cleaned Up!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

				</WTCODEGROUP>

			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(Result)" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="24">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC label="NotAvailable">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="BillingTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateDeclined">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						</WTSTATIC>
						<WTSTATIC label="BonusQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						</WTSTATIC>
						<WTSTATIC label="CalcBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentCredits">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutPaid">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayPayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSummary">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						</WTSTATIC>
						<WTSTATIC label="ListOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						</WTSTATIC>
						<WTSTATIC label="CreateWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						</WTSTATIC>
						<WTSTATIC label="AssignWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						</WTSTATIC>
						<!--
						<WTSTATIC label="MarkGCC">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="SetAlerts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						</WTSTATIC>
						<WTSTATIC label="CleanupData">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTSTATIC col="1" label="From" align="center" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTTEXT col="1" align="center" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" label="eWalletHdr" align="left"/>
						</WTROW>
						<WTROW>
							<WTREPEAT entity="CloudZow">
								<WTROW>
									<WTSTATIC col="1" value="DATA(Result)" align="left"/>
								</WTROW>
							</WTREPEAT>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" action="1" value="CONST(Process)" align="center">
						<WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Customer to Affiliate upgrade Enrollment Page for Machine! -->
		<!--============================================================================================-->
		<WTWEBPAGE name="CustomerUpgrade" caption="Customer Upgrade" navbar="false" header="false" footer="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="customerUpgrade">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferralID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Computers" datatype="number"/>
			<WTPARAM name="ActiveComputers" datatype="number"/>
			<WTPARAM name="TaxIDType1" datatype="number"/>
			<WTPARAM name="TaxIDType2" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Comm.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(5)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CountryIDb)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Computers)" value="CONST(8)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadLists">
				<WTCALLSUB name="LoadCountrys"/>
				<WTOBJECT name="Machines" project="ptsMachineUser" class="CMachines">
					<WTMETHOD name="List">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						reqActiveComputers = 0
						For Each oMachine in oMachines
							With oMachine
								If .Status &lt;= 2 Then
									reqActiveComputers = reqActiveComputers + 1
								End If
							End With
						Next
					</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll1.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferralID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferralID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(TRIM(.NameFirst + &quot; &quot; + .NameLast))"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10006" message="Oops, Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!--					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>-->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
<!--						<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferralID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>

				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETCACHE name="SYS(MenuBarState)" value="SYS(MenuBarState)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)"/>
					<WTSETATTRIBUTE name="ATTR(TaxIDType)" value="FORM(TaxIDType1)">
						<WTCONDITION expr="CONST(tmpCountryID)" oper="equal" value="CONST(224)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(TaxIDType)" value="FORM(TaxIDType2)">
						<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
					
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="0"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
						<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEF&quot;)"/>

					<WTSETATTRIBUTE name="ATTR(SponsorID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)">
						<WTCONDITION expr="ATTR(PaidDate)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Computers)" oper="equal" value="CONST(8)"/>
						<WTSETATTRIBUTE name="CONST(tmpTitle)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Title2)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(MaxMembers)" value="CONST(2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Computers)" oper="less" value="CONST(8)"/>
						<WTSETATTRIBUTE name="CONST(tmpTitle)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Title2)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(MaxMembers)" value="CONST(1)"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Process)" value="PARAM(Computers)"/>
					<WTSETATTRIBUTE name="CONST(OldPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(reqComputers * 5)"/>
					<WTSETATTRIBUTE name="ATTR(BV)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="ATTR(BV2)" value="ATTR(Price)"/>

					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
							oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Send notice to Referrer -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?Leadsers=1&amp;MemberID=" &amp; reqMemberID
							oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
				
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
<!--					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- Customer upgrade Processing -->
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(102)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(OldPrice)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="CONST(4)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;Customer upgrade to Affiliate&quot;)">
						<WTCONDITION expr="CONST(tmpTitle)" oper="not-equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;Customer upgrade to Reseller&quot;)">
						<WTCONDITION expr="CONST(tmpTitle)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/> 
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/> 
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
				<WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
				<WTSETATTRIBUTE name="CONST(tmpTaxIDType)" value="FORM(TaxIDType1)">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="equal" value="CONST(224)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpTaxIDType)" value="FORM(TaxIDType2)">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10125" message="Oops, Please enter a First Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10126" message="Oops, Please enter a Last Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpTaxIDType)" oper="equal" value="CONST(2)" connector="and"/>
					<WTCONDITION expr="CONST(tmpCompanyName)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10127" message="Oops, Please enter a Company Name."/>
				</WTCODEGROUP>

				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr = "PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to be billed monthly."/>
					</WTCODEGROUP>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
				</WTCODEGROUP>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)"/>
					<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;AffiliateWelcome.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
						<WTMETHOD name="Load" />
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>

			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="210" align="right"/>
				<WTCOLUMN width="490" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
				</WTROW>
				
				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
					//var countryid = document.getElementById('CountryID').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none';
					var paytype = payobj.value;
					//var l = payobj.length;
					//for( i = 0; i &lt; l; i++ ) {
					//	if (payobj[i].checked) {
					//		paytype = payobj[i].value;
					//		i = l;
					//	}
					//}
					//if (paytype == 5) {
					//	if ( countryid != 224 ) {
					//		paytype = 1;
					//		document.getElementById('PayType').value = paytype;
					//		alert("Electronic Checks not available outside the United States");
					//	}
					//}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
					ToggleType();
					}
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">	
					var val = obj.value;
					if ( val.length == 2 ) {
						obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {					
						obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatPhone(obj)">	
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					if( newval.length == 10 ) {
						obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
					}	
					if( newval.length == 11 ) {
						obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
					}	
					if( newval.length == 12 ) {
						obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
					}	
				</WTFUNCTION>
				<WTFUNCTION name="FormatTaxID(obj)">
					var taxidtype = document.getElementById('TaxIDType').value;
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					if( taxidtype == 1 ) {
						if( newval.length &lt; 9 ) {
							alert('Oops, Invalid Social Security Number'); 
						}
						else {
							obj.value = newval.substring(0,3) + '-' + newval.substring(3,5) + '-' + newval.substring(5,9);
						}
					}
					if( taxidtype == 2 ) {
						if( newval.length &lt; 9 ) {
							alert('Oops, Invalid Employer Identification Number'); 
						}
						else {
							obj.value = newval.substring(0,2) + '-' + newval.substring(2,9);
						}
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>
				
				<WTFUNCTION name="ShowCC()">
					var disp, computers = document.getElementById('Computers').value;
					if( computers == 0 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					document.getElementById('Payment').style.display = disp;
					document.getElementById('CardRows').style.display = disp;
					document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="ShowTaxIDType()">
					var countryid = document.getElementById('CountryID').value;
					if( countryid == 224 ) {
						document.getElementById('TaxIDType1').style.display = '';
						document.getElementById('TaxIDType2').style.display = 'none';
					}	
					else {
						document.getElementById('TaxIDType1').style.display = 'none';
						document.getElementById('TaxIDType2').style.display = '';
					}	
				</WTFUNCTION>

				<WTLOAD>ShowTaxIDType()</WTLOAD>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>

					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="3" align="center" bold="true">
							<WTSTATIC tag="ReferredBy"/>
							<WTSTATIC value="PARAM(ReferredBy)"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
							<WTCODEGROUP>
								<WTCHECK value="PARAM(IsAgree)"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, First Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="290" label="NameLast" size="25" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Last Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CompanyName"/>
						<WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
					</WTROW>
					
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60">
							<WTEXIT>if(this.value==''){alert('Oops, Mailing Address Required!')}; document.getElementById('Street1b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>



					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60">
							<WTEXIT>document.getElementById('Street2b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.City)" width="200" label="City" size="25">
							<WTEXIT>if(this.value==''){alert('Oops, City Required!');}else{TitleCase(this);}; document.getElementById('Cityb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" width="290" label="State" size="25">
							<WTEXIT>if(this.value==''){alert('Oops, State Required!');}else{TitleCase(this);}; document.getElementById('Stateb').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" width="100" label="Zip" size="10">
							<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')}; document.getElementById('Zipb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" width="390" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
							<WTEXIT>document.getElementById('CountryIDb').value = this.value;</WTEXIT>
							<WTCHANGE>ShowTaxIDType()</WTCHANGE>
						</WTCOMBO>
					</WTROW>

					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="20">
							<WTEXIT>FormatPhone(this);</WTEXIT>
						</WTTEXT>
					</WTROW>

					<WTROW margin-top="3">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="TaxID"/>
						<WTCOMBO col="3" value="PARAM(TaxIDType1)" translate="false">
							<WTOPTION id="1" label="TaxIDType1"/>
							<WTOPTION id="2" label="TaxIDType2"/>
							<WTOPTION id="3" label="TaxIDType3"/>
						</WTCOMBO>
						<WTCOMBO col="3" value="PARAM(TaxIDType2)" translate="false" noprespace="true">
							<WTOPTION id="4" label="TaxIDType4"/>
							<WTOPTION id="5" label="TaxIDType5"/>
							<WTOPTION id="6" label="TaxIDType6"/>
							<WTOPTION id="7" label="TaxIDType7"/>
							<WTOPTION id="8" label="TaxIDType8"/>
						</WTCOMBO>
						<WTTEXT col="3" value="ATTR(Member.TaxID)">
							<WTEXIT>FormatTaxID(this);</WTEXIT>
						</WTTEXT>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="50" align="center"/>
							<WTCOLUMN width="100" align="left"/>
							<WTCOLUMN width="550" align="left"/>
							<WTCOLUMN width="50" align="center"/>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" class="PageHeading" fontsize="6" valign="top" align="center">
									<WTCODEGROUP><WTIMAGE value="CONST(Affiliate.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC label="QualifiedAffiliate"/>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="2" bold="true" align="left" valign="top">
									<WTSTATIC label="QualifiedAffiliateText"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
		 						<WTRADIO col="3" group="Computers" name="8" align="left" datapathx="/DATA/PARAM/@computers=8"/>
								<WTSTATIC col="3" label="Computers8" bold="true"/>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" label="ResellerText" fontsize="1"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
		 						<WTRADIO col="3" group="Computers" name="1" datapathx="/DATA/PARAM/@computers=1"/>
								<WTSTATIC col="3" label="Computers1" fontsize="1"/>
							</WTROW>
						</WTTABLE>
					</WTROW>
					
					<WTCODEGROUP>
						<WTCONDITION expr = "ATTR(Member.BillingID)" oper="equal" value="CONST(0)" />
						<WTROW id="Agree2">
							<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW id="Payment">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="750" align="center"/>

								<WTROW margin-top="12" margin-bottom="12">
									<WTDIVIDER col="1" height="1" color="#584b42"/>
								</WTROW>
								<WTROW id="Pay2" margin-bottom="6">
									<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
								</WTROW>
								<WTROW>
									<WTHIDDEN value="PARAM(PayType)"/>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="6">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CardRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="12" label="2012"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="BillingAddress" />
									<WTTEXT col="2" value="PARAM(Street1b)" size="60">
										<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="20" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="20" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="10" align="left" required="true">
										<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>

							</WTTABLE>
						</WTROW>
						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="6" margin-bottom="24">
						<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
							<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Affiliate Upgrade Page for Machine! -->
		<!--============================================================================================-->
		<WTWEBPAGE name="change" caption="Change Purchase" navbar="false" header="false" footer="false" stylesheet="StyleSheet5.css" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="change" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Computers" datatype="number"/>
			<WTPARAM name="ZowMoney" datatype="number"/>
			<WTPARAM name="ZowUniversity" datatype="number"/>
			<WTPARAM name="FastTrack" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="Amount" datatype="number"/>
			<WTPARAM name="ActiveComputers" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="Result" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="Products.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="AuthorizeNet.asp"/>
			<WTINCLUDE name="AuthorizeToken.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="NewBilling">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<WTCALLSUB name="reqFastTrack = GetFastTrack( oMember)"/>
					<WTCALLSUB name="reqComputers = GetProduct( oMember, cZowBackups)"/>
					<WTCALLSUB name="reqZowMoney = GetProduct( oMember, cZowMoney)"/>
					<WTCALLSUB name="reqZowUniversity = GetProduct( oMember, cZowUniversity)"/>
<WTCUSTOM>
		aReference = Split(.Reference,"-")
		if(UBOUND(aReference) = 1) Then reqMemberToken = aReference(1) Else reqMemberToken = 0 
</WTCUSTOM>					
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machines" project="ptsMachineUser" class="CMachines">
					<WTMETHOD name="List">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
<WTCUSTOM>
				reqActiveComputers = 0
				For Each oMachine in oMachines
					With oMachine
						If .Status &lt;= 2 Then
							reqActiveComputers = reqActiveComputers + 1
						End If
					End With
				Next
</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(PayType)"/>
					<WTSETATTRIBUTE name="PARAM(Processor)" value="ATTR(TokenType)"/>
					<WTSETATTRIBUTE name="PARAM(Token)" value="ATTR(Token)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
				</WTOBJECT>
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Change.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="Add">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewBilling"/>
			</WTACTION>
			
			<WTACTION id="2" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to be billed monthly."/>
					</WTCODEGROUP>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
				</WTCODEGROUP>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSponsorID)" value="ATTR(SponsorID)"/>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="0"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)">
						<WTCONDITION expr="ATTR(Process)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Computers)" oper="not-equal" value="CONST(0)" connector="and"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(oldFastTrack)" value="ATTR(IsMaster)"/>
					<WTSETATTRIBUTE name="CONST(oldPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(oldComputers)" value="ATTR(Process)"/>
					<WTCALLSUB name="oldZowMoney = GetProduct( oMember, cZowMoney)"/>
					<WTCALLSUB name="oldZowUniversity = GetProduct( oMember, cZowUniversity)"/>
					
					<WTSETATTRIBUTE name="CONST(tmpFastTrack)" value="FORM(FastTrack)"/>
					<WTSETATTRIBUTE name="CONST(tmpComputers)" value="FORM(Computers)"/>
					<WTSETATTRIBUTE name="CONST(tmpZowMoney)" value="FORM(ZowMoney)"/>
					<WTSETATTRIBUTE name="CONST(tmpZowUniversity)" value="FORM(ZowUniversity)"/>

					<WTSETATTRIBUTE name="CONST(tmpZowMoney)" value="CONST(CLng(tmpZowMoney))"/>
					<WTSETATTRIBUTE name="CONST(tmpZowUniversity)" value="CONST(CLng(tmpZowUniversity))"/>
					<WTSETATTRIBUTE name="CONST(tmpNote)" value="CONST(&quot;&quot;)"/>

					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
					<!-- If they were not on FastTrack and now have selected FastTrack -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldFastTrack)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpFastTrack)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCALLSUB name="SetFastTrack oMember"/>
						<WTCALLSUB name="SetProduct oMember, cZowBackups, 8"/>
						<WTCALLSUB name="SetProduct oMember, cZowMoney, 1"/>
						<WTCALLSUB name="SetProduct oMember, cZowUniversity, 1"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(299)"/>
						<WTSETATTRIBUTE name="CONST(tmpNote)" value="CONST(&quot;Fast Track&quot;)"/>
					</WTCODEGROUP>
					<!-- If they were already on FastTrack or have not selected FastTrack -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldFastTrack)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpFastTrack)" oper="equal" value="CONST(0)" connector="or"/>
						<WTCALLSUB name="SetProduct oMember, cZowBackups, tmpComputers"/>
						<WTCALLSUB name="SetProduct oMember, cZowMoney, tmpZowMoney"/>
						<WTCALLSUB name="SetProduct oMember, cZowUniversity, tmpZowUniversity"/>

						<WTSETATTRIBUTE name="CONST(tmpNote)" value="CONST(tmpNote + &quot;Computers: &quot; + CStr(oldComputers) + &quot; to &quot; + CStr(tmpComputers) + &quot; &quot;)">
							<WTCONDITION expr="CONST(tmpComputers)" oper="not-equal" value="CONST(oldComputers)"/>
						</WTSETATTRIBUTE>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpZowMoney)" oper="not-equal" value="CONST(oldZowMoney)"/>
							<WTSETATTRIBUTE name="CONST(tmpNote)" value="CONST(tmpNote + &quot;Added ZowMoney &quot;)">
								<WTCONDITION expr="CONST(tmpZowMoney)" oper="not-equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(tmpNote)" value="CONST(tmpNote + &quot;Removed ZowMoney &quot;)">
								<WTCONDITION expr="CONST(tmpZowMoney)" oper="equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpZowUniversity)" oper="not-equal" value="CONST(oldZowUniversity)"/>
							<WTSETATTRIBUTE name="CONST(tmpNote)" value="CONST(tmpNote + &quot;Added ZowUniversity &quot;)">
								<WTCONDITION expr="CONST(tmpZowUniversity)" oper="not-equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(tmpNote)" value="CONST(tmpNote + &quot;Removed ZowUniversity &quot;)">
								<WTCONDITION expr="CONST(tmpZowUniversity)" oper="equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCALLSUB name="GetPrice oMember"/>

					<!-- Process Fast Track payment -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(Processor)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTCALLSUB name="GetPayment reqMemberID, BillingPrice, reqPayType, reqPayDesc, reqProcessor, reqMemberToken, reqToken"/>
							<WTCODEGROUP>
	 							<WTCONDITION expr="NoErrors"/>
								<!-- Update Billing Date -->
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
								<WTMETHOD name="Save">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Processor)" oper="equal" value="CONST(0)"/>
							<WTCUSTOM>LogMemberNote reqMemberID, "FAST TRACK PAYMENT ERROR: Missing Token"</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="PARAM(Amount)" value="CONST(CLng(.Price) - CLng(oldPrice))"/>
					<WTSETATTRIBUTE name="ATTR(BV)" value="CONST(CLng(.BV) + reqAmount)"/>
					<WTSETATTRIBUTE name="ATTR(BV2)" value="CONST(CLng(.BV2) + reqAmount)"/>
					<WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Title)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldTitle)" oper="equal" value="CONST(2)"/>
						<WTCONDITION expr="CONST(CLng(.BV))" oper="less" value="CONST(40)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Title2)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(MaxMembers)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(.BV))" oper="greater-equal" value="CONST(40)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)">
							<WTCONDITION expr="ATTR(Title)" oper="less" value="CONST(2)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Title2)" value="CONST(2)">
							<WTCONDITION expr="ATTR(Title2)" oper="less" value="CONST(2)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(MaxMembers)" value="CONST(2)">
							<WTCONDITION expr="ATTR(MaxMembers)" oper="less" value="CONST(2)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(newTitle)" value="ATTR(Title)"/>
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCODEGROUP>
	 				<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(newTitle)" oper="not-equal" value="CONST(oldTitle)" connector="and"/>
					<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
						<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="PARAM(MemberID)"/>
						<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
						<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(newTitle)"/>
						<WTSETATTRIBUTE name="ATTR(MemberTitle.IsEarned)" value="CONST(1)"/>
						<WTMETHOD name="Add">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTCONDITION expr="CONST(tmpSponsorID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpSponsorID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)"/>
<WTCUSTOM>
	tmpSender = "support@CloudZow.com"
	tmpFrom = "support@CloudZow.com"
	If newTitle = 1 Then
	tmpSubject = tmpName + " has downgraded to a Reseller"
	Else
	tmpSubject = tmpName + " has upgraded to an Affiliate"
	End If
	tmpBody = tmpSubject
	SendEmail reqSysCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpSubject
</WTCUSTOM>
					</WTOBJECT>
				</WTCODEGROUP>
				<!-- Update Group Sales Volume -->
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Amount)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(101)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(Amount)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- check for advancement for new FastTrack upgrade -->
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(BillingPrice)" oper="equal" value="CONST(299)" connector="and"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(15)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNote)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTCUSTOM>LogMemberNote reqMemberID, "PURCHASE CHANGE: " + tmpNote</WTCUSTOM>
				</WTCODEGROUP>
				
				<WTCALLSUB name="LoadBilling"/>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)">
						<WTCONDITION expr="CONST(BillingPrice)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(2)">
						<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>
				<WTCOLUMN width="500" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.IsMaster)"/>
					<WTHIDDEN value="PARAM(Processor)"/>
					<WTHIDDEN value="PARAM(MemberToken)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
					//var countryid = document.getElementById('CountryID').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none';
					var paytype = payobj.value;
					//var l = payobj.length;
					//for( i = 0; i &lt; l; i++ ) {
					//	if (payobj[i].checked) {
					//		paytype = payobj[i].value;
					//		i = l;
					//	}
					//}
					//if (paytype == 5) {
					//	if ( countryid != 224 ) {
					//		paytype = 1;
					//		document.getElementById('PayType').value = paytype;
					//		alert("Electronic Checks not available outside the United States");
					//	}
					//}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
					ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowCC()">
					var disp, computers = document.getElementById('Computers').value;
					if( computers == 0 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					document.getElementById('Payment').style.display = disp;
					document.getElementById('CardRows').style.display = disp;
					document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="ShowPrice()">
					var ismaster = document.getElementById('IsMaster').value;
					var fasttrack = document.getElementById('FastTrack').checked;
					var computers = document.getElementById('Computers').value;
					var money = document.getElementById('ZowMoney').checked;
					var university = document.getElementById('ZowUniversity').checked;
					var price = computers * 5;
					if( money ) { price = price + 15 }
					if( university ) { price = price + 15 }
					if( ismaster != 0 ) {
						price = price - 30;
						if(price &lt; 0) { price = 0 }
					}	
					else {
						if(fasttrack) {
							price = 40;
						}
					}
					document.getElementById('Price').value = 'Monthly: ' + formatCurrency( price );
				</WTFUNCTION>
				<WTFUNCTION name="ShowFastTrack()">
					var disp, fasttrack = document.getElementById('FastTrack').checked;
					if(fasttrack) { disp = 'none' } else { disp = '' }
					document.getElementById('ComputersRow').style.display = disp;
					document.getElementById('MoneyRow').style.display = disp;
					document.getElementById('UniversityRow').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="formatCurrency(num)">
					num = num.toString().replace(/\$|\,/g,'');
					if(isNaN(num))
					num = "0";
					sign = (num == (num = Math.abs(num)));
					num = Math.floor(num*100+0.50000000001);
					cents = num%100;
					num = Math.floor(num/100).toString();
					if(cents&lt;10)
					cents = "0" + cents;
					for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
					num = num.substring(0,num.length-(4*i+3))+','+
					num.substring(num.length-(4*i+3));
					return (((sign)?'':'-') + '$' + num + '.' + cents);
					//return (((sign)?'':'-') + '$' + num);
				</WTFUNCTION>

				<WTLOAD>ShowPrice();</WTLOAD>
				
				<WTSTATIC label="IsAgree2"/>
				<WTSTATIC label="FastTrack"/>
				<WTSTATIC label="ZowMoney"/>
				<WTSTATIC label="ZowUniversity"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="2"/>
						<WTSTATIC label="OnFastTrack" fontcolor="blue">
							<WTCONDITION expr="ATTR(Member.IsMaster)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="SuccessfulChange" value="ATTR(Member.Price)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(2)"/>
						<WTSTATIC col="1" merge="2" label="FastTrackCharge" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Continue)" align="center"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Member.IsMaster)" oper="equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left" bold="true">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(FastTrack)">
										<WTCLICK>ShowFastTrack();ShowPrice();</WTCLICK>
									</WTCHECK>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left">
								<WTSTATIC space="5"/><WTSTATIC space="5"/>
								<WTSTATIC label="FastTrack1"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left">
								<WTSTATIC space="5"/><WTSTATIC space="5"/>
								<WTSTATIC label="FastTrack2"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left">
								<WTSTATIC space="5"/><WTSTATIC space="5"/>
								<WTSTATIC label="FastTrack3"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left">
								<WTSTATIC space="5"/><WTSTATIC space="5"/>
								<WTSTATIC label="FastTrack4"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left">
								<WTSTATIC space="5"/><WTSTATIC space="5"/>
								<WTSTATIC label="FastTrack5"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" align="left">
								<WTSTATIC space="5"/><WTSTATIC space="5"/>
								<WTSTATIC label="FastTrack6"/>
							</WTSTATIC>
						</WTROW>


					</WTCODEGROUP>
					<WTROW>
						<WTCONDITION expr="ATTR(Member.IsMaster)" oper="not-equal" value="CONST(0)"/>
						<WTHIDDEN value="PARAM(FastTrack)"/>
					</WTROW>

					<WTROW margin-top="18" id="ComputersRow">
						<WTSTATIC col="1" align="right">
							<WTSTATIC label="OR" bold="true" fontsize="4" space="2">
								<WTCONDITION expr="ATTR(Member.IsMaster)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC col="2" align="left">
							<WTSTATIC label="ComputersText1" bold="true" space="1"/>
							<WTCODEGROUP>
								<WTCOMBO value="PARAM(Computers)" translate="false">
									<WTCHANGE>ShowPrice();</WTCHANGE>
									<WTOPTION id="0" label="Computers0">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(0)"/>
									</WTOPTION>
									<WTOPTION id="1" label="Computers1">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(1)"/>
									</WTOPTION>
									<WTOPTION id="2" label="Computers2">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(2)"/>
									</WTOPTION>
									<WTOPTION id="3" label="Computers3">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(3)"/>
									</WTOPTION>
									<WTOPTION id="4" label="Computers4">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(4)"/>
									</WTOPTION>
									<WTOPTION id="5" label="Computers5">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(5)"/>
									</WTOPTION>
									<WTOPTION id="6" label="Computers6">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(6)"/>
									</WTOPTION>
									<WTOPTION id="7" label="Computers7">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(7)"/>
									</WTOPTION>
									<WTOPTION id="8" label="Computers8">
										<WTCONDITION expr="PARAM(ActiveComputers)" oper="less-equal" value="CONST(8)"/>
									</WTOPTION>
								</WTCOMBO>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW id="MoneyRow" margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" align="left" bold="true">
							<WTCODEGROUP>
								<WTCHECK value="PARAM(ZowMoney)">
									<WTCLICK>ShowPrice();</WTCLICK>
								</WTCHECK>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW id="UniversityRow" margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" align="left" bold="true">
							<WTCODEGROUP>
								<WTCHECK value="PARAM(ZowUniversity)">
									<WTCLICK>ShowPrice();</WTCLICK>
								</WTCHECK>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="6">
						<WTTEXT col="1" merge="2" align="center" name="Price" value="ATTR(Member.Price)" style="BORDER:none; COLOR:blue; BACKGROUND:#e7e7e6; TEXT-ALIGN:center; FONT-BOLD:true;"/>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr = "ATTR(Member.BillingID)" oper="equal" value="CONST(0)" />
						<WTROW margin-top="12" id="Agree2">
							<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW id="Payment">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="750" align="center"/>

								<WTROW margin-top="12" margin-bottom="12">
									<WTDIVIDER col="1" height="1" color="#584b42"/>
								</WTROW>
								<WTROW id="Pay2" margin-bottom="6">
									<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="6">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="CardRows"> 
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="12" label="2012"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="BillingAddress" />
									<WTTEXT col="2" value="PARAM(Street1b)" size="60">
										<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left" required="true">
										<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Change)" align="center"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Customer Enrollment Page for CloudZow! -->
		<!--============================================================================================-->
		<WTWEBPAGE name="trial" caption="Try CloudZow" navbar="false" header="false" footer="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="trial">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="NewMemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="Computers" datatype="number"/>

			<WTPARAM name="M" datatype="number"/>

			<WTPARAM name="P" datatype="number"/>   <!-- force payment - no free trial -->
			<WTPARAM name="Pay" datatype="number"/> <!-- force payment - no free trial -->
			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			
			<WTPARAM name="First1" datatype="text"/>
			<WTPARAM name="Last1" datatype="text"/>
			<WTPARAM name="Email1" datatype="text"/>
			<WTPARAM name="Password1" datatype="text"/>
			<WTPARAM name="First2" datatype="text"/>
			<WTPARAM name="Last2" datatype="text"/>
			<WTPARAM name="Email2" datatype="text"/>
			<WTPARAM name="Password2" datatype="text"/>
			<WTPARAM name="First3" datatype="text"/>
			<WTPARAM name="Last3" datatype="text"/>
			<WTPARAM name="Email3" datatype="text"/>
			<WTPARAM name="Password3" datatype="text"/>
			<WTPARAM name="First4" datatype="text"/>
			<WTPARAM name="Last4" datatype="text"/>
			<WTPARAM name="Email4" datatype="text"/>
			<WTPARAM name="Password4" datatype="text"/>
			<WTPARAM name="First5" datatype="text"/>
			<WTPARAM name="Last5" datatype="text"/>
			<WTPARAM name="Email5" datatype="text"/>
			<WTPARAM name="Password5" datatype="text"/>
			<WTPARAM name="First6" datatype="text"/>
			<WTPARAM name="Last6" datatype="text"/>
			<WTPARAM name="Email6" datatype="text"/>
			<WTPARAM name="Password6" datatype="text"/>
			<WTPARAM name="First7" datatype="text"/>
			<WTPARAM name="Last7" datatype="text"/>
			<WTPARAM name="Email7" datatype="text"/>
			<WTPARAM name="Password7" datatype="text"/>
			<WTPARAM name="First8" datatype="text"/>
			<WTPARAM name="Last8" datatype="text"/>
			<WTPARAM name="Email8" datatype="text"/>
			<WTPARAM name="Password8" datatype="text"/>
			<WTPARAM name="First9" datatype="text"/>
			<WTPARAM name="Last9" datatype="text"/>
			<WTPARAM name="Email9" datatype="text"/>
			<WTPARAM name="Password9" datatype="text"/>
			<WTPARAM name="First10" datatype="text"/>
			<WTPARAM name="Last10" datatype="text"/>
			<WTPARAM name="Email10" datatype="text"/>
			<WTPARAM name="Password10" datatype="text"/>
			<WTPARAM name="First11" datatype="text"/>
			<WTPARAM name="Last11" datatype="text"/>
			<WTPARAM name="Email11" datatype="text"/>
			<WTPARAM name="Password11" datatype="text"/>
			<WTPARAM name="First12" datatype="text"/>
			<WTPARAM name="Last12" datatype="text"/>
			<WTPARAM name="Email12" datatype="text"/>
			<WTPARAM name="Password12" datatype="text"/>
			<WTPARAM name="First13" datatype="text"/>
			<WTPARAM name="Last13" datatype="text"/>
			<WTPARAM name="Email13" datatype="text"/>
			<WTPARAM name="Password13" datatype="text"/>
			<WTPARAM name="First14" datatype="text"/>
			<WTPARAM name="Last14" datatype="text"/>
			<WTPARAM name="Email14" datatype="text"/>
			<WTPARAM name="Password14" datatype="text"/>
			<WTPARAM name="First15" datatype="text"/>
			<WTPARAM name="Last15" datatype="text"/>
			<WTPARAM name="Email15" datatype="text"/>
			<WTPARAM name="Password15" datatype="text"/>
			<WTPARAM name="First16" datatype="text"/>
			<WTPARAM name="Last16" datatype="text"/>
			<WTPARAM name="Email16" datatype="text"/>
			<WTPARAM name="Password16" datatype="text"/>
			<WTPARAM name="First17" datatype="text"/>
			<WTPARAM name="Last17" datatype="text"/>
			<WTPARAM name="Email17" datatype="text"/>
			<WTPARAM name="Password17" datatype="text"/>
			<WTPARAM name="First18" datatype="text"/>
			<WTPARAM name="Last18" datatype="text"/>
			<WTPARAM name="Email18" datatype="text"/>
			<WTPARAM name="Password18" datatype="text"/>
			<WTPARAM name="First19" datatype="text"/>
			<WTPARAM name="Last19" datatype="text"/>
			<WTPARAM name="Email19" datatype="text"/>
			<WTPARAM name="Password19" datatype="text"/>
			<WTPARAM name="First20" datatype="text"/>
			<WTPARAM name="Last20" datatype="text"/>
			<WTPARAM name="Email20" datatype="text"/>
			<WTPARAM name="Password20" datatype="text"/>

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="LD_API.asp"/>
			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="BillingProcess.asp"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="AuthorizeToken.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(5)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="PARAM(M)" value="CONST(0)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(P)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Pay)" value="PARAM(P)"/>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(Computers)" value="CONST(1)"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCALLSUB name="LoadLists"/>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadLists">
				<WTCALLSUB name="LoadCountrys">
					<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(5188)"/>
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll5188.htm&quot;)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(5188)"/>
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll2.htm&quot;)">
							<WTCONDITION expr="PARAM(Pay)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll3.htm&quot;)">
							<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(TRIM(.NameFirst + &quot; &quot; + .NameLast))"/>
<WTCUSTOM>
If .Status &lt;&gt; "1" Then
	Response.Write "The Affiliate that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
	Response.End
End If
</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
<!--						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<!--					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>-->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
<!--						<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->

						<WTCODEGROUP>
		 					<WTCONDITION expr="NoErrors"/>
							<WTMETHOD name="Save">
								<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="Add">
								<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
								<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="AddMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)"/>
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)"/>
					<WTSETATTRIBUTE name="ATTR(Phone1)" value="FORM(Phone1)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
						<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEF&quot;)"/>

						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Process)" value="PARAM(Computers)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(reqComputers * 5)"/>

						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Pay)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(14)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(1)"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(5188)"/>
							<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(30)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;MU&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(.Price + 30)"/>
						</WTCODEGROUP>

						<WTMETHOD name="Add">
							<WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)"/>
						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<!-- Create/Update the billing tokens -->
							<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
							<WTCALLSUB name="GetToken reqNewMemberID, reqBillingID, tmpName, .Email, reqProcessor, reqMemberToken, reqToken, reqPayDesc "/>
							<WTCODEGROUP>
	 							<WTCONDITION expr="NoErrors"/>
								<WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(CSTR(reqProcessor) + &quot;-&quot; + CSTR(reqMemberToken))"/>
								<WTMETHOD name="Save">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>

						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(Computers)" oper="not-equal" value="CONST(0)" connector="and"/>
							<!-- Process the first payment -->
							<WTCALLSUB name="GetPayment reqNewMemberID, .Price, reqPayType, reqPayDesc, reqProcessor, reqMemberToken, reqToken"/>
							<WTCODEGROUP>
	 							<WTCONDITION expr="NoErrors"/>
								<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
								<!-- Update Billing Date -->
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
								<WTMETHOD name="Save">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>

					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MachineID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(NewMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Service)" value="SYSCON(MACHINE-SERVICE-BACKUP)"/>
<WTCUSTOM>
			For x = 1 to reqComputers
				First = Request.Form.Item("First" + CSTR(x))
				If (Len(First) &gt; 0) Then
					.Status = 1
					.NameFirst = First
					.NameLast = Request.Form.Item("Last" + CSTR(x))
					.Email = Request.Form.Item("Email" + CSTR(x))
					.Password = Request.Form.Item("Password" + CSTR(x))
					.WebName = "temp"
					If Len(.NameLast) = 0 Then .NameLast = tmpNameLast

					MachineID = CLng(.Add(CLng(reqSysUserID)))
					SetComputerWebName oMachine
					.Save CLng(reqSysUserID)
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
					tmpStatus = .Status
					.Status = 2
					.Qty = 2

					Result = UpdateComputerStatus( oMachine, tmpStatus )
					If Result &lt;&gt; "OK" Then
						DoError -1, CSTR(x), Result
						LogMemberNote reqNewMemberID, "ENROLL COMPUTER ERROR: (" + CSTR(x) + ") " + Result 
					Else
						.Save CLng(reqSysUserID)
						If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If

	'Email Support for new computer limits
	SendEmail reqSysCompanyID, "support@CloudZow.com", "support@CloudZow.com", "limit@CloudZow.com", "", "", "NEW COMPUTER: " + .Email, .NameFirst + " " + .NameLast + " - " + .LiveDriveID + " (" + .Qty + ")"

	'Email Software Installation Instructions
	If (xmlError = "") Then
	Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
	If oHTTP Is Nothing Then
	Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
								url = "http://" + reqSysServerName + reqSysServerPath + "10708.asp?CompanyID=5&amp;MachineID=" &amp; MachineID
								if reqPay &gt; 0 Then url = url + "&amp;pay=1"
								oHTTP.open "GET", url
								oHTTP.send
							End If
							Set oHTTP = Nothing
						End If
					End If
				End If
			Next 
</WTCUSTOM>
				</WTOBJECT>
<WTCUSTOM>
			'Email Customer Welcome
			If (xmlError = "") Then
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					url = "http://" + reqSysServerName + reqSysServerPath + "10707.asp?CompanyID=5&amp;MemberID=" &amp; reqNewMemberID
					if reqPay &gt; 0 Then url = url + "&amp;pay=1"
					oHTTP.open "GET", url
					oHTTP.send
				End If
				Set oHTTP = Nothing
			End If
</WTCUSTOM>
					<!-- Send notice to Referrer -->
				<WTCODEGROUP>
 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?Customer=1&amp;MemberID=" &amp; reqNewMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
				</WTCODEGROUP>
				<!-- New Paying Customer Activation Processing -->
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10125" message="Oops, Please enter a First Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10126" message="Oops, Please enter a Last Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpEmail))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(First1)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10131" message="Oops, Please enter at least one personal computer."/>
				</WTCODEGROUP>

				<WTOBJECT name="Machine" project="ptsMachineUser" class="CMachine">
					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
			For x = 1 to reqComputers
				First = Request.Form.Item("First" + CSTR(x))
				If (Len(First) &gt; 0) Then
					Email = Request.Form.Item("Email" + CSTR(x))
					Password = Request.Form.Item("Password" + CSTR(x))

					If (xmlError = "") Then
						.FetchEmail Email
						If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
						If (CLng(.MachineID) &lt;&gt; 0) Then
							DoError 10123, CSTR(x), "Oops, This email address is already assigned to another computer."
						End If
					End If
					If (xmlError = "") Then
						If (LEN(Password) &lt; 6) Then
							DoError 10124, CSTR(x), "Oops, Please enter at least 6 characters for the Password."
						End If
					End If
					If (xmlError &lt;&gt; "") Then x = 21
				End If
			Next
</WTCUSTOM>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
					<WTERROR number="10128" message="Oops, You must agree to be billed monthly."/>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETCACHE name="CUSTOMER" value="PARAM(NewMemberID)"/>
					<WTRETURN>
						<WTLINK name="10711" nodata="true">
							<WTPARAM name="MemberID" value="PARAM(NewMemberID)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="right" />
				<WTCOLUMN width="550" align="left" />

				<WTFUNCTION name="ValidFirst(id)">
					var obj, first, last, email;
					obj = document.getElementById('First'+id);
					first = obj.value;
					last = document.getElementById('Last'+id).value;
					email = document.getElementById('Email'+id).value;
					if ( first == "" &amp;&amp; ( last != "" || email != "" ) )
					   alert("#" + id + " first name is required");
					if ( first != "" )
						TitleCase(obj);
				</WTFUNCTION>
				<WTFUNCTION name="ValidLast(id)">
					var obj, first, last, email;
					first = document.getElementById('First'+id).value;
					obj = document.getElementById('Last'+id);
					last = obj.value;
					email = document.getElementById('Email'+id).value;
					if ( last == "" &amp;&amp; ( first != "" || email != "" ) )
					   alert("#" + id + " last name is required");
					if ( last != "" ) {
						TitleCase(obj);
						if ( first == "" )
							alert("#" + id + " first name is required");
					}	
				</WTFUNCTION>
				<WTFUNCTION name="ValidEmail(id)">
					var first, last, email, bad=0;
					first = document.getElementById('First'+id).value;
					last = document.getElementById('Last'+id).value;
					email = document.getElementById('Email'+id).value.toLowerCase();
					if ( email == "" &amp;&amp; first != "" )
					   alert("#" + id + " email address is required");
					if ( email != "" ) {
						var filter  = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
						//var filter = [a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[A-Z]{2}|com|org|net|edu|gov|mil|biz|info|mobi|name|aero|asia|jobs|museum)\b;
						if (! filter.test(email)) {
							alert("#" + id + " invalid email address");
							bad = 1;
						}	
						var i=1, disp;
						for (i=1; i&lt;=20; i++)
						{
							if( i != id ) {
								if( email == document.getElementById('Email' + i).value.toLowerCase() )
									bad=1;
							}	
							if( bad == 1 ) i=21;
						}
						if( bad == 1 ) { alert("Each computer email address must be unique."); }
						if ( first == "" ) { alert("#" + id + " first name is required"); }
						if ( last == "" ) {	alert("#" + id + " last name is required"); }
					}
				</WTFUNCTION>
				<WTFUNCTION name="ValidPassword(id)">
					email = document.getElementById('Email'+id).value;
					var pswd = document.getElementById('Password'+id).value;
					if ( email != '' &amp;&amp; pswd.length &lt; 6 )
					   alert("#" + id + " password must be at least 6 characters long");
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">	
					var val = obj.value;
					if ( val.length == 2 ) {
						obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {					
						obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowComputers()">
					var computers = document.getElementById('Computers').value;
					var i=1, disp;
					for (i=1; i&lt;=20; i++)
					{
						if( i &lt;= computers ) { disp = ''; } else { disp = 'none'; }
						document.getElementById('Computer' + i).style.display = disp;
					}
				</WTFUNCTION>

				<WTLOAD>ShowComputers();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(Processor)"/>
					<WTHIDDEN value="PARAM(MemberToken)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-top="12" margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>

				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="NameFirst"/>
					<WTTEXT col="2" value="ATTR(Member.NameFirst)" size="40" focus="true" required="true" style="height=28px; padding=4px 0">
						<WTEXIT>TitleCase(this); document.getElementById('First1').value = this.value;</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="NameLast"/>
					<WTTEXT col="2" value="ATTR(Member.NameLast)" label="NameLast" size="40" required="true" style="height=28px; padding=4px 0">
						<WTEXIT>TitleCase(this); document.getElementById('Last1').value = this.value;</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Member.Email)" size="40" required="true" style="height=28px; padding=4px 0">
						<WTEXIT>document.getElementById('Email1').value = this.value;</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Phone1"/>
					<WTTEXT col="2" value="ATTR(Member.Phone1)" size="40" required="false" style="height=28px; padding=4px 0"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTCODEGROUP><WTIMAGE value="CONST(Machine48.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="3"/>
						<WTSTATIC tag="ComputersText1" bold="true"/>
					</WTSTATIC>
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTCOMBO value="PARAM(Computers)" translate="false" style="font:12pt;">
								<WTCHANGE>ShowComputers();</WTCHANGE>
								<WTOPTION id="1" label="1Computer"/>
								<WTOPTION id="2" label="2Computers"/>
								<WTOPTION id="3" label="3Computers"/>
								<WTOPTION id="4" label="4Computers"/>
								<WTOPTION id="5" label="5Computers"/>
								<WTOPTION id="6" label="6Computers"/>
								<WTOPTION id="7" label="7Computers"/>
								<WTOPTION id="8" label="8Computers"/>
								<WTOPTION id="9" label="9Computers"/>
								<WTOPTION id="10" label="10Computers"/>
								<WTOPTION id="11" label="11Computers"/>
								<WTOPTION id="12" label="12Computers"/>
								<WTOPTION id="13" label="13Computers"/>
								<WTOPTION id="14" label="14Computers"/>
								<WTOPTION id="15" label="15Computers"/>
								<WTOPTION id="16" label="16Computers"/>
								<WTOPTION id="17" label="17Computers"/>
								<WTOPTION id="18" label="18Computers"/>
								<WTOPTION id="19" label="19Computers"/>
								<WTOPTION id="20" label="20Computers"/>
							</WTCOMBO>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="ComputersText2" bold="true"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42" />
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="AddComputers" align="left" class="PageHeading"/>
				</WTROW>
				<WTROW>
				<WTTABLE col="1" merge="2">
					<WTCOLUMN width="100" align="left" />
					<WTCOLUMN width="150" align="left" />
					<WTCOLUMN width="150" align="left" />
					<WTCOLUMN width="200" align="left" />
					<WTCOLUMN width="150" align="left" />

					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" label="NameFirst" bold="true"/>
						<WTSTATIC col="3" label="NameLast" bold="true"/>
						<WTSTATIC col="4" label="Logon" bold="true"/>
						<WTSTATIC col="5" label="Password" bold="true"/>
					</WTROW>
					<WTROW id="Computer1" height="36">
						<WTSTATIC col="1" value="CONST(Computer #1)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First1)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(1);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last1)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(1);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email1)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(1);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password1)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(1);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer2" height="36">
						<WTSTATIC col="1" value="CONST(Computer #2)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First2)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(2);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last2)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(2);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email2)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(2);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password2)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(2);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer3" height="36">
						<WTSTATIC col="1" value="CONST(Computer #3)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First3)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(3);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last3)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(3);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email3)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(3);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password3)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(3);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer4" height="36">
						<WTSTATIC col="1" value="CONST(Computer #4)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First4)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(4);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last4)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(4);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email4)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(4);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password4)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(4);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer5" height="36">
						<WTSTATIC col="1" value="CONST(Computer #5)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First5)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(5);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last5)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(5);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email5)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(5);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password5)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(5);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer6" height="36">
						<WTSTATIC col="1" value="CONST(Computer #6)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First6)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(6);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last6)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(6);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email6)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(6);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password6)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(6);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer7" height="36">
						<WTSTATIC col="1" value="CONST(Computer #7)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First7)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(7);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last7)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(7);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email7)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(7);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password7)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(7);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer8" height="36">
						<WTSTATIC col="1" value="CONST(Computer #8)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First8)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(8);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last8)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(8);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email8)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(8);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password8)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(8);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer9" height="36">
						<WTSTATIC col="1" value="CONST(Computer #9)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First9)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(9);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last9)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(9);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email9)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(9);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password9)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(9);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer10" height="36">
						<WTSTATIC col="1" value="CONST(Computer #10)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First10)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(10);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last10)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(10);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email10)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(10);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password10)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(10);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer11" height="36">
						<WTSTATIC col="1" value="CONST(Computer #11)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First11)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(11);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last11)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(11);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email11)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(11);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password11)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(11);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer12" height="36">
						<WTSTATIC col="1" value="CONST(Computer #12)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First12)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(12);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last12)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(12);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email12)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(12);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password12)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(12);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer13" height="36">
						<WTSTATIC col="1" value="CONST(Computer #13)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First13)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(13);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last13)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(13);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email13)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(13);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password13)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(13);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer14" height="36">
						<WTSTATIC col="1" value="CONST(Computer #14)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First14)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(14);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last14)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(14);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email14)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(14);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password14)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(14);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer15" height="36">
						<WTSTATIC col="1" value="CONST(Computer #15)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First15)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(15);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last15)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(15);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email15)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(15);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password15)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(15);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer16" height="36">
						<WTSTATIC col="1" value="CONST(Computer #16)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First16)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(16);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last16)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(16);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email16)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(16);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password16)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(16);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer17" height="36">
						<WTSTATIC col="1" value="CONST(Computer #17)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First17)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(17);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last17)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(17);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email17)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(17);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password17)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(17);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer18" height="36">
						<WTSTATIC col="1" value="CONST(Computer #18)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First18)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(18);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last18)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(18);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email18)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(18);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password18)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(18);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer19" height="36">
						<WTSTATIC col="1" value="CONST(Computer #19)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First19)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(19);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last19)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(19);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email19)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(19);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password19)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(19);</WTEXIT></WTTEXT>
					</WTROW>
					<WTROW id="Computer20" height="36">
						<WTSTATIC col="1" value="CONST(Computer #20)" bold="true"/>
						<WTTEXT col="2" value="PARAM(First20)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidFirst(20);</WTEXIT></WTTEXT>
						<WTTEXT col="3" value="PARAM(Last20)" size="19" maxlength="15" style="height=28px; padding=4px 0"><WTEXIT>ValidLast(20);</WTEXIT></WTTEXT>
						<WTTEXT col="4" value="PARAM(Email20)" size="28" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidEmail(20);</WTEXIT></WTTEXT>
						<WTTEXT col="5" value="PARAM(Password20)" size="25" maxlength="80" style="height=28px; padding=4px 0"><WTEXIT>ValidPassword(20);</WTEXIT></WTTEXT>
					</WTROW>
				</WTTABLE>
				</WTROW>
				
				<!-- === Payment ========================================================= -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="#584b42" />
					</WTROW>
					<WTROW id="Pay2" margin-bottom="12">
						<WTSTATIC col="1" merge="2" align="left" label="PaymentText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="PARAM(PayType)"/>
					</WTROW>
					<WTROW id="Pay3" margin-bottom="6">
				 		<WTSTATIC col="1"/>
				 		<WTSTATIC col="2" align="left">
				 			<WTCODEGROUP>
								<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(1);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
								<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(2);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
								<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(3);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
								<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(4);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 		</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardNumber"/>
						<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
							<WTEXIT>var x = this.value; this.value = x.replace(/[^\d]/g, '');</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardDate"/>
						<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
							<WTOPTION id="" label="Select"/>
							<WTOPTION id="1" label="January"/>
							<WTOPTION id="2" label="February"/>
							<WTOPTION id="3" label="March"/>
							<WTOPTION id="4" label="April"/>
							<WTOPTION id="5" label="May"/>
							<WTOPTION id="6" label="June"/>
							<WTOPTION id="7" label="July"/>
							<WTOPTION id="8" label="August"/>
							<WTOPTION id="9" label="September"/>
							<WTOPTION id="10" label="October"/>
							<WTOPTION id="11" label="November"/>
							<WTOPTION id="12" label="December"/>
						</WTCOMBO>
						<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
							<WTOPTION id="" label="Select"/>
							<WTOPTION id="12" label="2012"/>
							<WTOPTION id="13" label="2013"/>
							<WTOPTION id="14" label="2014"/>
							<WTOPTION id="15" label="2015"/>
							<WTOPTION id="16" label="2016"/>
							<WTOPTION id="17" label="2017"/>
							<WTOPTION id="18" label="2018"/>
							<WTOPTION id="19" label="2019"/>
							<WTOPTION id="20" label="2020"/>
							<WTOPTION id="21" label="2021"/>
							<WTOPTION id="22" label="2022"/>
							<WTOPTION id="23" label="2023"/>
							<WTOPTION id="24" label="2024"/>
							<WTOPTION id="25" label="2025"/>
						</WTCOMBO>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardName"/>
						<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardCode"/>
						<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
							<WTEXIT>FormatCardCode(this);</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="2">
							<WTCODEGROUP>
								<WTTOOLTIP>
									<WTIMAGE value="CONST(SymbolHelp.gif)"/>
									<WTTIP>
										<WTIMAGE value="CONST(SecurityCode.png)"/>
									</WTTIP>
								</WTTOOLTIP>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<WTROW>
						<WTSTATIC col="1" tag="BillingAddress" />
						<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60">
							<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="25" align="left">
							<WTEXIT>if(this.value==''){alert('Oops, City Required!');}else{TitleCase(this);}</WTEXIT>
						</WTTEXT>
						<WTTEXT col="2" value="ATTR(Billing.State)" width="350" label="State" size="25" align="left">
							<WTEXIT>if(this.value==''){alert('Oops, State Required!');}else{TitleCase(this);}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10" align="left">
							<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')}</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="450" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
					</WTROW>
					
					<WTROW id="Secure" margin-top="12">
						<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW id="Agree2">
						<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
							<WTCODEGROUP><WTCHECK value="PARAM(IsAgree2)"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue">
						<WTCODEGROUP><WTCHECK value="PARAM(IsAgree)"/></WTCODEGROUP>
					</WTSTATIC>
					<WTSTATIC col="1" merge="2" label="IsAgreeText">
						<WTLINK name="Page" target="Terms">
							<WTPARAM name="page" value="CONST(terms)"/>
						</WTLINK>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(StartTrial)" align="center">
						<WTCONDITION expr="PARAM(Pay)" oper="equal" value="CONST(0)"/>
						<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(StartNow)" align="center">
						<WTCONDITION expr="PARAM(Pay)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" merge="2" align="center" bold="true">
						<WTSTATIC tag="ReferredBy"/>
						<WTSTATIC value="PARAM(ReferredBy)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW height="48">
					<WTSTATIC col="1" space="1"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Customer Payment Page for Machine! -->
		<!--============================================================================================-->
		<WTWEBPAGE name="trialp" caption="Customer Payment" navbar="false" footer="false" focus="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="trialp">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>

			<WTINCLUDE name="LD_API.asp"/>
			<WTINCLUDE name="BillingProcess.asp"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="AuthorizeToken.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(5)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadCountrys"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
<!--						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<!--					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>-->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
<!--						<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)" />-->
						<WTCODEGROUP>
		 					<WTCONDITION expr="NoErrors"/>
							<WTMETHOD name="Save">
								<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="Add">
								<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
								<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>
			
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="UpdateMember">
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<!-- Create/Update the billing tokens -->
						<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot;, &quot; + .NameLast)"/>
						<WTCALLSUB name="GetToken reqMemberID, reqBillingID, tmpName, .Email, reqProcessor, reqMemberToken, reqToken, reqPayDesc "/>
						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(CSTR(reqProcessor) + &quot;-&quot; + CSTR(reqMemberToken))"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<!-- Process the first payment -->
						<WTCALLSUB name="GetPayment reqMemberID, .Price, reqPayType, reqPayDesc, reqProcessor, reqMemberToken, reqToken"/>
						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
							<!-- Update Billing Date -->
							<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?Customer=1&amp;MemberID=" + CSTR(reqMemberID)
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>

				<!-- New Paying Customer Activation Processing -->
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="CONST(4)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;Paid Customer from free trial&quot;)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->					
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadCountrys"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10128" message="Oops, You must agree to be billed monthly."/>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="UpdateMember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="Trialr">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="540" align="left"/>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
						//var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype = payobj.value; 
						//var l = payobj.length;
						//for( i = 0; i &lt; l; i++ ) {
						//	if (payobj[i].checked) {
						//		paytype = payobj[i].value;
						//		i = l;
						//	}
						//}
						//if (paytype == 5) {
						//	if ( countryid != 224 ) {
						//		paytype = 1;
						//		document.getElementById('PayType').value = paytype;
						//		alert("Electronic Checks not available outside the United States");
						//	}
						//}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
						ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="TitleCase(obj)">	
					var val = obj.value;
					if ( val.length == 2 ) {
						obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {					
						obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatCardCode(obj)">	
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
						alert('Oops, Invalid Security Code'); 
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(Processor)"/>
					<WTHIDDEN value="PARAM(MemberToken)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>

				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="Checkout" space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="TotalComputers" space="1"/>
						<WTSTATIC value="ATTR(Member.Process)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="TotalPrice" space="1"/>
						<WTSTATIC value="ATTR(Member.Price)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" align="center" bold="true"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW id="CardRows">
					<WTSTATIC col="1"/>
					<WTTABLE col="2" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="540" align="left"/>
						<WTROW>
							<WTHIDDEN value="PARAM(PayType)"/>
						</WTROW>
						<WTROW margin-bottom="6">
				 			<WTSTATIC col="1"/>
				 			<WTSTATIC col="2">
				 				<WTCODEGROUP>
									<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(1);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
									<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(2);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
									<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(3);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
									<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(4);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 			</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
								<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
								<WTOPTION id="" label="Select"/>
								<WTOPTION id="1" label="January"/>
								<WTOPTION id="2" label="February"/>
								<WTOPTION id="3" label="March"/>
								<WTOPTION id="4" label="April"/>
								<WTOPTION id="5" label="May"/>
								<WTOPTION id="6" label="June"/>
								<WTOPTION id="7" label="July"/>
								<WTOPTION id="8" label="August"/>
								<WTOPTION id="9" label="September"/>
								<WTOPTION id="10" label="October"/>
								<WTOPTION id="11" label="November"/>
								<WTOPTION id="12" label="December"/>
							</WTCOMBO>
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
								<WTOPTION id="" label="Select"/>
								<WTOPTION id="12" label="2012"/>
								<WTOPTION id="13" label="2013"/>
								<WTOPTION id="14" label="2014"/>
								<WTOPTION id="15" label="2015"/>
								<WTOPTION id="16" label="2016"/>
								<WTOPTION id="17" label="2017"/>
								<WTOPTION id="18" label="2018"/>
								<WTOPTION id="19" label="2019"/>
								<WTOPTION id="20" label="2020"/>
								<WTOPTION id="21" label="2021"/>
								<WTOPTION id="22" label="2022"/>
								<WTOPTION id="23" label="2023"/>
								<WTOPTION id="24" label="2024"/>
								<WTOPTION id="25" label="2025"/>
							</WTCOMBO>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
								<WTEXIT>FormatCardCode(this);</WTEXIT>
							</WTTEXT>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTTOOLTIP>
										<WTIMAGE value="CONST(SymbolHelp.gif)"/>
										<WTTIP>
											<WTIMAGE value="CONST(SecurityCode.png)"/>
										</WTTIP>
									</WTTOOLTIP>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1" tag="BillingAddress" />
							<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60">
								<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="25" align="left">
								<WTEXIT>if(this.value==''){alert('Oops, City Required!');}else{TitleCase(this);}</WTEXIT>
							</WTTEXT>
							<WTTEXT col="2" value="ATTR(Billing.State)" width="340" label="State" size="25" align="left">
								<WTEXIT>if(this.value==''){alert('Oops, State Required!');}else{TitleCase(this);}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10" align="left">
								<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')}</WTEXIT>
							</WTTEXT>
							<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="440" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-top="18">
					<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
					<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="3" value="CONST(Submit)" align="center">
						<WTCLICK>doSubmit(2,''); this.disabled = true</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Customer Receipt Page for Machine! -->
		<!--============================================================================================-->
		<WTWEBPAGE name="trialr" caption="Payment Receipt" navbar="false" header="ReportHeader" footer="false" focus="false"  stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="trialr">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Total" datatype="currency"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;XXXXXXXXXXXX&quot; &amp; Right(.CardNumber, 4))"/>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;XXX&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Machines" project="ptsMachineUser" class="CMachines">
					<WTMETHOD name="List">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
<WTCUSTOM>
				reqCount = 0
				reqTotal = 0
				For Each oMachine in oMachines
					With oMachine
						If .Status &lt;= 2 Then
							reqCount = reqCount + 1
							Select Case .Service
							Case 1
								tmpPrice = 5
							Case 2
								tmpPrice = 15
							End Select	
							reqTotal = reqTotal + tmpPrice
							.WebName = FormatCurrency(tmpPrice)
						End If
					End With
				Next
				reqTotal = FormatCurrency(reqTotal)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMachines" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="500" align="left"/>

				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>
				<WTSTATIC label="Amex"/>
				<WTSTATIC label="Discover"/>
				<WTSTATIC label="Backup"/>
				<WTSTATIC label="Backpack"/>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="PaymentReceipt" align="center" fontsize="4" class="PageHeading"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="3"/>
						<WTSTATIC value="ATTR(Member.Email)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTCODEGROUP>	
					<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
					<WTROW>
						<WTSTATIC col="1" tag="CardType"/>
						<WTSTATIC col="2" value="ATTR(Billing.CardType)" enum="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardNumber"/>
						<WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardDate"/>
						<WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
						<WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardName"/>
						<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
					</WTROW>
<!--					
					<WTROW>
						<WTSTATIC col="1" tag="CardCode"/>
						<WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
					</WTROW>
-->					
					<WTROW>
						<WTSTATIC col="1" tag="BillingAddress" />
						<WTSTATIC col="2" value="ATTR(Billing.Street1)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CityStateZip"/>
						<WTSTATIC col="2" value="ATTR(Billing.City)"/>
						<WTSTATIC col="2" value="ATTR(Billing.State)"/>
						<WTSTATIC col="2" value="ATTR(Billing.Zip)"/>
					</WTROW>
				</WTCODEGROUP>	

				<WTCODEGROUP>	
					<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(2)"/>
					<WTROW>
						<WTSTATIC col="1" tag="CheckBank"/>
						<WTSTATIC col="2" value="ATTR(Billing.CheckBank)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckRoute"/>
						<WTSTATIC col="2" value="ATTR(Billing.CheckRoute)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckAccount"/>
						<WTSTATIC col="2" value="ATTR(Billing.CheckAccount)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckNumber"/>
						<WTSTATIC col="2" value="ATTR(Billing.CheckNumber)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckName"/>
						<WTSTATIC col="2" value="ATTR(Billing.CheckName)"/>
					</WTROW>
				</WTCODEGROUP>	

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Machine">
						<WTCOLUMN width="30" align="left" label="UserName"/>
						<WTCOLUMN width="30" align="left" label="Email"/>
						<WTCOLUMN width="17" align="left" label="Password"/>
						<WTCOLUMN width="13" align="left" label="Service"/>
						<WTCOLUMN width="10" align="right" label="Price"/>

						<WTROW height="18">
							<WTSTATIC col="1">
								<WTCODEGROUP><WTIMAGE value="CONST(MachineStatus&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Machine.NameFirst)" space="1"/>
								<WTSTATIC value="DATA(Machine.NameLast)" space="1"/>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Machine.Email)"/>
							<WTSTATIC col="3" value="DATA(Machine.Password)"/>
							<WTSTATIC col="4" value="DATA(Machine.Service)" enum="true"/>
							<WTSTATIC col="5" value="DATA(Machine.WebName)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="300" align="left"/>
						<WTCOLUMN width="285" align="right"/>
						<WTCOLUMN width="65" align="right"/>
						<WTROW margin-top="6">
							<WTSTATIC col="1" tag="ActiveMachines" value="PARAM(Count)" bold="true"/>
							<WTSTATIC col="2" tag="Total" bold="true"/>
							<WTSTATIC col="3" value="PARAM(Total)" bold="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="24" margin-bottom="24">
					<WTSTATIC col="1" merge="2" align="center" label="PrintReceipt" bold="true"/>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.parent.opener.location.reload();window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="Stats" caption="CloudZow Stats" header="false" footer="false" navbar="false" action="0"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="Stats">
		<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
<WTCUSTOM>
		If reqDay &gt; 0 Then reqToday = DateAdd("d", reqDay * -1, reqSysDate) Else reqToday = reqSysDate
		Select Case DATEPART("w", reqToday )
			Case 1 reqToday = reqToday &amp; " Sunday"
			Case 2 reqToday = reqToday &amp; " Monday"
			Case 3 reqToday = reqToday &amp; " Tuesday"
			Case 4 reqToday = reqToday &amp; " Wednesday"
			Case 5 reqToday = reqToday &amp; " Thursday"
			Case 6 reqToday = reqToday &amp; " Friday"
			Case 7 reqToday = reqToday &amp; " Saturday"
		End Select
</WTCUSTOM>			
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(7)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="center"/>
				<WTCOLUMN width="6" align="center"/>
				<WTCOLUMN width="300" align="center"/>
				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP><WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="MachineStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Enrollments"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Resellers" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.RToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.RWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.RTotal)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Affiliates" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.AToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.AWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.ATotal)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="FastStarts" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.FToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.FWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.FTotal)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Customers" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.CToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.CWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.CTotal)"/>
								</WTROW>
								
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Computers"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Resellers" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.RCToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.RCWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.RCTotal)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Affiliates" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.ACToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.ACWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.ACTotal)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Customers" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.CCToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.CCWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.CCTotal)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="AverageComputers"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Resellers" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.RCAToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.RCAWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.RCATotal)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Affiliates" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.ACAToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.ACAWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.ACATotal)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Customers" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.CCAToday)"/>
									<WTSTATIC col="3" value="ATTR(Stats.CCAWeek)"/>
									<WTSTATIC col="4" value="ATTR(Stats.CCATotal)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
					<WTSTATIC col="2"/>
					<WTTABLE col="3" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Sales"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Today" bold="true" align="center"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.S1)" align="center"/>
									<WTSTATIC col="2" value="ATTR(Stats.S7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.S30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.S99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Customers" bold="true" align="center"/>
									<WTSTATIC col="2" label="Resellers" bold="true"/>
									<WTSTATIC col="3" label="Affiliates" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.SC)" align="center"/>
									<WTSTATIC col="2" value="ATTR(Stats.SR)"/>
									<WTSTATIC col="3" value="ATTR(Stats.SA)"/>
									<WTSTATIC col="4" value="ATTR(Stats.ST)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Trials" bold="true" align="center"/>
									<WTSTATIC col="2"/>
									<WTSTATIC col="3" label="Suspended" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.P1)" align="center"/>
									<WTSTATIC col="2"/>
									<WTSTATIC col="3" value="ATTR(Stats.P2)"/>
									<WTSTATIC col="4" value="ATTR(Stats.PT)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="CustomerConversion"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Trials" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.T7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.T30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.T99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Installs" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.I7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.I30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.I99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="InstallRate" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z7)" fontcolor="blue"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z30)" fontcolor="blue"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z99)" fontcolor="blue"/>
								</WTROW>
								<WTROW>
									<WTDIVIDER col="1" merge="4" height="1" color="CONST(#5084A2)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Customers" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.C7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.C30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.C99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Affiliates" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.A7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.A30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.A99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Conversion" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.V7)" fontcolor="blue"/>
									<WTSTATIC col="3" value="ATTR(Stats.V30)" fontcolor="blue"/>
									<WTSTATIC col="4" value="ATTR(Stats.V99)" fontcolor="blue"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="Money" caption="WealthBuilder" footer="false" navbar="false" secured="41" wrapper="wrapper800"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="Money">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Code" datatype="number"/>
			<WTPARAM name="O" datatype="text"/>

			<!-- O contains 1 ... Display Tax Estimator -->
			<!-- O contains 2 ... Display Business Expense Manager -->
			<!-- O contains 3 ... Display Debt Manager -->
			<!-- O contains 4 ... Display Credit Manager -->
			<!-- O contains 5 ... Display Financial Articles -->

      <WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

      <!-- CHECK FOR ILLEGAL ACCESS -->
      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTCODEGROUP>
				<WTCONDITION expr="PARAM(Code)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Code)" value="CONST(1)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTTAB name="MemberTab">
					<WTITEM label="ViewTaxMgr" width="150">
						<WTCONDITION expr="PARAM(O)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="CONST(InStr(reqO,&quot;1&quot;))" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabTaxMgr',1))"/>
					</WTITEM>
					<WTITEM label="ViewExpMgr" width="150">
						<WTCONDITION expr="PARAM(O)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="CONST(InStr(reqO,&quot;2&quot;))" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabExpMgr',1))"/>
					</WTITEM>
					<WTITEM label="ViewDebtMgr" width="150">
						<WTCONDITION expr="PARAM(O)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="CONST(InStr(reqO,&quot;3&quot;))" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabDebtMgr',1))"/>
					</WTITEM>
					<WTITEM label="ViewCreditMgr" width="150">
						<WTCONDITION expr="PARAM(O)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="CONST(InStr(reqO,&quot;4&quot;))" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabCreditMgr',1))"/>
					</WTITEM>
					<WTITEM label="ViewArticles" width="150">
						<WTCONDITION expr="PARAM(O)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="CONST(InStr(reqO,&quot;5&quot;))" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabArticles',1))"/>
					</WTITEM>
				</WTTAB>

				<WTFUNCTION name="ShowTab(tab, shw)">
					document.getElementById('TabTaxMgr').style.display = 'none';
					document.getElementById('TabExpMgr').style.display = 'none';
					document.getElementById('TabDebtMgr').style.display = 'none';
					document.getElementById('TabCreditMgr').style.display = 'none';
					document.getElementById('TabArticles').style.display = 'none';
					document.getElementById(tab).style.display = '';

					if ( tab == 'TabTaxMgr' ) {
						var src = document.getElementById('TaxMgrFrame').src
						if (src.indexOf("10400.asp") &lt; 0 ) {
							src = '10400.asp?MemberID=' + document.getElementById('MemberID').value 
							document.getElementById('TaxMgrFrame').src = src
						}
					}
					if ( tab == 'TabExpMgr' ) {
						var src = document.getElementById('ExpMgrFrame').src
						if (src.indexOf("6401.asp") &lt; 0 ) {
							src = '6401.asp?MemberID=' + document.getElementById('MemberID').value 
							document.getElementById('ExpMgrFrame').src = src
						}
					}
					if ( tab == 'TabDebtMgr' ) {
						var src = document.getElementById('DebtMgrFrame').src
						if (src.indexOf("10201.asp") &lt; 0 ) {
							src = '10201.asp?MemberID=' + document.getElementById('MemberID').value
							document.getElementById('DebtMgrFrame').src = src
						}
					}
					if ( tab == 'TabCreditMgr' ) {
						var src = document.getElementById('CreditMgrFrame').src
						if (src.indexOf("credit.asp") &lt; 0 ) {
							src = 'credit.asp?MemberID=' + document.getElementById('MemberID').value
							document.getElementById('CreditMgrFrame').src = src
						}
					}
					if ( tab == 'TabArticles' ) {
						var src = document.getElementById('ArticlesFrame').src
						if (src.indexOf("FinancialArticles.htm") &lt; 0 ) {
							src = 'sections/Money/FinanceArticles.htm'
							document.getElementById('ArticlesFrame').src = src
						}
					}
			    </WTFUNCTION>  
				<WTFUNCTION name="LoadTab()">
					var code = document.getElementById('Code').value 
					switch(code)
					{
					case '1':
						MemberTab.setCurrTab('TaxMgr'); 
						ShowTab('TabTaxMgr',0);
						break;    
					case '2':
						MemberTab.setCurrTab('ExpMgr'); 
						ShowTab('TabExpMgr',0);
						break;    
					case '3':
						MemberTab.setCurrTab('DebtMgr'); 
						ShowTab('TabDebtMgr',0);
						break;    
					case '4':
						MemberTab.setCurrTab('CreditMgr'); 
						ShowTab('TabCreditMgr',0);
						break;    
					case '5':
						MemberTab.setCurrTab('Articles'); 
						ShowTab('TabArticles',0);
						break;    
					}
			    </WTFUNCTION>  
				<WTLOAD>
					LoadTab();
				</WTLOAD>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="PARAM(Code)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTCODEGROUP><WTIMAGE value="CONST(ZowMoney.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="2"/>
						<WTSTATIC label="WealthBuilder" fontsize="4" space="1"/>
						<WTSTATIC label="for" space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;))"/>
<!--
						<WTCODEGROUP>
							<WTSTATIC space="3"/>
							<WTBUTTON value="CONST(Close)" align="center" btnclass="smbutton">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTCODEGROUP>
-->						
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" label="CloudMoneyText" class="prompt"/>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTSTATIC col="1" align="left">
						<WTCODEGROUP><WTSTARTTAB name="MemberTab"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW id="TabTaxMgr">
					<WTFRAME col="1" src="" name="TaxMgrFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabExpMgr">
					<WTFRAME col="1" src="" name="ExpMgrFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabDebtMgr">
					<WTFRAME col="1" src="" name="DebtMgrFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabCreditMgr">
					<WTFRAME col="1" src="" name="CreditMgrFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabArticles">
					<WTFRAME col="1" src="" name="ArticlesFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="University" caption="ZowUniversity" footer="false" navbar="false" secured="41" wrapper="wrapper800"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="University">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Code" datatype="number"/>
			
			<!-- Code = 1 ... Display Motivation -->
			<!-- Code = 2 ... Display Leadership -->
			<!-- Code = 3 ... Display Relationship -->
			<!-- Code = 4 ... Display Health -->
			<!-- Code = 5 ... Display Finance -->
			<!-- Code = 6 ... Display Constitution -->
			<!-- Code = 7 ... Display College -->
			
			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Code)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Code)" value="CONST(1)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTTAB name="MemberTab">
					<WTITEM label="ViewMotivation" width="110">
						<WTLINK name="JAVA(ShowTab('TabMotivation',1))"/>
					</WTITEM>
					<WTITEM label="ViewLeadership" width="110">
						<WTLINK name="JAVA(ShowTab('TabLeadership',1))"/>
					</WTITEM>
					<WTITEM label="ViewRelationship" width="110">
						<WTLINK name="JAVA(ShowTab('TabRelationship',1))"/>
					</WTITEM>
					<WTITEM label="ViewHealth" width="110">
						<WTLINK name="JAVA(ShowTab('TabHealth',1))"/>
					</WTITEM>
					<WTITEM label="ViewFinance" width="110">
						<WTLINK name="JAVA(ShowTab('TabFinance',1))"/>
					</WTITEM>
					<WTITEM label="ViewConstitution" width="110">
						<WTLINK name="JAVA(ShowTab('TabConstitution',1))"/>
					</WTITEM>
					<WTITEM label="ViewCollege" width="110">
						<WTLINK name="JAVA(ShowTab('TabCollege',1))"/>
					</WTITEM>
				</WTTAB>

				<WTFUNCTION name="ShowTab(tab, shw)">
					document.getElementById('TabMotivation').style.display = 'none';
					document.getElementById('TabLeadership').style.display = 'none';
					document.getElementById('TabRelationship').style.display = 'none';
					document.getElementById('TabHealth').style.display = 'none';
					document.getElementById('TabFinance').style.display = 'none';
					document.getElementById('TabConstitution').style.display = 'none';
					document.getElementById('TabCollege').style.display = 'none';
					document.getElementById(tab).style.display = '';

					if ( tab == 'TabMotivation' ) {
						var src = document.getElementById('MotivationFrame').src
						if (src.indexOf("Motivation.htm") &lt; 0 ) {
							src = 'http://www.cloudzow.com/sections/company/5/Motivation.htm'
							document.getElementById('MotivationFrame').src = src
						}
					}
					if ( tab == 'TabLeadership' ) {
						var src = document.getElementById('LeadershipFrame').src
						if (src.indexOf("Leadership.htm") &lt; 0 ) {
							src = 'http://www.cloudzow.com/sections/company/5/Leadership.htm'
							document.getElementById('LeadershipFrame').src = src
						}
					}
					if ( tab == 'TabRelationship' ) {
						var src = document.getElementById('RelationshipFrame').src
						if (src.indexOf("Relationship.htm") &lt; 0 ) {
							src = 'http://www.cloudzow.com/sections/company/5/Relationship.htm'
							document.getElementById('RelationshipFrame').src = src
						}
					}
					if ( tab == 'TabHealth' ) {
						var src = document.getElementById('HealthFrame').src
						if (src.indexOf("Health.htm") &lt; 0 ) {
							src = 'http://www.cloudzow.com/sections/company/5/Health.htm'
							document.getElementById('HealthFrame').src = src
						}
					}
					if ( tab == 'TabFinance' ) {
						var src = document.getElementById('FinanceFrame').src
						if (src.indexOf("Finance.htm") &lt; 0 ) {
							src = 'http://www.cloudzow.com/sections/company/5/Finance.htm'
							document.getElementById('FinanceFrame').src = src
						}
					}
					if ( tab == 'TabConstitution' ) {
						var src = document.getElementById('ConstitutionFrame').src
						if (src.indexOf("Constitution.htm") &lt; 0 ) {
							src = 'http://www.cloudzow.com/sections/company/5/Constitution.htm'
							document.getElementById('ConstitutionFrame').src = src
						}
					}
					if ( tab == 'TabCollege' ) {
						var src = document.getElementById('CollegeFrame').src
						if (src.indexOf("College.htm") &lt; 0 ) {
							src = 'http://www.cloudzow.com/sections/company/5/College.htm'
							document.getElementById('CollegeFrame').src = src
						}
					}
			    </WTFUNCTION>  
				<WTFUNCTION name="LoadTab()">
					var code = document.getElementById('Code').value 
					switch(code)
					{
					case '1':
						MemberTab.setCurrTab('Motivation'); 
						ShowTab('TabMotivation',0);
						break;    
					case '2':
						MemberTab.setCurrTab('Leadership'); 
						ShowTab('TabLeadership',0);
						break;    
					case '3':
						MemberTab.setCurrTab('Relationship'); 
						ShowTab('TabRelationship',0);
						break;    
					case '4':
						MemberTab.setCurrTab('Health'); 
						ShowTab('TabHealth',0);
						break;    
					case '5':
						MemberTab.setCurrTab('Finance'); 
						ShowTab('TabFinance',0);
						break;    
					case '6':
						MemberTab.setCurrTab('Constitution'); 
						ShowTab('TabConstitution',0);
						break;    
					case '7':
						MemberTab.setCurrTab('College'); 
						ShowTab('TabCollege',0);
						break;    
					}
			    </WTFUNCTION>  
				<WTLOAD>
					LoadTab();
				</WTLOAD>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="PARAM(Code)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTCODEGROUP><WTIMAGE value="CONST(ZowUniversity.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="2"/>
						<WTSTATIC label="ZowUniversity" fontsize="4" space="1"/>
						<WTSTATIC label="for" space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;))"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" label="CloudUniversityText" class="prompt"/>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTSTATIC col="1" align="left">
						<WTCODEGROUP><WTSTARTTAB name="MemberTab"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW id="TabMotivation">
					<WTFRAME col="1" src="" name="MotivationFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabLeadership">
					<WTFRAME col="1" src="" name="LeadershipFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabRelationship">
					<WTFRAME col="1" src="" name="RelationshipFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabHealth">
					<WTFRAME col="1" src="" name="HealthFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabFinance">
					<WTFRAME col="1" src="" name="FinanceFrame" frmwidth="800" frmheight="2500" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabConstitution">
					<WTFRAME col="1" src="" name="ConstitutionFrame" frmwidth="800" frmheight="2500" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabCollege">
					<WTFRAME col="1" src="" name="CollegeFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
	</WTWEBPAGES>
</WTROOT>