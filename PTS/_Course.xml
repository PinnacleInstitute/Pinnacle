<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="11" name="Course" alias="cs" language="false" audit="false">

<!-- NOTE: Custom SQL for FindOrg() must be updated for field changes -->

		<!--Identity-->
		<WTATTRIBUTE id="1101" name="CourseID" type="number" identity="true" min="1" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="1102" name="CourseCategoryID" type="number" source="entity"/>
		<WTATTRIBUTE id="1103" name="TrainerID" type="number" source="entity"/>
		<WTATTRIBUTE id="1104" name="CompanyID" type="number" source="entity"/> 
		<WTATTRIBUTE id="1105" name="ExamID" type="number" source="entity"/> 

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="1108" name="CourseCategoryName" type="text" length="60" min="1" max="60" source="join">
			<WTJOIN entity="CourseCategory" name="CourseCategoryName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1109" name="TrainerName" type="text" length="60" min="1" max="60" source="join">
			<WTJOIN entity="Trainer" name="CompanyName"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="1110" name="CourseName" type="text" length="80" min="1" max="80" source="entity" title="true" required="true"/>
		<WTATTRIBUTE id="1111" name="Status" type="number" required="true" source="entity">
			<WTENUM id="1" name="Pending"/>
			<WTENUM id="2" name="Review"/>
			<WTENUM id="3" name="Active"/>
			<WTENUM id="4" name="InActive"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1112" name="CourseType" type="number" required="true" source="entity">
			<WTENUM id="1" name="Personal"/>
			<WTENUM id="2" name="Academic"/>
			<WTENUM id="3" name="Professional"/>
			<WTENUM id="4" name="Technical"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1113" name="CourseLevel" type="number" required="true" source="entity">
			<WTENUM id="1" name="Beginner"/>
			<WTENUM id="2" name="Intermediate"/>
			<WTENUM id="3" name="Advanced"/>
			<WTENUM id="4" name="Expert"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1115" name="Description" type="text" length="1000" min="1" max="1000" source="entity" />
		<WTATTRIBUTE id="1116" name="Language" type="text" length="20" min="1" max="20" source="entity" />
		<WTATTRIBUTE id="1117" name="CourseLength" type="number" required="true" source="entity"/>
		<WTATTRIBUTE id="1118" name="CourseDate" type="date" required="true" source="entity"/>
		<WTATTRIBUTE id="1119" name="IsPaid" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1120" name="Price" type="currency" source="entity"/>
		<WTATTRIBUTE id="1121" name="Grp" type="number" source="entity"/>
		<WTATTRIBUTE id="1122" name="Seq" type="number" source="entity"/>

		<WTATTRIBUTE id="1124" name="PassingGrade" type="number" source="entity"/>
		<WTATTRIBUTE id="1125" name="Rating" type="number" source="entity"/>
		<WTATTRIBUTE id="1126" name="RatingCnt" type="number" source="entity"/>
		<WTATTRIBUTE id="1127" name="Classes" type="number" source="entity"/>
		<WTATTRIBUTE id="1130" name="Video" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1131" name="Audio" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1132" name="Quiz" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1133" name="Reference" type="text" length="15" min="1" max="15" source="entity" language="false"/>
		<WTATTRIBUTE id="1134" name="ScoreFactor" type="decimal" precision="6" length="10" source="entity"/>
		<WTATTRIBUTE id="1135" name="NoCertificate" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1136" name="NoEvaluation" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1137" name="IsCustomCertificate" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1138" name="Credit" type="currency" min="0" max="9.99" source="entity">
			<WTFORMAT value="#0.00"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1139" name="ExamWeight" type="number" source="entity"/>
		<WTATTRIBUTE id="1140" name="Pre" type="text" length="20" min="1" max="20" source="entity" language="false"/>

		<WTATTRIBUTE id="1193" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1194" name="Amount" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1195" name="OrgID" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1196" name="OrgStatus" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1197" name="OrgSeq" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1198" name="OrgCourseID" type="number" source="entity" persist="false"/>

		<!--Indexes-->
		<WTINDEX name="TrainerID">
			<WTATTRIBUTE name="TrainerID"/>
			<WTATTRIBUTE name="CourseCategoryID"/>
		</WTINDEX>
		<WTINDEX name="CourseCategoryID">
			<WTATTRIBUTE name="CourseCategoryID"/>
		</WTINDEX>
		<WTINDEX name="Grp">
			<WTATTRIBUTE name="Grp"/>
			<WTATTRIBUTE name="Seq"/>
		</WTINDEX>
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID"/>
		</WTINDEX>
		<WTINDEX name="Status">
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="CourseDate"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Course" entity="Course" alias="cs"/>
			<WTRELATIONSHIP name="Common" entity="Course" alias="cs">
				<WTENTITY name="CourseCategory" entity="CourseCategory" alias="cc">
					<WTATTRIBUTE alias="cs" name="CourseCategoryID" relalias="cc" relname="CourseCategoryID"/>
				</WTENTITY>
				<WTENTITY name="Trainer" entity="Trainer" alias="tr">
					<WTATTRIBUTE alias="cs" name="TrainerID" relalias="tr" relname="TrainerID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Trainer" entity="Course" alias="cs">
				<WTENTITY name="Trainer" entity="Trainer" alias="tr">
					<WTATTRIBUTE alias="cs" name="TrainerID" relalias="tr" relname="TrainerID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<!--List-->
		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="CourseName" default="true" contains="true"/>
			<WTATTRIBUTE name="CourseID"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="CourseDate"/>
		</WTENUM>

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="COURSE-PENDING" value="1"/>
			<WTSYSCON name="COURSE-REVIEW" value="2"/>
			<WTSYSCON name="COURSE-ACTIVE" value="3"/>
			<WTSYSCON name="COURSE-INACTIVE" value="4"/>
		</WTSYSCONS>

	</WTENTITY>

	<WTPROCEDURES>
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" template="new" >
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="NewID" datatype="number"/>
			<WTSETVALUE name="Now" value="SYS(timestamp)"/>
			<WTCODEGROUP>
				<WTINSERT/>
			</WTCODEGROUP>
			<WTSETVALUE name="NewID" value="CONST(@@IDENTITY)"/>
			<WTSETVALUE name="PARAM(CourseID)" value="NewID"/>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CourseCategoryID)" oper="greater" value="CONST(0)"/>
				<WTPROCEDURE name="CourseCategory_Update_Counters">
					<WTPARAM name="ATTR(CourseCategoryID)" direction="input" value="PARAM(CourseCategoryID)"/>		
				</WTPROCEDURE>			
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="Count" name="Count" style="GenerateDataProc.xsl"/>
		<!--==================================================================-->
<!--		<WTPROCEDURE type="Command" name="AddOrgCourse" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
		</WTPROCEDURE>
-->
 		<!--============================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTDECLARE name="CourseCategoryID" datatype="number"/>
			
			<WTSETVALUE name="CourseCategoryID" value="CONST((SELECT CourseCategoryID FROM Course WHERE CourseID = @CourseID))"/>
			
			<WTCODEGROUP>
				<WTPROCEDURE name="Shortcut_DeleteItem">
					<WTPARAM name="EntityID" direction="input" value="ENTITY(Course)"/>
					<WTPARAM name="ItemID" direction="input" value="PARAM(CourseID)"/>
				</WTPROCEDURE>
				<WTPROCEDURE name="Course_DeleteFT">
					<WTPARAM name="ATTR(CourseID)" direction="input" value="PARAM(CourseID)"/>
				</WTPROCEDURE>
				<WTCODEGROUP>
					<WTCONDITION expr="CourseCategoryID" oper="greater" value="CONST(0)"/>
					<WTPROCEDURE name="CourseCategory_Update_Counters">
						<WTPARAM name="ATTR(CourseCategoryID)" direction="input" value="CourseCategoryID"/>		
					</WTPROCEDURE>			
				</WTCODEGROUP>				
				<WTDELETE>
					<WTJOIN name="Course" lock="true"/>
					<WTCONDITION expr="ATTR(Course.CourseID)" oper="equal" value="PARAM(CourseID)"/>
				</WTDELETE>
				<WTPROCEDURE name="OrgCourse_DeleteCourses">
					<WTPARAM name="ATTR(CourseID)" direction="input" value="PARAM(CourseID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="NewID" datatype="number"/>
			<WTDECLARE name="OldStatus" datatype="number"/>
			<WTDECLARE name="OldCourseCategoryID" datatype="number"/>
			<WTCODEGROUP>
				<WTCUSTOM>SELECT @mOldStatus = Status, @mOldCourseCategoryID = CourseCategoryID FROM Course WHERE CourseID = @CourseID</WTCUSTOM>
			</WTCODEGROUP>
			<WTSETVALUE name="Now" value="SYS(timestamp)"/>
			<WTCODEGROUP>
				<WTCONDITION expr="OldStatus" oper="not-equal" value="PARAM(Status)"/>
				<WTPROCEDURE name="CourseCategory_Update_Counters">
					<WTPARAM name="ATTR(CourseCategoryID)" direction="input" value="PARAM(CourseCategoryID)"/>		
				</WTPROCEDURE>	
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="OldCourseCategoryID" oper="not-equal" value="PARAM(CourseCategoryID)"/>
				<WTPROCEDURE name="CourseCategory_Update_Counters">
					<WTPARAM name="ATTR(CourseCategoryID)" direction="input" value="OldCourseCategoryID"/>		
				</WTPROCEDURE>	
				<WTPROCEDURE name="CourseCategory_Update_Counters">
					<WTPARAM name="ATTR(CourseCategoryID)" direction="input" value="PARAM(CourseCategoryID)"/>		
				</WTPROCEDURE>	
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTUPDATE>
					<WTJOIN name="Course" lock="true"/>
					<WTCONDITION expr="ATTR(Course.CourseID)" oper="equal" value="PARAM(CourseID)"/>
				</WTUPDATE>
			</WTCODEGROUP>
		</WTPROCEDURE>

 		<!--============================================================================================-->
		<WTPROCEDURE name="UpdateFT" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" novalidate="true" nodata="true">
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="ATTR(CourseName)" direction="input"/>
			<WTPARAM name="ATTR(TrainerName)" direction="input"/>
			<WTPARAM name="ATTR(Description)" direction="input"/>
			<WTPARAM name="Result" datatype="number" direction="output"/>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="FindCompany" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="FindOrg" style="GenerateDataProc.xsl" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(OrgID)" oper="equal" value="PARAM(OrgID)" connector="and"/>
		</WTPROCEDURE>
		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="FindTrainer" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(TrainerID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(TrainerID)" oper="equal" value="PARAM(TrainerID)" connector="and"/>
		</WTPROCEDURE>
 		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="Search" style="GenerateDataProc.xsl" template="new" searchlength="200" bookmarklength="14" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
 		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="TBCompanyDate" style="GenerateDataProc.xsl" template="new" searchlength="20" bookmarklength="20" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(TrainerID)" direction="input"/> <!-- MemberID -->
			<WTPARAM name="ATTR(CourseDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
 		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="TBPublicDate" style="GenerateDataProc.xsl" template="new" searchlength="20" bookmarklength="20" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CourseDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
 		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="TBUnRegistered" style="GenerateDataProc.xsl" template="new" searchlength="80" bookmarklength="90" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(TrainerID)" direction="input"/> <!-- MemberID -->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
 		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="TBFavoritePublic" style="GenerateDataProc.xsl" template="new" searchlength="20" bookmarklength="20" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(TrainerID)" direction="input"/> <!-- MemberID -->
			<WTPARAM name="ATTR(CourseDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
 		<!--============================================================================================-->
		<WTPROCEDURE type="Find" name="TBFavoriteCompany" style="GenerateDataProc.xsl" template="new" searchlength="20" bookmarklength="20" nodata="true">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(TrainerID)" direction="input"/> <!-- MemberID -->
			<WTPARAM name="ATTR(CourseDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListCourse" style="GenerateDataProc.xsl" template="new" passthru="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(CourseCategoryID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseCategoryID)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="ATTR(CourseCategoryID)" oper="equal" value="PARAM(CourseCategoryID)"/>
					<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListPrivate" style="GenerateDataProc.xsl" template="new" passthru="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseCategoryID)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Course.Status)" oper="equal" value="CONST(3)" connector="and"/>
					<WTORDER name="ATTR(Course.Grp)"/>
					<WTORDER name="ATTR(Course.Seq)"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListSingleCourse" style="GenerateDataProc.xsl" template="new" passthru="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
					<WTJOIN name="Trainer"/>
					<WTCONDITION expr="ATTR(CourseID)" oper="equal" value="PARAM(CourseID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(3)" connector="and"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListTextCourses" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(Description)" direction="input"/> <!--CourseID list-->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Amount)"/>    <!-- Used to sort the courses by listed order -->
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrg" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseType)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLevel)"/>
					<WTATTRIBUTE value="ATTR(Course.Status)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
					<WTATTRIBUTE value="ATTR(Course.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.OrgStatus)"/>
					<WTATTRIBUTE value="ATTR(Course.OrgSeq)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListFavorite" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListProgram" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
					<WTATTRIBUTE value="ATTR(Course.Credit)"/>
					<WTATTRIBUTE value="ATTR(Course.Status)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListCourseCategory" style="GenerateDataProc.xsl" template="new" passthru="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(CourseCategoryID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTATTRIBUTE value="ATTR(Course.Grp)"/>
					<WTJOIN name="Trainer"/>
					<WTCONDITION expr="ATTR(CourseCategoryID)" oper="equal" value="PARAM(CourseCategoryID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(3)" connector="and"/>
					<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Course.Grp)"/>
					<WTORDER name="ATTR(Course.Seq)"/>
					<WTORDER name="ATTR(Course.Rating)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListGrp" style="GenerateDataProc.xsl" template="new" passthru="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(Grp)" direction="input" required="false"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Trainer.TrainerName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.Rating)"/>
					<WTATTRIBUTE value="ATTR(Course.RatingCnt)"/>
					<WTATTRIBUTE value="ATTR(Course.Classes)"/>
					<WTATTRIBUTE value="ATTR(Course.Language)"/>
					<WTATTRIBUTE value="ATTR(Course.Description)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseDate)"/>
					<WTJOIN name="Trainer"/>
					<WTCONDITION expr="ATTR(Grp)" oper="equal" value="PARAM(Grp)"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(3)" connector="and"/>
					<WTORDER name="ATTR(Course.Seq)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportStatus" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.Status)"/>
					<WTATTRIBUTE value="ATTR(Course.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportReview" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Course.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.TrainerName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="SetContent" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="TrainerID" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="CanUpload" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="IsUpload" direction="output" datatype="yesno"/>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--==================================================================-->
		<WTWEBPAGE name="1101" caption="Find" action="5" header="false" footer="false" navbar="false" wrapper="wrapper600"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="Mode" datatype="number"/>

<!-- Params used internally in the page for inserting and updating OrgCourses -->			
			<WTPARAM name="ID" datatype="number"/>
			<WTPARAM name="OrgCourseAction" datatype="number"/> <!-- 1: Update  2: Delete -->
			<WTPARAM name="Status" datatype="number"/>
			
			<!-- MODE==DESCRIPTION==============USER==PARAMS==========CALLED-BY====-->
			<!--  0  Courses in the system      emp   none            navbar,1212  --> 
			<!--  1  Courses for the company    org   CompanyID         navbar,2809  -->
			<!--  2  Courses for an Org         org   OrgID,CompanyID   2809,1101    -->
			<!--  3  Company Courses to Insert  org   OrgID,CompanyID   1101         -->
			<!-- ==================================================================-->

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(CourseName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(0)"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="8" name="Include" type="Add">
				<!--	Refresh current list -->
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
				<WTMETHOD name="Load">
					<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>		
				<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(2)"/>
				</WTMETHOD>
			</WTOBJECT>

			<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
				<WTMETHOD name="FetchCompany">
					<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
				</WTMETHOD>			
				<WTMETHOD name="Load">
					<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
			</WTOBJECT>

<!-- Update/Remove the selected course -->
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(OrgCourseAction)" oper="greater" value="CONST(0)"/>
				<WTOBJECT name="OrgCourse" project="ptsOrgCourseUser" class="COrgCourse">
					<WTMETHOD name="GetOrgCourse">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="CourseID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						<WTPARAM name="tmpOrgCourseID" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="Delete">
						<WTCONDITION expr="PARAM(OrgCourseAction)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="CourseID" direction="input" value="CONST(tmpOrgCourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(OrgCourseAction)" oper="equal" value="CONST(1)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="OrgCourseID" direction="input" value="CONST(tmpOrgCourseID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(Status)" value="PARAM(Status)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<!-- Clear the page buffer and refresh -->
				<WTRETURN>
					<WTLINK name="1101">
						<WTPARAM name="SearchText" value="PARAM(SearchText)"/>
						<WTPARAM name="FindTypeID" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" value="PARAM(Bookmark)"/>
						<WTPARAM name="Direction" value="PARAM(Direction)"/>
						<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
						<WTPARAM name="Mode" value="PARAM(Mode)"/>								
						<WTPARAM name="OrgCourseAction" value="CONST(0)"/>
						<WTPARAM name="ID" value="CONST(0)"/>
					</WTLINK>	
				</WTRETURN>	
			</WTCODEGROUP>
				
<!-- Find -->			
			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)" connector="or"/>
				<WTMETHOD name="Find">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindCompany">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)" connector="or"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindOrg">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
<!-- detect and add any selected courses for insertion into an Org -->				
<WTCUSTOM>
				If CLng(tmpInclude) = 1 And CLng(reqOrgID) &gt; 0 Then
					tmpCnt = 0					
					Set oOrgCourse = server.CreateObject("ptsOrgCourseUser.COrgCourse")
					If oOrgCourse Is Nothing Then
					   DoError Err.Number, Err.Source, "Unable to Create Object - ptsOrgCourseUser.COrgCourse"
					Else
						For Each oLoopCourse in oCourses
							tmpID = oLoopCourse.CourseID
							If Request.Form.Item(tmpID) = "on" Then
								tmpOrgCourseID = oOrgCourse.GetOrgCourse( reqOrgID, tmpID, reqSysUserID )
								If tmpOrgCourseID = 0 Then
									tmpCnt = tmpCnt + 1
									With oOrgCourse
										.OrgID = CLng(reqOrgID)
										.CourseID = tmpID
										.Status = 1
										.QuizLimit = CLng(tmpQuizLimit)
										.Add CLng(reqSysUserID)
										If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
									End With
								End If
							End If
						Next
					End If
					Set oOrgCourse = Nothing	
					DoError reqUploadError, "Include", tmpCnt &amp; " Courses Included!"
				End If
</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>
				<WTSTATIC label="ClassesRated"/>
				<WTSTATIC label="Preview"/>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTTABLE col="1">
						<WTCOLUMN width="300" align="left"/>
						<WTCOLUMN width="300" align="right"/>
						<WTROW>
							<WTSTATIC col="1" label="PrivateCourses" class="PageHeading"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="NewCourse">
										<WTLINK name="1102">
											<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTIMAGE value="CONST(ArrowUp.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="Import">
										<WTLINK name="11Import" target="Import">
											<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC label="Courses"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Mode)" oper="greater" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" align="left" class="PageHeading">
						<WTSTATIC tag="IncludedCourses"/>
						<WTSTATIC value="ATTR(Org.OrgName)" space="1"/>
						<WTSTATIC label="Folder"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" align="right">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
							<WTSTATIC label="CourseCategorys">
								<WTLINK name="1212"/>
							</WTSTATIC>
							<WTSTATIC space="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(OrgID)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC label="Report">
								<WTLINK name="1360" target="Report">
									<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC space="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
							<WTSTATIC label="IncludePublicCourses">
								<WTLINK name="1212" target="Courses">
									<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="Mode" value="CONST(3)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC space="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
							<WTSTATIC label="IncludePrivateCourses">
								<WTLINK name="1101" target="Courses">
									<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
									<WTPARAM name="Mode" value="CONST(3)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="less" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" align="left" label="CourseFindText" class="prompt"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="greater" value="CONST(1)"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" label="FolderCoursesText" class="prompt"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Courses.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTBUTTON col="1" action="8" align="center" value="CONST(Include)">
							<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" value="CONST(Close)">
							<WTCLICK>window.parent.parent.opener.location.reload();window.parent.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
				<WTSTATIC label="GradeHomework"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)" connector="or"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)" connector="or"/>
					<WTROW>
						<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Course">
							<WTCOLUMN width="11" align="left" valign="top" label="Rating"/>
							<WTCOLUMN width="4" align="left" valign="top"/>
							<WTCOLUMN width="39" align="left" valign="top" label="CourseTrainer"/>
							<WTCOLUMN width="13" align="left" valign="top" label="CourseType"/>
							<WTCOLUMN width="20" align="left" valign="top" label="CourseLevel"/>
							<WTCOLUMN width="13" align="right" valign="top" />

							<WTROW>
								<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
								 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
									<WTLINK name="1313" target="Ratings">
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
									</WTLINK>
								</WTIMAGE>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
									<WTCHECK col="2" name="&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(3)"/>
									<WTSTATIC col="2"/>
								</WTCODEGROUP>
								<WTSTATIC col="3">
									<WTSTATIC value="DATA(Course.CourseName)" fontcolor="green">
										<WTCONDITION expr="DATA(Status)" oper="less-equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Course.CourseName)" fontcolor="purple">
										<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Course.CourseName)">
										<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(3)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Course.CourseName)" fontcolor="red">
										<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(4)"/>
									</WTSTATIC>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTCONDITION expr="IsEmployee"/>
										<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)" connector="or"/>
										<WTCODEGROUP>
											<WTCONDITION expr="IsEmployee"/>
											<WTCONDITION expr="DATA(TrainerID)" oper="equal" value="CONST(0)" connector="or"/>
											<WTIMAGE value="CONST(edit.gif)" alt="Preview">
												<WTLINK name="1103">
													<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="IsEmployee"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(ArrowDown.gif)" alt="Export" imgalign="absmiddle">
												<WTLINK name="ExportCourse" target="Export">
													<WTPARAM name="CourseID" value="DATA(CourseID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="4" value="DATA(Course.CourseType)" valign="top"/>
								<WTSTATIC col="5" value="DATA(Course.CourseLevel)" valign="top"/>
								<WTSTATIC col="6" valign="top">
									<WTCODEGROUP>
										<WTCONDITION expr="IsEmployee"/>
										<WTCONDITION expr="PARAM(Mode)" oper="less-equal" value="CONST(1)" connector="and"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(lesson_status2.gif)" alt="Lessons">
												<WTLINK name="2311">
													<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
													<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(preview.gif)" alt="Preview">
												<WTLINK name="1330" target="preview">
													<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(copy.gif)" alt="Copy">
												<WTLINK name="1105" target="CopyCourse">
													<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(homework.gif)" alt="GradeHomework">
												<WTLINK name="6811" target="blank">
													<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(video.gif)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(audio.gif)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(quiz.gif)"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTSTATIC value="DATA(Course.TrainerName)">
										<WTCONDITION expr="IsOrgAdminOnly"/>
										<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
										<WTLINK name="0308" target="trainer">
											<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Course.TrainerName)">
										<WTCONDITION expr="IsEmployee"/>
										<WTCONDITION expr="IsTrainerOnly" connector="or"/>
										<WTLINK name="0303" >
											<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
											<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="4" merge="3" fontcolor="gray" valign="top">
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
										<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="1119" target="Group">
											<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Course.Status)"/>
									<WTSTATIC value="CONST( - )"/>
									<WTSTATIC value="DATA(Course.Language)"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat(' (',@coursedate,')')&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
					<WTROW>
						<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
						<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Course">
							<WTCOLUMN width="12" align="left" valign="top" label="RankSeq"/>
							<WTCOLUMN width="74" align="left" valign="top" label="CourseTrainer"/>
							<WTCOLUMN width="5" align="right" valign="top" />
							<WTCOLUMN width="9" align="right" valign="top" />

							<WTROW>
								<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
								 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
									<WTLINK name="1313" target="Ratings">
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
									</WTLINK>
								</WTIMAGE>
								<WTSTATIC col="2">
									<WTSTATIC value="DATA(Course.CourseName)"/>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))" space="1" fontcolor="purple"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit">
											<WTLINK name="3003">
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
												<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
											</WTLINK>
										</WTIMAGE>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Preview.gif)" alt="Preview">
											<WTLINK name="1330" target="preview">
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Course.CourseType)" oper="equal" value="CONST(0)"/>
											<WTIMAGE value="CONST(quiz.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Course.CourseType)" oper="equal" value="CONST(1)"/>
											<WTIMAGE value="CONST(quiz_no_retake.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Course.CourseType)" oper="equal" value="CONST(2)"/>
											<WTIMAGE value="CONST(quiz_no_answer.gif)"/>
										</WTCODEGROUP>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="4" bold="true">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Course.Status)" oper="equal" value="CONST(2)"/>
										<WTIMAGE value="CONST(CheckGreen.gif)" alt="Required">
											<WTLINK name="1101" skipreturn="true">	
												<WTPARAM name="SearchText" value="PARAM(SearchText)"/>
												<WTPARAM name="FindTypeID" value="PARAM(FindTypeID)"/>
												<WTPARAM name="Bookmark" value="PARAM(Bookmark)"/>
												<WTPARAM name="Direction" value="PARAM(Direction)"/>
												<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
												<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
												<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
												<WTPARAM name="Mode" value="PARAM(Mode)"/>										
												<WTPARAM name="ID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseAction" value="CONST(1)"/>
												<WTPARAM name="Status" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Course.Status)" oper="equal" value="CONST(1)"/>
										<WTIMAGE value="CONST(CheckGray.gif)" alt="Recommended">
											<WTLINK name="1101" skipreturn="true">	
												<WTPARAM name="SearchText" value="PARAM(SearchText)"/>
												<WTPARAM name="FindTypeID" value="PARAM(FindTypeID)"/>
												<WTPARAM name="Bookmark" value="PARAM(Bookmark)"/>
												<WTPARAM name="Direction" value="PARAM(Direction)"/>
												<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
												<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
												<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
												<WTPARAM name="Mode" value="PARAM(Mode)"/>	
												<WTPARAM name="ID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseAction" value="CONST(1)"/>
												<WTPARAM name="Status" value="CONST(2)"/>
											</WTLINK>							
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Trash.gif)" alt="Remove">
											<WTLINK name="1101" skipreturn="true">
												<WTPARAM name="SearchText" value="PARAM(SearchText)"/>
												<WTPARAM name="FindTypeID" value="PARAM(FindTypeID)"/>
												<WTPARAM name="Bookmark" value="PARAM(Bookmark)"/>
												<WTPARAM name="Direction" value="PARAM(Direction)"/>
												<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
												<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
												<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
												<WTPARAM name="Mode" value="PARAM(Mode)"/>								
												<WTPARAM name="ID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseAction" value="CONST(2)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" value="DATA(Course.Seq)" fontcolor="gray"/>
								<WTSTATIC col="2" merge="3" value="DATA(Course.TrainerName)">
									<WTLINK name="0308" target="trainer">
										<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTBUTTON col="1" action="8" align="center" value="CONST(Include)">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
						<WTCLICK>window.parent.parent.opener.location.reload();window.parent.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1102" caption="Course" header="false" footer="false" navbar="false" wrapper="wrapper600"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--===============================================================================-->
			<WTPARAM name="CourseCategoryID" datatype="number"/>
			<WTPARAM name="TrainerID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CourseCategoryID)" value="PARAM(CourseCategoryID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(TrainerID)" value="PARAM(TrainerID)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="CONST(&quot;English&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(CourseLength)" value="CONST(&quot;60&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(CourseDate)" value="SYS(date)"/>
<!--					<WTSETATTRIBUTE name="ATTR(PassingGrade)" value="CONST(&quot;70&quot;)"/>-->
					<WTSETATTRIBUTE name="ATTR(IsPaid)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CourseType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CourseLevel)" value="CONST(1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;CourseTemplate.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

			</WTACTION>
			
			<WTACTION name="Add" type="Add" id="1">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(TrainerID)" value="PARAM(TrainerID)"/>
					<WTSETATTRIBUTE name="ATTR(ScoreFactor)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTPARAM name="CourseID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCourseID)" value="ATTR(Course.CourseID)"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Lesson" project="ptsLessonUser" class="CLesson">
					<WTSETATTRIBUTE name="ATTR(CourseID)" value="CONST(tmpCourseID)"/>
<WTCUSTOM>
			For x = 1 To 15
				s = trim(Request.Form.Item("Lesson" &amp; x))
				If s &lt;&gt; "" Then
					.LessonName = s
					.Seq = x * 10
					.Status = 2
					.Content = 3
					.PassingGrade= 70
					.LessonLength = 15
					LessonID = CLng(.Add(CLng(reqSysUserID)))
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
				End If
			Next
</WTCUSTOM>
				</WTOBJECT>
				

<WTCUSTOM>
            If (xmlError = "") Then
					Set oFileSys = server.CreateObject("Scripting.FileSystemObject")
					oFileSys.CreateFolder reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(CourseID)
					Set oFileSys = Nothing
            End If
</WTCUSTOM>				
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Description.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(CourseID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="2311" skipreturn="true">
						<WTPARAM name="CourseID" value="CONST(CourseID)"/>
						<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="500" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="NewCourse" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step1.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="NewCourseText" align="left" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Course.CourseName)" size="60" focus="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CourseType"/>
						<WTCOMBO col="2" value="ATTR(Course.CourseType)" prespace="false"/>
						<WTCOMBO col="2" value="ATTR(Course.CourseLevel)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Status"/>
						<WTCOMBO col="2" value="ATTR(Course.Status)" prespace="false"/>
						<WTTEXT col="2" value="ATTR(Course.CourseDate)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Owner"/>
						<WTTEXT col="2" value="ATTR(Course.CompanyID)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Course.CourseType)"/>
						<WTHIDDEN value="ATTR(Course.CourseLevel)"/>
						<WTHIDDEN value="ATTR(Course.Status)"/>
						<WTHIDDEN value="ATTR(Course.CourseDate)"/>
						<WTHIDDEN value="ATTR(Course.CompanyID)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Reference"/>
					<WTTEXT col="2" value="ATTR(Course.Reference)" size="15" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="CourseLength"/>
					<WTTEXT col="2" value="ATTR(Course.CourseLength)" size="2" prespace="false"/>
					<WTSTATIC col="2" tag="Language"/>
					<WTTEXT col="2" value="ATTR(Course.Language)" prespace="false"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step2.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="DescriptionText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="2" value="ATTR(Course.Description)" rows="8" cols="72"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="DetailDescription" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="2" value="ATTR(HTMLFile.Data)" rows="25" cols="72" htmleditor="editor_simple" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step3.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="CategoryText" align="left" class="prompt"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CourseCategory"/>
						<WTTEXT col="2" value="ATTR(Course.CourseCategoryID)" size="3" prespace="false"/>
						<WTBUTTON col="2" value="CONST(SelectCategory)">
							<WTCLICK>window.open("1213.asp", '', "width=320, height=451 resizable=no, status=no");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Course.IsPaid)"/>
					</WTROW>
				</WTCODEGROUP>	
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CourseCategory"/>
						<WTBUTTON col="2" value="CONST(SelectCategory)">
							<WTCLICK>window.open("1213.asp", '', "width=320, height=451 resizable=no, status=no");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Course.CourseCategoryID)"/>
						<WTHIDDEN value="ATTR(Course.IsPaid)"/>
					</WTROW>
				</WTCODEGROUP>	

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="GrpSeqText" align="left" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Grp"/>
					<WTTEXT col="2" value="ATTR(Course.Grp)" size="5" prespace="false"/>
					<WTSTATIC col="2" tag="Seq"/>
					<WTTEXT col="2" value="ATTR(Course.Seq)" size="5" prespace="false"/>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step4.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="PassingGradeText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="PassingGrade"/>
					<WTTEXT col="2" value="ATTR(Course.PassingGrade)" size="2" prespace="false"/>
					<WTCHECK col="2" value="ATTR(Course.NoCertificate)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step5.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="LessonText" align="left" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson1"/>
					<WTTEXT col="2" name="Lesson1" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson2"/>
					<WTTEXT col="2" name="Lesson2" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson3"/>
					<WTTEXT col="2" name="Lesson3" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson4"/>
					<WTTEXT col="2" name="Lesson4" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson5"/>
					<WTTEXT col="2" name="Lesson5" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson6"/>
					<WTTEXT col="2" name="Lesson6" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson7"/>
					<WTTEXT col="2" name="Lesson7" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson8"/>
					<WTTEXT col="2" name="Lesson8" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson9"/>
					<WTTEXT col="2" name="Lesson9" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson10"/>
					<WTTEXT col="2" name="Lesson10" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson11"/>
					<WTTEXT col="2" name="Lesson11" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson12"/>
					<WTTEXT col="2" name="Lesson12" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson13"/>
					<WTTEXT col="2" name="Lesson13" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson14"/>
					<WTTEXT col="2" name="Lesson14" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Lesson15"/>
					<WTTEXT col="2" name="Lesson15" size="60" maxlength="80" prespace="false"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Add)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1103" caption="Course"  header="false" footer="false" navbar="false" wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--===============================================================================-->
			<WTPARAM name="CourseID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpTrainerID)" value="ATTR(Course.TrainerID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Description.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(reqCourseID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
<WTCUSTOM>
			SetCache "IMAGEPATH", "sections/course/" + CStr(reqCourseID) + "\" 
</WTCUSTOM>
				</WTOBJECT>
<!--				
				<WTOBJECT name="Lessons" project="ptsLessonUser" class="CLessons">
					<WTMETHOD name="ListCourse">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlLessons" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
-->
			</WTACTION>
			
			<WTACTION name="Update" type="Update" id="1">
				
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(oldCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(newCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Course.Status)" value="CONST(1)">
						<WTCONDITION expr="CONST(Request.Form.Item(&quot;MakePending&quot;))" oper="equal" value="&quot;on&quot;"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Course.Status)" value="CONST(2)">
						<WTCONDITION expr="CONST(Request.Form.Item(&quot;MakeReview&quot;))" oper="equal" value="&quot;on&quot;"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CourseDate)" value="SYS(date)">
						<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="CONST(3)"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(3)" connector="and"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="UpdateFT">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(3)" connector="and"/>
						<WTPARAM name="CourseID" direction="input" value="ATTR(CourseID)"/>
						<WTPARAM name="CourseName" direction="input" value="CONST(.CourseName)"/>
						<WTPARAM name="TrainerName" direction="input" value="CONST(.TrainerName)"/>
						<WTPARAM name="Description" direction="input" value="CONST(.Description)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Attachment" project="ptsAttachmentUser" class="CAttachment">
					<WTCONDITION expr="CONST(newCompanyID)" oper="not-equal" value="CONST(oldCompanyID)"/>
					<WTMETHOD name="UpdateCompanyID">
						<WTPARAM name="ParentType" direction="input" value="CONST(23)"/>
						<WTPARAM name="ParentID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="CompanyID" direction="input" value="CONST(newCompanyID)"/>
						<WTPARAM name="return" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Description.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(reqCourseID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Delete">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
<!--			
			<WTACTION name="CreateForum" type="Update" id="5">				
				<WTOBJECT name="Forum" project="ptsForumUser" class="CForum">
					<WTMETHOD name="Load">
						<WTPARAM name="ForumID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>

 TODO: set the parentid to a meaningful value 	

					<WTSETATTRIBUTE name="ATTR(Forum.ParentID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(Forum.ForumName)" value="FORM(CourseName)"/>
					<WTSETATTRIBUTES/>
					
					<WTMETHOD name="Add">
						<WTPARAM name="ForumID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlForums" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Course.Status)" value="CONST(1)">
						<WTCONDITION expr="CONST(Request.Form.Item(&quot;MakePending&quot;))" oper="equal" value="&quot;on&quot;"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Course.Status)" value="CONST(2)">
						<WTCONDITION expr="CONST(Request.Form.Item(&quot;MakeReview&quot;))" oper="equal" value="&quot;on&quot;"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Course.ForumID)" value="CONST(ForumID)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="UpdateFT">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(3)" connector="and"/>
						<WTPARAM name="CourseID" direction="input" value="ATTR(CourseID)"/>
						<WTPARAM name="CourseName" direction="input" value="CONST(.CourseName)"/>
						<WTPARAM name="TrainerName" direction="input" value="CONST(.TrainerName)"/>
						<WTPARAM name="Description" direction="input" value="CONST(.Description)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Description.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(reqCourseID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
-->			

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="500" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" tag="Course" value="ATTR(Course.CourseName)" class="PageHeading"/>
					<WTIMAGE col="1" merge="2" value="CONST(Shortcut.gif)">
						<WTCONDITION expr="NotMemberOnly"/>
						<WTCONDITION expr="_IsShortcuts" connector="or"/>
						<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
							<WTPARAM name="EntityID" value="ENTITY(Course)"/>
							<WTPARAM name="ItemID" value="ATTR(Course.CourseID)"/>
							<WTPARAM name="Name" value="ATTR(Course.CourseName)" clean="true"/>
							<WTPARAM name="URL" value="SYS(PageURL)"/>
						</WTLINK>
					</WTIMAGE>
					<WTIMAGE col="1" merge="2" value="CONST(copy.gif)" alt="Copy">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsTrainerOnly" connector="or"/>
						<WTCONDITION expr="ATTR(Course.TrainerID)" oper="equal" value="CONST(0)" connector="or"/>
						<WTLINK name="1105" target="CopyCourse">
							<WTPARAM name="CourseID" value="ATTR(Course.CourseID)"/>
						</WTLINK>
					</WTIMAGE>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" width="60%" align="left" tag="Trainer" value="ATTR(Course.TrainerName)" class="BoldText">
						<WTLINK name="0303" >
							<WTCONDITION expr="PARAM(contentpage)" oper="equal" value="CONST(0)"/>
							<WTPARAM name="TrainerID" value="ATTR(Course.TrainerID)"/>
						</WTLINK>
					</WTSTATIC>
					<WTLINKGROUP col="2" width="40%" align="right">
						<WTLINK name="2311" label="Lessons">
							<WTPARAM name="CourseID" value="ATTR(Course.CourseID)"/>
							<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
						</WTLINK>
						<WTLINK name="1313" label="Ratings" target="Ratings">
							<WTPARAM name="CourseID" value="ATTR(Course.CourseID)"/>
						</WTLINK>
						<WTLINK name="8001" label="Attachments" target="Attachments">
							<WTPARAM name="CourseID" value="ATTR(Course.CourseID)"/>
						</WTLINK>
						<WTLINK name="1106" label="Certificate" target="Certificate">
							<WTPARAM name="CourseID" value="ATTR(Course.CourseID)"/>
						</WTLINK>
					</WTLINKGROUP>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="EditCourseText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTIMAGE col="1" value="CONST(step1.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="CourseID" height="18"/>
					<WTSTATIC col="2" value="ATTR(Course.CourseID)" bold="true"/>
				</WTROW>
				<WTCODEGROUP>
					<!-- Is Employee or Private Course -->
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="ATTR(Course.CompanyID)" oper="greater" value="CONST(0)" connector="or"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Status"/>
						<WTCOMBO col="2" value="ATTR(Course.Status)" prespace="false"/>
						<WTTEXT col="2" value="ATTR(Course.CourseDate)"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<!-- Not Employee and Public Course -->
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="ATTR(Course.CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCODEGROUP>
						<!-- Not Employee and Public Course -->
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Status"/>
							<WTSTATIC col="2" value="ATTR(Course.Status)"/>
							<WTSTATIC col="2" value="ATTR(Course.CourseDate)"/>
						</WTROW>
						<WTROW>
							<WTHIDDEN value="ATTR(Course.Status)"/>
							<WTHIDDEN value="ATTR(Course.CourseDate)"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Course.Status)" oper="less" value="CONST(4)"/>
						<WTROW>
							<WTCONDITION expr="ATTR(Course.Status)" oper="equal" value="CONST(2)"/>
							<WTCONDITION expr="ATTR(Course.Status)" oper="equal" value="CONST(3)" connector="or"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" name="MakePending" label="MakePending"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="ATTR(Course.Status)" oper="equal" value="CONST(1)"/>
							<WTSTATIC col="1"/>
							<WTCHECK col="2" name="MakeReview" label="MakeReview"/>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step2.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="CourseNameText" align="left" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Course.CourseName)" size="60" focus="true" prespace="false"/>
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CourseType"/>
						<WTCOMBO col="2" value="ATTR(Course.CourseType)" prespace="false"/>
						<WTCOMBO col="2" value="ATTR(Course.CourseLevel)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Course.CourseType)"/>
						<WTHIDDEN value="ATTR(Course.CourseLevel)"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="PrivateCourse"/>
					<WTTEXT col="2" value="ATTR(Course.CompanyID)" size="6" prespace="false"/>
				</WTROW>
				<WTROW >
					<WTCONDITION expr="IsManager"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="TrainerID"/>
					<WTTEXT col="2" value="ATTR(Course.TrainerID)" size="4"/>
					<WTSTATIC col="2" tag="ScoreFactor"/>
					<WTTEXT col="2" value="ATTR(Course.ScoreFactor)" size="4"/>
				</WTROW>
				<WTROW >
					<WTCONDITION expr="NotManager"/>
					<WTHIDDEN value="ATTR(Course.TrainerID)"/>
					<WTHIDDEN value="ATTR(Course.ScoreFactor)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Reference"/>
					<WTTEXT col="2" value="ATTR(Course.Reference)" size="15" prespace="false"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="CourseLength"/>
					<WTTEXT col="2" value="ATTR(Course.CourseLength)" size="2" prespace="false"/>
					<WTSTATIC col="2" tag="Language"/>
					<WTTEXT col="2" value="ATTR(Course.Language)" prespace="false"/>
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CourseCategory"/>
						<WTTEXT col="2" value="ATTR(Course.CourseCategoryID)" size="3" prespace="false"/>
						<WTSTATIC col="2" value="ATTR(Course.CourseCategoryName)"/>
						<WTBUTTON col="2" value="CONST(Edit)">
							<WTCLICK>window.open("1213.asp", '', "width=320, height=451 resizable=no, status=no");</WTCLICK>
						</WTBUTTON>
						<WTSTATIC col="2" label="NoMyClasses"/>
					</WTROW>
					
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Course.NoEvaluation)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Rating"/>
						<WTTEXT col="2" value="ATTR(Course.Rating)" size="2" prespace="false"/>
						<WTSTATIC col="2" value="CONST((1-10))"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="RatingCnt"/>
						<WTSTATIC col="2" value="ATTR(Course.RatingCnt)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Classes"/>
						<WTSTATIC col="2" value="ATTR(Course.Classes)"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2"/>
						<WTCHECK col="2" value="ATTR(Course.IsPaid)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Price"/>
						<WTTEXT col="2" value="ATTR(Course.Price)" prespace="false" size="6"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CourseCategory"/>
						<WTSTATIC col="2" value="ATTR(Course.CourseCategoryName)"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Course.CourseCategoryID)"/>
						<WTHIDDEN value="ATTR(Course.NoEvaluation)"/>
						<WTHIDDEN value="ATTR(Course.Rating)"/>
						<WTHIDDEN value="ATTR(Course.IsPaid)"/>
						<WTHIDDEN value="ATTR(Course.Price)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="GrpSeqText" align="left" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Grp"/>
					<WTTEXT col="2" value="ATTR(Course.Grp)" size="5" prespace="false"/>
					<WTSTATIC col="2" tag="Seq"/>
					<WTTEXT col="2" value="ATTR(Course.Seq)" size="5" prespace="false"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step3.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="PassingGradeText" align="left" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="PassingGrade"/>
					<WTTEXT col="2" value="ATTR(Course.PassingGrade)" size="2" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Credit"/>
					<WTTEXT col="2" value="ATTR(Course.Credit)" size="4" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Pre"/>
					<WTTEXT col="2" value="ATTR(Course.Pre)" size="20" prespace="false"/>
					<WTSTATIC col="2" label="PreText" fontcolor="blue"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="ExamID"/>
					<WTTEXT col="2" value="ATTR(Course.ExamID)" size="4" prespace="false"/>
					<WTSTATIC col="2" tag="ExamWeight"/>
					<WTTEXT col="2" value="ATTR(Course.ExamWeight)" size="2" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Course.IsCustomCertificate)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Course.NoCertificate)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(step4.gif)" align="center" valign="center"/>
					<WTSTATIC col="2" label="DescriptionText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="2" value="ATTR(Course.Description)" rows="8" cols="72"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="DetailDescription" align="left" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" value="ATTR(HTMLFile.Data)" rows="25" cols="72" htmleditor="editor_simple" embedhtml="true"/>
				</WTROW>
			
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete" align="center">
						<WTCONDITION expr="IsActive"/>
						<WTCONDITION expr="IsEmployee" connector="and"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="1104" caption="Find Trainer Courses" action="5" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="TrainerID" datatype="number"/>
			
			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(CourseName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTMETHOD name="FindTrainer">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="TrainerID" direction="input" value="PARAM(TrainerID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="150" align="left"/>
						<WTCOLUMN width="450" align="right"/>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
							<WTIMAGE col="1" value="CONST(elearn.jpg)" imgwidth="120" align="center"/>
							<WTSTATIC col="2" label="NoCourses" align="left" valign="center" class="Prompt"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
							<WTIMAGE col="1" value="CONST(elearn.jpg)" imgwidth="120" align="center"/>
							<WTSTATIC col="2" label="MyCoursesText" align="left" valign="center" class="Prompt"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1"/>
							<WTLINKGROUP col="2" align="right">
								<WTLINK name="1102" label="NewCourse">
									<WTPARAM name="TrainerID" value="PARAM(TrainerID)"/>
								</WTLINK>
							</WTLINKGROUP>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader"/>
					<WTCOMBO col="1" value="ATTR(Courses.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="true" entity="Course">
						<WTCOLUMN width="11" align="left" valign="top" label="Rating"/>
						<WTCOLUMN width="63" align="left" valign="top" label="CourseName"/>
						<WTCOLUMN width="13" align="left" valign="top" label="CourseType"/>
						<WTCOLUMN width="13" align="right" valign="top" label="Lessons"/>

						<WTROW>
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
							 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
								<WTLINK name="1313" target="Ratings">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Course.CourseName)">
									<WTLINK name="1103"><WTPARAM name="CourseID" value="DATA(Course.CourseID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST( (preview))">
									<WTLINK name="1330" target="preview">
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Course.CourseType)"/>
							<WTLINKGROUP col="4">
								<WTLINK name="2311" label="Lessons">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTLINKGROUP>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC value="DATA(Course.Status)"/>
								<WTSTATIC value="CONST( - )"/>
								<WTSTATIC value="DATA(Course.Language)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Course.CourseLevel)"/>
							<WTSTATIC col="4"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1105" caption="Copy Course" navbar="false" footer="false"
		aspstyle="GenerateWebASP.xsl"  xslstyle="GenerateWebXSLList.xsl" >
		<!--===============================================================================-->
			<WTPARAM name="CourseID" datatype="number"/> 
			<WTPARAM name="Txn" datatype="number"/> 
			
			<WTSUB name="LoadCourse">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTCALLSUB name="LoadCourse"/>
				<WTOBJECT name="Lessons" project="ptsLessonUser" class="CLessons">
					<WTMETHOD name="ListCourse">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlLessons" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Add" type="Add">
				<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
<WTCUSTOM>
'Copy Course
Set oCourse = server.CreateObject("ptsCourseUser.CCourse")
If oCourse Is Nothing Then
	DoError Err.Number, Err.Source, "Unable to Create Object - ptsCourseUser.CCourse"
Else
	With oCourse
		.SysCurrentLanguage = reqSysLanguage
		.Load CLng(reqCourseID), CLng(reqSysUserID)
		.CourseDate = Date()
		.Status = 1
		.CourseName = "Copy Of " + .CourseName
		NewCourseID = .Add(1)
		If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
		xmlCourse = .XML(2)
		If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
	End With
End If
Set oCourse = Nothing

Set oFileSys = server.CreateObject("Scripting.FileSystemObject")
oFileSys.CreateFolder reqSysWebDirectory + "Sections\Course\" &amp; NewCourseID
Set oFileSys = Nothing

Set oHTMLFile = server.CreateObject("wtHTMLFile.CHTMLFile")
Set oQuizQuestions = server.CreateObject("ptsQuizQuestionUser.CQuizQuestions")
Set oQuizChoices = server.CreateObject("ptsQuizChoiceUser.CQuizChoices")

'Copy Course HTML Files
With oHTMLFile
	.Language = reqSysLanguage
	.Project = SysProject
	.Filename = "Description.htm"
	.Path = reqSysWebDirectory + "Sections\Course\" &amp; reqCourseID
	.Load 
	If Len(.Data) &gt; 10 Then
		.Path = reqSysWebDirectory + "Sections\Course\" &amp; NewCourseID
		.Save 
	End If
	.Filename = "Certificate.htm"
	.Path = reqSysWebDirectory + "Sections\Course\" &amp; reqCourseID
	.Load 
	If Len(.Data) &gt; 10 Then
		.Path = reqSysWebDirectory + "Sections\Course\" &amp; NewCourseID
		.Save 
	End If
End With

'Copy Lessons
Set oLessons = server.CreateObject("ptsLessonUser.CLessons")
If oLessons Is Nothing Then
	DoError Err.Number, Err.Source, "Unable to Create Object - ptsLessonUser.CLessons"
Else
	oLessons.ListCourse CLng(reqCourseID), CLng(reqSysUserID)
	For Each oLesson in oLessons
		OldLessonID = oLesson.LessonID
		If Request.Form.Item(OldLessonID) = "on" Then
			With oLesson
		        .Load OldLessonID, 1
				.CourseID = NewCourseID
				NewLessonID = .Add(1)
			End With	

			'Copy Lesson HTML Files
			With oHTMLFile
				.Language = reqSysLanguage
				.Project = SysProject
				.Filename = OldLessonID &amp; ".htm"
				.Path = reqSysWebDirectory + "Sections\Course\" &amp; reqCourseID
				.Load 
				If Len(.Data) &gt; 10 Then
					.Filename = NewLessonID &amp; ".htm"
					.Path = reqSysWebDirectory + "Sections\Course\" &amp; NewCourseID
					.Save 
				End If
				.Filename = OldLessonID &amp; "q.htm"
				.Path = reqSysWebDirectory + "Sections\Course\" &amp; reqCourseID
				.Load 
				If Len(.Data) &gt; 10 Then
					.Filename = NewLessonID &amp; "q.htm"
					.Path = reqSysWebDirectory + "Sections\Course\" &amp; NewCourseID
					.Save 
				End If
			End With

			oQuizQuestions.ListQuizQuestion OldLessonID, 1
			For Each oQuizQuestion in oQuizQuestions
				With oQuizQuestion
					If .IsRandom = "-1" Then .IsRandom = "1"
					.LessonID = NewLessonID
					OldQuizQuestionID = .QuizQuestionID
					NewQuizQuestionID = .Add(1)

					oQuizChoices.ListQuizChoice OldQuizQuestionID, 1
					cnt = 0
					For Each oQuizChoice in oQuizChoices
						With oQuizChoice
							.QuizQuestionID = NewQuizQuestionID
							cnt = cnt + 1
							.Seq = cnt
							.Add(1)
						End With
					Next
				End With
			Next
		End If
	Next
End If
Set oLessons = Nothing
Set oQuizChoices = Nothing
Set oQuizQuestions = Nothing
Set oHTMLFile = Nothing
</WTCUSTOM>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW>
					<WTSTATIC col="1" tag="CopyCourse" value="ATTR(Course.CourseName)" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="CopyCourseText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTREPEAT entity="Lesson">
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="3">
						<WTSTATIC col="1" space="5"/>
						<WTCHECK  col="1" name="&lt;xsl:value-of select=&quot;@lessonid&quot;/&gt;" check="true"/>
						<WTSTATIC col="1" value="DATA(Lesson.LessonName)"/>
					</WTROW>
				</WTREPEAT>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Copy)" align="center">
						<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1106" caption="Custom Certificate" header="false" footer="false" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--===============================================================================-->
			<WTPARAM name="CourseID" datatype="number"/>
			
			<WTACTION name="New" type="New" id="0">
					<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Certificate.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(reqCourseID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
						<WTMETHOD name="Load"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTOBJECT>
			</WTACTION>
			
			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Certificate.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(reqCourseID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
					<WTMETHOD name="Save"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTSTATIC col="1" label="CustomCertificate" align="left" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="CustomCertificateText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTMEMO col="1" value="ATTR(HTMLFile.Data)" rows="50" cols="100" htmleditor="true" embedhtml="true"/>
				</WTROW>

				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1107" caption="Custom Certificate" header="false" footer="false" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--===============================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="I" datatype="number"/>
			<WTDATATXN name="HTMLFile"/>
			
			<WTACTION name="New" type="New" id="0">
				<!-- Redirect to Printing Instructions -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(I)" oper="not-equal" value="CONST(0)"/>
					<WTSETCACHE name="CERTID" value="PARAM(SessionID)"/>
					<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
						<WTMETHOD name="Load">
							<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpCourseID)" value="ATTR(CourseID)"/>
					</WTOBJECT>
<WTCUSTOM>
	URLPath = "http://" + reqSysServerName + reqSysServerPath
	FilePath = Request.ServerVariables("APPL_PHYSICAL_PATH")
	FileName = "PrintCertificateC" + CSTR(tmpCourseID) + ".htm"
	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	Exists = oFileSys.FileExists(FilePath + FileName)
	If Exists Then
	   Response.Redirect URLPath + FileName
	Else
		FileName = "PrintCertificateC.htm"
		Exists = oFileSys.FileExists(FilePath + FileName)
		If Exists Then
			Response.Redirect URLPath + FileName
		Else
			reqI = 0	
		End If
	End If
	Set oFileSys = Nothing
</WTCUSTOM>	
				</WTCODEGROUP>
				
				<!-- Load Certificate -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(I)" oper="equal" value="CONST(0)"/>
					<WTGETCACHE name="PARAM(SessionID)" value="CERTID" />

					<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
						<WTMETHOD name="Load">
							<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpCourseID)" value="ATTR(CourseID)"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
						<WTSETATTRIBUTE name="CONST(tmpName)" value="ATTR(StudentName)"/>
						<WTSETATTRIBUTE name="CONST(tmpDate)" value="ATTR(CompleteDate)"/>
						<WTSETATTRIBUTE name="CONST(tmpScore)" value="ATTR(Grade)"/>
					</WTOBJECT>
					<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
						<WTMETHOD name="ListOwnerType">
							<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
							<WTPARAM name="OwnerID" direction="input" value="CONST(tmpMemberID)"/>
							<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
						</WTMETHOD>
<WTCUSTOM>
				For Each oAddress in oAddresss
					With oAddress
						tmpStreet = .Street1
						tmpUnit   = .Street2
						tmpCity   = .City
						tmpState  = .State
						tmpZip    = .Zip
					End With
				Next
</WTCUSTOM>					
					</WTOBJECT>
					<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Certificate.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; &amp; CStr(tmpCourseID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
						<WTMETHOD name="Load"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTOBJECT>
<WTCUSTOM>
		xmlHTMLFile = Replace( xmlHTMLFile, "{name}", CleanXMLComment(tmpName) )
		xmlHTMLFile = Replace( xmlHTMLFile, "{date}", tmpDate )
		xmlHTMLFile = Replace( xmlHTMLFile, "{score}", tmpScore )
		xmlHTMLFile = Replace( xmlHTMLFile, "{street}", CleanXMLComment(tmpStreet + " " + tmpUnit) )
		xmlHTMLFile = Replace( xmlHTMLFile, "{city}", CleanXMLComment(tmpCity) )
		xmlHTMLFile = Replace( xmlHTMLFile, "{state}", CleanXMLComment(tmpState) )
		xmlHTMLFile = Replace( xmlHTMLFile, "{zip}", CleanXMLComment(tmpZip) )
</WTCUSTOM>
				</WTCODEGROUP>
			</WTACTION>
			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1111" caption="Courses" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--===============================================================================-->
			<WTPARAM name="CourseCategoryID" datatype="number"/> 
			<WTPARAM name="CourseCategoryName" datatype="text"/>
			<WTPARAM name="CompanyID" datatype="number"/> 
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTMETHOD name="ListCourse">
						<WTPARAM name="CourseCategoryID" direction="input" value="PARAM(CourseCategoryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW>
					<WTSTATIC col="1" value="PARAM(CourseCategoryName)" class="PageHeading"/>
				</WTROW>

				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Course">
						<WTCOLUMN width="60" align="left" valign="top" label="CourseName"/>
						<WTCOLUMN width="40" align="left" valign="top" label="CourseLength"/>

						<WTROW>
							<WTSTATIC col="1" value="DATA(Course.CourseName)">
								<WTLINK name="1103"><WTPARAM name="CourseID" value="DATA(Course.CourseID)"/></WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Course.CourseLength)">
								<WTLINK name="1103"><WTPARAM name="CourseID" value="DATA(Course.CourseID)"/></WTLINK>
							</WTSTATIC>

						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="1112" caption="My Courses" action="5" header="false" footer="false" navbar="false" wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="TrainerID" datatype="number"/> 
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
      <WTPARAM name="Popup" datatype="number"/>

      <WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(CourseName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Add" type="Add">
				<WTRETURN>
					<WTLINK name="1102">
						<WTPARAM name="TrainerID" value="PARAM(TrainerID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTMETHOD name="FindTrainer">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="TrainerID" direction="input" value="PARAM(TrainerID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>
				
				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="150" align="left"/>
						<WTCOLUMN width="450" align="right"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(elearn.jpg)" imgwidth="120" align="center"/>
							<WTSTATIC col="2" label="MyCoursesText" align="left" valign="center" class="Prompt" newline="1"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW>
					<WTBUTTON col="1" action="4" value="CONST(NewCourse)" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
			 		<WTCONDITION expr="IsEmployee"/>
					<WTSTATIC col="1" label="Import" align="right">
						<WTLINK name="11Import" target="Import">
							<WTPARAM name="TrainerID" value="PARAM(TrainerID)"/>
						</WTLINK>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader"/>
					<WTCOMBO col="1" value="ATTR(Courses.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
          <WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
          <WTBUTTON col="1" action="3" value="CONST(Return)" align="center">
            <WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" align="left" label="ClickRating" class="prompt"/>
				</WTROW>

				<WTSTATIC label="GradeHomework"/>

				<WTROW>
					<WTRECORDSET col="1" prevnext="true" graybar="true" entity="Course">
						<WTCOLUMN width="11" align="left" valign="top" label="Rating"/>
						<WTCOLUMN width="63" align="left" valign="top" label="CourseName"/>
						<WTCOLUMN width="13" align="left" valign="top" label="CourseType"/>
						<WTCOLUMN width="13" align="right" valign="top" label="Lessons"/>

						<WTROW>
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
							 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
								<WTLINK name="1313" target="Ratings">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Course.CourseName)" space="1"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                    <WTLINK name="1103">
                      <WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
								<WTCODEGROUP>
							 		<WTCONDITION expr="IsEmployee"/>
                  <WTSTATIC space="1"/>
                  <WTIMAGE value="CONST(ArrowDown.gif)" alt="Export" imgalign="absmiddle">
										<WTLINK name="ExportCourse" target="Export">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Course.CourseType)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(lesson_status2.gif)" alt="Lessons">
										<WTLINK name="2311">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
                      <WTPARAM name="ContentPage" value="CONST(3)"/>
                    </WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview.gif)" alt="Preview">
										<WTLINK name="1330" target="preview">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
                      <WTPARAM name="ContentPage" value="CONST(3)"/>
                      <WTPARAM name="Popup" value="CONST(1)"/>
                    </WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(copy.gif)" alt="Copy">
										<WTLINK name="1105" target="CopyCourse">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(homework.gif)" alt="GradeHomework">
										<WTLINK name="6811" target="blank">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" fontcolor="gray">
								<WTSTATIC value="CONST(#)"/>
								<WTSTATIC value="DATA(Course.CourseID)" space="2"/>
								<WTSTATIC value="DATA(Course.Status)"/>
								<WTSTATIC value="CONST( - )"/>
								<WTSTATIC value="DATA(Course.Language)" space="2"/>
								<WTSTATIC value="DATA(Course.CourseDate)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Course.CourseLevel)" fontcolor="gray"/>
							<WTSTATIC col="4"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

      </WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="11Import" caption="Import Course" header="false" footer="false" navbar="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="TrainerID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="Cnt" datatype="number"/>

			<WTACTION id="1" name="Update" type="Update">
				<WTRETURN>
					<WTLINK name="ImportCourse" return="false">
						<WTPARAM name="TrainerID" value="PARAM(TrainerID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>
				
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="ImportCourse"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="prompt" align="center">
							<WTSTATIC label="ImportCourseText"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC tag="Trainer" value="PARAM(TrainerID)"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC tag="Company" value="PARAM(CompanyID)"/>
						</WTSTATIC>
					</WTROW>

				</WTCODEGROUP>
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(Txn)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC value="PARAM(Cnt)" space="1"/>
							<WTSTATIC label="ImportSuccess"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Import)" align="center">
				 		<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="1113" caption="Course Search" focus="false" navbar="false" header="false" footer="false"
		 page-left="0" margin="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
			<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="IsSearch" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>
			<WTINCLUDE name="Search.asp" />

			<WTDATATXN name="Courses"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(0)"/>
			<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="CONST(0)"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>
			<!--
			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10004" message="Oops, Please enter text to search for."/>
					<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(0)"/>
				</WTCODEGROUP>
			</WTACTION>
-->
			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="1" name="Include" type="Add">
				<!--	Refresh current list -->
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
				<WTCONDITION expr="PARAM(IsSearch)" oper="equal" value="CONST(1)"/>
				<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
				<WTMETHOD name="FetchCompany">
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
				</WTMETHOD>
				<WTMETHOD name="Load">
					<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
			</WTOBJECT>
			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTCONDITION expr="PARAM(IsSearch)" oper="equal" value="CONST(1)"/>
				<WTCUSTOM>
					tmpSearchText = SearchText(Trim(reqSearchText))

					reqBookmark = .Search(reqBookmark, tmpSearchText, reqDirection, CLng(reqCompanyID))

					'Check for error for Noise Words only
					If Err.Number = -2147217900 Then
					Err.Number = 0
					reqSearchText = ""
					End If
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If

					For Each oCourse in oCourses
					With oCourse
					If IsDate(.CourseDate) Then
					If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
					.CourseDate = reqSysDate
					End If
					End If
					End With
					Next

					If CLng(tmpInclude) = 1 And CLng(reqCompanyID) &gt; 0 Then
					tmpCnt = 0
					Set oOrgCourse = server.CreateObject("ptsOrgCourseUser.COrgCourse")
					If oOrgCourse Is Nothing Then
					DoError Err.Number, Err.Source, "Unable to Create Object - ptsOrgCourseUser.COrgCourse"
					Else
					For Each oLoopCourse in oCourses
					tmpID = oLoopCourse.CourseID
					If Request.Form.Item(tmpID) = "on" Then
					tmpOrgCourseID = oOrgCourse.GetOrgCourse( reqOrgID, tmpID, reqSysUserID )
					If tmpOrgCourseID = 0 Then
					tmpCnt = tmpCnt + 1
					With oOrgCourse
					.OrgID = CLng(reqOrgID)
					.CourseID = tmpID
					.Status = 1
					.QuizLimit = CLng(tmpQuizLimit)
					.Add CLng(reqSysUserID)
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
					End With
					End If
					End If
					Next
					End If
					Set oOrgCourse = Nothing
					DoError reqUploadError, "Include", tmpCnt &amp; " Courses Included!"
					End If
				</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTSTATIC col="1" merge="4" align="left" label="IncludeCoursesText" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTBUTTON col="1" merge="4" action="1" align="center" value="CONST(Include)">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="4" value="CONST(Close)">
						<WTCLICK>window.parent.parent.opener.location.reload();window.parent.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" prevnext="top" entity="Course">
						<WTCOLUMN width="11"/>
						<WTCOLUMN width="68"/>
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="11"/>

						<WTROW margin-top="3">
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
							 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
								<WTLINK name="1313" target="Ratings">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC col="2" prespace="false">
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTCHECK name="&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC value="CONST((preview))">
										<WTLINK name="1330" target="preview">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST( - )" bold="true"/>
								<WTSTATIC value="DATA(Course.TrainerName)">
									<WTLINK name="0308" target="trainer">
										<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" align="right" valign="top">
								<WTSTATIC value="DATA(Course.CourseLength)"/>
								<WTSTATIC value="CONST( min.)"/>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(Course.Language)" align="right" valign="top"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" merge="3" value="DATA(Course.Description)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTBUTTON col="1" merge="4" action="1" align="center" value="CONST(Include)">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="4" value="CONST(Close)">
						<WTCLICK>window.parent.parent.opener.location.reload();window.parent.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_1113" caption="Course Search" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="IsSearch" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>
			<WTINCLUDE name="Search.asp" />

			<WTDATATXN name="Courses"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(0)"/>
			<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="CONST(0)"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>
			<!--
			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10004" message="Oops, Please enter text to search for."/>
					<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(0)"/>
				</WTCODEGROUP>
			</WTACTION>
-->
			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="1" name="Include" type="Add">
				<!--	Refresh current list -->
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(IsSearch)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
				<WTCONDITION expr="PARAM(IsSearch)" oper="equal" value="CONST(1)"/>
				<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" connector="and"/>
				<WTMETHOD name="FetchCompany">
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
				</WTMETHOD>
				<WTMETHOD name="Load">
					<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
			</WTOBJECT>
			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTCONDITION expr="PARAM(IsSearch)" oper="equal" value="CONST(1)"/>
				<WTCUSTOM>
					tmpSearchText = SearchText(Trim(reqSearchText))

					reqBookmark = .Search(reqBookmark, tmpSearchText, reqDirection, CLng(reqCompanyID))

					'Check for error for Noise Words only
					If Err.Number = -2147217900 Then
					Err.Number = 0
					reqSearchText = ""
					End If
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If

					For Each oCourse in oCourses
					With oCourse
					If IsDate(.CourseDate) Then
					If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
					.CourseDate = reqSysDate
					End If
					End If
					End With
					Next

					If CLng(tmpInclude) = 1 And CLng(reqCompanyID) &gt; 0 Then
					tmpCnt = 0
					Set oOrgCourse = server.CreateObject("ptsOrgCourseUser.COrgCourse")
					If oOrgCourse Is Nothing Then
					DoError Err.Number, Err.Source, "Unable to Create Object - ptsOrgCourseUser.COrgCourse"
					Else
					For Each oLoopCourse in oCourses
					tmpID = oLoopCourse.CourseID
					If Request.Form.Item(tmpID) = "on" Then
					tmpOrgCourseID = oOrgCourse.GetOrgCourse( reqOrgID, tmpID, reqSysUserID )
					If tmpOrgCourseID = 0 Then
					tmpCnt = tmpCnt + 1
					With oOrgCourse
					.OrgID = CLng(reqOrgID)
					.CourseID = tmpID
					.Status = 1
					.QuizLimit = CLng(tmpQuizLimit)
					.Add CLng(reqSysUserID)
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
					End With
					End If
					End If
					Next
					End If
					Set oOrgCourse = Nothing
					DoError reqUploadError, "Include", tmpCnt &amp; " Courses Included!"
					End If
				</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" prevnext="top" entity="Course">
						<WTCOLUMN width="21"/>
						<WTCOLUMN width="79"/>

						<WTROW margin-top="3">
							<WTSTATIC col="1" merge="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="m_1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="m_1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="m_1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Course.CourseLength)"/>
									<WTSTATIC value="CONST( min.)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="Recommended" bold="true" >
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(1)" connector="and"/>
									</WTSTATIC>
									<WTSTATIC label="Required" bold="true">
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(2)" connector="and"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
									 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
										<WTLINK name="m_1313" target="Ratings">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC newline="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Course.Description)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1114" caption="Course List" focus="false" navbar="false" header="false" footer="false" wrapper="false"
		 page-left="0" margin="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="CategoryID" datatype="number"/>
			<WTPARAM name="tempCategoryID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			
			<WTPARAM name="ForumID" datatype="number"/>
			<WTPARAM name="IsChat" datatype="number"/>
			<WTPARAM name="IsForum" datatype="number"/>
			<WTPARAM name="CategoryName" datatype="text"/>
			<WTPARAM name="tempCategoryName" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTSETATTRIBUTE name="CONST(tmpInsert)" value="CONST(0)"/>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses"/>
			</WTACTION>
			
			<WTACTION name="Insert" type="Insert" id="1">
				<WTSETATTRIBUTE name="CONST(tmpInsert)" value="CONST(1)"/>
			</WTACTION>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryID)" value="CONST(-reqCategoryID)"/>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CategoryID)" oper="greater" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryID)" value="CONST(reqCategoryID)"/>
			</WTCODEGROUP>

			<WTOBJECT name="CourseCategory" project="ptsCourseCategoryUser" class="CCourseCategory">
				<WTCONDITION expr="PARAM(CategoryID)" oper="greater" value="CONST(0)"/>
				<WTMETHOD name="Load">
					<WTPARAM name="CourseCategoryID" direction="input" value="PARAM(CategoryID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="PARAM(ForumID)" value="ATTR(ForumID)"/>
				<WTSETATTRIBUTE name="PARAM(IsChat)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsForum)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(CategoryName)" value="ATTR(CourseCategoryName)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryName)" value="CONST(&quot;Add folder &quot; + reqCategoryName + &quot; to my favorite&quot; )"/>
			</WTOBJECT>
			
			<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
				<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
				<WTMETHOD name="Load">
					<WTPARAM name="OrgID" direction="input" value="CONST(-reqCategoryID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="PARAM(IsChat)" value="ATTR(IsChat)"/>
				<WTSETATTRIBUTE name="PARAM(IsForum)" value="ATTR(IsForum)"/>
				<WTSETATTRIBUTE name="PARAM(ForumID)" value="ATTR(ForumID)"/>
				<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
				<WTSETATTRIBUTE name="PARAM(CategoryName)" value="ATTR(OrgName)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryName)" value="CONST(&quot;Add folder &quot; + reqCategoryName + &quot; to my favorite&quot; )"/>
			</WTOBJECT>
			
			<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
				<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
				<WTMETHOD name="FetchCompany">
					<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
				</WTMETHOD>			
				<WTMETHOD name="Load">
					<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
			</WTOBJECT>
			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTMETHOD name="ListCourseCategory">
					<WTCONDITION expr="PARAM(CategoryID)" oper="greater" value="CONST(0)"/>
					<WTPARAM name="CourseCategoryID" direction="input" value="PARAM(CategoryID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
					<!-- PRIVATE COURSES (-x) -->
					<WTMETHOD name="ListPrivate"> <!-- all private company courses -->
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="ListOrg">
						<WTCONDITION expr="IsMemberOnly"/> <!-- all org courses -->
						<WTPARAM name="OrgID" direction="input" value="CONST(CLng(abs(reqCategoryID)))"/>
					</WTMETHOD>
				</WTCODEGROUP>
<WTCUSTOM>
				For Each oCourse in oCourses
				   With oCourse
						If IsDate(.CourseDate) Then
							If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
								.CourseDate = reqSysDate
							End If
						End If
				   End With
				Next

				If CLng(tmpInsert) = 1 And CLng(reqOrgID) &gt; 0 Then
					tmpCnt = 0
					Set oOrgCourse = server.CreateObject("ptsOrgCourseUser.COrgCourse")
					If oOrgCourse Is Nothing Then
					   DoError Err.Number, Err.Source, "Unable to Create Object - ptsOrgCourseUser.COrgCourse"
					Else
						For Each oLoopCourse in oCourses
							tmpID = oLoopCourse.CourseID
							If Request.Form.Item(tmpID) = "on" Then
								tmpOrgCourseID = oOrgCourse.GetOrgCourse( reqOrgID, tmpID, reqSysUserID )
								If tmpOrgCourseID = 0 Then
									tmpCnt = tmpCnt + 1
									With oOrgCourse
										.OrgID = CLng(reqOrgID)
										.CourseID = tmpID
										.Status = 1
										.QuizLimit = CLng(tmpQuizLimit)
										.Add CLng(reqSysUserID)
										If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
									End With
								End If
							End If
						Next
					End If
					Set oOrgCourse = Nothing
					DoError reqUploadError, "Include", tmpCnt &amp; " Courses Included!"
				End If
</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="65"/>
				<WTCOLUMN width="370"/>
				<WTCOLUMN width="55"/>
				<WTCOLUMN width="110"/>

				<WTSTATIC label="ToFavorites"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
						content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="3">
					<WTSTATIC col="1" merge="4" align="center" class="PageHeading" bold="true">
					<WTSTATIC value="PARAM(CategoryName)" space="1"/>
					<WTSTATIC label="Courses"/>
					</WTSTATIC>
				</WTROW>
<!--				
				<WTROW margin-top="3">
					<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" align="center">
						<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(CategoryID)" oper="greater" value="CONST(0)" connector="and"/>
						<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat( /DATA/LANGUAGE/LABEL[@name='Add'], ' ', /DATA/PARAM/@categoryname, ' ', /DATA/LANGUAGE/LABEL[@name='ToFavorites'])&quot;/>)" bold="true" >
							<WTLINK name="4620" target="Favorite">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								<WTPARAM name="RefType" value="CONST(1)"/>
								<WTPARAM name="RefID" value="PARAM(tempCategoryID)"/>
								<WTPARAM name="Name" value="PARAM(CategoryName)"/>
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>
					<WTSTATIC col="1" merge="4" align="center">
						<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)" connector="and"/>
						<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;concat( /DATA/LANGUAGE/LABEL[@name='Add'], ' ', /DATA/PARAM/@categoryname, ' ', /DATA/LANGUAGE/LABEL[@name='ToFavorites'])&quot;/>)" bold="true" >
							<WTLINK name="4620" target="Favorite">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								<WTPARAM name="RefType" value="CONST(2)"/>
								<WTPARAM name="RefID" value="PARAM(tempCategoryID)"/>
								<WTPARAM name="Name" value="PARAM(CategoryName)"/>
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
-->				
<!--
				<WTROW margin-top="3" margin-bottom="3">
					<WTCONDITION expr="PARAM(ForumID)" oper="greater" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" align="center" bold="true" class="PageHeading">
						<WTCONDITION expr="NotAnonymous"/>
						<WTSTATIC label="ConferenceRoom">
							<WTCONDITION expr="PARAM(IsChat)" oper="not-equal" value="CONST(0)"/>
							<WTLINK name="8420" return="false" target="_blank">
								<WTPARAM name="ForumID" value="PARAM(ForumID)"/>
							</WTLINK>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(IsForum)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC value="CONST( | )"/>
							<WTSTATIC label="Forum">
								<WTLINK name="8411" return="false" target="_blank">
									<WTPARAM name="ForumID" value="PARAM(ForumID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
-->
				<WTROW margin-top="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTSTATIC col="1" merge="4" align="left" label="IncludeCoursesText" class="prompt"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTBUTTON col="1" merge="4" action="1" align="center" value="CONST(Include)">
							<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="4" value="CONST(Close)">
							<WTCLICK>window.parent.parent.opener.location.reload();window.parent.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>

					<WTROW>
						<WTSTATIC col="1" merge="4" align="left" label="ClickRating" class="prompt"/>
					</WTROW>
					<WTREPEAT entity="Course">
						<WTROW margin-top="3">
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
							 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
								<WTLINK name="1313" target="Ratings">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTCHECK col="2" name="&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;">
								<WTCONDITION expr="IsEmployee"/>
								<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
								<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							</WTCHECK>	
							
							<WTSTATIC col="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="1330" target="preview">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST( - )" bold="true"/>
								<WTSTATIC value="DATA(Course.TrainerName)">
									<WTLINK name="0308" target="trainer">
										<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>

							<WTSTATIC col="3" align="right" valign="top">
								<WTSTATIC value="DATA(Course.CourseLength)"/>
								<WTSTATIC value="CONST( min.)"/>
							</WTSTATIC>
							
							<WTSTATIC col="4" align="right" valign="top" >
								<WTSTATIC value="DATA(Course.Language)" >
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="Recommended" bold="true" >
									<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
									<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(1)" connector="and"/>
								</WTSTATIC>
								<WTSTATIC label="Required" bold="true">
									<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
									<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(2)" connector="and"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" merge="3" value="DATA(Course.Description)"/>
						</WTROW>
					</WTREPEAT>
				</WTCODEGROUP>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTBUTTON col="1" merge="4" action="1" align="center" value="CONST(Include)">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="4" value="CONST(Close)">
						<WTCLICK>window.parent.parent.opener.location.reload();window.parent.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1114" caption="Course List" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="CategoryID" datatype="number"/>
			<WTPARAM name="tempCategoryID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>

			<WTPARAM name="ForumID" datatype="number"/>
			<WTPARAM name="IsChat" datatype="number"/>
			<WTPARAM name="IsForum" datatype="number"/>
			<WTPARAM name="CategoryName" datatype="text"/>
			<WTPARAM name="tempCategoryName" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTSETATTRIBUTE name="CONST(tmpInsert)" value="CONST(0)"/>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses"/>
			</WTACTION>

			<WTACTION name="Insert" type="Insert" id="1">
				<WTSETATTRIBUTE name="CONST(tmpInsert)" value="CONST(1)"/>
			</WTACTION>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryID)" value="CONST(-reqCategoryID)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CategoryID)" oper="greater" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryID)" value="CONST(reqCategoryID)"/>
			</WTCODEGROUP>

			<WTOBJECT name="CourseCategory" project="ptsCourseCategoryUser" class="CCourseCategory">
				<WTCONDITION expr="PARAM(CategoryID)" oper="greater" value="CONST(0)"/>
				<WTMETHOD name="Load">
					<WTPARAM name="CourseCategoryID" direction="input" value="PARAM(CategoryID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="PARAM(ForumID)" value="ATTR(ForumID)"/>
				<WTSETATTRIBUTE name="PARAM(IsChat)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsForum)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(CategoryName)" value="ATTR(CourseCategoryName)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryName)" value="CONST(&quot;Add folder &quot; + reqCategoryName + &quot; to my favorite&quot; )"/>
			</WTOBJECT>

			<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
				<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
				<WTMETHOD name="Load">
					<WTPARAM name="OrgID" direction="input" value="CONST(-reqCategoryID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="PARAM(IsChat)" value="ATTR(IsChat)"/>
				<WTSETATTRIBUTE name="PARAM(IsForum)" value="ATTR(IsForum)"/>
				<WTSETATTRIBUTE name="PARAM(ForumID)" value="ATTR(ForumID)"/>
				<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
				<WTSETATTRIBUTE name="PARAM(CategoryName)" value="ATTR(OrgName)"/>
				<WTSETATTRIBUTE name="PARAM(tempCategoryName)" value="CONST(&quot;Add folder &quot; + reqCategoryName + &quot; to my favorite&quot; )"/>
			</WTOBJECT>

			<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
				<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
				<WTMETHOD name="FetchCompany">
					<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
				</WTMETHOD>
				<WTMETHOD name="Load">
					<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
			</WTOBJECT>
			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTMETHOD name="ListCourseCategory">
					<WTCONDITION expr="PARAM(CategoryID)" oper="greater" value="CONST(0)"/>
					<WTPARAM name="CourseCategoryID" direction="input" value="PARAM(CategoryID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CategoryID)" oper="less" value="CONST(0)"/>
					<!-- PRIVATE COURSES (-x) -->
					<WTMETHOD name="ListPrivate">
						<!-- all private company courses -->
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="ListOrg">
						<WTCONDITION expr="IsMemberOnly"/>
						<!-- all org courses -->
						<WTPARAM name="OrgID" direction="input" value="CONST(CLng(abs(reqCategoryID)))"/>
					</WTMETHOD>
				</WTCODEGROUP>
				<WTCUSTOM>
					For Each oCourse in oCourses
					With oCourse
					If IsDate(.CourseDate) Then
					If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
					.CourseDate = reqSysDate
					End If
					End If
					End With
					Next

					If CLng(tmpInsert) = 1 And CLng(reqOrgID) &gt; 0 Then
					tmpCnt = 0
					Set oOrgCourse = server.CreateObject("ptsOrgCourseUser.COrgCourse")
					If oOrgCourse Is Nothing Then
					DoError Err.Number, Err.Source, "Unable to Create Object - ptsOrgCourseUser.COrgCourse"
					Else
					For Each oLoopCourse in oCourses
					tmpID = oLoopCourse.CourseID
					If Request.Form.Item(tmpID) = "on" Then
					tmpOrgCourseID = oOrgCourse.GetOrgCourse( reqOrgID, tmpID, reqSysUserID )
					If tmpOrgCourseID = 0 Then
					tmpCnt = tmpCnt + 1
					With oOrgCourse
					.OrgID = CLng(reqOrgID)
					.CourseID = tmpID
					.Status = 1
					.QuizLimit = CLng(tmpQuizLimit)
					.Add CLng(reqSysUserID)
					If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
					End With
					End If
					End If
					Next
					End If
					Set oOrgCourse = Nothing
					DoError reqUploadError, "Include", tmpCnt &amp; " Courses Included!"
					End If
				</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="22"/>
				<WTCOLUMN width="78"/>

				<WTSTATIC label="ToFavorites"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="3">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading" bold="true">
						<WTSTATIC value="PARAM(CategoryName)" space="1"/>
						<WTSTATIC label="Courses"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" label="ClickRating" class="prompt"/>
					</WTROW>
					<WTREPEAT entity="Course">
						<WTROW margin-top="3">
							<WTSTATIC col="1" merge="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="m_1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="m_1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="m_1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Course.CourseLength)"/>
									<WTSTATIC value="CONST( min.)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="Recommended" bold="true" >
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(1)" connector="and"/>
									</WTSTATIC>
									<WTSTATIC label="Required" bold="true">
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(2)" connector="and"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
									 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
										<WTLINK name="m_1313" target="Ratings">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC newline="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Course.Description)"/>
						</WTROW>
					</WTREPEAT>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1115" caption="Single Course" focus="false" navbar="false" header="false" footer="false"
		 page-left="0" margin="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/> <!-- current Member -->
			<WTPARAM name="CourseID" datatype="number"/> <!-- MemberID of Favorites (sessions) -->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(0)"/>

			<WTCODEGROUP>
				<WTCONDITION expr="CONST(reqActionCode)" oper="equal" value="CONST(1)"/>
				<WTSETATTRIBUTE name="CONST(reqActionCode)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpInsert)" value="CONST(1)"/>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
				</WTOBJECT>			
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
				</WTOBJECT>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListSingleCourse">
							<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
<WTCUSTOM>
				For Each oCourse in oCourses
				   With oCourse
						If IsDate(.CourseDate) Then
							If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
								.CourseDate = reqSysDate
							End If
						End If
				   End With
				Next

				If CLng(tmpInsert) = 1 And CLng(reqOrgID) &gt; 0 Then
					tmpCnt = 0
					Set oOrgCourse = server.CreateObject("ptsOrgCourseUser.COrgCourse")
					If oOrgCourse Is Nothing Then
					   DoError Err.Number, Err.Source, "Unable to Create Object - ptsOrgCourseUser.COrgCourse"
					Else
						For Each oLoopCourse in oCourses
							tmpID = oLoopCourse.CourseID
							If Request.Form.Item(tmpID) = "on" Then
								tmpOrgCourseID = oOrgCourse.GetOrgCourse( reqOrgID, tmpID, reqSysUserID )
								If tmpOrgCourseID = 0 Then
									tmpCnt = tmpCnt + 1
									With oOrgCourse
										.OrgID = CLng(reqOrgID)
										.CourseID = tmpID
										.Status = 1
										.QuizLimit = CLng(tmpQuizLimit)
										.Add CLng(reqSysUserID)
										If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
									End With
								End If
							End If
						Next
					End If
					Set oOrgCourse = Nothing
					DoError reqUploadError, "Include", tmpCnt &amp; " Courses Included!"
				End If
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="65"/>
				<WTCOLUMN width="410"/>
				<WTCOLUMN width="55"/>
				<WTCOLUMN width="70"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
						content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					<WTROW margin-bottom="6">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTSTATIC col="1" merge="4" align="left" label="IncludeCoursesText" class="prompt"/>
					</WTROW>

					<WTROW>
						<WTSTATIC col="1" merge="4" align="left" label="ClickRating" class="prompt"/>
					</WTROW>
					<WTREPEAT entity="Course">
						<WTROW margin-top="3">
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
							 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
								<WTLINK name="1313" target="Ratings">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTCHECK col="2" name="&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;">
								<WTCONDITION expr="IsEmployee"/>
								<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
								<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							</WTCHECK>	
							
							<WTSTATIC col="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC value="CONST((preview))">
										<WTLINK name="1330" target="preview">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST( - )" bold="true"/>
								<WTSTATIC value="DATA(Course.TrainerName)">
									<WTLINK name="0308" target="trainer">
										<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>

							<WTSTATIC col="3" align="right" valign="top">
								<WTSTATIC value="DATA(Course.CourseLength)"/>
								<WTSTATIC value="CONST( min.)"/>
							</WTSTATIC>
							
							<WTSTATIC col="4" align="right" valign="top" >
								<WTSTATIC value="DATA(Course.Language)" >
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="Recommended" bold="true" >
									<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
									<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(1)" connector="and"/>
								</WTSTATIC>
								<WTSTATIC label="Required" bold="true">
									<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
									<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(2)" connector="and"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" merge="3" value="DATA(Course.Description)"/>
						</WTROW>
					</WTREPEAT>
				</WTCODEGROUP>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTBUTTON col="1" merge="4" action="1" align="center" value="CONST(Include)">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="4" value="CONST(Close)">
						<WTCLICK>window.parent.parent.opener.location.reload();window.parent.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1115" caption="Single Course" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<!-- current Member -->
			<WTPARAM name="CourseID" datatype="number"/>
			<!-- MemberID of Favorites (sessions) -->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(0)"/>

			<WTCODEGROUP>
				<WTCONDITION expr="CONST(reqActionCode)" oper="equal" value="CONST(1)"/>
				<WTSETATTRIBUTE name="CONST(reqActionCode)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpInsert)" value="CONST(1)"/>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
				</WTOBJECT>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListSingleCourse">
							<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCUSTOM>
						For Each oCourse in oCourses
						With oCourse
						If IsDate(.CourseDate) Then
						If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
						.CourseDate = reqSysDate
						End If
						End If
						End With
						Next

						If CLng(tmpInsert) = 1 And CLng(reqOrgID) &gt; 0 Then
						tmpCnt = 0
						Set oOrgCourse = server.CreateObject("ptsOrgCourseUser.COrgCourse")
						If oOrgCourse Is Nothing Then
						DoError Err.Number, Err.Source, "Unable to Create Object - ptsOrgCourseUser.COrgCourse"
						Else
						For Each oLoopCourse in oCourses
						tmpID = oLoopCourse.CourseID
						If Request.Form.Item(tmpID) = "on" Then
						tmpOrgCourseID = oOrgCourse.GetOrgCourse( reqOrgID, tmpID, reqSysUserID )
						If tmpOrgCourseID = 0 Then
						tmpCnt = tmpCnt + 1
						With oOrgCourse
						.OrgID = CLng(reqOrgID)
						.CourseID = tmpID
						.Status = 1
						.QuizLimit = CLng(tmpQuizLimit)
						.Add CLng(reqSysUserID)
						If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
						End With
						End If
						End If
						Next
						End If
						Set oOrgCourse = Nothing
						DoError reqUploadError, "Include", tmpCnt &amp; " Courses Included!"
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="22"/>
				<WTCOLUMN width="78"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" label="ClickRating" class="prompt"/>
					</WTROW>
					<WTREPEAT entity="Course">
						<WTROW margin-top="3">
							<WTSTATIC col="1" merge="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="m_1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="m_1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="m_1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Course.CourseLength)"/>
									<WTSTATIC value="CONST( min.)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="Recommended" bold="true" >
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(1)" connector="and"/>
									</WTSTATIC>
									<WTSTATIC label="Required" bold="true">
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(2)" connector="and"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
									 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
										<WTLINK name="m_1313" target="Ratings">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC newline="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Course.Description)"/>
						</WTROW>
					</WTREPEAT>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1116" caption="Favorite Courses" focus="false" navbar="false" header="false" footer="false"
		 page-left="0" margin="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FavoritesName" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(FavoritesName)" value="ATTR(OrgName)"/>
				</WTOBJECT>
			
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListFavorite">
							<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
<WTCUSTOM>
					For Each oCourse in oCourses
					   With oCourse
							If IsDate(.CourseDate) Then
								If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
									.CourseDate = reqSysDate
								End If
							End If
					   End With
					Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="65"/>
				<WTCOLUMN width="410"/>
				<WTCOLUMN width="55"/>
				<WTCOLUMN width="70"/>
				
				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
						content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="4" align="center" class="PageHeading" bold="true">
					<WTSTATIC value="PARAM(FavoritesName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="4" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTREPEAT entity="Course">
					<WTROW margin-top="3">
						<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="middle"
						 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
							<WTLINK name="1313" target="Ratings">
								<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
							</WTLINK>
						</WTIMAGE>
						<WTIMAGE col="2" value="CONST(new.gif)" align="left" valign="center">
							<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
						</WTIMAGE>
						<WTSTATIC col="2" prespace="false" valign="top">
							<WTSTATIC value="DATA(Course.CourseName)" bold="true">
								<WTLINK name="1120">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
							<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
								<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
								<WTLINK name="1119">
									<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC col="2" valign="top">
							<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="Register" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="3" align="right" valign="top">
							<WTSTATIC value="DATA(Course.CourseLength)"/>
							<WTSTATIC value="CONST( min.)"/>
						</WTSTATIC>
						<WTSTATIC col="4" value="DATA(Course.Language)" align="right" valign="top"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" align="left" valign="top">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(video.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(audio.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(quiz.gif)"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="2" merge="4" value="DATA(Course.Description)"/>
					</WTROW>
				</WTREPEAT>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1116" caption="Favorite Courses" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FavoritesName" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(FavoritesName)" value="ATTR(OrgName)"/>
				</WTOBJECT>

				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListFavorite">
							<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCUSTOM>
						For Each oCourse in oCourses
						With oCourse
						If IsDate(.CourseDate) Then
						If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
						.CourseDate = reqSysDate
						End If
						End If
						End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="65"/>
				<WTCOLUMN width="235"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading" bold="true">
						<WTSTATIC value="PARAM(FavoritesName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" label="ClickRating" class="prompt"/>
					</WTROW>
					<WTREPEAT entity="Course">
						<WTROW margin-top="3">
							<WTSTATIC col="1" merge="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="m_1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="m_1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="m_1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Course.CourseLength)"/>
									<WTSTATIC value="CONST( min.)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
									 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
										<WTLINK name="m_1313" target="Ratings">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC newline="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Course.Description)"/>
						</WTROW>
					</WTREPEAT>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1126" caption="Program Courses" focus="false" navbar="false" header="false" footer="false"
		 page-left="0" margin="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListProgram">
							<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
<WTCUSTOM>
					For Each oCourse in oCourses
					   With oCourse
							If IsDate(.CourseDate) Then
								If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
									.CourseDate = reqSysDate
								End If
							End If
					   End With
					Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="65"/>
				<WTCOLUMN width="370"/>
				<WTCOLUMN width="55"/>
				<WTCOLUMN width="110"/>
				
				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
						content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="4" value="ATTR(Org.OrgName)" align="center" class="PageHeading" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="4" tag="RequiredCredits" value="ATTR(Org.Credits)" align="center" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="4" value="ATTR(Org.Description)" align="left" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="4" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTREPEAT entity="Course">
					<WTROW margin-top="3">
						<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="middle"
						 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
							<WTLINK name="1313" target="Ratings">
								<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
							</WTLINK>
						</WTIMAGE>
						<WTSTATIC col="2" align="left" valign="top">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
								<WTIMAGE value="CONST(new.gif)" align="left" valign="center" imgalign="absmiddle"/>
								<WTSTATIC space="1"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Status)" oper="equal" value="CONST(2)"/>
								<WTIMAGE value="CONST(CheckGreen.gif)" alt="Required" align="left" valign="center" imgalign="absmiddle"/>
								<WTSTATIC space="1"/>
							</WTCODEGROUP>
							<WTSTATIC value="DATA(Course.CourseName)" bold="true">
								<WTLINK name="1120">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
							<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
								<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
								<WTLINK name="1119">
									<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@credit&quot;/&gt; credits))" fontcolor="purple">
								<WTCONDITION expr="DATA(Course.Credit)" oper="greater" value="CONST(0)"/>
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
								<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="Register" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="3" align="right" valign="top">
							<WTSTATIC value="DATA(Course.CourseLength)"/>
							<WTSTATIC value="CONST( min.)"/>
						</WTSTATIC>
						<WTSTATIC col="4" align="right" valign="top" >
							<WTSTATIC value="DATA(Course.Language)" >
								<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
								<WTSTATIC label="Recommended" bold="true" >
									<WTCONDITION expr="DATA(Course.Status)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="Required" bold="true">
									<WTCONDITION expr="DATA(Course.Status)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" align="left" valign="top">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(video.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(audio.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(quiz.gif)"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="2" merge="4" value="DATA(Course.Description)"/>
					</WTROW>
				</WTREPEAT>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1126" caption="Program Courses" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListProgram">
							<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCUSTOM>
						For Each oCourse in oCourses
						With oCourse
						If IsDate(.CourseDate) Then
						If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
						.CourseDate = reqSysDate
						End If
						End If
						End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="22"/>
				<WTCOLUMN width="78"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" value="ATTR(Org.OrgName)" align="center" class="PageHeading" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="RequiredCredits" value="ATTR(Org.Credits)" align="center" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" value="ATTR(Org.Description)" align="left" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" label="ClickRating" class="prompt"/>
					</WTROW>
					<WTREPEAT entity="Course">
						<WTROW margin-top="3">
							<WTSTATIC col="1" merge="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Status)" oper="equal" value="CONST(2)"/>
									<WTIMAGE value="CONST(CheckGreen.gif)" alt="Required" align="left" valign="center" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="m_1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="m_1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="m_1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@credit&quot;/&gt; credits))">
										<WTCONDITION expr="DATA(Course.Credit)" oper="greater" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Course.CourseLength)"/>
									<WTSTATIC value="CONST( min.)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="Recommended" bold="true" >
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(1)" connector="and"/>
									</WTSTATIC>
									<WTSTATIC label="Required" bold="true">
										<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
										<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(2)" connector="and"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
									 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
										<WTLINK name="m_1313" target="Ratings">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC newline="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Course.Description)"/>
						</WTROW>
					</WTREPEAT>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1117" caption="Required Courses" contentpage="true"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListOrg">
							<WTPARAM name="OrgID" direction="input" value="PARAM(CompanyID)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="65"/>
				<WTCOLUMN width="370"/>
				<WTCOLUMN width="55"/>
				<WTCOLUMN width="110"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="4" label="OrgCourses" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="4" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="4" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTREPEAT entity="Course">
					<WTROW margin-top="3">
						<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
						 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
							<WTLINK name="1313" target="Ratings">
								<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
							</WTLINK>
						</WTIMAGE>
<!--				
						<WTSTATIC col="2" prespace="false" valign="top">
							<WTSTATIC value="DATA(Course.CourseName)" bold="true">
								<WTLINK name="1120">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
									<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTSTATIC>
-->						
						<WTSTATIC col="2" valign="top">
							<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
										<WTPARAM name="Register" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="3" align="right" valign="top">
							<WTSTATIC value="DATA(Course.CourseLength)"/>
							<WTSTATIC value="CONST( min.)"/>
						</WTSTATIC>
						<WTSTATIC col="4" align="right" bold="true" valign="top">
							<WTSTATIC label="Recommended" >
								<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="Required" >
								<WTCONDITION expr="DATA(Course.OrgStatus)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" align="left" valign="top">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(video.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(audio.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(quiz.gif)"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="2" merge="3" value="DATA(Course.Description)"/>
					</WTROW>
				</WTREPEAT>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="1118" caption="Course Search" focus="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="CourseDate" datatype="date"/>
			<WTPARAM name="Mode" datatype="number"/>

			<WTDATATXN name="Courses"/>
			
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION name="Cancel" type="Cancel" id="3">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
				<WTMETHOD name="TBCompanyDate">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="CONST(&quot;&quot;)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="TrainerID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="CourseDate" direction="input" value="PARAM(CourseDate)"/>
				</WTMETHOD>
				<WTMETHOD name="TBUnregistered">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="CONST(&quot;&quot;)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="TrainerID" direction="input" value="PARAM(MemberID)"/>
				</WTMETHOD>
				<WTMETHOD name="TBPublicDate">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="CONST(&quot;&quot;)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CourseDate" direction="input" value="PARAM(CourseDate)"/>
				</WTMETHOD>
				<WTMETHOD name="TBFavoriteCompany">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(28)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(32)" connector="or"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(33)" connector="or"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="CONST(&quot;&quot;)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="TrainerID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="CourseDate" direction="input" value="PARAM(CourseDate)"/>
				</WTMETHOD>
				<WTMETHOD name="TBFavoritePublic">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(29)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(34)" connector="or"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(35)" connector="or"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="CONST(&quot;&quot;)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="TrainerID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="CourseDate" direction="input" value="PARAM(CourseDate)"/>
				</WTMETHOD>
<WTCUSTOM>
				For Each oCourse in oCourses
				   With oCourse
						If IsDate(.CourseDate) Then
							If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
								.CourseDate = reqSysDate
							End If
						End If
				   End With
				Next
</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			
	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600"/>

				<WTROW margin-top="3" margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" align="center" class="PageHeading" bold="true">
						<WTSTATIC label="NewCompanyCourses" space="1"/>
						<WTSTATIC value="PARAM(CourseDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" align="center" class="PageHeading" bold="true">
						<WTSTATIC label="UnregisteredCourses"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
					<WTSTATIC col="1" align="center" class="PageHeading" bold="true">
						<WTSTATIC label="NewPublicCourses" space="1"/>
						<WTSTATIC value="PARAM(CourseDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(32)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(33)" connector="or"/>
					<WTSTATIC col="1" align="center" class="PageHeading" bold="true">
						<WTSTATIC label="FavoriteNewCompanyCourses" space="1"/>
						<WTSTATIC value="PARAM(CourseDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(34)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(35)" connector="or"/>
					<WTSTATIC col="1" align="center" class="PageHeading" bold="true">
						<WTSTATIC label="FavoriteNewPublicCourses" space="1"/>
						<WTSTATIC value="PARAM(CourseDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" prevnext="top" entity="Course">
						<WTCOLUMN width="11"/>
						<WTCOLUMN width="68"/>
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="11"/>

						<WTROW margin-top="3">
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
							 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
								<WTLINK name="1313" target="Ratings">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC col="2" prespace="false" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(CourseDate)" oper="not-equal" value="CONST('')"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Course.CourseDate)" fontcolor="purple"/>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC value="CONST((preview))">
										<WTLINK name="1330" target="preview">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@grp&quot;/&gt;))">
									<WTCONDITION expr="DATA(Course.Grp)" oper="not-equal" value="CONST(0)"/>
									<WTLINK name="1119">
										<WTPARAM name="Grp" value="DATA(Course.Grp)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST( - )" bold="true"/>
								<WTSTATIC value="DATA(Course.TrainerName)">
									<WTLINK name="0308" target="trainer">
										<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" align="right" valign="top">
								<WTSTATIC value="DATA(Course.CourseLength)"/>
								<WTSTATIC value="CONST( min.)"/>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(Course.Language)" align="right" valign="top"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" merge="3" value="DATA(Course.Description)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1119" caption="Course Series" focus="false" navbar="false" header="false" footer="false"
		 page-left="0" margin="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="Grp" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListGrp">
							<WTPARAM name="Grp" direction="input" value="PARAM(Grp)"/>
						</WTMETHOD>
					</WTCODEGROUP>
<WTCUSTOM>
					For Each oCourse in oCourses
					   With oCourse
							If IsDate(.CourseDate) Then
								If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
									.CourseDate = reqSysDate
								End If
							End If
					   End With
					Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="65"/>
				<WTCOLUMN width="410"/>
				<WTCOLUMN width="55"/>
				<WTCOLUMN width="70"/>
				
				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
						content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="4" align="center" class="PageHeading" bold="true">
						<WTSTATIC label="Grp" value="PARAM(Grp)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="4" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="4" align="left" label="ClickRating" class="prompt"/>
				</WTROW>
				<WTREPEAT entity="Course">
					<WTROW margin-top="3">
						<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
						 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
							<WTLINK name="1313" target="Ratings">
								<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
							</WTLINK>
						</WTIMAGE>
						<WTIMAGE col="2" value="CONST(new.gif)" align="left" valign="center">
							<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
						</WTIMAGE>
						<WTSTATIC col="2" prespace="false" valign="top">
							<WTSTATIC value="DATA(Course.CourseName)" bold="true">
								<WTLINK name="1120">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
							<WTSTATIC value="CONST( - )" bold="true"/>
							<WTSTATIC value="DATA(Course.TrainerName)">
								<WTLINK name="0308" target="trainer">
									<WTPARAM name="TrainerID" value="DATA(Course.TrainerID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC col="2" valign="top">
							<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
									<WTLINK name="1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="Register" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="3" align="right" valign="top">
							<WTSTATIC value="DATA(Course.CourseLength)"/>
							<WTSTATIC value="CONST( min.)"/>
						</WTSTATIC>
						<WTSTATIC col="4" value="DATA(Course.Language)" align="right" valign="top"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" align="left" valign="top">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(video.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(audio.gif)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE value="CONST(quiz.gif)"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="2" merge="4" value="DATA(Course.Description)"/>
					</WTROW>
				</WTREPEAT>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1119" caption="Course Series" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="Grp" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTCODEGROUP>
						<WTMETHOD name="ListGrp">
							<WTPARAM name="Grp" direction="input" value="PARAM(Grp)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCUSTOM>
						For Each oCourse in oCourses
						With oCourse
						If IsDate(.CourseDate) Then
						If DateDiff("d", CDate(.CourseDate), Now) &lt;= 30 Then
						.CourseDate = reqSysDate
						End If
						End If
						End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="22"/>
				<WTCOLUMN width="78"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading" bold="true">
						<WTSTATIC label="Grp" value="PARAM(Grp)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoCoursesFound" align="center" bold="true"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSCOURSES/PTSCOURSE))" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" label="ClickRating" class="prompt"/>
					</WTROW>
					<WTREPEAT entity="Course">
						<WTROW margin-top="3">
							<WTSTATIC col="1" merge="2" prespace="false">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(new.gif)" align="left" valign="center">
										<WTCONDITION expr="DATA(Course.CourseDate)" oper="equal" value="SYS(date)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Course.CourseName)" bold="true">
									<WTLINK name="m_1120">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC>
									<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(SymbolAdd24.gif)" alt="Register" imgalign="absmiddle">
											<WTLINK name="m_1120">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
												<WTPARAM name="OrgCourseID" value="DATA(Course.OrgCourseID)"/>
												<WTPARAM name="Register" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC space="1"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Course.CourseLength)"/>
									<WTSTATIC value="CONST( min.)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" align="left" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating&quot;/&gt;.gif)" valign="top"
									 altx="&lt;xsl:value-of select=&quot;concat(@ratingcnt, ' ', /DATA/LANGUAGE/LABEL[@name='ClassesRated'])&quot;/&gt;">
										<WTLINK name="m_1313" target="Ratings">
											<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC newline="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Course.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Course.Description)"/>
						</WTROW>
					</WTREPEAT>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="1120" caption="Course Description" focus="false" navbar="false" header="false" footer="false" wrapper="false"
		 page-left="0" margin="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/>
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="OrgCourseID" datatype="number"/>
			<WTPARAM name="Register" datatype="number"/>
			
			<WTSUB name="Register">
				<!-- Get member name -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
				</WTOBJECT>
				<!-- Create new session for the member -->
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CourseID)" value="PARAM(CourseID)"/>
					<WTSETATTRIBUTE name="ATTR(OrgCourseID)" value="PARAM(OrgCourseID)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(RegisterDate)" value="SYS(date)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpMemberNameLast)"/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpMemberNameFirst)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="SessionID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="1121" skipreturn="false">
						<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="OrgCourseID" value="PARAM(OrgCourseID)"/>
					</WTLINK>				
				</WTRETURN>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="NotEmployee" /> 
					<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)" connector="and"/> 
					<WTMETHOD name="CheckCourse">
						<WTPARAM name="reqSessionID" direction="return" datatype="number"/>
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" /> 
					<WTCONDITION expr="PARAM(Register)" oper="greater" value="CONST(0)" connector="and"/> 
					<WTCALLSUB name="Register"/>
				</WTCODEGROUP>
				
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" /> 
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Description.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; + CStr(reqCourseID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION name="Enroll" type="Enroll" id="1">
				<WTCALLSUB name="Register"/>
			</WTACTION>
			
			<WTACTION name="Cancel" type="Cancel" id="3">
				<WTRETURN/>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="590" align="left"/>
				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
						content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="12">
					<WTSTATIC col="1" class="PageHeading" align="left">
						<WTSTATIC value="ATTR(Course.CourseName)" space="2"/>
						<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@courseid&quot;/&gt;))"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="ATTR(Course.Description)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" /> 
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" action="1" value="CONST(Register)" align="center">
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" align="left"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="not-equal" value="CONST(0)" /> 
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="AlreadyRegistered">
								<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)" /> 
							</WTSTATIC>
							<WTSTATIC label="NotPrerequisite">
								<WTCONDITION expr="PARAM(SessionID)" oper="less" value="CONST(0)" /> 
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(OrgCourseID)" oper="not-equal" value="CONST(1)" /> 
						<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(OrgCourseID)" oper="equal" value="CONST(1)" /> 
						<WTROW margin-top="24" margin-bottom="12">
							<WTSTATIC col="1" label="ReportRegistered" class="PageHeading" align="center"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTBUTTON col="1" value="CONST(Close)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_1120" caption="Course List" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp" secured="98">
			<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/>
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="OrgCourseID" datatype="number"/>
			<WTPARAM name="Register" datatype="number"/>

			<WTSUB name="Register">
				<!-- Get member name -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
				</WTOBJECT>
				<!-- Create new session for the member -->
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CourseID)" value="PARAM(CourseID)"/>
					<WTSETATTRIBUTE name="ATTR(OrgCourseID)" value="PARAM(OrgCourseID)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(RegisterDate)" value="SYS(date)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpMemberNameLast)"/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpMemberNameFirst)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="SessionID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="m_1121" skipreturn="false">
						<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="OrgCourseID" value="PARAM(OrgCourseID)"/>
					</WTLINK>
				</WTRETURN>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="NotEmployee" />
					<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)" connector="and"/>
					<WTMETHOD name="CheckCourse">
						<WTPARAM name="reqSessionID" direction="return" datatype="number"/>
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(Register)" oper="greater" value="CONST(0)" connector="and"/>
					<WTCALLSUB name="Register"/>
				</WTCODEGROUP>

				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Description.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Course\&quot; + CStr(reqCourseID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION name="Enroll" type="Enroll" id="1">
				<WTCALLSUB name="Register"/>
			</WTACTION>

			<WTACTION name="Cancel" type="Cancel" id="3">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>
				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW margin-top="12">
					<WTSTATIC col="1" class="PageHeading" align="left">
						<WTSTATIC value="ATTR(Course.CourseName)" space="2"/>
						<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@courseid&quot;/&gt;))"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="ATTR(Course.Description)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" />
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" action="1" value="CONST(Register)" align="center">
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" align="left"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="not-equal" value="CONST(0)" />
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" class="PageHeading" align="center">
							<WTSTATIC label="AlreadyRegistered">
								<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)" />
							</WTSTATIC>
							<WTSTATIC label="NotPrerequisite">
								<WTCONDITION expr="PARAM(SessionID)" oper="less" value="CONST(0)" />
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(OrgCourseID)" oper="not-equal" value="CONST(1)" />
						<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(OrgCourseID)" oper="equal" value="CONST(1)" />
						<WTROW margin-top="24" margin-bottom="12">
							<WTSTATIC col="1" label="ReportRegistered" class="PageHeading" align="center"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTBUTTON col="1" value="CONST(Close)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="1121" caption="Enrollment Confirmation" focus="false" navbar="false" header="false" footer="false"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--=============================================================================================-->
			<WTPARAM name="CourseID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="OrgCourseID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="left"/>
				<WTCOLUMN width="500" align="left"/>
				<WTCOLUMN width="50" align="left"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" merge="3" value="ATTR(Course.CourseName)" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="EnrollConfirmationText" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(OrgCourseID)" oper="not-equal" value="CONST(1)" />
					<WTBUTTON col="1" merge="3" action="1" value="CONST(ReturnCatalog)" align="center"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(OrgCourseID)" oper="equal" value="CONST(1)" />
					<WTROW margin-top="24" margin-bottom="12">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" label="ReportRegistered" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" label="ReportRegistered1" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_1121" caption="Enrollment Confirmation" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--=============================================================================================-->
			<WTPARAM name="CourseID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="OrgCourseID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="3" align="left"/>
				<WTCOLUMN width="94" align="left"/>
				<WTCOLUMN width="3" align="left"/>

				<WTLOAD>
					content = window.parent.document.forms[0].SearchText;
					if(content)
					content.scrollIntoView();
				</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" merge="3" value="ATTR(Course.CourseName)" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="EnrollConfirmationText" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(OrgCourseID)" oper="not-equal" value="CONST(1)" />
					<WTBUTTON col="1" merge="3" action="1" value="CONST(ReturnCatalog)" align="center"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(OrgCourseID)" oper="equal" value="CONST(1)" />
					<WTROW margin-top="24" margin-bottom="12">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" label="ReportRegistered" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" label="ReportRegistered1" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="1160" caption="Class Reports" navbar="false" language="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="1160">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="ChartSource" datatype="text"/>
			<WTPARAM name="Unit" datatype="text"/>

			<WTINCLUDE name="ChartURL.asp"/>
		   
			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqReport &lt; 1 OR reqReport &gt; 5 Then reqReport = 1
				If IsDate(reqFromDate) AND IsDate(reqToDate) Then
					tmpDays = DateDiff("d", reqFromDate, reqToDate )
					If tmpDays &lt;= 31 Then reqUnit = "day"
					If tmpDays &gt; 31 AND tmpDays &lt;= 90 Then reqUnit = "week"
					If tmpDays &gt; 90 AND tmpDays &lt;= 365 Then reqUnit = "month"
					If tmpDays &gt; 365 Then reqUnit = "quarter"
				Else
					reqFromDate = CDate( DateAdd("d", -1, Date()) )
					reqToDate = CDate( Date() )
					reqUnit = "day"	
				End If
</WTCUSTOM>
				<WTOBJECT name="Courses" project="ptsCourseUser" class="CCourses">
					<WTMETHOD name="ReportStatus">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportReview">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					</WTMETHOD>
<WTCUSTOM>
	tmpData = ""
	tmpLabels = ""
	For Each oCourse in oCourses
		With oCourse
			Select Case reqReport
			Case 1:
				reqCount = reqCount + .Quantity
				tmpLabels = tmpLabels + .Status + "|"
				tmpData = tmpData + .Quantity + "|"
			Case 2:
				reqCount = reqCount + 1
			End Select
		End With
	Next

	reqCount = FormatNumber(reqCount,0)
	'Remove last | delimiter
	If tmpData &lt;&gt; "" And Right(tmpData,1) = "|" Then tmpData = Left(tmpData, Len(tmpData)-1 )
	If tmpLabels &lt;&gt; "" And Right(tmpLabels,1) = "|" Then tmpLabels = Left(tmpLabels, Len(tmpLabels)-1 )

	'---ChartURL( Type, Width, Height, StartDate, EndDate, Unit, LangFile, Data, Title, XTitle, YTitle )
	Select Case reqReport
	Case 1:
		ChartLabels "1160Chart1", tmpLabels, "", "", "", ""
		reqChartSource = "Chart.asp?type=pie&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;labels=" + tmpLabels
	End Select
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="xmlCourses" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="600" align="left"/>
				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="CourseStatusReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" label="CourseReviewReport" class="PageHeading" align="center"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTIMAGE col="1" merge="2" align="center" value="PARAM(ChartSource)" path="../.."/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Course">
						<WTCOLUMN width="10" align="left" valign="top" label="#"/>
						<WTCOLUMN width="45" align="left" valign="top" label="CourseName"/>
						<WTCOLUMN width="45" align="left" valign="top" label="TrainerName"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Course.CourseID)"/>
							<WTSTATIC col="2" value="DATA(Course.CourseName)">
								<WTLINK name="1103">
									<WTPARAM name="CourseID" value="DATA(Course.CourseID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Company.TrainerName)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" align="center" tag="TotalCourses" value="PARAM(Count)" class="PageHeading"/>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" align="left" tag="TotalCourses" value="PARAM(Count)" class="PageHeading"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>