<WTROOT prefix="pts" system="Pinnacle">

	<WTENTITY id="138" name="GCR" alias="gcr">
		<!--Identity-->
		<WTATTRIBUTE id="13801" name="GCRID" type="number" identity="true" title="true" min="1" required="true" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="13895" name="Result" type="text" length="1000" source="entity" persist="false"/>
		<WTATTRIBUTE id="13896" name="Status" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="13897" name="czDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="13898" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="13899" name="Amount" type="number" source="entity" persist="false"/>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="GCR" entity="GCR" alias="gcr"/>
		</WTRELATIONSHIPS>
	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="CustomList" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(GCR.GCRID)"/>
					<WTATTRIBUTE value="ATTR(GCR.Result)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
<!-- Processing - Admin Page -->
		<!--==================================================================-->
		<WTWEBPAGE name="13800" caption="GCR Processing" header="false" footer="false" navbar="false" wrapper="wrapper800" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="13800" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Process" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Result" datatype="text"/>
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Count" datatype="number"/>
      <WTPARAM name="Total" datatype="money"/>

      <WTDATATXN name="Members"/>
			<WTDATATXN name="GCRs"/>
      <WTDATATXN name="SalesOrders"/>
      <WTDATATXN name="Payouts"/>

      <WTINCLUDE name="Note.asp"/>
<!--      <WTINCLUDE name="Payout.asp"/>-->
      <WTINCLUDE name="WalletPayout.asp"/>
      <WTINCLUDE name="BillingPayout.asp"/>
      <WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="PaymentFile.asp"/>
			<WTINCLUDE name="Orders.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
			<WTINCLUDE name="DeclineEmail.asp"/>
      <WTINCLUDE name="LostBonusEmail.asp"/>

      <WTCODEGROUP>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(17)"/>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<!-- Set this page to not timeout for 4 hours -->
				<WTCUSTOM>Server.ScriptTimeout = 14400</WTCUSTOM>				
			</WTCODEGROUP>

      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
			<!-- Disable Certain Features based on User Type -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsManagerOnly"/>
				<WTCUSTOM>If InStr( ",2,3,5,6,11,12,13,21,22,23,24,25,26,27,29,30,31,33,34,35,37,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,74,75,76,77,78,79,80,81,82,83,84,85,86,", ","+CSTR(reqProcess)+"," ) = 0 Then reqProcess = 0</WTCUSTOM>
			</WTCODEGROUP>
        <!-- Set default User Input Options -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)" connector="or"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="CONST(100)">
            <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
        </WTCODEGROUP>
<WTCUSTOM>
  'Set date range to previous month
  If reqOption = 0 Then
  reqFromDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
  reqToDate = DateAdd( "d", -1, reqFromDate )
  reqFromDate = DateAdd( "m", -1, reqFromDate )
  End If
  'Set date range to current date
  If reqOption = 1 Then
  reqToDate = reqSysDate
  reqFromDate = reqSysDate
  End If
  'Set date range to previous month
  If reqOption = 2 Then
  reqToDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
  reqFromDate = DateAdd( "m", -1, reqToDate )
  reqToDate = DateAdd( "d", -1, reqToDate )
  End If
  'Set date range to one month back from last Sunday
  If reqOption = 3 Then
  reqToDate = DateAdd( "d", -5, reqSysDate )
  reqFromDate = DateAdd( "m", -1, reqToDate )
  End If
  'Set date range to 1 week back
  If reqOption = 4 Then
  reqToDate = DateAdd( "d", -1, reqSysDate )
  reqFromDate = DateAdd( "d", -7, reqToDate )
  End If
  'Set date range to yesterday
  If reqOption = 5 Then
  reqFromDate = DateAdd( "d", -1, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 2 days ago
  If reqOption = 6 Then
  reqFromDate = DateAdd( "d", -2, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 3 days ago
  If reqOption = 7 Then
  reqFromDate = DateAdd( "d", -3, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 4 days ago
  If reqOption = 8 Then
  reqFromDate = DateAdd( "d", -4, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set date range to 5 days ago
  If reqOption = 9 Then
  reqFromDate = DateAdd( "d", -5, reqSysDate )
  reqToDate = reqFromDate
  End If
  'Set todate to 1 week back
  If reqOption = 11 Then
  reqToDate = DateAdd( "d", -7, reqSysDate )
  End If
  'Set todate to 2 weeks back
  If reqOption = 12 Then
  reqToDate = DateAdd( "d", -14, reqSysDate )
  End If
  'Set todate to 3 weeks back
  If reqOption = 13 Then
  reqToDate = DateAdd( "d", -21, reqSysDate )
  End If
  'Set todate to 4 weeks back
  If reqOption = 14 Then
  reqToDate = DateAdd( "d", -28, reqSysDate )
  End If
</WTCUSTOM>
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)" connector="or"/>
          <WTCODEGROUP>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
						<WTERROR number="10133" message="Oops, Please enter the required information." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>

					<!-- Create Billing Tokens -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						<WTCUSTOM>
							Result = BillingTokens()
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " New Billing Tokens Successfully Created! (" + aResult(1) + " bad)"
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Create Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(200)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payments Successfully Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Process Order Payments for Sales Orders and email bonus recipients -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						<WTCUSTOM>
							PaymentOwnerType = 52
							PostProcess = 1
							Result = ProcessPayments( reqCompanyID, PaymentOwnerType, "1/1/2099", PostProcess )
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " Payments Successfully Processed! (" + aResult(1) + " bad)"
						</WTCUSTOM>
						<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult">
							<WTCONDITION expr="CONST(aResult(0))" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- List Declined Token -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Tokens!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="Level" direction="input" value="CONST(4)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Declined Payments Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Verify Bonus Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Earn Bonuses!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Calculate Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						<WTOBJECT name="Commission" project="ptsCommissionUser" class="CCommission">
							<WTMETHOD name="CustomCommissions">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="CommType" direction="input" value="CONST(1)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="CONST(Amount)" value="CONST(0)"/>
							<WTMETHOD name="TotalCommissions">
								<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Bonuses Created! (&quot; &amp; FormatCurrency(Amount,2) &amp; &quot;) &quot;)"/>
						</WTOBJECT>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + &quot; from &quot; + CStr(reqFromDate) + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					
					<!-- Display Hidden Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(202)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Bonuses Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Create Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyPayouts">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payouts Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Payout Credits -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(4)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(30)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payment Credits Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Verify Payout Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(6)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Receive a Payout!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Create Payout Files -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
            <WTCALLSUB name="ExportWalletWallet reqCompanyID, 14, reqToDate, tmpTotal, tmpFile, tmpAmount"/>
            <WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; BitCoin eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
            <WTCALLSUB name="ExportWalletWallet reqCompanyID, 13, reqToDate, tmpTotal, tmpFile, tmpAmount"/>
            <WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; STP eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;No Payouts to Export!&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>

							<!-- Mark Payouts Paid -->
              <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
								<WTMETHOD name="WalletStatus">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="PayType" direction="input" value="CONST(14)"/>
									<WTPARAM name="Count" direction="return" datatype="number"/>
								</WTMETHOD>
								<WTMETHOD name="WalletStatus">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="PayType" direction="input" value="CONST(13)"/>
									<WTPARAM name="Count" direction="return" datatype="number"/>
								</WTMETHOD>
							</WTOBJECT>
            </WTCODEGROUP>

					</WTCODEGROUP>

					<!-- Mark Payouts Paid -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS EXPORT PAYOUTS AMOUNT -->
<!--
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyStatus2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="PaidDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(-1)"/>
								<WTPARAM name="Reference" direction="input" value="CONST(&quot;3&quot;)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Pending Payouts Marked Paid!&quot;)"/>
						</WTOBJECT>
-->						
					</WTCODEGROUP>
					
					<!-- Display Hidden Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(203)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Payouts Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Recalculate Group Sales Volume and Promotions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(1)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Group Sales Totals Recalculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Post sales summary -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(2)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Sales Summary Postings!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- List Enroller Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(90)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Enroller Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All New eWallets to be Created -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTOBJECT name="GCRs" project="ptsGCRUser" class="CGCRs">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlGCRs" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;New eWallets to be imported to iPayout in a .CSV file!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Assign New eWallets to Payout Method -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New eWallets Assigned!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Mark GCC Payment Orders Pending (in process)-->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All New Global Cash Card orders marked pending!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Set All Member Alerts-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Member Alerts Set!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Clean up Data -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Data Cleaned Up!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Export Submitted Orders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Export Green Fuel Tab Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export GCR Max Inhouse Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; LM Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export GCR Max OIL Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 3, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; LM-OIL Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>

							<!-- Update These Submitted Orders to InProcess -->
							<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
								<WTMETHOD name="Custom2">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="Status" direction="input" value="CONST(101)"/>
									<WTPARAM name="OrderDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
									<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Export Inprocess Orders -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GCR Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
-->
					
					<!-- Update Inprocess Orders to Complete -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="OrderDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Inprocess Orders to Complete -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Email Commissions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						<WTCALLSUB name="CommissionEmail reqCompanyID, 0, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Commission Emails Sent&quot;)"/>
					</WTCODEGROUP>

					<!-- Recalculate All Title Advancements -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(15)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Title Advancements Calculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>


					<!-- Export Payment to process -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						<WTSETATTRIBUTE name="CONST(PaymentOwnerType)" value="CONST(52)"/>
						<WTCALLSUB name="ExportPayments reqCompanyID, PaymentOwnerType, &quot;1/1/2099&quot;,  CCTotal, CKTotal, CCFile, CKFile, ErrorMsg"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(ErrorMsg)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTCUSTOM>
								response.write ErrorMsg
								response.end
							</WTCUSTOM>
						</WTCODEGROUP>
						<!-- Exported CC Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/Billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CCFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CCTotal) + &quot; CC Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Exported ACH Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CKTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.gcrmarketing.com/billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CKFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CKTotal) + &quot; ACH Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCTotal + CKTotal)" oper="not-equal" value="CONST(0)"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Update Binary Sales -->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payments Updated in the Binary Sales Volume!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Update Binary Counts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(301)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Binary Downline member counts Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Recruiters -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(99)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Recruiters!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Earners -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(98)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Earners!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Countries -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(97)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Countries!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Email Members with Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="DeclineEmail reqCompanyID, 0, 1, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Declined Payments Emailed!&quot;)"/>
					</WTCODEGROUP>

					<!-- Suspend Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(207)"/>
								<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Suspended with Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Cancel Suspended Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(208)"/>
								<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Suspended Members Cancelled with Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Enrolled Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="Level" direction="input" value="PARAM(MemberID)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Member #&quot; + CStr(reqMemberID) + &quot; Downline Enrolled Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Binary Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(107)"/>
								<WTPARAM name="Level" direction="input" value="PARAM(MemberID)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Member #&quot; + CStr(reqMemberID) + &quot; Downline Binary Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Salesorder Cash Payments to be processed -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(104)"/>  <!-- Cash Payments -->
								<WTPARAM name="Level" direction="input" value="CONST(1)"/> <!-- Salesorders -->-->
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Cash Payments to be Processed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Salesorders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
							<WTMETHOD name="CustomList2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(1)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTCUSTOM>
								For Each oItem in oSalesOrders
								With oItem
								.Result = CHR(34) + Replace(.Result, "|", CHR(34) + "," + CHR(34)) + CHR(34)
								End With
								Next
							</WTCUSTOM>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlSalesOrders" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Sales Orders!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Binary Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(91)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Binary Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Missing Wallets -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(56)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Dealers with Missing Wallets!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Cancel Trial Members over 30 Days -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(57)"/>
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(302)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Trial Dealers Moved to Free Dealer!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

          <!-- Lock all payout methods -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(58)"/>
            <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(304)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(1)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( &quot;All Payout Methods Locked!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Unlock all payout methods -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(59)"/>
            <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(304)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(2)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST( &quot;All Payout Methods Unlocked!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- List Order Errors -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(106)"/>
                <WTPARAM name="Level" direction="input" value="CONST(0)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Dealers with Order Errors!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- List All Wallet Payout Requests -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)"/>
            <WTOBJECT name="Payouts" project="ptsPayoutUser" class="CPayouts">
              <WTMETHOD name="WalletExport">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="PayoutID" direction="input" value="CONST(0)"/>
                <WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
                <WTPARAM name="PayType" direction="input" value="CONST(0)"/>
              </WTMETHOD>
              <WTCUSTOM>
                reqTotal = 0.0
                reqCount = 0
                For Each oItem in oPayouts
                  With oItem
                    a = Split(.Notes, "|")
                    .OwnerID = a(1)
                    .Notes = Replace(.Notes, "|", " - " )
                    reqCount = reqCount + 1
                    reqTotal = reqTotal + CCUR(.Amount)
                  End With
                Next
                reqTotal = FormatCurrency(reqTotal,2)
              </WTCUSTOM>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlPayouts" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Wallet Payout Requests!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Clear Lost Bonuses -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(74)"/>
            <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
                <WTPARAM name="Status" direction="input" value="CONST(1080)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(CSTR(Count) +  &quot; Lost Bonuses Cleared!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- List Lost Bonuses -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
            <WTSETATTRIBUTE name="CONST(MinLostBonus)" value="PARAM(MemberID)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(80)"/>
                <WTPARAM name="Level" direction="input" value="CONST(MinLostBonus)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;List Lost Bonuses!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Email Members with Lost Bonuses -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)"/>
            <WTSETATTRIBUTE name="CONST(MinLostBonus)" value="PARAM(MemberID)"/>
            <WTCALLSUB name="LostBonusEmail reqCompanyID, MinLostBonus, tmpTotal"/>
            <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Lost Bonuses Emailed!&quot;)"/>
          </WTCODEGROUP>

          <!-- Reconcile Company Wallets -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(77)"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(210)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Reconcilled Company Wallets!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- List Sponsor Matrix Orphan Affiliates -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(78)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(107)"/>
                <WTPARAM name="Level" direction="input" value="CONST(0)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Matrix Sponsor Orphaned Affiliates!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!--  Sales Team Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(79)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(1)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Sales Team Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Billing Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(80)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(2)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Billing Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Order Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(81)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(3)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

          <!-- Payout Exceptions List -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)"/>
            <WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
              <WTMETHOD name="CustomList">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(200)"/>
                <WTPARAM name="Level" direction="input" value="CONST(4)"/>
              </WTMETHOD>
              <WTMETHOD name="XML">
                <WTPARAM name="xmlMembers" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Wallet Exceptions!&quot;)"/>
            </WTOBJECT>
          </WTCODEGROUP>

					<!-- List Summary GCR Coin Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(83)"/>
						<WTOBJECT name="GCRs" project="ptsGCRUser" class="CGCRs">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(10)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlGCRs" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;GCR Coin Order Summary!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Detail GCR Coin Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
						<WTOBJECT name="GCRs" project="ptsGCRUser" class="CGCRs">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlGCRs" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;GCR Coin Order Details!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Summary Hardware Wallet Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(85)"/>
						<WTOBJECT name="GCRs" project="ptsGCRUser" class="CGCRs">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlGCRs" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;GCR Hardware Wallet Order Summary!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

          <!-- List Detail Hardware Wallet Orders to Fulfill -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)"/>
						<WTOBJECT name="GCRs" project="ptsGCRUser" class="CGCRs">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(13)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlGCRs" direction="return" datatype="text"/>
							</WTMETHOD>
              <WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;GCR Hardware Wallet Order Details!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

      </WTCODEGROUP>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="center"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(Result)" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="24">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC label="NotAvailable">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="BillingTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateDeclined">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						</WTSTATIC>
						<WTSTATIC label="BonusQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						</WTSTATIC>
						<WTSTATIC label="CalcBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentCredits">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutPaid">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayPayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSummary">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						</WTSTATIC>
						<WTSTATIC label="ListReferralOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						</WTSTATIC>
						<WTSTATIC label="CreateWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						</WTSTATIC>
						<WTSTATIC label="AssignWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						</WTSTATIC>
						<!--
						<WTSTATIC label="MarkGCC">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="SetAlerts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						</WTSTATIC>
						<WTSTATIC label="CleanupData">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						</WTSTATIC>
						<WTSTATIC label="EmailCommissions">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						</WTSTATIC>
						<WTSTATIC label="TitleAdvancements">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						</WTSTATIC>
<!--						
						<WTSTATIC label="UpdateBinarySales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="UpdateBinaryCount">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						</WTSTATIC>
						<WTSTATIC label="TopRecruiters">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						</WTSTATIC>
						<WTSTATIC label="TopEarners">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						</WTSTATIC>
						<WTSTATIC label="TopCountries">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineEmail">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineSuspend">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineCancel">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						</WTSTATIC>
						<WTSTATIC label="AllMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						</WTSTATIC>
						<WTSTATIC label="EnrollMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
						</WTSTATIC>
						<WTSTATIC label="BinaryMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)"/>
						</WTSTATIC>
						<WTSTATIC label="CashPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)"/>
						</WTSTATIC>
						<WTSTATIC label="ListSalesOrders">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						</WTSTATIC>
						<WTSTATIC label="ListBinaryOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)"/>
						</WTSTATIC>
						<WTSTATIC label="ListMissingWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(56)"/>
						</WTSTATIC>
            <WTSTATIC label="CancelTrialDealers">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(57)"/>
            </WTSTATIC>
            <WTSTATIC label="LockPayouts">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(58)"/>
            </WTSTATIC>
            <WTSTATIC label="UnlockPayouts">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(59)"/>
            </WTSTATIC>
            <WTSTATIC label="ListOrderErrors">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)"/>
            </WTSTATIC>
            <WTSTATIC label="WalletPayouts">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)"/>
            </WTSTATIC>
            <WTSTATIC label="ClearLostBonuses">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(74)"/>
            </WTSTATIC>
            <WTSTATIC label="ListLostBonuses">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
            </WTSTATIC>
            <WTSTATIC label="EmailLostBonuses">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)"/>
            </WTSTATIC>
            <WTSTATIC label="ReconcileWallets">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(77)"/>
            </WTSTATIC>
            <WTSTATIC label="ListSponsorOrphans">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(78)"/>
            </WTSTATIC>
            <WTSTATIC label="SalesTeamExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(79)"/>
            </WTSTATIC>
            <WTSTATIC label="BillingExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(80)"/>
            </WTSTATIC>
            <WTSTATIC label="OrderExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(81)"/>
            </WTSTATIC>
            <WTSTATIC label="PayoutExceptions">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)"/>
            </WTSTATIC>
            <WTSTATIC label="CoinOrderSummary">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(83)"/>
            </WTSTATIC>
            <WTSTATIC label="CoinOrderDetail">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
            </WTSTATIC>
            <WTSTATIC label="WalletOrderSummary">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(85)"/>
            </WTSTATIC>
            <WTSTATIC label="WalletOrderDetail">
              <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)"/>
            </WTSTATIC>
          </WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)" connector="or"/>
					<WTSTATIC col="1" label="From" align="center" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)" connector="or"/>
          <WTTEXT col="1" align="center" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
					<WTSTATIC col="1" tag="MemberID" align="center" />
					<WTTEXT col="1" align="center" value="PARAM(MemberID)" name="MemberID" size="8" />
				</WTROW>
        <WTROW margin-top="12">
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
          <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(76)" connector="or"/>
          <WTSTATIC col="1" tag="MinLostBonus" align="center" />
          <WTTEXT col="1" align="center" value="PARAM(MemberID)" name="MemberID" size="5" />
        </WTROW>

        <WTROW margin-bottom="12" margin-top="12">
          <WTBUTTON col="1" action="1" value="CONST(Process)" align="center">
            <WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)" connector="or"/>
            <WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(cashregister.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0436d" return="false" target="Declines">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(Level)"/>
                        <WTPARAM name="Code" value="CONST(2)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(60)"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="1003" return="false" target="Finances">
                        <WTPARAM name="PaymentID" value="DATA(MemberID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(79)"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(80)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(81)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)" connector="or"/>
            <WTROW margin-top="12"/>
            <WTREPEAT entity="Member">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@level&quot;/&gt;.gif)" imgalign="absmiddle" path="Company\14"/>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(82)"/>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="Code" value="CONST(2)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(82)"/>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="Code" value="CONST(4)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(genealogy.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0470" return="false" target="SalesTeam">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                      <WTLINK name="0403" target="Member">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)" connector="or"/>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(78)" connector="or"/>
            <WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)" space="3"/>
                  <WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@status&quot;/&gt;)"/>
                  <WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@status&quot;/&gt;)" space="3"/>
<!--
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
-->									
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="SalesOrder">
							<WTROW>
								<WTSTATIC col="1" value="DATA(Result)" align="left"/>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" label="eWalletHdr" align="left"/>
						</WTROW>
						<WTROW>
							<WTREPEAT entity="GCR">
								<WTROW>
									<WTSTATIC col="1" value="DATA(Result)" align="left"/>
								</WTROW>
							</WTREPEAT>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(56)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(GLogo.png)" alt="Edit" path="company/17/" imgalign="absmiddle">
											<WTLINK name="13803" target="Wallet">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(61)"/>
            <WTROW margin-top="12">
              <WTSTATIC col="1" align="center" class="PageHeading">
                <WTSTATIC tag="Total"/>
                <WTSTATIC value="PARAM(Count)" space="2"/>
                <WTSTATIC value="CONST(-)" space="2"/>
                <WTSTATIC value="PARAM(Total)"/>
              </WTSTATIC>
            </WTROW>
            <WTROW margin-top="12"/>
            <WTREPEAT entity="Payout">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(OwnerID)"/>
                        <WTPARAM name="Code" value="CONST(4)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                      <WTLINK name="0403" target="Member">
                        <WTPARAM name="MemberID" value="DATA(OwnerID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Email.gif)" alt="Email" imgalign="absmiddle">
                      <WTLINK name="0836" target="PayoutEmail">
                        <WTPARAM name="PayoutID" value="DATA(PayoutID)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="DATA(PayType)" oper="equal" value="SYSCON(PAYOUT_BITCOIN)"/>
                    <WTCONDITION expr="DATA(PayType)" oper="equal" value="SYSCON(PAYOUT_SOLIDTRUST)" connector="or"/>
                    <WTIMAGE value="CONST(cashregister.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0803" target="Payout">
                        <WTPARAM name="PayoutID" value="DATA(PayoutID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                        <WTPARAM name="Wallet" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="DATA(PayType)" oper="not-equal" value="SYSCON(PAYOUT_BITCOIN)"/>
                    <WTCONDITION expr="DATA(PayType)" oper="not-equal" value="SYSCON(PAYOUT_SOLIDTRUST)" connector="and"/>
                    <WTIMAGE value="CONST(blank16.gif)" imgalign="absmiddle"/>
                  </WTCODEGROUP>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(Amount)"/>
                  <WTSTATIC space="3"/>
                  <WTSTATIC value="DATA(Notes)"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(75)"/>
            <WTROW margin-top="12"/>
            <WTREPEAT entity="Member">
              <WTROW>
                <WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@level&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/17"/>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                      <WTLINK name="0475" return="false" target="Finances">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="Code" value="CONST(2)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTCODEGROUP>
                    <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                      <WTLINK name="0403" target="Member">
                        <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        <WTPARAM name="ContentPage" value="CONST(3)"/>
                        <WTPARAM name="Popup" value="CONST(1)"/>
                      </WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
                </WTSTATIC>
              </WTROW>
            </WTREPEAT>
          </WTCODEGROUP>

         <WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(83)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(85)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)" connector="or"/>
						<WTREPEAT entity="GCR">
							<WTROW>
								<WTSTATIC col="1" align="left">
                  <WTCODEGROUP>
        						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
        						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)" connector="or"/>
                    <WTIMAGE value="CONST(calculator32.gif)" imgalign="absmiddle">
                      <WTLINK name="GCRFulfill" target="GCRFulfill">
                        <WTPARAM name="PaymentID" value="DATA(GCRID)"/>
                        <WTPARAM name="Process" value="PARAM(Process)"/>
                      </WTLINK>
                    </WTIMAGE>
                    <WTSTATIC space="1"/>
                  </WTCODEGROUP>
									<WTSTATIC value="DATA(Result)" align="left" fontsize="5"/>
                </WTSTATIC>
              </WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

        </WTCODEGROUP>

        <WTROW margin-bottom="12"/>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Member Change Membership Options Page -->
		<!--============================================================================================-->
		<WTWEBPAGE name="13801" caption="Business Packages" navbar="false" header="false" footer="false" wrapper="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="13801">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="OrderOption" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="Amount" datatype="number"/>
			<WTPARAM name="BillingPrice" datatype="number"/>
			<WTPARAM name="CountryID" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="Result" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
<!--			<WTINCLUDE name="btc.asp"/>-->

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(17)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="NewBilling">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(0)"/>
<!--					
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(2)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(2)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(5)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(3)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(7)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(4)"/>
					</WTSETATTRIBUTE>
-->					
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(2)"/>
					<!-- Set AutoShip Order Option -->
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(1)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;202&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(2)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;203&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(3)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;204&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(4)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;205&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(5)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;206&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(6)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;207&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(7)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;208&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
          
 					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot;None&quot;)"/>
          <WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;204&quot;))" oper="not-equal" value="CONST(0)"/>
  					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot;Silver&quot;)"/>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(69.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot;Silver Package ($69.95)&quot;)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(99.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot; Silver Plus ($99.95)&quot;)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(299.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot; Silver Premium ($299.95)&quot;)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(999.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot; Silver Ultimate ($999.95)&quot;)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
          <WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;205&quot;))" oper="not-equal" value="CONST(0)"/>
  					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot;Gold&quot;)"/>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(299.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot;Gold Package ($299.95)&quot;)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(399.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot; Gold Plus ($399.95)&quot;)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(599.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot; Gold Premium ($599.95)&quot;)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
						  <WTCONDITION expr="ATTR(Price)" oper="equal" value="CONST(999.95)"/>
    					<WTSETATTRIBUTE name="CONST(tmpProduct)" value="CONST(&quot; Gold Ultimate ($999.95)&quot;)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
				</WTOBJECT>
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Upgrade.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
          <WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{product}", tmpProduct )
          </WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="FetchOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryID)" value="ATTR(CountryID)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewBilling"/>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
<!--        
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to recurring billing."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(0)"/>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(1)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
-->        
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					<WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
          <WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdateBilling)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
          </WTCODEGROUP>

          <WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>
          <WTSETATTRIBUTE name="CONST(oldPrice)" value="ATTR(Price)"/>
          <WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Member.Title)"/>
          <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(oldTitle)"/>
          <WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>

					<!-- **************************************************************** -->
					<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(0)"/>

					<!-- Set Autoship options -->
					<WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Bronze -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;203&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(69.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(3)"/>
            </WTCODEGROUP>
            
						<WTCODEGROUP>
							<!-- Silver -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;204&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(69.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(4)"/>
            </WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Gold -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;205&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(299.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(5)"/>
            </WTCODEGROUP>

            <WTCODEGROUP>
							<!-- Silver Plus -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(31)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;204&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(99.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(4)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
							<!-- Silver Premium -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(32)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;204&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(299.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(4)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
							<!-- Silver Ultimate -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(33)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;204&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(999.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(4)"/>
            </WTCODEGROUP>

            <WTCODEGROUP>
							<!-- Gold Plus -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(41)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;205&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(399.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(5)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
							<!-- Gold Premium -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(42)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;205&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(599.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(5)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
							<!-- Gold Ultimate -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(43)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;205&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(999.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(5)"/>
            </WTCODEGROUP>
              
						<WTCODEGROUP>
							<!-- Prospector -->
							<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(6)"/>
							<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;207&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(999.95)"/>
              <WTSETATTRIBUTE name="CONST(newTitle)" value="CONST(5)"/>
            </WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Upgrade Autoship Only -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(1)"/>
              <WTCODEGROUP>
							  <WTCONDITION expr="CONST(InStr(.Options2, tmpCode))" oper="equal" value="CONST(0)"/>
							  <WTCONDITION expr="CONST(oldPrice)" oper="not-equal" value="ATTR(Price)" connector="or"/>
							  <!-- remove all old autoship codes -->
							  <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;203&quot;, &quot;&quot;))"/>
							  <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;204&quot;, &quot;&quot;))"/>
							  <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;205&quot;, &quot;&quot;))"/>
							  <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;207&quot;, &quot;&quot;))"/>
							  <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(.Options2 + &quot;,&quot; + tmpCode )"/>
							  <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;,,&quot;, &quot;,&quot;))"/>
							  <WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
              </WTCODEGROUP>
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(newTitle)" oper="greater" value="CONST(oldTitle)"/>
                <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(newTitle)"/>
                <WTMETHOD name="Save"/>
              </WTCODEGROUP>
            </WTCODEGROUP>

            <!-- Process Trial Members -->
            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(2)"/>
              <WTSETATTRIBUTE name="CONST(initCode)" value="CONST(Replace(tmpCode, &quot;20&quot;, &quot;10&quot;) )"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(initCode + &quot;,&quot; + tmpCode )"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="ATTR(Price)"/>
              <WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
              <WTCODEGROUP>
                <WTCONDITION expr="CONST(newTitle)" oper="not-equal" value="CONST(oldTitle)"/>
                <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(newTitle)"/>
                <WTMETHOD name="Save"/>
              </WTCODEGROUP>
            </WTCODEGROUP>

          </WTCODEGROUP>

					<!-- Temporarily turn off payment processing-->
<!--					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>-->

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Qualify)" oper="not-equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>

					<!-- If there is a change to the membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdate)" oper="not-equal" value="CONST(0)"/>
						<!-- Get Payment -->
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
							<WTCUSTOM>
								tmpProcessor = ""
								tmpAcct = ""
								Select Case reqPayType
								Case 1, 2, 3, 4	'Process Credit Cards
								tmpProcessor = tmpCardProcessor
								tmpAcct = tmpCardAcct
								Case 5 'Process Electronic Checks
								tmpProcessor = tmpCheckProcessor
								tmpAcct = tmpCheckAcct
								End Select
							</WTCUSTOM>
							<WTCALLSUB name="Result = SubmitPayment( reqCompanyID, reqMemberID, reqPayType, reqPayDesc, reqBillingPrice, Purpose, PostProcess )"/>
<!--						<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, reqBillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>-->
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
								<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
								<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(tmpUpdatePaidDate)" oper="not-equal" value="CONST(0)"/>
									<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
									<WTMETHOD name="Save">
										<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
									</WTMETHOD>
								</WTCODEGROUP>
								<!-- Send BitCoin Payment Request -->
								<WTCODEGROUP>
									<WTCONDITION expr="NoErrors"/>
									<WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)" connector="and"/>
									<WTCONDITION expr="CONST(PaymentID)" oper="not-equal" value="CONST(0)" connector="and"/>
									<WTCUSTOM>
										result = SendBitCoinRequest( reqCompanyID, .Email, Purpose, reqBillingPrice, PaymentID )
									</WTCUSTOM>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMember" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
						<!-- log the membership change -->
						<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE: (&quot; + oldOptions2 + &quot;) to (&quot; + .Options2 + &quot;)&quot;">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
						<WTCALLSUB name="reqBillingPrice = FormatCurrency( reqBillingPrice, 2 )">
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
						<!-- Update possible old pending payment or create new payment -->
						<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(303)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
				</WTOBJECT>

				<!-- If there is a change to the member's title (or they activated) -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(newTitle)" oper="greater" value="CONST(oldTitle)"/>
						<!-- log the title change -->
						<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
							<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="PARAM(MemberID)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(newTitle)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.IsEarned)" value="CONST(1)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTOBJECT>
						<!-- notify the referrer -->
						<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
							<WTCONDITION expr="CONST(tmpReferralID)" oper="not-equal" value="CONST(0)"/>
							<WTMETHOD name="Load">
								<WTPARAM name="MemberID" direction="input" value="CONST(tmpReferralID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)"/>
							<WTCUSTOM>
								tmpSender = "support@gcrmarketing.com"
								tmpFrom = "support@gcrmarketing.com"
								Select Case newTitle
								Case 2
								tmpSubject = tmpName + " has upgraded to Dealer"
								Case 3
								tmpSubject = tmpName + " has upgraded to Bronze"
								Case 4
								tmpSubject = tmpName + " has upgraded to Silver"
								Case 5
								tmpSubject = tmpName + " has upgraded to Gold"
								End Select
								tmpBody = tmpSubject
								SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
							</WTCUSTOM>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Custom Upgrade Processing -->
					<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
						<WTMETHOD name="Custom">
							<WTPARAM name="Status" direction="input" value="CONST(102)"/>
							<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Result" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)">
						<WTCONDITION expr="CONST(tmpUpdate)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(-1)">
						<WTCONDITION expr="CONST(tmpUpdate)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE ERROR: &quot; + xmlError"/>
				</WTCODEGROUP>

			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			
			<WTACTION id="4" name="logout" type="Cancel">
				<WTRETURN>
					<WTLINK name="0101" nodata="true">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>
				<WTCOLUMN width="600" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="PARAM(CountryID)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" align="center" class="PageHeading" fontcolor="blue">
							<WTSTATIC label="SuccessfulChange" value="ATTR(Member.Price)">
								<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="NoChange">
								<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(-1)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="24">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>
				  <WTROW margin-bottom="6">
					  <WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				  </WTROW>

					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="13802" caption="GCR Stats" header="false" footer="false" navbar="false" action="0" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="13802" secured="1251">
			<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					If reqDay &gt; 0 Then reqToday = DateAdd("d", reqDay * -1, reqSysDate) Else reqToday = reqSysDate
					Select Case DATEPART("w", reqToday )
					Case 1 reqToday = reqToday &amp; " Sunday"
					Case 2 reqToday = reqToday &amp; " Monday"
					Case 3 reqToday = reqToday &amp; " Tuesday"
					Case 4 reqToday = reqToday &amp; " Wednesday"
					Case 5 reqToday = reqToday &amp; " Thursday"
					Case 6 reqToday = reqToday &amp; " Friday"
					Case 7 reqToday = reqToday &amp; " Saturday"
					End Select
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(7)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="center"/>
				<WTCOLUMN width="6" align="center"/>
				<WTCOLUMN width="300" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="GCRStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="90" align="right"/>
								<WTCOLUMN width="70" align="center"/>
								<WTCOLUMN width="70" align="center"/>
								<WTCOLUMN width="70" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Members"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Member" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m11)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m17)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m199)"/>
								</WTROW>
<!--
                <WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Affiliate" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m21)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m27)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m299)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Bronze" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m31)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m37)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m399)"/>
								</WTROW>
-->                
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Silver" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m41)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m47)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m499)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Gold" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m51)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m57)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m599)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Diamond" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m61)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m67)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m699)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Active" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.a1)" bold="true"/>
									<WTSTATIC col="3" value="ATTR(Stats.a7)" bold="true"/>
									<WTSTATIC col="4" value="ATTR(Stats.a99)" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Cancelled" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.c1)" bold="true"/>
									<WTSTATIC col="3" value="ATTR(Stats.c7)" bold="true"/>
									<WTSTATIC col="4" value="ATTR(Stats.c99)" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.t1)" bold="true"/>
									<WTSTATIC col="3" value="ATTR(Stats.t7)" bold="true"/>
									<WTSTATIC col="4" value="ATTR(Stats.t99)" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
					<WTSTATIC col="2"/>
					<WTTABLE col="3" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="8" align="right"/>
								<WTCOLUMN width="73" align="center"/>
								<WTCOLUMN width="73" align="center"/>
								<WTCOLUMN width="73" align="center"/>
								<WTCOLUMN width="73" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="5" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Sales"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true" align="center"/>
									<WTSTATIC col="3" label="Days7" bold="true"/>
									<WTSTATIC col="4" label="Days30" bold="true"/>
									<WTSTATIC col="5" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="S" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S11)" align="center"/>
									<WTSTATIC col="3" value="ATTR(Stats.S17)"/>
									<WTSTATIC col="4" value="ATTR(Stats.S130)"/>
									<WTSTATIC col="5" value="ATTR(Stats.S199)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="P" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S21)" align="center"/>
									<WTSTATIC col="3" value="ATTR(Stats.S27)"/>
									<WTSTATIC col="4" value="ATTR(Stats.S230)"/>
									<WTSTATIC col="5" value="ATTR(Stats.S299)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="A" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S31)" align="center"/>
									<WTSTATIC col="3" value="ATTR(Stats.S37)"/>
									<WTSTATIC col="4" value="ATTR(Stats.S330)"/>
									<WTSTATIC col="5" value="ATTR(Stats.S399)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="75" align="right"/>
                <WTCOLUMN width="75" align="center"/>
                <WTCOLUMN width="75" align="center"/>
                <WTCOLUMN width="75" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Bonuses"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" label="Today" bold="true" align="center"/>
                  <WTSTATIC col="2" label="Days7" bold="true"/>
                  <WTSTATIC col="3" label="Days30" bold="true"/>
                  <WTSTATIC col="4" label="Total" bold="true"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" value="ATTR(Stats.B1)" align="center"/>
                  <WTSTATIC col="2" value="ATTR(Stats.B7)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.B30)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.B99)"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="63" align="center"/>
                <WTCOLUMN width="79" align="center"/>
                <WTCOLUMN width="79" align="center"/>
                <WTCOLUMN width="79" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Wallet"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" label="Available" bold="true"/>
                  <WTSTATIC col="3" label="Requested" bold="true"/>
                  <WTSTATIC col="4" label="Total" bold="true"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Total" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.W1)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.W2)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.W3)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Qualified" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.W4)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.W5)"/>
                  <WTSTATIC col="4"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="13803" caption="GCR Wallet" header="false" footer="false" navbar="false" action="0" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="13803">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Product" datatype="text"/>
			<WTPARAM name="Logon" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpAuthUserID)" value="ATTR(AuthUserID)"/>
          <WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;101&quot;)"/>
            <!--          
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;101&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;202&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;202&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;203&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;203&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;204&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;204&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;205&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;205&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;206&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;206&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;207&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;207&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Product)" value="CONST(&quot;208&quot;)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;208&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
-->          
				</WTOBJECT>
				<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
					<WTCONDITION expr="PARAM(Product)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="CONST(tmpAuthUserID)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Logon)" value="ATTR(Logon)"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="ATTR(Password)"/>
				</WTOBJECT>
				<!-- Send GCR Order -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTCUSTOM>
						Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
						If oHTTP Is Nothing Then
						Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
            Else
            reqLogon = Replace( reqLogon, Chr(38), "%26") 'can't pass amphersand in URL
            tmpPassword = Replace( tmpPassword, Chr(38), "%26") 'can't pass amphersand in URL
            tmpURL = "GlobalCoinOrder.asp?MemberID=" + CStr(reqMemberID) + "&amp;Product=" + reqProduct + "&amp;User=" + reqLogon + "&amp;Pswd=" + tmpPassword
						tmpURL = "http://" + reqSysServerName + reqSysServerPath + tmpURL
						Response.write "&lt;BR&gt;" + tmpURL + "&lt;BR&gt;&lt;BR&gt;"
						oHTTP.open "GET", tmpURL
						oHTTP.send
						End If
						Set oHTTP = Nothing
					</WTCUSTOM>
				</WTCODEGROUP>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC tag="Dealer" value="PARAM(MemberID)" space="2"/>
						<WTSTATIC value="PARAM(Logon)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTSTATIC label="NoProducts" fontcolor="red">
							<WTCONDITION expr="PARAM(Product)" oper="equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC fontcolor="blue">
							<WTCONDITION expr="PARAM(Product)" oper="not-equal" value="CONST('')"/>
							<WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST('')" connector="and"/>
							<WTSTATIC label="NewWallet" space="1"/>
							<WTSTATIC value="PARAM(Product)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTBUTTON col="1" value="Close">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="13804" caption="GCR Dashboard" header="false" footer="false" navbar="false" action="0" wrapper="wrapper400s"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="13804" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Show" datatype="number"/>
      
      
      <WTPARAM name="Today" datatype="text"/>

      <WTDATATXN name="Dash"/>

      <!-- CHECK FOR NON-DOWNLINE ACCESS -->
			<WTSUB name="CheckUpline">
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="CheckUpline">
							<WTPARAM name="SponsorID" direction="input" value="SYS(MemberID)"/>
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(1)"/>
							<WTPARAM name="Result" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTRETURN>
						<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
						<WTLINK name="0101" return="false">
							<WTPARAM name="ActionCode" value="CONST(9)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTSUB>

  <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(Show)" value="CONST(1)">
          <WTCONDITION expr="IsEmployee"/>
          <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
          <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="SYS(MemberID)" connector="or"/>
        </WTSETATTRIBUTE>
        <WTCUSTOM>
          reqToday = reqSysDate
          Select Case DATEPART("w", reqToday )
          Case 1 reqToday = reqToday &amp; " Sunday"
          Case 2 reqToday = reqToday &amp; " Monday"
          Case 3 reqToday = reqToday &amp; " Tuesday"
          Case 4 reqToday = reqToday &amp; " Wednesday"
          Case 5 reqToday = reqToday &amp; " Thursday"
          Case 6 reqToday = reqToday &amp; " Friday"
          Case 7 reqToday = reqToday &amp; " Saturday"
          End Select
        </WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="CheckUpline"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
          <WTMETHOD name="Load">
            <WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlCompany" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(8)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="xmlDash" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="400" align="center"/>

        <WTROW>
          <WTSTATIC col="1" align="center">
            <WTCODEGROUP>
              <WTIMAGE value="CONST(Dashboard.png)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
        
        <WTROW margin-bottom="3">
          <WTSTATIC col="1" align="center" class="PageHeading">
            <WTSTATIC space="1"/>
            <WTSTATIC label="GCRDashboard"/>
            <WTSTATIC value="CONST( - )"/>
            <WTSTATIC value="PARAM(Today)" newline="1"/>
            <WTSTATIC bold="true">
              <WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
              <WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
              <WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;))"/>
            </WTSTATIC>
            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(Dash.f)" oper="not-equal" value="CONST(0)"/>
              <WTIMAGE value="CONST(IsLocked.gif)" imgalign="absmiddle"/>
            </WTCODEGROUP>
<!--            
            <WTSTATIC newline="1"/>
            <WTSTATIC label="Joined" space="1"/>
            <WTSTATIC value="ATTR(Member.EnrollDate)"/>
-->            
          </WTSTATIC>
        </WTROW>

        <WTROW margin-bottom="3">
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="150" align="right"/>
                <WTCOLUMN width="250" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Advancement"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="Title" align="right"/>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;"/>
                    </WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Title1">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title2">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title3">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title4">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title5">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title6">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title7">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title8">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(8)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title9">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(9)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title10">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(10)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(10)"/>
                  <WTSTATIC col="1" tag="NextTitle" align="right"/>
                  <WTSTATIC col="2">
                    <WTCODEGROUP>
                      <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title+1&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;"/>
                    </WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Title2">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title3">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title4">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title5">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title6">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title7">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title8">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title9">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(8)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Title10">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(9)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="NeedNext" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC value="ATTR(Dash.a1)"/>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Personal">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(9)"/>
                    </WTSTATIC>
                    <WTSTATIC space="1"/>
                    <WTSTATIC label="Need2">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need3">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need4">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need5">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need6">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need7">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need8">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need9">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(8)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Need10">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(9)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="PersonalsTeam" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC value="ATTR(Member.BV)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Member.QV)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="LastRecruit" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.r1)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.r1)">
                      <WTCONDITION expr="ATTR(Dash.r1)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.r2)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.r2)">
                      <WTCONDITION expr="ATTR(Dash.r2)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-bottom="3">
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="150" align="right"/>
                <WTCOLUMN width="250" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Qualifications"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="BonusQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="Yes" bold="true">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(0)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NotActive" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Trial14" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Active30" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="PayoutQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="Yes" bold="true">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(0)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NotActive" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NoPayoutMethod" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(2)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NoTaxID" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(3)"/>
                    </WTSTATIC>
                    <WTSTATIC label="NoSTPUSA" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q2)" oper="equal" value="CONST(4)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="CollectorQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="Collector5">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(1)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Collector10">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="equal" value="CONST(0)"/>
                      <WTCONDITION expr="ATTR(Member.Title)" oper="greater" value="CONST(1)" connector="and"/>
                    </WTSTATIC>
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.q1)" oper="not-equal" value="CONST(0)"/>
                      <WTCONDITION expr="ATTR(Member.Title)" oper="not-equal" value="CONST(1)" connector="and"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="LeadershipQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="D1Team">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="D2Team">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="D3Team">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="greater-equal" value="CONST(8)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="MatchQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="No">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="less" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Level1">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Level2">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Level3">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                    </WTSTATIC>
                    <WTSTATIC label="Level4">
                      <WTCONDITION expr="ATTR(Member.Title)" oper="greater-equal" value="CONST(8)"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="MatrixQualified" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None" fontcolor="red">
                      <WTCONDITION expr="ATTR(Dash.q3)" oper="equal" value="CONST(0)"/>
                    </WTSTATIC>
                    <WTSTATIC>
                      <WTCONDITION expr="ATTR(Dash.q3)" oper="not-equal" value="CONST(0)"/>
                      <WTSTATIC label="Level2">
                        <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(2)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level4">
                        <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(3)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level6">
                        <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(4)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level8">
                        <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(5)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level10">
                        <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(6)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level12">
                        <WTCONDITION expr="ATTR(Member.Title)" oper="equal" value="CONST(7)"/>
                      </WTSTATIC>
                      <WTSTATIC label="Level15">
                        <WTCONDITION expr="ATTR(Member.Title)" oper="greater-equal" value="CONST(8)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
<!--                
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="SpainPromo" align="right"/>
                  <WTSTATIC col="2"  value="ATTR(Dash.s3)"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="SpainPersonal" align="right"/>
                  <WTSTATIC col="2"  value="ATTR(Dash.s1)"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="SpainTeam" align="right"/>
                  <WTSTATIC col="2"  value="ATTR(Dash.s2)"/>
                </WTROW>
-->                
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-bottom="3">
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="100" align="right"/>
                <WTCOLUMN width="100" align="center"/>
                <WTCOLUMN width="100" align="center"/>
                <WTCOLUMN width="100" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Finances"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTCONDITION expr="PARAM(Show)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" label="Recent" bold="true"/>
                  <WTSTATIC col="3" label="Quarter" bold="true"/>
                  <WTSTATIC col="4" label="Total" bold="true"/>
                </WTROW>

                <WTROW margin-bottom="2">
                  <WTCONDITION expr="PARAM(Show)" oper="not-equal" value="CONST(0)"/>
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="PARAM(Show)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC col="1" tag="Payouts" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Dash.p1)"/>
                  <WTSTATIC col="3" value="ATTR(Dash.p3)"/>
                  <WTSTATIC col="4" value="ATTR(Dash.p99)"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="FirstOrder" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.b3)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.b3)">
                      <WTCONDITION expr="ATTR(Dash.b3)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="3">
                    <WTSTATIC value="ATTR(Dash.b4)">
                      <WTCONDITION expr="ATTR(Dash.b4)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="4"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="LastOrder" align="right"/>
                  <WTSTATIC col="2">
                    <WTSTATIC label="None">
                      <WTCONDITION expr="ATTR(Dash.b1)" oper="equal" value="CONST('')"/>
                    </WTSTATIC>
                    <WTSTATIC value="ATTR(Dash.b1)">
                      <WTCONDITION expr="ATTR(Dash.b1)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="3">
                    <WTSTATIC value="ATTR(Dash.b2)">
                      <WTCONDITION expr="ATTR(Dash.b2)" oper="not-equal" value="CONST('')"/>
                    </WTSTATIC>
                  </WTSTATIC>
                  <WTSTATIC col="4"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTSTATIC col="1" tag="NextOrder" align="right"/>
                    <WTSTATIC col="2">
                      <WTSTATIC value="ATTR(Member.Price)">
                        <WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
                      </WTSTATIC>
                      <WTSTATIC label="None">
                        <WTCONDITION expr="ATTR(Member.Billing)" oper="not-equal" value="CONST(3)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                    <WTSTATIC col="3">
                      <WTSTATIC value="ATTR(Member.PaidDate)">
                        <WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
                      </WTSTATIC>
                    </WTSTATIC>
                  <WTSTATIC col="4"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Member.Retail)" oper="not-equal" value="CONST('$0.00')"/>
                  <WTSTATIC col="1" tag="LostBonuses" align="right" fontcolor="red"/>
                  <WTSTATIC col="2" value="ATTR(Member.Retail)" fontcolor="red"/>
                  <WTSTATIC col="3" merge="2" align="left" fontcolor="red">
                    <WTSTATIC label="since" space="1"/>
                    <WTSTATIC value="ATTR(Company.LostBonusDate)"/>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW>
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="400" align="center"/>
            <WTROW margin-bottom="3">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="400" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC fontcolor="darkblue" bold="true">
                      <WTSTATIC label="Leadership"/>
                    </WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l11)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="Enroller" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l11)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l12)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l13)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l21)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="Mentor" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l21)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l22)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l23)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l31)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="D1Leader" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l31)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l32)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l33)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l41)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="D2Leader" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l41)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l42)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l43)"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="2">
                  <WTCONDITION expr="ATTR(Dash.l51)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC col="1" align="center">
                    <WTSTATIC tag="D3Leader" bold="true"/>
                    <WTSTATIC value="ATTR(Dash.l51)" newline="1"/>
                    <WTSTATIC value="ATTR(Dash.l52)" space="1"/>
                    <WTSTATIC value="CONST(/)" space="1"/>
                    <WTSTATIC value="ATTR(Dash.l53)"/>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-top="6" margin-bottom="6">
          <WTBUTTON col="1" value="Close">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

  		<!--============================================================================================-->
		<WTWEBPAGE name="13805" caption="GCR Support" header="false" footer="false" navbar="false" action="0" wrapper="wrapper800"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="13805" secured="1251">
			<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>
			<WTPARAM name="OrgID" datatype="number"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
          If reqDay &gt; 0 Then tmpToday = CStr(DateAdd("d", reqDay * -1, reqSysDate)) Else tmpToday = reqSysDate
					Select Case DATEPART("w", tmpToday )
					Case 1 reqToday = "Sunday "
					Case 2 reqToday = "Monday "
					Case 3 reqToday = "Tuesday "
					Case 4 reqToday = "Wednesday "
					Case 5 reqToday = "Thursday "
					Case 6 reqToday = "Friday "
					Case 7 reqToday = "Saturday "
					End Select
          reqToday = reqToday + tmpToday + " " + CStr(Time())
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(12)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
        <WTCONDITION expr="PARAM(OrgID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>			
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Orgs" project="ptsOrgUser" class="COrgs">
					<WTMETHOD name="ListActiveUsers">
						<WTPARAM name="CompanyID" direction="input" value="SYSCON(GCR)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrgs" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="267" align="center"/>
				<WTCOLUMN width="267" align="center"/>
				<WTCOLUMN width="266" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="GCRSupportStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

        <WTROW>
					<WTTABLE col="1" merge="3">
						<WTCOLUMN width="800" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="80" align="right"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>
								<WTCOLUMN width="72" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="11" height="24" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true" fontsize="3">
                      <WTCODEGROUP>
                        <WTCONDITION expr="PARAM(OrgID)" oper="equal" value="CONST(0)"/>
			        			    <WTSTATIC label="AllSupportTickets"/>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="PARAM(OrgID)" oper="not-equal" value="CONST(0)"/>
						            <WTSTATIC value="ATTR(Org.NameFirst)" space="1"/>
						            <WTSTATIC value="ATTR(Org.NameLast)" space="1"/>
                        <WTSTATIC label="SupportTickets"/>
                      </WTCODEGROUP>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTDIVIDER col="1" merge="11" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="1hr" bold="true"/>
									<WTSTATIC col="3" label="4hr" bold="true"/>
									<WTSTATIC col="4" label="12hr" bold="true"/>
									<WTSTATIC col="5" label="1day" bold="true"/>
									<WTSTATIC col="6" label="2day" bold="true"/>
									<WTSTATIC col="7" label="3day" bold="true"/>
									<WTSTATIC col="8" label="7day" bold="true"/>
									<WTSTATIC col="9" label="14day" bold="true"/>
									<WTSTATIC col="10" label="14+day" bold="true"/>
									<WTSTATIC col="11" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Submitted" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z1a)" fontcolor="green"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z1b)" fontcolor="green"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z1c)" fontcolor="orange"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z1d)" fontcolor="orange"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z1e)" fontcolor="purple"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z1f)" fontcolor="purple"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z1g)" fontcolor="red"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z1h)" fontcolor="red"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z1i)" fontcolor="red" bold="true"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z1t)" fontcolor="blue"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Assigned" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z2a)" fontcolor="green"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z2b)" fontcolor="green"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z2c)" fontcolor="orange"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z2d)" fontcolor="orange"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z2e)" fontcolor="purple"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z2f)" fontcolor="purple"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z2g)" fontcolor="red"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z2h)" fontcolor="red"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z2i)" fontcolor="red" bold="true"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z2t)" fontcolor="blue"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="InProcess" align="right" fontcolor="blue"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z3a)" fontcolor="green"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z3b)" fontcolor="green"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z3c)" fontcolor="orange"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z3d)" fontcolor="orange"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z3e)" fontcolor="purple"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z3f)" fontcolor="purple"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z3g)" fontcolor="red"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z3h)" fontcolor="red"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z3i)" fontcolor="red" bold="true"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z3t)" fontcolor="blue"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTDIVIDER col="1" merge="11" height="1" color="#5084A2"/>
								</WTROW>
                <WTROW margin-bottom="6">
                  <WTSTATIC col="1" tag="Unresolved" align="right" fontcolor="blue"/>
                  <WTSTATIC col="2" value="ATTR(Stats.Z7a)" fontcolor="blue"/>
                  <WTSTATIC col="3" value="ATTR(Stats.Z7b)" fontcolor="blue"/>
                  <WTSTATIC col="4" value="ATTR(Stats.Z7c)" fontcolor="blue"/>
                  <WTSTATIC col="5" value="ATTR(Stats.Z7d)" fontcolor="blue"/>
                  <WTSTATIC col="6" value="ATTR(Stats.Z7e)" fontcolor="blue"/>
                  <WTSTATIC col="7" value="ATTR(Stats.Z7f)" fontcolor="blue"/>
                  <WTSTATIC col="8" value="ATTR(Stats.Z7g)" fontcolor="blue"/>
                  <WTSTATIC col="9" value="ATTR(Stats.Z7h)" fontcolor="blue"/>
                  <WTSTATIC col="10" value="ATTR(Stats.Z7i)" fontcolor="blue"/>
                  <WTSTATIC col="11" value="ATTR(Stats.Z7t)" fontcolor="blue"/>
                </WTROW>
<!--                
                <WTROW margin-bottom="6">
                  <WTSTATIC col="1" tag="Resolved" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.Z4a)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.Z4b)"/>
                  <WTSTATIC col="4" value="ATTR(Stats.Z4c)"/>
                  <WTSTATIC col="5" value="ATTR(Stats.Z4d)"/>
                  <WTSTATIC col="6" value="ATTR(Stats.Z4e)"/>
                  <WTSTATIC col="7" value="ATTR(Stats.Z4f)"/>
                  <WTSTATIC col="8" value="ATTR(Stats.Z4g)"/>
                  <WTSTATIC col="9" value="ATTR(Stats.Z4h)"/>
                  <WTSTATIC col="10" value="ATTR(Stats.Z4i)"/>
                  <WTSTATIC col="11" value="ATTR(Stats.Z4t)"/>
                </WTROW>
                <WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Postponed" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z5a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z5b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z5c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z5d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z5e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z5f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z5g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z5h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z5i)"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z5t)"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTDIVIDER col="1" merge="11" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z6a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z6b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z6c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z6d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z6e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z6f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z6g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z6h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z6i)"/>
									<WTSTATIC col="11" value="ATTR(Stats.Z6t)"/>
								</WTROW>
-->                
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTSTATIC col="1" tag="OrgID" align="center"/>
					<WTTEXT col="1" value="PARAM(OrgID)" size="4" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

      	<WTROW>
          <WTTABLE col="1" valign="top">
            <WTCOLUMN width="200" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="100" align="center"/>
                <WTCOLUMN width="100" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="2" height="24" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC label="DailyResolvedTickets" fontcolor="darkblue" bold="true"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="2" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Today" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD1)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="Yesterday" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD2)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="2DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD3)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="3DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD4)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="4DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD5)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="5DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD6)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="6DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD7)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="7DaysAgo" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZD8)"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>

          <WTTABLE col="2" valign="top">
            <WTCOLUMN width="200" align="center"/>
            <WTROW margin-bottom="6">
              <WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
                <WTCOLUMN width="80" align="right"/>
                <WTCOLUMN width="60" align="center"/>
                <WTCOLUMN width="60" align="center"/>

                <WTROW>
                  <WTSTATIC col="1" merge="3" height="24" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
                    <WTSTATIC label="ResolvedTicketDays" fontcolor="darkblue" bold="true"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTDIVIDER col="1" merge="3" height="1" color="#5084A2"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="SameDay" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR1)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP1)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="NextDay" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR2)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP2)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="2Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR3)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP3)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="3Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR4)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP4)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="4Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR5)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP5)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="5Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR6)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP6)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="6Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR7)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP7)"/>
                </WTROW>
                <WTROW margin-bottom="3">
                  <WTSTATIC col="1" tag="6+Days" align="right"/>
                  <WTSTATIC col="2" value="ATTR(Stats.ZR8)"/>
                  <WTSTATIC col="3" value="ATTR(Stats.ZP8)"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>

          <WTTABLE col="3" valign="top">
            <WTCOLUMN width="200" align="center"/>
            <WTROW margin-bottom="6">
              <WTRECORDSET col="1" graybar="true" entity="Org" valign="top">
                <WTCOLUMN width="40" align="center" label="OrgID"/>
                <WTCOLUMN width="60" align="left" label="StaffName"/>
                <WTROW>
                  <WTSTATIC col="1" value="DATA(Org.OrgID)" align="center"/>
                  <WTSTATIC col="2" value="DATA(Org.NameFirst)" align="left"/>
                </WTROW>
              </WTRECORDSET>
            </WTROW>
          </WTTABLE>

        </WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="MiningPool" caption="GCR Distribution Pool" header="false" footer="false" navbar="false" wrapper="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="MiningPool">
      <!--============================================================================================-->
      <WTPARAM name="Days" datatype="number"/>
      <WTPARAM name="M" datatype="number"/>

      <WTCODEGROUP>
			  <WTCONDITION expr="NotEmployee"/>
			  <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
			  <WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
  			<WTSETATTRIBUTE name="PARAM(M)" value="CONST(0)"/>
      </WTCODEGROUP>
        
      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="GCRs" project="ptsGCRUser" class="CGCRs">
          <WTMETHOD name="CustomList">
            <WTPARAM name="Status" direction="input" value="CONST(1)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(Days)"/>
            <WTPARAM name="Amount" direction="input" value="PARAM(M)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlGCRs" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="250" align="left"/>

        <WTROW margin-top="6">
          <WTSTATIC col="1" align="left" class="PageHeading">
            <WTSTATIC value="CONST(GCR Distribution Pool)" space="1"/>
            <WTSTATIC value="PARAM(M)">
              <WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-top="6" margin-bottom="6">
          <WTSTATIC col="1" value="CONST(Distribution Prices Only - NOT Public Prices)" align="left" bold="true"/>
        </WTROW>
        <WTREPEAT entity="GCR">
          <WTROW>
            <WTSTATIC col="1" value="DATA(Result)"/>
          </WTROW>
        </WTREPEAT>

        <WTROW margin-top="12" margin-bottom="12">
          <WTSTATIC col="1" merge="3" tag="DaysBack" align="left"/>
          <WTTEXT col="1" value="PARAM(Days)" size="1" prespace="false" focus="true"/>
          <WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
          <WTBUTTON col="1" value="Close" btnclass="smbutton">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>
      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="WalletInfo" caption="GCR Coin Wallet Info" header="false" footer="false" navbar="false" wrapper="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="WalletInfo" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Member2FA" datatype="number"/>
      <WTPARAM name="ShowAdmin" datatype="number"/>
      <WTPARAM name="Email" datatype="text"/>

      <WTINCLUDE name="GCRWallet.asp"/>

      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTCODEGROUP>
        <WTCONDITION expr="IsEmployee"/>
        <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
        <WTCONDITION expr="IsMemberOnly" connector="or"/>
        <WTSETATTRIBUTE name="PARAM(ShowAdmin)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(Is2FA(reqSysUserID))"/>
      </WTCODEGROUP>
      
      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
              <WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(3)" connector="and"/>
              <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="PARAM(Email)">
            <WTCONDITION expr="PARAM(Email)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(tmpReference)" value="ATTR(Reference)"/>
          <WTCUSTOM>
            tmpAddress = ""
            tmpBalance = 0
            tmp2FA = 0
            tmpCreated = ""
            tmp2FAStatus = ""
            result = GCRWallet_Info( tmpEmail, tmpAddress, tmpBalance, tmp2FA, tmpCreated )
            If result = "ok" Then
              strBalance = FormatNumber(tmpBalance,8)
              If tmp2FA = "1" Then tmp2FAStatus = "Enabled" Else tmp2FAStatus = "Disabled"
            Else
              tmpAddress = result
              strBalance = result
              tmpEmail = "NOT " + tmpEmail
            End If
          </WTCUSTOM>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;WalletInfo.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(ShowAdmin)" oper="not-equal" value="CONST(1)"/>
            <WTCONDITION expr="PARAM(Member2FA)" oper="not-equal" value="CONST(1)" connector="or"/>
            <WTSETATTRIBUTE name="CONST(tmpEmail)" value="CONST(&quot;**********&quot;)"/>
            <WTSETATTRIBUTE name="CONST(tmpReference)" value="CONST(&quot;**********&quot;)"/>
          </WTCODEGROUP>
          <WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{email}", tmpEmail )
            xmlHTMLFile = Replace( xmlHTMLFile, "{reference}", tmpReference )
            xmlHTMLFile = Replace( xmlHTMLFile, "{address}", tmpAddress )
            xmlHTMLFile = Replace( xmlHTMLFile, "{balance}", CStr(strBalance) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{2FA}", tmp2FAStatus )
            xmlHTMLFile = Replace( xmlHTMLFile, "{created}", tmpCreated )
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <WTACTION id="5" name="ResetPassword" type="Update">
        <WTCUSTOM>
          Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
          tmpURL = "https://www.gcrmarketing.com/GCRWalletCreate.asp?M=" + CStr(reqMemberID)
          oHTTP.open "GET", tmpURL
          oHTTP.send
          Set oHTTP = Nothing
        </WTCUSTOM>
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <WTACTION id="6" name="DisableWallet" type="Update">
        <WTCUSTOM>
          Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
          tmpURL = "https://www.gcrmarketing.com/GCRWalletDisable.asp?M=" + CStr(reqMemberID)
          oHTTP.open "GET", tmpURL
          oHTTP.send
          result = oHTTP.ResponseText
          If result &lt;&gt; "ok" Then DoError 1, "", result
          Set oHTTP = Nothing
        </WTCUSTOM>
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>
      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="400" align="left"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" action="5" value="CONST(ResetPassword)" align="center" msg="ConfirmResetPassword">
            <WTCONDITION expr="PARAM(ShowAdmin)" oper="equal" value="CONST(1)"/>
            <WTCONDITION expr="PARAM(Member2FA)" oper="equal" value="CONST(1)" connector="and"/>
          </WTBUTTON>
          
          <WTBUTTON col="1" action="6" value="CONST(Disable2FA)" msg="ConfirmDisable2FA">
            <WTCONDITION expr="IsManager"/>
          </WTBUTTON>
          
          <WTBUTTON col="1" value="Close">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>
        
      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="GCRPaymentPortal" caption="GCR Payments" header="false" footer="false" navbar="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="GCRPaymentPortal" secure="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="PaymentID" datatype="number"/>
      <WTPARAM name="Status" datatype="number"/>
      <WTPARAM name="Member2FA" datatype="number"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(Is2FA(reqSysUserID))"/>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(500)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            a = Split(Result, "|")
            reqStatus = a(0)
            reqPaymentID = a(1)
            tmpAmount = a(2)
          </WTCUSTOM>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;PaymentPortal.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
          <WTCUSTOM>
            If reqMember2FA = 0 Then str2FA = "Disabled" Else str2FA = "Enabled"
            If reqStatus = 1 Then strPayment = "First" Else strPayment = "Next"
            strAmount = FormatCurrency(tmpAmount)
            xmlHTMLFile = Replace( xmlHTMLFile, "{mid}", CStr(reqMemberID) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{pid}", CStr(reqPaymentID) )
            xmlHTMLFile = Replace( xmlHTMLFile, "{2fa}", str2FA )
            xmlHTMLFile = Replace( xmlHTMLFile, "{amount}", strAmount )
            xmlHTMLFile = Replace( xmlHTMLFile, "{payment}", strPayment )
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>
      
      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="600" align="left"/>

        <WTROW margin-bottom="6">
          <WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
          <WTSTATIC col="1" label="NoPaymentDue" align="center" class="PageHeading"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" action="3" value="Return" align="center"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="GCROrder" caption="GCR Coin Buying Service" header="false" footer="false" navbar="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="GCROrder" secure="52">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Amount" datatype="text"/>
      <WTPARAM name="Mode" datatype="number"/>
      <WTPARAM name="Product" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(501)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="reqProduct" direction="return" datatype="text"/>
          </WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(2)">
  					<WTCONDITION expr="PARAM(Product)" oper="equal" value="CONST(&quot;0&quot;)"/>
					</WTSETATTRIBUTE>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember">
  				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
        </WTCALLSUB>
      </WTACTION>

      <WTACTION id="2" name="Add" type="Add">
				<WTSETATTRIBUTE name="PARAM(Amount)" value="FORM(Amount)"/>
        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(Amount)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10139" message="Oops, Please enter an amount greater than zero."/>
        </WTCODEGROUP>
        
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Payment.CompanyID)" value="CONST(17)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.PayDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.PayType)" value="CONST(14)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.CommStatus)" value="CONST(3)"/>
          <WTSETATTRIBUTE name="ATTR(Amount)" value="PARAM(Amount)"/>
					<WTSETATTRIBUTE name="ATTR(Total)" value="ATTR(Amount)"/>
					<WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(&quot;GCRCOIN&quot;)"/>
          <WTMETHOD name="Add">
						<WTPARAM name="reqPaymentID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)">
  					<WTCONDITION expr="NoErrors"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="160" align="right"/>
        <WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="NewGCRPayment" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
				  <WTROW margin-top="12" margin-bottom="12">
					  <WTSTATIC col="1" merge="2" label="NoProduct" class="PageHeading" align="center"/>
				  </WTROW>
        </WTCODEGROUP>
        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
				  <WTROW margin-top="12" margin-bottom="12">
					  <WTSTATIC col="1" merge="2" class="PageHeading" align="center">
					    <WTSTATIC label="GoodPayment" newline="1"/>
					    <WTSTATIC label="GoodPayment2"/>
					  </WTSTATIC>
				  </WTROW>
        </WTCODEGROUP>
        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
				  <WTROW margin-top="6">
					  <WTSTATIC col="1" merge="2" label="PaymentText" class="prompt" align="left"/>
				  </WTROW>
				  <WTROW margin-top="6">
					  <WTSTATIC col="1" merge="2" label="PaymentText2" class="prompt" align="left"/>
				  </WTROW>
				  <WTROW margin-top="6" margin-bottom="18">
					  <WTSTATIC col="1" merge="2" label="PaymentText3" class="prompt" align="left"/>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1" tag="Amount"/>
					  <WTTEXT col="2" value="PARAM(Amount)" required="true" size="5"/>
				  </WTROW>
        </WTCODEGROUP>

        <WTROW margin-top="18" margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="2" value="CONST(CreateOrder)" align="center">
  					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>


    <!--============================================================================================-->
    <WTWEBPAGE name="GCREnroll" caption="GCR Enroll" header="false" footer="false" navbar="false"  wrapper="wrapper750blue"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="GCREnroll">
      <!--============================================================================================-->
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="M" datatype="number"/>
      <WTPARAM name="NewMemberID" datatype="number"/>
      <WTPARAM name="Mode" datatype="number"/>
      <WTPARAM name="IsAgree" datatype="number"/>
      <WTPARAM name="IsAgree2" datatype="number"/>
      <WTPARAM name="ReferID" datatype="text"/>
      <WTPARAM name="ReferredBy" datatype="text"/>
      <WTPARAM name="PayID" datatype="number"/>
      <WTPARAM name="Reference" datatype="text"/>

      <WTINCLUDE name="Email.asp"/>
      <WTINCLUDE name="Note.asp"/>
      <WTINCLUDE name="Comm.asp"/>

      <WTCODEGROUP>
        <WTCUSTOM>response.end</WTCUSTOM>
      </WTCODEGROUP>
      
      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
        <WTGETCACHE name="PARAM(M)" value="A" datatype="number"/>
      </WTCODEGROUP>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(GCR)"/>
        <WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
        <WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
        <WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
        <WTSETATTRIBUTE name="PARAM(IsAgree)" value="FORM(IsAgree)"/>
        <WTSETATTRIBUTE name="PARAM(IsAgree2)" value="FORM(IsAgree2)"/>
      </WTCODEGROUP>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="AddMember">
        <!-- get company options -->
        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
          <WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
        </WTOBJECT>
        <!-- Create Payout Record -->
        <WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTMETHOD name="Load">
            <WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <!-- Set eWallet -->
          <WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
          <WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-SOLIDTRUST)"/>
          <WTSETATTRIBUTE name="ATTR(CardName)" value="CONST(&quot;&quot;)" />
          <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
          <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
          <WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
          <WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
          <WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
          <WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
          <WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
          <WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
          <WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
          <WTMETHOD name="Save">
            <WTCONDITION expr="PARAM(PayID)" oper="not-equal" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="Add">
            <WTCONDITION expr="PARAM(PayID)" oper="equal" value="CONST(0)"/>
            <WTPARAM name="reqPayID" direction="return" datatype="number"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
        </WTOBJECT>

        <!-- get referrer's group # -->
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(GroupID)" value="ATTR(GroupID)"/>
          <WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email2)"/>
          <WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email)">
            <WTCONDITION expr="CONST(InStr(ReferEmail, &quot;@&quot;))" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
        </WTOBJECT>
        <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
          <WTMETHOD name="Load">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(CompanyEmail)" value="ATTR(Email)"/>
        </WTOBJECT>

        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTES/>

          <WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
          <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
          <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>

          <WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
          <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;RETAIL&quot;)">
            <WTCONDITION expr="PARAM(IsAgree2)" oper="not-equal" value="SYSCON(NO)"/>
          </WTSETATTRIBUTE>
<!--
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
            <WTMETHOD name="Save">
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
-->            
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
            <WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
            <WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
            <WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
            <WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
            <WTSETATTRIBUTE name="ATTR(GroupID)" value="CONST(GroupID)"/>
            <WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
              <WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
            <WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;BCDEFI&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
            <WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
            <WTMETHOD name="Add">
              <WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
<!--          
          </WTCODEGROUP>
-->          

          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <!-- Send Welcome Email w/ Logon and Password -->
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(tmpSendEmail)" oper="not-equal" value="CONST(0)"/>
              <WTCUSTOM>
                Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
                If oHTTP Is Nothing Then
                Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
                Else
                oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
                oHTTP.send
                End If
                Set oHTTP = Nothing
              </WTCUSTOM>
            </WTCODEGROUP>

            <!-- Create GCR Coin Wallet -->
            <WTCUSTOM>
              Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
              If oHTTP Is Nothing Then
              Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
              Else
              tmpURL = "GCRWalletCreate.asp?M=" + CStr(reqNewMemberID)
              oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + tmpURL
              oHTTP.send
              End If
              Set oHTTP = Nothing
            </WTCUSTOM>

            <!-- Send notice to Referrer -->
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(ReferEmail)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
              <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
              <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
              <WTCUSTOM>
                tmpSubject = "NEW REFERRED MEMBER: " + tmpNameFirst + " " + tmpNameLast + " - " + tmpEmail
                tmpBody = ""
                SendEmail reqCompanyID, CompanyEmail, CompanyEmail, ReferEmail, "", "", tmpSubject, tmpBody
              </WTCUSTOM>
            </WTCODEGROUP>

          </WTCODEGROUP>

        </WTOBJECT>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
            <WTMETHOD name="Load">
              <WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(NewMemberID)"/>
            <WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
            <WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
            <WTSETATTRIBUTES/>
            <WTMETHOD name="Add">
              <WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              <WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>

          <!-- Custom Company Activation Processing -->
          <WTCODEGROUP>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(100)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>

        </WTCODEGROUP>

        <WTCALLSUB name="LogMemberNote reqNewMemberID, &quot;ENROLL ERROR: &quot; + err.description + xmlError">
          <WTCONDITION expr="IsErrors"/>
          <WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
        </WTCALLSUB>
      </WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Reference)" value="ATTR(Reference)"/>
          <WTSETATTRIBUTES/>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="CONST(Len(.CountryID))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTCALLSUB name="LoadEnroll"/>
        <WTCALLSUB name="LoadCountrys"/>
        <WTCALLSUB name="LoadRefer"/>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadEnroll">
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Enroll.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>
      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadCountrys">
        <WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
          <WTMETHOD name="EnumCompany">
            <WTPARAM name="xmlCountrys" direction="return" datatype="text" />
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
            <WTPARAM name="ItemID" direction="input" value="CONST()" />
            <WTPARAM name="Element" direction="input" value="CONST()" />
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>
      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadRefer">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)">
            <WTCONDITION expr="ATTR(IsCompany)" oper="equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="PARAM(ReferredBy)" value="ATTR(CompanyName)">
            <WTCONDITION expr="ATTR(IsCompany)" oper="not-equal" value="CONST(0)"/>
          </WTSETATTRIBUTE>
          <WTCUSTOM>
            If InStr( "1234", .Status ) = 0 Then
            Response.Write "The Member that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
            Response.End
            End If
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidLogon">
        <WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
        <WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(6)" connector="and"/>
          <WTERROR number="10101" message="Oops, Your Logon Name must be at least six characters/numbers long."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(6)" connector="and"/>
          <WTERROR number="10102" message="Oops, Your Password must be at least six characters/numbers long."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
          <WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
            <WTMETHOD name="IsLogon">
              <WTPARAM name="IsAvailable" direction="return" datatype="number"/>
              <WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
            </WTMETHOD>
          </WTOBJECT>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
            <WTERROR number="-2147220513" message="Oops, The Logon/Website Name is not available.  Please select another or contact Member Support for assistance."/>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>
      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidAddress">
        <WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
          <WTCONDITION expr="NoErrors" />
          <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
          <WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
          <WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
          <WTSETATTRIBUTES/>
          <WTMETHOD name="Validate">
            <WTPARAM name="New" direction="input" value="CONST(1)" />
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>
      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidPhone">
        <WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
          <WTERROR number="10006" message="Oops, Phone Number is Required."/>
        </WTCODEGROUP>
      </WTSUB>
      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="DuplicateEmail">
        <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="ExistEmail">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
            <WTPARAM name="MemberID" direction="return" datatype="number"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(MemberID)" oper="not-equal" value="CONST(0)"/>
            <WTERROR number="10123" message="Oops, This email address is already assigned to someone else."/>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>
      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="ValidateContact">
        <WTCALLSUB name="LoadCompanyOptions">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
        <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
        <WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
        <WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTERROR number="10125" message="Oops, Please enter a First Name."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTERROR number="10126" message="Oops, Please enter a Last Name."/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
          <WTCUSTOM>
            If ValidEmail( tmpEmail ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
          </WTCUSTOM>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCALLSUB name="DuplicateEmail"/>
        </WTCODEGROUP>
        <WTCALLSUB name="ValidPhone">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidAddress">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidLogon">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(NewMemberID)" value="CONST(0)"/>
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <WTACTION id="2" name="Add" type="Add">
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
          <WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
          <WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
        </WTCODEGROUP>
        <WTCALLSUB name="ValidateContact">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="Addmember">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="LoadMember">
          <WTCONDITION expr="IsErrors"/>
        </WTCALLSUB>

        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)"/>
          <WTSETATTRIBUTE name="CONST(tmpLogon)" value="FORM(NewLogon)"/>
          <WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
          <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
            <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Welcome.htm&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
            <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
            <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
            <WTMETHOD name="Load" />
            <WTMETHOD name="XML">
              <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
            </WTMETHOD>
            <WTCUSTOM>
              xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqNewMemberID) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
              xmlHTMLFile = Replace( xmlHTMLFile, "{pwd}", tmpPassword )
              xmlHTMLFile = Replace( xmlHTMLFile, "{email}", tmpEmail )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reference}", reqReference )
            </WTCUSTOM>
          </WTOBJECT>
        </WTCODEGROUP>

      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="50" align="right"/>
        <WTCOLUMN width="160" align="right"/>
        <WTCOLUMN width="540" align="left"/>

        <WTFUNCTION name="TitleCase(obj)">
          var val = obj.value;
          if ( val.length == 2 ) {
          obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
          }
          else {
          obj.value = val.charAt(0).toUpperCase() + val.slice(1);
          }
        </WTFUNCTION>
        <WTFUNCTION name="FormatPhone(obj)">
          var val = obj.value;
          var newval = val.replace(/[^\d]/g, '');
          if( newval.length == 10 ) {
          obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
          }
          if( newval.length == 11 ) {
          obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
          }
          if( newval.length == 12 ) {
          obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
          }
        </WTFUNCTION>
        <WTFUNCTION name="FormatLogon(obj)">
          var val = obj.value;
          var newval = val.replace(/[^0-9a-zA-Z]/g, '');
          obj.value = newval;
          if( newval.length &lt; 6 ) {
          alert('Oops, Logon must be at least 6 characters or numbers.');
          }
        </WTFUNCTION>

        <WTROW>
          <WTHIDDEN value="PARAM(Mode)"/>
          <WTHIDDEN value="PARAM(M)"/>
          <WTHIDDEN value="PARAM(NewMemberID)"/>
          <WTHIDDEN value="PARAM(PayID)"/>
          <WTHIDDEN value="PARAM(ReferredBy)"/>
        </WTROW>

        <WTSTATIC label="IsAgree"/>
        <WTSTATIC label="IsAgree2"/>
        <WTSTATIC label="CompanyNameTip"/>
        <WTSTATIC label="Email2Tip"/>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(ReferredBy)" oper="equal" value="CONST('')"/>
            <WTROW margin-top="24">
              <WTSTATIC col="1" merge="3" align="center" class="PageHeading" fontcolor="red">
                <WTSTATIC label="NoReferral1" newline="2"/>
                <WTSTATIC label="NoReferral2"/>
              </WTSTATIC>
            </WTROW>
          </WTCODEGROUP>
          
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>

            <WTROW margin-top="6">
              <WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
            </WTROW>
            <WTROW margin-top="6" margin-bottom="12">
              <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
            </WTROW>
            <WTROW margin-bottom="12">
              <WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
              <WTSTATIC col="1" merge="3" align="center" bold="true">
                <WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
              </WTSTATIC>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
                <WTCODEGROUP>
                  <WTCHECK value="PARAM(IsAgree)"/>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>
            <WTROW margin-top="6">
              <WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
                <WTCODEGROUP>
                  <WTCHECK value="PARAM(IsAgree2)"/>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>

            <WTROW margin-top="12" margin-bottom="6">
              <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
            </WTROW>
            <WTROW margin-bottom="6">
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" merge="2" align="left" label="NewMemberText"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" tag="MemberName"/>
              <WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true" required="false">
                <WTEXIT>TitleCase(this);</WTEXIT>
              </WTTEXT>
              <WTTEXT col="3" value="ATTR(Member.NameLast)" width="340" label="NameLast" size="25" required="false">
                <WTEXIT>TitleCase(this);</WTEXIT>
              </WTTEXT>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2">
                <WTSTATIC label="CompanyName"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(TipQuestion.gif)" alt="CompanyNameTip">
                    <WTLINK name="CONST(alert('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='CompanyNameTip']&quot;/&gt;');)" click="true" />
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTSTATIC space="1"/>
              </WTSTATIC>
              <WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
            </WTROW>
            <WTROW margin-top="6">
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" tag="Email"/>
              <WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="false"/>
            </WTROW>
            <WTROW margin-top="6">
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" tag="Phone"/>
              <WTTEXT col="3" value="ATTR(Member.Phone1)" size="20">
                <WTEXIT>FormatPhone(this);</WTEXIT>
              </WTTEXT>
            </WTROW>
            <WTROW margin-top="6">
              <WTSTATIC col="1" />
              <WTSTATIC col="2" tag="Address" />
              <WTTEXT col="3" value="ATTR(Address.Street1)" size="60"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" />
              <WTSTATIC col="2"/>
              <WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" />
              <WTSTATIC col="2"/>
              <WTTEXT col="3" value="ATTR(Address.City)" width="200" label="City" size="27" required="false">
                <WTEXIT>TitleCase(this);</WTEXIT>
              </WTTEXT>
              <WTTEXT col="3" value="ATTR(Address.State)" width="340" label="State" size="27" required="false">
                <WTEXIT>TitleCase(this);</WTEXIT>
              </WTTEXT>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" />
              <WTSTATIC col="2" />
              <WTTEXT col="3" value="ATTR(Address.Zip)" width="100" label="Zip" size="8" required="false"/>
              <WTCOMBO col="3" value="ATTR(Address.CountryID)" width="440" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
            </WTROW>
            <WTROW margin-top="12" margin-bottom="6">
              <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
            </WTROW>
            <WTROW margin-bottom="6">
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" merge="2" align="left" label="LogonText"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" tag="NewLogon"/>
              <WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20">
                <WTEXIT>FormatLogon(this);</WTEXIT>
              </WTTEXT>
              <WTSTATIC col="3" label="LogonTip"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" tag="NewPassword"/>
              <WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20" secure="false" />
              <WTSTATIC col="3" label="PasswordText"/>
            </WTROW>
            <WTROW margin-top="18" margin-bottom="12">
              <WTBUTTON col="1" merge="3" action="2" value="CONST(Submit)" align="center" btnclass="bigbutton"/>
            </WTROW>

          </WTCODEGROUP>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)"/>
          <WTROW margin-top="12">
            <WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
          </WTROW>
          <WTROW margin-top="12" margin-bottom="12">
            <WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
              <WTCLICK>window.close()</WTCLICK>
            </WTBUTTON>
          </WTROW>
        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="GCRProductPortal" caption="GCR Products" page-left="5" page-top="5" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false" secure="52">
		<!--==================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Product" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
        <WTCONDITION expr="PARAM(Product)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(501)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="reqProduct" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Product)" value="CONST(0)">
            <WTCONDITION expr="PARAM(Product)" oper="less" value="CONST(0)"/>
          </WTSETATTRIBUTE>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Product&quot; + CStr(reqProduct) + &quot;.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID) + &quot;\Products&quot; )"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="CONST(en)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTSTATIC newline="2" />
					<WTBUTTON value="CONST(CloseWindow)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>
    
    <!--============================================================================================-->
    <WTWEBPAGE name="GCRProductPortal2" caption="GCR Products" header="false" footer="false" navbar="false" wrapper="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" langfile="GCRProductPortal" secure="52" focus="false">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Product" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
        <WTCONDITION expr="PARAM(Product)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(501)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="reqProduct" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Product&quot; + CStr(reqProduct) + &quot;.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID) + &quot;\Products&quot; )"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <!--**********************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTBUTTON value="CONST(CloseWindow)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTCODEGROUP>
			</WTCONTENT>
    </WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="GCRUniversity" caption="GCRUniversity" page-left="5" page-top="5" footer="false" navbar="false" secured="41" wrapper="wrapper800"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="GCRUniversity">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Code" datatype="number"/>
			
			<!-- Code = 1 ... Display Motivation -->
			<!-- Code = 2 ... Display Leadership -->
			<!-- Code = 3 ... Display Relationship -->
			<!-- Code = 4 ... Display Health -->
			<!-- Code = 5 ... Display Finance -->
			<!-- Code = 6 ... Display Constitution -->
			<!-- Code = 7 ... Display College -->
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Code)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Code)" value="CONST(1)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTTAB name="MemberTab">
					<WTITEM label="ViewMotivation" width="110">
						<WTLINK name="JAVA(ShowTab('TabMotivation',1))"/>
					</WTITEM>
					<WTITEM label="ViewLeadership" width="110">
						<WTLINK name="JAVA(ShowTab('TabLeadership',1))"/>
					</WTITEM>
					<WTITEM label="ViewRelationship" width="110">
						<WTLINK name="JAVA(ShowTab('TabRelationship',1))"/>
					</WTITEM>
					<WTITEM label="ViewHealth" width="110">
						<WTLINK name="JAVA(ShowTab('TabHealth',1))"/>
					</WTITEM>
					<WTITEM label="ViewFinance" width="110">
						<WTLINK name="JAVA(ShowTab('TabFinance',1))"/>
					</WTITEM>
					<WTITEM label="ViewConstitution" width="110">
						<WTLINK name="JAVA(ShowTab('TabConstitution',1))"/>
					</WTITEM>
					<WTITEM label="ViewCollege" width="110">
						<WTLINK name="JAVA(ShowTab('TabCollege',1))"/>
					</WTITEM>
				</WTTAB>

				<WTFUNCTION name="ShowTab(tab, shw)">
					document.getElementById('TabMotivation').style.display = 'none';
					document.getElementById('TabLeadership').style.display = 'none';
					document.getElementById('TabRelationship').style.display = 'none';
					document.getElementById('TabHealth').style.display = 'none';
					document.getElementById('TabFinance').style.display = 'none';
					document.getElementById('TabConstitution').style.display = 'none';
					document.getElementById('TabCollege').style.display = 'none';
					document.getElementById(tab).style.display = '';

					if ( tab == 'TabMotivation' ) {
						var src = document.getElementById('MotivationFrame').src
						if (src.indexOf("Motivation.htm") &lt; 0 ) {
							src = 'sections/company/17/Motivation.htm'
							document.getElementById('MotivationFrame').src = src
						}
					}
					if ( tab == 'TabLeadership' ) {
						var src = document.getElementById('LeadershipFrame').src
						if (src.indexOf("Leadership.htm") &lt; 0 ) {
							src = 'sections/company/17/Leadership.htm'
							document.getElementById('LeadershipFrame').src = src
						}
					}
					if ( tab == 'TabRelationship' ) {
						var src = document.getElementById('RelationshipFrame').src
						if (src.indexOf("Relationship.htm") &lt; 0 ) {
							src = 'sections/company/17/Relationship.htm'
							document.getElementById('RelationshipFrame').src = src
						}
					}
					if ( tab == 'TabHealth' ) {
						var src = document.getElementById('HealthFrame').src
						if (src.indexOf("Health.htm") &lt; 0 ) {
							src = 'sections/company/17/Health.htm'
							document.getElementById('HealthFrame').src = src
						}
					}
					if ( tab == 'TabFinance' ) {
						var src = document.getElementById('FinanceFrame').src
						if (src.indexOf("Finance.htm") &lt; 0 ) {
							src = 'sections/company/17/Finance.htm'
							document.getElementById('FinanceFrame').src = src
						}
					}
					if ( tab == 'TabConstitution' ) {
						var src = document.getElementById('ConstitutionFrame').src
						if (src.indexOf("Constitution.htm") &lt; 0 ) {
							src = 'sections/company/17/Constitution.htm'
							document.getElementById('ConstitutionFrame').src = src
						}
					}
					if ( tab == 'TabCollege' ) {
						var src = document.getElementById('CollegeFrame').src
						if (src.indexOf("College.htm") &lt; 0 ) {
							src = 'sections/company/17/College.htm'
							document.getElementById('CollegeFrame').src = src
						}
					}
			    </WTFUNCTION>  
				<WTFUNCTION name="LoadTab()">
					var code = document.getElementById('Code').value 
					switch(code)
					{
					case '1':
						MemberTab.setCurrTab('Motivation'); 
						ShowTab('TabMotivation',0);
						break;    
					case '2':
						MemberTab.setCurrTab('Leadership'); 
						ShowTab('TabLeadership',0);
						break;    
					case '3':
						MemberTab.setCurrTab('Relationship'); 
						ShowTab('TabRelationship',0);
						break;    
					case '4':
						MemberTab.setCurrTab('Health'); 
						ShowTab('TabHealth',0);
						break;    
					case '5':
						MemberTab.setCurrTab('Finance'); 
						ShowTab('TabFinance',0);
						break;    
					case '6':
						MemberTab.setCurrTab('Constitution'); 
						ShowTab('TabConstitution',0);
						break;    
					case '7':
						MemberTab.setCurrTab('College'); 
						ShowTab('TabCollege',0);
						break;    
					}
			    </WTFUNCTION>  
				<WTLOAD>
					LoadTab();
				</WTLOAD>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="PARAM(Code)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTCODEGROUP><WTIMAGE value="CONST(ZowUniversity.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="2"/>
						<WTSTATIC label="GCRUniversity" fontsize="4" space="1"/>
            <WTCODEGROUP>
    					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
  						<WTSTATIC label="for" space="1"/>
	  					<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
		  				<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
			  			<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;))"/>
            </WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" label="CloudUniversityText" class="prompt"/>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTSTATIC col="1" align="left">
						<WTCODEGROUP><WTSTARTTAB name="MemberTab"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW id="TabMotivation">
					<WTFRAME col="1" src="" name="MotivationFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabLeadership">
					<WTFRAME col="1" src="" name="LeadershipFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabRelationship">
					<WTFRAME col="1" src="" name="RelationshipFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabHealth">
					<WTFRAME col="1" src="" name="HealthFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabFinance">
					<WTFRAME col="1" src="" name="FinanceFrame" frmwidth="800" frmheight="2500" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabConstitution">
					<WTFRAME col="1" src="" name="ConstitutionFrame" frmwidth="800" frmheight="2500" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabCollege">
					<WTFRAME col="1" src="" name="CollegeFrame" frmwidth="800" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="GCRFulfill" caption="GCR Order Fulfillment" header="false" footer="false" navbar="false" wrapper="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="GCRFulfill" secured="125">
      <!--============================================================================================-->
      <WTPARAM name="PaymentID" datatype="number"/>
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Process" datatype="number"/>
      <WTPARAM name="Mode" datatype="number"/>
      <WTPARAM name="Address" datatype="text"/>
      <WTPARAM name="Amount" datatype="text"/>
      <WTPARAM name="Note" datatype="text"/>
      <WTPARAM name="Rate" datatype="text"/>
      <WTPARAM name="Coins" datatype="number"/>

      <WTINCLUDE name="GCRWallet.asp"/>

      <WTSUB name="LoadOrder">
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="PARAM(PaymentID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(OwnerID)"/>
          <WTCODEGROUP>
  					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
            <WTCUSTOM>
              reqAmount = CCUR(.Amount)
              If InStr("104,204", .Purpose) &gt; 0 Then reqAmount = CCUR(.Amount) - 69.95
              If InStr("105,205", .Purpose) &gt; 0 Then reqAmount = CCUR(.Amount) - 274.95
              reqAmount = FormatCurrency( reqAmount )
              If .Token &gt; 0 Then reqMode = 2
            </WTCUSTOM>
          </WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayment" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTCALLSUB name="LoadMember"/>

        <WTCODEGROUP>
  				<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
          <WTGETCACHE name="PARAM(Rate)" value="COINRATE">
  					  <WTCONDITION expr="PARAM(Rate)" oper="equal" value="CONST(&quot;&quot;)"/>
				  </WTGETCACHE>
				  <WTSETATTRIBUTE name="PARAM(Rate)" value="CONST(&quot;0.005&quot;)">
  					  <WTCONDITION expr="PARAM(Rate)" oper="equal" value="CONST(&quot;&quot;)"/>
				  </WTSETATTRIBUTE>
				  <WTSETCACHE name="COINRATE" value="PARAM(Rate)"/>
				  <WTSETATTRIBUTE name="PARAM(Coins)" value="CONST( FormatNumber(reqAmount / CCUR(reqRate),0) )"/>
        </WTCODEGROUP>
      </WTSUB>

      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
          <WTCODEGROUP>
  					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
            <WTCUSTOM>
              reqAddress = ""
              tmpBalance = 0
              tmp2FA = 0
              tmpCreated = ""
              tmp2FAStatus = ""
              result = GCRWallet_Info( tmpEmail, reqAddress, tmpBalance, tmp2FA, tmpCreated )
              If result &lt;&gt; "ok" Then reqAddress = result
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="UpdateOrder">
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="PARAM(PaymentID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(OwnerID)"/>
          
          <WTCODEGROUP>
  					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
					  <WTSETATTRIBUTE name="ATTR(Token)" value="CONST(1)"/>
					  <WTSETATTRIBUTE name="ATTR(TokenOwner)" value="PARAM(Coins)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
  					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(86)"/>
					  <WTSETATTRIBUTE name="ATTR(Token)" value="CONST(2)"/>
          </WTCODEGROUP>
          
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(.Notes + &quot; &quot; + reqNote)">
  					<WTCONDITION expr="PARAM(Note)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)"/>
		      <WTMETHOD name="Save">
			      <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
		      </WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayment" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTCALLSUB name="LoadMember"/>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadOrder"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="UpdateOrder"/>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="100" align="right"/>
        <WTCOLUMN width="300" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(Address)"/>
					<WTHIDDEN value="PARAM(Coins)"/>
        </WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="OrderFulfillment" class="PageHeading" align="left"/>
				</WTROW>
				
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
        
				<WTROW margin-bottom="12">
 					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="OrderFulfilled" class="PageHeading" fontcolor="red" align="center"/>
				</WTROW>
				<WTROW margin-bottom="12">
 					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" label="AlreadyFulfilled" class="PageHeading" fontcolor="red" align="center"/>
				</WTROW>

        <WTROW>
					<WTSTATIC col="1" tag="Member"/>
					<WTSTATIC col="2">
					  <WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
					  <WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
					  <WTSTATIC value="CONST(-)" space="1"/>
					  <WTSTATIC value="ATTR(Member.MemberID)"/>
            <WTSTATIC space="1"/>
            <WTCODEGROUP>
              <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                <WTLINK name="0403" target="Member">
                  <WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
                  <WTPARAM name="ContentPage" value="CONST(3)"/>
                  <WTPARAM name="Popup" value="CONST(1)"/>
                </WTLINK>
              </WTIMAGE>
            </WTCODEGROUP>
            <WTSTATIC space="1"/>
            <WTCODEGROUP>
              <WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
                <WTLINK name="0475" return="false" target="Finances">
                  <WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
                  <WTPARAM name="Code" value="CONST(2)"/>
                  <WTPARAM name="ContentPage" value="CONST(3)"/>
                  <WTPARAM name="Popup" value="CONST(1)"/>
                </WTLINK>
              </WTIMAGE>
            </WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PaymentID"/>
					<WTSTATIC col="2" value="ATTR(Payment.PaymentID)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PaidDate"/>
					<WTSTATIC col="2" value="ATTR(Payment.PaidDate)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Amount"/>
					<WTSTATIC col="2" value="ATTR(Payment.Amount)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Purpose"/>
					<WTSTATIC col="2" value="ATTR(Payment.Purpose)"/>
				</WTROW>

        <WTCODEGROUP>
  				<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(84)"/>
 				  <WTROW margin-top="6">
					  <WTSTATIC col="1" tag="CoinAmount"/>
					  <WTSTATIC col="2" value="PARAM(Amount)" bold="true"/>
				  </WTROW>
 				  <WTROW margin-top="6">
					  <WTSTATIC col="1" tag="Rate"/>
					  <WTTEXT col="2" value="PARAM(Rate)" size="5"/>
  				  <WTSTATIC col="2" bold="true">
  					  <WTSTATIC value="PARAM(Coins)" space="1"/>
  					  <WTSTATIC label="Coins"/>
  				  </WTSTATIC>
            <WTBUTTON col="2" action="0" value="CONST(Calc)" class="smbutton">
   					  <WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
            </WTBUTTON>
				  </WTROW>
          <WTROW margin-top="6">
					  <WTSTATIC col="1" tag="Address"/>
					  <WTSTATIC col="2" value="PARAM(Address)" bold="true"/>
				  </WTROW>
        </WTCODEGROUP>
        

        <WTCODEGROUP>
 					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
   				<WTROW margin-top="6">
					  <WTSTATIC col="1" merge="2" tag="Note" align="left"/>
				  </WTROW>
          <WTROW>
					  <WTMEMO col="1" merge="2" align="left" value="PARAM(Note)" cols="45" rows="2"/>
				  </WTROW>
        </WTCODEGROUP>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="1" value="CONST(Fulfill)" align="center">
   					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
          </WTBUTTON>
          <WTBUTTON col="1" value="Close">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>
        
      </WTCONTENT>
    </WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="GCRCertify" caption="Certification Program" page-left="5" page-top="5" navbar="false" header="false" footer="false" page-image="bg.jpg"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false">
		<!--==================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Product" datatype="number"/>

      <WTCODEGROUP>
        <WTCONDITION expr="NotOrgAdmin"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(12046)" connector="and"/>
        <WTCUSTOM>Response.end</WTCUSTOM>
      </WTCODEGROUP>
      
      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="GCR" project="ptsGCRUser" class="CGCR">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(501)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="PARAM(Product)"/>
            <WTPARAM name="reqProduct" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Product)" value="CONST(0)">
            <WTCONDITION expr="PARAM(Product)" oper="less" value="CONST(0)"/>
          </WTSETATTRIBUTE>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Program&quot; + CStr(reqProduct) + &quot;.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(tmpCompanyID) + &quot;\Products&quot; )"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="CONST(en)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>
    
</WTWEBPAGES>
</WTROOT>