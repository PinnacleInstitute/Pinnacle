<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="90" name="Note" alias="nt" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="9001" name="NoteID" type="number" identity="true" min="1" required="true" source="entity" title="true"/>
	
		<!--Foreign Keys-->
		<WTATTRIBUTE id="9002" name="OwnerType" type="number" source="entity"/>
		<WTATTRIBUTE id="9003" name="OwnerID" type="number" source="entity"/>
		<WTATTRIBUTE id="9004" name="AuthUserID" type="number" source="entity"/>
		
		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="9005" name="NameLast" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="AuthUser" name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9006" name="NameFirst" type="text" length="30" min="1" max="30" source="join">
			<WTJOIN entity="AuthUser" name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9007" name="UserName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameFirst"/>
			<WTCOMPUTE text=" "/>
			<WTCOMPUTE name="NameLast"/>
		</WTATTRIBUTE>
		
		<!--Attributes-->
		<WTATTRIBUTE id="9010" name="NoteDate" type="date" source="entity">
			<WTFORMAT value="m-d-yy h:mmam/pm"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9011" name="Notes" type="text" length="1000" min="1" max="1000" source="entity" language="false"/>
		<WTATTRIBUTE id="9012" name="IsLocked" type="yesno" source="entity"/>
		<WTATTRIBUTE id="9013" name="IsFrozen" type="yesno" source="entity"/>
		<WTATTRIBUTE id="9014" name="IsReminder" type="yesno" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="9090" name="FromDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="9091" name="ToDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="9092" name="Owner" type="text" length="60" source="entity" persist="false"/>	
		<WTATTRIBUTE id="9093" name="Num" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="9094" name="Data1" type="text" length="80" source="entity" persist="false"/>
		<WTATTRIBUTE id="9095" name="Data2" type="text" length="80" source="entity" persist="false"/>
		<WTATTRIBUTE id="9096" name="Data3" type="text" length="80" source="entity" persist="false"/>

		<!--Indexes-->
		<WTINDEX name="Owner">
			<WTATTRIBUTE name="OwnerType"/>
			<WTATTRIBUTE name="OwnerID"/>
		</WTINDEX>
		<WTINDEX name="AuthUserID">
			<WTATTRIBUTE name="AuthUserID"/>
			<WTATTRIBUTE name="NoteDate"/>
		</WTINDEX>
		<WTINDEX name="NoteDate">
			<WTATTRIBUTE name="NoteDate"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Note" entity="Note" alias="nt"/>
			<WTRELATIONSHIP name="Common" entity="Note" alias="nt">
				<WTENTITY name="AuthUser" entity="AuthUser" alias="au">
					<WTATTRIBUTE alias="nt" name="AuthUserID" relalias="au" relname="AuthUserID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="NoteDate" default="true"/>
			<WTATTRIBUTE name="Notes" contains="true"/>
		</WTENUM>
	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE name="Count" type="Count" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Find" name="FindOwner" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(OwnerType)" direction="input" required="false"/>
			<WTPARAM name="ATTR(OwnerID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(FromDate)" direction="input" required="false"/>
			<WTPARAM name="ATTR(ToDate)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Note.OwnerType)" oper="equal" value="PARAM(OwnerType)" connector="and"/>
			<WTCONDITION expr="ATTR(Note.OwnerID)" oper="equal" value="PARAM(OwnerID)" connector="and"/>
			<WTCONDITION expr="ATTR(Note.NoteDate)" oper="greater-equal" value="PARAM(FromDate)" connector="and"/>
			<WTCONDITION expr="ATTR(Note.NoteDate)" oper="less-equal" value="PARAM(ToDate)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="DeleteOwner" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(OwnerType)" direction="input"/>
			<WTPARAM name="ATTR(OwnerID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTDELETE>
					<WTJOIN name="Note" lock="true"/>
					<WTCONDITION expr="ATTR(Note.OwnerType)" oper="equal" value="PARAM(OwnerType)"/>
					<WTCONDITION expr="ATTR(Note.OwnerID)" oper="equal" value="PARAM(OwnerID)" connector="and"/>
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListNotes" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(OwnerType)" direction="input"/>
			<WTPARAM name="ATTR(OwnerID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="ATTR(Note.OwnerType)" oper="equal" value="PARAM(OwnerType)"/>
					<WTCONDITION expr="ATTR(Note.OwnerID)" oper="equal" value="PARAM(OwnerID)" connector="and"/>
					<WTORDER name="ATTR(Note.IsFrozen)" descend="true"/>
					<WTORDER name="ATTR(Note.NoteDate)" descend="true"/>
					<WTORDER name="ATTR(Note.NoteID)" descend="true"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListActivity" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(OwnerType)" direction="input"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerType)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerID)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="PARAM(AuthUserID)" oper="equal" value="CONST(0)" paren="start"/>
					<WTCONDITION expr="ATTR(Note.AuthUserID)" oper="equal" value="PARAM(AuthUserID)" connector="or" paren="end"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="greater-equal" value="PARAM(FromDate)" connector="and"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="less-equal" value="PARAM(ToDate)" connector="and"/>
					<WTCONDITION expr="PARAM(OwnerType)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
					<WTCONDITION expr="ATTR(Note.OwnerType)" oper="equal" value="PARAM(OwnerType)" connector="or" paren="end"/>
					<WTCONDITION expr="ATTR(Note.IsReminder)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Note.NoteDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListReminder" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(OwnerType)" direction="input"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerType)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerID)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="PARAM(AuthUserID)" oper="equal" value="CONST(0)" paren="start"/>
					<WTCONDITION expr="ATTR(Note.AuthUserID)" oper="equal" value="PARAM(AuthUserID)" connector="or" paren="end"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="greater-equal" value="PARAM(FromDate)" connector="and"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="less-equal" value="PARAM(ToDate)" connector="and"/>
					<WTCONDITION expr="PARAM(OwnerType)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
					<WTCONDITION expr="ATTR(Note.OwnerType)" oper="equal" value="PARAM(OwnerType)" connector="or" paren="end"/>
					<WTCONDITION expr="ATTR(Note.IsReminder)" oper="equal" value="CONST(1)" connector="and"/>
					<WTORDER name="ATTR(Note.NoteDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListActivityOwner" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(OwnerType)" direction="input"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerType)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerID)"/>
					<WTATTRIBUTE value="ATTR(Note.Owner)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListReminderOwner" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(OwnerType)" direction="input"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerType)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerID)"/>
					<WTATTRIBUTE value="ATTR(Note.Owner)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="Summary" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(OwnerType)" direction="input"/> <!-- AuthUser UserType -->
			<WTPARAM name="ATTR(IsReminder)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/> <!-- AuthUserID -->
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.Num)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListNotesStarts" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(Notes)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerType)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerID)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="greater-equal" value="PARAM(FromDate)"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="less-equal" value="PARAM(ToDate)" connector="and"/>
					<WTCONDITION expr="ATTR(Note.Notes)" oper="starts" value="PARAM(Notes)" connector="and"/>
					<WTORDER name="ATTR(Note.NoteDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListNotesContains" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
		<!--==================================================================================================================-->
			<WTPARAM name="ATTR(Notes)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerType)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerID)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="greater-equal" value="PARAM(FromDate)"/>
					<WTCONDITION expr="ATTR(Note.NoteDate)" oper="less-equal" value="PARAM(ToDate)" connector="and"/>
					<WTCONDITION expr="ATTR(Note.Notes)" oper="contains" value="PARAM(Notes)" connector="and"/>
					<WTORDER name="ATTR(Note.NoteDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--================================================================================================-->					
		<WTPROCEDURE name="ListCustom" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Num)" direction="input"/>
			<WTPARAM name="ATTR(FromDate)" direction="input"/>
			<WTPARAM name="ATTR(ToDate)" direction="input"/>
			<WTPARAM name="ATTR(Data1)" direction="input"/>
			<WTPARAM name="ATTR(Data2)" direction="input"/>
			<WTPARAM name="ATTR(Data3)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Note.NoteID)"/>
					<WTATTRIBUTE value="ATTR(Note.NoteDate)"/>
					<WTATTRIBUTE value="ATTR(Note.Notes)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerType)"/>
					<WTATTRIBUTE value="ATTR(Note.OwnerID)"/>
					<WTATTRIBUTE value="ATTR(Note.AuthUserID)"/>
					<WTATTRIBUTE value="ATTR(AuthUser.UserName)" alias="UserName"/>
					<WTATTRIBUTE value="ATTR(Note.IsLocked)"/>
					<WTATTRIBUTE value="ATTR(Note.IsFrozen)"/>
					<WTATTRIBUTE value="ATTR(Note.IsReminder)"/>
					<WTATTRIBUTE value="ATTR(Note.Data1)"/>
					<WTATTRIBUTE value="ATTR(Note.Data2)"/>
					<WTATTRIBUTE value="ATTR(Note.Data3)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>	
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--==================================================================-->
		<WTWEBPAGE name="9002" page-width="600" page-left="0" margin-width="0" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--==================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>

			<WTINCLUDE name="Comm.asp"/>

			<WTSUB name="SendIssueMsg">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(OwnerID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(SubmitID)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubmitType)" value="ATTR(SubmitType)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubmitID)" value="ATTR(SubmitID)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(Left(.IssueName,1))" oper="equal" value="CONST(&quot;*&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(IssueName)" value="CONST(Replace(.IssueName,&quot;*&quot;,&quot;&quot;))"/>
            <WTMETHOD name="Save">
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="CONST(tmpIssueName)" value="ATTR(IssueName)"/>
        </WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpSubmitType)" oper="equal" value="ENTITY(Member)"/>
					<WTCONDITION expr="CONST(tmpSubmitID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Load">
							<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)"/>
					</WTOBJECT>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpMemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(InStr(tmpTo,&quot;@&quot;))" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;SUPPORT TICKET #&quot; + CStr(reqOwnerID) + &quot; &quot; + tmpIssueName)"/>
							<WTSETATTRIBUTE name="CONST(tmpNotes)" value="FORM(Notes)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://&quot; + reqSysServerName + reqSysServerPath + &quot;9002i.asp?i=&quot; + CStr(reqOwnerID))"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + &quot;You have a message. Click Here to Reply (You must be already logged in)&quot; + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpNotes + &quot;&lt;br&gt;&lt;br&gt;&quot; + LINK)"/>
							<WTCUSTOM>
								SendEmail tmpCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
							</WTCUSTOM>
						</WTCODEGROUP>
					</WTOBJECT>
				</WTCODEGROUP>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="PARAM(OwnerType)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(OwnerID)"/>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="SYS(UserID)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpIsMsg)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;&quot;)"/>
				<!-- Get Member IsMsg option for Mentoring Notes -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(OwnerType)" oper="equal" value="CONST(-4)"/>
					<WTMETHOD name="GetIsMsg">
						<WTPARAM name="MemberID" direction="input" value="PARAM(OwnerID)"/>
						<WTPARAM name="tmpIsMsg" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Mentoring Note&quot;)"/>
				</WTOBJECT>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<!-- If we are on the same day, set the time to now -->
					<WTSETATTRIBUTE name="CONST(tmpDate)" value="CONST(CDATE(MONTH(.NoteDate)&amp;&quot;/&quot;&amp;DAY(.NoteDate)&amp;&quot;/&quot;&amp;YEAR(.NoteDate)))"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)">
						<WTCONDITION expr="CONST(CDATE(tmpDate))" oper="equal" value="CONST(CDATE(reqSysDate))"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="PARAM(OwnerType)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(OwnerID)"/>
          <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(ValidXML(.Notes))"/>
          <WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpIsMsg)" oper="not-equal" value="CONST(0)" connector="and"/>
<WTCUSTOM>SendMsg reqSysUserID, reqOwnerID, tmpSubject, .Notes</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="SYS(UserID)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="ATTR(OwnerType)" oper="equal" value="ENTITY(Issue)" connector="and"/>
					<WTCALLSUB name="SendIssueMsg"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>
				<WTCOLUMN width="200" align="right"/>
<!--
				<WTLOAD>
					content = window.parent.document.getElementById("NotesFrame");
					if(content) content.height=130;
				</WTLOAD>
-->
				<WTCODEGROUP>
					<WTCONDITION expr="NotManager"/>
					<WTROW>
						<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
						<WTSTATIC col="1" tag="NoteDate"/>
						<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
						<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
						<WTBUTTON col="2" action="2" value="CONST(Add)" align="right" btnclass="smbutton" prespace="false">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Note.AuthUserID)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsManager"/>
					<WTROW>
						<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
						<WTSTATIC col="1" tag="NoteDate"/>
						<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
						<WTSTATIC col="1" tag="AuthUserID"/>
						<WTTEXT col="1" value="ATTR(Note.AuthUserID)" size="4" prespace="false"/>
						<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
						<WTBUTTON col="2" action="2" value="CONST(Add)" align="right" btnclass="smbutton" prespace="false">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Note.Notes)" cols="72" rows="6" focus="true"/>
				</WTROW>
				<WTROW>
					<WTIMAGE col="1" merge="2" align="left" value="CONST(IsReminder.gif)" imgalign="absmiddle"/>
					<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsReminder)" prespace="false"/>
					<WTIMAGE col="1" merge="2" align="left" value="CONST(IsFrozen.gif)" imgalign="absmiddle">
						<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
					</WTIMAGE>
					<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsFrozen)" prespace="false">
						<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
					</WTCHECK>
					<WTIMAGE col="1" merge="2" align="left" value="CONST(IsLocked.gif)" imgalign="absmiddle">
						<WTCONDITION expr="IsManager"/>
					</WTIMAGE>
					<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsLocked)" prespace="false">
						<WTCONDITION expr="IsManager"/>
					</WTCHECK>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9002i" page-width="600" header="false" navbar="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" secured="52">
			<!--==================================================================-->
			<WTPARAM name="I" datatype="number"/>	<!-- IssueID -->
			<WTPARAM name="AuthUserID" datatype="number"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="Path" datatype="text"/>

			<WTINCLUDE name="Comm.asp"/>

			<WTSUB name="SendIssueMsg">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCUSTOM>reqPath = "company/" + .CompanyID</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(Path)" value="CONST(&quot;company/&quot; + .CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(SubmitID)"/>
					<WTSETATTRIBUTE name="CONST(tmpToName)" value="ATTR(AssignedTo)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubmittedBy)" value="ATTR(SubmittedBy)"/>
				</WTOBJECT>
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTCONDITION expr="CONST(tmpMemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
        <WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpToName)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Load">
							<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompany)"/>
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)"/>
					</WTOBJECT>
					<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
						<WTMETHOD name="GetEmail">
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(tmpTo,&quot;@&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;SUPPORT TICKET #&quot; + CStr(reqI) + &quot; &quot; + tmpSubmittedBy)"/>
						<WTSETATTRIBUTE name="CONST(tmpNotes)" value="FORM(Notes)"/>
						<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(tmpNotes)"/>
						<WTCUSTOM>
							SendEmail tmpCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="LoadIssueMsg">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(SubmitID)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTCONDITION expr="CONST(tmpMemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="PARAM(Path)" value="CONST(&quot;company/&quot; + .CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(SubmitID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(AuthUserID)" value="ATTR(AuthUserID)"/>
				</WTOBJECT>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListNotes">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Issue)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(I)"/>
					</WTMETHOD>
					<WTCUSTOM>
						If reqNewDate &lt;&gt; "" Then
						For Each oNote in oNotes
						With oNote
						If CDate(.NoteDate) > CDate(reqNewDate) Then .Num = 1
						End With
						Next
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadIssueMsg"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpIsMsg)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Issue)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(I)"/>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="PARAM(AuthUserID)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
          <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(ValidXML(.Notes))"/>
          <WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)">
						<WTCONDITION expr="NoErrors"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
        <WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
          <WTCONDITION expr="NoErrors"/>
          <WTMETHOD name="Load">
            <WTPARAM name="IssueID" direction="input" value="PARAM(I)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(IssueName)" value="CONST(&quot;*&quot; + .IssueName)"/>
          <WTMETHOD name="Save">
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCALLSUB name="SendIssueMsg"/>
				</WTCODEGROUP>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>
				<WTCOLUMN width="200" align="right"/>

				<WTROW>
					<WTHIDDEN value="PARAM(AuthUserID)"/>
				</WTROW>

				<WTROW margin-top="12">
					<WTIMAGE col="1" merge="2" value="CONST(logo.png)" path="PARAM(Path)" align="center"/>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
						<WTSTATIC label="SupportTicket"/>
						<WTSTATIC value="PARAM(I)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" value="ATTR(Issue.IssueName)" bold="true"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" value="ATTR(Issue.Description)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="IssueMsgSent" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>

					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="PleaseReply" class="PageHeading"/>
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Note.Notes)" cols="72" rows="6" focus="true"/>
					</WTROW>

					<WTROW margin-top="12">
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Submit)" align="center"/>
						<WTBUTTON col="1" merge="2" value="CONST(Close)">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>

					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="PreviousMsgs" bold="true"/>
					</WTROW>
					<WTROW margin-top="3">
						<WTRECORDSET col="1" merge="2" graybar="true" noitems="false" entity="Note">
							<WTCOLUMN width="100" align="left" valign="top"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsNewNote.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Note.Num)" oper="equal" value="CONST(1)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsReminder.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsFrozen.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsLocked.gif)" imgalign="absmiddle">
											<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
									<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
									<WTSTATIC value="DATA(Note.Notes)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="IsManager"/>
										<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start"/>
										<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>

				</WTCODEGROUP>


			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_9002" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp" secured="98">
			<!--==================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>

			<WTINCLUDE name="Comm.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="PARAM(OwnerType)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(OwnerID)"/>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="SYS(UserID)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpIsMsg)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;&quot;)"/>
				<!-- Get Member IsMsg option for Mentoring Notes -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(OwnerType)" oper="equal" value="CONST(-4)"/>
					<WTMETHOD name="GetIsMsg">
						<WTPARAM name="MemberID" direction="input" value="PARAM(OwnerID)"/>
						<WTPARAM name="tmpIsMsg" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Mentoring Note&quot;)"/>
				</WTOBJECT>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<!-- If we are on the same day, set the time to now -->
					<WTSETATTRIBUTE name="CONST(tmpDate)" value="CONST(CDATE(MONTH(.NoteDate)&amp;&quot;/&quot;&amp;DAY(.NoteDate)&amp;&quot;/&quot;&amp;YEAR(.NoteDate)))"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)">
						<WTCONDITION expr="CONST(CDATE(tmpDate))" oper="equal" value="CONST(CDATE(reqSysDate))"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="PARAM(OwnerType)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(OwnerID)"/>
          <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(ValidXML(.Notes))"/>
          <WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpIsMsg)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>SendMsg reqSysUserID, reqOwnerID, tmpSubject, .Notes</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="SYS(UserID)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="67" align="left"/>
				<WTCOLUMN width="33" align="right"/>
				<!--
				<WTLOAD>
					content = window.parent.document.getElementById("NotesFrame");
					if(content) content.height=130;
				</WTLOAD>
-->
				<WTCODEGROUP>
					<WTCONDITION expr="NotManager"/>
					<WTROW>
						<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
						<WTSTATIC col="1" tag="NoteDate"/>
						<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
						<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
						<WTBUTTON col="2" action="2" value="CONST(Add)" align="right" btnclass="smbutton" prespace="false">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Note.AuthUserID)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsManager"/>
					<WTROW>
						<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
						<WTSTATIC col="1" tag="NoteDate"/>
						<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
						<WTSTATIC col="1" tag="AuthUserID"/>
						<WTTEXT col="1" value="ATTR(Note.AuthUserID)" size="4" prespace="false"/>
						<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
						<WTBUTTON col="2" action="2" value="CONST(Add)" align="right" btnclass="smbutton" prespace="false">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Note.Notes)" cols="34" rows="6" focus="true"/>
				</WTROW>
				<WTROW>
					<WTIMAGE col="1" merge="2" align="left" value="CONST(IsReminder.gif)" imgalign="absmiddle"/>
					<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsReminder)" prespace="false"/>
					<WTIMAGE col="1" merge="2" align="left" value="CONST(IsFrozen.gif)" imgalign="absmiddle">
						<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
					</WTIMAGE>
					<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsFrozen)" prespace="false">
						<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
					</WTCHECK>
					<WTIMAGE col="1" merge="2" align="left" value="CONST(IsLocked.gif)" imgalign="absmiddle">
						<WTCONDITION expr="IsManager"/>
					</WTIMAGE>
					<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsLocked)" prespace="false">
						<WTCONDITION expr="IsManager"/>
					</WTCHECK>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9003" page-width="600" page-left="0" margin-width="0" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--==================================================================-->
			<WTPARAM name="NoteID" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(AuthUserID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(Popup)" value="CONST(3)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
          <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(ValidXML(.Notes))"/>
          <WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(Popup)" value="CONST(2)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTCONDITION expr="IsEmployee"/>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Delete">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(Popup)" value="CONST(3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="375" align="left"/>
				<WTCOLUMN width="225" align="right"/>
<!--
				<WTLOAD>
					content = window.parent.document.getElementById("NotesFrame");
					if(content) content.height=130;
				</WTLOAD>
-->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(2)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="SuccessfullyUpdated" align="center" class="PageHeading" fontcolor="red"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(3)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="SuccessfullyDeleted" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Popup)" oper="less" value="CONST(3)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NotManager"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" tag="NoteDate"/>
							<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
							<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
							<WTBUTTON col="2" action="1" value="CONST(Update)" align="right" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
							<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
							</WTBUTTON>
							<WTBUTTON col="2" value="CONST(Close)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="2" action="4" value="CONST(Delete)" msg="ConfirmDelete" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
						</WTROW>
						<WTROW>
							<WTHIDDEN value="ATTR(Note.AuthUserID)"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="IsManager"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" tag="NoteDate"/>
							<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
							<WTSTATIC col="1" tag="AuthUserID"/>
							<WTTEXT col="1" value="ATTR(Note.AuthUserID)" size="4" prespace="false"/>
							<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
							<WTBUTTON col="2" action="1" value="CONST(Update)" align="right" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
							<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
							</WTBUTTON>
							<WTBUTTON col="2" value="CONST(Close)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="2" action="4" value="CONST(Delete)" btnclass="smbutton" msg="ConfirmDelete" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Note.Notes)" cols="72" rows="6"/>
					</WTROW>

					<WTROW>
						<WTIMAGE col="1" merge="2" align="left" value="CONST(IsReminder.gif)" imgalign="absmiddle"/>
						<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsReminder)" prespace="false"/>
						<WTIMAGE col="1" merge="2" align="left" value="CONST(IsFrozen.gif)" imgalign="absmiddle">
							<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
						</WTIMAGE>
						<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsFrozen)" prespace="false">
							<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
						</WTCHECK>
						<WTIMAGE col="1" merge="2" align="left" value="CONST(IsLocked.gif)" imgalign="absmiddle">
							<WTCONDITION expr="IsManager"/>
						</WTIMAGE>
						<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsLocked)" prespace="false">
							<WTCONDITION expr="IsManager"/>
						</WTCHECK>
					</WTROW>
				</WTCODEGROUP>
			
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_9003" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp" secured="98">
			<!--==================================================================-->
			<WTPARAM name="NoteID" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(AuthUserID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(Popup)" value="CONST(3)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
          <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(ValidXML(.Notes))"/>
          <WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(Popup)" value="CONST(2)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTCONDITION expr="IsEmployee"/>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTMETHOD name="Delete">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(Popup)" value="CONST(3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="PARAM(NoteID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNote" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="67" align="left"/>
				<WTCOLUMN width="33" align="right"/>
				<!--
				<WTLOAD>
					content = window.parent.document.getElementById("NotesFrame");
					if(content) content.height=130;
				</WTLOAD>
-->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(2)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="SuccessfullyUpdated" align="center" class="PageHeading" fontcolor="red"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(3)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="SuccessfullyDeleted" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Popup)" oper="less" value="CONST(3)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NotManager"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" tag="NoteDate"/>
							<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
							<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
							<WTBUTTON col="2" action="1" value="CONST(Update)" align="right" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
							<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
							</WTBUTTON>
							<WTBUTTON col="2" value="CONST(Close)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="2" action="4" value="CONST(Delete)" msg="ConfirmDelete" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
						</WTROW>
						<WTROW>
							<WTHIDDEN value="ATTR(Note.AuthUserID)"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="IsManager"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" tag="NoteDate"/>
							<WTTEXT col="1" value="ATTR(Note.NoteDate)" size="15" prespace="false"/>
							<WTSTATIC col="1" tag="AuthUserID"/>
							<WTTEXT col="1" value="ATTR(Note.AuthUserID)" size="4" prespace="false"/>
							<WTSTATIC col="1" label="NoteMax" fontcolor="purple"/>
							<WTBUTTON col="2" action="1" value="CONST(Update)" align="right" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
							<WTBUTTON col="2" action="3" value="CONST(Cancel)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
							</WTBUTTON>
							<WTBUTTON col="2" value="CONST(Close)" btnclass="smbutton" prespace="false">
								<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="2" action="4" value="CONST(Delete)" btnclass="smbutton" msg="ConfirmDelete" prespace="false">
								<WTCONDITION expr="IsActive"/>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Note.Notes)" cols="34" rows="6"/>
					</WTROW>

					<WTROW>
						<WTIMAGE col="1" merge="2" align="left" value="CONST(IsReminder.gif)" imgalign="absmiddle"/>
						<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsReminder)" prespace="false"/>
						<WTIMAGE col="1" merge="2" align="left" value="CONST(IsFrozen.gif)" imgalign="absmiddle">
							<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
						</WTIMAGE>
						<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsFrozen)" prespace="false">
							<WTCONDITION expr="ATTR(Note.OwnerID)" oper="not-equal" value="CONST(0)"/>
						</WTCHECK>
						<WTIMAGE col="1" merge="2" align="left" value="CONST(IsLocked.gif)" imgalign="absmiddle">
							<WTCONDITION expr="IsManager"/>
						</WTIMAGE>
						<WTCHECK col="1" merge="2" align="left" value="ATTR(Note.IsLocked)" prespace="false">
							<WTCONDITION expr="IsManager"/>
						</WTCHECK>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9005" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
			<!--==================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>
				<WTROW>
					<WTSTATIC col="1" value="PARAM(Title)" class="PageHeading" space="1"/>
					<WTBUTTON col="1" value="CONST(Close)" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTFRAME col="1" src="CONST(9011.asp?OwnerType=&lt;xsl:value-of select=&quot;/DATA/PARAM/@ownertype&quot;/&gt;&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@ownerid&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;)" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="600" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_9005" caption="My Notes" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--==================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>
				<WTROW>
					<WTSTATIC col="1" value="PARAM(Title)" class="PageHeading" space="1"/>
					<WTBUTTON col="1" value="CONST(Close)" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTFRAME col="1" src="CONST(m_9011.asp?OwnerType=&lt;xsl:value-of select=&quot;/DATA/PARAM/@ownertype&quot;/&gt;&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@ownerid&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;)" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="100" frmheight="600" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9010" caption="Print Notes" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListNotes">
						<WTPARAM name="OwnerType" direction="input" value="PARAM(OwnerType)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(OwnerID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>

				<WTROW>
					<WTSTATIC col="1" value="PARAM(Title)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" noitems="false" entity="Note">
						<WTCOLUMN width="100" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsReminder.gif)">
										<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsFrozen.gif)">
										<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsLocked.gif)">
										<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
								<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
								<WTSTATIC value="DATA(Note.Notes)" space="1"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9011" page-width="580" page-left="0" margin-width="0" caption="List" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>
			<WTPARAM name="Height" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="NewDate" datatype="date"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListNotes">
						<WTPARAM name="OwnerType" direction="input" value="PARAM(OwnerType)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(OwnerID)"/>
					</WTMETHOD>
<WTCUSTOM>
				If reqNewDate &lt;&gt; "" Then
					For Each oNote in oNotes
						With oNote
							If CDate(.NoteDate) > CDate(reqNewDate) Then .Num = 1
						End With
					Next
				End If	
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="280" align="left"/>

				<WTFUNCTION name="PrintNotes()">
					var typ = document.getElementById('OwnerType').value
					var id = document.getElementById('OwnerID').value
					var title = document.getElementById('Title').value
					var url = "9010.asp?OwnerType=" + typ + "&amp;OwnerID=" + id + "&amp;Title=" + title;
					var win = window.open(url,"PrintNotes","top=75,left=75,height=600,width=675,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="PARAM(OwnerType)"/>
					<WTHIDDEN value="PARAM(OwnerID)"/>
					<WTHIDDEN value="PARAM(Title)"/>
				</WTROW>

				<WTSTATIC label="edit"/>
<!--				
				<WTLOAD>
					content = window.parent.document.getElementById("NotesFrame");
					if(content) content.height=content.frmheight;
				</WTLOAD>
-->
				<WTROW>
					<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
					<WTSTATIC col="1" label="Notes" bold="true"/>
					<WTSTATIC col="2" align="right">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle">
								<WTLINK name="9002">
									<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
									<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NewNote">
							<WTLINK name="9002">
								<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
								<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
							</WTLINK>
						</WTSTATIC>
						<WTSTATIC value="CONST( | )"/>
						<WTCODEGROUP>
							<WTIMAGE value="CONST(printer.gif)" imgalign="absmiddle">
								<WTLINK name="PrintNotes();" click="true"/>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="Print">
							<WTLINK name="PrintNotes();" click="true"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" noitems="false" entity="Note">
						<WTCOLUMN width="100" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsNewNote.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.Num)" oper="equal" value="CONST(1)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsReminder.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsFrozen.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsLocked.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
								<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
								<WTSTATIC value="DATA(Note.Notes)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="IsManager"/>
									<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start"/>
									<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="9003" class="NavBar">
											<WTPARAM name="NoteID" value="DATA(NoteID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_9011" caption="Notes List" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>
			<WTPARAM name="Height" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="NewDate" datatype="date"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListNotes">
						<WTPARAM name="OwnerType" direction="input" value="PARAM(OwnerType)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(OwnerID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						If reqNewDate &lt;&gt; "" Then
						For Each oNote in oNotes
						With oNote
						If CDate(.NoteDate) > CDate(reqNewDate) Then .Num = 1
						End With
						Next
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="40" align="left"/>
				<WTCOLUMN width="60" align="left"/>

				<WTFUNCTION name="PrintNotes()">
					var typ = document.getElementById('OwnerType').value
					var id = document.getElementById('OwnerID').value
					var title = document.getElementById('Title').value
					var url = "9010.asp?OwnerType=" + typ + "&amp;OwnerID=" + id + "&amp;Title=" + title;
					var win = window.open(url,"PrintNotes","top=75,left=75,height=600,width=675,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="PARAM(OwnerType)"/>
					<WTHIDDEN value="PARAM(OwnerID)"/>
					<WTHIDDEN value="PARAM(Title)"/>
				</WTROW>

				<WTSTATIC label="edit"/>
				<!--				
				<WTLOAD>
					content = window.parent.document.getElementById("NotesFrame");
					if(content) content.height=content.frmheight;
				</WTLOAD>
-->
				<WTROW>
					<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
					<WTSTATIC col="1" label="Notes" bold="true"/>
					<WTSTATIC col="2" align="right">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle">
								<WTLINK name="9002">
									<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
									<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NewNote">
							<WTLINK name="m_9002">
								<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
								<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
							</WTLINK>
						</WTSTATIC>
						<WTSTATIC value="CONST( | )"/>
						<WTCODEGROUP>
							<WTIMAGE value="CONST(printer.gif)" imgalign="absmiddle">
								<WTLINK name="PrintNotes();" click="true"/>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="Print">
							<WTLINK name="PrintNotes();" click="true"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" noitems="false" entity="Note">
						<WTCOLUMN width="100" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsNewNote.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.Num)" oper="equal" value="CONST(1)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsReminder.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsFrozen.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsLocked.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
								<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
								<WTSTATIC value="DATA(Note.Notes)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="IsManager"/>
									<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start"/>
									<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="m_9003" class="NavBar">
											<WTPARAM name="NoteID" value="DATA(NoteID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9012" header="false" footer="false" navbar="false" wrapper="wrapper800"
			page-left="0" margin-width="0" navbar-width="0" focus="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>
			<WTPARAM name="Height" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="NewDate" datatype="date"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListNotes">
						<WTPARAM name="OwnerType" direction="input" value="PARAM(OwnerType)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(OwnerID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						If reqNewDate &lt;&gt; "" Then
						For Each oNote in oNotes
						With oNote
						If CDate(.NoteDate) > CDate(reqNewDate) Then .Num = 1
						End With
						Next
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="500" align="left"/>

				<WTSTATIC label="edit"/>
				<WTROW>
					<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
					<WTSTATIC col="1" label="Notes" bold="true"/>
					<WTSTATIC col="2" align="right">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle">
								<WTLINK name="9002">
									<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
									<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NewNote">
							<WTLINK name="9002">
								<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
								<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
							</WTLINK>
						</WTSTATIC>
						<WTSTATIC value="CONST( | )"/>
						<WTSTATIC label="Print">
							<WTLINK name="9010" target="Print">
								<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
								<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
								<WTPARAM name="Title" value="PARAM(Title)"/>
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" noitems="false" entity="Note">
						<WTCOLUMN width="100" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsNewNote.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.Num)" oper="equal" value="CONST(1)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsReminder.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsFrozen.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsLocked.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
								<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
								<WTSTATIC value="DATA(Note.Notes)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="IsManager"/>
									<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start"/>
									<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="9003" class="NavBar">
											<WTPARAM name="NoteID" value="DATA(NoteID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================================-->
		<WTWEBPAGE name="9001" caption="Find" action="5" header="false" footer="false" navbar="false" wrapper="wrapper800"
			page-left="0" margin-width="0" navbar-width="0"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
			<!--==================================================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="OwnerID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="NewDate" datatype="date"/>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(NoteDate)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(Date)"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(DateAdd(&quot;m&quot;, -1, reqToDate))"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DateAdd(&quot;d&quot;, 1, reqToDate))"/>
				<WTMETHOD name="FindOwner">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="OwnerType" direction="input" value="PARAM(OwnerType)"/>
					<WTPARAM name="OwnerID" direction="input" value="PARAM(OwnerID)"/>
					<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
					<WTPARAM name="ToDate" direction="input" value="CONST(tmpToDate)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTCUSTOM>
					If reqNewDate &lt;&gt; "" Then
					For Each oNote in oNotes
					With oNote
					If CDate(.NoteDate) > CDate(reqNewDate) Then .Num = 1
					End With
					Next
					End If
				</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="left"/>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="300" align="left"/>
						<WTCOLUMN width="500" align="right"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(notes.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" label="Notes" bold="true"/>
							<WTSTATIC col="2" align="right">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle">
										<WTLINK name="9002">
											<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
											<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC label="NewNote">
									<WTLINK name="9002">
										<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
										<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST( | )"/>
								<WTSTATIC label="Print">
									<WTLINK name="9010" target="Print">
										<WTPARAM name="OwnerType" value="PARAM(OwnerType)"/>
										<WTPARAM name="OwnerID" value="PARAM(OwnerID)"/>
										<WTPARAM name="Title" value="PARAM(Title)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader"/>
					<WTCOMBO col="1" value="ATTR(Notes.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="10" focus="true"/>
					<WTSTATIC col="1" tag="From" class="ColumnHeader"/>
					<WTTEXT col="1" value="PARAM(FromDate)" size="7" type="date" prespace="false"/>
					<WTSTATIC col="1" tag="To" class="ColumnHeader"/>
					<WTTEXT col="1" value="PARAM(ToDate)" size="7" type="date" prespace="false"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Note">
						<WTCOLUMN width="100" align="left" valign="top"/>
						<WTROW height="24">
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsNewNote.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.Num)" oper="equal" value="CONST(1)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsReminder.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsFrozen.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(IsLocked.gif)" imgalign="absmiddle">
										<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
								<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
								<WTSTATIC value="DATA(Note.Notes)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="IsManager"/>
									<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start"/>
									<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="9003" class="NavBar">
											<WTPARAM name="NoteID" value="DATA(NoteID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>


		<!--==================================================================-->
		<WTWEBPAGE name="9020" caption="Report" navbar="false" action="5" form="Report"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--==================================================================-->
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="OwnerType" datatype="number"/>
			<WTPARAM name="AuthUserID" datatype="number"/>
			<WTPARAM name="Owner" datatype="text"/>
			<WTPARAM name="User" datatype="text"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(date)"/>
						<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2000&quot;"/>
						<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(Date())"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="5" name="Report" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="FORM(FromDate)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="FORM(ToDate)"/>
				<!-- Add a day to account for the minutes of the day -->
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DATEADD(&quot;d&quot;,1,CDate(reqToDate)))"/>
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListActivity">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="" direction="input" value="PARAM(OwnerType)"/>
						<WTPARAM name="" direction="input" value="PARAM(AuthUserID)"/>
						<WTPARAM name="" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="ListReminder">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="" direction="input" value="PARAM(OwnerType)"/>
						<WTPARAM name="" direction="input" value="PARAM(AuthUserID)"/>
						<WTPARAM name="" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>
				
				<WTSTATIC label="edit"/>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" label="ActivityReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" label="ReminderReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="PARAM(User)" class="PageHeading" align="center"/>
					<WTSTATIC col="1" value="PARAM(Owner)" class="PageHeading" align="center"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn"/>
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="UptoToday"/>
						<WTOPTION id="4" label="PrevWeek"/>
						<WTOPTION id="5" label="PrevMonth"/>
						<WTOPTION id="6" label="PrevYear"/>
						<WTOPTION id="7" label="WeekToDate"/>
						<WTOPTION id="8" label="MonthToDate"/>
						<WTOPTION id="9" label="YearToDate"/>
						<WTOPTION id="10" label="Tomorrow"/>
						<WTOPTION id="11" label="Next7Days"/>
						<WTOPTION id="12" label="Next14Days"/>
						<WTOPTION id="13" label="Next30Days"/>
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From"/>
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" tag="To"/>
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8"/>
					<WTBUTTON col="1" action="5" value="CONST(Report)" default="true"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="SYS(ActionCode)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						<WTRECORDSET col="1" graybar="true" entity="Note">
							<WTCOLUMN width="100" align="left" valign="top"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsReminder.gif)">
											<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsFrozen.gif)">
											<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsLocked.gif)">
											<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
									<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
									<WTSTATIC value="DATA(Note.OwnerType)" space="1" fontcolor="gray"/>
									<WTSTATIC value="DATA(Note.OwnerID)" space="1" fontcolor="gray"/>
									<WTCODEGROUP>
										<WTCONDITION expr="IsManager"/>
										<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start"/>
										<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
											<WTLINK name="9003" class="NavBar" target="EditNote">
												<WTPARAM name="NoteID" value="DATA(NoteID)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" value="DATA(Note.Notes)"/>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9021" caption="Summary" navbar="false" action="5" form="Report"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--==================================================================-->
			<WTPARAM name="UserType" datatype="number"/>
			<WTPARAM name="Reminder" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(reqReminder+1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Reminder)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(date)"/>
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Reminder)" oper="equal" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2000&quot;"/>
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)"/>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(Date)"/>
			</WTACTION>

			<WTACTION id="5" name="Report" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(reqReminder+1)"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="FORM(FromDate)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="FORM(ToDate)"/>
				<!-- Add a day to account for the minutes of the day -->
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DATEADD(&quot;d&quot;,1,CDate(reqToDate)))"/>
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="Summary">
						<WTPARAM name="" direction="input" value="PARAM(UserType)"/>
						<WTPARAM name="" direction="input" value="PARAM(Reminder)"/>
						<WTPARAM name="" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>
				
				<WTSTATIC label="edit"/>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" label="ActivitySummary" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" label="ReminderSummary" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="UserType" value="PARAM(UserType)" class="PageHeading" align="center"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn"/>
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="UptoToday"/>
						<WTOPTION id="4" label="PrevWeek"/>
						<WTOPTION id="5" label="PrevMonth"/>
						<WTOPTION id="6" label="PrevYear"/>
						<WTOPTION id="7" label="WeekToDate"/>
						<WTOPTION id="8" label="MonthToDate"/>
						<WTOPTION id="9" label="YearToDate"/>
						<WTOPTION id="10" label="Tomorrow"/>
						<WTOPTION id="11" label="Next7Days"/>
						<WTOPTION id="12" label="Next14Days"/>
						<WTOPTION id="13" label="Next30Days"/>
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From"/>
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" tag="To"/>
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8"/>
					<WTBUTTON col="1" action="5" value="CONST(Report)" default="true"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="SYS(ActionCode)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						<WTRECORDSET col="1" graybar="true" entity="Note">
							<WTCOLUMN width="50" align="left" valign="top" label="UserName"/>
							<WTCOLUMN width="50" align="left" valign="top" label="Notes"/>
							<WTROW>
								<WTSTATIC col="1" value="DATA(UserName)">
									<WTLINK name="9020" class="NavBar" target="Report">
										<WTPARAM name="Report" value="PARAM(Report)"/>
										<WTPARAM name="AuthUserID" value="DATA(NoteID)"/>
										<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
										<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
										<WTPARAM name="User" value="DATA(UserName)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC col="1" value="DATA(Num)"/>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9022" caption="Report" navbar="false" action="5" form="Report"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--==================================================================-->
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="Search" datatype="number"/>
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(date)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(Date())"/>
				<WTSETATTRIBUTE name="PARAM(Search)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="5" name="Report" type="Report">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="FORM(FromDate)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="FORM(ToDate)"/>
				<WTSETATTRIBUTE name="PARAM(SearchText)" value="FORM(SearchText)"/>
				<WTSETATTRIBUTE name="PARAM(Search)" value="FORM(Search)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchText)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="CONST(reqActionCode)" value="CONST(0)" />
					<WTERROR number="0" message="Oops, Please enter text to search for." />
				</WTCODEGROUP>

				<!-- Add a day to account for the minutes of the day -->
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DATEADD(&quot;d&quot;,1,CDate(reqToDate)))"/>
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="ListNotesStarts">
						<WTCONDITION expr="PARAM(Search)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="ListNotesContains">
						<WTCONDITION expr="PARAM(Search)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>
				
				<WTSTATIC label="edit"/>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="NotesReport" class="PageHeading" align="center"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn"/>
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="UptoToday"/>
						<WTOPTION id="4" label="PrevWeek"/>
						<WTOPTION id="5" label="PrevMonth"/>
						<WTOPTION id="6" label="PrevYear"/>
						<WTOPTION id="7" label="WeekToDate"/>
						<WTOPTION id="8" label="MonthToDate"/>
						<WTOPTION id="9" label="YearToDate"/>
						<WTOPTION id="10" label="Tomorrow"/>
						<WTOPTION id="11" label="Next7Days"/>
						<WTOPTION id="12" label="Next14Days"/>
						<WTOPTION id="13" label="Next30Days"/>
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From"/>
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" tag="To"/>
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="Search"/>
					<WTRADIO col="1" group="Search" name="1" datapathx="/DATA/PARAM[@search=1]" label="StartsWith" prespace="false"/>
					<WTRADIO col="1" group="Search" name="2" datapathx="/DATA/PARAM[@search=2]" label="Contains"/>
					<WTTEXT col="1" value="PARAM(SearchText)" name="SearchText"/>
					<WTBUTTON col="1" action="5" value="CONST(Report)" default="true"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="SYS(ActionCode)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						<WTRECORDSET col="1" graybar="true" entity="Note">
							<WTCOLUMN width="100" align="left" valign="top"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsReminder.gif)">
											<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsFrozen.gif)">
											<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsLocked.gif)">
											<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple"/>
									<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue"/>
									<WTSTATIC value="DATA(Note.OwnerType)" space="1" fontcolor="gray"/>
									<WTSTATIC value="DATA(Note.OwnerID)" space="1" fontcolor="gray"/>
									<WTCODEGROUP>
										<WTCONDITION expr="IsManager"/>
										<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start"/>
										<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
											<WTLINK name="9003" class="NavBar" target="EditNote">
												<WTPARAM name="NoteID" value="DATA(NoteID)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" value="DATA(Note.Notes)"/>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>