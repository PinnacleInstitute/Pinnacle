<WTROOT prefix="pts" system="Pinnacle">
	<WTENTITY id="177" name="Seminar" alias="sem">

		<!--Identity-->
		<WTATTRIBUTE id="17701" name="SeminarID" type="number" identity="true" title="true" min="1" required="true" source="entity"/>

    <!--Foreign Keys-->
    <WTATTRIBUTE id="17702" name="CompanyID" type="number" source="entity"/>
    <WTATTRIBUTE id="17703" name="MemberID" type="number" source="entity"/>

    <!--Foreign Table Fields-->

    <!--Attributes-->
    <WTATTRIBUTE id="17710" name="SeminarName" type="text" length="100" min="1" max="100" source="entity"/>
    <WTATTRIBUTE id="17711" name="Description" type="text" length="1000" min="1" max="1000" source="entity"/>
    <WTATTRIBUTE id="17712" name="Status" type="number" source="entity">
      <WTENUM id="1" name="Pending"/>
      <WTENUM id="2" name="Active"/>
      <WTENUM id="3" name="Complete"/>
      <WTENUM id="4" name="Cancelled"/>
    </WTATTRIBUTE>

    <!-- Non Persist Fields -->

    <!--Indexes-->
    <WTINDEX name="CompanyID">
      <WTATTRIBUTE name="CompanyID"/>
    </WTINDEX>
    <WTINDEX name="MemberID">
      <WTATTRIBUTE name="MemberID"/>
    </WTINDEX>

    <WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Seminar" entity="Seminar" alias="sem"/>
      <WTRELATIONSHIP name="Common" entity="Seminar" alias="sem"/>
    </WTRELATIONSHIPS>

    <!-- System Constants -->

    <!--List-->
    <WTENUM id="1" type="find">
      <WTATTRIBUTE name="SeminarName" default="true"/>
      <WTATTRIBUTE name="Description" contains="true"/>
    </WTENUM>

  </WTENTITY>

	<WTPROCEDURES>
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
    <WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
      <WTJOIN name="Common"/>
    </WTPROCEDURE>
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
    <!--==================================================================================================================-->
    <WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
      <WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
      <WTPARAM name="SYS(userid)" direction="input"/>
      <WTBOOKMARK name=""/>
      <WTJOIN name="Common"/>
      <WTCONDITION expr="ATTR(Seminar.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
    </WTPROCEDURE>
    <!--==================================================================================================================-->
    <WTPROCEDURE type="Find" name="FindStatus" style="GenerateDataProc.xsl">
      <WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
      <WTPARAM name="ATTR(Status)" direction="input" required="false"/>
      <WTPARAM name="SYS(userid)" direction="input"/>
      <WTBOOKMARK name=""/>
      <WTJOIN name="Common"/>
      <WTCONDITION expr="ATTR(Seminar.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
      <WTCONDITION expr="ATTR(Seminar.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
    </WTPROCEDURE>
    <!--==================================================================================================================-->
    <WTPROCEDURE type="Find" name="FindMember" style="GenerateDataProc.xsl">
      <WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
      <WTPARAM name="SYS(userid)" direction="input"/>
      <WTBOOKMARK name=""/>
      <WTJOIN name="Common"/>
      <WTCONDITION expr="ATTR(Seminar.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
    </WTPROCEDURE>
    <!--==================================================================================================================-->
    <WTPROCEDURE type="Find" name="FindMemberStatus" style="GenerateDataProc.xsl">
      <WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
      <WTPARAM name="ATTR(Status)" direction="input" required="false"/>
      <WTPARAM name="SYS(userid)" direction="input"/>
      <WTBOOKMARK name=""/>
      <WTJOIN name="Common"/>
      <WTCONDITION expr="ATTR(Seminar.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
      <WTCONDITION expr="ATTR(Seminar.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
    </WTPROCEDURE>
  </WTPROCEDURES>

	<WTWEBPAGES>
    <!--==================================================================================================================-->
    <WTWEBPAGE name="17701" caption="FindSeminar" action="5" header="false" footer="false" navbar="false" wrapper="wrapper1000"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
    <!--==================================================================================================================-->
      <WTPARAM name="SearchText" datatype="text"/>
      <WTPARAM name="FindTypeID" datatype="number"/>
      <WTPARAM name="Bookmark" datatype="text"/>
      <WTPARAM name="Direction" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="Status" datatype="number"/>
      <WTPARAM name="Title" datatype="text"/>

      <WTPARAM name="URL" datatype="text"/>
      <WTPARAM name="Language" datatype="text"/>

      <WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(SeminarName)">
        <WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
      </WTSETATTRIBUTE>
      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(URL)" value="CONST(&quot;http://&quot; + reqSysServerName + reqSysServerPath + &quot;Seminar/Seminar&quot;)" />
        <WTSETATTRIBUTE name="PARAM(Language)" value="CONST(&quot;en&quot;)" />

        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(21)">
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
        <WTOBJECT name="Seminars" project="ptsSeminarUser" class="CSeminars">
          <WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlSeminars" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(14)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
        <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
          <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(CompanyName)"/>
        </WTOBJECT>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(.NameFirst + &quot; &quot; + .NameLast)"/>
        </WTOBJECT>
      </WTACTION>

      <WTACTION id="5" name="Find" type="New">
        <WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
      </WTACTION>

      <WTACTION id="6" name="Previous" type="New">
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
      </WTACTION>

      <WTACTION id="7" name="Next" type="New">
        <WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
      </WTACTION>

      <WTOBJECT name="Seminars" project="ptsSeminarUser" class="CSeminars">
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Find">
            <WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
            <WTPARAM name="reqBookmark" direction="return" datatype="text"/>
            <WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
            <WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
            <WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
            <WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="FindStatus">
            <WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
            <WTPARAM name="reqBookmark" direction="return" datatype="text"/>
            <WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
            <WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
            <WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
            <WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="FindMember">
            <WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
            <WTPARAM name="reqBookmark" direction="return" datatype="text"/>
            <WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
            <WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
            <WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
            <WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="FindMemberStatus">
            <WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
            <WTPARAM name="reqBookmark" direction="return" datatype="text"/>
            <WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
            <WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
            <WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
            <WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
        </WTCODEGROUP>
        <WTMETHOD name="XML">
          <WTPARAM name="xmlSeminars" direction="return" datatype="text"/>
          <WTPARAM name="Option" direction="input" value="CONST(15)"/>
        </WTMETHOD>
      </WTOBJECT>
      <WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
        <WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
        <WTMETHOD name="XML">
          <WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
        </WTMETHOD>
      </WTOBJECT>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="1000" align="left"/>

        <WTFUNCTION name="NewSeminar()">
          var cid = document.getElementById('CompanyID').value
          var mid = document.getElementById('MemberID').value
          var url = "17702.asp?companyid=" + cid + "&amp;memberid=" + mid + "&amp;returnurl=17701.asp?companyid=" + cid + "%26memberid=" + mid
          window.location = url
        </WTFUNCTION>
        <WTFUNCTION name="UploadPage(id,lang)">
          var url, win;
          var lang = document.getElementById('Language').value;
          url = "17720.asp?SeminarID=" + id + "&amp;Language=" + lang
          win = window.open(url,"UploadFile","top=100,left=100,height=200,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>

        <WTROW>
          <WTHIDDEN name="CompanyID" value="PARAM(CompanyID)"/>
          <WTHIDDEN name="MemberID" value="PARAM(MemberID)"/>
          <WTHIDDEN name="Title" value="PARAM(Title)"/>
          <WTHIDDEN name="Language" value="PARAM(Language)"/>
        </WTROW>

        <WTROW margin-top="12">
          <WTTABLE col="1">
            <WTCOLUMN width="200" align="left"/>
            <WTCOLUMN width="800" align="left"/>
            <WTROW>
              <WTIMAGE col="1" value="CONST(Seminar48.png)" align="center"/>
              <WTSTATIC col="2" tag="FindSeminar" value="PARAM(Title)" align="left" fontsize="5"/>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="6">
          <WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
          <WTCOMBO col="1" value="ATTR(Seminars.FindTypeID)" translate="true" prespace="false"/>
          <WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
          <WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true" prespace="false"/>
          <WTCOMBO col="1" value="PARAM(Status)">
            <WTOPTION id="0" label="All"/>
            <WTOPTION id="1" label="Pending"/>
            <WTOPTION id="2" label="Active"/>
            <WTOPTION id="3" label="Complete"/>
            <WTOPTION id="4" label="Cancelled"/>
          </WTCOMBO>
          <WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
          <WTBUTTON col="1" value="CONST(NewSeminar)" align="center">
            <WTCLICK>NewSeminar()</WTCLICK>
          </WTBUTTON>
          <WTBUTTON col="1" value="CONST(Close)">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

        <WTROW>
          <WTRECORDSET col="1" graybar="true" prevnext="top" entity="Seminar">
            <WTCOLUMN width="60" align="left" label="SeminarName"/>
            <WTCOLUMN width="20" align="left"/>
            <WTCOLUMN width="10" align="center" label="Status"/>
            <WTCOLUMN width="10" align="center" label="SeminarID"/>
            <WTROW height="30">
              <WTSTATIC col="1">
                <WTSTATIC value="DATA(SeminarName)" fontsize="3"/>
                <WTCODEGROUP>
                  <WTSTATIC space="2"/>
                  <WTIMAGE value="CONST(Edit24.gif)" imgalign="absmiddle">
                    <WTLINK name="17703"><WTPARAM name="SeminarID" value="DATA(SeminarID)"/></WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="2">
                <WTCODEGROUP>
                  <WTSTATIC space="2"/>
                  <WTIMAGE value="CONST(Attendees24.gif)" imgalign="absmiddle">
                    <WTLINK name="18001" target="Attendees">
                      <WTPARAM name="SeminarID" value="DATA(SeminarID)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTSTATIC space="2"/>
                  <WTIMAGE value="CONST(DocPreview24.gif)" imgalign="absmiddle">
                    <WTLINK name="sp" target="PreviewPage">
                      <WTPARAM name="S" value="DATA(SeminarID)"/>
                      <WTPARAM name="Preview" value="CONST(1)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTSTATIC space="2"/>
                  <WTIMAGE value="CONST(Download.gif)" alt="DownloadPage">
                    <WTLINK name="CONST(&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@url,@seminarid, '[', /DATA/PARAM/@language, '].htm')&quot;/&gt;)" target="download"/>
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTSTATIC space="2"/>
                  <WTIMAGE value="CONST(Upload.gif)" alt="UploadPage">
                    <WTLINK name="UploadPage(&lt;xsl:value-of select=&quot;@seminarid&quot;/&gt;)" click="true" />
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTSTATIC space="2"/>
                  <WTIMAGE value="CONST(Email24.gif)" imgalign="absmiddle">
                    <WTLINK name="17730" target="SeminarEmail">
                      <WTPARAM name="SeminarID" value="DATA(SeminarID)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTSTATIC space="2"/>
                  <WTIMAGE value="CONST(Report24.gif)" imgalign="absmiddle">
                    <WTLINK name="18115" target="SeminarLog">
                      <WTPARAM name="SeminarID" value="DATA(SeminarID)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="3" value="DATA(Status)"/>
              <WTSTATIC col="4" value="DATA(SeminarID)"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" merge="4" value="DATA(Description)" align="left" fontcolor="gray"/>
            </WTROW>
          </WTRECORDSET>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="17702" caption="NewSeminar" header="false" footer="false" navbar="false" wrapper="wrapper600"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CopyID" datatype="number"/>

      <WTINCLUDE name="FileManager.asp"/>

      <WTSUB name="AddSeminar">
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
          <WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
          <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(2)"/>
          <WTSETATTRIBUTES/>
          <WTMETHOD name="Add">
            <WTPARAM name="tmpSeminarID" direction="return" datatype="number"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsErrors"/>
            <WTMETHOD name="XML">
              <WTPARAM name="xmlSeminar" direction="return" datatype="text"/>
              <WTPARAM name="Option" direction="input" value="CONST(2)"/>
            </WTMETHOD>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTOBJECT name="Venue" project="ptsVenueUser" class="CVenue">
          <WTCONDITION expr="NoErrors"/>
          <WTMETHOD name="Load">
            <WTPARAM name="VenueID" direction="input" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(SeminarID)" value="CONST(tmpSeminarID)"/>
          <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
          <WTSETATTRIBUTES/>
          <WTMETHOD name="Add">
            <WTPARAM name="tmpVenueID" direction="return" datatype="number"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsErrors"/>
            <WTMETHOD name="XML">
              <WTPARAM name="xmlVenue" direction="return" datatype="text"/>
              <WTPARAM name="Option" direction="input" value="CONST(2)"/>
            </WTMETHOD>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTOBJECT name="Meeting" project="ptsMeetingUser" class="CMeeting">
          <WTCONDITION expr="NoErrors"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MeetingID" direction="input" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(VenueID)" value="CONST(tmpVenueID)"/>
          <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(2)"/>
          <WTSETATTRIBUTES/>
          <WTMETHOD name="Add">
            <WTPARAM name="tmpMeetingID" direction="return" datatype="number"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsErrors"/>
            <WTMETHOD name="XML">
              <WTPARAM name="xmlMeeting" direction="return" datatype="text"/>
              <WTPARAM name="Option" direction="input" value="CONST(2)"/>
            </WTMETHOD>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="PARAM(CopyID)" oper="not-equal" value="CONST(0)" connector="and"/>
          <WTSETATTRIBUTE name="CONST(FolderName)" value="CONST(reqSysWebDirectory + &quot;Seminar&quot;)"/>
          <WTCUSTOM>
          tmpFiles = FileList( FolderName, "htm", "Seminar" + CStr(reqSeminarID) )
          a = Split( tmpFiles, "|")
          total = UBOUND(a)
          For x = 0 to total
            tmp = a(x)
            If tmp &lt;&gt; "" Then
              fromFile = FolderName + "\" + tmp
              toFile = FolderName + "\" + Replace( tmp, "Seminar" + CStr(reqCopyID), "Seminar" + CStr(tmpSeminarID) )
              CopyFile fromFile, toFile
            End If
          Next
          </WTCUSTOM>
        </WTCODEGROUP>
      </WTSUB>

      <WTSUB name="LoadSeminar">
        <WTSETATTRIBUTE name="PARAM(CopyID)" value="CONST(1)"/>
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="CONST(0)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(0)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
          </WTCODEGROUP>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlSeminar" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadSeminar"/>
      </WTACTION>

        <WTACTION id="2" name="Add" type="Add">
          <WTCALLSUB name="AddSeminar"/>
          <WTRETURN>
            <WTCONDITION expr="NoErrors"/>
          </WTRETURN>
        </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

      <!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" class="PageHeading" align="left">
            <WTCODEGROUP><WTIMAGE value="CONST(Seminar48.png)" imgalign="absmiddle"/></WTCODEGROUP>
            <WTSTATIC space="3"/>
            <WTSTATIC label="NewSeminar"/>
          </WTSTATIC>
        </WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="SeminarName"/>
          <WTTEXT col="2" value="ATTR(Seminar.SeminarName)" size="60"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Description"/>
          <WTMEMO col="2" value="ATTR(Seminar.Description)" cols="60" rows="3"/>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1"/>
          <WTSTATIC col="2" label="CopySeminar" align="left"/>
          <WTTEXT col="2" value="PARAM(CopyID)" size="2"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" class="PageHeading" align="left">
            <WTCODEGROUP><WTIMAGE value="CONST(Venue48.png)" imgalign="absmiddle"/></WTCODEGROUP>
            <WTSTATIC space="3"/>
            <WTSTATIC label="Where"/>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="VenueName"/>
          <WTTEXT col="2" value="ATTR(Venue.VenueName)" size="60"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Street"/>
          <WTTEXT col="2" value="ATTR(Venue.Street1)" size="30"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1"/>
          <WTTEXT col="2" value="ATTR(Venue.Street2)" size="30"/>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" tag="City"/>
          <WTTEXT col="2" value="ATTR(Venue.City)" size="20"/>
          <WTSTATIC col="2" tag="State"/>
          <WTTEXT col="2" value="ATTR(Venue.State)" size="10" prespace="false"/>
          <WTSTATIC col="2" tag="Zip"/>
          <WTTEXT col="2" value="ATTR(Venue.Zip)" size="10" prespace="false"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" class="PageHeading" align="left">
            <WTCODEGROUP><WTIMAGE value="CONST(DateTime48.png)" imgalign="absmiddle"/></WTCODEGROUP>
            <WTSTATIC space="3"/>
            <WTSTATIC label="When"/>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="MeetingDate"/>
          <WTTEXT col="2" value="ATTR(Meeting.MeetingDate)" type="date"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="StartTime"/>
          <WTTEXT col="2" value="ATTR(Meeting.StartTime)"/>
          <WTSTATIC col="2" tag="EndTime"/>
          <WTTEXT col="2" value="ATTR(Meeting.EndTime)" prespace="false"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Limit"/>
          <WTTEXT col="2" value="ATTR(Meeting.Limit)" size="3"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center"/>
          <WTBUTTON col="1" action="3" value="CONST(Cancel)"/>
        </WTROW>

      </WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="17703" caption="Seminar" header="false" footer="false" navbar="false" wrapper="wrapper600"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
      <!--============================================================================================-->
      <WTPARAM name="SeminarID" datatype="number"/>
      <WTPARAM name="URL" datatype="text"/>
      <WTPARAM name="URL2" datatype="text"/>

      <WTCODEGROUP>
        <WTCUSTOM>
          reqURL = "http://" + reqSysServerName + reqSysServerPath + "sp.asp?s=" &amp; reqSeminarID
          reqURL2 = CStr(reqSeminarID) + ".BitcoinLunchNLearn.com"
        </WTCUSTOM>
      </WTCODEGROUP>

          <WTSUB name="UpdateSeminar">
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(SeminarID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTES/>
          <WTMETHOD name="Save">
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsErrors"/>
            <WTMETHOD name="XML">
              <WTPARAM name="xmlSeminar" direction="return" datatype="text"/>
              <WTPARAM name="Option" direction="input" value="CONST(2)"/>
            </WTMETHOD>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="LoadSeminar">
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(SeminarID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlSeminar" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Meetings" project="ptsMeetingUser" class="CMeetings">
          <WTMETHOD name="ListSeminar">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(SeminarID)"/>
            <WTPARAM name="Status" direction="input" value="CONST(1)"/>
          </WTMETHOD>
          <WTCUSTOM>
            For Each oItem in oMeetings
              With oItem
                If .VenueName = "~" Then
                  Select Case Weekday(.MeetingDate)
                  Case 1 .Day = "Sunday"
                  Case 2 .Day = "Monday"
                  Case 3 .Day = "Tuesday"
                  Case 4 .Day = "Wednesday"
                  Case 5 .Day = "Thursday"
                  Case 6 .Day = "Friday"
                  Case 7 .Day = "Saturday"
                  End Select
                End If
              End With
            Next
          </WTCUSTOM>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMeetings" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadSeminar"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="UpdateSeminar"/>
        <WTCALLSUB name="LoadSeminar">
          <WTCONDITION expr="IsErrors"/>
        </WTCALLSUB>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <WTACTION id="4" name="Delete" type="Delete">
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(SeminarID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="Delete">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(SeminarID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="160" align="right"/>
        <WTCOLUMN width="440" align="left"/>

        <WTFUNCTION name="NewVenue()">
          var sid = document.getElementById('SeminarID').value
          var url = "17802.asp?seminarid=" + sid + "&amp;returnurl=17703.asp?seminarid=" + sid
          window.location = url
        </WTFUNCTION>
        <WTROW>
          <WTHIDDEN value="PARAM(SeminarID)"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" class="PageHeading" align="left">
            <WTCODEGROUP><WTIMAGE value="CONST(Seminar48.png)" imgalign="absmiddle"/></WTCODEGROUP>
            <WTSTATIC space="3"/>
            <WTSTATIC tag="Seminar" value="ATTR(Seminar.SeminarName)"/>
          </WTSTATIC>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" label="ReferralSource" align="left" class="prompt"/>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTSTATIC col="1" merge="2" tag="Link" value="PARAM(URL)" align="center" fontsize="3" newline="1"/>
          <WTSTATIC col="1" merge="2" tag="Link2" value="PARAM(URL2)" align="center" fontsize="3"/>
        </WTROW>

            <WTCODEGROUP>
          <WTCONDITION expr="IsEmployee"/>
          <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
          <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" merge="2" tag="CompanyID" align="center"/>
            <WTTEXT col="1" value="ATTR(Seminar.CompanyID)" size="3" prespace="false"/>
            <WTSTATIC col="1" tag="MemberID"/>
            <WTTEXT col="1" value="ATTR(Seminar.MemberID)" size="3" prespace="false"/>
          </WTROW>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NotEmployee"/>
          <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
          <WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
          <WTROW>
            <WTHIDDEN value="ATTR(Seminar.CompanyID)"/>
            <WTHIDDEN value="ATTR(Seminar.MemberID)"/>
          </WTROW>
        </WTCODEGROUP>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="SeminarName"/>
          <WTTEXT col="2" value="ATTR(Seminar.SeminarName)" size="60"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Description"/>
          <WTMEMO col="2" value="ATTR(Seminar.Description)" cols="60" rows="3"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Status"/>
          <WTCOMBO col="2" value="ATTR(Seminar.Status)"/>
        </WTROW>

        <WTROW margin-top="12">
          <WTTABLE col="1" merge="2">
            <WTCOLUMN width="300" align="left"/>
            <WTCOLUMN width="300" align="right"/>
            <WTROW>
              <WTSTATIC col="1" align="left" class="PageHeading">
                <WTCODEGROUP><WTIMAGE value="CONST(Venue48.png)" imgalign="absmiddle"/></WTCODEGROUP>
                <WTSTATIC space="3"/>
                <WTSTATIC label="Venue"/>
              </WTSTATIC>
              <WTBUTTON col="2" value="CONST(NewVenue)" align="right" class="PageHeader">
                <WTCLICK>NewVenue()</WTCLICK>
              </WTBUTTON>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW>
          <WTRECORDSET col="1" merge="2" graybar="false" entity="Meeting">
            <WTCOLUMN width="10" align="left" valign="top" label="Name"/>
            <WTCOLUMN width="40" align="left" valign="top" label="DateTime"/>
            <WTCOLUMN width="15" align="center" valign="top" label="Status"/>
            <WTCOLUMN width="15" align="center" valign="top" label="Limit"/>
            <WTCOLUMN width="10" align="center" valign="top" label="Guests"/>
            <WTCOLUMN width="10" align="center" valign="top" label="Attended"/>
            <WTROW height="30">
              <WTCONDITION expr="DATA(VenueName)" oper="not-equal" value="CONST('~')"/>
              <WTSTATIC col="1" merge="6">
                <WTSTATIC value="DATA(VenueName)" fontsize="3"/>
                <WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTIMAGE value="CONST(Edit24.gif)" imgalign="absmiddle">
                    <WTLINK name="17803"><WTPARAM name="VenueID" value="DATA(Guests)"/></WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTSTATIC space="1"/>
                <WTSTATIC label="Active" fontcolor="blue"><WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/></WTSTATIC>
                <WTSTATIC label="Inactive" fontcolor="red"><WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/></WTSTATIC>
                <WTSTATIC space="1"/>
                <WTSTATIC value="DATA(Description)" fontcolor="gray"/>
              </WTSTATIC>
            </WTROW>
            <WTROW height="18">
              <WTCONDITION expr="DATA(VenueName)" oper="equal" value="CONST('~')"/>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2">
                <WTSTATIC value="DATA(Meeting.Day)" space="1" bold="true"/>
                <WTSTATIC space="1"/>
                <WTSTATIC value="DATA(Meeting.MeetingDate)" space="1" bold="true"/>
                <WTSTATIC space="1"/>
                <WTSTATIC value="DATA(Meeting.StartTime)"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(EndTime)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC space="1"/>
                  <WTSTATIC label="to" space="1"/>
                  <WTSTATIC value="DATA(Meeting.EndTime)"/>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="3">
                <WTSTATIC label="Pending" fontcolor="green"><WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/></WTSTATIC>
                <WTSTATIC label="Active" fontcolor="blue"><WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/></WTSTATIC>
                <WTSTATIC label="Full" fontcolor="purple"><WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(3)"/></WTSTATIC>
                <WTSTATIC label="Cancelled" fontcolor="red"><WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(4)"/></WTSTATIC>
                <WTSTATIC label="Complete"><WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(5)"/></WTSTATIC>
              </WTSTATIC>
              <WTSTATIC col="4" value="DATA(Meeting.Limit)"/>
              <WTSTATIC col="5" value="DATA(Meeting.Guests)"/>
              <WTSTATIC col="6" value="DATA(Meeting.Attended)"/>
            </WTROW>
          </WTRECORDSET>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
          <WTBUTTON col="1" merge="2" action="3" value="CONST(Return)"/>
          <WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="17704" caption="Seminar Page" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
      <!--==================================================================-->
      <WTPARAM name="SeminarID" datatype="number"/>
      <WTPARAM name="URL" datatype="text"/>

      <WTCODEGROUP>
        <WTCUSTOM>
          reqURL = "http://" + reqSysServerName + reqSysServerPath + "sp.asp?s=" &amp; reqSeminarID
        </WTCUSTOM>
      </WTCODEGROUP>

      <WTSUB name="LoadPage">
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Seminar&quot; &amp; reqSeminarID &amp; &quot;.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Seminar\&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(Language)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="UpdatePage">
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Seminar&quot; &amp; reqSeminarID &amp; &quot;.htm&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Seminar\&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(Language)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
          <WTMETHOD name="Save"/>
          <WTMETHOD name="XML">
            <WTCONDITION expr="IsErrors"/>
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadPage"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="UpdatePage"/>
        <WTCALLSUB name="LoadPage">
          <WTCONDITION expr="IsErrors"/>
        </WTCALLSUB>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="1000" align="left"/>

        <WTROW>
          <WTSTATIC col="1" label="SeminarPromotionPage" align="left" class="PageHeading"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" align="left" height="1" color="SYS(headerdivider)"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" align="left" fontsize="3">
            <WTSTATIC tag="Link" space="1"/>
            <WTSTATIC value="PARAM(URL)"/>
          </WTSTATIC>
        </WTROW>

        <WTROW margin-top="6" margin-bottom="6">
          <WTDIVIDER col="1" align="left" height="1" color="SYS(divider)"/>
        </WTROW>

        <WTROW>
          <WTMEMO col="1" align="left" value="ATTR(HTMLFile.Data)" cols="100" rows="50" htmleditor="true" embedhtml="true"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
          <WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--===============================================================================-->
    <WTWEBPAGE name="sp" caption="Seminar Program" navbar="false" footer="false" 
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" langfile="sp" body="true" error="true">
      <!--===============================================================================-->
      <WTPARAM name="s" datatype="number" />
      <WTPARAM name="l" datatype="text" />
      <WTPARAM name="r" datatype="text" />
      <WTPARAM name="Preview" datatype="number" />

      <WTINCLUDE name="Comm.asp"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="CONST(tmpLanguage)" value="PARAM(l)"/>
        <WTSETATTRIBUTE name="CONST(tmpLanguage)" value="SYS(Language)">
          <WTCONDITION expr="CONST(tmpLanguage)" oper="equal" value="CONST(&quot;&quot;)" />
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <WTSUB name="LoadPage">
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(s)" />
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(SeminarName)" value="ATTR(SeminarName)" />
          <WTSETATTRIBUTE name="CONST(SeminarDesc)" value="ATTR(Description)" />
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Status)" oper="not-equal" value="CONST(2)" />
            <WTCONDITION expr="PARAM(Preview)" oper="equal" value="CONST(0)" connector="and"/>
            <WTCUSTOM>Response.write "Seminar Not Available"
            Response.end</WTCUSTOM>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTOBJECT name="Meetings" project="ptsMeetingUser" class="CMeetings">
          <WTMETHOD name="ListSeminar">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(s)"/>
            <WTPARAM name="Status" direction="input" value="CONST(0)"/>
          </WTMETHOD>
          <WTCUSTOM>
            tmpMeetings = ""
            cnt = 0
            For Each oItem in oMeetings
              With oItem
                If .VenueName &lt;&gt; "~" Then
                  VenueName = "&lt;b&gt;" + .VenueName + "&lt;/b&gt;"
                  Description = .Description
                Else
                  If cnt = 0 Then Check = " checked" Else Check = ""
                  cnt = cnt + 1
                  If .Status = 2 Then
                    Input = "&lt;input type=&quot;&quot;radio&quot;&quot; name=&quot;&quot;Meeting&quot;&quot; value=&quot;&quot;" + .MeetingID + "&quot;&quot;" + Check +"/&gt;"
                  Else
                      Input = "&amp;nbsp;&amp;nbsp;&amp;nbsp;"
                  End If
                  If .Status = 3 Then Full = " (FULL)" Else Full = ""
                  MeetingTime = .StartTime
                  If .EndTime &lt;&gt; "" Then MeetingTime = MeetingTime + " - " + .EndTime
                  DayStr = ""
                  Select Case Weekday(.MeetingDate)
                  Case 1 DayStr = "Sunday"
                  Case 2 DayStr = "Monday"
                  Case 3 DayStr = "Tuesday"
                  Case 4 DayStr = "Wednesday"
                  Case 5 DayStr = "Thursday"
                  Case 6 DayStr = "Friday"
                  Case 7 DayStr = "Saturday"
                  End Select
            Label = "&lt;span id=&quot;&quot;venue&quot;&quot;> " + VenueName + Full + "&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;" + DayStr + " " + .MeetingDate + " " + MeetingTime + "&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;" + Description
                  tmpMeetings = tmpMeetings + Input + Label + "&lt;br&gt;&lt;/span&gt;"
                End If
              End With
            Next
           </WTCUSTOM>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Seminar&quot; &amp; reqS &amp; &quot;.htm&quot;)" />
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Seminar\&quot;)" />
          <WTSETATTRIBUTE name="ATTR(Language)" value="CONST(tmpLanguage)" />
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
          <WTMETHOD name="Load" />
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
          </WTMETHOD>
        </WTOBJECT>
        <WTCUSTOM>
          If reqActionCode = 1 And xmlError = "" Then tmpDisplay = "block" Else tmpDisplay = "none"
          If reqActionCode = 1 Then xmlHTMLFile = Replace( xmlHTMLFile, "autoplay=1", "autoplay=0" )
          xmlHTMLFile = Replace( xmlHTMLFile, "{display}", tmpDisplay )
          xmlHTMLFile = Replace( xmlHTMLFile, "{seminarname}", SeminarName )
          xmlHTMLFile = Replace( xmlHTMLFile, "{description}", SeminarDesc )
          xmlHTMLFile = Replace( xmlHTMLFile, "{meetings}", CleanXMLComment(tmpMeetings) )
        </WTCUSTOM>
      </WTSUB>

      <WTSUB function="EmailConfirmation(pEmail, pMeetingID)">
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(InStr(pEmail, &quot;@&quot;))" oper="not-equal" value="CONST(0)" />
          <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
            <WTMETHOD name="Load">
              <WTPARAM name="SeminarID" direction="input" value="PARAM(s)" />
              <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(SeminarName)" value="ATTR(SeminarName)" />
          </WTOBJECT>
          <WTOBJECT name="Meeting" project="ptsMeetingUser" class="CMeeting">
            <WTMETHOD name="Load">
              <WTPARAM name="MeetingID" direction="input" value="CONST(pMeetingID)" />
              <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(VenueID)" value="ATTR(VenueID)" />
            <WTSETATTRIBUTE name="CONST(MeetingDate)" value="ATTR(MeetingDate)" />
            <WTSETATTRIBUTE name="CONST(StartTime)" value="ATTR(StartTime)" />
            <WTSETATTRIBUTE name="CONST(EndTime)" value="ATTR(EndTime)" />
          </WTOBJECT>
          <WTOBJECT name="Venue" project="ptsVenueUser" class="CVenue">
            <WTMETHOD name="Load">
              <WTPARAM name="VenueID" direction="input" value="CONST(VenueID)" />
              <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(VenueName)" value="ATTR(VenueName)" />
            <WTSETATTRIBUTE name="CONST(Street1)" value="ATTR(Street1)"/>
            <WTSETATTRIBUTE name="CONST(Street2)" value="ATTR(Street2)"/>
            <WTSETATTRIBUTE name="CONST(City)" value="ATTR(City)"/>
            <WTSETATTRIBUTE name="CONST(State)" value="ATTR(State)"/>
            <WTSETATTRIBUTE name="CONST(Zip)" value="ATTR(Zip)"/>
            <WTCUSTOM>
              DayStr = ""
              Select Case Weekday(MeetingDate)
              Case 1 DayStr = "Sunday"
              Case 2 DayStr = "Monday"
              Case 3 DayStr = "Tuesday"
              Case 4 DayStr = "Wednesday"
              Case 5 DayStr = "Thursday"
              Case 6 DayStr = "Friday"
              Case 7 DayStr = "Saturday"
              End Select
            </WTCUSTOM>
          </WTOBJECT>
          <WTSETATTRIBUTE name="CONST(CompanyID)" value="CONST(21)" />
          <WTSETATTRIBUTE name="CONST(CompanyEmail)" value="CONST(&quot;support@NexxusUniversity.com&quot;)" />
          <WTCUSTOM>
            tmpSubject = "SUCCESSFUL REGISTRATION - " + SeminarName
            MeetingDate = MeetingDate + "  " + StartTime
            If EndTime &lt;&gt; "" Then MeetingDate = MeetingDate + " - " + EndTime
            tmpBody = "We look forward to your attendance at:&lt;br&gt;&lt;b&gt;" + VenueName + "&lt;/b&gt;&lt;br&gt;" + DayStr + " " + MeetingDate + "&lt;br&gt;" + Street1 + " " + Street2 + ", " + City + " " + State + " " + Zip
            SendEmail CompanyID, CompanyEmail, CompanyEmail, pEmail, "", "", tmpSubject, tmpBody
          </WTCUSTOM>
        </WTCODEGROUP>
      </WTSUB>

      <WTSUB name="AddLog">
        <WTOBJECT name="SeminarLog" project="ptsSeminarLogUser" class="CSeminarLog">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarLogID" direction="input" value="CONST(0)" />
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(SeminarID)" value="PARAM(s)" />
          <WTSETATTRIBUTE name="ATTR(LogDate)" value="SYS(Now)" />
          <WTMETHOD name="Add">
            <WTPARAM name="SeminarLogID" direction="return" datatype="number" />
            <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadPage"/>
        <WTCALLSUB name="AddLog">
          <WTCONDITION expr="PARAM(Preview)" oper="equal" value="CONST(0)"/>
        </WTCALLSUB>
      </WTACTION>
      
      <WTACTION id="1" name="Add" type="Add">
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Preview)" oper="equal" value="CONST(0)" />
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
          <WTSETATTRIBUTE name="CONST(tmpMeetingID)" value="FORM(Meeting)"/>

          <WTOBJECT name="Attendee" project="ptsAttendeeUser" class="CAttendee">
            <WTMETHOD name="Load">
              <WTPARAM name="AttendeeID" direction="input" value="CONST(0)" />
              <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
            </WTMETHOD>

            <WTSETATTRIBUTE name="ATTR(SeminarID)" value="PARAM(s)"/>
            <WTSETATTRIBUTE name="ATTR(MeetingID)" value="CONST(tmpMeetingID)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(RegisterDate)" value="SYS(Now)"/>
            <WTSETATTRIBUTE name="ATTR(IP)" value="CONST(Request.ServerVariables(&quot;REMOTE_ADDR&quot;))"/>
            <WTSETATTRIBUTE name="ATTR(Refer)" value="CONST(Left(reqr,20))"/>

            <WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)"/>
            <WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)"/>
            <WTSETATTRIBUTE name="ATTR(Email)" value="CONST(tmpEmail)"/>
            <WTSETATTRIBUTE name="ATTR(Phone)" value="FORM(Phone)"/>
            <WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)"/>
            <WTSETATTRIBUTE name="ATTR(Guests)" value="FORM(Guests)"/>
<!--
            <WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)"/>
            <WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)"/>
            <WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)"/>
            <WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)"/>
-->
            <WTMETHOD name="Add">
              <WTPARAM name="AttendeeID" direction="return" datatype="number" />
              <WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
            </WTMETHOD>
          </WTOBJECT>
          <WTOBJECT name="Meeting" project="ptsMeetingUser" class="CMeeting">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="CountGuests">
              <WTPARAM name="MeetingID" direction="input" value="CONST(tmpMeetingID)"/>
              <WTPARAM name="Result" direction="return"/>
            </WTMETHOD>
          </WTOBJECT>
          <WTCALLSUB name="EmailConfirmation tmpEmail, tmpMeetingID">
            <WTCONDITION expr="NoErrors"/>
          </WTCALLSUB>
          <WTCALLSUB name="LoadPage"/>
        </WTCODEGROUP>

      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCODEGROUP>
          <WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true" />

          <WTSTATIC newline="2"/>
          <WTBUTTON value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--=============================================================================================-->
    <WTWEBPAGE name="17720" caption="Upload File" action="false" submit="17720Upload.asp" type="multi"
			navbar="false" header="false" footer="false" page-left="0" margin="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
      <!--=============================================================================================-->
      <WTPARAM name="SeminarID" datatype="number"/>
      <WTPARAM name="UploadError" datatype="number"/>
      <WTPARAM name="UploadErrorDesc" datatype="text"/>
      <WTPARAM name="DeleteFile" datatype="text"/>
      <WTPARAM name="FileName" datatype="text"/>
      <WTPARAM name="Language" datatype="text"/>
      <WTPARAM name="Status" datatype="number"/>

      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
        <WTCUSTOM>DoError reqUploadError, "Upload", reqUploadErrorDesc</WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(Language)" value="CONST(&quot;en&quot;)" />
        <WTCUSTOM>If Len(reqFileName) = 0 Then reqFileName = "Seminar" + CSTR(reqSeminarID) + "[" + reqLanguage + "]"</WTCUSTOM>
        <WTSETCACHE name="FILENAME" value="PARAM(FileName)"/>
      </WTACTION>

      <!--*******************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="400" align="left"/>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
          <WTROW>
            <WTSTATIC col="1" label="UploadPage" class="PageHeading"/>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
          </WTROW>
          <WTROW margin-bottom="6">
            <WTSTATIC col="1" value="PARAM(FileName)" class="PageHeading" align="center"/>
          </WTROW>
          <WTROW margin-bottom="12">
            <WTSTATIC col="1" label="UploadPageText" class="prompt"/>
          </WTROW>
          <WTROW margin-bottom="18">
            <WTFILE col="1" align="center" value="upload" accept="*.htm" size="30"/>
            <WTBUTTON col="1" align="center" default="true" action="1" value="CONST(Submit)"/>
          </WTROW>
        </WTCODEGROUP>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(1)"/>
          <WTROW margin-top="36" margin-bottom="12">
            <WTSTATIC col="1" label="UploadPageSuccessful" class="PageHeading" align="center"/>
          </WTROW>
          <WTROW margin-bottom="24">
            <WTSTATIC col="1" value="PARAM(FileName)" class="PageHeading" align="center"/>
          </WTROW>
          <WTROW>
            <WTBUTTON col="1" value="CONST(Close)" align="center">
              <WTCLICK>window.close()</WTCLICK>
            </WTBUTTON>
          </WTROW>
        </WTCODEGROUP>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--=============================================================================================-->
    <WTWEBPAGE name="17730" caption="Seminar Emails" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
      <!--=============================================================================================-->
      <WTPARAM name="SeminarID" datatype="number"/>
      <WTPARAM name="DeleteFile" datatype="text"/>

      <WTINCLUDE name="FileManager.asp"/>
      <WTDATATXN name="Files"/>

      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(DeleteFile)" oper="not-equal" value="CONST(&quot;&quot;)"/>
        <WTCUSTOM>
          reqDeleteFile = Replace( reqDeleteFile, "Day ", "" )
          tmpFile = reqSysWebDirectory + &quot;Seminar\&quot; + "Seminar" + CStr(reqSeminarID) + "-" + reqDeleteFile + "[en].htm"
          DeleteFile tmpFile
          Response.Redirect "17730.asp?SeminarID=" &amp; reqSeminarID
        </WTCUSTOM>
      </WTCODEGROUP>
      
      <WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="CONST(FolderName)" value="CONST(reqSysWebDirectory + &quot;Seminar&quot;)"/>
        <WTCUSTOM>
          xmlFiles = ListFiles( FolderName, "htm", "Seminar" + CStr(reqSeminarID) + "-" )
          xmlFiles = Replace( xmlFiles, "[en].htm", "" )
          xmlFiles = Replace( xmlFiles, "[en].HTM", "" )
          xmlFiles = Replace( xmlFiles, "Seminar" + CStr(reqSeminarID) + "-", "Day " )
        </WTCUSTOM>
      </WTACTION>

      <!--*******************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="375" align="left"/>
        <WTCOLUMN width="375" align="right"/>

        <WTFUNCTION name="NewEmail()">
          var sid = document.getElementById('SeminarID').value
          var url = "17731.asp?seminarid=" + sid + "&amp;returnurl=17730.asp?seminarid=" + sid
          window.location = url
        </WTFUNCTION>
        <WTROW>
          <WTHIDDEN value="PARAM(SeminarID)"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" label="SeminarEmails" class="PageHeading"/>
          <WTBUTTON col="2" value="CONST(NewEmail)" align="right" class="PageHeader">
            <WTCLICK>NewEmail()</WTCLICK>
          </WTBUTTON>
        </WTROW>

        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" merge="2" height="1" color="#777777"/>
        </WTROW>
        <WTROW>
          <WTTABLE col="1" merge="2">
            <WTCOLUMN width="300" align="left"/>
            <WTCOLUMN width="125" align="left"/>
            <WTCOLUMN width="225" align="left"/>
            <WTCOLUMN width="100" align="center"/>

            <WTREPEAT xpath="/DATA/TXN/FILES/FILE">
              <WTROW height="30">
                <WTSTATIC col="1" fontsize="3">
                  <WTSTATIC value="DATA(name)" fontsize="3"/>
                  <WTCODEGROUP>
                    <WTSTATIC space="2"/>
                    <WTIMAGE value="CONST(Edit24.gif)" imgalign="absmiddle">
                      <WTLINK name="17731"><WTPARAM name="SeminarID" value="PARAM(SeminarID)"/><WTPARAM name="Day" value="DATA(Name)"/></WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTSTATIC space="2"/>
                    <WTIMAGE value="CONST(Preview24.gif)" imgalign="absmiddle">
                      <WTLINK name="17732" target="PreviewEmail"><WTPARAM name="SeminarID" value="PARAM(SeminarID)"/><WTPARAM name="Day" value="DATA(Name)"/></WTLINK>
                    </WTIMAGE>
                  </WTCODEGROUP>
                </WTSTATIC>
                <WTSTATIC col="2" value="DATA(size)"/>
                <WTSTATIC col="3" value="DATA(date)"/>
                <WTIMAGE col="4" value="CONST(trash.gif)" imgalign="absmiddle">
                  <WTLINK name="17730" target="PreviewPage">
                    <WTPARAM name="SeminarID" value="PARAM(SeminarID)"/>
                    <WTPARAM name="DeleteFile" value="DATA(name)"/>
                  </WTLINK>
                </WTIMAGE>
              </WTROW>
            </WTREPEAT>
          </WTTABLE>
        </WTROW>
        
        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>
        
      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="17731" caption="Seminar Email" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
      <!--==================================================================-->
      <WTPARAM name="SeminarID" datatype="number"/>
      <WTPARAM name="Day" datatype="text"/>
      <WTPARAM name="EditDay" datatype="number"/>

      <WTCODEGROUP>
        <WTCUSTOM>
          If reqDay = "" Then reqDay = "Day 0"
          tmpDay = Replace( reqDay, "Day ", "" )
          If reqActionCode = 0 Then reqEditDay = tmpDay Else tmpDay = reqEditDay
          tmpFileName = "Seminar" + CStr(reqSeminarID) + "-" + CStr(tmpDay) + ".htm"
        </WTCUSTOM>
      </WTCODEGROUP>  
      <WTSUB name="LoadPage">
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(SeminarID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlSeminar" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpFileName)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Seminar\&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="CONST(&quot;en&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="UpdatePage">
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpFileName)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Seminar\&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="CONST(&quot;en&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTSETATTRIBUTE name="ATTR(Data)" value="FORM(Data)"/>
          <WTMETHOD name="Save"/>
          <WTMETHOD name="XML">
            <WTCONDITION expr="IsErrors"/>
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadPage"/>
      </WTACTION>

      <WTACTION id="1" name="Update" type="Update">
        <WTCALLSUB name="UpdatePage"/>
        <WTCALLSUB name="LoadPage">
          <WTCONDITION expr="IsErrors"/>
        </WTCALLSUB>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="3" name="Cancel" type="Cancel">
        <WTRETURN/>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="750" align="left"/>

        <WTROW>
          <WTSTATIC col="1" align="left" class="PageHeading">
            <WTSTATIC label="SeminarEmailPage" space="1"/>
            <WTSTATIC value="PARAM(Day)"/>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" align="left" height="1" color="SYS(headerdivider)"/>
        </WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Day" align="left"/>
          <WTTEXT col="1" value="PARAM(EditDay)" size="2"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Subject" value="ATTR(Seminar.SeminarName)" fontsize="3"/>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Body" align="left"/>
          <WTSTATIC col="1" label="BodyTags" bold="true" prespace="false"/>
        </WTROW>

        <WTROW>
          <WTMEMO col="1" align="left" value="ATTR(HTMLFile.Data)" cols="75" rows="15" htmleditor="true" embedhtml="true"/>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" action="1" value="CONST(Update)" align="center"/>
          <WTBUTTON col="1" action="3" value="CONST(Cancel)"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="17732" caption="Email Preview" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
      <!--==================================================================-->
      <WTPARAM name="SeminarID" datatype="number"/>
      <WTPARAM name="Day" datatype="text"/>

      <WTCODEGROUP>
        <WTCUSTOM>
          If reqDay = "" Then reqDay = "Day 0"
          tmpDay = Replace( reqDay, "Day ", "" )
          tmpFileName = "Seminar" + CStr(reqSeminarID) + "-" + CStr(tmpDay) + ".htm"
        </WTCUSTOM>
      </WTCODEGROUP>
      <WTSUB name="LoadPage">
        <WTOBJECT name="Seminar" project="ptsSeminarUser" class="CSeminar">
          <WTMETHOD name="Load">
            <WTPARAM name="SeminarID" direction="input" value="PARAM(SeminarID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpSeminarName)" value="ATTR(SeminarName)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlSeminar" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpFileName)"/>
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Seminar\&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="CONST(&quot;en&quot;)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{firstname}", "Mary" )
            xmlHTMLFile = Replace( xmlHTMLFile, "{lastname}", "Smith" )
            xmlHTMLFile = Replace( xmlHTMLFile, "{seminarname}", tmpSeminarName )
            xmlHTMLFile = Replace( xmlHTMLFile, "{venuename}", "Henry's Tavern" )
            xmlHTMLFile = Replace( xmlHTMLFile, "{venueaddress}", "12345 Main St., Dallas TX 75026" )
            tmpDate = DateAdd( "d", tmpDay, reqSysDate )
            xmlHTMLFile = Replace( xmlHTMLFile, "{meetingdatetime}", CStr(tmpDate) + " 12:00pm - 1:00pm" )
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadPage"/>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="750" align="left"/>

        <WTROW>
          <WTSTATIC col="1" align="left" class="PageHeading">
            <WTSTATIC label="SeminarEmailPage" space="1"/>
            <WTSTATIC value="PARAM(Day)"/>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTDIVIDER col="1" align="left" height="1" color="SYS(headerdivider)"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" tag="Subject" value="ATTR(Seminar.SeminarName)" fontsize="3"/>
        </WTROW>

        <WTROW>
            <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTROW>

        <WTROW margin-top="24" margin-bottom="12">
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

  </WTWEBPAGES>
</WTROOT>