<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="04" name="Member" alias="me" log="false">

		<!--Identity-->
		<WTATTRIBUTE id="0401" name="MemberID" type="number" identity="true" min="1" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="0402" name="AuthUserID" type="number" source="entity"><WTINIT/></WTATTRIBUTE>
		<WTATTRIBUTE id="0403" name="WebsiteID" type="number" source="entity"/>
		<WTATTRIBUTE id="0404" name="CompanyID" type="number" source="entity"/>
		<WTATTRIBUTE id="0405" name="PromoID" type="number" source="entity"/>
		<WTATTRIBUTE id="0406" name="BillingID" type="number" source="entity"/>
		<WTATTRIBUTE id="0407" name="PayID" type="number" source="entity"/>
		<WTATTRIBUTE id="0408" name="ReferralID" type="number" source="entity"/>
		<WTATTRIBUTE id="0409" name="SponsorID" type="number" source="entity"/>
		<WTATTRIBUTE id="0410" name="Sponsor2ID" type="number" source="entity"/>
		<WTATTRIBUTE id="0411" name="Sponsor3ID" type="number" source="entity"/>
		<WTATTRIBUTE id="0412" name="MentorID" type="number" source="entity"/>

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="0413" name="UserGroup" type="number" source="join" passthru="true">
			<WTJOIN entity="AuthUser" name="UserGroup"/>
			<WTENUM id="41" name="Member"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0414" name="UserStatus" type="number" source="join" passthru="true">
			<WTJOIN entity="AuthUser" name="UserStatus"/>
			<WTENUM id="1" name="Active"/>
			<WTENUM id="2" name="InActive"/>
			<WTENUM id="3" name="ReadOnly"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0415" name="Logon" type="text" length="80" source="join">
			<WTJOIN entity="AuthUser" name="Logon"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="0416" name="CompanyName" type="text" length="60" min="1" max="60" source="entity" title="true"/>
		<WTATTRIBUTE id="0417" name="NameLast" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="0418" name="NameFirst" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="0419" name="MemberName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameLast"/>
			<WTCOMPUTE text=", "/>
			<WTCOMPUTE name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0420" name="BV" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0421" name="QV" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0422" name="BV2" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0423" name="QV2" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0424" name="BV3" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0425" name="QV3" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0426" name="BV4" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0427" name="QV4" type="currency" min="-999999.99" max="999999.99" source="entity">
			<WTFORMAT value="###,###,##0" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0428" name="Qualify" type="number" source="entity">
			<WTENUM id="1" name="QualifyNo"/>
			<WTENUM id="2" name="QualifyYes"/>
			<WTENUM id="3" name="QualifyLock"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0429" name="QualifyDate" type="date" source="entity"/>

		<WTATTRIBUTE id="0430" name="Email" type="text" length="80" min="1" max="80" source="entity" required="true"/>
		<WTATTRIBUTE id="0431" name="Email2" type="text" length="80" min="1" max="80" source="entity"/>
		<WTATTRIBUTE id="0432" name="Phone1" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0433" name="Phone2" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0434" name="Fax" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="0435" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Paid"/>
			<WTENUM id="2" name="Trial"/>
			<WTENUM id="3" name="Free"/>
			<WTENUM id="4" name="Suspended"/>
			<WTENUM id="5" name="InActive"/>
			<WTENUM id="6" name="Cancelled"/>
			<WTENUM id="7" name="Terminated"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0436" name="Level" type="number" source="entity"/>

		<WTATTRIBUTE id="0437" name="Newsletter" type="number" source="entity"/>
		<WTATTRIBUTE id="0438" name="EnrollDate" type="date" source="entity" required="true">
			<WTFORMAT value="m-d-yy h:mm am/pm"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0439" name="EndDate" type="date" source="entity"/>
		<WTATTRIBUTE id="0440" name="InitPrice" type="currency" source="entity"/>
		<WTATTRIBUTE id="0441" name="Price" type="currency" source="entity"/>
		<WTATTRIBUTE id="0442" name="Retail" type="currency" source="entity"/>
		<WTATTRIBUTE id="0443" name="BusAccts" type="number" source="entity"/>
		<WTATTRIBUTE id="0444" name="BusAcctPrice" type="currency" source="entity"/>
		<WTATTRIBUTE id="0445" name="BusAcctRetail" type="currency" source="entity"/>
		<WTATTRIBUTE id="0446" name="IsDiscount" type="yesno" source="entity"/>
		<WTATTRIBUTE id="0447" name="Discount" type="currency" source="entity"/>
		<WTATTRIBUTE id="0448" name="IsCompany" type="yesno" source="entity"/>
		<WTATTRIBUTE id="0449" name="Billing" type="number" source="entity">
			<WTENUM id="1" name="BillNone"/>
			<WTENUM id="2" name="BillCompany"/>
			<WTENUM id="3" name="BillMember"/>
			<WTENUM id="4" name="BillMaster"/>
			<WTENUM id="5" name="BillManual"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0450" name="AccessLimit" type="text" length="50" min="1" max="50" source="entity" language="false"/>
		<WTATTRIBUTE id="0451" name="QuizLimit" type="number" source="entity">
			<WTENUM id="1" name="NoRetake"/>
			<WTENUM id="2" name="NoAnswer"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0452" name="Reference" type="text" length="15" min="1" max="15" source="entity" language="false"/>
		<WTATTRIBUTE id="0453" name="Referral" type="text" length="15" min="1" max="15" source="entity" language="false"/>
		<WTATTRIBUTE id="0454" name="TrialDays" type="number" source="entity"/>

		<WTATTRIBUTE id="0455" name="MasterID" type="number" source="entity"/>
		<WTATTRIBUTE id="0456" name="IsIncluded" type="yesno" source="entity"/>
		<WTATTRIBUTE id="0457" name="IsMaster" type="yesno" source="entity"/>
		<WTATTRIBUTE id="0458" name="MasterPrice" type="currency" source="entity"/>
		<WTATTRIBUTE id="0459" name="MasterMembers" type="number" source="entity"/>
		<WTATTRIBUTE id="0460" name="MaxMembers" type="number" source="entity"/>
		<WTATTRIBUTE id="0461" name="VisitDate" type="date" source="entity">
			<WTFORMAT value="m-d-yy h:mm am/pm"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0462" name="TaxIDType" type="number" source="entity">
			<WTENUM id="1" name="TaxIDType1"/>
			<WTENUM id="2" name="TaxIDType2"/>
			<WTENUM id="3" name="TaxIDType3"/>
			<WTENUM id="4" name="TaxIDType4"/>
			<WTENUM id="5" name="TaxIDType5"/>
			<WTENUM id="6" name="TaxIDType6"/>
			<WTENUM id="7" name="TaxIDType7"/>
			<WTENUM id="8" name="TaxIDType8"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0463" name="TaxID" type="text" length="15" min="1" max="15" source="entity"/>
		<WTATTRIBUTE id="0464" name="AutoShipDate" type="date" source="entity"/>
		<WTATTRIBUTE id="0465" name="PaidDate" type="date" source="entity"/>
		<WTATTRIBUTE id="0466" name="StatusDate" type="date" source="entity"/>
		<WTATTRIBUTE id="0467" name="StatusChange" type="number" source="entity">
			<WTENUM id="1" name="Paid"/>
			<WTENUM id="2" name="Trial"/>
			<WTENUM id="3" name="Free"/>
			<WTENUM id="4" name="Suspended"/>
			<WTENUM id="5" name="InActive"/>
			<WTENUM id="6" name="Cancelled"/>
			<WTENUM id="7" name="Terminated"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0468" name="LevelChange" type="number" source="entity"/>
		<WTATTRIBUTE id="0469" name="IsRemoved" type="yesno" source="entity"/>
		<WTATTRIBUTE id="0470" name="GroupID" type="number" source="entity"/>
		<WTATTRIBUTE id="0471" name="Role" type="text" length="15" min="1" max="15" source="entity"/>
		<WTATTRIBUTE id="0472" name="Secure" type="number" source="entity"/>
		<WTATTRIBUTE id="0473" name="Options" type="text" length="20" source="entity" language="false"/>
		<WTATTRIBUTE id="0474" name="Options2" type="text" length="40" min="1" max="40" source="entity" language="false"/>
		<WTATTRIBUTE id="0475" name="Pos" type="number" source="entity"/>
		<WTATTRIBUTE id="0476" name="Signature" type="text" length="1000" min="1" max="1000" source="entity" embedhtml="true"/>
		<WTATTRIBUTE id="0477" name="SocNet" type="text" length="200" min="1" max="200" source="entity" language="false"/>
		<WTATTRIBUTE id="0478" name="ConfLine" type="text" length="40" min="1" max="40" source="entity" language="false"/>
		<WTATTRIBUTE id="0479" name="NotifyMentor" type="text" length="10" min="1" max="10" source="entity" language="false"/>
		<WTATTRIBUTE id="0480" name="Image" type="text" length="15" min="1" max="15" source="entity" language="false"/>
		<WTATTRIBUTE id="0481" name="Identification" type="text" length="150" source="entity"/>
		<WTATTRIBUTE id="0482" name="Title" type="number" source="entity"/>
		<WTATTRIBUTE id="0483" name="Title2" type="number" source="entity"/>
		<WTATTRIBUTE id="0484" name="MinTitle" type="number" source="entity"/>
		<WTATTRIBUTE id="0485" name="TitleDate" type="date" source="entity"/>
		<WTATTRIBUTE id="0486" name="InputValues" type="text" length="1000" min="1" max="1000" source="entity"/>
		<WTATTRIBUTE id="0487" name="Icons" type="text" length="20" min="1" max="20" source="entity" language="false"/>
		<WTATTRIBUTE id="0488" name="IsMsg" type="number" source="entity"/>
<!--		<WTATTRIBUTE id="0488" name="IsMsgs" type="yesno" source="entity"/> -->
		<WTATTRIBUTE id="0489" name="Timezone" type="number" source="entity" blankrow="false">
			<WTENUM id="-12" name="GMTm12"/>
			<WTENUM id="-11" name="GMTm11"/>
			<WTENUM id="-10" name="GMTm10"/>
			<WTENUM id="-9" name="GMTm9"/>
			<WTENUM id="-8" name="GMTm8"/>
			<WTENUM id="-7" name="GMTm7"/>
			<WTENUM id="-6" name="GMTm6"/>
			<WTENUM id="-5" name="GMTm5"/>
			<WTENUM id="-4" name="GMTm4"/>
			<WTENUM id="-3" name="GMTm3"/>
			<WTENUM id="-2" name="GMTm2"/>
			<WTENUM id="-1" name="GMTm1"/>
			<WTENUM id="0" name="GMT"/>
			<WTENUM id="1" name="GMTp1"/>
			<WTENUM id="2" name="GMTp2"/>
			<WTENUM id="3" name="GMTp3"/>
			<WTENUM id="4" name="GMTp4"/>
			<WTENUM id="5" name="GMTp5"/>
			<WTENUM id="6" name="GMTp6"/>
			<WTENUM id="7" name="GMTp7"/>
			<WTENUM id="8" name="GMTp8"/>
			<WTENUM id="9" name="GMTp9"/>
			<WTENUM id="10" name="GMTp10"/>
			<WTENUM id="11" name="GMTp11"/>
			<WTENUM id="12" name="GMTp12"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0490" name="Process" type="number" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="0491" name="NewLogon" type="text" length="80" min="3" max="80" source="entity" persist="false" passthru="true"/>
		<WTATTRIBUTE id="0492" name="NewPassword" type="password" length="30" min="3" max="30" source="entity" persist="false" passthru="true"/>
		<WTATTRIBUTE id="0493" name="ReportFromDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="0494" name="ReportToDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="0495" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="0496" name="Amount" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="0497" name="OrgID" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="0498" name="InputOptions" type="text" length="1000" min="1" max="1000" source="entity" persist="false">
			<WTINPUTOPTIONS name="InputOptions" values="InputValues"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0499" name="Unit" type="text" length="40" min="1" max="40" source="entity" persist="false" passthru="true"/>

		<!--Indexes-->
		<WTINDEX name="AuthUserID">
			<WTATTRIBUTE name="AuthUserID"/>
		</WTINDEX>
		<WTINDEX name="CompanyName">
			<WTATTRIBUTE name="CompanyName"/>
		</WTINDEX>
		<WTINDEX name="MemberName">
			<WTATTRIBUTE name="NameLast"/>
			<WTATTRIBUTE name="NameFirst"/>
		</WTINDEX>
		<WTINDEX name="ReferralID">
			<WTATTRIBUTE name="ReferralID"/>
		</WTINDEX>
		<WTINDEX name="MentorID">
			<WTATTRIBUTE name="MentorID"/>
		</WTINDEX>
		<WTINDEX name="SponsorID">
			<WTATTRIBUTE name="SponsorID"/>
		</WTINDEX>
		<WTINDEX name="Sponsor2ID">
			<WTATTRIBUTE name="Sponsor2ID"/>
		</WTINDEX>
		<WTINDEX name="Sponsor3ID">
			<WTATTRIBUTE name="Sponsor3ID"/>
			<WTATTRIBUTE name="Pos"/>
		</WTINDEX>
		<WTINDEX name="GroupID">
			<WTATTRIBUTE name="GroupID"/>
		</WTINDEX>
		<WTINDEX name="Reference">
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="Reference"/>
		</WTINDEX>
		<WTINDEX name="MasterID">
			<WTATTRIBUTE name="MasterID"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Role"/>
		</WTINDEX>
		<WTINDEX name="Email">
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="Email"/>
		</WTINDEX>
		<WTINDEX name="EnrollDate">
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="EnrollDate"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Member" entity="Member" alias="me"/>
			<WTRELATIONSHIP name="Common" entity="Member" alias="me">
				<WTENTITY name="AuthUser" entity="AuthUser" alias="au">
					<WTATTRIBUTE alias="me" name="AuthUserID" relalias="au" relname="AuthUserID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="AuthUser" entity="Member" alias="me">
				<WTENTITY name="AuthUser" entity="AuthUser" alias="au">
					<WTATTRIBUTE alias="me" name="AuthUserID" relalias="au" relname="AuthUserID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="OrgMember" entity="Member" alias="me">
				<WTENTITY name="OrgMember" entity="OrgMember" alias="om" validate="false">
					<WTATTRIBUTE alias="me" name="MemberID" relalias="om" relname="MemberID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="MemberName" default="true"/>
			<WTATTRIBUTE name="CompanyName"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="Reference"/>
			<WTATTRIBUTE name="Phone1"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="MasterID"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Role" contains="true"/>
		</WTENUM>

    <WTENUM id="2" type="find">
      <WTATTRIBUTE name="MemberName" default="true"/>
      <WTATTRIBUTE name="MemberID"/>
      <WTATTRIBUTE name="EnrollDate"/>
    </WTENUM>

    <WTENUM id="3" type="find">
      <WTATTRIBUTE name="MemberName" default="true"/>
      <WTATTRIBUTE name="Email"/>
      <WTATTRIBUTE name="InitPrice" const="1"/>
      <WTATTRIBUTE name="Options2" const="1"/>
      <WTATTRIBUTE name="EnrollDate"/>
      <WTATTRIBUTE name="MemberID"/>
    </WTENUM>

    <!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="MEMBER-STATUS-PAID" value="1"/>
			<WTSYSCON name="MEMBER-STATUS-TRIAL" value="2"/>
			<WTSYSCON name="MEMBER-BILL-NONE" value="1"/>
			<WTSYSCON name="MEMBER-BILL-COMPANY" value="2"/>
			<WTSYSCON name="MEMBER-BILL-MEMBER" value="3"/>
			<WTSYSCON name="MEMBER-BILL-MASTER" value="4"/>
			<WTSYSCON name="ACCT-INDIVIDUAL" value="1"/>
			<WTSYSCON name="ACCT-BUSINESS" value="2"/>
			<WTSYSCON name="USER-MEMBER" value="41"/>
			<WTSYSCON name="USER-ACTIVE" value="1"/>
			<WTSYSCON name="USER-INACTIVE" value="2"/>
			<WTSYSCON name="TYPE-APPT" value="1" />
			<WTSYSCON name="TYPE-GOAL" value="-70" />
			<WTSYSCON name="TYPE-PROJECT" value="-75" />
			<WTSYSCON name="TYPE-TASK" value="-74" />
			<WTSYSCON name="TYPE-LEAD" value="-22" />
			<WTSYSCON name="TYPE-SALES" value="-81" />
			<WTSYSCON name="TYPE-EVENTS" value="-96" />
			<WTSYSCON name="TYPE-SERVICE" value="-701" />

			<!-- Sales Order System Constants -->
			<WTSYSCON name="STATUS-SUBMITTED" value="1"/>
			<WTSYSCON name="STATUS-INPROCESS" value="2"/>
			<WTSYSCON name="STATUS-COMPLETE" value="3"/>
			<WTSYSCON name="STATUS-CANCELLED" value="4"/>
			<WTSYSCON name="STATUS-RETURNED" value="5"/>
			<WTSYSCON name="PAYSTATUS-SUBMITTED" value="1"/>
			<WTSYSCON name="FULFILL-COURSE" value="1"/>
			<WTSYSCON name="FULFILL-ASSESSMENT" value="2"/>
			<WTSYSCON name="FULFILL-DOWNLOAD" value="3"/>
			<WTSYSCON name="FULFILL-CUSTOM" value="4"/>

      <WTSYSCON name="MSG-OFF" value="0"/>
      <WTSYSCON name="MSG-ON" value="1"/>
      <WTSYSCON name="MSG-UNSUBSCRIBE" value="2"/>

      <!-- Remove Types -->
			<WTSYSCON name="REMOVE-MENTOR" value="1"/>
			<WTSYSCON name="REMOVE-GROUP" value="2"/>
		</WTSYSCONS>
		
		<WTCONDITIONS>
			<WTCONDITION name="_IsAlertPayment"><WTCONDITION expr="CONST(contains)" value="CONST((@role, 'P'))"/></WTCONDITION>
			<WTCONDITION name="_IsAlertBackup"><WTCONDITION expr="CONST(contains)" value="CONST((@role, 'B'))"/></WTCONDITION>
			<WTCONDITION name="_NotAlertPayment"><WTCONDITION expr="CONST(not(contains)" value="CONST((@role, 'P')))"/></WTCONDITION>
			<WTCONDITION name="_NotAlertBackup"><WTCONDITION expr="CONST(not(contains)" value="CONST((@role, 'B')))"/></WTCONDITION>
		</WTCONDITIONS>

  
	</WTENTITY>

	<!--Procedures-->
	<WTPROCEDURES>
		<!--================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="NewID" datatype="number"/>
			<WTDECLARE name="AuthUserID" datatype="number"/>
			<WTSETVALUE name="Now" value="SYS(timestamp)"/>
			<WTSETVALUE name="AuthUserID" value="CONST(0)"/>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Email2)" oper="equal" value="CONST('')"/>
				<WTSETVALUE name="PARAM(Email2)" value="PARAM(Email)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UserGroup)" oper="greater" value="CONST(0)"/>
				<WTPROCEDURE name="AuthUser_Add">
					<WTPARAM name="ATTR(Logon)" direction="input" value="PARAM(NewLogon)"/>
					<WTPARAM name="ATTR(Password)" direction="input" value="PARAM(NewPassword)"/>
					<WTPARAM name="ATTR(Email)" direction="input" value="PARAM(Email)"/>
					<WTPARAM name="ATTR(NameLast)" direction="input" value="PARAM(NameLast)"/>
					<WTPARAM name="ATTR(NameFirst)" direction="input" value="PARAM(NameFirst)"/>
					<WTPARAM name="ATTR(UserGroup)" direction="input" value="PARAM(UserGroup)"/>
					<WTPARAM name="ATTR(UserStatus)" direction="input" value="PARAM(UserStatus)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="AuthUserID" direction="output"/>
				</WTPROCEDURE>			
				<WTSETVALUE name="PARAM(AuthUserID)" value="AuthUserID" null="0"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTINSERT/>
			</WTCODEGROUP>
<!--
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(MasterID)" oper="greater" value="CONST(0)"/>
				<WTPROCEDURE name="Member_CalcMasterPrice">
					<WTPARAM name="ATTR(MemberID)" direction="input" value="PARAM(MasterID)"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
-->			
			<WTSETVALUE name="NewID" value="CONST(@@Identity)"/>			
			<WTSETVALUE name="PARAM(MemberID)" value="NewID"/>
			<WTSETVALUE name="PARAM(AuthUserID)" value="AuthUserID"/>
			<WTCODEGROUP>
				<WTPROCEDURE name="Member_AddCustom">
					<WTPARAM name="ATTR(CompanyID)" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="ATTR(MemberID)" direction="input" value="NewID"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<WTPROCEDURE name="AddOrgMember"  type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true" >
		<!--==================================================================-->
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="Exists" direction="output" datatype="number"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="DeleteOrgMember" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true" >
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="Count" type="Count" style="GenerateDataProc.xsl"/>
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTDECLARE name="AuthUserID" datatype="number"/>
			<WTDECLARE name="MasterID" datatype="number"/>

			<WTCODEGROUP>
				<WTPROCEDURE name="Shortcut_DeleteItem">
					<WTPARAM name="EntityID" direction="input" value="ENTITY(Member)"/>
					<WTPARAM name="ItemID" direction="input" value="PARAM(MemberID)"/>
				</WTPROCEDURE>
				<WTPROCEDURE name="Member_FetchAuthUserID">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="AuthUserID" direction="output"/>
				</WTPROCEDURE>
<!--				
				<WTPROCEDURE name="Member_FetchMasterID">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="MasterID" direction="output"/>
				</WTPROCEDURE>
-->				
				<WTPROCEDURE name="AuthUser_Delete">
					<WTPARAM name="ATTR(AuthUserID)" direction="input" value="AuthUserID"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
				</WTPROCEDURE>
				<WTCODEGROUP>
					<WTPROCEDURE name="Member_DeleteMaster">
						<WTPARAM name="ATTR(MemberID)" direction="input" value="PARAM(MemberID)"/>
					</WTPROCEDURE>
				</WTCODEGROUP>
				<WTDELETE>
					<WTJOIN name="Member" lock="true"/>
					<WTCONDITION expr="ATTR(Member.MemberID)" oper="equal" value="PARAM(MemberID)"/>
				</WTDELETE>
				<WTPROCEDURE name="OrgMember_DeleteMembers">
					<WTPARAM name="ATTR(MemberID)" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
				</WTPROCEDURE>
<!--				
				<WTCODEGROUP>
					<WTCONDITION expr="MasterID" oper="greater" value="CONST(0)"/>
					<WTPROCEDURE name="Member_CalcMasterPrice">
						<WTPARAM name="ATTR(MemberID)" direction="input" value="MasterID"/>
					</WTPROCEDURE>
				</WTCODEGROUP>
-->				
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchAuthUserID" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="output"/>
			<WTDECLARE name="AuthUserID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="AuthUserID" value="ATTR(Member.AuthUserID)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.MemberID)" oper="equal" value="PARAM(MemberID)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(AuthUserID)" value="AuthUserID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchRef" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Reference)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="output"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="output"/>
			<WTDECLARE name="MemberID" datatype="number"/>
			<WTDECLARE name="AuthUserID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="MemberID" value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE name="AuthUserID" value="ATTR(Member.AuthUserID)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
					<WTCONDITION expr="ATTR(Member.Reference)" oper="equal" value="PARAM(Reference)" connector="and"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(MemberID)" value="MemberID" null="0"/>
				<WTSETVALUE name="PARAM(AuthUserID)" value="AuthUserID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchMasterID" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTPARAM name="ATTR(MasterID)" direction="output"/>
			<WTDECLARE name="MasterID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="MasterID" value="ATTR(Member.MasterID)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.MemberID)" oper="equal" value="PARAM(MemberID)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(MasterID)" value="MasterID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchLogon" type="Fetch" style="GenerateDataProc.xsl" template="new" nodata="true">
			<WTPARAM name="ATTR(Logon)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="output"/>
			<WTPARAM name="ATTR(Level)" direction="output"/>
			<WTPARAM name="ATTR(GroupID)" direction="output"/>
			<WTDECLARE name="MemberID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="MemberID" value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE name="Level" value="ATTR(Member.Level)"/>
					<WTATTRIBUTE name="GroupID" value="ATTR(Member.GroupID)"/>
					<WTJOIN name="AuthUser" lock="false"/>
					<WTCONDITION expr="ATTR(AuthUser.Logon)" oper="equal" value="PARAM(Logon)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(MemberID)" value="MemberID" null="0"/>
				<WTSETVALUE name="PARAM(Level)" value="Level" null="0"/>
				<WTSETVALUE name="PARAM(GroupID)" value="GroupID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindSponsor" enum="2" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(SponsorID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Member"/>
			<WTCONDITION expr="ATTR(Member.SponsorID)" oper="equal" value="PARAM(SponsorID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Status)" oper="less-equal" value="CONST(5)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindSponsor2" enum="2" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(Sponsor2ID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Member"/>
			<WTCONDITION expr="ATTR(Member.Sponsor2ID)" oper="equal" value="PARAM(Sponsor2ID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Status)" oper="less-equal" value="CONST(5)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindSponsor3" enum="2" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(Sponsor3ID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Member"/>
			<WTCONDITION expr="ATTR(Member.Sponsor3ID)" oper="equal" value="PARAM(Sponsor3ID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Status)" oper="less-equal" value="CONST(5)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="AuthUserID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="Level"/>
			<WTATTRIBUTE name="Reference"/>
			<WTATTRIBUTE name="VisitDate"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTATTRIBUTE name="Billing"/>
			<WTATTRIBUTE name="Phone1"/>
			<WTATTRIBUTE name="Phone2"/>
			<WTATTRIBUTE name="Fax"/>
			<WTATTRIBUTE name="IsCompany"/>
			<WTATTRIBUTE name="CompanyName"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Qualify"/>
			<WTATTRIBUTE name="IsIncluded"/>
			<WTATTRIBUTE name="IsMaster"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Member"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindOwner" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="AuthUserID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="Level"/>
			<WTATTRIBUTE name="Reference"/>
			<WTATTRIBUTE name="VisitDate"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTATTRIBUTE name="PaidDate"/>
			<WTATTRIBUTE name="Billing"/>
			<WTATTRIBUTE name="Phone1"/>
			<WTATTRIBUTE name="Phone2"/>
			<WTATTRIBUTE name="Fax"/>
			<WTATTRIBUTE name="IsCompany"/>
			<WTATTRIBUTE name="CompanyName"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="ReferralID"/>
			<WTATTRIBUTE name="SponsorID"/>
			<WTATTRIBUTE name="Sponsor2ID"/>
			<WTATTRIBUTE name="Sponsor3ID"/>
			<WTATTRIBUTE name="Qualify"/>
			<WTATTRIBUTE name="IsIncluded"/>
			<WTATTRIBUTE name="IsMaster"/>
			<WTATTRIBUTE name="Price"/>
			<WTATTRIBUTE name="Process"/>
			<WTATTRIBUTE name="Role"/>
			<WTATTRIBUTE name="PromoID"/>
			<WTATTRIBUTE name="BV"/>
			<WTATTRIBUTE name="QV"/>
			<WTATTRIBUTE name="BV2"/>
			<WTATTRIBUTE name="QV2"/>
			<WTATTRIBUTE name="BV3"/>
			<WTATTRIBUTE name="QV3"/>
			<WTATTRIBUTE name="BV4"/>
			<WTATTRIBUTE name="QV4"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Member"/>
			<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindOrg" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="AuthUserID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="Level"/>
			<WTATTRIBUTE name="Reference"/>
			<WTATTRIBUTE name="VisitDate"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTATTRIBUTE name="Billing"/>
			<WTATTRIBUTE name="Phone1"/>
			<WTATTRIBUTE name="Phone2"/>
			<WTATTRIBUTE name="Fax"/>
			<WTATTRIBUTE name="IsCompany"/>
			<WTATTRIBUTE name="CompanyName"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Qualify"/>
			<WTATTRIBUTE name="IsIncluded"/>
			<WTATTRIBUTE name="IsMaster"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="OrgMember"/>
			<WTCONDITION expr="CONST(om.OrgID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindMaster" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="AuthUserID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="Level"/>
			<WTATTRIBUTE name="Reference"/>
			<WTATTRIBUTE name="VisitDate"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTATTRIBUTE name="Billing"/>
			<WTATTRIBUTE name="Phone1"/>
			<WTATTRIBUTE name="Phone2"/>
			<WTATTRIBUTE name="Fax"/>
			<WTATTRIBUTE name="IsCompany"/>
			<WTATTRIBUTE name="CompanyName"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Role"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Qualify"/>
			<WTATTRIBUTE name="IsMaster"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MasterID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Member"/>
			<WTCONDITION expr="ATTR(MasterID)" oper="equal" value="PARAM(MasterID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindGroup" style="GenerateDataProc.xsl">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="AuthUserID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="Level"/>
			<WTATTRIBUTE name="Reference"/>
			<WTATTRIBUTE name="VisitDate"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTATTRIBUTE name="Billing"/>
			<WTATTRIBUTE name="Phone1"/>
			<WTATTRIBUTE name="Phone2"/>
			<WTATTRIBUTE name="Fax"/>
			<WTATTRIBUTE name="IsCompany"/>
			<WTATTRIBUTE name="CompanyName"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Role"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Qualify"/>
			<WTATTRIBUTE name="IsMaster"/>
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(GroupID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Member"/>
			<WTCONDITION expr="ATTR(Member.GroupID)" oper="equal" value="PARAM(GroupID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Status)" oper="greater" value="CONST(0)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Status)" oper="less" value="CONST(5)" connector="and"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Find" name="FindCustomer" enum="3" style="GenerateDataProc.xsl">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTBOOKMARK name=""/>
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CompanyID"/>
			<WTATTRIBUTE name="AuthUserID"/>
			<WTATTRIBUTE name="MemberName"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="Status"/>
			<WTATTRIBUTE name="Level"/>
			<WTATTRIBUTE name="Reference"/>
			<WTATTRIBUTE name="VisitDate"/>
			<WTATTRIBUTE name="EnrollDate"/>
			<WTATTRIBUTE name="Billing"/>
			<WTATTRIBUTE name="Phone1"/>
			<WTATTRIBUTE name="Phone2"/>
			<WTATTRIBUTE name="Fax"/>
			<WTATTRIBUTE name="IsCompany"/>
			<WTATTRIBUTE name="CompanyName"/>
			<WTATTRIBUTE name="GroupID"/>
			<WTATTRIBUTE name="Role"/>
			<WTATTRIBUTE name="Title"/>
			<WTATTRIBUTE name="Qualify"/>
			<WTATTRIBUTE name="IsMaster"/>
      <WTATTRIBUTE name="Price"/>
      <WTATTRIBUTE name="InitPrice"/>
      <WTATTRIBUTE name="Options2"/>
      <WTJOIN name="Member" lock="false"/>
			<WTCONDITION expr="ATTR(Member.ReferralID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Status)" oper="less-equal" value="CONST(3)" connector="and"/>
			<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)" connector="and"/>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="XML" name="XMLFind" style="GenerateDataProc.xsl" template="new" nobusn="true" nodata="true" options="true">
			<WTATTRIBUTE value="MemberID"/>
			<WTATTRIBUTE value="CompanyID"/>
			<WTATTRIBUTE value="AuthUserID"/>
			<WTATTRIBUTE value="MemberName"/>
			<WTATTRIBUTE value="Email"/>
			<WTATTRIBUTE value="Status"/>
			<WTATTRIBUTE value="Level"/>
			<WTATTRIBUTE value="Reference"/>
			<WTATTRIBUTE value="VisitDate"/>
			<WTATTRIBUTE value="EnrollDate"/>
			<WTATTRIBUTE value="Billing"/>
			<WTATTRIBUTE value="Phone1"/>
			<WTATTRIBUTE value="Phone2"/>
			<WTATTRIBUTE value="Fax"/>
			<WTATTRIBUTE value="IsCompany"/>
			<WTATTRIBUTE value="CompanyName"/>
			<WTATTRIBUTE value="GroupID"/>
			<WTATTRIBUTE value="Title"/>
			<WTATTRIBUTE value="ReferralID"/>
			<WTATTRIBUTE value="SponsorID"/>
			<WTATTRIBUTE value="Sponsor2ID"/>
			<WTATTRIBUTE value="Sponsor3ID"/>
			<WTATTRIBUTE value="Qualify"/>
			<WTATTRIBUTE value="IsIncluded"/>
			<WTATTRIBUTE value="IsMaster"/>
			<WTATTRIBUTE value="Role"/>
			<WTATTRIBUTE value="Price"/>
      <WTATTRIBUTE value="InitPrice"/>
      <WTATTRIBUTE value="Options2"/>
      <WTATTRIBUTE value="PromoID"/>
			<WTATTRIBUTE value="BV"/>
			<WTATTRIBUTE value="QV"/>
			<WTATTRIBUTE value="BV2"/>
			<WTATTRIBUTE value="QV2"/>
			<WTATTRIBUTE value="BV3"/>
			<WTATTRIBUTE value="QV3"/>
			<WTATTRIBUTE value="BV4"/>
			<WTATTRIBUTE value="QV4"/>
		</WTPROCEDURE>
		<!--==========================================================================================-->
		<WTPROCEDURE type="XML" name="XMLGenealogy" style="GenerateDataProc.xsl" template="new" nobusn="true" nodata="true" options="true">
			<WTATTRIBUTE value="MemberID"/>
			<WTATTRIBUTE value="SponsorID"/>
			<WTATTRIBUTE value="MemberName"/>
			<WTATTRIBUTE value="EnrollDate"/>
			<WTATTRIBUTE value="VisitDate"/>
			<WTATTRIBUTE value="Status"/>
			<WTATTRIBUTE value="Title"/>
			<WTATTRIBUTE value="BV">
				<WTFORMAT value="###,###,##0" />
			</WTATTRIBUTE>
			<WTATTRIBUTE value="QV">
				<WTFORMAT value="###,###,##0" />
			</WTATTRIBUTE>
			<WTATTRIBUTE value="Phone1"/>
			<WTATTRIBUTE value="Email"/>
			<WTATTRIBUTE value="Identification"/>
			<WTATTRIBUTE value="BV4"> <!-- downline count -->
				<WTFORMAT value="###,###,##0" />
			</WTATTRIBUTE>
			<WTATTRIBUTE value="BusAccts"/> <!-- sponsor team -->
			<WTATTRIBUTE value="MaxMembers"/> <!-- leg title -->
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Fetch" name="LoadAuthUser" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(Employee.AuthUserID)" direction="input"/>
			<WTPARAM name="ATTR(Employee.MemberID)" direction="output"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="CONST(@MemberID)" value="ATTR(Member.MemberID)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.AuthUserID)" oper="equal" value="PARAM(AuthUserID)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrg" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyName)"/>
					<WTATTRIBUTE value="ATTR(Member.Email)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTATTRIBUTE value="ATTR(Member.Reference)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListReferral" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(ReferralID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.NameFirst)"/>
					<WTATTRIBUTE value="ATTR(Member.NameLast)"/>
					<WTATTRIBUTE value="ATTR(Member.Status)"/>
					<WTATTRIBUTE value="ATTR(Member.Level)"/>
					<WTATTRIBUTE value="ATTR(Member.Email)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.ReferralID)" oper="equal" value="PARAM(ReferralID)"/>
					<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Member.EnrollDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListCustomers" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.NameFirst)"/>
					<WTATTRIBUTE value="ATTR(Member.NameLast)"/>
					<WTATTRIBUTE value="ATTR(Member.Status)"/>
					<WTATTRIBUTE value="ATTR(Member.Level)"/>
					<WTATTRIBUTE value="ATTR(Member.Email)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.ReferralID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Member.Status)" oper="greater-equal" value="CONST(1)" connector="and"/>
					<WTCONDITION expr="ATTR(Member.Status)" oper="less-equal" value="CONST(2)" connector="and"/>
					<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Member.EnrollDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListMentor" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(MentorID)" direction="input"/>
			<WTPARAM name="ATTR(VisitDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyID)"/>
					<WTATTRIBUTE value="ATTR(Member.NameLast)"/>
					<WTATTRIBUTE value="ATTR(Member.NameFirst)"/>
					<WTATTRIBUTE value="ATTR(Member.VisitDate)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTATTRIBUTE value="ATTR(Member.Status)"/>
					<WTATTRIBUTE value="ATTR(Member.Email)"/>
					<WTATTRIBUTE value="ATTR(Member.Options)"/>
					<WTATTRIBUTE value="ATTR(Member.Unit)"/>  <!-- Company Options -->
					<WTATTRIBUTE value="ATTR(Member.NotifyMentor)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
					<WTATTRIBUTE value="ATTR(Member.Image)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Member.MentorID)" oper="equal" value="PARAM(MentorID)"/>
					<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Member.Status)" oper="less" value="CONST(5)" connector="and"/>
					<WTORDER name="ATTR(Member.CompanyName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="Now" datatype="date"/>
			<WTDECLARE name="NewID" datatype="number"/>
			<WTSETVALUE name="Now" value="SYS(timestamp)"/>
<!--			<WTDECLARE name="OldMasterID" datatype="number"/>-->
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Email2)" oper="equal" value="CONST('')"/>
				<WTSETVALUE name="PARAM(Email2)" value="PARAM(Email)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(AuthUserID)" oper="greater" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(UserGroup)" oper="equal" value="CONST(0)" connector="and"/>
				<WTPROCEDURE name="AuthUser_Delete">
					<WTPARAM name="ATTR(AuthUserID)" direction="input" value="PARAM(AuthUserID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
				</WTPROCEDURE>
				<WTSETVALUE name="PARAM(AuthUserID)" value="CONST(0)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(AuthUserID)" oper="greater" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(UserGroup)" oper="greater" value="CONST(0)" connector="and"/>
				<WTPROCEDURE name="AuthUser_Update">
					<WTPARAM name="ATTR(AuthUserID)" direction="input" value="PARAM(AuthUserID)"/>
					<WTPARAM name="ATTR(Email)" direction="input" value="PARAM(Email)"/>
					<WTPARAM name="ATTR(NameLast)" direction="input" value="PARAM(NameLast)"/>
					<WTPARAM name="ATTR(NameFirst)" direction="input" value="PARAM(NameFirst)"/>
					<WTPARAM name="ATTR(UserGroup)" direction="input" value="PARAM(UserGroup)"/>
					<WTPARAM name="ATTR(UserStatus)" direction="input" value="PARAM(UserStatus)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(AuthUserID)" oper="equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(UserGroup)" oper="greater" value="CONST(0)" connector="and"/>
				<WTPROCEDURE name="AuthUser_Add">
					<WTPARAM name="ATTR(Logon)" direction="input" value="PARAM(NewLogon)"/>
					<WTPARAM name="ATTR(Password)" direction="input" value="PARAM(NewPassword)"/>
					<WTPARAM name="ATTR(Email)" direction="input" value="PARAM(Email)"/>
					<WTPARAM name="ATTR(NameLast)" direction="input" value="PARAM(NameLast)"/>
					<WTPARAM name="ATTR(NameFirst)" direction="input" value="PARAM(NameFirst)"/>
					<WTPARAM name="ATTR(UserGroup)" direction="input" value="PARAM(UserGroup)"/>
					<WTPARAM name="ATTR(UserStatus)" direction="input" value="PARAM(UserStatus)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="NewID" direction="output"/>
				</WTPROCEDURE>
				<WTSETVALUE name="PARAM(AuthUserID)" value="NewID" null="0"/>
			</WTCODEGROUP>
<!--			
			<WTCODEGROUP>
				<WTPROCEDURE name="Member_FetchMasterID">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SYS(userid)" direction="input" value="PARAM(UserID)"/>
					<WTPARAM name="OldMasterID" direction="output"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
-->			
			<WTCODEGROUP>
				<WTUPDATE>
					<WTJOIN name="Member" lock="true"/>
					<WTCONDITION expr="ATTR(Member.MemberID)" oper="equal" value="PARAM(MemberID)"/>
				</WTUPDATE>
			</WTCODEGROUP>
<!--			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(MasterID)" oper="greater" value="CONST(0)"/>
				<WTPROCEDURE name="Member_CalcMasterPrice">
					<WTPARAM name="ATTR(MemberID)" direction="input" value="PARAM(MasterID)"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="OldMasterID" oper="not-equal" value="PARAM(MasterID)"/>
				<WTCONDITION expr="OldMasterID" oper="greater" value="CONST(0)" connector="and"/>
				<WTPROCEDURE name="Member_CalcMasterPrice">
					<WTPARAM name="ATTR(MemberID)" direction="input" value="OldMasterID"/>
				</WTPROCEDURE>
			</WTCODEGROUP>
-->			
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE name="CalcMasterPrice" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="DeleteMaster" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE name="CheckMaster" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MasterID)" direction="input"/>
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="MemberID" direction="output" datatype="number"/>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE name="ActiveCount" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" passthru="true"/>
			<WTPARAM name="ATTR(MasterID)" direction="input" passthru="true"/>
			<WTPARAM name="MasterMembers" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="MaxCount" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MasterID)" direction="input" passthru="true"/>
			<WTPARAM name="MaxMembers" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="ExistEmail" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" passthru="true"/>
			<WTPARAM name="ATTR(Email)" direction="input" passthru="true"/>
			<WTPARAM name="MemberID" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="RefRef" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Reference)" direction="input"/>
			<WTPARAM name="ReferralID" direction="output" datatype="number"/>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportMembership" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.Status)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportNewEnrollment" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(Unit)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportTotalEnrollment" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(Unit)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportBilling" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.Billing)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportVisit" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.Amount)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportVisitStatus" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.Amount)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportAuthLog" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyName)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportMembershipDetail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportBillingDetail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(Billing)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportVisitDetail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Quantity)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyName)"/>
					<WTATTRIBUTE value="ATTR(Member.VisitDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportVisitDetailStatus" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Quantity)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyName)"/>
					<WTATTRIBUTE value="ATTR(Member.VisitDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE name="TBCount" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(VisitDate)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
		
		<!--==================================================================================================-->
		<WTPROCEDURE name="Dashboard" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(AuthUserID)" direction="input"/>
			<WTPARAM name="ATTR(VisitDate)" direction="input"/>
			<WTPARAM name="ATTR(CompanyName)" direction="input"/>  <!--Options-->
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE name="Performance" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(CompanyName)" direction="input"/>  <!--Options-->
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ListNewsLetter" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" />   <!-- NewsLetterID -->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)" />
					<WTATTRIBUTE value="ATTR(Member.Email)" />
					<WTATTRIBUTE value="ATTR(Member.NameFirst)" />
					<WTATTRIBUTE value="ATTR(Member.NameLast)" />
					<WTATTRIBUTE value="ATTR(Member.Phone1)" />
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="Genealogy" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>  <!-- (1=enroller, 2=sponsor, 3=mentor) -->
			<WTPARAM name="ATTR(Level)" direction="input"/>   <!-- number of levels (1-4) -->
			<WTPARAM name="ATTR(Title)" direction="input"/>   <!-- minimum Title -->
			<WTPARAM name="ATTR(QV)" direction="input"/>   <!-- minimum points -->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.SponsorID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTATTRIBUTE value="ATTR(Member.VisitDate)"/>
					<WTATTRIBUTE value="ATTR(Member.Status)"/>
					<WTATTRIBUTE value="ATTR(Member.Title)"/>
					<WTATTRIBUTE value="ATTR(Member.BV)"/>
					<WTATTRIBUTE value="ATTR(Member.QV)"/>
					<WTATTRIBUTE value="ATTR(Member.Phone1)"/>
					<WTATTRIBUTE value="ATTR(Member.Email)"/>
					<WTATTRIBUTE value="ATTR(Downline.Identification)"/> <!-- location (city, state) -->
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="GetSignature" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" passthru="true"/> <!-- Signature Type -->
			<WTPARAM name="ATTR(Amount)" direction="input" passthru="true"/>   <!-- Type Item ID -->
			<WTPARAM name="ATTR(Fax)" direction="input" passthru="true"/>      <!-- Language -->
			<WTPARAM name="Result" direction="output" datatype="text" length="3000"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="GetIsMsg" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListEmail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" passthru="true"/>
			<WTPARAM name="ATTR(Email)" direction="input" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.NameLast)"/>
					<WTATTRIBUTE value="ATTR(Member.NameFirst)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="RemoveMember" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true" >
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/> <!-- remove type -->
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="NewMembers" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.Identification)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="FundRaisingSummary" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.Reference)"/>
					<WTATTRIBUTE value="ATTR(Member.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="FundRaisingDetail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.CompanyName)"/>
					<WTATTRIBUTE value="ATTR(Member.EnrollDate)"/>
					<WTATTRIBUTE value="ATTR(Member.Reference)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="CustomList" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" passthru="true"/>  <!-- Report # -->
			<WTPARAM name="ATTR(Level)" direction="input" passthru="true"/>  <!-- Report Option -->
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Member.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.Status)"/>
					<WTATTRIBUTE value="ATTR(Member.Level)"/>
					<WTATTRIBUTE value="ATTR(Member.Signature)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="SearchDownline" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(SponsorID)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(CompanyName)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Level)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="100"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="CheckUpline" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(SponsorID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="TotalCustomers" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="Result" direction="output" datatype="number"/>
		</WTPROCEDURE>

	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--============================================================================================-->
		<WTWEBPAGE name="0401" header="false" footer="false" navbar="false" caption="Find" action="5" wrapper="wrapper900" page-left="10"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="125">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="RemoveID" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="OrgMemberID" datatype="number"/>

			<WTJAVASCRIPT name="AJAX.js"/>
			<WTDATATXN name="AddFolders"/>

			<!-- MODE==DESCRIPTION==============USER==PARAMS==========CALLED-BY====-->
			<!--  0  Members in the system      emp   none            navbar,0101  --> 
			<!--  1  Members for the company    org   CompanyID         navbar,2809  -->
			<!--  2  Members for an Org         org   OrgID,CompanyID   2809,0401    -->
			<!--  3  Company Members to Insert  org   OrgID,CompanyID   0401         -->
			<!-- ==================================================================-->

      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(MemberName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(0)"/>

			<WTCODEGROUP>
				<WTGETCACHE name="PARAM(OrgMemberID)" value="MEMBERID" />
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XMLFind">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="8" name="Include" type="Add">
				<!--	Refresh current list -->
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpInclude)" value="CONST(1)"/>
			</WTACTION>

<!-- Remove the selected OrgMember record (User clicks remove link) -->
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(RemoveID)" oper="greater" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="DeleteOrgMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(RemoveID)"/>
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- Clear the response buffer after removing -->			
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="0401">
						<WTPARAM name="SearchText" value="PARAM(SearchText)"/>
						<WTPARAM name="FindTypeID" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" value="PARAM(Bookmark)"/>
						<WTPARAM name="Direction" value="PARAM(Direction)"/>
						<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
						<WTPARAM name="Mode" value="PARAM(Mode)"/>
						<WTPARAM name="RemoveID" value="CONST(0)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

<!-- Load the Org object and store the CompanyID -->			
			<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
				<WTMETHOD name="Load">
					<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>	
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(Org.CompanyID)"/>		
				<WTMETHOD name="XML">
					<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(2)"/>
				</WTMETHOD>
			</WTOBJECT>

<!-- Load the Member object for searching -->
			<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)" connector="or"/>
				<WTMETHOD name="Find">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindOwner">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)" connector="or"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindOrg">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="CompanyID" direction="input" value="PARAM(OrgID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTCODEGROUP>  <!-- PB - Calculate Monthly Sales Volume Due -->
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
					<WTCUSTOM>
						For Each oItem in oMembers
						With oItem
							Purchase = CCUR(.BV2)
							Required = CCUR(.QV2)
							Variance = Required - Purchase
							If Variance &lt; 0 Then Variance = 0
							If Required &gt; 0 Then
								.Role = Left(CStr(Variance) + " " + CStr(Purchase) + " " + CStr(Required), 15)
							End If
						End With
						Next
					</WTCUSTOM>
				</WTCODEGROUP>
				<WTMETHOD name="XMLFind">
					<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
<!-- detect and add any selected members for insertion into an Org -->				
<WTCUSTOM>
					If tmpInclude = 1 Then 
						tmpCnt = 0
						Set oMember = server.CreateObject("ptsMemberUser.CMember")
						If oMember Is Nothing Then
						   DoError Err.Number, Err.Source, "Unable to Create Object - ptsMemberUser.CMember"
						Else
							For Each oMem in oMembers
								tmpID = oMem.MemberID
								If Request.Form.Item(tmpID) = "on" Then
									memberExist = 0
									memberExist = oMember.AddOrgMember ( tmpID, CLng(reqOrgID),CLng(reqSysUserID)) 
									If (memberExist = 0)Then tmpCnt = tmpCnt + 1
									If (Err.Number &lt;&gt; 0) Then DoError Err.Number, Err.Source, Err.Description End If
								End If
							Next
						End If
						Set oMember = Nothing
						DoError reqUploadError, "Include", tmpCnt &amp; " Members Included!"
					End If
</WTCUSTOM>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Folders" project="ptsFolderUser" class="CFolders">
				<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(2)"/>
				<WTMETHOD name="EnumFolderAll">
					<WTPARAM name="xmlAddFolders" direction="return" concat="true" datatype="text" />
					<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
					<WTPARAM name="GroupID" direction="input" value="CONST(0)" />
					<WTPARAM name="MemberID" direction="input" value="CONST(0)" />
					<WTPARAM name="Entity" direction="input" value="CONST(4)" />
					<WTPARAM name="ItemID" direction="input" value="CONST()" />
					<WTPARAM name="Element" direction="input" value="CONST(&quot;AddFolder&quot;)" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
				</WTMETHOD>
			</WTOBJECT>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="900" align="left"/>

				<WTFUNCTION name="ViewPerformance(id)">
          var url, win;
          var cid = document.getElementById('CompanyID').value
          url = "0445.asp?memberid=" + id
          if( cid == 14) { url = "13504.asp?memberid=" + id }
          if( cid == 17) { url = "13804.asp?memberid=" + id }
          if( cid == 20) { url = "13904.asp?memberid=" + id }
          win = window.open(url,"Performance","top=100,left=100,height=650,width=450,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>
				<WTFUNCTION name="addFolder(id)">
					var viewdrip = document.getElementById('ViewDrip').checked
					if( viewdrip == 0 ) {
						var item = document.getElementById('ItemID').value
						var url = "12502.asp?Entity=4&amp;MemberID=0&amp;FolderID=" + id + "&amp;ItemID=" + item
						sendAJAX( url );
					}
					else {
						var url = "11410.asp?folderid=" + id
						var win = window.open(url,"DripCampaign","top=100,left=100,height=400,width=600,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
						win.focus();
					}
					document.getElementById('AddFolders').value = 0;
					document.getElementById('ViewDrip').checked = 0;
					popupWindow('folderpopup',false);
				</WTFUNCTION>
				<WTFUNCTION name="popupFolder(id)">
					var x = document.getElementById('CursorX').value;
					var y = document.getElementById('CursorY').value;
					var o = document.getElementById('folderpopup');
					document.getElementById('ItemID').value = id
					if( x != 0 ) {
						o.style.left = x-50;
						o.style.top = y-50;
					}
					popupWindow('folderpopup',true);
				</WTFUNCTION>
				<WTFUNCTION name="popupWindow(e,d)">
					var obj = document.getElementById(e);
					if(d)
						obj.style.display = 'block';
					else
						obj.style.display = 'none';
				</WTFUNCTION>
				<WTFUNCTION name="InitCursor()">
					if(window.addEventListener) {
					document.body.addEventListener('mousemove',getCursorXY,false);
					}
					else if(window.attachEvent) {
					document.body.attachEvent('onmousemove',getCursorXY);
					}
				</WTFUNCTION>
				<WTFUNCTION name="getCursorXY(e)">
					document.getElementById('CursorX').value = e.pageX;
					document.getElementById('CursorY').value = e.pageY;
				</WTFUNCTION>

				<WTLOAD>
					InitCursor();
				</WTLOAD>

				<WTDIVISION id="folderpopup" style="display:none; border:solid 1px #333; position:absolute; left:100px; top:100px; z-index:1">
					<WTDIVISION style="background:blue; color:white; height=8px; padding:2px; text-align:center;">
						<WTSTATIC label="AddFolder"/>
					</WTDIVISION>
					<WTDIVISION style="background:#ddd; padding:5px;">
						<WTCOMBO col="1" name="AddFolders" datapath="/DATA/TXN/PTSADDFOLDERS/ENUM">
							<WTCHANGE>addFolder(this.options[this.selectedIndex].value);</WTCHANGE>
						</WTCOMBO>
						<WTCHECK col="1" name="ViewDrip"/>
						<WTSTATIC label="ViewDrip" fontsize="2" space="1"/>
						<WTBUTTON col="1" value="CONST(Close)" btnclass="smbutton">
							<WTCLICK>popupWindow('folderpopup',false);</WTCLICK>
						</WTBUTTON>
					</WTDIVISION>
				</WTDIVISION>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN name="ItemID" value="CONST(0)"/>
					<WTHIDDEN name="CursorX" value="CONST(0)"/>
					<WTHIDDEN name="CursorY" value="CONST(0)"/>
				</WTROW>

				<WTSTATIC label="AddFolder"/>

				<WTROW margin-bottom="6">
					  <WTTABLE col="1">
						  <WTCOLUMN width="300" align="center"/>
						  <WTCOLUMN width="600" align="left"/>
						  <WTROW>
					      <WTSTATIC col="1" align="left" class="PageHeading">
						      <WTSTATIC label="Members">
    					      <WTCONDITION expr="PARAM(Mode)" oper="less" value="CONST(2)"/>
						      </WTSTATIC>
                  <WTCODEGROUP>
    					      <WTCONDITION expr="PARAM(Mode)" oper="greater" value="CONST(1)"/>
  						      <WTSTATIC tag="IncludedMembers"/>
	  					      <WTSTATIC value="ATTR(Org.OrgName)" space="1"/>
		  				      <WTSTATIC label="Folder"/>
                  </WTCODEGROUP>
					      </WTSTATIC>
					      <WTSTATIC col="2" align="right" class="PageHeader">
                  <WTCODEGROUP>
          					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
                    <WTSTATIC label="CertLookup" space="1"><WTLINK name="3422" target="Report"/></WTSTATIC>
						        <WTSTATIC value="CONST(|)" space="1"/>
                    <WTSTATIC label="NewMember"><WTLINK name="0402" target="NewMember"/></WTSTATIC>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
          					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
						        <WTSTATIC label="ContactManager" bold="true">
							        <WTCONDITION expr="PARAM(OrgMemberID)" oper="not-equal" value="CONST(0)"/>
							        <WTLINK name="8161" target="ContactManager">
								        <WTPARAM name="MemberID" value="PARAM(OrgMemberID)"/>
								        <WTPARAM name="ContentPage" value="CONST(3)"/>
								        <WTPARAM name="Popup" value="CONST(1)"/>
							        </WTLINK>
						        </WTSTATIC>
						        <WTCODEGROUP>
							        <WTCONDITION expr="IsManager"/>
							        <WTSTATIC value="CONST(|)"/>
							        <WTSTATIC label="NewMember" bold="true">
								        <WTLINK name="0402" target="NewMember">
									        <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								        </WTLINK>
							        </WTSTATIC>
						        </WTCODEGROUP>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
          					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
                    <WTSTATIC label="IncludeMember">
						          <WTLINK name="0401" target="IncludeMember">
							          <WTPARAM name="Mode" value="CONST(3)"/>
							          <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
							          <WTPARAM name="OrgID" value="PARAM(OrgID)"/>
							          <WTPARAM name="contentpage" value="CONST(3)"/>
						          </WTLINK>
                    </WTSTATIC>
                  </WTCODEGROUP>
					      </WTSTATIC>
						  </WTROW>
					  </WTTABLE>
				</WTROW>
<!--
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
-->
        <WTCODEGROUP>
				  <WTCONDITION expr="PARAM(Mode)" oper="greater-equal" value="CONST(2)"/>
				  <WTROW margin-bottom="6">
					  <WTTABLE col="1">
						  <WTCOLUMN width="100" align="center"/>
						  <WTCOLUMN width="500" align="left"/>
						  <WTROW>
							  <WTIMAGE col="1" value="CONST(Member.gif)" align="center"/>
							  <WTSTATIC col="2" align="left" class="prompt">
								  <WTSTATIC label="MemberFindText">
									  <WTCONDITION expr="PARAM(Mode)" oper="less" value="CONST(2)"/>
								  </WTSTATIC>
								  <WTSTATIC label="FolderMembersText">
									  <WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
								  </WTSTATIC>
								  <WTSTATIC label="IncludeMembersText">
									  <WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
								  </WTSTATIC>
							  </WTSTATIC>
						  </WTROW>
					  </WTTABLE>
				  </WTROW>
				  <WTROW margin-bottom="6">
					  <WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				  </WTROW>
        </WTCODEGROUP>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Members.FindTypeID)" translate="true">
						<WTOPTION id="419" label="MemberName"/>
						<WTOPTION id="401" label="MemberID"/>
						<WTOPTION id="438" label="EnrollDate"/>
						<WTOPTION id="430" label="Email"/>
						<WTOPTION id="432" label="Phone1"/>
						<WTOPTION id="470" label="GroupID"/>
						<WTOPTION id="435" label="Status"/>
						<WTOPTION id="471" label="Role"/>
						<WTOPTION id="416" label="CompanyName"/>
						<WTOPTION id="452" label="Reference"/>
						<WTOPTION id="455" label="MasterID"/>
					</WTCOMBO>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
          <WTSTATIC col="1">
            <WTCODEGROUP>
              <WTIMAGE value="CONST(preview.gif)" imgalign="absmiddle">
                <WTLINK name="0465" target="LogonLookup"/>
              </WTIMAGE>
              <WTSTATIC label="LogonLookup">
                <WTLINK name="0465" target="LogonLookup"/>
              </WTSTATIC>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
				
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
					<WTBUTTON col="1" action="8" align="center" value="CONST(Include)"/>
					<WTBUTTON col="1" value="CONST(Close)">
						<WTCLICK>window.parent.opener.location.reload();window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTSTATIC label="shoppingcart"/>
				<WTSTATIC label="genealogy"/>
				<WTSTATIC label="mentoring"/>
				<WTSTATIC label="finances"/>
				<WTSTATIC label="notes"/>
				<WTSTATIC label="sales"/>
				<WTSTATIC label="website"/>
				<WTSTATIC label="logon"/>
				<WTSTATIC label="supporttickets"/>
				<WTSTATIC label="FastTrack"/>
				<WTSTATIC label="enroll"/>
				<WTSTATIC label="newcustomer"/>
				<WTSTATIC label="activity"/>
				<WTSTATIC label="profiles"/>
				<WTSTATIC label="orgcontact"/>

				<WTROW>
					<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)" connector="or"/>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Member">
						<WTCOLUMN width="10" align="left" valign="top" label="#"/>
						<WTCOLUMN width="3" align="left" valign="top"/>
						<WTCOLUMN width="25" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="27" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Status"/>
						<WTCOLUMN width="25" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">0475
								<WTSTATIC value="DATA(Member.MemberID)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Member.ReferralID)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Member.ReferralID)" fontcolor="gray"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
									<WTCHECK name="&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
<!--                
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Qualify)" oper="equal" value="CONST(1)"/>
									<WTIMAGE value="CONST(SymbolRestricted1.gif)" alt="Edit" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
-->                
								<WTSTATIC value="DATA(Member.MemberName)"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="0403">
											<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
											<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
											<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Window.gif)" imgalign="absmiddle">
										<WTLINK name="MemberHome" return="false" target="_blank">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Member.Title)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(Member.Email)"/>
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
									<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Qualify)" oper="less-equal" value="CONST(1)"/>
										<WTIMAGE value="CONST(Status-1.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Qualify)" oper="greater" value="CONST(1)"/>
										<WTIMAGE value="CONST(Status1.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
								</WTCODEGROUP>

								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Member.Status)" oper="less-equal" value="SYSCON(MEMBER-TRIAL)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Member.Level)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(IsMaster)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(FastTrack.gif)" alt="FastTrack" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(PromoID)" oper="not-equal" value="CONST(0)"/>
										<WTIMAGE value="CONST(OverDraft.gif)" alt="PromoID" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(IsMaster)" oper="equal" value="CONST(0)"/>
										<WTCONDITION expr="DATA(MemberID)" oper="equal" value="DATA(GroupID)" connector="and"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(GrpAdmin.gif)" alt="GrpAdmin" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTSTATIC value="CONST(B)" fontcolor="red">
										<WTCONDITION expr="DATA(Qualify)" oper="less-equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC value="CONST(B)" fontcolor="green">
										<WTCONDITION expr="DATA(Qualify)" oper="greater" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC value="CONST(P)" fontcolor="red">
										<WTCONDITION expr="DATA(IsIncluded)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC value="CONST(P)" fontcolor="green">
										<WTCONDITION expr="DATA(IsIncluded)" oper="not-equal" value="CONST(0)"/>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(2)"/>
								<WTCODEGROUP>
									<WTSTATIC col="6" align="right">
<!--
										<WTCODEGROUP>
											<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
												<WTLINK name="0443" return="false" target="new">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
-->										
<!--
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(Genealogysm.gif)" alt="genealogy" imgalign="absmiddle">
												<WTLINK name="0470" return="false" target="Genealogy">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
-->
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(RIGHT180)"/>
											<WTIMAGE value="CONST(genealogy.gif)" alt="ViewFriends" imgalign="absmiddle">
												<WTLINK name="14101" target="Friends">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(news.gif)" alt="ViewBroadcasts" imgalign="absmiddle">
												<WTLINK name="14401" target="Broadcasts">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
												</WTLINK>
											</WTIMAGE>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(ad.gif)" alt="ViewAds" imgalign="absmiddle">
												<WTLINK name="14301" target="Ads">
													<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(PEOPLEEDGE)"/>
                      <WTIMAGE value="CONST(profile.gif)" alt="profiles" imgalign="absmiddle">
                        <WTLINK name="13711" target="Profiles">
                          <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        </WTLINK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
                      <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
                      <WTIMAGE value="CONST(certificate16.gif)" alt="GiftCertificates" imgalign="absmiddle">
                        <WTLINK name="15901" target="GiftCertificates">
                          <WTPARAM name="MemberID" value="DATA(MemberID)"/>
                        </WTLINK>
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
											<WTCONDITION expr="_IsFinances"/>
											<WTCONDITION expr="IsEmployee" connector="or"/>
											<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
											<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
											<WTSTATIC space="1"/>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsAlertPayment"/>
												<WTIMAGE value="CONST(financesm_a.gif)" alt="finances" imgalign="absmiddle">
													<WTLINK name="0475" return="false" target="Finances">
														<WTPARAM name="MemberID" value="DATA(MemberID)"/>
														<WTPARAM name="Code" value="CONST(4)"/>
														<WTPARAM name="ContentPage" value="CONST(3)"/>
														<WTPARAM name="Popup" value="CONST(1)"/>
													</WTLINK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_NotAlertPayment"/>
												<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
													<WTLINK name="0475" return="false" target="Finances">
														<WTPARAM name="MemberID" value="DATA(MemberID)"/>
														<WTPARAM name="Code" value="CONST(4)"/>
														<WTPARAM name="ContentPage" value="CONST(3)"/>
														<WTPARAM name="Popup" value="CONST(1)"/>
													</WTLINK>
												</WTIMAGE>
											</WTCODEGROUP>
										</WTCODEGROUP>

										<WTCODEGROUP>
											<WTCONDITION expr="_IsShopping"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(ShoppingCart.gif)" alt="shoppingcart" imgalign="absmiddle">
												<WTLINK name="5250" class="PageHeadingLink" return="false" target="ShoppingCart">
													<WTPARAM name="C" value="DATA(CompanyID)"/>
													<WTPARAM name="Me" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>

										<WTCODEGROUP>
											<WTCONDITION expr="_IsGenealogy"/>
											<WTCONDITION expr="IsEmployee" connector="or"/>
											<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
											<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(genealogy.gif)" alt="genealogy" imgalign="absmiddle">
												<WTLINK name="0470" class="PageHeadingLink" return="false" target="Genealogy">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>

										<WTCODEGROUP>
											<WTCONDITION expr="_IsSupportTicket"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(supportticketsm.gif)" alt="supporttickets" imgalign="absmiddle">
												<WTLINK name="9506" return="false" target="SupportTickets">
													<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
													<WTPARAM name="T" value="ENTITY(Member)"/>
													<WTPARAM name="I" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>

										<WTCODEGROUP>
											<WTCONDITION expr="_IsMentoring"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(mentorsm.gif)" alt="mentoring" imgalign="absmiddle">
												<WTLINK name="0410" class="PageHeadingLink" return="false" target="Mentor">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(OrgMemberID)" oper="not-equal" value="CONST(0)"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(orgcontact.gif)" alt="orgcontact" imgalign="absmiddle">
												<WTLINK name="8163a" class="PageHeadingLink" return="false" target="ContactManager">
													<WTPARAM name="OrgMemberID" value="PARAM(OrgMemberID)"/>
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsCalendar"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(calendarsm.gif)" alt="calendar" imgalign="absmiddle">
												<WTLINK name="Calendar" class="PageHeadingLink" target="Calendar">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsGoals"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(goalsm.gif)" alt="goals" imgalign="absmiddle">
												<WTLINK name="7001" class="PageHeadingLink" target="Goals">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsAssessments"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Assessmentsm.gif)" alt="assessments" imgalign="absmiddle">
											<WTLINK name="3411" class="PageHeadingLink" target="Assessments">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsClasses"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Classsm.gif)" alt="classes" imgalign="absmiddle">
											<WTLINK name="1311" class="PageHeadingLink" target="Courses">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
										<WTSTATIC space="1"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Member.Status)" oper="equal" value="SYSCON(MEMBER-FREE)"/>
									<WTSTATIC col="6"/>
								</WTCODEGROUP>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
								<WTSTATIC col="6" bold="true">
									<WTSTATIC label="Remove">
										<WTLINK name="0401" skipreturn="true">
											<WTPARAM name="SearchText" value="PARAM(SearchText)"/>
											<WTPARAM name="FindTypeID" value="PARAM(FindTypeID)"/>
											<WTPARAM name="Bookmark" value="PARAM(Bookmark)"/>
											<WTPARAM name="Direction" value="PARAM(Direction)"/>
											<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
											<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
											<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
											<WTPARAM name="Mode" value="PARAM(Mode)"/>								
											<WTPARAM name="RemoveID" value="DATA(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
							</WTCODEGROUP>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Member.CompanyID)" fontcolor="gray">
									<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC fontcolor="gray">
									<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(1)"/>
									<WTSTATIC value="DATA(Member.SponsorID)">
										<WTCONDITION expr="DATA(Member.SponsorID)" oper="not-equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Member.Sponsor2ID)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(Member.Sponsor2ID)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Member.Sponsor3ID)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(Member.Sponsor3ID)"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2"/>
							<WTSTATIC col="3" valign="top" fontcolor="gray">
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@enrolldate&quot;/&gt;)" space="1"/>
								<WTSTATIC value="DATA(Member.Billing)"/>
							</WTSTATIC>
							<WTSTATIC col="4" merge="2" fontcolor="purple">
                <WTSTATIC value="DATA(Member.Reference)" space="2">
                  <WTCONDITION expr="ATTR(Member.CompanyID)" oper="not-equal" value="SYSCON(GCR)"/>
                  <WTCONDITION expr="IsEmployee" connector="or"/>
                  <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
                </WTSTATIC>
                <WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@visitdate&quot;/&gt;))" space="2">
									<WTCONDITION expr="DATA(VisitDate)" oper="not-equal" value="CONST('')"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Member.GroupID)"/>
							</WTSTATIC>
							
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(2)"/>
								<WTSTATIC col="6" align="right">
                  <WTCODEGROUP>
                    <WTCONDITION expr="_IsPerformance"/>
                    <WTCONDITION expr="DATA(CompanyID)" oper="equal" value="SYSCON(LEGACYMAX)" connector="or"/>
                    <WTCONDITION expr="DATA(CompanyID)" oper="equal" value="SYSCON(GCR)" connector="or"/>
                    <WTCONDITION expr="DATA(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)" connector="or"/>
                    <WTIMAGE value="CONST(performance.gif)" alt="performance" imgalign="absmiddle">
                      <WTLINK name="ViewPerformance(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(notessm.gif)" alt="notes" imgalign="absmiddle">
											<WTLINK name="9005" return="false" target="Notes">
												<WTPARAM name="OwnerType" value="ENTITY(Member)"/>
												<WTPARAM name="OwnerID" value="DATA(MemberID)"/>
												<WTPARAM name="Title" value="DATA(MemberName)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="CONST(count(/DATA/TXN/PTSADDFOLDERS/ENUM))" oper="greater" value="CONST(1)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(FolderAdd.gif)" alt="AddFolder" imgalign="absmiddle">
											<WTLINK name="popupFolder(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true"/>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(5)"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(11)" connector="and"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(12)" connector="and"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(SymbolAdd.gif)" alt="enroll" imgalign="absmiddle">
											<WTLINK name="Enroll" return="false" target="_blank">
												<WTPARAM name="C" value="DATA(CompanyID)"/>
												<WTPARAM name="M" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(SymbolAdd.gif)" alt="enroll" imgalign="absmiddle">
											<WTLINK name="Enroll" return="false" target="_blank">
												<WTPARAM name="C" value="DATA(CompanyID)"/>
												<WTPARAM name="M" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(SymbolAdd.gif)" alt="enroll" imgalign="absmiddle">
											<WTLINK name="Enroll" return="false" target="_blank">
												<WTPARAM name="C" value="DATA(CompanyID)"/>
												<WTPARAM name="M" value="DATA(MemberID)"/>
												<WTPARAM name="Retail" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(12)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(SymbolAdd.gif)" alt="enroll" imgalign="absmiddle">
											<WTLINK name="13201" return="false" target="_blank">
												<WTPARAM name="M" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(TELLALLMOBILE)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(SymbolAdd.gif)" alt="newcustomer" imgalign="absmiddle">
											<WTLINK name="14903" return="false" target="_blank">
												<WTPARAM name="M" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsActivityTracker"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Activity.gif)" alt="activity" imgalign="absmiddle">
											<WTLINK name="11711" return="false" target="_blank">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Reportsm.gif)" alt="CustomReports" imgalign="absmiddle">
											<WTLINK name="Reports" class="PageHeadingLink" target="Reports">
												<WTPARAM name="M" value="DATA(MemberID)"/>
												<WTPARAM name="C" value="DATA(CompanyID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsSuspect"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Contactsm.gif)" alt="viewcontacts" imgalign="absmiddle">
											<WTLINK name="8161" class="PageHeadingLink" target="Sales">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsSales"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Prospectsm.gif)" alt="viewprospects" imgalign="absmiddle">
											<WTLINK name="8101" class="PageHeadingLink" target="Sales">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsService"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Customersm.gif)" alt="viewcustomers" imgalign="absmiddle">
											<WTLINK name="8151" class="PageHeadingLink" target="Sales">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(logon.gif)" alt="logon" imgalign="absmiddle">
											<WTLINK name="0104" return="false" target="Logon">
												<WTPARAM name="AuthUserID" value="DATA(AuthUserID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(2)"/>
								<WTSTATIC col="6"/>
							</WTCODEGROUP>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" value="DATA(Role)"/>
							<WTSTATIC col="3" merge="4" fontcolor="gray">
								<WTSTATIC value="CONST(M:)"/>
								<WTSTATIC value="DATA(Member.Phone1)" space="2"/>
								<WTSTATIC value="CONST(D:)"/>
								<WTSTATIC value="DATA(Member.Phone2)" space="2"/>
								<WTSTATIC value="CONST(N:)"/>
								<WTSTATIC value="DATA(Member.Fax)" space="2"/>
								<WTSTATIC value="DATA(Member.CompanyName)">
									<WTCONDITION expr="DATA(IsCompany)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(3)"/>
					<WTBUTTON col="1" action="8" align="center" value="CONST(Include)"/>
					<WTBUTTON col="1" value="CONST(Close)">
						<WTCLICK>window.parent.opener.location.reload();window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0402" caption="New Member" navbar="false" aspstyle="GenerateWebASP.xsl" 
		xslstyle="GenerateWebXSLAdd.xsl" focus="false">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>         <!-- Pass in from other page -->
			<WTPARAM name="MasterID" datatype="number"/>		  <!-- Pass in from other page -->
			<WTPARAM name="MemberAdded" datatype="text"/>		  <!-- Pass in from other page -->
			<WTPARAM name="GroupID" datatype="number"/>	          <!-- Pass in from other page -->
			<WTPARAM name="Refer" datatype="text"/>		          <!-- Pass in from other page -->
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Try" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="A" datatype="number"/>
			<WTPARAM name="G" datatype="number"/>
			<WTPARAM name="AR" datatype="number"/>				<!-- Affiliate Referral Required -->

			<WTINCLUDE name="Company.asp"/>
			<WTINCLUDE name="CompanyHeader.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(A)" oper="greater" value="CONST(0)" />
				<WTSETCACHE name="A" value="PARAM(A)" />
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)" />
				<WTSETCACHE name="GroupID" value="PARAM(G)" />
				<WTSETATTRIBUTE name="PARAM(GroupID)" value="PARAM(G)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(A)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(A)" value="A" />
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(A)" oper="equal" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="PARAM(A)" value="CONST(0)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(GroupID)" value="GROUPID" />
			</WTCODEGROUP>

			<WTSUB name="LoadCompany">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="PARAM(Try)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Coption.TrialDays)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(A)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Len(.Data))" oper="less" value="CONST(10)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
						<WTMETHOD name="Load" />
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			<WTSUB function="ActiveMembers(prmCompanyID, prmMasterID)">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ActiveCount">
						<WTPARAM name="CompanyID" direction="input" value="CONST(prmCompanyID)"/>
						<WTPARAM name="MasterID" direction="input" value="CONST(prmMasterID)"/>
						<WTPARAM name="tmpActiveCount" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(tmpActiveCount))" oper="less" value="CONST(0)"/>
						<WTERROR number="10111" message="Oops, You have exceeded the maximum number of allowed active members."/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(AR)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(AR)" oper="not-equal" value="CONST(0)" connector="or"/>
					<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
						<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTCALLSUB name="GetCompany(reqCompanyID)"/>
						<!-- Set Group Header -->
						<WTCALLSUB name="SetCompanyGrpHeader reqCompanyID, reqGroupID, reqSysLanguage">
							<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="SYSCON(ACCT-INDIVIDUAL)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(1)"/>
					<WTCALLSUB name="LoadCompany"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberAdded)" oper="not-equal" value="&quot;&quot;"/>
<WTCUSTOM>
				DoError 1, "", reqMemberAdded + " Successfully Added!"
</WTCUSTOM>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="2" name="Next" type="Continue">
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="CONST(tmpLevel)" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Status)" oper="less" value="CONST(4)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="PARAM(Status)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="SYSCON(MEMBER-PAID)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="SYSCON(MEMBER-TRIAL)">
						<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Status)" value="SYSCON(MEMBER-FREE)">
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(4)"/>
				</WTSETATTRIBUTE>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="SYSCON(ACCT-INDIVIDUAL)"/>
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-PAID)" connector="and" paren="start"/>
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="SYSCON(ACCT-BUSINESS)" connector="or" paren="end"/>
					<WTCALLSUB name="ActiveMembers reqCompanyID, reqMasterID"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTSETATTRIBUTE name="PARAM(IsAgree)" value="FORM(IsAgree)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
						<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
						<WTCALLSUB name="LoadCompany"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTRETURN>
						<WTLINK name="0412" return="false">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
							<WTPARAM name="MasterID" value="PARAM(MasterID)"/>
							<WTPARAM name="Membership" value="PARAM(Membership)"/>
							<WTPARAM name="Status" value="PARAM(Status)"/>
							<WTPARAM name="Level" value="CONST(tmpLevel)"/>
							<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
							<WTPARAM name="Refer" value="PARAM(Refer)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTLINK name="0000" return="false"/>
				</WTRETURN>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="10" align="right"/>
				<WTCOLUMN width="20" align="left"/>
				<WTCOLUMN width="720" align="left"/>

				<WTFUNCTION name="ShowTry()">
				for (i = 0; i &lt; Member.Status.length; i++) {
					if (Member.Status[i].checked) {
						if (Member.Status[i].value == 4) 
							document.getElementById('TryMe').style.display = 'none';
						else
							document.getElementById('TryMe').style.display = '';
					}	
				}             
			    </WTFUNCTION>  
				<WTLOAD>
					ShowTry();
				</WTLOAD>
			    
				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(AR)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(A)" oper="equal" value="CONST(0)" connector="and"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" merge="3" label="AffiliateRequired" align="left" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(AR)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(AR)" oper="not-equal" value="CONST(0)" connector="or"/>
					<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)" connector="and"/>

					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="3" label="Enrollment" align="left" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(headerdivider)"/>
					</WTROW>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="2">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC bold="true">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
									<WTSTATIC value="ATTR(Member.NameLast)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTROW>
						<WTHIDDEN value="PARAM(CompanyID)"/>
					</WTROW>
<!--					
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="_IsUpgrade"/>
						<WTBUTTON col="1" merge="3" value="CONST(MembershipInfo)" align="center">
							<WTCLICK>var URL="0419.asp?CompanyID=" + document.getElementById('CompanyID').value; window.open( URL);</WTCLICK>
						</WTBUTTON>
					</WTROW>
-->
					<WTROW>
						<WTCONDITION expr="PARAM(MasterID)" oper="equal" value="SYSCON(NO)"/>
						<WTCONDITION expr="ATTR(Company.IsBusAcct)" oper="not-equal" value="SYSCON(NO)" connector="and"/>
						<WTSTATIC col="1"/>
						<WTRADIO col="2" merge="2" group="Membership" name="1" datapathx="/DATA/PARAM[@membership=1]" label="Individual" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="SYSCON(NO)"/>
						<WTCONDITION expr="ATTR(Company.IsBusAcct)" oper="equal" value="SYSCON(NO)" connector="or"/>
						<WTHIDDEN value="PARAM(Membership)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Company.PaidName)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="2"/>
						<WTRADIO col="3" group="Status" name="1" datapathx="/DATA/PARAM[@status=1]">
							<WTCLICK>ShowTry()</WTCLICK>
						</WTRADIO>
						<WTSTATIC col="3" label="PaidMembership" prespace="false">
							<WTCONDITION expr="ATTR(Company.PaidName)" oper="not-exist"/>
						</WTSTATIC>
						<WTSTATIC col="3" value="ATTR(Company.PaidName)" prespace="false">
							<WTCONDITION expr="ATTR(Company.PaidName)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC col="3">
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC value="ATTR(Company.Price)" bold="true"/>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Company.PaidName2)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="2"/>
						<WTRADIO col="3" group="Status" name="2" datapathx="/DATA/PARAM[@status=2]">
							<WTCLICK>ShowTry()</WTCLICK>
						</WTRADIO>
						<WTSTATIC col="3" value="ATTR(Company.PaidName2)" prespace="false"/>
						<WTSTATIC col="3">
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC value="ATTR(Company.Price2)" bold="true"/>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Company.PaidName3)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="2"/>
						<WTRADIO col="3" group="Status" name="3" datapathx="/DATA/PARAM[@status=3]">
							<WTCLICK>ShowTry()</WTCLICK>
						</WTRADIO>
						<WTSTATIC col="3" value="ATTR(Company.PaidName3)" prespace="false"/>
						<WTSTATIC col="3">
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC value="ATTR(Company.Price3)" bold="true"/>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Company.IsFree)" oper="not-equal" value="SYSCON(NO)"/>
						<WTSTATIC col="1" merge="2"/>
						<WTSTATIC col="3">
							<WTCODEGROUP>
								<WTRADIO group="Status" name="4" datapathx="/DATA/PARAM[@status=4]">
									<WTCLICK>ShowTry()</WTCLICK>
								</WTRADIO>
							</WTCODEGROUP>
							<WTSTATIC label="FreeMembership">
								<WTCONDITION expr="ATTR(Company.FreeName)" oper="not-exist"/>
							</WTSTATIC>
							<WTSTATIC value="ATTR(Company.FreeName)">
								<WTCONDITION expr="ATTR(Company.FreeName)" oper="not-equal" value="CONST('')"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Company.TrialDays)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW id="TryMe">
							<WTSTATIC col="1" merge="2"/>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(Try)" label="Try"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="ATTR(Company.TrialDays)" space="1" bold="true"/>
								<WTSTATIC label="days"/>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MasterID)" oper="equal" value="SYSCON(NO)"/>
						<WTCONDITION expr="ATTR(Company.IsBusAcct)" oper="not-equal" value="SYSCON(NO)" connector="and"/>
						<WTROW margin-top="6" margin-bottom="3">
							<WTSTATIC col="1"/>
							<WTRADIO col="2" merge="2" group="Membership" name="2" datapathx="/DATA/PARAM[@membership=2]" label="BusinessMembership"/>
							<WTSTATIC col="2">
								<WTSTATIC value="CONST(()"/>
								<WTSTATIC value="ATTR(Company.BusPrice)" bold="true"/>
								<WTSTATIC value="CONST())"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" merge="2"/>
							<WTSTATIC col="3" label="IncludedAccounts"/>
							<WTSTATIC col="3">
								<WTSTATIC value="CONST(()"/>
								<WTSTATIC value="ATTR(Company.BusAccts)" bold="true"/>
								<WTSTATIC value="CONST())"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" merge="2"/>
							<WTSTATIC col="3" label="AdditionalAccount"/>
							<WTSTATIC col="3">
								<WTSTATIC value="CONST(()"/>
								<WTSTATIC value="ATTR(Company.BusAcctPrice)" bold="true"/>
								<WTSTATIC value="CONST())"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2"/>
							<WTSTATIC col="3" label="CertifyAccountText"/>
						</WTROW>
					</WTCODEGROUP>
				
					<WTCODEGROUP>				
<!--					<WTCONDITION expr="IsAnonymous"/>-->
						<WTROW margin-top="12" margin-bottom="12">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
						</WTROW>
						
						<WTROW margin-top="6">
							<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" label="IsAgree" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC bold="true">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
									<WTSTATIC value="ATTR(Member.NameLast)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="2" value="CONST(Continue)" align="center">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCONDITION expr="NotAnonymous"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" action="3" value="CONST(Cancel)" align="center">
							<WTCONDITION expr="IsAnonymous"/>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="0403" contentpage="true" wrapper="wrapper800"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="125">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="ParentID" datatype="number"/>
      <WTPARAM name="BillingID" datatype="number"/>
      <WTPARAM name="PayID" datatype="number"/>
      <WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="RefName" datatype="text"/>
			<WTPARAM name="Options" datatype="text"/>
			<WTPARAM name="MemberOptions" datatype="text"/>
			<WTPARAM name="Identify" datatype="number"/>
			<WTPARAM name="UploadImageFile" datatype="text"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="VisitDate" datatype="date"/>
			<WTPARAM name="AuthUserID" datatype="number"/>
			<WTPARAM name="Extra" datatype="number"/>
			<WTPARAM name="IsMsg" datatype="number"/>
			<WTPARAM name="FaceBook" datatype="text"/>
			<WTPARAM name="Twitter" datatype="text"/>
			<WTPARAM name="Google" datatype="text"/>
			<WTPARAM name="Pinterest" datatype="text"/>
			<WTPARAM name="Tumblr" datatype="text"/>
			<WTPARAM name="LinkedIn" datatype="text"/>
			<WTPARAM name="MySpace" datatype="text"/>
			<WTPARAM name="Skype" datatype="text"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="SponsorID" datatype="number"/>
			<WTPARAM name="Binary" datatype="number"/>
      <WTPARAM name="ShowQualify" datatype="number"/>
      <WTPARAM name="Wallet" datatype="number"/>

      <WTPARAM name="FastTrack" datatype="number"/>
			<WTPARAM name="Backups" datatype="number"/>
			<WTPARAM name="Money" datatype="number"/>
			<WTPARAM name="University" datatype="number"/>
			<WTPARAM name="PV" datatype="text"/>
			<WTPARAM name="BV" datatype="text"/>

			<WTPARAM name="Products" datatype="text"/>
			<WTPARAM name="SponsorName" datatype="text"/>
      <WTPARAM name="Token" datatype="text"/>
      <WTPARAM name="BillingMethod" datatype="text"/>
      <WTPARAM name="PayoutMethod" datatype="text"/>
      <WTPARAM name="Member2FA" datatype="number"/>

      <WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="Products.asp"/>
			<WTINCLUDE name="Binary.asp"/>
      <WTINCLUDE name="Languages.asp"/>
      <WTINCLUDE name="Billing.asp"/>
      <WTINCLUDE name="BillingPayout.asp"/>
      <WTINCLUDE name="GCRWallet.asp"/>

      <WTDATATXN name="Languages"/>

<!-- TEST GATrack
			<WTPARAM name="Order" datatype="text"/>
			<WTTRACK acct="SYS(GAA)" order="PARAM(Order)"/>
			<WTTRACK acct="SYS(CGAA)"/>
			<WTSETATTRIBUTE name="PARAM(Order)" value="CONST(&quot;1;2;3;4;5;6;7;8:10;11;12;13;14;15:20;21;22;23;24;25&quot;)"/>
-->

<!-- Used By Menu Bar -->
			<WTSETATTRIBUTE name="CONST(tmpUserGroup)" value="CONST(0)"/>
			<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="CONST(0)"/>
<!--			<WTSETATTRIBUTE name="CONST(tmpIsMaster)" value="CONST(0)"/>-->

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadImageFile)" oper="not-equal" value="&quot;&quot;"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(Image)" value="PARAM(UploadImageFile)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB function="ActiveMembers(prmCompanyID, prmMasterID)">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ActiveCount">
						<WTPARAM name="CompanyID" direction="input" value="CONST(prmCompanyID)"/>
						<WTPARAM name="MasterID" direction="input" value="CONST(prmMasterID)"/>
						<WTPARAM name="tmpActiveCount" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(tmpActiveCount))" oper="less" value="CONST(0)"/>
						<WTERROR number="10111" message="Oops, You have exceeded the maximum number of allowed active members."/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateMember">
        <WTSETATTRIBUTE name="CONST(ConsumerID)" value="CONST(0)"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="PARAM(VisitDate)" value="ATTR(VisitDate)"/>
					<WTSETATTRIBUTE name="PARAM(AuthUserID)" value="ATTR(AuthUserID)"/>
					<WTSETATTRIBUTE name="CONST(tmpUserGroup)" value="ATTR(UserGroup)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="ATTR(IsDiscount)"/>
<!--					<WTSETATTRIBUTE name="CONST(tmpIsMaster)" value="ATTR(IsMaster)"/>-->
					<WTSETATTRIBUTE name="CONST(oldStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(oldReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(oldIsRemoved)" value="ATTR(IsRemoved)"/>
					<WTSETATTRIBUTE name="CONST(oldSponsorID)" value="ATTR(SponsorID)"/>
          <WTSETATTRIBUTE name="CONST(oldPromoID)" value="ATTR(PromoID)"/>
          <WTSETATTRIBUTE name="CONST(oldEmail)" value="ATTR(Email)"/>
          <WTSETATTRIBUTE name="CONST(oldSponsorID)" value="ATTR(SponsorID)"/>
          <!--					<WTSETATTRIBUTE name="CONST(tmpTaxID)" value="ATTR(TaxID)"/>-->

          <WTSETATTRIBUTES/>
          
          <WTSETATTRIBUTE name="CONST(ConsumerID)" value="ATTR(SponsorID)">
            <WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTCONDITION expr="ATTR(SponsorID)" oper="not-equal" value="CONST(oldSponsorID)" connector="and"/>
          </WTSETATTRIBUTE>
          <!--
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(TaxID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(TaxID)" value="CONST(tmpTaxID)">
							<WTCONDITION expr="ATTR(TaxID)" oper="equal" value="CONST(&quot;xxx-xx-&quot; + Right(.TaxID,4))"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
-->
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
            <WTCONDITION expr="CONST(oldEmail)" oper="not-equal" value="CONST(.Email)" connector="and"/>
            <WTCUSTOM>
              result = GCRWallet_UpdateEmail( oldEmail, .Email )
              If result &lt;&gt; "ok" Then
                .Email = oldEmail
                Response.write result
              End If
            </WTCUSTOM>
          </WTCODEGROUP>
          
					<WTSETATTRIBUTE name="CONST(newStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(newTitle)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(newReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(newIsRemoved)" value="ATTR(IsRemoved)"/>
					<WTSETATTRIBUTE name="CONST(newSponsorID)" value="ATTR(SponsorID)"/>
					<WTSETATTRIBUTE name="PARAM(SponsorID)" value="ATTR(SponsorID)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(newSponsorID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(newSponsorID)" oper="not-equal" value="CONST(oldSponsorID)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="SYSCON(MEMBER-PAID)" connector="and"/>
						<WTCALLSUB name="ActiveMembers .CompanyID, .MasterID"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Member.EndDate)" oper="equal" value="CONST(&quot;0&quot;)"/>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-INACTIVE)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(Member.EndDate)" value="SYS(Now)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Len(.Signature))" oper="less" value="CONST(8)"/>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
						<WTCALLSUB name=".Options2 = SetBinary( .Options2, reqBinary )"/>
					</WTCODEGROUP>
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)" paren="start"/>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)" connector="or" paren="end"/>
						<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(Member.Level)" value="CONST(1)"/>
					</WTCODEGROUP>
-->
<WTCODEGROUP>
<WTCONDITION expr="IsSocNetPublic"/>
<WTCUSTOM>
	.SocNet = "FB;" + reqFaceBook + ":" + "TW;" + reqTwitter + ":" + "GO;" + reqGoogle + ":" + "PI;" + reqPinterest + ":" + "TU;" + reqTumblr + ":" + "LI;" + reqLinkedIn + ":" + "MS;" + reqMySpace + ":" + "SK;" + reqSkype
</WTCUSTOM>
</WTCODEGROUP>

					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(newTitle)" oper="not-equal" value="CONST(oldTitle)" connector="and"/>
						<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
							<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="PARAM(MemberID)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(newTitle)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTOBJECT>
					</WTCODEGROUP>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(PromoID)" oper="not-equal" value="CONST(oldPromoID)" connector="and"/>
<WTCUSTOM>
						LogMemberNote reqMemberID, "OVERDRAFT PROTECTION CHANGE: (" + .PromoID + ") " 
</WTCUSTOM>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(ConsumerID)" oper="not-equal" value="CONST(0)" connector="and"/>
          <WTMETHOD name="Load">
            <WTPARAM name="ConsumerID" direction="input" value="CONST(ConsumerID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(AffiliateID)" value="PARAM(MemberID)"/>
          <WTMETHOD name="Save">
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
        </WTOBJECT>


        <!-- If no errors and IsGenealogy, Process changes to the status, title and referralID -->
<!--
				<WTOBJECT name="Downline" project="ptsDownlineUser" class="CDownline">
	 				<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(InStr(reqMemberOptions,&quot;o&quot;))" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="UpdateTitle">
						<WTCONDITION expr="CONST(newTitle)" oper="not-equal" value="CONST(oldTitle)"/>
						<WTCONDITION expr="CONST(oldReferralID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ParentID" direction="input" value="CONST(oldReferralID)"/>
						<WTPARAM name="ChildID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Old" direction="input" value="CONST(oldTitle)"/>
						<WTPARAM name="Title" direction="input" value="CONST(newTitle)"/>
						<WTPARAM name="result" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="UpdateStatus">
						<WTCONDITION expr="CONST(newStatus)" oper="not-equal" value="CONST(oldStatus)"/>
						<WTCONDITION expr="CONST(oldReferralID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ParentID" direction="input" value="CONST(oldReferralID)"/>
						<WTPARAM name="ChildID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Old" direction="input" value="CONST(oldStatus)"/>
						<WTPARAM name="Status" direction="input" value="CONST(newStatus)"/>
						<WTPARAM name="result" direction="return" datatype="number"/>
					</WTMETHOD>
-->					
					<!-- This will remove the removed member from all downlines -->
<!--					
					<WTMETHOD name="UpdateStatus">
						<WTCONDITION expr="CONST(oldIsRemoved)" oper="equal" value="CONST(&quot;0&quot;)"/>
						<WTCONDITION expr="CONST(newIsRemoved)" oper="equal" value="CONST(&quot;1&quot;)" connector="and"/>
						<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ParentID" direction="input" value="PARAM(ParentID)"/>
						<WTPARAM name="ChildID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Old" direction="input" value="CONST(0)"/>
						<WTPARAM name="Status" direction="input" value="CONST(99)"/>
						<WTPARAM name="result" direction="return" datatype="number"/>
					</WTMETHOD>
-->					
					<!-- This will add the removed member back to all downlines -->
<!--					
					<WTMETHOD name="Build">
						<WTCONDITION expr="CONST(oldIsRemoved)" oper="equal" value="CONST(&quot;1&quot;)"/>
						<WTCONDITION expr="CONST(newIsRemoved)" oper="equal" value="CONST(&quot;0&quot;)" connector="and"/>
						<WTCONDITION expr="CONST(oldReferralID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ParentID" direction="input" value="CONST(oldReferralID)"/>
						<WTPARAM name="ChildID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="result" direction="return" datatype="number"/>
					</WTMETHOD>
-->					
					<!-- This will move the member under the new parent -->
<!--					
					<WTMETHOD name="Build">
						<WTCONDITION expr="CONST(newReferralID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(newReferralID)" oper="not-equal" value="CONST(oldReferralID)" connector="and" paren="start"/>
						<WTCONDITION expr="CONST(reqActionCode)" oper="equal" value="CONST(10)" connector="or" paren="end"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ParentID" direction="input" value="CONST(newReferralID)"/>
						<WTPARAM name="ChildID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
-->					
			</WTSUB>

			<WTSUB name="LoadBilling">
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(1)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(Is2FA(reqSysUserID))"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="NotEmployee"/>
            <WTCONDITION expr="ATTR(CompanyID)" oper="not-equal" value="CONST(CSTR(reqSysCompanyID))" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)" connector="and"/>
            <WTSETATTRIBUTE name="PARAM(Binary)" value="CONST(-1)"/>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpOptions2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="PARAM(PV)" value="ATTR(BV)"/>
					<WTSETATTRIBUTE name="PARAM(BV)" value="ATTR(QV)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LIFETIME)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)"/>
					</WTCODEGROUP>
<!--          
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(PB49)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Junior Pak&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Partner Pak&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;102&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Senior Pak&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;103&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GFTGLOBAL)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Silver Pack&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Gold Pack&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;102&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Platinum Pack&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;103&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
-->          
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LEGACYMAX)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Silver Pack&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;104&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Gold Pack&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;105&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Diamond Pack #1&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;106&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Diamond Pack #2&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;107&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Diamond Pack #3&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;108&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Monthly Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;113&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Quartlerly Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;114&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Monthly Triple Diamond Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;115&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Quartlerly Triple Diamond Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;116&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Monthly Blue Diamond Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;117&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Quartlerly Blue Diamond Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;118&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Monthly Presidential Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;119&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Quartlerly Presidential Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;120&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot; Quartlerly Trucker Autoship&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;121&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(&quot; Coins: &quot; + .Referral)">
              <WTCONDITION expr="IsEmployee"/>
              <WTCONDITION expr="ATTR(Referral)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
            </WTSETATTRIBUTE>
<!--
            <WTSETATTRIBUTE name="PARAM(Wallet)" value="CONST(1)">
              <WTCONDITION expr="ATTR(Reference)" oper="equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
-->       
<!--            
            <WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Bronze&quot;)">
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;203&quot;))" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Silver&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;204&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Gold&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;205&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Miner&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;206&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Prospector&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;207&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Claim Staker&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;208&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
-->          
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(FREELOYALTY)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(TELLALLMOBILE)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;1GB&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;111&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;3GB&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;112&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;5GB&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;113&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Unlimited GB&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;114&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
            <WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
              <WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Donation&quot;)">
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Personal&quot;)">
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;201&quot;))" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Personal2&quot;)">
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;202&quot;))" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
              <WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Beginner&quot;)">
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Basic&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;102&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Products)" value="CONST(reqProducts + &quot;Pro&quot;)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;103&quot;))" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
          </WTCODEGROUP>

          <!--
					<WTSETATTRIBUTE name="ATTR(TaxID)" value="CONST(&quot;xxx-xx-&quot; + Right(.TaxID,4))">
						<WTCONDITION expr="ATTR(TaxID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
-->
          <WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
          <WTSETATTRIBUTE name="PARAM(PayID)" value="ATTR(PayID)"/>
          <WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="PARAM(MemberOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="PARAM(VisitDate)" value="ATTR(VisitDate)"/>
					<WTSETATTRIBUTE name="PARAM(AuthUserID)" value="ATTR(AuthUserID)"/>
					<WTSETATTRIBUTE name="CONST(tmpUserGroup)" value="ATTR(UserGroup)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="ATTR(IsDiscount)"/>
<!--					<WTSETATTRIBUTE name="CONST(tmpIsMaster)" value="ATTR(IsMaster)"/>-->
					<WTSETATTRIBUTE name="PARAM(SponsorID)" value="ATTR(SponsorID)"/>
					<WTSETATTRIBUTE name="PARAM(IsMsg)" value="ATTR(IsMsg)"/>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)">
						<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="ATTR(GroupID)"/>
					</WTSETATTRIBUTE>
<WTCODEGROUP>
<WTCONDITION expr="IsSocNetPublic"/>
<WTCUSTOM>
	aSocNets = split(.SocNet, ":")
	total = UBOUND(aSocNets)
	For x = 0 to total
	aSocNet = split(aSocNets(x), ";")
	Select Case aSocNet(0)
	Case "FB": reqFaceBook = aSocNet(1)
	Case "TW": reqTwitter = aSocNet(1)
	Case "GO": reqGoogle = aSocNet(1)
	Case "PI": reqPinterest = aSocNet(1)
	Case "TU": reqTumblr = aSocNet(1)
	Case "LI": reqLinkedIn = aSocNet(1)
	Case "MS": reqMySpace = aSocNet(1)
	Case "SK": reqSkype = aSocNet(1)
	End Select
	Next
</WTCUSTOM>
</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(ReferralID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="ATTR(ReferralID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(SponsorName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					</WTCODEGROUP>
				</WTOBJECT>
        <WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
          <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(PayID)" oper="not-equal" value="CONST(0)" connector="or"/>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
            <WTMETHOD name="Load">
              <WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
              <WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
              <WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
              <WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTCUSTOM>
              reqBillingMethod = BillingPayment(oBilling)
              reqBillingMethod = Replace( reqBillingMethod, "Charged:[", "")
              reqBillingMethod = Replace( reqBillingMethod, "]", "")
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(PayID)" oper="not-equal" value="CONST(0)"/>
            <WTMETHOD name="Load">
              <WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
              <WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
              <WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
              <WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            </WTSETATTRIBUTE>
            <WTCUSTOM>
              reqPayoutMethod = BillingPayout(oBilling)
              reqPayoutMethod = Replace( reqPayoutMethod, "Pay:[", "")
              reqPayoutMethod = Replace( reqPayoutMethod, "]", "")
            </WTCUSTOM>
          </WTCODEGROUP>
        </WTOBJECT>
        <WTOBJECT name="Govid" project="ptsGovidUser" class="CGovid">
					<WTMETHOD name="FetchMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(GNumber)" value="CONST(&quot;xxxxxx&quot; + Right(.GNumber, 4))">
						<WTCONDITION expr="ATTR(GNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGovid" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
<!--
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(RefName)" value="ATTR(RefName)"/>
				</WTOBJECT>
-->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(RefName)" value="ATTR(RefName)"/>
					<WTSETATTRIBUTE name="PARAM(Identify)" value="ATTR(Identify)"/>
					<WTSETATTRIBUTE name="CONST(xmlLanguages)" value="CONST(LanguagesXML(.Languages, 1))">
						<WTCONDITION expr="ATTR(Languages)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
						<WTCUSTOM>
							Downlines = .TBPage
							If InStr(Downlines, "B" ) &gt; 0 Then reqBinary = 1
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpInputOptions)" oper="not-equal" value="CONST(&quot;&quot;)"/>
<WTCUSTOM>
	Set oInputOptions = server.CreateObject("wtSystem.CInputOptions")
	With oInputOptions
	.Load tmpInputOptions
	If reqSysUserGroup &lt;= 23 Then
					tmpDisplayRows = .DisplayRows(0)
				Else
					tmpDisplayRows = .DisplayRows(1)
				End If
			End With	
			Set oInputOptions = Nothing
			reqExtra = 100 + (tmpDisplayRows * 25 )
			If reqExtra &gt; 550 Then reqExtra = 550
</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="less-equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
					<WTSETCACHE name="SYS(MenuBarState)" value="SYS(MenuBarState)"/>
					<WTSETATTRIBUTE name="PARAM(MemberOptions)" value="CONST(reqMemberOptions + reqOptions)"/>
				</WTOBJECT>
				<WTOBJECT name="Titles" project="ptsTitleUser" class="CTitles">
					<WTCONDITION expr="IsTitles"/>
					<WTCONDITION expr="IsEmployee" connector="or"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlTitles" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
          <WTCALLSUB name="reqBinary = GetBinary( tmpOptions2 )">
            <WTCONDITION expr="PARAM(Binary)" oper="greater" value="CONST(0)"/>
          </WTCALLSUB>
<!--
				<WTOBJECT name="LeadCampaigns" project="ptsLeadCampaignUser" class="CLeadCampaigns">
					<WTMETHOD name="EnumPresent">
						<WTPARAM name="xmlLeadCampaigns" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Grp" direction="input" value="PARAM(GroupID)" />
						<WTPARAM name="GroupID1" direction="input" value="CONST(tmpGroupID1)" />
						<WTPARAM name="GroupID2" direction="input" value="CONST(tmpGroupID2)" />
						<WTPARAM name="GroupID3" direction="input" value="CONST(tmpGroupID3)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()"/>
						<WTPARAM name="Element" direction="input" value="CONST()"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
-->				
<!--				<WTCALLSUB name="LoadBilling"/>-->
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="9" name="UpdateExit" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Delete">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- If no errors and IsGenealogy, Process changes to the status, title and referralID -->
				<WTOBJECT name="Downline" project="ptsDownlineUser" class="CDownline">
	 				<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(ParentID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(InStr(reqMemberOptions,&quot;o&quot;))" oper="not-equal" value="CONST(0)" connector="and"/>
					<!-- This will remove the deleted member from all downlines -->
					<WTMETHOD name="UpdateStatus">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ParentID" direction="input" value="PARAM(ParentID)"/>
						<WTPARAM name="ChildID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Old" direction="input" value="CONST(0)"/>
						<WTPARAM name="Status" direction="input" value="CONST(99)"/>
						<WTPARAM name="result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Delete">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
<!--
				<WTCALLSUB name="LoadBilling">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
-->
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
<!--
			<WTACTION id="5" name="Billing" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadBilling">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
-->
			<WTACTION id="6" name="UploadImage" type="Upload">
				<WTCALLSUB name="UpdateMember"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETCACHE name="MEMBERID" value="PARAM(MemberID)"/>
					<WTSETCACHE name="CONTENTPAGE" value="PARAM(contentpage)"/>
					<WTSETCACHE name="POPUP" value="PARAM(Popup)"/>
					<WTRETURN>
						<WTLINK name="0425" return="false">
							<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
						</WTLINK>
					</WTRETURN>			
				</WTCODEGROUP>
			</WTACTION>
<!--
			<WTACTION id="7" name="AddBilling" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
-->
			<WTACTION id="8" name="ChangeStatus" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadBilling">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="0414" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="12" name="CreditBilling" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(5)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="13" name="MoveDownline" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(204)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(SponsorID)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="14" name="EditGovid" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadBilling">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="10903" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="15" name="PayPalPayment" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(17)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="16" name="Edit16" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTRETURN>
					<WTLINK name="4910" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="Opt" value="CONST(4)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

      <WTACTION id="17" name="CoinWallet" type="Update">
        <WTCALLSUB name="UpdateMember"/>
        <WTCUSTOM>
          Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
          tmpURL = "http://www.gcrmarketing.com/GCRWalletCreate.asp?M=" + CStr(reqMemberID)
          oHTTP.open "GET", tmpURL
          oHTTP.send
          Set oHTTP = Nothing
        </WTCUSTOM>
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>

      <WTACTION id="18" name="DisableWallet" type="Update">
        <WTCALLSUB name="UpdateMember"/>
        <WTCUSTOM>
          Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
          tmpURL = "http://www.gcrmarketing.com/GCRWalletDisable.asp?M=" + CStr(reqMemberID)
          oHTTP.open "GET", tmpURL
          oHTTP.send
          Set oHTTP = Nothing
        </WTCUSTOM>
        <WTCALLSUB name="LoadMember"/>
      </WTACTION>


      <!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="640" align="left"/>

				<WTFUNCTION name="EditExtra()">
					var url, win, height;
					url = "0455.asp?companyid=" + document.getElementById('CompanyID').value + "&amp;memberid=" + document.getElementById('MemberID').value
					height = document.getElementById('Extra').value
		            win = window.open(url,"ExtraInfo","top=100,left=100,height=" + height + ",width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="EditBVQV()">
					var url, win, height;
					url = "0459.asp?memberid=" + document.getElementById('MemberID').value
					win = window.open(url,"ExtraInfo","top=100,left=100,height=300,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewForms()">
					var url, win;
					url = "9311.asp?companyid=" + document.getElementById('CompanyID').value + "&amp;memberid=" + document.getElementById('MemberID').value
		            win = window.open(url,"Forms","top=100,left=100,height=300,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewTitles()">
					var url, win;
					url = "5711.asp?memberid=" + document.getElementById('MemberID').value
		            win = window.open(url,"Titles","top=100,left=100,height=300,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewCampaign()">
				var id = document.getElementById('WebsiteID').value;
				if( id != 0 )
				{
					var url, win;
					var member = document.getElementById('MemberID').value;
					url = "pp.asp?p=" + id + "&amp;m=" + member + "&amp;preview=1"
					win = window.open(url,'Presentation');
					win.focus();
				}
			    </WTFUNCTION>  
				<WTFUNCTION name="ViewDownlines()">
					var url, win;
					url = "5404.asp?memberid=" + document.getElementById('MemberID').value
		            win = window.open(url,"Teams","top=100,left=100,height=200,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewIncome(id)">
					var url, win;
					url = "0491.asp?memberid=" + id
					win = window.open(url,"Income","top=100,left=100,height=275,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewSponsorTeams(id)">
					var url, win, company;
					company = document.getElementById('CompanyID').value
					url = "0471.asp?memberid=" + id + "&amp;companyid=" + company
					if( company == 9 ) { url = url + "&amp;s2=1" }
				win = window.open(url,"Teams","top=100,left=100,height=200,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
				win.focus();
			</WTFUNCTION>
        <WTFUNCTION name="ViewDashboard(id)">
          var url, win, cid;
          cid = document.getElementById('CompanyID').value
          if( cid == 14) { url = "13504.asp?memberid=" + id }
          if( cid == 17) { url = "13804.asp?memberid=" + id }
          if( cid == 20) { url = "13904.asp?memberid=" + id }
          win = window.open(url,"Dashboard","top=100,left=100,height=650,width=450,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>
        <WTFUNCTION name="ViewWalletInfo(id)">
          var url, win;
          url = "WalletInfo.asp?memberid=" + id 
          win = window.open(url,"WalletInfo","top=100,left=100,height=425,width=650,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>

        <WTSTATIC label="CreditCard"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Cash"/>
				<WTSTATIC label="NoPay"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Check"/>
				<WTSTATIC label="NoComm"/>
				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>

				<WTSTATIC label="GType1"/>
				<WTSTATIC label="GType2"/>
				<WTSTATIC label="GType3"/>
				<WTSTATIC label="GType4"/>
				<WTSTATIC label="GType5"/>
				<WTSTATIC label="GType6"/>
				<WTSTATIC label="GType7"/>
				<WTSTATIC label="GType8"/>
				<WTSTATIC label="GType9"/>
				<WTSTATIC label="GType10"/>
				<WTSTATIC label="GType11"/>
				<WTSTATIC label="GType12"/>

				<WTTAB name="MemberTab">
					<WTITEM label="ViewContact" width="70"><WTLINK name="JAVA(ShowTab('TabContact',1))"/></WTITEM>
					<WTITEM label="ViewStatus" width="70"><WTLINK name="JAVA(ShowTab('TabStatus',1))"/></WTITEM>
					<WTITEM label="ViewBilling" width="65">
						<WTCONDITION expr="IsPayments"/>
						<WTCONDITION expr="IsEmployee" connector="or"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
<!--						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="SYSCON(MEMBER-FREE)" connector="or"/>-->
						<WTLINK name="JAVA(ShowTab('TabBilling',1))"/>
					</WTITEM>
					<WTITEM label="Notes" width="65">
						<WTLINK name="JAVA(ShowTab('TabNotes',1))"/>
					</WTITEM>
					<WTITEM label="Msgs" width="80">
            <WTCONDITION expr="PARAM(IsMsg)" oper="equal" value="SYSCON(MSG-ON)"/>
            <WTLINK name="JAVA(ShowTab('TabMsgs',1))"/>
					</WTITEM>
					<WTITEM label="ViewAccess" width="70">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabAccess',1))"/>
					</WTITEM>
					<WTITEM label="ViewGroup" width="70">
<!--						<WTCONDITION expr="IsEmployee"/>-->
						<WTLINK name="JAVA(ShowTab('TabGroup',1))"/>
					</WTITEM>
					<WTITEM label="ViewFolders" width="70">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabFolders',1))"/>
					</WTITEM>
					<!--					
					<WTITEM label="ViewBusiness" width="70">
						<WTCONDITION expr="IsEmployee"/>
						<WTLINK name="JAVA(ShowTab('TabBusiness',1))"/>
					</WTITEM>
-->					
				</WTTAB>

				<WTFUNCTION name="ShowTab(tab, shw)">
					document.getElementById('TabStatus').style.display = 'none';
					document.getElementById('TabBilling').style.display = 'none';
					document.getElementById('TabNotes').style.display = 'none';
					document.getElementById('TabMsgs').style.display = 'none';
					document.getElementById('TabContact').style.display = 'none';
					document.getElementById('TabAccess').style.display = 'none';
					document.getElementById('TabGroup').style.display = 'none';
					//document.getElementById('TabBusiness').style.display = 'none';
					document.getElementById('TabFolders').style.display = 'none';
					document.getElementById(tab).style.display = '';
					if (shw > 0) {
					content = window.document.getElementById('Email2');
					if(content)
					content.scrollIntoView();
					}
					if ( tab == 'TabContact' ) {
					var src = document.getElementById('AddressFrame').src
					if (src.indexOf("3711.") &lt; 0 ) {
							var id = document.getElementById('MemberID').value
							var companyid = document.getElementById('CompanyID').value
							src = '3711.asp?OwnerType=4&amp;OwnerID=' + id + '&amp;Companyid=' + companyid
							document.getElementById('AddressFrame').src = src
						}	
					}	
					if ( tab == 'TabNotes' ) {
						var src = document.getElementById('NotesFrame').src
						if (src.indexOf("9011.") &lt; 0 ) {
							var id = document.getElementById('MemberID').value
							var title = document.getElementById('MemberName').value
							src = '9011.asp?Height=250&amp;OwnerType=4&amp;OwnerID=' + id + '&amp;Title=' + title
							document.getElementById('NotesFrame').src = src
						}	
					}	
					if ( tab == 'TabMsgs' ) {
						var src = document.getElementById('MsgsFrame').src
						if (src.indexOf("9701.") &lt; 0 ) {
							var id = document.getElementById('MemberID').value
							src = '9701.asp?Height=250&amp;OwnerType=4&amp;OwnerID=' + id
							document.getElementById('MsgsFrame').src = src
						}
					}
					if ( tab == 'TabFolders' ) {
						var obj = document.getElementById('FoldersFrame')
						var src = obj.src
						if (src.indexOf("12511") &lt; 0 ) {
							var mid = document.getElementById('MemberID').value
							src = '12511.asp?entity=4&amp;popup=1&amp;itemid=' + mid + '&amp;memberid=0'
							obj.src = src
						}
					}
				</WTFUNCTION>  
				<WTLOAD>
					ShowTab('TabContact',0);
				</WTLOAD>

				<WTMENU name="MemberMenu" type="bar" menuwidth="120">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTITEM label="Personal">
						<WTIMAGE name="MyInfo.gif"/>
						<WTITEM label="Home"><WTCONDITION expr="PARAM(contentpage)" oper="equal" value="CONST(0)"/><WTLINK name="0404" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/></WTLINK></WTITEM>
						<WTITEM label="Icons"><WTLINK name="0431" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Resources"><WTLINK name="9304" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="GroupID" value="PARAM(GroupID)"/><WTPARAM name="GrpCompanyID" value="PARAM(CompanyID)"/></WTLINK></WTITEM>
						<WTITEM label="CustomReports"><WTLINK name="Reports" target="Reports" nodata="true"><WTPARAM name="M" value="PARAM(MemberID)"/><WTPARAM name="C" value="PARAM(CompanyID)"/></WTLINK></WTITEM>
						<WTITEM label="ExpenseManager"><WTLINK name="6401"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="Performance"><WTLINK name="0445" nodata="true" target="Performance"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Mentoring"><WTLINK name="0410" nodata="true" target="Mentoring"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Genealogy"><WTLINK name="0470" nodata="true" target="Genealogy"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Goals"><WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Calendar"><WTLINK name="Calendar" nodata="true" target="blank"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Projects"><WTLINK name="7501" nodata="true"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="SupportTickets"><WTLINK name="9506" nodata="true" target="SupportTickets">
              <WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
              <WTPARAM name="T" value="ENTITY(Member)"/><WTPARAM name="I" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Identification"><WTCONDITION expr="PARAM(Identify)" oper="not-equal" value="CONST(0)"/><WTLINK name="0426" nodata="true" target="Identify"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Referrals"><WTLINK name="0408" nodata="true"><WTPARAM name="ReferralID" value="PARAM(MemberID)"/><WTPARAM name="contentpage" value="PARAM(contentpage)"/></WTLINK></WTITEM>
						<WTITEM label="Ads"><WTLINK name="14311" nodata="true" target="Ads"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/></WTLINK></WTITEM>
						<WTITEM label="Broadcasts"><WTLINK name="14401" nodata="true" target="Broadcasts"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/></WTLINK></WTITEM>
						<!--						<WTITEM label="MasterMembers"><WTCONDITION expr="CONST(tmpIsMaster)" oper="not-equal" value="CONST(0)"/><WTLINK name="0411" nodata="true" target="MasterMembers"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MasterID" value="PARAM(MemberID)"/></WTLINK></WTITEM>-->
					</WTITEM>
					<WTITEM label="Finance">
						<WTIMAGE name="Finance.gif"/>
						<WTITEM label="SalesOrders"><WTLINK name="0475" nodata="true" target="Finances"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(1)"/><WTPARAM name="ContentPage" value="CONST(3)"/><WTPARAM name="Popup" value="CONST(1)"/></WTLINK></WTITEM>
						<WTITEM label="Payments"><WTLINK name="0475" nodata="true" target="Finances"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(2)"/><WTPARAM name="ContentPage" value="CONST(3)"/><WTPARAM name="Popup" value="CONST(1)"/></WTLINK></WTITEM>
						<WTITEM label="Bonuses"><WTLINK name="0475" nodata="true" target="Finances"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(3)"/><WTPARAM name="ContentPage" value="CONST(3)"/><WTPARAM name="Popup" value="CONST(1)"/></WTLINK></WTITEM>
<!--						<WTITEM label="Payouts"><WTLINK name="0475" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(4)"/></WTLINK></WTITEM>-->
						<WTITEM label="Customers"><WTLINK name="0448" nodata="true" target="Customers"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="Billing"><WTLINK name="1011" nodata="true"><WTPARAM name="OwnerType" value="ENTITY(Member)"/><WTPARAM name="OwnerID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="AutoShip"><WTLINK name="0433" nodata="true" target="AutoShip"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="DebtManager"><WTLINK name="10201" nodata="true" target="DebtMgr"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Sales">
						<WTIMAGE name="Prospect.gif"/>
						<WTITEM label="LeadManager"><WTLINK name="8161" nodata="true" target="blank"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="contentpage" value="CONST(3)"/><WTPARAM name="popup" value="CONST(1)"/></WTLINK></WTITEM>
						<WTITEM label="SalesSystem"><WTLINK name="8101" nodata="true" target="blank"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="contentpage" value="CONST(3)"/><WTPARAM name="popup" value="CONST(1)"/></WTLINK></WTITEM>
						<WTITEM label="Service"><WTLINK name="8151" nodata="true" target="blank"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="contentpage" value="CONST(3)"/><WTPARAM name="popup" value="CONST(1)"/></WTLINK></WTITEM>
						<WTITEM label="PartyPlans"><WTLINK name="2511" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Training">
						<WTIMAGE name="Catalog.gif"/>
						<WTITEM label="Classes"><WTLINK name="1311" nodata="true" target="Classes"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="CertReport"><WTLINK name="3411" nodata="true" target="CertReport"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="TrainingBuddy"><WTLINK name="0440" nodata="true" target="Buddy"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="VisitDate" value="PARAM(VisitDate)"/><WTPARAM name="ContentPage" value="CONST(3)"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Tools">
						<WTIMAGE name="Tools.gif"/>
						<WTITEM label="ResetLogon"><WTCONDITION expr="CONST(tmpUserGroup)" oper="not-equal" value="CONST(0)"/><WTLINK name="0104" nodata="true"><WTPARAM name="contentpage" value="PARAM(contentpage)"/><WTPARAM name="AuthUserID" value="PARAM(AuthUserID)"/></WTLINK></WTITEM>
						<WTITEM label="ViewLogon"><WTCONDITION expr="IsEmployee"/><WTCONDITION expr="CONST(tmpUserGroup)" oper="not-equal" value="CONST(0)" connector="and"/><WTLINK name="0113" nodata="true"><WTPARAM name="contentpage" value="PARAM(contentpage)"/><WTPARAM name="AuthUserID" value="PARAM(AuthUserID)"/></WTLINK></WTITEM>
						<WTITEM label="IPs"><WTCONDITION expr="CONST(tmpUserGroup)" oper="not-equal" value="CONST(0)"/><WTLINK name="7111" nodata="true"><WTPARAM name="AuthUserID" value="PARAM(AuthUserID)"/><WTPARAM name="contentpage" value="PARAM(contentpage)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="Assign"><WTLINK name="8101" nodata="true" target="Assign"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="AssignID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="ImportCustomers"><WTLINK name="8116" nodata="true" target="Import"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="ExportCustomers"><WTLINK name="8117" nodata="true" target="Export"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="EnrollAgree"><WTLINK name="joinr" nodata="true" target="Confirm"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSTATIC col="1" merge="2" align="right">
						<WTCODEGROUP><WTSTARTMENU name="MemberMenu" type="bar"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="ATTR(Member.MemberName)"/>
					<WTHIDDEN value="PARAM(Extra)"/>
					<WTHIDDEN value="PARAM(ParentID)"/>
					<WTHIDDEN value="PARAM(MemberOptions)"/>
          <WTHIDDEN value="PARAM(Token)"/>
        </WTROW>

				<WTROW>
					<WTIMAGE col="1" value="CONST(Member.gif)" class="PageHeader" align="center"/>
					<WTSTATIC col="2" align="left" valign="center" class="PageHeading">
						<WTSTATIC value="CONST(#)"/>
						<WTSTATIC value="ATTR(Member.MemberID)"/>
						<WTSTATIC value="CONST(-)"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>

            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(Member.Title)" oper="not-equal" value="CONST(0)"/>
              <WTSTATIC space="1"/>
              <WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
            </WTCODEGROUP>

            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LEGACYMAX)"/>
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)" connector="or"/>
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)" connector="or"/>
              <WTSTATIC space="1"/>
              <WTIMAGE value="CONST(performance.gif)" alt="performance" imgalign="absmiddle">
                <WTLINK name="ViewDashboard(&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;)" click="true" />
              </WTIMAGE>
            </WTCODEGROUP>

            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
              <WTCODEGROUP>
                <WTSTATIC space="1"/>
                <WTIMAGE value="CONST(gcr32.gif)" alt="WalletInfo" path="Company/17" imgalign="absmiddle">
                  <WTLINK name="ViewWalletInfo(&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;)" click="true" />
                </WTIMAGE>
              </WTCODEGROUP>
            </WTCODEGROUP>

            <WTCODEGROUP>
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Shortcut.gif)">
								<WTCONDITION expr="_IsShortcuts"/>
								<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
									<WTPARAM name="EntityID" value="ENTITY(Member)"/>
									<WTPARAM name="ItemID" value="ATTR(Member.MemberID)"/>
									<WTPARAM name="Name" value="ATTR(Member.CompanyName)" clean="true"/>
									<WTPARAM name="URL" value="SYS(PageURL)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
								<WTLINK name="Tutorial" target="Tutorial">
									<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-PROFILE)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
									<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Member.IsCompany)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC value="ATTR(Member.CompanyName)"/>
						</WTSTATIC>
						<WTSTATIC newline="1"/>
						<WTSTATIC fontsize="2" fontcolor="purple">
							<WTSTATIC tag="VisitDate" value="ATTR(Member.VisitDate)" newline="1"/>
							<WTSTATIC tag="EnrollDate" value="ATTR(Member.EnrollDate)" space="3"/>
							<WTSTATIC tag="PaidDate" value="ATTR(Member.PaidDate)">
								<WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC fontsize="2" fontcolor="blue">
							<WTSTATIC newline="1"/>
							<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@pv,'/',/DATA/PARAM/@bv)&quot;/&gt;))" space="1"/>
							<WTSTATIC value="PARAM(Products)">
								<WTCONDITION expr="PARAM(Products)" oper="not-equal" value="CONST('')"/>
							</WTSTATIC>
            </WTSTATIC>
						<WTSTATIC fontsize="2">
							<WTCONDITION expr="PARAM(ShowQualify)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC label="NotBonusQualified" fontcolor="red">
								<WTCONDITION expr="ATTR(Member.Qualify)" oper="less-equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="BonusQualified" fontcolor="green">
								<WTCONDITION expr="ATTR(Member.Qualify)" oper="greater" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC space="1"/>
							<WTSTATIC value="CONST(/)" space="1"/>
							<WTSTATIC label="NotPayoutQualified" fontcolor="red">
								<WTCONDITION expr="ATTR(Member.IsIncluded)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC label="PayoutQualified" fontcolor="green">
								<WTCONDITION expr="ATTR(Member.IsIncluded)" oper="not-equal" value="CONST(0)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTSTATIC label="ViewFriends"/>
				<WTSTATIC label="ViewBroadcasts"/>
				<WTSTATIC label="ViewAds"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="left">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(12)"/>
							<WTIMAGE value="CONST(genealogy.gif)" alt="ViewFriends">
								<WTLINK name="14101" target="Friends">
									<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(news.gif)" alt="ViewBroadcasts">
								<WTLINK name="14401" target="Broadcasts">
									<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
									<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(ad.gif)" alt="ViewAds">
								<WTLINK name="14311" target="Ads">
									<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
									<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
					<WTBUTTON col="2" action="1" value="CONST(Update)" align="right" btnclass="smbutton">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="2" action="9" value="CONST(UpdateExit)" align="right" btnclass="smbutton">
						<WTCONDITION expr="IsActive"/>
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)" align="right" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
					</WTBUTTON>
					<WTBUTTON col="2" value="CONST(Close)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="IsEmployee"/>
					<WTSTATIC col="1" tag="CompanyID"/>
					<WTTEXT col="2" value="ATTR(Member.CompanyID)" size="2"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTHIDDEN value="ATTR(Member.CompanyID)"/>
				</WTROW>
        <WTROW>
          <WTCONDITION expr="ATTR(Member.CompanyID)" oper="not-equal" value="SYSCON(NEXXUS)"/>
          <WTSTATIC col="1" tag="Custom"/>
          <WTTEXT col="2" value="ATTR(Member.Role)" size="15"/>
          <WTSTATIC col="2">
            <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(PEOPLEEDGE)"/>
            <WTSTATIC tag="Credit"/>
            <WTCODEGROUP>
              <WTTEXT value="ATTR(Member.Process)" size="2"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
        <WTROW>
          <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTSTATIC col="1" tag="NexxusRewards"/>
          <WTCOMBO col="2" value="ATTR(Member.Role)">
            <WTOPTION id="0" label="NotQualified"/>
            <WTOPTION id="1" label="SalesAffiliate"/>
            <WTOPTION id="2" label="Supervisor"/>
            <WTOPTION id="3" label="Manager"/>
            <WTOPTION id="4" label="Director"/>
            <WTOPTION id="5" label="VP"/>
          </WTCOMBO>
        </WTROW>

        <WTROW>
					<WTSTATIC col="1" tag="ReferralID"/>
					<WTTEXT col="2" value="ATTR(Member.ReferralID)" size="5" prespace="false"/>
					<WTSTATIC col="2" fontcolor="blue">
						<WTSTATIC value="PARAM(SponsorName)">
							<WTLINK name="0403" return="false" target="Enroller">
                <WTPARAM name="MemberID" value="ATTR(Member.ReferralID)"/>
                <WTPARAM name="contentpage" value="CONST(3)"/>
                <WTPARAM name="Popup" value="CONST(1)"/>
              </WTLINK>
						</WTSTATIC>
					</WTSTATIC>
					<WTSTATIC col="2" tag="MentorID"/>
					<WTTEXT col="2" value="ATTR(Member.MentorID)" size="5" prespace="false"/>
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(5)" />
							<WTIMAGE value="CONST(genealogy.gif)" imgalign="absmiddle">
								<WTLINK name="ViewDownlines(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
							</WTIMAGE>
							<WTIMAGE value="CONST(financesm.gif)" imgalign="absmiddle">
								<WTLINK name="ViewIncome(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
							</WTIMAGE>
							<WTIMAGE value="CONST(machine16.gif)" imgalign="absmiddle">
								<WTLINK name="10711" return="false" target="Machines">
									<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
								</WTLINK>
							</WTIMAGE>
							<WTIMAGE value="CONST(customer16.gif)" imgalign="absmiddle">
								<WTLINK name="0449" return="false" target="Customers">
									<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(9)" />
							<WTIMAGE value="CONST(genealogy.gif)" imgalign="absmiddle">
								<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW>
          <WTSTATIC col="1">
            <WTSTATIC tag="SponsorID">
              <WTCONDITION expr="ATTR(Member.CompanyID)" oper="not-equal" value="SYSCON(NEXXUS)" />
            </WTSTATIC>
            <WTSTATIC tag="ShopperID">
              <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(NEXXUS)" />
            </WTSTATIC>
          </WTSTATIC>
          <WTTEXT col="2" value="ATTR(Member.SponsorID)" size="5" prespace="false"/>
					<WTSTATIC col="2">
						<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(13)"/>
            <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(14)" connector="or"/>
            <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(17)" connector="or"/>
            <WTSTATIC tag="MatrixWidth"/>
						<WTCODEGROUP><WTTEXT value="ATTR(Member.Process)" size="2"/></WTCODEGROUP>
					</WTSTATIC>
          <WTSTATIC col="2" tag="Sponsor2ID"/>
          <WTTEXT col="2" value="ATTR(Member.Sponsor2ID)" size="5" prespace="false"/>
					<WTSTATIC col="2" tag="Sponsor3ID"/>
					<WTTEXT col="2" value="ATTR(Member.Sponsor3ID)" size="5" prespace="false"/>
					<WTSTATIC col="2" tag="Pos">
            <WTCONDITION expr="PARAM(Binary)" oper="greater" value="CONST(0)" />
            <WTSTATIC label="BinaryLeft">
              <WTCONDITION expr="ATTR(Member.Pos)" oper="equal" value="CONST(0)" />
            </WTSTATIC>
            <WTSTATIC label="BinaryRight">
              <WTCONDITION expr="ATTR(Member.Pos)" oper="equal" value="CONST(1)" />
            </WTSTATIC>
          </WTSTATIC>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="MemberName"/>
					<WTTEXT col="2" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25"/>
					<WTTEXT col="2" value="ATTR(Member.NameLast)" width="440" label="NameLast" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Member.IsCompany)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CompanyName"/>
					<WTTEXT col="2" value="ATTR(Member.CompanyName)" size="55"/>
				</WTROW>

        <WTCODEGROUP>
  				<WTCONDITION expr="ATTR(Member.CompanyID)" oper="not-equal" value="SYSCON(GCR)"/>
  				<WTCONDITION expr="IsManager" connector="or"/>
  				<WTROW>
					  <WTSTATIC col="1" tag="Email"/>
					  <WTTEXT col="2" value="ATTR(Member.Email)" size="55"/>
				  </WTROW>
        </WTCODEGROUP>  
        <WTCODEGROUP>
  				<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(GCR)"/>
  				<WTCONDITION expr="NotManager" connector="and"/>
  				<WTROW>
					  <WTHIDDEN value="ATTR(Member.Email)"/>
				  </WTROW>
  				<WTROW height="18">
					  <WTSTATIC col="1" tag="Email"/>
					  <WTSTATIC col="2" value="ATTR(Member.Email)" bold="true"/>
					  <WTSTATIC col="2" label="EmailLocked" fontcolor="blue"/>
				  </WTROW>
        </WTCODEGROUP>  

				<WTROW>
					<WTSTATIC col="1" tag="Email2"/>
					<WTTEXT col="2" value="ATTR(Member.Email2)" size="55"/>
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(Email2)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="left">
						<WTCODEGROUP><WTSTARTTAB name="MemberTab"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW id="TabNotes">
					<WTFRAME col="1" merge="2" align="left" src="" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="625" frmheight="250" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabFolders">
					<WTFRAME col="1" merge="2" align="left" src="" name="FoldersFrame" frmclass="FrameNoScroll" frmwidth="625" frmheight="200" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabMsgs">
					<WTCONDITION expr="ATTR(Member.IsMsg)" oper="equal" value="SYSCON(MSG-ON)"/>
					<WTFRAME col="1" merge="2" align="left" src="" name="MsgsFrame" frmclass="FrameNoScroll" frmwidth="625" frmheight="1000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabMsgs">
          <WTCONDITION expr="ATTR(Member.IsMsg)" oper="not-equal" value="SYSCON(MSG-ON)"/>
        </WTROW>

				<!-- ======================================================================= -->
				<WTSTATIC label="ConfirmMove"/>
				<WTROW id="TabStatus">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="640" align="left"/>

						<WTCODEGROUP>
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							<WTROW margin-top="6">
								<WTSTATIC col="1" tag="EnrollDate"/>
								<WTTEXT col="2" value="ATTR(Member.EnrollDate)" size="15"/>
								<WTSTATIC col="2" tag="EndDate"/>
								<WTTEXT col="2" value="ATTR(Member.EndDate)" prespace="false"/>
								<WTBUTTON col="2" value="CONST(EditBVQV)" btnclass="smbutton">
									<WTCONDITION expr="IsSysAdmin"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCLICK>EditBVQV()</WTCLICK>
								</WTBUTTON>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Status"/>
								<WTCOMBO col="2" value="ATTR(Member.Status)"/>
								<WTBUTTON col="2" action="13" value="CONST(MoveDownline)" btnclass="smbutton" msg="ConfirmMove">
									<WTCONDITION expr="PARAM(CompanyID)" oper="greater-equal" value="CONST(5)"/>
								</WTBUTTON>
								<WTBUTTON col="2" action="8" value="CONST(ChangeStatus)" btnclass="smbutton">
									<WTCONDITION expr="ATTR(Member.IsRemoved)" oper="equal" value="SYSCON(NO)"/>
									<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)" connector="and" paren="start"/>
									<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-FREE)" connector="or"/>
									<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-INACTIVE)" connector="or" paren="end"/>
								</WTBUTTON>
								<WTCHECK col="2" value="ATTR(Member.IsRemoved)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Level"/>
								<WTTEXT col="2" value="ATTR(Member.Level)" size="2"/>
<!--
								<WTCOMBO col="2" value="ATTR(Member.Level)">
									<WTOPTION id="0" label="Customer"/>
									<WTOPTION id="1" label="Affiliate"/>
								</WTCOMBO>
-->
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(5)"/>
									<WTCHECK col="2" value="ATTR(Member.IsMaster)"/>
									<WTSTATIC col="2" space="3"/>
								</WTCODEGROUP>
								<WTSTATIC col="2" tag="TrialDays"/>
								<WTTEXT col="2" value="ATTR(Member.TrialDays)" size="2" prespace="false"/>
              </WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="StatusDate"/>
								<WTTEXT col="2" value="ATTR(Member.StatusDate)"/>
								<WTSTATIC col="2" tag="StatusChange"/>
								<WTCOMBO col="2" value="ATTR(Member.StatusChange)" prespace="false"/>
								<WTSTATIC col="2" tag="LevelChange"/>
								<WTTEXT col="2" value="ATTR(Member.LevelChange)" size="1" prespace="false"/>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(count(/DATA/TXN/PTSTITLES/ENUM))" oper="greater" value="CONST(1)"/>
								<WTROW>
									<WTSTATIC col="1" tag="Title"/>
									<WTCOMBO col="2" value="ATTR(Member.Title)" datapath="/DATA/TXN/PTSTITLES/ENUM" setselected="true"/>
									<WTBUTTON col="2" value="CONST(TitleHistory)" btnclass="smbutton">
										<WTCONDITION expr="_IsTitles"/>
										<WTCONDITION expr="NotMemberOnly" connector="or"/>
										<WTCLICK>ViewTitles()</WTCLICK>
									</WTBUTTON>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="Title2"/>
									<WTCOMBO col="2" value="ATTR(Member.Title2)" datapath="/DATA/TXN/PTSTITLES/ENUM" setselected="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="MinTitle"/>
									<WTCOMBO col="2" value="ATTR(Member.MinTitle)" datapath="/DATA/TXN/PTSTITLES/ENUM" setselected="true"/>
									<WTSTATIC col="2" tag="TitleDate"/>
									<WTTEXT col="2" value="ATTR(Member.TitleDate)" prespace="false"/>
								</WTROW>
							</WTCODEGROUP>
							<WTROW>
								<WTSTATIC col="1" tag="Qualify"/>
								<WTCOMBO col="2" value="ATTR(Member.Qualify)">
									<WTOPTION id="0"/>
									<WTOPTION id="1" label="QualifyNo"/>
									<WTOPTION id="2" label="QualifyYes"/>
									<WTOPTION id="3" label="QualifyLock"/>
								</WTCOMBO>
								<WTSTATIC col="2" tag="QualifyDate"/>
								<WTTEXT col="2" value="ATTR(Member.QualifyDate)" prespace="false"/>
								<WTSTATIC col="2" value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv, '|',/DATA/TXN/PTSMEMBER/@qv)&quot;/&gt;))" fontcolor="blue"/>
								<WTSTATIC col="2" value="CONST((&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@qv4&quot;/&gt;))" fontcolor="purple"/>
							</WTROW>
              <WTROW>
                <WTSTATIC col="1"/>
                <WTCHECK col="2" value="ATTR(Member.IsIncluded)"/>
              </WTROW>
              <WTROW margin-top="3">
                <WTSTATIC col="1" tag="IsMsg" />
                <WTCOMBO col="2" value="ATTR(Member.IsMsg)">
                  <WTOPTION id="0" label="Msg-Off"/>
                  <WTOPTION id="1" label="Msg-On"/>
                  <WTOPTION id="2" label="Msg-Unsubscribe"/>
                </WTCOMBO>
              </WTROW>
            </WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="NotEmployee"/>
							<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
							<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
							<WTROW>
								<WTHIDDEN value="ATTR(Member.EnrollDate)"/>
								<WTHIDDEN value="ATTR(Member.EndDate)"/>
								<WTHIDDEN value="ATTR(Member.PaidDate)"/>
								<WTHIDDEN value="ATTR(Member.AutoShipDate)"/>
								<WTHIDDEN value="ATTR(Member.Title)"/>
								<WTHIDDEN value="ATTR(Member.MinTitle)"/>
								<WTHIDDEN value="ATTR(Member.TitleDate)"/>
								<WTHIDDEN value="ATTR(Member.Qualify)"/>
								<WTHIDDEN value="ATTR(Member.QualifyDate)"/>
								<WTHIDDEN value="ATTR(Member.Status)"/>
								<WTHIDDEN value="ATTR(Member.IsRemoved)"/>
								<WTHIDDEN value="ATTR(Member.Level)"/>
								<WTHIDDEN value="ATTR(Member.StatusDate)"/>
								<WTHIDDEN value="ATTR(Member.StatusChange)"/>
								<WTHIDDEN value="ATTR(Member.LevelChange)"/>
								<WTHIDDEN value="ATTR(Member.TrialDays)"/>
								<WTHIDDEN value="ATTR(Member.Process)"/>
								<WTHIDDEN value="ATTR(Member.BusAccts)"/>
								<WTHIDDEN value="ATTR(Member.MaxMembers)"/>
							</WTROW>

							<WTCODEGROUP>
								<WTCONDITION expr="IsMemberBusiness"/>
								<WTROW margin-top="6">
									<WTSTATIC col="1" tag="Status"/>
									<WTSTATIC col="2" value="ATTR(Member.Status)"/>
									<WTBUTTON col="2" action="8" value="CONST(ChangeStatus)">
										<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
										<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-FREE)" connector="or"/>
										<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-INACTIVE)" connector="or"/>
									</WTBUTTON>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="Level"/>
									<WTSTATIC col="2" value="ATTR(Member.Level)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="EnrollDate"/>
									<WTSTATIC col="2" value="ATTR(Member.EnrollDate)"/>
									<WTSTATIC col="2" tag="EndDate"/>
									<WTSTATIC col="2" value="ATTR(Member.EndDate)"/>
								</WTROW>
								<WTROW>		
									<WTSTATIC col="1" tag="PaidDate" height="18"/>
									<WTSTATIC col="2" value="ATTR(Member.PaidDate)"/>
								</WTROW>
								<WTROW>		
									<WTCONDITION expr="ATTR(Member.StatusChange)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC col="1" tag="StatusDate" height="18"/>
									<WTSTATIC col="2" value="ATTR(Member.StatusDate)"/>
									<WTSTATIC col="2" tag="StatusChange"/>
									<WTSTATIC col="2" value="ATTR(Member.StatusChange)"/>
									<WTSTATIC col="2" tag="LevelChange"/>
									<WTSTATIC col="2" value="ATTR(Member.LevelChange)"/>
								</WTROW>
								<WTCODEGROUP>
									<WTVARIABLE name="tmpTitle" value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;)"/>
								</WTCODEGROUP>
								<WTROW>
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSTITLES/ENUM))" oper="greater" value="CONST(1)"/>
									<WTSTATIC col="1" tag="Title"/>
									<WTSTATIC col="2" value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSTITLES/ENUM[@id=$tmpTitle]/@name&quot;/&gt;)"/>
									<WTSTATIC col="2" value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv, '|',/DATA/TXN/PTSMEMBER/@qv)&quot;/&gt;))" fontcolor="blue"/>
								</WTROW>
							</WTCODEGROUP>
						</WTCODEGROUP>

					</WTTABLE>
				</WTROW>
				
				<!-- ======================================================================= -->
				<WTSTATIC label="ConfirmCredit"/>
				<WTSTATIC label="ConfirmPayPal"/>
				<WTROW id="TabBilling">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="640" align="left"/>

						<WTROW margin-top="6">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTSTATIC col="1" merge="2" align="left">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(financesm.gif)" imgalign="absmiddle"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.BillingID)" oper="equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(newnote.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC tag="BillingMethod" bold="true">
										<WTLINK name="0436" nodata="true" target="Billing">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
                  <WTSTATIC space="1"/>
                  <WTSTATIC value="PARAM(BillingMethod)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

            <WTROW>
              <WTCONDITION expr="IsEmployee"/>
              <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
              <WTSTATIC col="1" merge="2" align="left">
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(financesm.gif)" imgalign="absmiddle"/>
                  <WTCODEGROUP>
                    <WTCONDITION expr="ATTR(Member.PayID)" oper="equal" value="CONST(0)"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(newnote.gif)" imgalign="absmiddle"/>
                  </WTCODEGROUP>
                  <WTSTATIC space="1"/>
                  <WTSTATIC tag="PayoutMethod" bold="true">
                    <WTLINK name="0441" nodata="true" target="Payout">
                      <WTPARAM name="MemberID" value="PARAM(MemberID)"/>
                    </WTLINK>
                    <WTSTATIC space="1"/>
                    <WTSTATIC value="PARAM(PayoutMethod)"/>
                  </WTSTATIC>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>

            <WTROW margin-top="6">
							<WTSTATIC col="1" tag="Billing"/>
							<WTCOMBO col="2" value="ATTR(Member.Billing)"/>
							<WTBUTTON col="2" action="12" value="CONST(CreditPayment)" btnclass="smbutton" msg="ConfirmCredit">
								<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(2)"/>
								<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(5)" connector="or"/>
								<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(6)" connector="or"/>
								<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(7)" connector="or"/>
							</WTBUTTON>
							<WTBUTTON col="2" action="15" value="CONST(PayPalPayment)" btnclass="smbutton" msg="ConfirmPayPal">
								<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(5)"/>
							</WTBUTTON>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="PaidDate"/>
							<WTTEXT col="2" value="ATTR(Member.PaidDate)"/>
						</WTROW>
						
						<WTCODEGROUP>
							<WTROW margin-top="6" margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Price"/>
								<WTTEXT col="2" value="ATTR(Member.Price)" size="8"/>
								<WTSTATIC col="2" tag="InitPrice"/>
								<WTTEXT col="2" value="ATTR(Member.InitPrice)" size="8" prespace="false"/>
							</WTROW>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" tag="Options2"/>
								<WTTEXT col="2" value="ATTR(Member.Options2)"/>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(LearnMore.gif)">
											<WTLINK name="Page" target="Help">
												<WTPARAM name="Page" value="CONST(MemberOptions2)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<!--							
							<WTROW>
								<WTSTATIC col="1" tag="Retail"/>
								<WTTEXT col="2" value="ATTR(Member.Retail)" size="5"/>
								<WTCHECK col="2" value="ATTR(Member.IsDiscount)"/>
								<WTSTATIC col="2" tag="Discount"/>
								<WTTEXT col="2" value="ATTR(Member.Discount)" size="4" prespace="false"/>
							</WTROW>
-->							
<!--							
							<WTROW margin-top="6">
								<WTSTATIC col="1"/>
								<WTCHECK col="2" value="ATTR(Member.PromoID)"/>
								<WTSTATIC col="2">
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(LearnMore.gif)">
											<WTLINK name="Page" target="Help">
												<WTPARAM name="Page" value="CONST(Overdraft)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
-->							
<!--							
							<WTROW>
								<WTSTATIC col="1" tag="Retail"/>
								<WTTEXT col="2" value="ATTR(Member.Retail)" size="5"/>
								<WTCHECK col="2" value="ATTR(Member.IsDiscount)"/>
								<WTSTATIC col="2" tag="Discount"/>
								<WTTEXT col="2" value="ATTR(Member.Discount)" size="4" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="PromoID"/>
								<WTTEXT col="2" value="ATTR(Member.PromoID)" size="6"/>
							</WTROW>
-->							
						</WTCODEGROUP>
<!--
						<WTCODEGROUP>
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)" connector="or"/>
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)" connector="or"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Member.BillingID)" oper="equal" value="CONST(0)"/>
								<WTROW margin-top="6">
									<WTSTATIC col="1"/>
									<WTBUTTON col="2" action="7" value="CONST(AddBilling)"/>
								</WTROW>
							</WTCODEGROUP>

							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Member.BillingID)" oper="greater" value="CONST(0)"/>
								<WTROW margin-top="6">
									<WTSTATIC col="1"/>
									<WTBUTTON col="2" action="5" value="CONST(EditBilling)"/>
								</WTROW>
								<WTROW margin-top="6" margin-bottom="6">
									<WTSTATIC col="1"/>
									<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="PayType"/>
									<WTSTATIC col="2" value="ATTR(Billing.PayType)" enum="true"/>
								</WTROW>
							
								<WTCODEGROUP>	
									<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
									<WTROW margin-top="6" margin-bottom="6">
										<WTSTATIC col="1"/>
										<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardType"/>
										<WTSTATIC col="2" value="ATTR(Billing.CardType)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardNumber"/>
										<WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardDate"/>
										<WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
										<WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardName"/>
										<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardCode"/>
										<WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
									</WTROW>
								</WTCODEGROUP>	

								<WTCODEGROUP>	
									<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(2)"/>
									<WTROW margin-top="6" margin-bottom="6">
										<WTSTATIC col="1"/>
										<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckBank"/>
										<WTSTATIC col="2" value="ATTR(Billing.CheckBank)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckRoute"/>
										<WTSTATIC col="2" value="ATTR(Billing.CheckRoute)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckAccount"/>
										<WTSTATIC col="2" value="ATTR(Billing.CheckAccount)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckNumber"/>
										<WTSTATIC col="2" value="ATTR(Billing.CheckNumber)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckName"/>
										<WTSTATIC col="2" value="ATTR(Billing.CheckName)"/>
									</WTROW>
								</WTCODEGROUP>	
							</WTCODEGROUP>	
						</WTCODEGROUP>	
-->						
					</WTTABLE>
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW id="TabGroup">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="640" align="left"/>

						<WTROW>
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="_IsEditGrp" connector="or"/>
							<WTSTATIC col="1" tag="GroupID"/>
							<WTTEXT col="2" value="ATTR(Member.GroupID)"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="NotEmployee"/>
							<WTCONDITION expr="_NotEditGrp" connector="and"/>
							<WTHIDDEN value="ATTR(Member.GroupID)"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="PARAM(RefName)" space="2">
									<WTCONDITION expr="PARAM(RefName)" oper="not-equal" value="CONST('')"/>
								</WTSTATIC>
								<WTSTATIC tag="Reference">
									<WTCONDITION expr="PARAM(RefName)" oper="equal" value="CONST('')"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTTEXT col="2" value="ATTR(Member.Reference)" size="15"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC label="Referring" space="1"/>
								<WTSTATIC value="PARAM(RefName)" space="2">
									<WTCONDITION expr="PARAM(RefName)" oper="not-equal" value="CONST('')"/>
								</WTSTATIC>
								<WTSTATIC tag="Reference">
									<WTCONDITION expr="PARAM(RefName)" oper="equal" value="CONST('')"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTTEXT col="2" value="ATTR(Member.Referral)" size="15"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="ATTR(Member.ConfLine)" size="30"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<!-- ======================================================================= -->
<!--
				<WTROW id="TabBusiness">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="640" align="left"/>

						<WTCODEGROUP>
							<WTCONDITION expr="IsEmployee"/>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" merge="2" align="left" label="MasterText" class="prompt"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="MasterID"/>
								<WTTEXT col="2" value="ATTR(Member.MasterID)" size="6"/>
								<WTCHECK col="2" value="ATTR(Member.IsIncluded)"/>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTCHECK col="2" value="ATTR(Member.IsMaster)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" tag="BusAcctPrice"/>
								<WTTEXT col="2" value="ATTR(Member.BusAcctPrice)" size="4" prespace="false"/>
								<WTSTATIC col="2" tag="BusAcctRetail"/>
								<WTTEXT col="2" value="ATTR(Member.BusAcctRetail)" size="4" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" tag="BusAccts"/>
								<WTTEXT col="2" value="ATTR(Member.BusAccts)" size="2" prespace="false"/>
								<WTSTATIC col="2" tag="MaxMembers"/>
								<WTTEXT col="2" value="ATTR(Member.MaxMembers)" size="2" prespace="false"/>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="MasterPrice"/>
								<WTSTATIC col="2" value="ATTR(Member.MasterPrice)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="MasterMembers"/>
								<WTSTATIC col="2" value="ATTR(Member.MasterMembers)"/>
							</WTROW>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="NotEmployee"/>
							<WTROW>
								<WTHIDDEN value="ATTR(Member.MasterID)"/>
								<WTHIDDEN value="ATTR(Member.IsMaster)"/>
								<WTHIDDEN value="ATTR(Member.BusAcctPrice)"/>
								<WTHIDDEN value="ATTR(Member.BusAcctRetail)"/>
								<WTHIDDEN value="ATTR(Member.BusAccts)"/>
							</WTROW>
							
							<WTCODEGROUP>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" merge="2" align="left" label="MasterText" class="prompt"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="MasterID"/>
									<WTSTATIC col="2" value="ATTR(Member.MasterID)"/>
									<WTCHECK col="2" value="ATTR(Member.IsIncluded)"/>
								</WTROW>

								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Member.IsMaster)" oper="not-equal" value="SYSCON(NO)"/>
									<WTROW margin-top="6" margin-bottom="6">
										<WTSTATIC col="1"/>
										<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTSTATIC col="2" label="IsMaster" bold="true"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTSTATIC col="2">
											<WTSTATIC tag="BusAccts"/>
											<WTSTATIC value="ATTR(Member.BusAccts)" space="3"/>
											<WTSTATIC tag="BusAcctPrice"/>
											<WTSTATIC value="ATTR(Member.BusAcctPrice)"/>
										</WTSTATIC>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="MaxMembers"/>
										<WTTEXT col="2" value="ATTR(Member.MaxMembers)"/>
									</WTROW>
									<WTROW margin-top="6" margin-bottom="6">
										<WTSTATIC col="1"/>
										<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="MasterPrice"/>
										<WTSTATIC col="2" value="ATTR(Member.MasterPrice)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="MasterMembers"/>
										<WTSTATIC col="2" value="ATTR(Member.MasterMembers)"/>
									</WTROW>
								</WTCODEGROUP>

								<WTROW>
									<WTCONDITION expr="ATTR(Member.IsMaster)" oper="equal" value="SYSCON(NO)"/>
									<WTHIDDEN value="ATTR(Member.MaxMembers)"/>
								</WTROW>

							</WTCODEGROUP>
						</WTCODEGROUP>

					</WTTABLE>
				</WTROW>
-->
				<!-- ======================================================================= -->
				<WTROW id="TabAccess">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="640" align="left"/>

						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" class="prompt">
								<WTSTATIC label="OptionsText" space="1"/>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-bottom="6">
							<WTSTATIC col="1" tag="Options"/>
							<WTTEXT col="2" value="ATTR(Member.Options)"/>
							<WTBUTTON col="2" action="16" value="CONST(Edit)" btnclass="smbutton"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="PARAM(Options)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC col="1" tag="DefaultOptions"/>
							<WTSTATIC col="2" value="PARAM(Options)" bold="true"/>
						</WTROW>
<!--						
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" tag="Options2"/>
							<WTTEXT col="2" value="ATTR(Member.Options2)"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(LearnMore.gif)">
										<WTLINK name="Page" target="Help">
											<WTPARAM name="Page" value="CONST(MemberOptions2)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
-->						
						<WTROW margin-bottom="6">
							<WTCONDITION expr="PARAM(Binary)" oper="greater" value="CONST(0)"/>
							<WTSTATIC col="1" tag="Pos"/>
              <WTCOMBO col="2" value="ATTR(Member.Pos)">
                <WTOPTION id="0" label="BinaryLeft"/>
                <WTOPTION id="1" label="BinaryRight"/>
              </WTCOMBO>
              <WTSTATIC col="2" tag="BinaryPlacement"/>
							<WTCOMBO col="2" value="PARAM(Binary)" noprespace="true">
                <WTOPTION id="1" label="PlaceWeak"/>
                <WTOPTION id="4" label="PlaceStrong"/>
                <WTOPTION id="2" label="PlaceLeft"/>
								<WTOPTION id="3" label="PlaceRight"/>
							</WTCOMBO>
						</WTROW>

						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" label="SecurityLevelText" align="left" class="prompt"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" tag="Secure"/>
							<WTTEXT col="2" value="ATTR(Member.Secure)" size="2"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="AccessLimitText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="AccessLimit"/>
							<WTTEXT col="2" value="ATTR(Member.AccessLimit)" size="50"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="QuizLimit"/>
							<WTCOMBO col="2" value="ATTR(Member.QuizLimit)"/>
						</WTROW>
<!--
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="ConfText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="ConfLine"/>
							<WTTEXT col="2" value="ATTR(Member.ConfLine)" size="40"/>
						</WTROW>
-->
						<WTCODEGROUP>
							<WTCONDITION expr="IsAdmin"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Identification"/>
								<WTMEMO col="2" value="ATTR(Member.Identification)" rows="2" cols="50"/>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
					 			<WTSTATIC col="1" tag="UserAccess"/>
					 			<WTCOMBO col="2" value="ATTR(Member.UserGroup)"/>
					 			<WTCOMBO col="2" value="ATTR(Member.UserStatus)"/>
							</WTROW>
						</WTCODEGROUP>
						<WTROW>
							<WTCONDITION expr="NotAdmin"/>
							<WTHIDDEN value="ATTR(Member.Identification)"/>
							<WTHIDDEN value="ATTR(Member.UserGroup)"/>
							<WTHIDDEN value="ATTR(Member.UserStatus)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<!-- ======================================================================= -->
				<WTROW id="TabContact">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="640" align="left"/>

						<WTROW>
							<WTBUTTON col="1" merge="2" value="CONST(ExtraInfo)" align="center" btnclass="smbutton">
								<WTCONDITION expr="_IsMemberExtra"/>
								<WTCONDITION expr="PARAM(Extra)" oper="not-equal" value="CONST(0)" connector="and"/>
								<WTCLICK>EditExtra()</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="1" merge="2" value="CONST(Forms)" align="center" btnclass="smbutton">
								<WTCONDITION expr="_IsMemberForms"/>
								<WTCLICK>ViewForms()</WTCLICK>
							</WTBUTTON>
						</WTROW>

						<WTROW>
							<WTFRAME col="1" merge="2" align="left" src="" name="AddressFrame" frmclass="FrameNoScroll" frmwidth="625" frmheight="180" label="NoFrameSupport" border="0"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Phone1"/>
							<WTTEXT col="2" value="ATTR(Member.Phone1)" size="30"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Phone2"/>
							<WTTEXT col="2" value="ATTR(Member.Phone2)" size="30"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Fax"/>
							<WTTEXT col="2" value="ATTR(Member.Fax)" size="30"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-top="3">
							<WTCONDITION expr="CONST(count(DATA/TXN/PTSLANGUAGES/ENUM))" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1" tag="PreferredLanguage"/>
							<WTCOMBO col="2" value="ATTR(Member.Icons)" datapath="/DATA/TXN/PTSLANGUAGES/ENUM" setselected="true"/>
						</WTROW>

						<WTROW margin-top="3">
							<WTSTATIC col="1" tag="AutoShipDate"/>
							<WTTEXT col="2" value="ATTR(Member.AutoShipDate)"/>
						</WTROW>
						<WTROW margin-top="3">
							<WTSTATIC col="1" tag="Timezone" />
							<WTCOMBO col="2" value="ATTR(Member.Timezone)" />
						</WTROW>
<!--						
						<WTROW margin-top="3">
							<WTSTATIC col="1" tag="WebsiteID"/>
							<WTCOMBO col="2" value="ATTR(Member.WebsiteID)" datapath="/DATA/TXN/PTSLEADCAMPAIGNS/ENUM" setselected="true"/>
							<WTBUTTON col="2" value="CONST(Preview)" btnclass="smbutton">
								<WTCLICK>ViewCampaign()</WTCLICK>
							</WTBUTTON>
						</WTROW>
-->						
						<WTROW margin-top="3">
              <WTCONDITION expr="_IsPayouts"/>
              <WTCONDITION expr="IsEmployee" connector="or"/>
              <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
              <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
              <WTSTATIC col="1" tag="Govid"/>
							<WTSTATIC col="2">
								<WTSTATIC value="ATTR(Govid.GType)" enum="true"/>
								<WTSTATIC value="CONST(:)" space="1"/>
								<WTSTATIC value="ATTR(Govid.GNumber)" bold="true"/>
							</WTSTATIC>
							<WTBUTTON col="2" action="14" value="CONST(Edit)" btnclass="smbutton"/>
						</WTROW>
<!--						
						<WTROW margin-top="3">
							<WTSTATIC col="1" tag="TaxID"/>
							<WTCOMBO col="2" value="ATTR(Member.TaxIDType)"/>
							<WTTEXT col="2" value="ATTR(Member.TaxID)"/>
						</WTROW>
-->						
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTSTATIC col="1" merge="2" align="left" label="ImageHelp" class="Prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" valign="bottom" tag="Image"/>
							<WTBUTTON col="2" action="6" value="CONST(Upload)"/>
							<WTIMAGE col="2" value="ATTR(Member.Image)" align="left" valign="top" path="Member" imgwidth="100">
								<WTCONDITION expr="ATTR(Member.Image)" oper="not-equal" value="''"/>
							</WTIMAGE>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr="NotMemberOnly"/>
							<WTCONDITION expr="_IsSuspect" connector="or"/>
							<WTCONDITION expr="_IsSales" connector="or"/>
							<WTCONDITION expr="_IsService" connector="or"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>

							<WTROW>
								<WTSTATIC col="1" tag="Signature" align="left"/>
								<WTSTATIC col="2" align="right" label="MoreSignatures" bold="true">
									<WTLINK name="6111" target="Signature" nodata="true">
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTMEMO col="1" merge="2" align="left" value="ATTR(Member.Signature)" cols="72" rows="10" htmleditor="editor" embedhtml="true"/>
							</WTROW>

							<WTROW margin-bottom="3">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="2" align="left" label="SignatureText" class="prompt" />
							</WTROW>
						</WTCODEGROUP>

						<WTROW margin-top="6" margin-bottom="3">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" merge="2" align="left" label="SocNetText" class="prompt" />
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="FaceBookUser"/>
							<WTTEXT col="2" value="PARAM(FaceBook)"/>
							<WTIMAGE col="2" value="CONST(social-FaceBook.png)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="TwitterUser"/>
							<WTTEXT col="2" value="PARAM(Twitter)"/>
							<WTIMAGE col="2" value="CONST(social-Twitter.png)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="GoogleUser"/>
							<WTTEXT col="2" value="PARAM(Google)"/>
							<WTIMAGE col="2" value="CONST(social-Google.png)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="PinterestUser"/>
							<WTTEXT col="2" value="PARAM(Pinterest)"/>
							<WTIMAGE col="2" value="CONST(social-Pinterest.png)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="TumblrUser"/>
							<WTTEXT col="2" value="PARAM(Tumblr)"/>
							<WTIMAGE col="2" value="CONST(social-Tumblr.png)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="LinkedInUser"/>
							<WTTEXT col="2" value="PARAM(LinkedIn)"/>
							<WTIMAGE col="2" value="CONST(social-LinkedIn.png)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="MySpaceUser"/>
							<WTTEXT col="2" value="PARAM(MySpace)"/>
							<WTIMAGE col="2" value="CONST(social-MySpace.png)" imgalign="absmiddle"/>
						</WTROW>
						<WTROW height="36">
							<WTSTATIC col="1" tag="SkypeUser"/>
							<WTTEXT col="2" value="PARAM(Skype)"/>
							<WTIMAGE col="2" value="CONST(social-Skype.png)" imgalign="absmiddle"/>
						</WTROW>
						<!--
						<WTROW margin-top="3" margin-bottom="3">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
						</WTROW>
            -->
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="9" value="CONST(UpdateExit)" align="center">
						<WTCONDITION expr="IsActive"/>
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" align="center" msg="ConfirmDelete">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					</WTBUTTON>

				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0443" contentpage="true" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" 
		focus="false" secured="61">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="ParentID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="RefName" datatype="text"/>
			<WTPARAM name="Options" datatype="text"/>
			<WTPARAM name="MemberOptions" datatype="text"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="VisitDate" datatype="date"/>
			<WTPARAM name="Identify" datatype="number"/>
			<WTPARAM name="AuthUserID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>


			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<!-- Used By Menu Bar -->
	
			<WTSETATTRIBUTE name="CONST(tmpUserGroup)" value="CONST(0)"/>
			<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="CONST(0)"/>
<!--			<WTSETATTRIBUTE name="CONST(tmpIsMaster)" value="CONST(0)"/>-->

			<WTSETATTRIBUTE name="PARAM(contentpage)" value="CONST(3)"/>
			<WTSETATTRIBUTE name="PARAM(Popup)" value="CONST(1)"/>

			<WTSUB name="UpdateMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="PARAM(VisitDate)" value="ATTR(VisitDate)"/>
					<WTSETATTRIBUTE name="PARAM(AuthUserID)" value="ATTR(AuthUserID)"/>
					<WTSETATTRIBUTE name="CONST(tmpUserGroup)" value="ATTR(UserGroup)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="ATTR(IsDiscount)"/>
<!--					<WTSETATTRIBUTE name="CONST(tmpIsMaster)" value="ATTR(IsMaster)"/>-->
					<WTSETATTRIBUTE name="CONST(oldStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(oldReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(oldSponsorID)" value="ATTR(SponsorID)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(newStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(newTitle)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(newReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(newSponsorID)" value="ATTR(SponsorID)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(newSponsorID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(newSponsorID)" oper="not-equal" value="CONST(oldSponsorID)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Member.EndDate)" oper="equal" value="CONST(&quot;0&quot;)"/>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-INACTIVE)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(Member.EndDate)" value="SYS(Now)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)" paren="start"/>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)" connector="or" paren="end"/>
						<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(Member.Level)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(newTitle)" oper="not-equal" value="CONST(oldTitle)" connector="and"/>
						<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
							<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="PARAM(MemberID)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(newTitle)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTOBJECT>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="PARAM(MemberOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="PARAM(VisitDate)" value="ATTR(VisitDate)"/>
					<WTSETATTRIBUTE name="PARAM(AuthUserID)" value="ATTR(AuthUserID)"/>
					<WTSETATTRIBUTE name="CONST(tmpUserGroup)" value="ATTR(UserGroup)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="ATTR(IsDiscount)"/>
<!--					<WTSETATTRIBUTE name="CONST(tmpIsMaster)" value="ATTR(IsMaster)"/>-->
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)">
						<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="ATTR(GroupID)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(RefName)" value="ATTR(RefName)"/>
					<WTSETATTRIBUTE name="PARAM(Identify)" value="ATTR(Identify)"/>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpInputOptions)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(MemberOptions)" value="CONST(reqMemberOptions + reqOptions)"/>
				</WTOBJECT>
				<WTOBJECT name="Titles" project="ptsTitleUser" class="CTitles">
					<WTCONDITION expr="IsTitles"/>
					<WTCONDITION expr="IsEmployee" connector="or"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlTitles" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTTAB name="MemberTab">
					<WTITEM label="ViewStatus" width="100"><WTLINK name="JAVA(ShowTab('TabStatus',1))"/></WTITEM>
					<WTITEM label="Notes" width="100">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTLINK name="JAVA(ShowTab('TabNotes',1))"/>
					</WTITEM>
					<WTITEM label="ViewGroup" width="100">
						<WTLINK name="JAVA(ShowTab('TabGroup',1))"/>
					</WTITEM>
				</WTTAB>

				<WTFUNCTION name="ShowTab(tab, shw)">
					document.getElementById('TabStatus').style.display = 'none';
					document.getElementById('TabNotes').style.display = 'none';
					document.getElementById('TabGroup').style.display = 'none';
					document.getElementById(tab).style.display = '';
					if (shw > 0) {
						content = window.document.getElementById('Email');
						if(content)
							content.scrollIntoView();
					}
					if ( tab == 'TabNotes' ) {
						var src = document.getElementById('NotesFrame').src
						if (src.indexOf("9011") &lt; 0 ) {
							var id = document.getElementById('MemberID').value
							var title = document.getElementById('MemberName').value
							src = '9011.asp?Height=250&amp;OwnerType=4&amp;OwnerID=' + id + '&amp;Title=' + title
							document.getElementById('NotesFrame').src = src
						}	
					}	
			    </WTFUNCTION>  
				<WTFUNCTION name="ViewTitles()">
					var url, win;
					url = "5711.asp?memberid=" + document.getElementById('MemberID').value
		            win = window.open(url,"Titles","top=100,left=100,height=300,width=425,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				<WTLOAD>
					ShowTab('TabStatus',0);
				</WTLOAD>
				
				<WTMENU name="MemberMenu" type="bar" menuwidth="120">
					<WTCONDITION expr="IsEmployee"/>
					<WTITEM label="Personal">
						<WTIMAGE name="MyInfo.gif"/>
						<WTITEM label="Home"><WTCONDITION expr="PARAM(contentpage)" oper="equal" value="CONST(0)"/><WTLINK name="0404" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/></WTLINK></WTITEM>
						<WTITEM label="Icons"><WTLINK name="0431" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Resources"><WTLINK name="9304" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="GroupID" value="PARAM(GroupID)"/><WTPARAM name="GrpCompanyID" value="PARAM(CompanyID)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="Mentoring"><WTLINK name="0410" nodata="true" target="Mentoring"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Genealogy"><WTLINK name="0470" nodata="true" target="Genealogy"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Goals"><WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Calendar"><WTLINK name="Calendar" nodata="true" target="blank"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Projects"><WTLINK name="7501" nodata="true"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="SupportTickets"><WTLINK name="9506" nodata="true" target="SupportTickets"><WTPARAM name="T" value="ENTITY(Member)"/><WTPARAM name="I" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Identification"><WTCONDITION expr="PARAM(Identify)" oper="not-equal" value="CONST(0)"/><WTLINK name="0426" nodata="true" target="Identify"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Referrals"><WTCONDITION expr="CONST(tmpIsDiscount)" oper="not-equal" value="CONST(0)"/><WTLINK name="0408" nodata="true"><WTPARAM name="ReferralID" value="PARAM(MemberID)"/><WTPARAM name="contentpage" value="PARAM(contentpage)"/></WTLINK></WTITEM>
<!--						<WTITEM label="MasterMembers"><WTCONDITION expr="CONST(tmpIsMaster)" oper="not-equal" value="CONST(0)"/><WTLINK name="0411" nodata="true" target="MasterMembers"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MasterID" value="PARAM(MemberID)"/></WTLINK></WTITEM>-->
					</WTITEM>
					<WTITEM label="Finance">
						<WTIMAGE name="Finance.gif"/>
						<WTITEM label="SalesOrders"><WTLINK name="0475" nodata="true" target="Finances"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(1)"/><WTPARAM name="ContentPage" value="CONST(3)"/><WTPARAM name="Popup" value="CONST(1)"/></WTLINK></WTITEM>
						<WTITEM label="Payments"><WTLINK name="0475" nodata="true" target="Finances"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(2)"/><WTPARAM name="ContentPage" value="CONST(3)"/><WTPARAM name="Popup" value="CONST(1)"/></WTLINK></WTITEM>
						<WTITEM label="Bonuses"><WTLINK name="0475" nodata="true" target="Finances"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(3)"/><WTPARAM name="ContentPage" value="CONST(3)"/><WTPARAM name="Popup" value="CONST(1)"/></WTLINK></WTITEM>
<!--						<WTITEM label="Payouts"><WTLINK name="0475" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="Code" value="CONST(4)"/></WTLINK></WTITEM>-->
						<WTDIVIDER/>
						<WTITEM label="Billing"><WTLINK name="1011" nodata="true"><WTPARAM name="OwnerType" value="ENTITY(Member)"/><WTPARAM name="OwnerID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="AutoShip"><WTLINK name="0433" nodata="true" target="AutoShip"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Sales">
						<WTIMAGE name="Prospect.gif"/>
						<WTITEM label="LeadManager"><WTLINK name="8161" nodata="true" target="blank"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="SalesSystem"><WTLINK name="8101" nodata="true"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="Service"><WTLINK name="8151" nodata="true"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="PartyPlans"><WTLINK name="2511" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Training">
						<WTIMAGE name="Catalog.gif"/>
						<WTITEM label="Classes"><WTLINK name="1311" nodata="true" target="Classes"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="CertReport"><WTLINK name="3411" nodata="true" target="CertReport"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="TrainingBuddy"><WTLINK name="0440" nodata="true" target="Buddy"><WTPARAM name="MemberID" value="PARAM(MemberID)"/><WTPARAM name="VisitDate" value="PARAM(VisitDate)"/><WTPARAM name="ContentPage" value="CONST(3)"/></WTLINK></WTITEM>
					</WTITEM>
					<WTITEM label="Tools">
						<WTIMAGE name="Tools.gif"/>
						<WTITEM label="ResetLogon"><WTCONDITION expr="CONST(tmpUserGroup)" oper="not-equal" value="CONST(0)"/><WTLINK name="0104" nodata="true"><WTPARAM name="contentpage" value="PARAM(contentpage)"/><WTPARAM name="AuthUserID" value="PARAM(AuthUserID)"/></WTLINK></WTITEM>
						<WTITEM label="ViewLogon"><WTCONDITION expr="CONST(tmpUserGroup)" oper="not-equal" value="CONST(0)"/><WTLINK name="0113" nodata="true"><WTPARAM name="contentpage" value="PARAM(contentpage)"/><WTPARAM name="AuthUserID" value="PARAM(AuthUserID)"/></WTLINK></WTITEM>
						<WTITEM label="IPs"><WTCONDITION expr="CONST(tmpUserGroup)" oper="not-equal" value="CONST(0)"/><WTLINK name="7111" nodata="true"><WTPARAM name="AuthUserID" value="PARAM(AuthUserID)"/><WTPARAM name="contentpage" value="PARAM(contentpage)"/></WTLINK></WTITEM>
						<WTDIVIDER/>
						<WTITEM label="Assign"><WTLINK name="8101" nodata="true" target="Assign"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="AssignID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="ImportCustomers"><WTLINK name="8116" nodata="true" target="Import"><WTPARAM name="CompanyID" value="PARAM(CompanyID)"/><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
						<WTITEM label="ExportCustomers"><WTLINK name="8117" nodata="true" target="Export"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK></WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="IsEmployee"/>
					<WTSTATIC col="1" merge="2" align="right">
						<WTCODEGROUP><WTSTARTMENU name="MemberMenu" type="bar"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="ATTR(Member.MemberName)"/>
					<WTHIDDEN value="PARAM(ParentID)"/>
					<WTHIDDEN value="PARAM(MemberOptions)"/>
				</WTROW>

				<WTROW>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsOrgAdminOnly"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTROW>
						<WTLINKGROUP col="1" merge="2" align="right">
<!--
							<WTLINK name="0470" label="Genealogy" class="PageHeadingLink" nodata="true" target="Genealogy">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							</WTLINK>
-->							
							<WTLINK name="0410" label="Mentoring" class="PageHeadingLink" nodata="true" target="Mentoring">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							</WTLINK>
							<WTLINK name="0431" label="Icons" class="PageHeadingLink" nodata="true">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							</WTLINK>
							<WTLINK name="0426" label="Identification" class="PageHeadingLink" nodata="true" target="Identify">
								<WTCONDITION expr="PARAM(Identify)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							</WTLINK>
							<WTLINK name="1311" label="Classes" class="PageHeadingLink" target="Classes">
								<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
								<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
							</WTLINK>

							<WTLINK name="0470" label="Genealogy" class="PageHeadingLink" nodata="true" target="Genealogy">
								<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
							</WTLINK>
							<WTLINK name="8101" label="Sales" class="PageHeadingLink" nodata="true">
								<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
								<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
							</WTLINK>
							<WTLINK name="0475" label="Finance" class="PageHeadingLink" nodata="true" target="Finances">
								<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
								<WTPARAM name="ContentPage" value="CONST(3)"/>
								<WTPARAM name="Popup" value="CONST(1)"/>
							</WTLINK>

							<WTLINK name="7001" label="Goals" class="PageHeadingLink">
								<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
							</WTLINK>
							<WTLINK name="3411" label="CertReport" class="PageHeadingLink" target="CertReport">
								<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
							</WTLINK>
							<WTLINK name="0104" label="ResetLogon" class="PageHeadingLink">
					 			<WTCONDITION expr="ATTR(UserGroup)" oper="not-equal" value="CONST(0)"/>
					 			<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
					 			<WTPARAM name="AuthUserID" value="ATTR(Member.AuthUserID)"/>
					 		</WTLINK>
						</WTLINKGROUP>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTIMAGE col="1" value="CONST(Member.gif)" align="center" class="PageHeader"/>
					<WTSTATIC col="2" align="left" valign="center" class="PageHeading">
						<WTSTATIC value="CONST(#)"/>
						<WTSTATIC value="ATTR(Member.MemberID)"/>
						<WTSTATIC value="CONST(-)"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Shortcut.gif)">
								<WTCONDITION expr="_IsShortcuts"/>
								<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
									<WTPARAM name="EntityID" value="ENTITY(Member)"/>
									<WTPARAM name="ItemID" value="ATTR(Member.MemberID)"/>
									<WTPARAM name="Name" value="ATTR(Member.CompanyName)" clean="true"/>
									<WTPARAM name="URL" value="SYS(PageURL)"/>
									<WTPARAM name="IsPopup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Member.IsCompany)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC value="ATTR(Member.CompanyName)"/>
						</WTSTATIC>
						<WTSTATIC newline="1"/>
						<WTSTATIC fontsize="2" fontcolor="black">
							<WTSTATIC value="CONST(D:)"/>
							<WTSTATIC value="ATTR(Member.Phone1)" space="2"/>
							<WTSTATIC value="CONST(N:)"/>
							<WTSTATIC value="ATTR(Member.Phone2)" space="2"/>
							<WTSTATIC value="CONST(M:)"/>
							<WTSTATIC value="ATTR(Member.Fax)"/>
							<WTSTATIC newline="1"/>
						</WTSTATIC>
						<WTSTATIC fontsize="2" fontcolor="purple">
							<WTSTATIC tag="VisitDate" value="ATTR(Member.VisitDate)" newline="1"/>
							<WTSTATIC tag="EnrollDate" value="ATTR(Member.EnrollDate)" space="3"/>
							<WTSTATIC tag="PaidDate" value="ATTR(Member.PaidDate)">
								<WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTROW>
						<WTSTATIC col="1" tag="ReferralID"/>
						<WTTEXT col="2" value="ATTR(Member.ReferralID)" size="5" prespace="false"/>
						<WTSTATIC col="2" tag="MentorID"/>
						<WTTEXT col="2" value="ATTR(Member.MentorID)" size="5" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="SponsorID"/>
						<WTTEXT col="2" value="ATTR(Member.SponsorID)" size="5" prespace="false"/>
						<WTSTATIC col="2" tag="Sponsor2ID"/>
						<WTTEXT col="2" value="ATTR(Member.Sponsor2ID)" size="5" prespace="false"/>
						<WTSTATIC col="2" tag="Sponsor3ID"/>
						<WTTEXT col="2" value="ATTR(Member.Sponsor3ID)" size="5" prespace="false"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Member.ReferralID)"/>
					<WTHIDDEN value="ATTR(Member.SponsorID)"/>
					<WTHIDDEN value="ATTR(Member.Sponsor2ID)"/>
					<WTHIDDEN value="ATTR(Member.Sponsor3ID)"/>
					<WTHIDDEN value="ATTR(Member.MentorID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="MemberName"/>
					<WTTEXT col="2" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25"/>
					<WTTEXT col="2" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Member.IsCompany)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CompanyName"/>
					<WTTEXT col="2" value="ATTR(Member.CompanyName)" size="60"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Member.Email)" size="60"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="IsEmployee"/>
	 				<WTCONDITION expr="_IsSales" connector="or"/>
	 				<WTCONDITION expr="_IsMentor" connector="or"/>
					<WTSTATIC col="1" tag="Email2"/>
					<WTTEXT col="2" value="ATTR(Member.Email2)" size="60"/>
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(Email2)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="left">
						<WTCODEGROUP><WTSTARTTAB name="MemberTab"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW id="TabNotes">
					<WTFRAME col="1" merge="2" src="" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="250" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

				<WTROW id="TabStatus">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>

						<WTCODEGROUP>
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							<WTROW margin-top="6">
								<WTSTATIC col="1" tag="EnrollDate"/>
								<WTTEXT col="2" value="ATTR(Member.EnrollDate)" size="15"/>
								<WTSTATIC col="2" tag="EndDate"/>
								<WTTEXT col="2" value="ATTR(Member.EndDate)" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="PaidDate"/>
								<WTTEXT col="2" value="ATTR(Member.PaidDate)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Status"/>
								<WTCOMBO col="2" value="ATTR(Member.Status)"/>
								<WTSTATIC col="2" space="5"/>
								<WTCHECK col="2" value="ATTR(Member.IsRemoved)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="Level"/>
								<WTTEXT col="2" value="ATTR(Member.Level)" size="2"/>
								<WTSTATIC col="2" tag="TrialDays"/>
								<WTTEXT col="2" value="ATTR(Member.TrialDays)" size="2"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="StatusDate"/>
								<WTTEXT col="2" value="ATTR(Member.StatusDate)"/>
								<WTSTATIC col="2" tag="StatusChange"/>
								<WTCOMBO col="2" value="ATTR(Member.StatusChange)" prespace="false"/>
								<WTSTATIC col="2" tag="LevelChange"/>
								<WTTEXT col="2" value="ATTR(Member.LevelChange)" size="1" prespace="false"/>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTSTATIC col="1"/>
								<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(count(/DATA/TXN/PTSTITLES/ENUM))" oper="greater" value="CONST(1)"/>
								<WTROW>
									<WTSTATIC col="1" tag="Title"/>
									<WTCOMBO col="2" value="ATTR(Member.Title)" datapath="/DATA/TXN/PTSTITLES/ENUM" setselected="true"/>
									<WTBUTTON col="2" value="CONST(TitleHistory)" btnclass="smbutton">
										<WTCONDITION expr="_IsTitles"/>
										<WTCONDITION expr="NotMemberOnly" connector="or"/>
										<WTCLICK>ViewTitles()</WTCLICK>
									</WTBUTTON>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="MinTitle"/>
									<WTCOMBO col="2" value="ATTR(Member.MinTitle)" datapath="/DATA/TXN/PTSTITLES/ENUM" setselected="true"/>
									<WTSTATIC col="2" tag="TitleDate"/>
									<WTTEXT col="2" value="ATTR(Member.TitleDate)" prespace="false"/>
								</WTROW>
							</WTCODEGROUP>
							<WTROW>
								<WTSTATIC col="1" tag="Qualify"/>
								<WTCOMBO col="2" value="ATTR(Member.Qualify)">
									<WTOPTION id="0"/>
									<WTOPTION id="1" label="QualifyNo"/>
									<WTOPTION id="2" label="QualifyYes"/>
									<WTOPTION id="3" label="QualifyLock"/>
								</WTCOMBO>
								<WTSTATIC col="2" tag="QualifyDate"/>
								<WTTEXT col="2" value="ATTR(Member.QualifyDate)" prespace="false"/>
								<WTSTATIC col="2" value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv, '|',/DATA/TXN/PTSMEMBER/@qv)&quot;/&gt;))" fontcolor="blue"/>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="NotEmployee"/>
							<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
							<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
							<WTROW>
								<WTHIDDEN value="ATTR(Member.EnrollDate)"/>
								<WTHIDDEN value="ATTR(Member.EndDate)"/>
								<WTHIDDEN value="ATTR(Member.PaidDate)"/>
								<WTHIDDEN value="ATTR(Member.AutoShipDate)"/>
								<WTHIDDEN value="ATTR(Member.Status)"/>
								<WTHIDDEN value="ATTR(Member.IsRemoved)"/>
								<WTHIDDEN value="ATTR(Member.Level)"/>
								<WTHIDDEN value="ATTR(Member.TrialDays)"/>
								<WTHIDDEN value="ATTR(Member.StatusDate)"/>
								<WTHIDDEN value="ATTR(Member.StatusChange)"/>
								<WTHIDDEN value="ATTR(Member.LevelChange)"/>
								<WTHIDDEN value="ATTR(Member.Title)"/>
								<WTHIDDEN value="ATTR(Member.MinTitle)"/>
								<WTHIDDEN value="ATTR(Member.TitleDate)"/>
								<WTHIDDEN value="ATTR(Member.Qualify)"/>
								<WTHIDDEN value="ATTR(Member.QualifyDate)"/>
							</WTROW>

							<WTCODEGROUP>
								<WTCONDITION expr="IsOrgAdminOnly"/>
								<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
								<WTROW margin-top="6">
									<WTSTATIC col="1" tag="Status"/>
									<WTSTATIC col="2" value="ATTR(Member.Status)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="Level"/>
									<WTSTATIC col="2" value="ATTR(Member.Level)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="EnrollDate"/>
									<WTSTATIC col="2" value="ATTR(Member.EnrollDate)"/>
									<WTSTATIC col="2" tag="EndDate"/>
									<WTSTATIC col="2" value="ATTR(Member.EndDate)"/>
								</WTROW>
								<WTROW>		
									<WTSTATIC col="1" tag="PaidDate" height="18"/>
									<WTSTATIC col="2" value="ATTR(Member.PaidDate)"/>
								</WTROW>
								<WTROW>		
									<WTCONDITION expr="ATTR(Member.StatusChange)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC col="1" tag="StatusDate" height="18"/>
									<WTSTATIC col="2" value="ATTR(Member.StatusDate)"/>
									<WTSTATIC col="2" tag="StatusChange"/>
									<WTSTATIC col="2" value="ATTR(Member.StatusChange)"/>
									<WTSTATIC col="2" tag="LevelChange"/>
									<WTSTATIC col="2" value="ATTR(Member.LevelChange)"/>
								</WTROW>
								<WTCODEGROUP>
									<WTVARIABLE name="tmpTitle" value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;)"/>
								</WTCODEGROUP>
								<WTROW>
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSTITLES/ENUM))" oper="greater" value="CONST(1)"/>
									<WTSTATIC col="1" tag="Title"/>
									<WTSTATIC col="2" value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSTITLES/ENUM[@id=$tmpTitle]/@name&quot;/&gt;)"/>
									<WTSTATIC col="2" value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv, '|',/DATA/TXN/PTSMEMBER/@qv)&quot;/&gt;))" fontcolor="blue"/>
								</WTROW>
							</WTCODEGROUP>
						</WTCODEGROUP>

					</WTTABLE>
				</WTROW>
				
				<!-- ======================================================================= -->
				<WTROW id="TabGroup">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>

						<WTROW>
							<WTSTATIC col="1" tag="GroupID"/>
							<WTTEXT col="2" value="ATTR(Member.GroupID)"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="PARAM(RefName)" space="2">
									<WTCONDITION expr="PARAM(RefName)" oper="not-equal" value="CONST('')"/>
								</WTSTATIC>
								<WTSTATIC tag="Reference">
									<WTCONDITION expr="PARAM(RefName)" oper="equal" value="CONST('')"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTTEXT col="2" value="ATTR(Member.Reference)" size="15"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0463" caption="Member Profile" contentpage="true" wrapper="wrapper600"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="52" track="0">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="RefName" datatype="text"/>
			<WTPARAM name="Identify" datatype="number"/>
			<WTPARAM name="UploadImageFile" datatype="text"/>
			<WTPARAM name="IsMsg" datatype="number"/>
			<WTPARAM name="FaceBook" datatype="text"/>
			<WTPARAM name="Twitter" datatype="text"/>
			<WTPARAM name="Google" datatype="text"/>
			<WTPARAM name="Pinterest" datatype="text"/>
			<WTPARAM name="Tumblr" datatype="text"/>
			<WTPARAM name="LinkedIn" datatype="text"/>
			<WTPARAM name="MySpace" datatype="text"/>
			<WTPARAM name="Skype" datatype="text"/>
      <WTPARAM name="Binary" datatype="number"/>
      <WTPARAM name="OrderOption" datatype="number"/>
      <WTPARAM name="ShowQualify" datatype="number"/>

			<WTPARAM name="FastTrack" datatype="number"/>
			<WTPARAM name="Backups" datatype="number"/>
			<WTPARAM name="Money" datatype="number"/>
			<WTPARAM name="University" datatype="number"/>
			<WTPARAM name="PV" datatype="text"/>
			<WTPARAM name="BV" datatype="text"/>
			<WTPARAM name="Action" datatype="number"/>
			<WTPARAM name="Member2FA" datatype="number"/>

			<WTPARAM name="Products" datatype="text"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="Products.asp"/>
			<WTINCLUDE name="Binary.asp"/>
			<WTINCLUDE name="Languages.asp"/>

			<WTDATATXN name="Languages"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
<WTCUSTOM>
'tmpHTTPS = Request.ServerVariables("HTTPS")
''response.write "[" + tmpHTTPS + "]"
'If tmpHTTPS = "off" Then
'	Response.Redirect "https://" + reqSysServerName + reqSysServerPath + "0463.asp" + "?MemberID=" + CStr(reqMemberID) + "&amp;ContentPage=3&amp;Popup=1"
'End If
</WTCUSTOM>			
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotInfo" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadImageFile)" oper="not-equal" value="&quot;&quot;"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(Image)" value="PARAM(UploadImageFile)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTOBJECT>
			</WTCODEGROUP>

			<WTSUB name="UpdateMember">
        <WTSETATTRIBUTE name="CONST(ConsumerID)" value="CONST(0)"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="CONST(oldPromoID)" value="ATTR(PromoID)"/>
          <WTSETATTRIBUTE name="CONST(oldSponsorID)" value="ATTR(SponsorID)"/>
          <!--					<WTSETATTRIBUTE name="CONST(tmpTaxID)" value="ATTR(TaxID)"/>-->
					<WTSETATTRIBUTES/>
          <WTSETATTRIBUTE name="CONST(ConsumerID)" value="ATTR(SponsorID)">
            <WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTCONDITION expr="ATTR(SponsorID)" oper="not-equal" value="CONST(oldSponsorID)" connector="and"/>
          </WTSETATTRIBUTE>
          <!--					
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(TaxID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(TaxID)" value="CONST(tmpTaxID)">
							<WTCONDITION expr="ATTR(TaxID)" oper="equal" value="CONST(&quot;xxx-xx-&quot; + Right(.TaxID,4))"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
-->					
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Len(.Signature))" oper="less" value="CONST(8)"/>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Binary)" oper="greater" value="CONST(0)"/>
            <WTCALLSUB name=".Options2 = SetBinary( .Options2, reqBinary )"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTCUSTOM>
              days = DateDiff( "d", .PaidDate, reqSysDate )
              If days &gt; 10 Then .PaidDate = reqSysDate
            </WTCUSTOM>
            <!-- Set Affiliate Package Options -->
            <WTCODEGROUP>
              <!-- None -->
              <WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Beginner -->
              <WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(1)"/>
              <WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;101&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(10)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Basic -->
              <WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(2)"/>
              <WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;102&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(25)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Pro -->
              <WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(3)"/>
              <WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;103&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(50)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Beginner Ad -->
              <WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(4)"/>
              <WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;106&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(10)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Basic Ad -->
              <WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(5)"/>
              <WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;107&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(25)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Pro Ad -->
              <WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(6)"/>
              <WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;108&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(50)"/>
            </WTCODEGROUP>

            <WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>
            <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;B&quot; + CSTR(reqBinary) + &quot;,&quot; + tmpCode)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(oldOptions2)" oper="not-equal" value="ATTR(Options2)"/>
              <!-- log the membership change -->
              <WTCALLSUB name="LogMemberNote reqMemberID, &quot;OPTIONS CHANGE: (&quot; + oldOptions2 + &quot;) to (&quot; + .Options2 + &quot;)&quot;">
                <WTCONDITION expr="NoErrors"/>
              </WTCALLSUB>
            </WTCODEGROUP>
          </WTCODEGROUP>
          
          <WTCODEGROUP>
<WTCONDITION expr="IsSocNetPublic"/>
<WTCUSTOM>
	.SocNet = "FB;" + reqFaceBook + ":" + "TW;" + reqTwitter + ":" + "GO;" + reqGoogle + ":" + "PI;" + reqPinterest + ":" + "TU;" + reqTumblr + ":" + "LI;" + reqLinkedIn + ":" + "MS;" + reqMySpace + ":" + "SK;" + reqSkype
</WTCUSTOM>
</WTCODEGROUP>
					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="PARAM(Action)" value="CONST(1)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(PromoID)" oper="not-equal" value="CONST(oldPromoID)"/>
							<WTCUSTOM>
								LogMemberNote reqMemberID, "OVERDRAFT PROTECTION CHANGE: (" + .PromoID + ") "
							</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTOBJECT name="Consumer" project="ptsConsumerUser" class="CConsumer">
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="CONST(ConsumerID)" oper="not-equal" value="CONST(0)" connector="and"/>
          <WTMETHOD name="Load">
            <WTPARAM name="ConsumerID" direction="input" value="CONST(ConsumerID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(AffiliateID)" value="PARAM(MemberID)"/>
          <WTMETHOD name="Save">
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(3)" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(1)"/>
     			<WTCODEGROUP>
				    <WTCONDITION expr="IsMemberOnly"/>
            <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(Is2FA(reqSysUserID))"/>
			    </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="NotEmployee"/>
            <WTCONDITION expr="ATTR(CompanyID)" oper="not-equal" value="CONST(CSTR(reqSysCompanyID))" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)" connector="and"/>
            <WTSETATTRIBUTE name="PARAM(Binary)" value="CONST(-1)"/>
          </WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpOptions2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="PARAM(IsMsg)" value="ATTR(IsMsg)"/>
					<WTSETATTRIBUTE name="PARAM(PV)" value="ATTR(BV)"/>
					<WTSETATTRIBUTE name="PARAM(BV)" value="ATTR(QV)"/>
					<WTSETATTRIBUTE name="ATTR(TaxID)" value="CONST(&quot;xxx-xx-&quot; + Right(.TaxID,4))">
						<WTCONDITION expr="ATTR(TaxID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LIFETIME)"/>
						<WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSETATTRIBUTE name="PARAM(ShowQualify)" value="CONST(1)">
              <WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(0)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;101&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(1)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;102&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(2)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;103&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(3)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;106&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(4)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;107&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(5)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(InStr(.Options2, &quot;108&quot;))" oper="not-equal" value="CONST(0)"/>
              <WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(6)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>

          <WTCODEGROUP>
<WTCONDITION expr="IsSocNetPublic"/>
<WTCUSTOM>
	aSocNets = split(.SocNet, ":")
	total = UBOUND(aSocNets)
	For x = 0 to total
	aSocNet = split(aSocNets(x), ";")
	Select Case aSocNet(0)
	Case "FB": reqFaceBook = aSocNet(1)
	Case "TW": reqTwitter = aSocNet(1)
	Case "GO": reqGoogle = aSocNet(1)
	Case "PI": reqPinterest = aSocNet(1)
	Case "TU": reqTumblr = aSocNet(1)
	Case "LI": reqLinkedIn = aSocNet(1)
	Case "MS": reqMySpace = aSocNet(1)
	Case "SK": reqSkype = aSocNet(1)
	End Select
	Next
</WTCUSTOM>
</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Govid" project="ptsGovidUser" class="CGovid">
					<WTMETHOD name="FetchMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(GNumber)" value="CONST(&quot;xxxxxx&quot; + Right(.GNumber, 4))">
						<WTCONDITION expr="ATTR(GNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGovid" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(RefName)" value="ATTR(RefName)"/>
					<WTSETATTRIBUTE name="PARAM(Identify)" value="ATTR(Identify)"/>
					<WTSETATTRIBUTE name="CONST(xmlLanguages)" value="CONST(LanguagesXML(.Languages, 1))">
						<WTCONDITION expr="ATTR(Languages)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
						<WTCUSTOM>
							Downlines = .TBPage
							If InStr(Downlines, "B" ) &gt; 0 Then reqBinary = 1
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpInputOptions)" oper="not-equal" value="CONST(&quot;&quot;)"/>
<WTCUSTOM>
		    Set oInputOptions = server.CreateObject("wtSystem.CInputOptions")
			With oInputOptions
				.Load tmpInputOptions
				If reqSysUserGroup &lt;= 23 Then
					tmpDisplayRows = .DisplayRows(0)
				Else
					tmpDisplayRows = .DisplayRows(1)
				End If
			End With	
			Set oInputOptions = Nothing
			reqExtra = 100 + (tmpDisplayRows * 25 )
			If reqExtra &gt; 550 Then reqExtra = 550
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
          <WTCALLSUB name="reqBinary = GetBinary( tmpOptions2 )">
            <WTCONDITION expr="PARAM(Binary)" oper="greater" value="CONST(0)"/>
          </WTCALLSUB>
<!--
				<WTGETCACHE name="CONST(tmpGroupID)" value="GROUPID"/>
				<WTOBJECT name="LeadCampaigns" project="ptsLeadCampaignUser" class="CLeadCampaigns">
					<WTCONDITION expr="IsCompanyWebsite"/>
					<WTMETHOD name="EnumPresent">
						<WTPARAM name="xmlLeadCampaigns" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Grp" direction="input" value="CONST(tmpGroupID)" />
						<WTPARAM name="Grp1" direction="input" value="CONST(0)" />
						<WTPARAM name="Grp2" direction="input" value="CONST(0)" />
						<WTPARAM name="Grp3" direction="input" value="CONST(0)" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()"/>
						<WTPARAM name="Element" direction="input" value="CONST()"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
-->				
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" connector="or"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" connector="and"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="6" name="UploadImage" type="Upload">
				<WTCALLSUB name="UpdateMember"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETCACHE name="MEMBERID" value="PARAM(MemberID)"/>
					<WTSETCACHE name="CONTENTPAGE" value="PARAM(contentpage)"/>
					<WTSETCACHE name="POPUP" value="PARAM(Popup)"/>
					<WTSETCACHE name="PAGE" value="CONST(&quot;0463&quot;)"/>
					<WTRETURN>
						<WTLINK name="0425" return="false">
							<WTPARAM name="contentpage" value="PARAM(contentpage)"/>
						</WTLINK>
					</WTRETURN>			
				</WTCODEGROUP>
			</WTACTION>

      <WTACTION id="14" name="EditGovid" type="Update">
        <WTCALLSUB name="UpdateMember"/>
        <WTCALLSUB name="LoadBilling">
          <WTCONDITION expr="IsErrors"/>
        </WTCALLSUB>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
          <WTLINK name="10903" nolocaldata="true">
            <WTPARAM name="MemberID" value="PARAM(MemberID)"/>
          </WTLINK>
        </WTRETURN>
      </WTACTION>

      <WTACTION id="15" name="CreateShopper" type="Update">
        <WTCALLSUB name="UpdateMember"/>
        <WTCALLSUB name="LoadBilling">
          <WTCONDITION expr="IsErrors"/>
        </WTCALLSUB>
        <WTRETURN>
          <WTCONDITION expr="NoErrors"/>
          <WTLINK name="NewShopper" nolocaldata="true">
            <WTPARAM name="AffiliateID" value="PARAM(MemberID)"/>
            <WTPARAM name="Ret" value="CONST(1)"/>
          </WTLINK>
        </WTRETURN>
      </WTACTION>

      <!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ViewCampaign()">
					var id = document.getElementById('WebsiteID').value;
					if( id != 0 )
					{
						var url, win;
						var member = document.getElementById('MemberID').value;
						url = "pp.asp?p=" + id + "&amp;m=" + member + "&amp;preview=1"
						win = window.open(url,'Presentation');
						win.focus();
					}
			  </WTFUNCTION>
        <WTFUNCTION name="ViewWalletInfo(id)">
          var url, win;
          url = "WalletInfo.asp?memberid=" + id
          win = window.open(url,"WalletInfo","top=100,left=100,height=425,width=650,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>

        <WTFUNCTION name="ShowAddress()">
					var id = document.getElementById('MemberID').value
					var companyid = document.getElementById('CompanyID').value
					src = '3711.asp?OwnerType=4&amp;OwnerID=' + id + '&amp;Companyid=' + companyid
					document.getElementById('AddressFrame').src = src
			    </WTFUNCTION>  
				<WTLOAD>
					ShowAddress();
				</WTLOAD>


				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
          <WTHIDDEN value="ATTR(Member.CompanyID)"/>
        </WTROW>
<!--
				<WTROW>
					<WTSTATIC col="1" merge="2" align="right">
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(IsMaster)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(members.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Members">
								<WTLINK name="0411" nodata="true" target="MasterMembers">
									<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
									<WTPARAM name="MasterID" value="ATTR(Member.MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
	 						<WTCONDITION expr="_IsIconBar"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(icons.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Icons">
								<WTLINK name="0431" nodata="true">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Identify)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(icons.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Identification">
								<WTLINK name="0426" nodata="true" target="Identify">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(icons.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="BillingMethod">
								<WTLINK name="0436" nodata="true" target="Billing">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPayouts"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(icons.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="PayoutMethod">
								<WTLINK name="0441" nodata="true" target="Payout">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Member.IsDiscount)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(icons.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Referrals">
								<WTLINK name="0408" target="Referrals" nodata="true">
									<WTPARAM name="ReferralID" value="PARAM(MemberID)"/>
				 					<WTPARAM name="contentpage" value="CONST(3)"/>
				 					<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsAutoShip"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(icons.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="AutoShip">
								<WTLINK name="0433" nodata="true" target="AutoShip">
									<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
-->
<!--				
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="right">
						<WTCODEGROUP>
	 						<WTCONDITION expr="_IsLogon"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(logon.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="ChangeLogon">
								<WTLINK name="0103" nodata="true" target="Logon">
									<WTPARAM name="popup" value="CONST(1)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(logon.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="ChangePassword">
								<WTLINK name="0106" nodata="true" target="Password">
									<WTPARAM name="popup" value="CONST(1)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
-->
				<WTROW>
					<WTIMAGE col="1" value="CONST(Member.gif)" align="center" class="PageHeader"/>
					<WTSTATIC col="2" align="left" valign="center" class="PageHeading">
						<WTSTATIC value="CONST(#)"/>
						<WTSTATIC value="ATTR(Member.MemberID)"/>
						<WTSTATIC value="CONST(-)"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
								<WTLINK name="Tutorial" target="Tutorial">
									<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-PROFILE)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
									<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>

            <WTCODEGROUP>
              <WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
              <WTCODEGROUP>
                <WTCONDITION expr="IsEmployee"/>
                <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
                <WTCONDITION expr="IsMemberOnly" connector="or"/>
                <WTSTATIC space="1"/>
                <WTIMAGE value="CONST(gcr32.gif)" alt="WalletInfo" path="Company/17" imgalign="absmiddle">
                  <WTLINK name="ViewWalletInfo(&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;)" click="true" />
                </WTIMAGE>
              </WTCODEGROUP>
            </WTCODEGROUP>


            <WTSTATIC>
							<WTCONDITION expr="ATTR(Member.IsCompany)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC value="ATTR(Member.CompanyName)"/>
						</WTSTATIC>
						<WTSTATIC newline="1"/>
						<WTSTATIC fontsize="2" fontcolor="purple">
							<WTSTATIC tag="VisitDate" value="ATTR(Member.VisitDate)" newline="1"/>
							<WTSTATIC tag="EnrollDate" value="ATTR(Member.EnrollDate)" newline="1"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)"/>
								<WTCONDITION expr="ATTR(Member.Price)" oper="not-equal" value="CONST('$0.00')" connector="and"/>
								<WTSTATIC tag="PaidDate" value="ATTR(Member.PaidDate)" space="2"/>
								<WTSTATIC value="ATTR(Member.Price)"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC fontsize="2" fontcolor="blue">
							<WTCONDITION expr="PARAM(PV)" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(BV)" oper="not-equal" value="CONST(0)" connector="or"/>
							<WTCONDITION expr="PARAM(Products)" oper="not-equal" value="CONST('')" connector="or"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@pv,'/',/DATA/PARAM/@bv)&quot;/&gt;))" space="1">
								<WTCONDITION expr="PARAM(PV)" oper="not-equal" value="CONST(0)"/>
								<WTCONDITION expr="PARAM(BV)" oper="not-equal" value="CONST(0)" connector="or"/>
							</WTSTATIC>
							<WTSTATIC value="PARAM(Products)">
								<WTCONDITION expr="PARAM(Products)" oper="not-equal" value="CONST('')"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC fontsize="2">
							<WTCONDITION expr="PARAM(ShowQualify)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC label="NotBonusQualified" fontcolor="red">
								<WTCONDITION expr="ATTR(Member.Qualify)" oper="less-equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="BonusQualified" fontcolor="green">
								<WTCONDITION expr="ATTR(Member.Qualify)" oper="greater" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC space="1"/>
							<WTSTATIC value="CONST(/)" space="1"/>
							<WTSTATIC label="NotPayoutQualified" fontcolor="red">
								<WTCONDITION expr="ATTR(Member.IsIncluded)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC label="PayoutQualified" fontcolor="green">
								<WTCONDITION expr="ATTR(Member.IsIncluded)" oper="not-equal" value="CONST(0)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTROW margin-top="6">
            <WTSTATIC col="1" tag="OrderOption" bold="true"/>
            <WTCOMBO col="2" value="PARAM(OrderOption)">
              <WTOPTION id="0" label="OrderOption_21_0"/>
              <WTOPTION id="1" label="OrderOption_21_1"/>
              <WTOPTION id="2" label="OrderOption_21_2"/>
              <WTOPTION id="3" label="OrderOption_21_3"/>
              <WTOPTION id="4" label="OrderOption_21_4"/>
              <WTOPTION id="5" label="OrderOption_21_5"/>
              <WTOPTION id="6" label="OrderOption_21_6"/>
            </WTCOMBO>
          </WTROW>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Binary)" oper="greater" value="CONST(0)"/>
          <WTROW margin-top="6">
            <WTSTATIC col="1" tag="BinaryPlacement" bold="true"/>
            <WTCOMBO col="2" value="PARAM(Binary)">
              <WTOPTION id="1" label="PlaceWeak"/>
              <WTOPTION id="4" label="PlaceStrong"/>
              <WTOPTION id="2" label="PlaceLeft"/>
              <WTOPTION id="3" label="PlaceRight"/>
            </WTCOMBO>
          </WTROW>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTROW margin-top="6">
            <WTSTATIC col="1" tag="ShopperID" bold="true"/>
            <WTTEXT col="2" value="ATTR(Member.SponsorID)" size="5"/>
            <WTBUTTON col="2" action="15" value="CONST(CreateShopper)" btnclass="smbutton">
              <WTCONDITION expr="ATTR(Member.SponsorID)" oper="equal" value="CONST(0)"/>
            </WTBUTTON>
          </WTROW>
        </WTCODEGROUP>
        <WTROW margin-top="6">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Member.IsCompany)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CompanyName"/>
					<WTTEXT col="2" value="ATTR(Member.CompanyName)" size="50"/>
				</WTROW>

        <WTCODEGROUP>
  				<WTCONDITION expr="ATTR(Member.CompanyID)" oper="not-equal" value="SYSCON(GCR)"/>
  				<WTROW>
					  <WTSTATIC col="1" tag="Email"/>
					  <WTTEXT col="2" value="ATTR(Member.Email)" size="50"/>
				  </WTROW>
        </WTCODEGROUP>  
        <WTCODEGROUP>
  				<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="SYSCON(GCR)"/>
  				<WTROW>
					  <WTHIDDEN value="ATTR(Member.Email)"/>
				  </WTROW>
  				<WTROW height="18">
					  <WTSTATIC col="1" tag="Email"/>
					  <WTSTATIC col="2" value="ATTR(Member.Email)" bold="true"/>
					  <WTSTATIC col="2" label="EmailLocked" fontcolor="blue"/>
				  </WTROW>
        </WTCODEGROUP>  
  
				<WTROW>
	 				<WTCONDITION expr="_IsSales"/>
	 				<WTCONDITION expr="_IsMentor" connector="or"/>
					<WTSTATIC col="1" tag="Email2"/>
					<WTTEXT col="2" value="ATTR(Member.Email2)" size="50"/>
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(Email2)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Phone1"/>
					<WTTEXT col="2" value="ATTR(Member.Phone1)" size="30"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(12)"/>
					<WTSTATIC col="1" tag="Phone2"/>
					<WTTEXT col="2" value="ATTR(Member.Phone2)" size="30"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(12)"/>
					<WTSTATIC col="1" tag="Fax"/>
					<WTTEXT col="2" value="ATTR(Member.Fax)" size="30"/>
				</WTROW>

				<WTROW margin-top="3">
					<WTCONDITION expr="CONST(count(DATA/TXN/PTSLANGUAGES/ENUM))" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="PreferredLanguage"/>
					<WTCOMBO col="2" value="ATTR(Member.Icons)" datapath="/DATA/TXN/PTSLANGUAGES/ENUM" setselected="true"/>
				</WTROW>
				
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="AutoShipDate"/>
					<WTTEXT col="2" value="ATTR(Member.AutoShipDate)"/>
				</WTROW>

				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="Timezone" />
					<WTCOMBO col="2" value="ATTR(Member.Timezone)" />
				</WTROW>
<!--				
				<WTROW margin-top="3">
					<WTCONDITION expr="_IsCompanyWebsite"/>
					<WTSTATIC col="1" tag="WebsiteID"/>
					<WTCOMBO col="2" value="ATTR(Member.WebsiteID)" datapath="/DATA/TXN/PTSLEADCAMPAIGNS/ENUM" setselected="true"/>
					<WTBUTTON col="2" value="CONST(Preview)" btnclass="smbutton">
						<WTCLICK>ViewCampaign()</WTCLICK>
					</WTBUTTON>
				</WTROW>
-->				
				<WTROW margin-top="3">
					<WTCONDITION expr="_IsPayouts"/>
					<WTSTATIC col="1" tag="Govid"/>
					<WTSTATIC col="2">
						<WTSTATIC value="ATTR(Govid.GType)" enum="true"/>
						<WTSTATIC value="CONST(:)" space="1"/>
						<WTSTATIC value="ATTR(Govid.GNumber)" bold="true"/>
					</WTSTATIC>
					<WTBUTTON col="2" action="14" value="CONST(Edit)" btnclass="smbutton"/>
				</WTROW>
<!--
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="TaxID"/>
					<WTCOMBO col="2" value="ATTR(Member.TaxIDType)"/>
					<WTTEXT col="2" value="ATTR(Member.TaxID)"/>
				</WTROW>
-->				
<!--
				<WTROW margin-top="6">
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Member.PromoID)"/>
					<WTSTATIC col="2">
						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(Overdraft)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
-->
				<!-- ======================================================================= -->
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTFRAME col="1" merge="2" src="" name="AddressFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="160" label="NoFrameSupport" border="0"/>
				</WTROW>

				<WTCODEGROUP>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" merge="2" align="left" class="Prompt">
							<WTSTATIC label="ImageHelp">
								<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(12)"/>
							</WTSTATIC>
							<WTSTATIC label="ImageHelp12">
								<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(12)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" valign="bottom" tag="Image"/>
						<WTBUTTON col="2" action="6" value="CONST(Upload)"/>
						<WTIMAGE col="2" value="ATTR(Member.Image)" align="left" valign="top" path="Member" imgwidth="100">
							<WTCONDITION expr="ATTR(Member.Image)" oper="not-equal" value="''"/>
						</WTIMAGE>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotMemberOnly"/>
					<WTCONDITION expr="_IsSuspect" connector="or"/>
					<WTCONDITION expr="_IsSales" connector="or"/>
					<WTCONDITION expr="_IsService" connector="or"/>
					
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Signature" align="left"/>
						<WTSTATIC col="2" align="right" label="MoreSignatures" bold="true">
							<WTLINK name="6111" target="Signature" nodata="true">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							</WTLINK>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Member.Signature)" cols="72" rows="10" htmleditor="editor" embedhtml="true"/>
					</WTROW>

					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" label="SignatureText" class="prompt" />
					</WTROW>
				</WTCODEGROUP>

				<!-- ======================================================================= -->
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
				</WTROW>
<!--				
				<WTROW>
					<WTSTATIC col="1" tag="GroupID"/>
					<WTTEXT col="2" value="ATTR(Member.GroupID)"/>
					<WTSTATIC col="2" tag="Alerts"/>
					<WTTEXT col="2" value="ATTR(Member.Role)" size="20" prespace="false"/>
				</WTROW>
-->
<!--
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(12)"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="OriginalGroup"/>
						<WTSTATIC col="2" value="ATTR(Member.Referral)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="Group"/>
						<WTTEXT col="2" value="ATTR(Member.GroupID)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="Donate"/>
						<WTSTATIC col="2">
							<WTCODEGROUP>
								<WTTEXT value="ATTR(Member.Role)" size="3"/>
								<WTSTATIC label="DonateText"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
-->        
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Member.CompanyID)" oper="not-equal" value="CONST(12)"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Member.GroupID)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Member.GroupID)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" tag="GroupID"/>
						<WTSTATIC col="2" value="ATTR(Member.GroupID)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="ATTR(Member.Reference)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1">
						<WTSTATIC value="PARAM(RefName)" space="2">
							<WTCONDITION expr="PARAM(RefName)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC tag="Reference">
							<WTCONDITION expr="PARAM(RefName)" oper="equal" value="CONST('')"/>
						</WTSTATIC>
					</WTSTATIC>
					<WTSTATIC col="2" value="ATTR(Member.Reference)"/>
					<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Member.Referral)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="2">
							<WTSTATIC space="5"/>
							<WTSTATIC label="Referring" space="1"/>
							<WTSTATIC value="PARAM(RefName)" space="2">
								<WTCONDITION expr="PARAM(RefName)" oper="not-equal" value="CONST('')"/>
							</WTSTATIC>
							<WTSTATIC tag="Reference">
								<WTCONDITION expr="PARAM(RefName)" oper="equal" value="CONST('')"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC col="2" value="ATTR(Member.Referral)"/>
					</WTCODEGROUP>
				</WTROW>

				<!-- ======================================================================= -->
				<WTCODEGROUP>
					<WTCONDITION expr="_IsSocNetPublic"/>
					<WTROW margin-top="6" margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" merge="2" align="left" label="SocNetText" class="prompt" />
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="FaceBookUser"/>
						<WTTEXT col="2" value="PARAM(FaceBook)"/>
						<WTIMAGE col="2" value="CONST(social-FaceBook.png)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="TwitterUser"/>
						<WTTEXT col="2" value="PARAM(Twitter)"/>
						<WTIMAGE col="2" value="CONST(social-Twitter.png)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="GoogleUser"/>
						<WTTEXT col="2" value="PARAM(Google)"/>
						<WTIMAGE col="2" value="CONST(social-Google.png)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="PinterestUser"/>
						<WTTEXT col="2" value="PARAM(Pinterest)"/>
						<WTIMAGE col="2" value="CONST(social-Pinterest.png)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="TumblrUser"/>
						<WTTEXT col="2" value="PARAM(Tumblr)"/>
						<WTIMAGE col="2" value="CONST(social-Tumblr.png)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="LinkedInUser"/>
						<WTTEXT col="2" value="PARAM(LinkedIn)"/>
						<WTIMAGE col="2" value="CONST(social-LinkedIn.png)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="MySpaceUser"/>
						<WTTEXT col="2" value="PARAM(MySpace)"/>
						<WTIMAGE col="2" value="CONST(social-MySpace.png)" imgalign="absmiddle"/>
					</WTROW>
					<WTROW height="36">
						<WTSTATIC col="1" tag="SkypeUser"/>
						<WTTEXT col="2" value="PARAM(Skype)"/>
						<WTIMAGE col="2" value="CONST(social-Skype.png)" imgalign="absmiddle"/>
					</WTROW>
				</WTCODEGROUP>
<!--        
				<WTCODEGROUP>
					<WTCONDITION expr="_IsMsgs"/>
					<WTROW margin-top="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
					</WTROW>
					<WTROW>
						<WTCHECK col="1" merge="2" value="ATTR(Member.IsMsg)" align="center"/>
						<WTCHECK col="1" merge="2" value="ATTR(Member.IsMsgs)"/> 
					</WTROW>
				</WTCODEGROUP>
-->        
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Popup)" oper="greater" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTSTATIC col="1" merge="2" label="Updated" fontcolor="red" bold="true">
						<WTCONDITION expr="PARAM(Action)" oper="equal" value="CONST(1)" />
					</WTSTATIC>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_0463" caption="Member Profile" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="m_0463" mobile="MobileHome.asp" secured="52" track="0">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="RefName" datatype="text"/>
			<WTPARAM name="Action" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="UpdateMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTES/>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Len(.Signature))" oper="less" value="CONST(8)"/>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Action)" value="CONST(1)">
						<WTCONDITION expr="NoErrors"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(RefName)" value="ATTR(RefName)"/>
				</WTOBJECT>
				<WTOBJECT name="Titles" project="ptsTitleUser" class="CTitles">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlTitles" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="2" name="Logon" type="Update">
				<WTRETURN>
					<WTLINK name="m_0103" nolocaldata="true"/>
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="3" name="Password" type="Update">
				<WTRETURN>
					<WTLINK name="m_0106" nolocaldata="true"/>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>

				<WTFUNCTION name="ShowAddress()">
					var id = document.getElementById('MemberID').value
					var companyid = document.getElementById('CompanyID').value
					src = 'm_3711.asp?OwnerType=4&amp;OwnerID=' + id + '&amp;Companyid=' + companyid
					document.getElementById('AddressFrame').src = src
				</WTFUNCTION>
				<WTLOAD>
					ShowAddress();
				</WTLOAD>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="ATTR(Member.CompanyID)"/>
				</WTROW>
				<WTSTATIC label="IsCompany"/>
				<WTSTATIC label="GMTm12"/>
				<WTSTATIC label="GMTm11"/>
				<WTSTATIC label="GMTm10"/>
				<WTSTATIC label="GMTm9"/>
				<WTSTATIC label="GMTm8"/>
				<WTSTATIC label="GMTm7"/>
				<WTSTATIC label="GMTm6"/>
				<WTSTATIC label="GMTm5"/>
				<WTSTATIC label="GMTm4"/>
				<WTSTATIC label="GMTm3"/>
				<WTSTATIC label="GMTm2"/>
				<WTSTATIC label="GMTm1"/>
				<WTSTATIC label="GMT"/>
				<WTSTATIC label="GMTp1"/>
				<WTSTATIC label="GMTp2"/>
				<WTSTATIC label="GMTp3"/>
				<WTSTATIC label="GMTp4"/>
				<WTSTATIC label="GMTp5"/>
				<WTSTATIC label="GMTp6"/>
				<WTSTATIC label="GMTp7"/>
				<WTSTATIC label="GMTp8"/>
				<WTSTATIC label="GMTp9"/>
				<WTSTATIC label="GMTp10"/>
				<WTSTATIC label="GMTp11"/>
				<WTSTATIC label="GMTp12"/>
				
				<WTROW>
					<WTIMAGE col="1" value="CONST(Member.gif)" align="center"/>
					<WTSTATIC col="2" align="left" valign="center" class="PageHeading">
						<WTSTATIC value="CONST(#)"/>
						<WTSTATIC value="ATTR(Member.MemberID)"/>
						<WTSTATIC value="CONST(-)"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Member.IsCompany)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC value="ATTR(Member.CompanyName)"/>
						</WTSTATIC>
						<WTSTATIC newline="1"/>
						<WTSTATIC fontsize="1" fontcolor="purple">
							<WTSTATIC tag="VisitDate" value="ATTR(Member.VisitDate)" newline="1"/>
							<WTSTATIC tag="EnrollDate" value="ATTR(Member.EnrollDate)" newline="1"/>
							<WTSTATIC tag="PaidDate" value="ATTR(Member.PaidDate)">
								<WTCONDITION expr="ATTR(Member.Billing)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				
				<WTROW margin-top="3">
					<WTCONDITION expr="ATTR(Member.CompanyID)" oper="equal" value="CONST(7)"/>
					<WTSTATIC col="1" merge="2" align="center">
						<WTSTATIC label="ReferralLink" bold="true" newline="1"/>
						<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@logon&quot;/&gt;.myTrackerPro.com)" fontcolor="blue" bold="true"/>
					</WTSTATIC>
				</WTROW>
				
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Member.Email)" size="28"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTCONDITION expr="_IsSales"/>
					<WTCONDITION expr="_IsMentor" connector="or"/>
					<WTSTATIC col="1" tag="Email2"/>
					<WTTEXT col="2" value="ATTR(Member.Email2)" size="28"/>
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(Email2)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="Phone1"/>
					<WTTEXT col="2" value="ATTR(Member.Phone1)" size="28"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="Phone2"/>
					<WTTEXT col="2" value="ATTR(Member.Phone2)" size="28"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="Fax"/>
					<WTTEXT col="2" value="ATTR(Member.Fax)" size="28"/>
				</WTROW>
<!--
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="AutoShipDate"/>
					<WTTEXT col="2" value="ATTR(Member.AutoShipDate)"/>
				</WTROW>
-->				
				<WTROW margin-top="3">
					<WTSTATIC col="1" tag="Timezone" />
					<WTCOMBO col="2" value="ATTR(Member.Timezone)" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTSTATIC col="1" merge="2" label="Updated" fontcolor="red" bold="true">
						<WTCONDITION expr="PARAM(Action)" oper="equal" value="CONST(1)" />
					</WTSTATIC>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW margin-top="3" margin-bottom="3">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTFRAME col="1" merge="2" src="" name="AddressFrame" frmclass="FrameNoScroll" frmwidth="100%" frmheight="160" label="NoFrameSupport" border="0"/>
				</WTROW>
<!--
				<WTCODEGROUP>
					<WTCONDITION expr="NotMemberOnly"/>
					<WTCONDITION expr="_IsSuspect" connector="or"/>
					<WTCONDITION expr="_IsSales" connector="or"/>
					<WTCONDITION expr="_IsService" connector="or"/>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" tag="Signature" align="left"/>
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Member.Signature)" cols="35" rows="6" htmleditor="basic" embedhtml="true"/>
					</WTROW>

					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="left" label="SignatureText" class="prompt" />
					</WTROW>
				</WTCODEGROUP>
-->
				<!-- ======================================================================= -->
				<WTROW margin-top="3" margin-bottom="3">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(medium)"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSTITLES/ENUM))" oper="greater" value="CONST(1)"/>
					<WTSTATIC col="1" tag="Title"/>
					<WTCOMBO col="2" value="ATTR(Member.Title)" datapath="/DATA/TXN/PTSTITLES/ENUM" setselected="true"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTSTATIC col="1">
						<WTSTATIC value="PARAM(RefName)" space="2">
							<WTCONDITION expr="PARAM(RefName)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC tag="Reference">
							<WTCONDITION expr="PARAM(RefName)" oper="equal" value="CONST('')"/>
						</WTSTATIC>
					</WTSTATIC>
					<WTTEXT col="2" value="ATTR(Member.Reference)" size="10"/>
				</WTROW>
<!--				
				<WTROW margin-top="3">
					<WTSTATIC col="1" label="GroupID" space="2"/>
					<WTTEXT col="2" value="ATTR(Member.GroupID)" size="10"/>
				</WTROW>
-->
				<WTROW margin-top="3">
					<WTSTATIC col="1" label="MentorID" space="2"/>
					<WTTEXT col="2" value="ATTR(Member.MentorID)" size="10"/>
				</WTROW>


				<!-- ======================================================================= -->

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
				</WTROW>
<!--				
				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(ChangeLogon)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(ChangePassword)" align="center"/>
				</WTROW>
-->				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0464" caption="Edit Member" header="false" navbar="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSUB function="TestActiveMembers(prmMasterID)">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ActiveCount">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MasterID" direction="input" value="CONST(prmMasterID)"/>
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="MaxCount">
						<WTPARAM name="MasterID" direction="input" value="CONST(prmMasterID)"/>
						<WTPARAM name="reqMax" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(reqCount))" oper="less" value="CONST(0)"/>
						<WTCONDITION expr="CONST(reqCount)" oper="equal" value="CONST(reqMax)" connector="or"/>
						<WTERROR number="10111" message="Oops, You have exceeded the maximum number of allowed active members."/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTES/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="ATTR(Status)"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-STATUS-PAID)" connector="and"/>
						<WTCALLSUB name="TestActiveMembers(.MasterID)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Delete">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ShowAddress()">
					var id = document.getElementById('MemberID').value
					var companyid = document.getElementById('CompanyID').value
					src = '3711.asp?OwnerType=4&amp;OwnerID=' + id + '&amp;Companyid=' + companyid
					document.getElementById('AddressFrame').src = src
			    </WTFUNCTION>  
				<WTLOAD>
					ShowAddress();
				</WTLOAD>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="ATTR(Member.CompanyID)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="right">
						<WTCODEGROUP>
	 						<WTCONDITION expr="_IsLogon"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(logon.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="ChangeLogon">
								<WTLINK name="0103" nodata="true" target="Logon">
									<WTPARAM name="popup" value="CONST(1)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(logon.gif)" imgalign="absmiddle"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="ChangePassword">
								<WTLINK name="0106" nodata="true" target="Password">
									<WTPARAM name="popup" value="CONST(1)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
								</WTLINK>
							</WTSTATIC>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(Member.gif)" align="center"/>
					<WTSTATIC col="2" align="left" valign="center" class="PageHeading">
						<WTSTATIC value="CONST(#)"/>
						<WTSTATIC value="ATTR(Member.MemberID)"/>
						<WTSTATIC value="CONST(-)"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
						<WTSTATIC newline="1"/>
						<WTSTATIC fontsize="2" fontcolor="purple">
							<WTSTATIC tag="VisitDate" value="ATTR(Member.VisitDate)" newline="1"/>
							<WTSTATIC tag="EnrollDate" value="ATTR(Member.EnrollDate)" newline="1"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" tag="MemberName"/>
					<WTTEXT col="2" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
					<WTTEXT col="2" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Member.Email)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status"/>
					<WTCOMBO col="2" value="ATTR(Member.Status)">
						<WTOPTION id="1" label="Active"/>
						<WTOPTION id="5" label="Inactive"/>
					</WTCOMBO>
<!--
					<WTSTATIC col="2" tag="Dept"/>
					<WTTEXT col="2" value="ATTR(Member.Role)" size="15" noprespace="true"/>
-->					
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone1"/>
					<WTTEXT col="2" value="ATTR(Member.Phone1)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone2"/>
					<WTTEXT col="2" value="ATTR(Member.Phone2)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Fax"/>
					<WTTEXT col="2" value="ATTR(Member.Fax)" size="30"/>
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTFRAME col="1" merge="2" src="" name="AddressFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="80" label="NoFrameSupport" border="0"/>
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" align="center" msg="ConfirmDelete"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="0465" caption="Lookup Logon" header="false" footer="false" navbar="false"  wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="125">
      <!--============================================================================================-->
      <WTPARAM name="Logon" datatype="text"/>

      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTMETHOD name="FetchLogon">
            <WTPARAM name="Logon" direction="input" value="PARAM(Logon)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="ATTR(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="600" align="center"/>

        <WTROW margin-top="12">
          <WTSTATIC col="1" label="LogonLookup" class="PageHeading"/>
        </WTROW>
        
        <WTROW margin-top="12">
          <WTSTATIC col="1" tag="Logon"/>
          <WTTEXT col="1" value="PARAM(Logon)"/>
        </WTROW>

        <WTROW margin-top="12">
          <WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST('')"/>
          <WTSTATIC col="1" class="PageHeading">
            <WTSTATIC value="CONST(#)"/>
            <WTSTATIC value="ATTR(Member.MemberID)"/>
            <WTSTATIC value="CONST(-)"/>
            <WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
            <WTSTATIC value="ATTR(Member.NameLast)"/>
            <WTSTATIC value="CONST(- ()"/>
            <WTSTATIC value="ATTR(Member.CompanyID)"/>
            <WTSTATIC value="CONST())"/>
          </WTSTATIC>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" action="0" value="CONST(Submit)" align="center"/>
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
		<WTWEBPAGE name="0455" caption="Extra Info" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0455">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(InputOptions)" value="CONST(tmpInputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(1100)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>

					<WTINPUTOPTIONS name="CONST(tmpInputOptions)" values="ATTR(InputValues)" secure="23"/>

					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="300" align="left"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="Updated" fontcolor="red" align="center" class="PageHeading"/>
				</WTROW>

				<WTINPUTOPTIONS name="InputOptions" values="InputValues" entity="Member" secure="23"/>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0459" caption="BV QV" navbar="false" header="false" footer="false" page-width="400" wrapper="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0459">
			<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(1100)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="300" align="left"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC label="Updated" fontcolor="red">
							<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="BV"/>
					<WTTEXT col="2" value="ATTR(Member.BV)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="QV"/>
					<WTTEXT col="2" value="ATTR(Member.QV)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="BV2"/>
					<WTTEXT col="2" value="ATTR(Member.BV2)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="QV2"/>
					<WTTEXT col="2" value="ATTR(Member.QV2)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="BV3"/>
					<WTTEXT col="2" value="ATTR(Member.BV3)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="QV3"/>
					<WTTEXT col="2" value="ATTR(Member.QV3)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="BV4"/>
					<WTTEXT col="2" value="ATTR(Member.BV4)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="QV4"/>
					<WTTEXT col="2" value="ATTR(Member.QV4)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0414" caption="Member Status" contentpage="true" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" 
		focus="false" secured="61">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="Months" datatype="number"/>
			<WTPARAM name="Change" datatype="number"/>
			<WTPARAM name="PaidUp" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB function="ActiveMembers(prmCompanyID, prmMasterID)">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ActiveCount">
						<WTPARAM name="CompanyID" direction="input" value="CONST(prmCompanyID)"/>
						<WTPARAM name="MasterID" direction="input" value="CONST(prmMasterID)"/>
						<WTPARAM name="tmpActiveCount" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(tmpActiveCount))" oper="less" value="CONST(0)"/>
						<WTERROR number="10111" message="Oops, You have exceeded the maximum number of allowed active members."/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpTerm)" value="FORM(Term)"/>
					<WTSETATTRIBUTE name="CONST(tmpImmediate)" value="FORM(Immediate)"/>
					<WTSETATTRIBUTE name="CONST(tmpMonths)" value="FORM(Months)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatusChange)" value="FORM(StatusChange)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevelChange)" value="FORM(LevelChange)"/>
					<WTSETATTRIBUTES/>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
						<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="SYSCON(MEMBER-PAID)" connector="and"/>
						<WTCALLSUB name="ActiveMembers .CompanyID, .MasterID"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCODEGROUP>
							<!-- If NO Billing -->
							<WTCONDITION expr="ATTR(Billing)" oper="less-equal" value="SYSCON(MEMBER-BILL-NONE)"/>
							<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(LevelChange)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(0)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- If Billing -->
							<WTCONDITION expr="ATTR(Billing)" oper="greater" value="SYSCON(MEMBER-BILL-NONE)"/>
							<WTCODEGROUP>
								<!-- If previous Status was Active -->
								<WTCONDITION expr="CONST(tmpStatus)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
								<WTCODEGROUP>
									<!-- If NOT changing FROM Active Status - check for future status change-->
									<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
									<WTSETATTRIBUTE name="PARAM(Change)" value="SYSCON(YES)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<!-- If changing FROM Active Status -->
									<WTCONDITION expr="ATTR(Status)" oper="not-equal" value="SYSCON(MEMBER-PAID)"/>
									<WTSETATTRIBUTE name="ATTR(StatusChange)" value="ATTR(Status)"/>
									<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MEMBER-PAID)"/>
									<!-- Calculate Date to Change Status -->
									<WTCODEGROUP>
										<!-- If they've never paid before - change status after 1 month from now -->
										<WTCONDITION expr="ATTR(PaidDate)" oper="equal" value="CONST(&quot;&quot;)"/>
										<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, 1, Date()))"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<!-- If they've Paid before -->
										<WTCONDITION expr="ATTR(PaidDate)" oper="not-equal" value="CONST(&quot;&quot;)"/>
										<WTCODEGROUP>
											<!-- If NOT Paid Up - change status on PaidDate + 1 month -->
											<WTCONDITION expr="CONST(DATEDIFF(&quot;d&quot;, Date(), .PaidDate))" oper="less" value="CONST(0)"/>
											<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<!-- If Paid Up - change status on PaidDate -->
											<WTCONDITION expr="CONST(DATEDIFF(&quot;d&quot;, Date(), .PaidDate))" oper="greater-equal" value="CONST(0)"/>
											<!-- If the user selected change at next bill date-->
											<WTCODEGROUP>
												<WTCONDITION expr="CONST(tmpImmediate)" oper="equal" value="CONST(1)"/>
												<WTSETATTRIBUTE name="ATTR(StatusDate)" value="ATTR(PaidDate)"/>
											</WTCODEGROUP>
											<!-- If the user selected change immediately-->
											<WTCODEGROUP>
												<WTCONDITION expr="CONST(tmpImmediate)" oper="equal" value="CONST(2)"/>
												<WTSETATTRIBUTE name="ATTR(Status)" value="ATTR(StatusChange)"/>
												<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(0)"/>
												<WTSETATTRIBUTE name="ATTR(LevelChange)" value="CONST(0)"/>
												<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(0)"/>
											</WTCODEGROUP>
										</WTCODEGROUP>
									</WTCODEGROUP>
								</WTCODEGROUP>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<!-- If previous Status was NOT Active AND If changing TO Active Status - check for future status change -->
								<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="SYSCON(MEMBER-PAID)"/>
								<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-PAID)" connector="and"/>
								<WTSETATTRIBUTE name="PARAM(Change)" value="SYSCON(YES)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<!-- If we need to check for a future status change -->
								<WTCONDITION expr="PARAM(Change)" oper="equal" value="SYSCON(YES)"/>
								<WTCODEGROUP>
									<!-- If NOT Changing the Status back in the future -->
									<WTCONDITION expr="CONST(tmpTerm)" oper="equal" value="CONST(1)"/>
									<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(0)"/>
									<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(0)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<!-- If Change Status After a specified number of months -->
									<WTCONDITION expr="CONST(tmpTerm)" oper="equal" value="CONST(2)"/>
									<WTCODEGROUP>
										<!-- If They specified the number of months -->
										<WTCONDITION expr="CONST(IsNumeric(tmpMonths))" oper="equal" value="CONST(TRUE)"/>
										<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(tmpStatusChange)"/>
										<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, tmpMonths, Date()))"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<!-- If They did NOT specified the number of months - dont' change back-->
										<WTCONDITION expr="CONST(IsNumeric(tmpMonths))" oper="equal" value="CONST(FALSE)"/>
										<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(0)"/>
										<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(0)"/>
									</WTCODEGROUP>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
	 					<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Months)" value="CONST(1)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaidUp)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
						<WTCONDITION expr="ATTR(PaidDate)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTCONDITION expr="CONST(CDATE(.PaidDate))" oper="greater-equal" value="CONST(CDATE(reqSysDate))" connector="and"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ToggleActiveStatus()">
					if (document.getElementById('Status').value == 1 ) {
						document.getElementById('Term').style.display = '';
					}
					else {
						document.getElementById('Term').style.display = 'none';
					}
					if ( document.getElementById('PaidUp').value == 0) {
						document.getElementById('Immediate').style.display = 'none';
					}	
					else {
						if (document.getElementById('Status').value > 1) {
							document.getElementById('Immediate').style.display = '';
						}	
						else {
							document.getElementById('Immediate').style.display = 'none';
						}	
					}	
			    </WTFUNCTION>  
				<WTFUNCTION name="ToggleChangeStatus()">
					if (document.getElementById('Term').checked)
						document.getElementById('ChangeTo').style.display = '';
					else 
						document.getElementById('ChangeTo').style.display = 'none';
			    </WTFUNCTION>  
				<WTLOAD>ToggleActiveStatus();ToggleChangeStatus();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(PaidUp)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" tag="Member" value="ATTR(Member.CompanyName)" bold="true" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="ChangeStatusText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="PaidDate" height="18"/>
					<WTSTATIC col="2" value="ATTR(Member.PaidDate)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="NewStatus"/>
					<WTCOMBO  col="2" value="ATTR(Member.Status)">
						<WTOPTION id="1" label="Paid"/>
						<WTOPTION id="3" label="Free"/>
						<WTOPTION id="5" label="Inactive"/>
						<WTCHANGE>ToggleActiveStatus();</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW id="Term">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="LeaveTerm"/>
							<WTRADIO col="2" group="Term" name="1" check="first" label="Indefinate">
								<WTCLICK>ToggleChangeStatus()</WTCLICK>
							</WTRADIO>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTRADIO col="2" group="Term" name="2" label="LeaveFor">
								<WTCLICK>ToggleChangeStatus()</WTCLICK>
							</WTRADIO>
							<WTTEXT col="2" value="PARAM(Months)" size="1"/>
							<WTSTATIC col="2" label="Months"/>
						</WTROW>
						<WTROW margin-top="6" id="ChangeTo">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" space="5"/>
							<WTSTATIC col="2" tag="ChangeTo"/>
							<WTCOMBO  col="2" value="ATTR(Member.StatusChange)">
								<WTOPTION id="1" label="Paid"/>
								<WTOPTION id="3" label="Free"/>
								<WTOPTION id="5" label="Inactive"/>
							</WTCOMBO>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="Immediate">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTRADIO col="2" group="Immediate" name="1" check="first" label="OnPaidDate"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTRADIO col="2" group="Immediate" name="2" label="Immediate"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTCONDITION expr="IsMemberBusiness" connector="or" paren="start"/>
						<WTCONDITION expr="ATTR(Member.MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and" paren="end"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0415" caption="Mentoring Notes" navbar="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="52">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="NewDate" datatype="date"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<!-- SAVE MEMBERID BEING MENTORED -->
				<WTSETCACHE name="MentoringID" value="PARAM(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTSETCACHE>
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(Clng(tmpMentoringID))" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>			
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="75" align="center"/>
				<WTCOLUMN width="600" align="center"/>
				<WTCOLUMN width="75" align="center"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" label="MentorNotes" value="ATTR(Member.MemberName)" class="PageHeading"/>
					<WTBUTTON col="1" merge="3" value="CONST(Close)" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTFRAME col="2" src="CONST(9011.asp?OwnerType=-4&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;&amp;amp;NewDate=&lt;xsl:value-of select=&quot;/DATA/PARAM/@newdate&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyname&quot;/&gt;)" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="600" label="NoFrameSupport" border="0"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0404" caption="Member Back-Office" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0404" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="EmployeeID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Upgrade" datatype="number"/>
			<WTPARAM name="TBImage" datatype="text"/>
			<WTPARAM name="Identify" datatype="number"/>
			<WTPARAM name="NewMember" datatype="number"/>
			<WTPARAM name="VisitDate" datatype="text"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="Level" datatype="number"/>
			<WTPARAM name="Test" datatype="number"/>
			<WTPARAM name="Warn" datatype="number"/>
			<WTPARAM name="Options2" datatype="text"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
<!--
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
-->
			<WTCODEGROUP>
<WTCUSTOM>
tmpUserAgent = Request.ServerVariables("HTTP_USER_AGENT")
If InStr(tmpUserAgent, "MSIE 8.0" ) &gt; 0 OR InStr(tmpUserAgent, "MSIE 9.0" ) &gt; 0 Then reqWarn = 1
</WTCUSTOM>			
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;BrowserWarning.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLWarn" direction="return" datatype="text"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;HTMLWarn&quot;)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTINCLUDE name="LimitedAccess.asp"/>
			<WTINCLUDE name="MemberOptions.asp"/>
			<WTINCLUDE name="Encript.asp"/>

			<WTDATATXN name="HTMLMember"/>
			<WTDATATXN name="HTMLWarn"/>
			<WTDATATXN name="DB"/>
			<WTDATATXN name="Icons"/>
<!--			<WTINCLUDE name="DB.asp"/>-->


			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Test)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>Response.write Request.Cookies("temppts")</WTCUSTOM>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTGETCACHE name="PARAM(Identify)" value="IDENTIFY"/>
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
					<WTSETATTRIBUTE name="SYS(MemberID)" value="PARAM(MemberID)"/>
					<WTSETCACHE name="SYS(MemberID)" value="SYS(MemberID)"/>
					<WTSETATTRIBUTE name="PARAM(NewMember)" value="SYSCON(TRUE)"/>
				</WTCODEGROUP>
				<!-- Check for Employee switching over to a Member -->
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(EmployeeID)" oper="greater" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(NewMember)" value="SYSCON(TRUE)"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTSETATTRIBUTE name="SYS(usergroup)" value="CONST(41)"/>
							<WTSETCACHE name="SYS(usergroup)" value="SYS(usergroup)"/>
							<WTSETATTRIBUTE name="SYS(userid)" value="ATTR(Member.AuthUserID)"/>
							<WTSETCACHE name="SYS(userid)" value="SYS(userid)"/>
							<WTSETATTRIBUTE name="SYS(memberid)" value="PARAM(MemberID)"/>
							<WTSETCACHE name="SYS(memberid)" value="SYS(memberid)"/>
							<WTSETATTRIBUTE name="SYS(CompanyID)" value="ATTR(Member.CompanyID)"/>
							<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
							<WTSETATTRIBUTE name="SYS(NAVBARIMAGE)" value="CONST(&quot;Images/Company/&quot; + CSTR(reqSysCompanyID) + &quot;/navbarimage.gif&quot;)"/>
							<WTSETCACHE name="SYS(NAVBARIMAGE)" value="SYS(NAVBARIMAGE)"/>
							<WTSETCACHE name="SECURITYLEVEL" value="ATTR(Member.Secure)"/>
							<WTSETCACHE name="SYS(UserMode)" value="SYS(UserMode)"/>
							<WTCALLSUB name="tmpAccess = LimitedAccess( .AccessLimit )"/>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(tmpAccess)" oper="equal" value="CONST(0)"/>
								<WTERROR number="-2147220514" message="Oops, Your access to the system has been limited - Access Denied."/>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTOBJECT>
				</WTCODEGROUP>
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(NewMember)" oper="equal" value="SYSCON(TRUE)"/>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETCACHE name="VISITDATE" value="ATTR(Member.VisitDate)"/>
						<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(Member.CompanyID)"/>
						<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Member.Status)"/>
						<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Member.Level)"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberOptions)" value="ATTR(Member.Options)"/>
					</WTOBJECT>
					<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="FetchCompany">
							<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
						</WTMETHOD>			
						<WTMETHOD name="Load">
							<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(FreeOptions)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options2)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options3)"/>
						</WTCODEGROUP>

						<WTCALLSUB name="reqSysUserOptions = GetUserOptions(CompanyOptions, tmpMemberOptions)"/>
						<WTSETCACHE name="SYS(UserOptions)" value="SYS(UserOptions)"/>
					</WTOBJECT>
				</WTCODEGROUP>
<WTCUSTOM>
		If reqVisitDate = "" Then reqVisitDate = GetCache("VISITDATE")
</WTCUSTOM>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(Member.CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(Level)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="PARAM(Options2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="CONST(tmpTitle)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(tmpIcons)" value="ATTR(Icons)"/>
					<WTSETATTRIBUTE name="CONST(tmpRef)" value="ATTR(Reference)"/>
					<WTSETATTRIBUTE name="CONST(tmpLogon)" value="ATTR(Member.Logon)"/>
					<WTSETATTRIBUTE name="CONST(tmpSocNet)" value="ATTR(Member.SocNet)">
						<WTCONDITION expr="IsSocNetPublic"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)">
						<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="ATTR(GroupID)"/>
					</WTSETATTRIBUTE>

					<WTCODEGROUP>
			 			<WTCONDITION expr="CONST(tmpTitle)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(Replace(reqSysUserOptions,&quot;A&quot;,&quot;&quot;))"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(Replace(reqSysUserOptions,&quot;o&quot;,&quot;&quot;))"/>
						<WTSETCACHE name="SYS(UserOptions)" value="SYS(UserOptions)"/>
					</WTCODEGROUP>
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberOnly"/>
						<WTCONDITION expr="NotSkipJumpStart" connector="and"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(reqSysUserOptions + &quot;8&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Options)" value="CONST(.Options + &quot;8&quot;)"/>
						<WTSETCACHE name="SYS(UserOptions)" value="SYS(UserOptions)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
-->					
					<!-- If we have identification info, turn off identify for this page -->
<WTCUSTOM>
				tmp = Replace(.Identification, ",", "" )
				If tmp &lt;&gt; "" Then reqIdentify = 0
</WTCUSTOM>
					<WTSETATTRIBUTE name="CONST(tmpAuthUserID)" value="ATTR(AuthUserID)"/>
					<WTSETATTRIBUTE name="PARAM(Upgrade)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Status)" oper="not-equal" value="SYSCON(MEMBER-PAID)"/>
						<WTCONDITION expr="ATTR(Level)" oper="not-equal" value="CONST(1)" connector="and"/>
						<WTCONDITION expr="ATTR(Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)" connector="and"/>
					</WTSETATTRIBUTE>
<!--					
					<WTSETATTRIBUTE name="PARAM(Upgrade)" value="CONST(-1)">
						<WTCONDITION expr="IsMember"/>
						<WTCONDITION expr="NotUpgrade" connector="and"/>
					</WTSETATTRIBUTE>
-->					
					<WTMETHOD name="Dashboard">
						<WTCONDITION expr="IsDashboard"/>
						<WTPARAM name="xmlDB" direction="return" datatype="text"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AuthUserID" direction="input" value="SYS(UserID)"/>
						<WTPARAM name="VisitDate" direction="input" value="PARAM(VisitDate)"/>
						<WTPARAM name="Options" direction="input" value="SYS(UserOptions)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				<WTCODEGROUP>
<!--	 				<WTCONDITION expr="IsIconBar"/>-->
<WTCUSTOM>
'tmpIcons = "EFGHIKL26ahow"
					xmlIcons = "&lt;ICONS&gt;"
					While tmpIcons &lt;&gt; "" 
						tmpIcon = Left(tmpIcons, 1)
						tmpIcons = Mid(tmpIcons, 2)
						tmpName = ""
						tmpFile = ""
						tmpURL = ""
						Select Case tmpIcon
							Case "E"
								If InStr(reqSysUserOptions,"E") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Sales"" file=""IconE.gif"" url=""8101.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "F"
								If InStr(reqSysUserOptions,"F") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Projects"" file=""IconF.gif"" url=""7501.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;companyid=" + CStr(reqCompanyID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "G"
								If InStr(reqSysUserOptions,"G") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Mentoring"" file=""IconG.gif"" url=""0410.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "H"
								If InStr(reqSysUserOptions,"H") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Goals"" file=""IconH.gif"" url=""7001.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "I"
								If InStr(reqSysUserOptions,"I") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""MyInfo"" file=""IconI.gif"" target=""MyInfo"" secure=""True"" url=""0463.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;contentpage=3&amp;amp;popup=1" + """/&gt;"
								End If
							Case "K"
								If InStr(reqSysUserOptions,"K") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Classes"" file=""IconK.gif"" url=""1311.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;companyid=" + CStr(reqCompanyID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "L"
								If InStr(reqSysUserOptions,"L") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Assessments"" file=""IconL.gif"" url=""3411.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;companyid=" + CStr(reqCompanyID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "2"
								If InStr(reqSysUserOptions,"2") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Calendar"" file=""Icon2.gif"" target=""Calendar"" url=""Calendar.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "6"
								If InStr(reqSysUserOptions,"6") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Customers"" file=""Icon6.gif"" url=""8151.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "a"
								If InStr(reqSysUserOptions,"a") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Resources"" file=""Icon_a.gif"" url=""9304.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;GroupID=" + reqGroupID + "&amp;amp;grpcompanyid=" + CSTR(reqCompanyID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "h"
								If InStr(reqSysUserOptions,"h") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Leads"" file=""Icon_h.gif"" target=""Leads"" url=""8161.asp?memberid=" + CStr(reqMemberID) + "&amp;amp;returnurl=0404.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "o"
								If InStr(reqSysUserOptions,"o") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Genealogy"" file=""Icon_o.gif"" target=""Genealogy"" url=""0470.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "w"
								If InStr(reqSysUserOptions,"w") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Finances"" file=""Icon_w.gif"" target=""Finances"" url=""0475.asp?contentpage=3&amp;amp;popup=1&amp;amp;memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "/"
								If InStr(reqSysUserOptions,"/") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Expenses"" file=""Icon_ex.gif"" url=""6401.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
							Case "["
								If InStr(reqSysUserOptions,"[") &lt;&gt; 0 Then
									xmlIcons = xmlIcons + "&lt;ICON name=""Performance"" file=""Performance48.gif"" target=""Performance"" url=""0445.asp?memberid=" + CStr(reqMemberID) + """/&gt;"
								End If
						End Select
					Wend
					xmlIcons = xmlIcons + "&lt;/ICONS&gt;"
</WTCUSTOM>
				</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(memberid)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
			 		<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)"/>
				</WTCODEGROUP>

				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
			 		<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0404.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
		 			<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTCALLSUB name="tmpMemberPage = GetMemberOptions(&quot;MP&quot;)"/>
					<WTCALLSUB name="tmpGroupPage = GetMemberOptions(&quot;GP&quot;)"/>
					<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
						<WTCODEGROUP>
				 			<WTCONDITION expr="IsMemberHomePage"/>
				 			<WTCODEGROUP>
					 			<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(5)"/>
								<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;MemberNews&quot; + CStr(reqLevel) + &quot;.htm&quot; )"/>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
					 			<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
								<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;MemberNews&quot; + CStr(reqLevel) + &quot;.htm&quot; )"/>
								<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;MemberNews&quot; + CStr(reqLevel) + &quot;r.htm&quot; )">
						 			<WTCONDITION expr="CONST(tmpTitle)" oper="equal" value="CONST(1)"/>
								</WTSETATTRIBUTE>
				 			</WTCODEGROUP>
							<WTMETHOD name="Load"/>
							<WTSETATTRIBUTE name="CONST(tmpNews)" value="ATTR(Data)"/>

				 			<WTCODEGROUP>
					 			<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(5)"/>
								<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpMemberPage)"/>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
					 			<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
								<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Member.htm&quot;)"/>
								<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Memberr.htm&quot; )">
						 			<WTCONDITION expr="CONST(tmpTitle)" oper="equal" value="CONST(1)"/>
								</WTSETATTRIBUTE>
				 			</WTCODEGROUP>

							<WTMETHOD name="Load"/>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
				 			<WTCONDITION expr="CONST(tmpGroupPage)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpGroupPage)"/>
							<WTMETHOD name="Load"/>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlHTMLMember" direction="return" datatype="text"/>
								<WTPARAM name="ElementName" direction="input" value="CONST(&quot;HTMLMember&quot;)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTOBJECT>
<WTCUSTOM>
			xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqMemberID )
			xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
			xmlHTMLFile = Replace( xmlHTMLFile, "{news}", tmpNews )
'			xmlHTMLFile = Replace( xmlHTMLFile, "{eref}", Encript(tmpRef) )
			xmlHTMLMember = Replace( xmlHTMLMember, "{id}", reqMemberID )
			xmlHTMLMember = Replace( xmlHTMLMember, "{lgn}", tmpLogon )
'			xmlHTMLMember = Replace( xmlHTMLMember, "{eref}", Encript(tmpRef) )

			If InStr( reqOptions2, "M" ) = 0 Then
				repl = ""
			Else	 
				repl = "&lt;a href=""money.asp?memberid=" + CStr(reqMemberID) + """ target=""money""&gt;&lt;img border=""0"" hspace=""0"" src=""http://www.cloudzow.com/Images/zowmoney.gif""&gt;&lt;br&gt;My ZowFinance&lt;/a&gt;"
			End If	
			xmlHTMLFile = Replace( xmlHTMLFile, "{money}", repl )
			If InStr( reqOptions2, "U" ) = 0 Then
				repl = ""
			Else	 
				repl = "&lt;a href=""university.asp?memberid=" + CStr(reqMemberID) + """ target=""university""&gt;&lt;img border=""0"" hspace=""0"" src=""http://www.cloudzow.com/Images/zowuniversity.gif""&gt;&lt;br&gt;My ZowUniversity&lt;/a&gt;"
			End If	
			xmlHTMLFile = Replace( xmlHTMLFile, "{university}", repl )
</WTCUSTOM>
				</WTCODEGROUP>
				<WTOBJECT name="Shortcuts" project="ptsShortcutUser" class="CShortcuts">
					<WTCONDITION expr="IsShortcuts"/>
					<WTMETHOD name="ListPinned">
						<WTPARAM name="AuthUserID" direction="input" value="CONST(tmpAuthUserID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlShortcuts" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
<WTCODEGROUP>
<WTCONDITION expr="IsSocNetPublic"/>
<WTCUSTOM>
If xmlShortcuts = "&lt;PTSSHORTCUTS/&gt;" OR  xmlShortcuts = "" Then 
	xmlShortcuts = "&lt;PTSSHORTCUTS&gt;" 
Else
	xmlShortcuts = Left(xmlShortcuts, Len(xmlShortcuts) - 15 )
End If	
If InStr(tmpSocNet, ":") > 0 Then
	aSocNets = split(tmpSocNet, ":")
	total = UBOUND(aSocNets)
	For x = 0 to total
		aSocNet = split(aSocNets(x), ";")
		user = CleanXML(TRIM(aSocNet(1)))
		If user &lt;&gt; "" Then
			Select Case aSocNet(0)
				Case "FB": 
					shortcut = "&lt;PTSSHORTCUT entityid=""101"" shortcutname=""FaceBook"" url=""http://www.facebook.com/" + user + """ ispopup=""1""/&gt;"
				Case "MS": 
					shortcut = "&lt;PTSSHORTCUT entityid=""102"" shortcutname=""MySpace"" url=""http://www.myspace.com/" + user + """ ispopup=""1""/&gt;"
				Case "TW": 
					shortcut = "&lt;PTSSHORTCUT entityid=""103"" shortcutname=""Twitter"" url=""http://www.twitter.com/" + user + """ ispopup=""1""/&gt;"
				Case "LI": 
					shortcut = "&lt;PTSSHORTCUT entityid=""104"" shortcutname=""LinkedIn"" url=""http://www.linkedin.com/in/" + user + """ ispopup=""1""/&gt;"
			End Select
			xmlShortcuts = xmlShortcuts + shortcut
		End If	
	Next
End If
xmlShortcuts = xmlShortcuts + "&lt;/PTSSHORTCUTS&gt;"
</WTCUSTOM>
</WTCODEGROUP>
				<WTOBJECT name="Appts" project="ptsApptUser" class="CAppts">
					<WTCONDITION expr="IsDashboard"/>
					<WTCONDITION expr="IsCalendar" connector="and"/>
					<WTMETHOD name="ListToday">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="VisitDate" direction="input" value="SYS(Date)"/>
						<WTPARAM name="Options" direction="input" value="SYS(UserOptions)"/>
					</WTMETHOD>
<WTCUSTOM>
			'calculate and store day and time
			For Each oAppt in oAppts
				With oAppt
					.Opt = "0"
					If .StartDate &lt;&gt; .EndDate Then .Opt = "1"
					If .IsEdit &lt;&gt; "0" Then .Opt = "2"
					If .IsAllDay = 0 Then .ApptName = .StartTime + " " + .ApptName
					'convert ApptID for other types
					Select Case .ApptType
						Case "-70" 
							.ApptID = CLng(.ApptID) mod 700000000 'Goals 
							'If the goal date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "3" Then .Status = 0
						Case "-701" 
							.ApptID = CLng(.ApptID) mod 700000000 'Service Goals 
							'If the goal date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "3" Then .Status = 0
						Case "-22" 
							.ApptID = CLng(.ApptID) mod 220000000 'Leads 
							If CDate(.StartDate) &lt; Date() Then .CalendarID = 1 Else .CalendarID = 0
						Case "-81" 
							.ApptID = CLng(.ApptID) mod 810000000 'Sales 
							If CDate(.StartDate) &lt; Date() Then .CalendarID = 1 Else .CalendarID = 0
						Case "-96" 
							.ApptID = CLng(.ApptID) mod 960000000 'Events
						Case "-75" 
							.ApptID = CLng(.ApptID) mod 750000000 'Projects 
							'If the project date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "2" Then .Status = 0
						Case "-74" 
							.ApptID = CLng(.ApptID) mod 740000000 'Tasks 
							'If the task date has happened yet, don't mark status 
							If CDate(.StartDate) &gt;= Date() And .Status &lt;&gt; "2" Then .Status = 0
					End Select
					'Calculate the Military Time for sorting the appts 
					If .StartTime = "" Then 
						.Reminder = 0
					Else
						tmpTime = .StartTime
						newTime = "0"
						length = Len(tmpTime)
						For x = 1 to length
							c = Mid(tmpTime, x, 1)
							If IsNumeric(c) Then newTime = newTime + c
						Next
						If Left(newTime,3) = "012" Then
							If InStr(UCase(tmpTime), "A") Then 
								newTime = "0" + Mid(tmpTime, 3,2)
							End If
						Else
							If InStr(UCase(tmpTime), "P") Then 
								newTime = (Clng(newTime) + 1200)
							End If
						End If
						.Reminder = newTime
					End If	
				End With
			Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAppts" direction="return" concat="true" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Goals" project="ptsGoalUser" class="CGoals">
					<WTCONDITION expr="IsDashboard"/>
					<WTCONDITION expr="IsGoals" connector="and"/>
					<WTMETHOD name="ListActiveTrack">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoals" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTSTATIC label="Sales"/>
				<WTSTATIC label="Projects"/>
				<WTSTATIC label="Mentoring"/>
				<WTSTATIC label="Goals"/>
				<WTSTATIC label="MyInfo"/>
				<WTSTATIC label="Classes"/>
				<WTSTATIC label="Assessments"/>
				<WTSTATIC label="Resources"/>
				<WTSTATIC label="Calendar"/>
				<WTSTATIC label="Customers"/>
				<WTSTATIC label="Leads"/>
				<WTSTATIC label="Genealogy"/>
				<WTSTATIC label="Finances"/>
				<WTSTATIC label="Expenses"/>
	
				<WTFUNCTION name="CheckIdentity()">
					<!-- If we need Identification info -->
					var url, win
					url = "0426.asp?memberid=" + document.getElementById('MemberID').value;
			        win = window.open(url);
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="EditAppt(id)">
					var url, win;
					url = "4803.asp?apptid=" + id
					win = window.open(url,"Appt","top=100,left=100,height=400,width=550,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="EditOther(typ,id)">
					var url, win;
					switch (typ)
					{
					case -70:
						url = "7003.asp?goalid=" + id + " &amp;popup=1"
						break
					case -22:
						url = "2203.asp?leadid=" + id + " &amp;popup=1"
						break
					case -81:
						url = "8103.asp?prospectid=" + id + " &amp;popup=1"
						break
					case -96:
						url = "9603.asp?eventid=" + id + " &amp;popup=1"
						break
					case -75:
						url = "7503.asp?projectid=" + id + " &amp;popup=1"
						break
					case -74:
						url = "7403.asp?taskid=" + id + " &amp;popup=1"
						break
					}
		            win = window.open(url,null);
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>

				<WTCODEGROUP>
			 		<WTCONDITION expr="IsMember"/>
			 		
					<WTROW>
			 			<WTCONDITION expr="IsEmployee"/>
						 <WTLINKGROUP col="1" align="right">
							<WTLINK name="0403" label="Member" class="PageHeadingLink" nodata="true">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							</WTLINK>
						 </WTLINKGROUP>
					</WTROW>

					<WTCODEGROUP>
<!--		 				<WTCONDITION expr="_IsIconBar"/>-->
						<WTCONDITION expr="CONST(count(/DATA/TXN/ICONS/ICON))" oper="greater" value="CONST(0)"/>
						<WTROW>
							<WTTABLE col="1" merge="2" firstrow="false">
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>

								<WTREPEAT xpath="/DATA/TXN/ICONS/ICON[position() mod 6 = 1]">
									<WTROW margin-bottom="12">
										<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 6]">
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Name)" oper="not-equal" value="CONST('')"/>
												<WTSTATIC col="1">
													<WTCODEGROUP>
														<WTCONDITION expr="CONST(@target)" value="CONST( )"/>
														<WTIMAGE valign="center" value="DATA(Icon.File)">
															<WTLINK name="DATA(URL)" type="anchor" target="&lt;xsl:value-of select=&quot;@target&quot;/&gt;"/>
														</WTIMAGE>
													</WTCODEGROUP>
													<WTCODEGROUP>
														<WTCONDITION expr="CONST(not(@target))" value="CONST( )"/>
														<WTIMAGE valign="center" value="DATA(Icon.File)">
															<WTLINK name="DATA(URL)" type="anchor"/>
														</WTIMAGE>
													</WTCODEGROUP>
													<WTSTATIC newline="1"/>
													<WTSTATIC label="DATA(Name)" bold="true"/>
												</WTSTATIC>
											</WTCODEGROUP>
										</WTREPEAT>
									</WTROW>
								</WTREPEAT>
							</WTTABLE>
						</WTROW>
<!--
						<WTROW margin-top="3" margin-bottom="3">
							<WTDIVIDER col="1" merge="5" height="1" color="SYS(divider)"/>
						</WTROW>
-->
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSHORTCUTS/PTSSHORTCUT))" oper="greater" value="CONST(0)"/>
						<WTROW margin-bottom="3">
							<WTTABLE col="1">
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>
								<WTCOLUMN width="100" align="center"/>

								<WTREPEAT xpath="/DATA/TXN/PTSSHORTCUTS/PTSSHORTCUT[position() mod 6 = 1]">
									<WTROW margin-top="3">
										<WTREPEAT xpath=".|following-sibling::PTSSHORTCUT[position() &amp;lt; 6]">
											<WTSTATIC col="1" valign="top">
												<WTCODEGROUP>
					 								<WTCONDITION expr="DATA(IsPopup)" oper="equal" value="CONST(0)"/>
													<WTIMAGE valign="center" value="CONST(entity&lt;xsl:value-of select=&quot;@entityid&quot;/&gt;a.gif)">
														<WTLINK name="DATA(Shortcut.URL)" type="anchor" return="true" nodata="true"/>
													</WTIMAGE>
												</WTCODEGROUP>
												<WTCODEGROUP>
					 								<WTCONDITION expr="DATA(IsPopup)" oper="not-equal" value="CONST(0)"/>
													<WTIMAGE valign="center" value="CONST(entity&lt;xsl:value-of select=&quot;@entityid&quot;/&gt;a.gif)">
														<WTLINK name="DATA(Shortcut.URL)" type="anchor" target="new"/>
													</WTIMAGE>
												</WTCODEGROUP>
											</WTSTATIC>
										</WTREPEAT>
									</WTROW>
									<WTROW>
										<WTREPEAT xpath=".|following-sibling::PTSSHORTCUT[position() &amp;lt; 6]">
											<WTSTATIC col="1" valign="top">
												<WTSTATIC value="DATA(Shortcut.ShortcutName)">
					 								<WTCONDITION expr="DATA(IsPopup)" oper="equal" value="CONST(0)"/>
													<WTLINK name="DATA(Shortcut.URL)" type="anchor" return="true" nodata="true"/>
												</WTSTATIC>
												<WTSTATIC value="DATA(Shortcut.ShortcutName)">
					 								<WTCONDITION expr="DATA(IsPopup)" oper="not-equal" value="CONST(0)"/>
													<WTLINK name="DATA(Shortcut.URL)" type="anchor" target="new"/>
												</WTSTATIC>
											</WTSTATIC>
										</WTREPEAT>
									</WTROW>
								</WTREPEAT>
							</WTTABLE>
						</WTROW>
<!--
						<WTROW margin-top="3" margin-bottom="3">
							<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
						</WTROW>
-->
					</WTCODEGROUP>

					<!-- Dashboard -->
					<WTCODEGROUP>
						<WTCONDITION expr="_IsDashboard"/>
						<WTROW>
							<WTTABLE col="1">
								<WTCOLUMN width="365" align="center"/>
								<WTCOLUMN width="5"  align="center"/>
								<WTCOLUMN width="230" align="center"/>
<!--
								<WTROW>
									<WTSTATIC col="1" merge="4" background="BorderTop.gif" align="center" bold="true">
										<WTSPAN style="background:white"/>
										<WTSTATIC space="2"/>
										<WTSTATIC label="Dashboard" space="2" fontcolor="darkblue"/>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTIMAGE col="1" merge="4" value="CONST(dashboard.gif)"/>
								</WTROW>
								<WTROW height="3">
									<WTSTATIC col="1" background="BorderLeft.gif"/>
									<WTSTATIC col="2" merge="2"/>
									<WTSTATIC col="4" background="BorderRight.gif"/>
								</WTROW>
-->
								<WTROW>
									<WTCONDITION expr="_IsCalendar"/>
									<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
										<WTCOLUMN width="355" align="center"/>
										<WTROW>
											<WTTABLE col="1">
												<WTCOLUMN width="355" align="center"/>
												<WTROW>
													<WTSTATIC col="1" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
														<WTSTATIC space="1"/>
														<WTCODEGROUP>
															<WTIMAGE value="CONST(db-appts.gif)" imgalign="absmiddle"/>
														</WTCODEGROUP>
														<WTSTATIC space="1"/>
														<WTSTATIC fontcolor="darkblue" bold="true">
															<WTSTATIC tag="Today"/>
															<WTSTATIC value="SYS(Date)"/>
														</WTSTATIC>
													</WTSTATIC>
												</WTROW>
											</WTTABLE>
										</WTROW>
										<WTROW margin-top="12" margin-bottom="12">
											<WTCONDITION expr="CONST(count(/DATA/TXN/PTSAPPTS/PTSAPPT))" oper="equal" value="CONST(0)"/>
											<WTTABLE col="1">
												<WTCOLUMN width="355" align="center"/>
												<WTROW>
													<WTSTATIC col="1" label="NoAppts"/>
												</WTROW>
											</WTTABLE>
										</WTROW>
										<!-- ************************************************************************* -->
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(count(/DATA/TXN/PTSAPPTS/PTSAPPT))" oper="greater" value="CONST(0)"/>
											<WTROW>
												<WTRECORDSET col="1" graybar="true" entity="Appt" width="355">
													<WTCOLUMN width="100" align="left" valign="top" />
													<WTSORT name="@reminder" datatype="number"/>
													<WTSORT name="@apptname"/>
													<WTROW>
														<WTSTATIC col="1">
															<WTSTATIC space="1"/>
															<WTCODEGROUP>
																<WTIMAGE value="CONST(appt&lt;xsl:value-of select=&quot;@appttype&quot;/&gt;.gif)" valign="top" />
															</WTCODEGROUP>
															<WTCODEGROUP>
																<WTCONDITION expr="DATA(IsPlan)" oper="not-equal" value="CONST(0)"/>
																<WTIMAGE value="CONST(plan.gif)" valign="top"/>
															</WTCODEGROUP>
															<WTCODEGROUP>
																<WTCONDITION expr="DATA(Recur)" oper="not-equal" value="CONST(0)"/>
																<WTIMAGE value="CONST(recur.gif)" valign="top"/>
															</WTCODEGROUP>
															<WTSTATIC space="1"/>
															<WTCODEGROUP>
																<WTCONDITION expr="DATA(Importance)" oper="equal" value="CONST(1)"/>
																<WTIMAGE value="CONST(apptlow.gif)" valign="top" alt="ImportanceLow"/>
															</WTCODEGROUP>
															<WTCODEGROUP>
																<WTCONDITION expr="DATA(Importance)" oper="equal" value="CONST(3)"/>
																<WTIMAGE value="CONST(appthigh.gif)" valign="top" alt="ImportanceHigh" />
															</WTCODEGROUP>
															<WTCODEGROUP>
																<WTCONDITION expr="DATA(Show)" oper="equal" value="CONST(2)"/>
																<WTIMAGE value="CONST(apptprivate.gif)" valign="top" alt="ShowPrivate"/>
															</WTCODEGROUP>
															<WTCODEGROUP>
																<WTCONDITION expr="DATA(Show)" oper="equal" value="CONST(3)"/>
																<WTIMAGE value="CONST(apptbusy.gif)" valign="top" alt="ShowBusy"/>
															</WTCODEGROUP>
															<WTSTATIC bold="true">
																<WTCODEGROUP>
																	<WTCONDITION expr="DATA(ApptType)" oper="greater-equal" value="CONST(0)"/>
																	<WTSTATIC space="1"/>
																	<WTSTATIC value="DATA(ApptName)">
																		<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('0')"/>
																		<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																	<WTSTATIC value="DATA(ApptName)" fontcolor="purple">
																		<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('1')"/>
																		<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																	<WTSTATIC value="DATA(ApptName)" fontcolor="red">
																		<WTCONDITION expr="DATA(Opt)" oper="equal" value="CONST('2')"/>
																		<WTLINK name="EditAppt(&lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																</WTCODEGROUP>		
																<WTCODEGROUP>
																	<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-GOAL)"/>
																	<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-SERVICE)" connector="or"/>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/><!--Complete-->
																		<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(3)" connector="and"/><!--Complete-->
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)">
																			<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(3)"/><!--Complete-->
																		<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)" fontcolor="green">
																			<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Incomplete-->
																		<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)" fontcolor="red">
																			<WTLINK name="EditOther(-70, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																</WTCODEGROUP>		
																<WTCODEGROUP>
																	<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-LEAD)"/>
																	<WTCODEGROUP>
																		<WTIMAGE value="CONST(Appt2.gif)" valign="top"/>
																	</WTCODEGROUP>
																	<WTSTATIC space="1"/>
																	<WTSTATIC value="DATA(ApptName)">
																		<WTCONDITION expr="DATA(CalendarID)" oper="not-equal" value="CONST('1')"/>
																		<WTLINK name="EditOther(-22, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																	<WTSTATIC value="DATA(ApptName)" fontcolor="red">
																		<WTCONDITION expr="DATA(CalendarID)" oper="equal" value="CONST('1')"/>
																		<WTLINK name="EditOther(-22, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																</WTCODEGROUP>		
																<WTCODEGROUP>
																	<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-SALES)"/>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
																		<WTIMAGE value="CONST(Appt2.gif)" valign="top"/>
																	</WTCODEGROUP>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/>
																		<WTIMAGE value="CONST(Appt3.gif)" valign="top"/>
																	</WTCODEGROUP>
																	<WTSTATIC space="1"/>
																	<WTSTATIC value="DATA(ApptName)">
																		<WTCONDITION expr="DATA(CalendarID)" oper="not-equal" value="CONST('1')"/>
																		<WTLINK name="EditOther(-81, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																	<WTSTATIC value="DATA(ApptName)" fontcolor="red">
																		<WTCONDITION expr="DATA(CalendarID)" oper="equal" value="CONST('1')"/>
																		<WTLINK name="EditOther(-81, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																</WTCODEGROUP>		
																<WTCODEGROUP>
																	<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-EVENTS)"/>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/>
																		<WTIMAGE value="CONST(event&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" valign="top" />
																	</WTCODEGROUP>
																	<WTSTATIC space="1"/>
																	<WTSTATIC value="DATA(ApptName)">
																		<WTLINK name="EditOther(-96, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																	</WTSTATIC>
																</WTCODEGROUP>		
																<WTCODEGROUP>
																	<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-PROJECT)"/>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/>
																		<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)" connector="and"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)">
																			<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Complete-->
																		<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)" fontcolor="green">
																			<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Incomplete-->
																		<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)" fontcolor="red">
																			<WTLINK name="EditOther(-75, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																</WTCODEGROUP>		
																<WTCODEGROUP>
																	<WTCONDITION expr="DATA(ApptType)" oper="equal" value="SYSCON(TYPE-TASK)"/>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(2)"/>
																		<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)" connector="and"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)">
																			<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(2)"/><!--Complete-->
																		<WTIMAGE value="CONST(greenchecksm.gif)" valign="top"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)" fontcolor="green">
																			<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																	<WTCODEGROUP>
																		<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/><!--Incomplete-->
																		<WTIMAGE value="CONST(redchecksm.gif)" valign="top"/>
																		<WTSTATIC space="1"/>
																		<WTSTATIC value="DATA(ApptName)" fontcolor="red">
																			<WTLINK name="EditOther(-74, &lt;xsl:value-of select=&quot;@apptid&quot;/&gt;)" click="true"/>
																		</WTSTATIC>
																	</WTCODEGROUP>
																</WTCODEGROUP>		
															</WTSTATIC>
														</WTSTATIC>
													</WTROW>
													<WTROW>
														<WTCONDITION expr="DATA(Location)" oper="not-equal" value="CONST('')"/>
														<WTCONDITION expr="DATA(Note)" oper="not-equal" value="CONST('')" connector="or"/>
														<WTSTATIC col="1">
															<WTSTATIC value="DATA(Appt.Location)" space="1"/>
															<WTSTATIC value="DATA(Appt.Note)" escape="false"/>
														</WTSTATIC>
													</WTROW>
												</WTRECORDSET>
											</WTROW>
										</WTCODEGROUP>
<!--
										<WTROW height="12">
											<WTSTATIC col="1" merge="3" background="BorderBottom2.gif" align="center"/>
										</WTROW>
-->
									</WTTABLE>
									<WTSTATIC col="2"/>

									<!-- ******************************************************************************* -->
									<WTTABLE col="3" valign="top">
										<WTCOLUMN width="230" align="center"/>
										<WTROW>
											<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
												<WTCOLUMN width="230" align="center"/>
												<WTCODEGROUP>
													<WTCONDITION expr="_IsGoals"/>
													<WTROW>
														<WTTABLE col="1">
															<WTCOLUMN width="230" align="center"/>
															<WTROW>
																<WTSTATIC col="1" height="18" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
																	<WTSTATIC space="1"/>
																	<WTCODEGROUP>
																		<WTIMAGE value="CONST(db-goals.gif)" imgalign="absmiddle"/>
																	</WTCODEGROUP>
																	<WTSTATIC space="1"/>
																	<WTSTATIC label="SuccessTracks" fontcolor="darkblue" bold="true"/>
																</WTSTATIC>
															</WTROW>
														</WTTABLE>
													</WTROW>

													<WTROW>
														<WTTABLE col="1">
															<WTCOLUMN width="230" align="left"/>
															<WTCODEGROUP>
																<WTCONDITION expr="CONST(count(/DATA/TXN/PTSGOALS/PTSGOAL))" oper="greater" value="CONST(0)"/>
																<WTREPEAT entity="Goal">
																	<WTROW>
																		<WTSTATIC col="1" value="DATA(Goal.GoalName)">
																			<WTLINK name="7050" target="Preview">
																				<WTPARAM name="GoalID" value="DATA(Goal.GoalID)"/>
																			</WTLINK>
																		</WTSTATIC>
																	</WTROW>
																</WTREPEAT>
															</WTCODEGROUP>

															<WTROW margin-bottom="2">
																<WTSTATIC col="1">
																	<WTCODEGROUP>
																		<WTIMAGE value="CONST(db-newgoal.gif)" imgalign="absmiddle"/>
																	</WTCODEGROUP>
																	<WTSTATIC space="1"/>
																	<WTSTATIC label="JoinSuccessTrack" bold="true">
																		<WTLINK name="7005" target="Tracks">
																			<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
																			<WTPARAM name="ContentPage" value="CONST(1)"/>
																			<WTPARAM name="Popup" value="CONST(1)"/>
																		</WTLINK>
																	</WTSTATIC>
																</WTSTATIC>
															</WTROW>
														</WTTABLE>

													</WTROW>
												</WTCODEGROUP>
											</WTTABLE>
										</WTROW>

										<WTCODEGROUP>
											<WTCONDITION expr="_IsMentor"/>
											<WTCONDITION expr="_IsMentoring" connector="or"/>
											<WTROW margin-top="6">
												<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
													<WTCOLUMN width="230" align="center"/>
													<WTROW>
														<WTTABLE col="1">
															<WTCOLUMN width="230" align="center"/>
															<WTROW>
																<WTSTATIC col="1" height="18" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
																	<WTSTATIC space="1"/>
																	<WTCODEGROUP>
																		<WTIMAGE value="CONST(db-mentor.gif)" imgalign="absmiddle"/>
																	</WTCODEGROUP>
																	<WTSTATIC space="1"/>
																	<WTSTATIC label="Mentoring" fontcolor="darkblue" bold="true"/>
																</WTSTATIC>
															</WTROW>
														</WTTABLE>
													</WTROW>

													<WTROW>
														<WTCONDITION expr="_IsMentor"/>
														<WTSTATIC col="1">
															<WTSTATIC value="ATTR(DB.Mentorees)" space="1" bold="true"/>
															<WTSTATIC label="Mentorees">
																<WTLINK name="0410" target="Mentor">
																	<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
																	<WTPARAM name="ContentPage" value="CONST(3)"/>
																	<WTPARAM name="Popup" value="CONST(1)"/>
																</WTLINK>
															</WTSTATIC>
														</WTSTATIC>
													</WTROW>
													<WTROW>
														<WTSTATIC col="1">
															<WTSTATIC value="ATTR(DB.MentorNotes)" space="1" bold="true"/>
															<WTCODEGROUP>
																<WTCONDITION expr="ATTR(DB.MentorNotes)" oper="greater" value="CONST(0)"/>
																<WTIMAGE value="CONST(NewNote.gif)" imgalign="absmiddle"/>
																<WTSTATIC space="1"/>
															</WTCODEGROUP>
															<WTSTATIC label="MentoringNotes">
																<WTLINK name="0410" target="Mentor">
																	<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
																	<WTPARAM name="ContentPage" value="CONST(3)"/>
																	<WTPARAM name="Popup" value="CONST(1)"/>
																</WTLINK>
															</WTSTATIC>
														</WTSTATIC>
													</WTROW>
												</WTTABLE>
											</WTROW>
										</WTCODEGROUP>


										<WTCODEGROUP>
											<WTCONDITION expr="_IsSales"/>
											<WTCONDITION expr="_IsService" connector="or"/>
											<WTROW margin-top="6">
												<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid">
													<WTCOLUMN width="230" align="center"/>
													<WTROW>
														<WTTABLE col="1">
															<WTCOLUMN width="230" align="center"/>
															<WTROW>
																<WTSTATIC col="1" height="18" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
																	<WTSTATIC space="1"/>
																	<WTCODEGROUP>
																		<WTIMAGE value="CONST(db-sales.gif)" imgalign="absmiddle"/>
																	</WTCODEGROUP>
																	<WTSTATIC space="1"/>
																	<WTSTATIC label="Sales" fontcolor="darkblue" bold="true"/>
																</WTSTATIC>
															</WTROW>
														</WTTABLE>
													</WTROW>

													<WTCODEGROUP>
														<WTCONDITION expr="_IsSales"/>
														<WTROW>
															<WTSTATIC col="1">
																<WTSTATIC value="ATTR(DB.Prospects)" space="1" bold="true"/>
																<WTSTATIC label="NewProspects">
																	<WTLINK name="8129" target="Sales">
																		<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
																		<WTPARAM name="Rpt" value="CONST(1)"/>
																	</WTLINK>
																</WTSTATIC>
															</WTSTATIC>
														</WTROW>
														<WTROW>
															<WTSTATIC col="1">
																<WTSTATIC value="ATTR(DB.Prospects30)" space="1" bold="true"/>
																<WTSTATIC label="Prospects30">
																	<WTLINK name="8129" target="Sales">
																		<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
																		<WTPARAM name="Rpt" value="CONST(2)"/>
																	</WTLINK>
																</WTSTATIC>
															</WTSTATIC>
														</WTROW>
														<WTROW>
															<WTSTATIC col="1">
																<WTSTATIC value="ATTR(DB.ProspectsActive)" space="1" bold="true"/>
																<WTSTATIC label="ActiveProspects">
																	<WTLINK name="8129" target="Sales">
																		<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
																		<WTPARAM name="Rpt" value="CONST(3)"/>
																	</WTLINK>
																</WTSTATIC>
															</WTSTATIC>
														</WTROW>
													</WTCODEGROUP>
													<WTROW>
														<WTCONDITION expr="_IsService"/>
														<WTSTATIC col="1">
															<WTSTATIC value="ATTR(DB.Customers)" space="1" bold="true"/>
															<WTSTATIC label="TotalCustomers">
																<WTLINK name="8151" target="Service">
																	<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
																	<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
																	<WTPARAM name="ContentPage" value="CONST(1)"/>
																	<WTPARAM name="Popup" value="CONST(1)"/>
																</WTLINK>
															</WTSTATIC>
														</WTSTATIC>
													</WTROW>
												</WTTABLE>
											</WTROW>
										</WTCODEGROUP>

										<WTROW height="10"/>

									</WTTABLE>

								</WTROW>
							</WTTABLE>

						</WTROW>
					</WTCODEGROUP>
					
					<WTROW>
						<WTHIDDEN value="PARAM(CompanyID)"/>
					</WTROW>
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Upgrade)" oper="greater-equal" value="CONST(0)"/>
						<WTROW margin-top="6">
							<WTCONDITION expr="PARAM(Upgrade)" oper="equal" value="CONST(1)"/>
							<WTBUTTON col="1" value="CONST(MembershipUpgradeInfo)" align="center" btnclass="smbutton">
								<WTCLICK>var URL="0419.asp?CompanyID=" + document.getElementById('CompanyID').value; window.open( URL);</WTCLICK>
							</WTBUTTON>
						</WTROW>
						<WTROW margin-top="6">
							<WTCONDITION expr="PARAM(Upgrade)" oper="equal" value="CONST(0)"/>
							<WTBUTTON col="1" value="CONST(MembershipInfo)" align="right" btnclass="smbutton">
								<WTCLICK>var URL="0419.asp?CompanyID=" + document.getElementById('CompanyID').value; window.open( URL);</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
-->					
					<WTROW margin-top="12" margin-bottom="12">
						<WTCONDITION expr="PARAM(Identify)" oper="not-equal" value="CONST(0)"/>
						<WTBUTTON col="1" value="CONST(IdentificationInfo)" align="center">
							<WTCLICK>CheckIdentity();</WTCLICK>
						</WTBUTTON>
					</WTROW>

					<WTROW margin-top="6">
						<WTSTATIC col="1" value="ATTR(HTMLMember.Data)" align="left" embedhtml="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12" margin-bottom="12">
							<WTSTATIC col="1" value="ATTR(HTMLWarn.Data)" embedhtml="true" />
						</WTROW>
					</WTCODEGROUP>

				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0405" caption="Upgrade Membership" focus="false" navbar="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Expired" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Level" datatype="number"/>
			<WTPARAM name="Try" datatype="number"/>
			<WTPARAM name="Billing" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(1)">
				 		<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Billing)" value="ATTR(Billing)"/>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="PARAM(Expired)" value="CONST(1)">
				 		<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(5)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Expired)" value="CONST(1)">
				 		<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(2)"/>
				 		<WTCONDITION expr="ATTR(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
				 		<WTCONDITION expr="CONST(DateAdd( &quot;d&quot;, .TrialDays, FormatDateTime(.EnrollDate,2)))" oper="greater" value="SYS(Date)" connector="and"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCoption" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="4" name="Upgrade" type="Add">
				<WTCALLSUB name="LoadMember"/>

				<WTSETATTRIBUTE name="PARAM(Level)" value="PARAM(Status)"/>
				<WTSETATTRIBUTE name="PARAM(Status)" value="SYSCON(MEMBER-PAID)"/>
				<WTSETATTRIBUTE name="PARAM(Status)" value="SYSCON(MEMBER-TRIAL)">
					<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(1)"/>
				</WTSETATTRIBUTE>

				<WTRETURN>
					<WTCONDITION expr="PARAM(Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)"/>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTLINK name="2902" return="false" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="NextURL" value="CONST(&quot;0413.asp?MemberID=&quot; &amp; reqMemberID &amp; &quot;%26Status=&quot; &amp; reqStatus &amp; &quot;%26Level=&quot; &amp; reqLevel)"/>
					</WTLINK>
				</WTRETURN>
				<WTRETURN>
					<WTLINK name="0413" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="Status" value="PARAM(Status)"/>
						<WTPARAM name="Level" value="PARAM(Level)"/>
						<WTPARAM name="Txn" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Continue" type="Continue">
				<WTRETURN>
					<WTLINK name="0404" return="false">
						<WTPARAM name="MemberID" value="SYS(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="5" name="Exit" type="Continue">
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW margin-top="12" margin-bottom="6">
					<WTCONDITION expr="PARAM(Expired)" oper="equal" value="CONST(1)"/>
					<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)" connector="and"/>
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTSTATIC label="TrialExpired" bold="true" fontcolor="red" fontsize="4"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="6">
					<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="SYSCON(MEMBER-BILL-MEMBER)"/>
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTSTATIC label="NoUpgrade" bold="true" fontcolor="red" fontsize="4"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Expired)" oper="not-equal" value="CONST(1)"/>
					<WTCONDITION expr="PARAM(Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)" connector="and"/>
					<WTROW margin-top="12">
						<WTRADIO col="1" group="Status" name="1" datapathx="/DATA/PARAM[@status=1]"/>
						<WTSTATIC col="1" label="PaidMembership" prespace="false">
							<WTCONDITION expr="ATTR(Coption.PaidName)" oper="not-exist"/>
						</WTSTATIC>
						<WTSTATIC col="1" value="ATTR(Coption.PaidName)" prespace="false">
							<WTCONDITION expr="ATTR(Coption.PaidName)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC col="1">
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC value="ATTR(Coption.Price)" bold="true"/>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)" paren="start"/>
						<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(3)" connector="or" paren="end"/>
						<WTCONDITION expr="ATTR(Coption.PaidName2)" oper="not-equal" value="CONST('')" connector="and"/>
						<WTRADIO col="1" group="Status" name="2" datapathx="/DATA/PARAM[@status=2]"/>
						<WTSTATIC col="1" value="ATTR(Coption.PaidName2)" prespace="false"/>
						<WTSTATIC col="1">
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC value="ATTR(Coption.Price2)" bold="true"/>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(Coption.PaidName3)" oper="not-equal" value="CONST('')" connector="and"/>
						<WTRADIO col="1" group="Status" name="3" datapathx="/DATA/PARAM[@status=3]"/>
						<WTSTATIC col="1" value="ATTR(Coption.PaidName3)" prespace="false"/>
						<WTSTATIC col="1">
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC value="ATTR(Coption.Price3)" bold="true"/>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Coption.TrialDays)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(Member.TrialDays)" oper="equal" value="CONST(0)" connector="and"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW id="TryMe">
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(Try)" label="Try"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="ATTR(Coption.TrialDays)" space="1" bold="true"/>
								<WTSTATIC label="days"/>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="4" value="CONST(Upgrade)" align="center">
						<WTCONDITION expr="PARAM(Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(ContinueMember)" align="center">
						<WTCONDITION expr="PARAM(Expired)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="5" value="CONST(Continue)" align="center">
						<WTCONDITION expr="PARAM(Expired)" oper="equal" value="CONST(1)"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0407" caption="Organization Members" contentpage="true" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="contentpage" datatype="number"/>
		   
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ListOrg">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="300" align="left"/>
				
				<WTROW>
					<WTSTATIC col="1" label="Members" class="PageHeading" align="left"/>
					
					<WTLINKGROUP col="2" align="right">	
						<WTLINK name="2809" label="Company" class="PageHeadingLink">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						</WTLINK>
						<WTLINK name="0402" label="NewMember" target="NewMember">
					 		<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					 	</WTLINK>				 	
					</WTLINKGROUP>
				</WTROW>
					
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
						<WTCOLUMN width="35" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="35" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="15" align="left" valign="top" label="EnrollDate"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Reference"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Member.CompanyName)">
								<WTLINK name="0463" target="MyInfo">
					 				<WTPARAM name="MemberID" value="DATA(MemberID)"/>
					 				<WTPARAM name="contentpage" value="CONST(3)"/>
					 				<WTPARAM name="popup" value="CONST(1)"/>
					 			</WTLINK>		
					 		</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Member.Email)">
								<WTLINK type="mail" name="DATA(Member.Email)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.EnrollDate)"/>
							<WTSTATIC col="4" value="DATA(Member.Reference)"/>
						</WTROW>						
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="right" tag="TotalMembers" value="PARAM(Count)" class="PageHeading"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0408" caption="Referred Members" header="false" footer="false" navbar="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52" track="0">
		<!--==================================================================-->
			<WTPARAM name="ReferralID" datatype="number"/>
			<WTPARAM name="Total" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
		   
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ListReferral">
						<WTPARAM name="ReferralID" direction="input" value="PARAM(ReferralID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqTotal" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						For Each oMember in oMembers
							With oMember
								If InStr("12",.Status) &gt; 0 Then reqCount = reqCount + 1
							End With
						Next
					</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="300" align="left"/>

				<WTROW>
					<WTSTATIC col="1" label="ReferredMembers" class="PageHeading" align="left"/>
				</WTROW>
					
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" bold="true" fontcolor="blue" align="center">
						<WTSTATIC tag="TotalReferrals" value="PARAM(Total)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="PARAM(Count)"/>
							<WTSTATIC space="5"/>
							<WTSTATIC tag="ActiveReferrals" value="PARAM(Count)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
						<WTCOLUMN width="30" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Status"/>
						<WTCOLUMN width="35" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="20" align="left" valign="top" label="EnrollDate"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Member.NameFirst)" space="1"/>
								<WTSTATIC value="DATA(Member.NameLast)"/>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Member.Status)" space="1"/>
								<WTSTATIC value="DATA(Member.Level)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.Email)">
								<WTLINK type="mail" name="DATA(Member.Email)"/>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(Member.EnrollDate)"/>
						</WTROW>						
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_0408" caption="Referred Members" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" action="5" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98" track="0">
			<!--==================================================================-->
			<WTPARAM name="ReferralID" datatype="number"/>
			<WTPARAM name="Total" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ListReferral">
						<WTPARAM name="ReferralID" direction="input" value="PARAM(ReferralID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqTotal" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						For Each oMember in oMembers
						With oMember
						If InStr("12",.Status) &gt; 0 Then reqCount = reqCount + 1
						End With
						Next
					</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW>
					<WTSTATIC col="1" label="ReferredMembers" class="PageHeading"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" bold="true" fontcolor="blue" align="center">
						<WTSTATIC tag="TotalReferrals" value="PARAM(Total)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="PARAM(Count)"/>
							<WTSTATIC space="5"/>
							<WTSTATIC tag="ActiveReferrals" value="PARAM(Count)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTRECORDSET col="1" graybar="true" entity="Member">
						<WTCOLUMN width="45" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="20" align="left" valign="top" label="Status"/>
						<WTCOLUMN width="35" align="left" valign="top" label="EnrollDate"/>
						<WTROW height="24">
							<WTCONDITION expr="DATA(Member.Status)" oper="less-equal" value="SYSCON(MEMBER-SUSPENDED)"/>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Member.NameFirst)" space="1"/>
								<WTSTATIC value="DATA(Member.NameLast)"/>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Member.Status)" space="1"/>
								<WTSTATIC value="DATA(Member.Level)">
									<WTCONDITION expr="DATA(Member.Status)" oper="less-equal" value="SYSCON(MEMBER-TRIAL)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.EnrollDate)"/>
						</WTROW>
						<WTROW height="24">
							<WTCONDITION expr="DATA(Member.Status)" oper="greater" value="SYSCON(MEMBER-SUSPENDED)"/>
							<WTSTATIC col="1" fontcolor="red">
								<WTSTATIC value="DATA(Member.NameFirst)" space="1"/>
								<WTSTATIC value="DATA(Member.NameLast)"/>
							</WTSTATIC>
							<WTSTATIC col="2" fontcolor="red">
								<WTSTATIC value="DATA(Member.Status)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.EnrollDate)" fontcolor="red"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0448" caption="Referred Customers" header="false" footer="false" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
		   
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ListCustomers">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="300" align="left"/>

				<WTFUNCTION name="ViewSales(id)">
					var url, win;
					url = "5221.asp?memberid=" + id
		            win = window.open(url,"CustomerSales","top=100,left=100,height=200,width=600,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTSTATIC col="1" label="Customers" class="PageHeading" align="left"/>
				</WTROW>
					
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
						<WTCOLUMN width="30" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="35" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="20" align="left" valign="top" label="EnrollDate"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Orders"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Member.NameFirst)" space="1"/>
								<WTSTATIC value="DATA(Member.NameLast)"/>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Member.Email)">
								<WTLINK type="mail" name="DATA(Member.Email)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.EnrollDate)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview.gif)" alt="ViewSales" imgalign="absmiddle">
										<WTLINK name="ViewSales(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>						
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="left" tag="TotalCustomers" value="PARAM(Count)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0449" caption="Retail Customers" action="5" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52" langfile="0449">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="url" datatype="text"/>
			<WTPARAM name="Count" datatype="number"/>
      <WTPARAM name="MemberName" datatype="text"/>

      <WTCUSTOM>
			requrl = "http://" + reqSysServerName + reqSysServerPath + "10709.asp?MemberID="
</WTCUSTOM>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(MemberName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTGETCACHE name="CONST(tmpMemberID)" value="CUSTOMER"/>
			<WTCODEGROUP>
				<WTCONDITION expr="IsAnonymous"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(tmpMemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

      <WTCODEGROUP>
        <WTCONDITION expr="NotMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberName)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(MemberName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; #&quot; + .MemberID)"/>
        </WTOBJECT>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XMLFind">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
				<WTMETHOD name="FindCustomer">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XMLFind">
					<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
				<WTMETHOD name="TotalCustomers">
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="reqCount" direction="return" datatype="number"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

        <WTFUNCTION name="ViewCustomer(id)">
          var url, win;
          url = "0421c.asp?m=" + id
          win = window.open(url,"CustomerInfo","top=200,left=200,height=200,width=280,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>

        <WTROW>
          <WTHIDDEN value="PARAM(MemberName)"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTSTATIC col="1" class="PageHeading" align="left">
            <WTSTATIC space="2"/>
            <WTCODEGROUP><WTIMAGE value="CONST(Retail48.png)" imgalign="absmiddle"/></WTCODEGROUP>
            <WTSTATIC space="2"/>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(MemberName)" oper="equal" value="CONST('')"/>
              <WTSTATIC label="Customers" fontsize="4"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(MemberName)" oper="not-equal" value="CONST('')"/>
              <WTSTATIC tag="Customers" value="PARAM(MemberName)" fontsize="4"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Members.FindTypeID)" translate="true">
						<WTOPTION id="419" label="CustomerName"/>
						<WTOPTION id="430" label="Email"/>
            <WTOPTION id="440" label="Price"/>
            <WTOPTION id="474" label="Product"/>
            <WTOPTION id="438" label="EnrollDate"/>
            <WTOPTION id="401" label="MemberID"/>
          </WTCOMBO>
          
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Member">
						<WTCOLUMN width="28" align="left" valign="top" label="CustomerName"/>
						<WTCOLUMN width="28" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="12" align="left" valign="top" label="Phone"/>
            <WTCOLUMN width="8" align="center" valign="top" label="EnrollDate"/>
            <WTCOLUMN width="8" align="center" valign="top" label="VisitDate"/>
            <WTCOLUMN width="8" align="center" valign="top" label="Price"/>
            <WTCOLUMN width="8" align="center" valign="top" label="Product"/>
						
            <WTROW height="24">
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(MemberName)" space="1"/>
                <WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" fontcolor="blue" space="1"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(preview.gif)" alt="ViewCustomer" imgalign="absmiddle">
                    <WTLINK name="ViewCustomer(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
                  </WTIMAGE>
                </WTCODEGROUP>
              </WTSTATIC>
							<WTSTATIC col="2" value="DATA(Email)">
								<WTLINK type="mail" name="DATA(Email)"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Phone1)"/>
              <WTSTATIC col="4" value="DATA(EnrollDate)"/>
              <WTSTATIC col="5" value="DATA(VisitDate)"/>
              <WTSTATIC col="6">
                <WTSTATIC value="DATA(InitPrice)">
                  <WTCONDITION expr="DATA(InitPrice)" oper="not-equal" value="CONST('$0.00')"/>
                </WTSTATIC>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(InitPrice)" oper="equal" value="CONST('$0.00')"/>
                  <WTIMAGE value="CONST(certificate16.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="7" value="DATA(Options2)"/>
            </WTROW>
					</WTRECORDSET>
				</WTROW>

        <WTROW margin-top="6">
					<WTSTATIC col="1" align="left" tag="TotalCustomers" value="PARAM(Count)" bold="true"/>
				</WTROW>

        <WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>


		<!--============================================================================================-->
		<WTWEBPAGE name="0409" caption="Member FAQ" navbar="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
			 		<WTCONDITION expr="SYS(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;faq.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqSysCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0410" caption="Member Mentoring" focus="false" contentpage="true" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52" track="0">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="MentorID" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="RemoveID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="NewDate" datatype="date"/>
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="Emails" datatype="text"/>
			<WTPARAM name="ChangeMentor" datatype="number"/>

			<WTINCLUDE name="Label.asp"/>
			<WTINCLUDE name="Comm.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotMentoring" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadMentor">
				

				<WTSETATTRIBUTE name="CONST(MemberOptions)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompany)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (&quot; + .MemberID + &quot;)&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="PARAM(MentorID)" value="ATTR(MentorID)"/>
					<WTSETATTRIBUTE name="PARAM(NewDate)" value="ATTR(VisitDate)">
						<WTCONDITION expr="NotMemberOnly"/>
					</WTSETATTRIBUTE>
					<WTGETCACHE name="PARAM(NewDate)" value="VISITDATE">
						<WTCONDITION expr="IsMemberOnly"/>
					</WTGETCACHE>
					<WTSETATTRIBUTE name="PARAM(NewDate)" value="SYS(Date)">
						<WTCONDITION expr="PARAM(NewDate)" oper="equal" value="CONST(&quot;0&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MemberID)">
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="Load">
						<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MentorID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(NameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(MentorID)" value="CONST(0)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="IsMemberOnly"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompany)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
<WTCUSTOM>
If InStr( CompanyOptions + MemberOptions, "~G" ) = 0 Then
	reqChangeMentor = 1
Else
	reqChangeMentor = 0
End If	
</WTCUSTOM>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ListMentor">
						<WTPARAM name="MentorID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="VisitDate" direction="input" value="PARAM(NewDate)"/>
					</WTMETHOD>
<WTCUSTOM>
				reqEmails = ""
				cnt = 0
				For Each oMember in oMembers
					If cnt &lt;&gt; 0 Then reqEmails = reqEmails + ";"
					With oMember
						If InStr( .Email, "@") &gt; 0 Then  reqEmails = reqEmails + .Email
					End With
					cnt = cnt + 1
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(RemoveID)" oper="not-equal" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="RemoveMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(RemoveID)"/>
						<WTPARAM name="Status" direction="input" value="SYSCON(REMOVE-MENTOR)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

			<WTACTION id="2" name="Mark" type="New">
				<WTSETATTRIBUTE name="PARAM(NewDate)" value="CONST(Now())"/>
			    <WTSETCACHE name="VISITDATE" value="PARAM(NewDate)"/>
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="New">
				<WTSETATTRIBUTE name="CONST(tmpMentorID)" value="FORM(MentorID)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpMentorID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(NameFirst)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10113" message="Oops, The selected Mentor # does not exist."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Member.Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompany)" value="ATTR(Member.CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Member.Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Member.Level)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email2)"/>
					<WTSETATTRIBUTE name="CONST(tmpMsgTo)" value="ATTR(MemberID)">
						<WTCONDITION expr="ATTR(IsMsg)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompany)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="CONST(CompanyOptions + MemberOptions)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;g&quot;))" oper="equal" value="CONST(0)"/>
						<WTERROR number="10114" message="Oops, The selected Mentor is not able to be a Mentor with their current membership."/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompany)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="CONST(tmpMentorID)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Member.Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
<!--					<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Phone1 + &quot; &quot; + .Phone2 + &quot;&lt;BR&gt;&quot; + .Street + &quot; &quot; + .Unit + &quot;&lt;BR&gt;&quot; + .City + &quot;, &quot; + .State + &quot; &quot; + .Zip + &quot; &quot; + .Country)"/>-->
					<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
				If tmpMentorID &lt;&gt; 0 Then
					filename = "Language\Member[" + reqSysLanguage + "].xml"
					tmpSubject = GetLabel( filename, "NewMentoree") + ": " + tmpSubject

					If InStr(tmpTo, "@") &gt; 0 Then
						If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
						SendEmail reqSysCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
					End If	
					If tmpMsgTo &lt;&gt; "" Then
						SendMsg 1, tmpMsgTo, tmpSubject, tmpBody 
					End If
				End If	
</WTCUSTOM>
				</WTOBJECT>
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="350" align="right"/>
				<WTCOLUMN width="250" align="left"/>

				<WTFUNCTION name="ViewMember(id)">
					var url, win;
					url = "0421.asp?memberid=" + id
		            win = window.open(url,"MemberInfo","top=100,left=100,height=200,width=330,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewPerformance(id)">
					var url, win;
					url = "0445.asp?memberid=" + id
		            win = window.open(url,"Performance","top=100,left=100,height=350,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
        <WTFUNCTION name="ViewNotify(id)">
          var url, win;
          url = "0417.asp?memberid=" + id
          win = window.open(url,"MemberNotify","top=100,left=100,height=350,width=350,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>

        <WTSTATIC label="NewMentoree"/>
				<WTSTATIC label="emailteam"/>
				<WTSTATIC label="mentoringteam"/>
				<WTSTATIC label="performance"/>
				<WTSTATIC label="mentoring"/>
				<WTSTATIC label="calendar"/>
				<WTSTATIC label="goals"/>
				<WTSTATIC label="viewcontacts"/>
				<WTSTATIC label="viewprospects"/>
				<WTSTATIC label="viewcustomers"/>
				<WTSTATIC label="assessments"/>
				<WTSTATIC label="classes"/>
				<WTSTATIC label="projects"/>
				<WTSTATIC label="notes"/>
				<WTSTATIC label="notifications"/>
				<WTSTATIC label="ViewMentor"/>
				<WTSTATIC label="ViewMyself"/>
				<WTSTATIC label="ViewInfo"/>
				<WTSTATIC label="Remove"/>
				<WTSTATIC label="Reassign"/>
<!--					
				<WTROW margin-top="6" margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
-->				
				<WTROW margin-bottom="3">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTIMAGE col="1" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
					<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
					<WTSTATIC col="2" label="MyMentorID" align="right" space="2" class="PageHeader"/>
					<WTTEXT  col="2" value="PARAM(MentorID)" size="6" prespace="false"/>
					<WTBUTTON col="2" action="1" value="CONST(Update)" btnclass="smbutton"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ChangeMentor)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-bottom="3">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="SYS(MemberID)"/>
							<WTIMAGE col="1" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
							<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
							<WTSTATIC col="2" label="MyMentorID" align="right" space="2" class="PageHeader"/>
							<WTTEXT  col="2" value="PARAM(MentorID)" size="6" prespace="false"/>
							<WTBUTTON col="2" action="1" value="CONST(Update)" btnclass="smbutton"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
							<WTIMAGE col="1" merge="2" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
							<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ChangeMentor)" oper="equal" value="CONST(0)"/>
						<WTROW margin-bottom="3">
							<WTIMAGE col="1" merge="2" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
							<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" class="prompt">
						<WTSTATIC label="MentoringText" space="1"/>
<!--						
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(HelpMentor)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
-->						
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MentorID)" oper="equal" value="CONST(0)"/>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="NoMentor" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-bottom="2">

						<WTTABLE col="1" merge="2" valign="top" padding="0" style="border: 1px #5084A2 solid">
							<WTCOLUMN width="600" align="center"/>
							<WTROW>
								<WTSTATIC col="1" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(mentora_sm.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC label="MyMentor" fontcolor="darkblue" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsPinnacleTutorial"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
											<WTLINK name="Tutorial" target="Tutorial">
												<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-MENTOREE)"/>
												<WTPARAM name="contentpage" value="CONST(3)"/>
												<WTPARAM name="popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" class="PageHeading" align="left">
									<WTSTATIC bold="true" space="2">
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(Member.Image)" oper="not-equal" value="''"/>
											<WTIMAGE value="ATTR(Member.Image)" align="left" imgalign="absmiddle" imgwidth="50" path="Member"/>
										</WTCODEGROUP>
										<WTSTATIC space="3"/>
										<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
										<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(preview.gif)" alt="ViewInfo" imgalign="absmiddle">
												<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;/DATA/PARAM/@mentorid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="ATTR(Member.Email)">
											<WTLINK type="mail" name="ATTR(Member.Email)"/>
										</WTSTATIC>
									</WTSTATIC>
<!--									
									<WTSTATIC>
					 					<WTCONDITION expr="SYS(Memberid)" oper="not-equal" value="PARAM(MemberID)"/>
										<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(mentora.gif)" alt="ViewMentor" imgalign="absmiddle">
												<WTLINK name="0410" class="PageHeadingLink" return="false">
													<WTPARAM name="MemberID" value="PARAM(MentorID)"/>
													<WTPARAM name="M" value="PARAM(M)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
													<WTPARAM name="Popup" value="PARAM(Popup)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
									<WTSTATIC>
										<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="PARAM(M)"/>
										<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="PARAM(M)" connector="and"/>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(mentorb.gif)" alt="ViewMyself" imgalign="absmiddle">
												<WTLINK name="0410" class="PageHeadingLink" return="false">
													<WTPARAM name="MemberID" value="PARAM(M)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
													<WTPARAM name="Popup" value="PARAM(Popup)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
-->									
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTFRAME col="1" merge="2" src="CONST(9011.asp?OwnerType=-4&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;&amp;amp;NewDate=&lt;xsl:value-of select=&quot;/DATA/PARAM/@newdate&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;)" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="150" label="NoFrameSupport" border="0"/>
				</WTROW>
<!--					
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="_NotMentor" connector="and"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" label="UpgradeToMentor" class="PageHeading" align="center" fontcolor="red"/>
					</WTROW>
				</WTCODEGROUP>
-->				
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="_IsMentor" connector="or"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTTABLE col="1" merge="2" valign="top" padding="0" style="border: 1px #5084A2 solid">
							<WTCOLUMN width="375" align="center"/>
							<WTCOLUMN width="225" align="center"/>
							<WTROW>
								<WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(mentorb_sm.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC label="MyMentorees" fontcolor="darkblue" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsPinnacleTutorial"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
											<WTLINK name="Tutorial" target="Tutorial">
												<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-MENTORING)"/>
												<WTPARAM name="contentpage" value="CONST(3)"/>
												<WTPARAM name="popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" align="center" class="prompt">
									<WTSTATIC>
										<WTSTATIC value="PARAM(MemberID)" space="1" fontcolor="red" bold="true"/>
										<WTSTATIC label="MentorNumberText">
											<WTCONDITION expr="PARAM(ChangeMentor)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC label="MentorNumberText2">
											<WTCONDITION expr="PARAM(ChangeMentor)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
<!--
										<WTCODEGROUP>
											<WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle">
												<WTLINK name="Page" target="Help">
													<WTPARAM name="Page" value="CONST(HelpMentor)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
-->										
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(emailsend.gif)" alt="emailteam" imgalign="absmiddle">
											<WTLINK name="PARAM(Emails)" type="mail"/>
										</WTIMAGE>
										<WTSTATIC space="5"/>
										<WTIMAGE value="CONST(mentoringteam.gif)" alt="mentoringteam" imgalign="absmiddle">
											<WTLINK name="0470" target="Genealogy" return="false">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="Line" value="SYSCON(GENEALOGY-MENTOR)"/>
												<WTPARAM name="Only" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
					
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
							<WTCOLUMN width="10" align="center"/>
							<WTCOLUMN width="72" align="left" valign="top" label="MemberName"/>
							<WTCOLUMN width="18" align="right" valign="top" label="VisitDate"/>
							<WTROW height="48">
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Image)" oper="not-equal" value="''"/>
										<WTIMAGE value="DATA(Image)" align="left" imgalign="absmiddle" imgwidth="50" path="Member"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTSTATIC fontcolor="purple" bold="true">
										<WTSTATIC value="DATA(NameFirst)" space="1"/>
										<WTSTATIC value="DATA(NameLast)" space="1"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(preview.gif)" alt="ViewInfo" imgalign="absmiddle">
											<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC newline="1"/>
									<!-- @unit = Company Options -->
									<WTSTATIC bold="true">
<!--										
										<WTCODEGROUP>
											<WTCONDITION expr="NotMemberOnly"/>
											<WTCONDITION expr="_IsPerformance" connector="or"/>
											<WTIMAGE value="CONST(performance.gif)" alt="performance" imgalign="absmiddle">
												<WTLINK name="ViewPerformance(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
-->										
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(MentorID)" oper="not-equal" value="CONST(0)"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(mentorsm.gif)" alt="mentoring" imgalign="absmiddle">
												<WTLINK name="0410" class="PageHeadingLink" return="false">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="PARAM(M)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
													<WTPARAM name="Popup" value="PARAM(Popup)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, '2'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(calendarsm.gif)" alt="calendar" imgalign="absmiddle">
												<WTLINK name="Calendar" class="PageHeadingLink" target="Calendar">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'H'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(goalsm.gif)" alt="goals" imgalign="absmiddle">
												<WTLINK name="7001" class="PageHeadingLink" target="Goals">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="PARAM(MemberID)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'h'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Contactsm.gif)" alt="viewcontacts" imgalign="absmiddle">
												<WTLINK name="8161" class="PageHeadingLink" target="Sales">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'E'))"/>
											<WTCONDITION expr="CONST(contains)" value="CONST((@options, 'E'))" connector="or"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Prospectsm.gif)" alt="viewprospects" imgalign="absmiddle">
												<WTLINK name="8101" class="PageHeadingLink" target="Sales">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, '6'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Customersm.gif)" alt="viewcustomers" imgalign="absmiddle">
												<WTLINK name="8151" class="PageHeadingLink" target="Sales">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'L'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Assessmentsm.gif)" alt="assessments" imgalign="absmiddle">
												<WTLINK name="3411" class="PageHeadingLink" target="Assessments">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'K'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Classsm.gif)" alt="classes" imgalign="absmiddle">
												<WTLINK name="1314" class="PageHeadingLink" target="Courses">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'F'))"/>
											<WTCONDITION expr="CONST(contains)" value="CONST((@options, 'F'))" connector="or"/>
											<WTCONDITION expr="CONST(contains)" value="CONST((@options, 'f'))" connector="or"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Projectsm.gif)" alt="projects" imgalign="absmiddle">
												<WTLINK name="7501" class="PageHeadingLink" target="Projects">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="CompanyID" value="DATA(CompanyID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="2"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.Quantity)" oper="equal" value="CONST(0)"/>
											<WTIMAGE value="CONST(notessm.gif)" alt="notes" imgalign="absmiddle">
												<WTLINK name="0415" class="PageHeadingLink" target="Notes">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="NewDate" value="PARAM(NewDate)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.Quantity)" oper="greater" value="CONST(0)"/>
											<WTIMAGE value="CONST(notessm1.gif)" alt="notes" imgalign="absmiddle">
												<WTLINK name="0415" class="PageHeadingLink" target="Notes">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="NewDate" value="PARAM(NewDate)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="2"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.NotifyMentor)" oper="not-exist"/>
											<WTIMAGE value="CONST(notifysm.gif)" alt="notifications" imgalign="absmiddle">
                        <WTLINK name="ViewNotify(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.NotifyMentor)" oper="exist"/>
											<WTIMAGE value="CONST(notifysm1.gif)" alt="notifications" imgalign="absmiddle">
                        <WTLINK name="ViewNotify(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>

									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTSTATIC value="DATA(Member.VisitDate)" fontcolor="purple" newline="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Trash.gif)" alt="Remove" imgalign="absmiddle">
											<WTLINK name="0410" class="PageHeadingLink" return="false">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="RemoveID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
												<WTPARAM name="Popup" value="PARAM(Popup)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
<!--									
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(ChangeMentor)" oper="equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(mentora_sm.gif)" alt="Reassign" imgalign="absmiddle">
											<WTLINK name="0424" class="PageHeadingLink" target="mentor" return="false">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
-->									
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="2" align="left" tag="TotalMembers" value="PARAM(Count)" bold="true"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="2" value="CONST(MarkRead)" align="center"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="greater" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_0410" caption="Member Mentoring" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98" track="0">
			<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="MentorID" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="RemoveID" datatype="number"/>
			<WTPARAM name="NewDate" datatype="date"/>
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="Emails" datatype="text"/>
			<WTPARAM name="ChangeMentor" datatype="number"/>

			<WTINCLUDE name="Label.asp"/>
			<WTINCLUDE name="Comm.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotMentoring" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadMentor">


				<WTSETATTRIBUTE name="CONST(MemberOptions)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompany)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (&quot; + .MemberID + &quot;)&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="PARAM(MentorID)" value="ATTR(MentorID)"/>
					<WTSETATTRIBUTE name="PARAM(NewDate)" value="ATTR(VisitDate)">
						<WTCONDITION expr="NotMemberOnly"/>
					</WTSETATTRIBUTE>
					<WTGETCACHE name="PARAM(NewDate)" value="VISITDATE">
						<WTCONDITION expr="IsMemberOnly"/>
					</WTGETCACHE>
					<WTSETATTRIBUTE name="PARAM(NewDate)" value="SYS(Date)">
						<WTCONDITION expr="PARAM(NewDate)" oper="equal" value="CONST(&quot;0&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MemberID)">
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="Load">
						<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MentorID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="ATTR(NameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(MentorID)" value="CONST(0)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="IsMemberOnly"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompany)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTCUSTOM>
					If InStr( CompanyOptions + MemberOptions, "~G" ) = 0 Then
					reqChangeMentor = 1
					Else
					reqChangeMentor = 0
					End If
				</WTCUSTOM>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ListMentor">
						<WTPARAM name="MentorID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="VisitDate" direction="input" value="PARAM(NewDate)"/>
					</WTMETHOD>
					<WTCUSTOM>
						reqEmails = ""
						cnt = 0
						For Each oMember in oMembers
						If cnt &lt;&gt; 0 Then reqEmails = reqEmails + ";"
						With oMember
						If InStr( .Email, "@") &gt; 0 Then  reqEmails = reqEmails + .Email
						End With
						cnt = cnt + 1
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(RemoveID)" oper="not-equal" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="RemoveMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(RemoveID)"/>
						<WTPARAM name="Status" direction="input" value="SYSCON(REMOVE-MENTOR)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

			<WTACTION id="2" name="Mark" type="New">
				<WTSETATTRIBUTE name="PARAM(NewDate)" value="CONST(Now())"/>
				<WTSETCACHE name="VISITDATE" value="PARAM(NewDate)"/>
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="New">
				<WTSETATTRIBUTE name="CONST(tmpMentorID)" value="FORM(MentorID)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpMentorID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(NameFirst)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10113" message="Oops, The selected Mentor # does not exist."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Member.Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompany)" value="ATTR(Member.CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Member.Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Member.Level)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email2)"/>
					<WTSETATTRIBUTE name="CONST(tmpMsgTo)" value="ATTR(MemberID)">
						<WTCONDITION expr="ATTR(IsMsg)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompany)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="CONST(CompanyOptions + MemberOptions)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;g&quot;))" oper="equal" value="CONST(0)"/>
						<WTERROR number="10114" message="Oops, The selected Mentor is not able to be a Mentor with their current membership."/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompany)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="CONST(tmpMentorID)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Member.Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					<!--					<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Phone1 + &quot; &quot; + .Phone2 + &quot;&lt;BR&gt;&quot; + .Street + &quot; &quot; + .Unit + &quot;&lt;BR&gt;&quot; + .City + &quot;, &quot; + .State + &quot; &quot; + .Zip + &quot; &quot; + .Country)"/>-->
					<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						If tmpMentorID &lt;&gt; 0 Then
						filename = "Language\Member[" + reqSysLanguage + "].xml"
						tmpSubject = GetLabel( filename, "NewMentoree") + ": " + tmpSubject

						If InStr(tmpTo, "@") &gt; 0 Then
						If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
						SendEmail reqSysCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
						End If
						If tmpMsgTo &lt;&gt; "" Then
						SendMsg 1, tmpMsgTo, tmpSubject, tmpBody
						End If
						End If
					</WTCUSTOM>
				</WTOBJECT>
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="150" align="left"/>

				<WTLOAD>
					window.location.hash = 'top';
				</WTLOAD>

				<WTFUNCTION name="ViewMember(id)">
					var url, win;
					url = "0421.asp?memberid=" + id
					win = window.open(url,"MemberInfo","top=100,left=100,height=200,width=330,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewPerformance(id)">
					var url, win;
					url = "0445.asp?memberid=" + id
					win = window.open(url,"Performance","top=100,left=100,height=350,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTSTATIC label="NewMentoree"/>
				<WTSTATIC label="emailteam"/>
				<WTSTATIC label="mentoringteam"/>
				<WTSTATIC label="performance"/>
				<WTSTATIC label="mentoring"/>
				<WTSTATIC label="calendar"/>
				<WTSTATIC label="goals"/>
				<WTSTATIC label="viewcontacts"/>
				<WTSTATIC label="viewprospects"/>
				<WTSTATIC label="viewcustomers"/>
				<WTSTATIC label="assessments"/>
				<WTSTATIC label="classes"/>
				<WTSTATIC label="projects"/>
				<WTSTATIC label="notes"/>
				<WTSTATIC label="notifications"/>
				<WTSTATIC label="ViewMentor"/>
				<WTSTATIC label="ViewMyself"/>
				<WTSTATIC label="ViewInfo"/>
				<WTSTATIC label="Remove"/>
				<WTSTATIC label="Reassign"/>
				<!--					
				<WTROW margin-top="6" margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
-->
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTROW margin-bottom="3">
						<WTIMAGE col="1" merge="2" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
						<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" merge="2" label="MyMentorID" align="right" space="2"/>
						<WTTEXT  col="1" value="PARAM(MentorID)" size="4" prespace="false"/>
						<WTBUTTON col="1" action="1" value="CONST(Update)" btnclass="smbutton"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ChangeMentor)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-bottom="3">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="SYS(MemberID)"/>
							<WTIMAGE col="1" merge="2" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
							<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="SYS(MemberID)"/>
							<WTSTATIC col="1" merge="2" label="MyMentorID" align="right" space="2"/>
							<WTTEXT  col="1" value="PARAM(MentorID)" size="4" prespace="false"/>
							<WTBUTTON col="1" action="1" value="CONST(Update)" btnclass="smbutton"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
							<WTIMAGE col="1" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
							<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ChangeMentor)" oper="equal" value="CONST(0)"/>
						<WTROW margin-bottom="3">
							<WTIMAGE col="1" value="CONST(mentormd.gif)" align="left" class="PageHeading" imgalign="absmiddle"/>
							<WTSTATIC col="1"  tag="MentorSystem" value="PARAM(Title)"/>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" class="prompt">
						<WTSTATIC label="MentoringText" space="1"/>
						<!--						
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(HelpMentor)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
-->
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MentorID)" oper="equal" value="CONST(0)"/>
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="NoMentor" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-bottom="2">

						<WTTABLE col="1" merge="2" valign="top" padding="0" style="border: 1px #5084A2 solid">
							<WTCOLUMN width="300" align="center"/>
							<WTROW>
								<WTSTATIC col="1" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(mentora_sm.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC label="MyMentor" fontcolor="darkblue" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsPinnacleTutorial"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
											<WTLINK name="Tutorial" target="Tutorial">
												<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-MENTOREE)"/>
												<WTPARAM name="contentpage" value="CONST(3)"/>
												<WTPARAM name="popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" class="PageHeading" align="left">
									<WTSTATIC bold="true" space="2">
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(Member.Image)" oper="not-equal" value="''"/>
											<WTIMAGE value="ATTR(Member.Image)" align="left" imgalign="absmiddle" imgwidth="50" path="Member"/>
										</WTCODEGROUP>
										<WTSTATIC space="3"/>
										<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
										<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(preview.gif)" alt="ViewInfo" imgalign="absmiddle">
												<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;/DATA/PARAM/@mentorid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="ATTR(Member.Email)">
											<WTLINK type="mail" name="ATTR(Member.Email)"/>
										</WTSTATIC>
									</WTSTATIC>
									<!--									
									<WTSTATIC>
					 					<WTCONDITION expr="SYS(Memberid)" oper="not-equal" value="PARAM(MemberID)"/>
										<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(mentora.gif)" alt="ViewMentor" imgalign="absmiddle">
												<WTLINK name="0410" class="PageHeadingLink" return="false">
													<WTPARAM name="MemberID" value="PARAM(MentorID)"/>
													<WTPARAM name="M" value="PARAM(M)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
													<WTPARAM name="Popup" value="PARAM(Popup)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
									<WTSTATIC>
										<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="PARAM(M)"/>
										<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="PARAM(M)" connector="and"/>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(mentorb.gif)" alt="ViewMyself" imgalign="absmiddle">
												<WTLINK name="0410" class="PageHeadingLink" return="false">
													<WTPARAM name="MemberID" value="PARAM(M)"/>
													<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
													<WTPARAM name="Popup" value="PARAM(Popup)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
-->
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTFRAME col="1" merge="2" src="CONST(m_9011.asp?OwnerType=-4&amp;amp;OwnerID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;&amp;amp;NewDate=&lt;xsl:value-of select=&quot;/DATA/PARAM/@newdate&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;)" name="NotesFrame" frmclass="FrameNoScroll" frmwidth="100" frmheight="150" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!--					
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="_NotMentor" connector="and"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" label="UpgradeToMentor" class="PageHeading" align="center" fontcolor="red"/>
					</WTROW>
				</WTCODEGROUP>
-->
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="_IsMentor" connector="or"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTTABLE col="1" merge="2" valign="top" padding="0" style="border: 1px #5084A2 solid">
							<WTCOLUMN width="175" align="center"/>
							<WTCOLUMN width="125" align="center"/>
							<WTROW>
								<WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(mentorb_sm.gif)" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC label="MyMentorees" fontcolor="darkblue" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="_IsPinnacleTutorial"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
											<WTLINK name="Tutorial" target="Tutorial">
												<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-MENTORING)"/>
												<WTPARAM name="contentpage" value="CONST(3)"/>
												<WTPARAM name="popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" align="center" class="prompt">
									<WTSTATIC>
										<WTSTATIC value="PARAM(MemberID)" space="1" fontcolor="red" bold="true"/>
										<WTSTATIC label="MentorNumberText">
											<WTCONDITION expr="PARAM(ChangeMentor)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC label="MentorNumberText2">
											<WTCONDITION expr="PARAM(ChangeMentor)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
										<!--
										<WTCODEGROUP>
											<WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle">
												<WTLINK name="Page" target="Help">
													<WTPARAM name="Page" value="CONST(HelpMentor)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
-->
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(emailsend.gif)" alt="emailteam" imgalign="absmiddle">
											<WTLINK name="PARAM(Emails)" type="mail"/>
										</WTIMAGE>
										<WTSTATIC space="5"/>
										<WTIMAGE value="CONST(mentoringteam.gif)" alt="mentoringteam" imgalign="absmiddle">
											<WTLINK name="0470" target="Genealogy" return="false">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="Line" value="SYSCON(GENEALOGY-MENTOR)"/>
												<WTPARAM name="Only" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
							<WTCOLUMN width="10" align="center"/>
							<WTCOLUMN width="70" align="left" valign="top" label="MemberName"/>
							<WTCOLUMN width="20" align="right" valign="top" label="Visit"/>
							<WTROW height="48">
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Image)" oper="not-equal" value="''"/>
										<WTIMAGE value="DATA(Image)" align="left" imgalign="absmiddle" imgwidth="25" path="Member"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTSTATIC fontcolor="purple" bold="true">
										<WTSTATIC value="DATA(NameFirst)" space="1"/>
										<WTSTATIC value="DATA(NameLast)" space="1"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(preview.gif)" alt="ViewInfo" imgalign="absmiddle">
											<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC newline="1"/>
									<!-- @unit = Company Options -->
									<WTSTATIC bold="true">
										<!--										
										<WTCODEGROUP>
											<WTCONDITION expr="NotMemberOnly"/>
											<WTCONDITION expr="_IsPerformance" connector="or"/>
											<WTIMAGE value="CONST(performance.gif)" alt="performance" imgalign="absmiddle">
												<WTLINK name="ViewPerformance(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
-->
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(MentorID)" oper="not-equal" value="CONST(0)"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(mentorsm.gif)" alt="mentoring" imgalign="absmiddle">
												<WTLINK name="0410" class="PageHeadingLink" return="false">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="PARAM(M)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(0)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, '2'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(calendarsm.gif)" alt="calendar" imgalign="absmiddle">
												<WTLINK name="Calendar" class="PageHeadingLink" target="Calendar">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'H'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(goalsm.gif)" alt="goals" imgalign="absmiddle">
												<WTLINK name="7001" class="PageHeadingLink" target="Goals">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="PARAM(MemberID)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'h'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Contactsm.gif)" alt="viewcontacts" imgalign="absmiddle">
												<WTLINK name="8161" class="PageHeadingLink" target="Sales">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'E'))"/>
											<WTCONDITION expr="CONST(contains)" value="CONST((@options, 'E'))" connector="or"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Prospectsm.gif)" alt="viewprospects" imgalign="absmiddle">
												<WTLINK name="8101" class="PageHeadingLink" target="Sales">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, '6'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Customersm.gif)" alt="viewcustomers" imgalign="absmiddle">
												<WTLINK name="8151" class="PageHeadingLink" target="Sales">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'L'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Assessmentsm.gif)" alt="assessments" imgalign="absmiddle">
												<WTLINK name="3411" class="PageHeadingLink" target="Assessments">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'K'))"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Classsm.gif)" alt="classes" imgalign="absmiddle">
												<WTLINK name="1314" class="PageHeadingLink" target="Courses">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="CONST(contains)" value="CONST((@unit, 'F'))"/>
											<WTCONDITION expr="CONST(contains)" value="CONST((@options, 'F'))" connector="or"/>
											<WTCONDITION expr="CONST(contains)" value="CONST((@options, 'f'))" connector="or"/>
											<WTSTATIC space="2"/>
											<WTIMAGE value="CONST(Projectsm.gif)" alt="projects" imgalign="absmiddle">
												<WTLINK name="7501" class="PageHeadingLink" target="Projects">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="CompanyID" value="DATA(CompanyID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="2"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.Quantity)" oper="equal" value="CONST(0)"/>
											<WTIMAGE value="CONST(notessm.gif)" alt="notes" imgalign="absmiddle">
												<WTLINK name="0415" class="PageHeadingLink" target="Notes">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="NewDate" value="PARAM(NewDate)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.Quantity)" oper="greater" value="CONST(0)"/>
											<WTIMAGE value="CONST(notessm1.gif)" alt="notes" imgalign="absmiddle">
												<WTLINK name="0415" class="PageHeadingLink" target="Notes">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="M" value="CONST(1)"/>
													<WTPARAM name="NewDate" value="PARAM(NewDate)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="2"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.NotifyMentor)" oper="not-exist"/>
											<WTIMAGE value="CONST(notifysm.gif)" alt="notifications" imgalign="absmiddle">
												<WTLINK name="0417" class="PageHeadingLink">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.NotifyMentor)" oper="exist"/>
											<WTIMAGE value="CONST(notifysm1.gif)" alt="notifications" imgalign="absmiddle">
												<WTLINK name="0417" class="PageHeadingLink">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTSTATIC value="DATA(Member.VisitDate)" fontcolor="purple" newline="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Trash.gif)" alt="Remove" imgalign="absmiddle">
											<WTLINK name="0410" class="PageHeadingLink" return="false">
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
												<WTPARAM name="RemoveID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(0)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<!--									
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(ChangeMentor)" oper="equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(mentora_sm.gif)" alt="Reassign" imgalign="absmiddle">
											<WTLINK name="0424" class="PageHeadingLink" target="mentor" return="false">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
-->
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="2" align="left" tag="TotalMembers" value="PARAM(Count)" bold="true"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(MarkRead)" align="center"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0411" caption="Find" action="5" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MasterID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Max" datatype="number"/>
		   
			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(MemberName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			
			<WTCODEGROUP>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ActiveCount">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MasterID" direction="input" value="PARAM(MasterID)"/>
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="MaxCount">
						<WTPARAM name="MasterID" direction="input" value="PARAM(MasterID)"/>
						<WTPARAM name="reqMax" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(CLng(reqCount))" oper="less" value="CONST(0)"/>
						<WTERROR number="10111" message="Oops, You have exceeded the maximum number of allowed active members."/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XMLFind">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
				<WTMETHOD name="FindMaster">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MasterID" direction="input" value="PARAM(MasterID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XMLFind">
					<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTFUNCTION name="ViewPerformance(id)">
					var url, win;
					url = "0445.asp?memberid=" + id
		            win = window.open(url,"Performance","top=100,left=100,height=350,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTSTATIC label="Business"/>
				<WTSTATIC label="GoalReport"/>
				<WTSTATIC label="CourseReport"/>
				<WTSTATIC label="AssessReport"/>
				
				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="200" align="left"/>
						<WTCOLUMN width="400" align="right"/>
						<WTROW>
							<WTSTATIC col="1" label="Members" class="PageHeading" align="left"/>
							<WTSTATIC col="2">
								<WTSTATIC bold="true">
									<WTSTATIC tag="ActiveMembers" value="PARAM(Count)" space="1"/>
									<WTSTATIC label="of" space="1"/>
									<WTSTATIC value="PARAM(Max)" space="5"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Count)" oper="less" value="PARAM(Max)"/>
									<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="NewMember">
										<WTLINK name="0454">
											<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
											<WTPARAM name="MasterID" value="PARAM(MasterID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
					
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="left" label="MasterMemberText" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Members.FindTypeID)" translate="true">
						<WTOPTION id="419" label="MemberName"/>
						<WTOPTION id="401" label="MemberID"/>
						<WTOPTION id="430" label="Email"/>
						<WTOPTION id="435" label="Status"/>
						<WTOPTION id="438" label="EnrollDate"/>
						<WTOPTION id="471" label="Role"/>
					</WTCOMBO>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Member">
						<WTCOLUMN width="10" align="left" valign="top" label="#"/>
						<WTCOLUMN width="30" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="30" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="5" align="center" valign="top" label="Status"/>
						<WTCOLUMN width="25" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Member.MemberID)"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Member.MemberName)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsMaster)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(Business.gif)" alt="Business" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsMaster)" oper="equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="0464">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
					 					</WTLINK>		
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.Email)"/>
							<WTSTATIC col="4">
								<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="5" align="right">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(performance.gif)" alt="performance" imgalign="absmiddle">
										<WTLINK name="ViewPerformance(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(mentorsm.gif)" alt="mentoring" imgalign="absmiddle">
										<WTLINK name="0410" class="PageHeadingLink" return="false" target="Mentor">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(calendarsm.gif)" alt="calendar" imgalign="absmiddle">
										<WTLINK name="Calendar" class="PageHeadingLink" target="Calendar">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(goalsm.gif)" alt="goals" imgalign="absmiddle">
										<WTLINK name="7001" class="PageHeadingLink" target="Goals">
											<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Classsm.gif)" alt="classes" imgalign="absmiddle">
										<WTLINK name="1311" class="PageHeadingLink" target="Courses">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Assessmentsm.gif)" alt="assessments" imgalign="absmiddle">
										<WTLINK name="3411" class="PageHeadingLink" target="Assessments">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Member.MentorID)" fontcolor="gray"/>
							<WTSTATIC col="2" valign="top" fontcolor="gray">
								<WTSTATIC value="DATA(Role)"/>
							</WTSTATIC>
							<WTSTATIC col="3" valign="top" fontcolor="gray">
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@enrolldate&quot;/&gt;)"/>
								<WTSTATIC space="2"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@visitdate&quot;/&gt;)" fontcolor="purple"/>
							</WTSTATIC>
							<WTSTATIC col="4"/>
							<WTSTATIC col="5" align="right">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(ReportRed.gif)" alt="GoalReport" imgalign="absmiddle">
										<WTLINK name="7020" class="PageHeadingLink" target="GoalReport">
											<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(ReportBlue.gif)" alt="CourseReport" imgalign="absmiddle">
										<WTLINK name="1322" class="PageHeadingLink" target="CourseReport">
											<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(ReportGreen.gif)" alt="AssessReport" imgalign="absmiddle">
										<WTLINK name="3420" class="PageHeadingLink" target="AssessReport">
											<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(logon.gif)" alt="logon" imgalign="absmiddle">
										<WTLINK name="0104" return="false" target="Logon">
											<WTPARAM name="AuthUserID" value="DATA(AuthUserID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="4" fontcolor="gray">
								<WTSTATIC value="CONST(D:)"/>
								<WTSTATIC value="DATA(Member.Phone1)" space="2"/>
								<WTSTATIC value="CONST(N:)"/>
								<WTSTATIC value="DATA(Member.Phone2)" space="2"/>
								<WTSTATIC value="CONST(M:)"/>
								<WTSTATIC value="DATA(Member.Fax)" space="2"/>
								<WTSTATIC value="DATA(Member.CompanyName)">
									<WTCONDITION expr="DATA(IsCompany)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0412" caption="Add Member" navbar="false" aspstyle="GenerateWebASP.xsl" 
		xslstyle="GenerateWebXSLAdd.xsl">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>    <!-- Pass in from other page -->
			<WTPARAM name="MasterID" datatype="number"/>     <!-- Pass in from other page -->
			<WTPARAM name="Membership" datatype="number"/>   <!-- Pass in from other page -->
			<WTPARAM name="Status" datatype="number"/>       <!-- Pass in from other page -->
			<WTPARAM name="Level" datatype="number"/>        <!-- Pass in from other page -->
			<WTPARAM name="GroupID" datatype="number"/>      <!-- Pass in from other page -->
			<WTPARAM name="Refer" datatype="text"/>          <!-- Pass in from other page -->
			<WTPARAM name="RefName" datatype="text"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Billing" datatype="number"/>
			<WTPARAM name="IsReferral" datatype="number"/>
			<WTPARAM name="Price" datatype="currency"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(0)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Set company options --> 
					<WTSETATTRIBUTE name="PARAM(IsReferral)" value="ATTR(IsDiscount)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="NewMember">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Set company options -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="CONST(tmpBilling)" value="ATTR(Billing)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(1)" connector="or"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price2)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price3)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail3)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpInitPrice)" value="ATTR(InitPrice)"/>
					<WTSETATTRIBUTE name="CONST(tmpDiscount)" value="ATTR(Discount)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="ATTR(IsDiscount)"/>
					<WTSETATTRIBUTE name="CONST(tmpBusPrice)" value="ATTR(BusPrice)"/>
					<WTSETATTRIBUTE name="CONST(tmpBusRetail)" value="ATTR(BusRetail)"/>
					<WTSETATTRIBUTE name="CONST(tmpBusAccts)" value="ATTR(BusAccts)"/>
					<WTSETATTRIBUTE name="CONST(tmpBusAcctPrice)" value="ATTR(BusAcctPrice)"/>
					<WTSETATTRIBUTE name="CONST(tmpBusAcctRetail)" value="ATTR(BusAcctRetail)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsBusAcct)" value="ATTR(IsBusAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpPromoID)" value="ATTR(PromoCode)"/>
					<WTSETATTRIBUTE name="CONST(tmpAccessLimit)" value="ATTR(AccessLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberLimit)" value="ATTR(MemberLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpTrialDays)" value="ATTR(TrialDays)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsTrialPayment)" value="ATTR(IsTrialPayment)"/>
					<WTSETATTRIBUTE name="PARAM(RefName)" value="ATTR(RefName)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Pre-set attributes from company into member account -->
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(FormatDateTime(.EnrollDate,2))"/>
<!--					<WTSETATTRIBUTE name="ATTR(Country)" value="CONST(&quot;USA&quot;)"/>-->
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(tmpBilling)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="PARAM(Level)"/>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpInitPrice)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(tmpRetail)"/>
					<WTSETATTRIBUTE name="ATTR(Discount)" value="CONST(tmpDiscount)"/>
					<WTSETATTRIBUTE name="ATTR(IsDiscount)" value="CONST(tmpIsDiscount)"/>
					<WTSETATTRIBUTE name="ATTR(PromoID)" value="CONST(tmpPromoID)"/>
					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(tmpAccessLimit)"/>
					<WTSETATTRIBUTE name="ATTR(QuizLimit)" value="CONST(tmpQuizLimit)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(tmpTrialDays)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;d&quot;, tmpTrialDays, reqSysDate))"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(Referral)" value="PARAM(Refer)"/>
					<WTSETATTRIBUTE name="ATTR(Timezone)" value="CONST(-6)"/>
					<!-- Pre-set attributes for individual member account	-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="SYSCON(ACCT-INDIVIDUAL)"/>
						<!-- Use the default billing from the Company -->
						<!-- Pre-set attributes for business member account	-->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(MasterID)" value="PARAM(MasterID)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpBusAcctPrice)"/>
							<WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(tmpBusAcctRetail)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="SYSCON(MEMBER-BILL-MASTER)"/>
						</WTCODEGROUP>
<!--
						<WTSETATTRIBUTE name="ATTR(Billing)" value="SYSCON(MEMBER-BILL-NONE)">
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-FREE)"/>
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)" connector="or" paren="start"/>
							<WTCONDITION expr="CONST(tmpIsTrialPayment)" oper="equal" value="SYSCON(NO)" connector="and" paren="end"/>
						</WTSETATTRIBUTE>
-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="SYSCON(ACCT-BUSINESS)"/>
						<!-- Pre-set attributes for business master account	-->
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpBusPrice)"/>
						<WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(tmpBusRetail)"/>
						<WTSETATTRIBUTE name="ATTR(BusAccts)" value="CONST(tmpBusAccts)"/>
						<WTSETATTRIBUTE name="ATTR(BusAcctPrice)" value="CONST(tmpBusAcctPrice)"/>
						<WTSETATTRIBUTE name="ATTR(BusAcctRetail)" value="CONST(tmpBusAcctRetail)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="SYSCON(MEMBER-BILL-MEMBER)"/>
						<WTSETATTRIBUTE name="ATTR(IsMaster)" value="SYSCON(YES)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCALLSUB name="LoadCountry"/>
			</WTSUB>
			<WTSUB name="LoadCountry">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTRETURN>
							<WTLINK name="0406" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								<WTPARAM name="MemberID" value="CONST(MemberID)"/>
								<WTPARAM name="Email" value="CONST(tmpEmail)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="ValidAddress">
				<WTSETATTRIBUTE name="CONST(tmpStreet1)" value="FORM(Street1)"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="CONST(tmpStreet1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="AddMember">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(reqMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
 						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				
				<!-- check for a referring member number -->
				<WTGETCACHE name="CONST(tmpReferralID)" value="A" datatype="number"/>
				
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(tmpReferralID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpReferralID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST( CCUR(.Price) + CCUR(.InitPrice) )"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(Icons)" value="FORM(Icons)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(MasterID)" value="PARAM(MasterID)"/>
					<WTSETATTRIBUTE name="PARAM(Billing)" value="ATTR(Billing)">
						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="SYSCON(MEMBER-FREE)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Billing)" value="CONST(0)">
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-FREE)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;d&quot;, .TrialDays, reqSysDate))"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Level)" value="PARAM(Level)"/>
<WTCUSTOM>
			If .CompanyName &lt;&gt; &quot;&quot; Then .IsCompany = &quot;1&quot;
			If .CompanyName = &quot;&quot; Then .CompanyName = .NameLast + &quot;, &quot; + .NameFirst
</WTCUSTOM>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>
<!--
					<WTSETATTRIBUTE name="ATTR(Options)" value="CONST(&quot;*&quot;)">
						<WTCONDITION expr="IsEasy"/>
					</WTSETATTRIBUTE>
-->					
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpReferralID)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="CONST(tmpReferralID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="CONST(tmpReferralID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="CONST(tmpReferralID)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(Member.Title)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
							<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="PARAM(MemberID)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(oMember.Title)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTOBJECT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(IsMaster)" oper="equal" value="SYSCON(YES)"/>
						<WTSETATTRIBUTE name="ATTR(MasterID)" value="CONST(reqMemberID)"/>
						<WTMETHOD name="Save">
	 						<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(reqMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Icons)" value="FORM(Icons)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCALLSUB name="LoadCountry"/>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCALLSUB name="LoadCompanyOptions"/>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NotDuplicateEmail"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTRETURN>
						<WTCONDITION expr="PARAM(Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)"/>
						<WTCONDITION expr="CONST(tmpPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTLINK name="2902" return="false" secure="true">
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							<WTPARAM name="NextURL" value="CONST(&quot;0413.asp?Enroll=1&quot; &amp; &quot;%26MemberID=&quot; &amp; reqMemberID &amp; &quot;%26Membership=&quot; &amp; reqMembership &amp; &quot;%26Status=&quot; &amp; reqStatus)"/>
						</WTLINK>
					</WTRETURN>
					<WTRETURN>
						<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="SYSCON(MEMBER-BILL-MEMBER)"/>
						<WTCONDITION expr="CONST(tmpPrice)" oper="equal" value="CONST(0)" connector="or"/>
						<WTLINK name="0413" return="false">
							<WTPARAM name="Enroll" value="SYSCON(YES)"/>
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							<WTPARAM name="MemberShip" value="PARAM(Membership)"/>
							<WTPARAM name="Status" value="PARAM(Status)"/>
							<WTPARAM name="Txn" value="CONST(1)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTLINK name="0000" return="false"/>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.Icons)"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="3" label="Enrollment" align="left" class="PageHeading"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="MemberName"/>
					<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
					<WTTEXT col="3" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Email"/>
					<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="CompanyName"/>
					<WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
				</WTROW>
<!--				
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="GroupID"/>
					<WTTEXT col="3" value="ATTR(Member.GroupID)" size="15"/>
					<WTSTATIC col="3" tag="Role"/>
					<WTTEXT col="3" value="ATTR(Member.Role)" size="15" prespace="false"/>
				</WTROW>
-->
				<WTROW>
					<WTHIDDEN value="ATTR(Member.GroupID)"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RefName)" oper="not-equal" value="CONST('')"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2">
							<WTSTATIC value="PARAM(RefName)"/>
							<WTSTATIC value="CONST(:)" space="1"/>
						</WTSTATIC>
						<WTTEXT col="3" value="ATTR(Member.Reference)" size="8"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(IsReferral)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="3">
								<WTSTATIC label="Referring" space="1"/>
								<WTSTATIC value="PARAM(RefName)"/>
								<WTSTATIC value="CONST(:)"/>
							</WTSTATIC>
							<WTTEXT col="3" value="ATTR(Member.Referral)" size="8"/>
						</WTCODEGROUP>
						</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="PARAM(RefName)" oper="equal" value="CONST('')"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Member.Referral)"/>
				</WTROW>
<!--	
				<WTROW>
					<WTCONDITION expr="_IsMentoring"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="MentorID"/>
					<WTTEXT col="3" value="ATTR(Member.MentorID)" size="8"/>
				</WTROW>
-->
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="NewLogon"/>
					<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="NewPassword"/>
					<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
<!--
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="GroupIDRoleText" class="prompt"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
-->
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="SecurityLevelText" align="left" class="prompt"/>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Secure"/>
						<WTTEXT col="3" value="ATTR(Member.Secure)" size="2"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Options"/>
						<WTTEXT col="3" value="ATTR(Member.Options)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Member.Options)"/>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>
<!--
				<WTROW>
					<WTBUTTON col="1" merge="3" action="2" value="CONST(Continue)" align="center"/>
					<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
						<WTCONDITION expr="NotAnonymous"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="3" action="3" value="CONST(Cancel)" align="center">
						<WTCONDITION expr="IsAnonymous"/>
					</WTBUTTON>
				</WTROW>
-->
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="left" label="AddressText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTSTATIC col="2" tag="Address" />
					<WTTEXT col="3" value="ATTR(Address.Street1)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTSTATIC col="2"/>
					<WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTSTATIC col="2" tag="CityState"/>
					<WTTEXT col="3" value="ATTR(Address.City)" size="25"/>
					<WTTEXT col="3" value="ATTR(Address.State)" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTSTATIC col="2" tag="ZipCountry" />
					<WTTEXT col="3" value="ATTR(Address.Zip)" size="10"/>
					<WTCOMBO col="3" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>
			
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="2"/>
					<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Phone1"/>
					<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Phone2"/>
					<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Fax"/>
					<WTTEXT col="3" value="ATTR(Member.Fax)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Timezone" />
					<WTCOMBO col="3" value="ATTR(Member.Timezone)" />
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="EnrollDate"/>
						<WTTEXT col="3" value="ATTR(Member.EnrollDate)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Status"/>
						<WTCOMBO col="3" value="ATTR(Member.Status)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="TrialDays"/>
						<WTTEXT col="3" value="ATTR(Member.TrialDays)" size="2"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Price"/>
						<WTTEXT col="3" value="ATTR(Member.Price)" size="6"/>
						<WTSTATIC col="3" tag="InitPrice"/>
						<WTTEXT col="3" value="ATTR(Member.InitPrice)" size="6" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Retail"/>
						<WTTEXT col="3" value="ATTR(Member.Retail)" size="5"/>
						<WTCHECK col="3" value="ATTR(Member.IsDiscount)"/>
						<WTSTATIC col="3" tag="Discount"/>
						<WTTEXT col="3" value="ATTR(Member.Discount)" size="4" prespace="false"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="BusAccts"/>
						<WTTEXT col="3" value="ATTR(Member.BusAccts)" size="6"/>
						<WTSTATIC col="3" tag="BusAcctPrice"/>
						<WTTEXT col="3" value="ATTR(Member.BusAcctPrice)" size="5" prespace="false"/>
						<WTSTATIC col="3" tag="BusAcctRetail"/>
						<WTTEXT col="3" value="ATTR(Member.BusAcctRetail)" size="5" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2"/>
						<WTCHECK col="3" value="ATTR(Member.IsMaster)" label="IsMaster"/>
						<WTCHECK col="3" value="ATTR(Member.IsCompany)" label="IsCompany"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Billing"/>
						<WTCOMBO col="3" value="ATTR(Member.Billing)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="PromoID"/>
						<WTTEXT col="3" value="ATTR(Member.PromoID)" size="6"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CompanyID"/>
						<WTTEXT col="3" value="ATTR(Member.CompanyID)" size="6"/>
						<WTSTATIC col="3" tag="ReferralID"/>
						<WTTEXT col="3" value="ATTR(Member.ReferralID)" size="6" prespace="false"/>
						<WTSTATIC col="3" tag="SponsorID"/>
						<WTTEXT col="3" value="ATTR(Member.SponsorID)" size="6" prespace="false"/>
					</WTROW>
<!--					
					<WTROW margin-top="3">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="TaxID"/>
						<WTCOMBO col="3" value="ATTR(Member.TaxIDType)"/>
						<WTTEXT col="3" value="ATTR(Member.TaxID)"/>
					</WTROW>
-->					
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="AccessLimitText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="AccessLimit"/>
						<WTTEXT col="3" value="ATTR(Member.AccessLimit)" size="50"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="QuizLimit"/>
						<WTCOMBO col="3" value="ATTR(Member.QuizLimit)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>		
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="EnrollDate" height="18"/>
						<WTSTATIC col="3" value="ATTR(Member.EnrollDate)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="PromoID"/>
						<WTTEXT col="3" value="ATTR(Member.PromoID)" size="6"/>
					</WTROW>

					<WTROW>
						<WTHIDDEN value="ATTR(Member.EnrollDate)"/>
						<WTHIDDEN value="ATTR(Member.Status)"/>
						<WTHIDDEN value="ATTR(Member.TrialDays)"/>
						<WTHIDDEN value="ATTR(Member.Price)"/>
						<WTHIDDEN value="ATTR(Member.InitPrice)"/>
						<WTHIDDEN value="ATTR(Member.Retail)"/>
						<WTHIDDEN value="ATTR(Member.IsDiscount)"/>
						<WTHIDDEN value="ATTR(Member.Discount)"/>
						<WTHIDDEN value="ATTR(Member.BusAccts)"/>
						<WTHIDDEN value="ATTR(Member.BusAcctPrice)"/>
						<WTHIDDEN value="ATTR(Member.BusAcctRetail)"/>
						<WTHIDDEN value="ATTR(Member.IsMaster)"/>
						<WTHIDDEN value="ATTR(Member.IsCompany)"/>
						<WTHIDDEN value="ATTR(Member.CompanyID)"/>
						<WTHIDDEN value="ATTR(Member.ReferralID)"/>
						<WTHIDDEN value="ATTR(Member.SponsorID)"/>
						<WTHIDDEN value="ATTR(Member.AccessLimit)"/>
						<WTHIDDEN value="ATTR(Member.QuizLimit)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Member.Billing)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="IsOrgAdminOnly"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" tag="Billing"/>
					<WTCOMBO col="3" value="ATTR(Member.Billing)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="UserAccess"/>
						<WTCOMBO col="3" value="ATTR(Member.UserGroup)"/>
						<WTCOMBO col="3" value="ATTR(Member.UserStatus)"/>
						</WTROW>
				</WTCODEGROUP>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Member.UserGroup)"/>
					<WTHIDDEN value="ATTR(Member.UserStatus)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="3" action="2" value="CONST(Continue)" align="center"/>
					<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
						<WTCONDITION expr="NotAnonymous"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="3" action="3" value="CONST(Cancel)" align="center">
						<WTCONDITION expr="IsAnonymous"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for Bistrovi -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0442" caption="New Distributor" navbar="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0442">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsBuy" datatype="number"/>
			<WTPARAM name="IsJoin" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>

			<WTPARAM name="SalesOrderID" datatype="number"/>
			<WTPARAM name="Total" datatype="currency"/>
			<WTPARAM name="PayDesc" datatype="text"/>

			<WTINCLUDE name="Billing.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(4)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(4)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<!-- check for a referring member number -->
				<WTGETCACHE name="PARAM(ReferID)" value="A">
					<WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(0)"/>
				</WTGETCACHE>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="CONST(0)">
					<WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(IsBuy)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(IsJoin)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)"/>
				<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="FORM(Phone2)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone1)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCONDITION expr="CONST(tmpPhone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)"/>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
					<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
					<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
					<WTSETATTRIBUTE name="ATTR(CheckNumber)" value="FORM(CheckNumber)" />
					<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(Icons)" value="CONST(tmpIcons)"/>
					<WTSETATTRIBUTE name="ATTR(IsCompany)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CompanyName)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
						<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(ReferID)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					
					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer/Sponsor -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(reqMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-SHIPPING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
				
				<!-- Add Sales Order and payment, if specified -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsBuy)" oper="not-equal" value="SYSCON(NO)"/>
					<WTCONDITION expr="PARAM(IsJoin)" oper="not-equal" value="SYSCON(NO)" connector="or"/>
					<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
						<WTMETHOD name="Load">
							<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(SalesOrder.CompanyID)" value="PARAM(CompanyID)" />
						<WTSETATTRIBUTE name="ATTR(SalesOrder.MemberID)" value="PARAM(MemberID)" />
						<WTSETATTRIBUTE name="ATTR(SalesOrder.OrderDate)" value="SYS(now)" />
						<WTSETATTRIBUTE name="ATTR(SalesOrder.Status)" value="CONST(1)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(IsBuy)" oper="not-equal" value="SYSCON(NO)"/>
							<WTSETATTRIBUTE name="ATTR(SalesOrder.Ship)" value="CONST(1)" />
							<WTSETATTRIBUTE name="ATTR(SalesOrder.Shipping)" value="CONST(13.55)" />
						</WTCODEGROUP>
						<WTMETHOD name="Add">
							<WTPARAM name="reqSalesOrderID" direction="return" datatype="number" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
					</WTOBJECT>
					<WTOBJECT name="SalesItem" project="ptsSalesItemUser" class="CSalesItem">
						<WTMETHOD name="Load">
							<WTPARAM name="SalesItemID" direction="input" value="CONST(0)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(SalesItem.SalesOrderID)" value="PARAM(SalesOrderID)" />
						<WTSETATTRIBUTE name="ATTR(SalesItem.Status)" value="CONST(1)" />
						<WTSETATTRIBUTE name="ATTR(SalesItem.Quantity)" value="CONST(1)" />
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(IsBuy)" oper="not-equal" value="SYSCON(NO)"/>
							<WTSETATTRIBUTE name="ATTR(SalesItem.ProductID)" value="CONST(74)" />
							<WTSETATTRIBUTE name="ATTR(SalesItem.Price)" value="CONST(99.95)" />
							<WTMETHOD name="Add">
								<WTPARAM name="reqSalesItemID" direction="return" datatype="number" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(IsJoin)" oper="not-equal" value="SYSCON(NO)"/>
							<WTSETATTRIBUTE name="ATTR(SalesItem.ProductID)" value="CONST(75)" />
							<WTSETATTRIBUTE name="ATTR(SalesItem.Price)" value="CONST(85.00)" />
							<WTMETHOD name="Add">
								<WTPARAM name="reqSalesItemID" direction="return" datatype="number" />
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
							</WTMETHOD>
						</WTCODEGROUP>
					</WTOBJECT>
					<WTSETATTRIBUTE name="PARAM(Total)" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Total)" value="CONST(reqTotal + 113.50)">
						<WTCONDITION expr="PARAM(IsBuy)" oper="not-equal" value="SYSCON(NO)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Total)" value="CONST(reqTotal + 85)">
						<WTCONDITION expr="PARAM(IsJoin)" oper="not-equal" value="SYSCON(NO)"/>
					</WTSETATTRIBUTE>
					<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
						<WTCONDITION expr="NoErrors"/>
						<WTMETHOD name="Load">
							<WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(Payment.OwnerType)" value="ENTITY(SalesOrder)"/>
						<WTSETATTRIBUTE name="ATTR(Payment.OwnerID)" value="PARAM(SalesOrderID)"/>
						<WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Now)"/>
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(PAYSTATUS-SUBMITTED)"/>
						<WTSETATTRIBUTE name="ATTR(Amount)" value="PARAM(Total)"/>
						<WTSETATTRIBUTE name="ATTR(Total)" value="PARAM(Total)"/>
						<WTSETATTRIBUTE name="ATTR(Description)" value="PARAM(PayDesc)"/>
						<WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(&quot;FBMS + Super Sampler Pack&quot;)">
							<WTCONDITION expr="PARAM(IsBuy)" oper="not-equal" value="SYSCON(NO)"/>
							<WTCONDITION expr="PARAM(IsJoin)" oper="not-equal" value="SYSCON(NO)" connector="and"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(&quot;Super Sampler Pack&quot;)">
							<WTCONDITION expr="PARAM(IsBuy)" oper="not-equal" value="SYSCON(NO)"/>
							<WTCONDITION expr="PARAM(IsJoin)" oper="equal" value="SYSCON(NO)" connector="and"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(&quot;FBMS&quot;)">
							<WTCONDITION expr="PARAM(IsBuy)" oper="equal" value="SYSCON(NO)"/>
							<WTCONDITION expr="PARAM(IsJoin)" oper="not-equal" value="SYSCON(NO)" connector="and"/>
						</WTSETATTRIBUTE>
						<WTMETHOD name="Add">
							<WTPARAM name="PaymentID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="PARAM(IsBuy)" oper="not-equal" value="SYSCON(NO)"/>
						<WTCONDITION expr="PARAM(IsJoin)" oper="not-equal" value="SYSCON(NO)" connector="or"/>
					</WTCALLSUB>
				</WTCODEGROUP>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" tag="ReferredBy" bold="true" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-bottom="18">
						<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" label="IsAgree" align="center" bold="true"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CompanyName"/>
						<WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Email"/>
						<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60" required="true">
							<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="CityState"/>
						<WTTEXT col="3" value="ATTR(Address.City)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="ZipCountry" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" size="10" required="true">
							<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone1"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30" required="true">
							<WTEXIT>if(this.value==''){alert('Day Phone Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone2"/>
						<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewLogon"/>
						<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20"/>
						<WTSTATIC col="3" label="SiteName" italic="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewPassword"/>
						<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTCHECK col="2" merge="2" value="PARAM(IsBuy)" label="IsBuy" align="left" bold="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTSTATIC col="1"/>
						<WTCHECK col="2" merge="2" value="PARAM(IsJoin)" label="IsJoin" align="left" bold="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CheckBank"/>
						<WTTEXT col="3" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CheckName"/>
						<WTTEXT col="3" value="ATTR(Billing.CheckName)" size="25" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CheckRoute"/>
						<WTTEXT col="3" value="ATTR(Billing.CheckRoute)" size="10" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="CheckAccount"/>
						<WTTEXT col="3" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTIMAGE col="2" merge="2" align="center" value="CONST(checkref.gif)"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" tag="ReferredBy" bold="true" align="center"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="2" value="CONST(Submit)" align="center"/>
						<WTBUTTON col="1" merge="3" value="CONST(Cancel)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="MemberAdded" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for Merchant University -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0452" caption="New Student" navbar="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0452">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="Buy" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(5)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(5)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<!-- check for a referring member number -->
				<WTGETCACHE name="PARAM(ReferID)" value="A">
					<WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(0)"/>
				</WTGETCACHE>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="CONST(0)">
					<WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(Buy)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)"/>
				<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="FORM(Phone2)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone1)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCONDITION expr="CONST(tmpPhone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(2)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(2)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					</WTCODEGROUP>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(ReferID)"/>
					</WTCODEGROUP>
					
					<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(5)"/>
					<WTSETATTRIBUTE name="ATTR(LevelChange)" value="CONST(1)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Buy)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(49.95)"/>
						<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Buy)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(44.95)"/>
						<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, 3, reqSysDate))"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Buy)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(39.95)"/>
						<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, 6, reqSysDate))"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Buy)" oper="equal" value="CONST(4)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(34.95)"/>
						<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, 12, reqSysDate))"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					
					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer/Sponsor -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(reqMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-BILLING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ToggleType()">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype; 
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].checked) {
								paytype = payobj[i].value;
								i = l;
							}
						}
						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" tag="ReferredBy" bold="true" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-bottom="18">
						<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" label="IsAgree" align="center" bold="true"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Email"/>
						<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60" required="true">
							<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="CityState"/>
						<WTTEXT col="3" value="ATTR(Address.City)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="ZipCountry" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" size="10" required="true">
							<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone1"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30" required="true">
							<WTEXIT>if(this.value==''){alert('Day Phone Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone2"/>
						<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewLogon"/>
						<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewPassword"/>
						<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
		 				<WTRADIO col="2" merge="2" group="Buy" name="1" check="/DATA/PARAM/@buy=1" align="left"/>
						<WTSTATIC col="2" merge="2" label="Buy1"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
		 				<WTRADIO col="2" merge="2" group="Buy" name="2" check="/DATA/PARAM/@buy=2" align="left"/>
						<WTSTATIC col="2" merge="2" label="Buy2"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
		 				<WTRADIO col="2" merge="2" group="Buy" name="3" check="/DATA/PARAM/@buy=3" align="left"/>
						<WTSTATIC col="2" merge="2" label="Buy3"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
		 				<WTRADIO col="2" merge="2" group="Buy" name="4" check="/DATA/PARAM/@buy=4" align="left"/>
						<WTSTATIC col="2" merge="2" label="Buy4"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTROW>
				 		<WTSTATIC col="1" merge="3" align="center">
				 			<WTCODEGROUP>
				 				<WTRADIO group="PayType" name="1" check="/DATA/PARAM/@paytype=1">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(1);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="2" check="/DATA/PARAM/@paytype=2">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(2);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="5" check="/DATA/PARAM/@paytype=5">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(5);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 		</WTSTATIC>
					</WTROW>

					<WTROW id="CardRows">
						<WTSTATIC col="1"/>
						<WTTABLE col="2" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
									<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardDate"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardName"/>
								<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardCode"/>
								<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" required="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW id="CheckRows">
						<WTSTATIC col="1"/>
						<WTTABLE col="2" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckBank"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckName"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckRoute"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" size="10" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckAccount"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTIMAGE col="2" merge="2" align="center" value="CONST(checkref.gif)"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12">
						<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" tag="ReferredBy" bold="true" align="center"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
							<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" value="CONST(Cancel)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="MemberAdded" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for Columbia Learning Institute -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0453" caption="New Family" navbar="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0453">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Reference" datatype="text"/>

			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="S" datatype="text"/>
			
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(3)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(3)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(Reference)" value="PARAM(S)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="ATTR(CompanyName)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)"/>
				<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="FORM(Phone2)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone1)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCONDITION expr="CONST(tmpPhone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(2)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(2)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					</WTCODEGROUP>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(Reference)" value="PARAM(Reference)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(ReferID)"/>
					</WTCODEGROUP>
					
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(69.95)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 12, reqSysDate))"/>
					<WTSETATTRIBUTE name="ATTR(StatusDate)" value="ATTR(PaidDate)"/>
					<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(5)"/>
					<WTSETATTRIBUTE name="ATTR(LevelChange)" value="CONST(1)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					
					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer/Sponsor -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(reqMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-BILLING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Reference)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10116" message="Oops, Please specify who referred you."/>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ToggleType()">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype; 
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].checked) {
								paytype = payobj[i].value;
								i = l;
							}
						}
						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" class="PageHeading" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-bottom="18">
						<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" label="IsAgree" align="center" bold="true"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Email"/>
						<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60" required="true">
							<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="CityState"/>
						<WTTEXT col="3" value="ATTR(Address.City)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="ZipCountry" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" size="10" required="true">
							<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone1"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30" required="true">
							<WTEXIT>if(this.value==''){alert('Day Phone Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone2"/>
						<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewLogon"/>
						<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewPassword"/>
						<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
				 		<WTSTATIC col="1" merge="3" align="center">
				 			<WTCODEGROUP>
				 				<WTRADIO group="PayType" name="1" check="/DATA/PARAM/@paytype=1">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(1);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="2" check="/DATA/PARAM/@paytype=2">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(2);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="5" check="/DATA/PARAM/@paytype=5">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(5);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 		</WTSTATIC>
					</WTROW>

					<WTROW id="CardRows">
						<WTSTATIC col="1"/>
						<WTTABLE col="2" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
									<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardDate"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardName"/>
								<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardCode"/>
								<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" required="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW id="CheckRows">
						<WTSTATIC col="1"/>
						<WTTABLE col="2" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckBank"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckName"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckRoute"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" size="10" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckAccount"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTIMAGE col="2" merge="2" align="center" value="CONST(checkref.gif)"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12">
						<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" class="PageHeading" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(Reference)" oper="not-equal" value="CONST('')"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(Reference)" tag="StudentName" bold="true" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(Reference)" oper="equal" value="CONST('')"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" align="center"/>
							<WTSTATIC col="2" tag="StudentName"/>
							<WTTEXT col="3" value="PARAM(Reference)" size="15"/>
							<WTSTATIC col="3" label="15chars"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="24" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
							<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" value="CONST(Cancel)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="MemberAdded" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for Master Member -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0454" caption="New Member" navbar="false" header="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0454">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MasterID" datatype="number"/>

			
			
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="AddMember">
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(MasterID)" value="PARAM(MasterID)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(MasterID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					
					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(reqMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="MemberName"/>
						<WTTEXT col="2" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
						<WTTEXT col="2" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Email"/>
						<WTTEXT col="2" value="ATTR(Member.Email)" size="60" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Role"/>
						<WTTEXT col="2" value="ATTR(Member.Role)" size="15"/>
					</WTROW>
					
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="NewLogon"/>
						<WTTEXT col="2" value="ATTR(Member.NewLogon)" size="20"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="NewPassword"/>
						<WTTEXT col="2" value="ATTR(Member.NewPassword)" size="20"/>
					</WTROW>
					<WTROW margin-top="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Submit)" align="center">
							<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Address" />
						<WTTEXT col="2" value="ATTR(Address.Street1)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTTEXT col="2" value="ATTR(Address.Street2)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CityState"/>
						<WTTEXT col="2" value="ATTR(Address.City)" size="25"/>
						<WTTEXT col="2" value="ATTR(Address.State)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="ZipCountry" />
						<WTTEXT col="2" value="ATTR(Address.Zip)" size="10"/>
						<WTCOMBO col="2" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Phone1"/>
						<WTTEXT col="2" value="ATTR(Member.Phone1)" size="30"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Phone2"/>
						<WTTEXT col="2" value="ATTR(Member.Phone2)" size="30"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Fax"/>
						<WTTEXT col="2" value="ATTR(Member.Fax)" size="30"/>
					</WTROW>

					<WTROW margin-top="24" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Submit)" align="center">
							<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
					</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for Parents With Purpose -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0456" caption="New Family" navbar="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0456">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Reference" datatype="text"/>

			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="S" datatype="text"/>
			
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(583)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(583)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(Reference)" value="PARAM(S)">
					<WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="ATTR(CompanyName)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)"/>
				<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="FORM(Phone2)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone1)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCONDITION expr="CONST(tmpPhone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(2)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(2)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					</WTCODEGROUP>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(Reference)" value="PARAM(Reference)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(ReferID)"/>
					</WTCODEGROUP>
					
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(75.00)"/>
					<WTSETATTRIBUTE name="ATTR(StatusDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
					<WTSETATTRIBUTE name="ATTR(StatusChange)" value="CONST(5)"/>
					<WTSETATTRIBUTE name="ATTR(LevelChange)" value="CONST(1)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					
					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer/Sponsor -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(reqMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-BILLING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Reference)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10116" message="Oops, Please specify who referred you."/>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ToggleType()">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype; 
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].checked) {
								paytype = payobj[i].value;
								i = l;
							}
						}
						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" class="PageHeading" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-bottom="18">
						<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" label="IsAgree" align="center" bold="true"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Email"/>
						<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60" required="true">
							<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="CityState"/>
						<WTTEXT col="3" value="ATTR(Address.City)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" size="25" required="true">
							<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="ZipCountry" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" size="10" required="true">
							<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2"/>
						<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone1"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30" required="true">
							<WTEXIT>if(this.value==''){alert('Day Phone Required!');}</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone2"/>
						<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewLogon"/>
						<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewPassword"/>
						<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
					</WTROW>

					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
				 		<WTSTATIC col="1" merge="3" align="center">
				 			<WTCODEGROUP>
				 				<WTRADIO group="PayType" name="1" check="/DATA/PARAM/@paytype=1">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(1);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="2" check="/DATA/PARAM/@paytype=2">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(2);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="5" check="/DATA/PARAM/@paytype=5">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(5);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 		</WTSTATIC>
					</WTROW>

					<WTROW id="CardRows">
						<WTSTATIC col="1"/>
						<WTTABLE col="2" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
									<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardDate"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardName"/>
								<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardCode"/>
								<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" required="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW id="CheckRows">
						<WTSTATIC col="1"/>
						<WTTABLE col="2" merge="2">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckBank"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckName"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckRoute"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" size="10" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckAccount"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTIMAGE col="2" merge="2" align="center" value="CONST(checkref.gif)"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12">
						<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(ReferredBy)" class="PageHeading" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(Reference)" oper="not-equal" value="CONST('')"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="3" value="PARAM(Reference)" tag="StudentName" bold="true" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>				
						<WTCONDITION expr="PARAM(Reference)" oper="equal" value="CONST('')"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" align="center"/>
							<WTSTATIC col="2" tag="StudentName"/>
							<WTTEXT col="3" value="PARAM(Reference)" size="15"/>
							<WTSTATIC col="3" label="15chars"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="24" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
							<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" value="CONST(Cancel)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" label="MemberAdded" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for View TV -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0457" caption="New Affiliate" navbar="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0457">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>

			<WTPARAM name="M" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(6)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(6)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="PARAM(M)" value="CONST(0)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)"/>
				<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="FORM(Phone2)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone1)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCONDITION expr="CONST(tmpPhone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(2)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(2)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					</WTCODEGROUP>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>

					<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
					<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(ReferID)"/>
					
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(29.99)"/>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(99.00)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					
					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer/Sponsor -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<!-- New Member Activation Processing -->
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ToggleType()">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype; 
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].checked) {
								paytype = payobj[i].value;
								i = l;
							}
						}
						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>
				
				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" merge="3" label="ReferralRequired" align="left" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>

						<WTROW margin-top="2">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC value="PARAM(ReferredBy)" bold="true"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
						</WTROW>
						<WTROW margin-bottom="6">
							<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" label="IsAgree" align="center" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="18">
							<WTBUTTON col="1" merge="3" value="CONST(Decline)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>

						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="MemberName"/>
							<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
							<WTTEXT col="3" value="ATTR(Member.NameLast)" width="240" label="NameLast" size="25"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Email"/>
							<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="Address" />
							<WTTEXT col="3" value="ATTR(Address.Street1)" size="60" required="true">
								<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2"/>
							<WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="CityState"/>
							<WTTEXT col="3" value="ATTR(Address.City)" size="25" required="true">
								<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
							</WTTEXT>
							<WTTEXT col="3" value="ATTR(Address.State)" size="25" required="true">
								<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="ZipCountry" />
							<WTTEXT col="3" value="ATTR(Address.Zip)" size="10" required="true">
								<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
							</WTTEXT>
							<WTCOMBO col="3" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Phone1"/>
							<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30" required="true">
								<WTEXIT>if(this.value==''){alert('Day Phone Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Phone2"/>
							<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="NewLogon"/>
							<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="NewPassword"/>
							<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="12">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
				 			<WTSTATIC col="1" merge="3" align="center">
				 				<WTCODEGROUP>
				 					<WTRADIO group="PayType" name="1" check="/DATA/PARAM/@paytype=1">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(1);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="2" check="/DATA/PARAM/@paytype=2">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(2);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="5" check="/DATA/PARAM/@paytype=5">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(5);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 			</WTSTATIC>
						</WTROW>

						<WTROW id="CardRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" required="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CheckRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckBank"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckName"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckRoute"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" size="10" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAccount"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTIMAGE col="2" merge="2" align="center" value="CONST(checkref.gif)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW margin-top="12">
							<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>

						<WTROW margin-top="2">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC value="PARAM(ReferredBy)" bold="true"/>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-top="24" margin-bottom="12">
							<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
								<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="1" merge="3" value="CONST(Cancel)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="MemberAdded" align="center" class="PageHeading"/>
						</WTROW>
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for Wealth Resource Network -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0458" caption="New Member" navbar="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0458">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="Title" datatype="number"/>

			<WTPARAM name="M" datatype="number"/>
			
<!--			<WTINCLUDE name="ACHVerify.asp"/>-->

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(7)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(7)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(11)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="PARAM(M)" value="CONST(0)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(5)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
<!--
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
-->				
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)"/>
				<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="FORM(Phone2)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone1)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCONDITION expr="CONST(tmpPhone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(2)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(2)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
<WTCUSTOM>
'		Dim achReference
'		achResult = VerifyACH( 7, 0, .CheckRoute, .CheckAccount, .CheckAcctType, 1, achReference )
'		If achResult = "POS" Then
'			.Verified = 2
'		Else
'			DoError 10014, "", "Oops, Invalid Check Routing Number or Account Number."
'		End If
</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
		 				<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<!-- Add a Payout Record for each new member -->
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="not-equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-CHECK)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-ECHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)"/>
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)"/>
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)"/>
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)"/>
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)"/>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="reqPayID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	
					
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(1)"/>
<!--					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>-->
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEF&quot;)"/>

					<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
					<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(ReferID)"/>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>

					<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
<!--					<WTSETATTRIBUTE name="ATTR(Level)" value="PARAM(Membership)"/>-->
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(24.95)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(reqSysDate)"/>
<!--					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>-->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(39.95)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(39.95)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="PARAM(Title)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(&quot;1/1/2020&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Sponsor2ID)" value="PARAM(ReferID)"/>
					</WTCODEGROUP>
-->
<!--
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(30)"/>
					</WTCODEGROUP>
-->					
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<!-- New Member Activation Processing -->
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(2)" connector="and"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
					<!-- Send notice to Sponsor -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					tmpType = reqMembership - 1
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" + CStr(reqMemberID) + "&amp;type=" + CStr(tmpType)
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
<!--
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
-->				
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="210" align="right"/>
				<WTCOLUMN width="490" align="left"/>

				<WTFUNCTION name="ToggleType()">
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var VisibleCash = 'none'; var VisibleAgree2 = 'none';
						var paytype; 
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].checked) {
								paytype = payobj[i].value;
								i = l;
							}
						}
						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) {VisibleCheck = ''; VisibleAgree2 = '';}
						if (paytype == 7) VisibleCash = '';
						//document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
						document.getElementById('CashRows').style.display = VisibleCash;
						//document.getElementById('Agree2Row').style.display = VisibleAgree2;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>

<!--				<WTLOAD>ToggleType();</WTLOAD>-->

				<WTSTATIC label="IsAgree"/>
				
				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" merge="3" label="ReferralRequired" align="left" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>

						<WTROW margin-top="2">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC value="PARAM(ReferredBy)" bold="true"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
						</WTROW>
						<WTROW margin-bottom="12">
							<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" align="center" bold="true"/>
						</WTROW>
<!--						
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
		 					<WTRADIO col="2" merge="2" group="Membership" name="1" check="1" align="left"/>
							<WTSTATIC col="2" merge="2" label="StandardMembership" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
		 					<WTRADIO col="2" merge="2" group="Membership" name="2" align="left"/>
							<WTSTATIC col="2" merge="2" label="BasicMembership" bold="true"/>
						</WTROW>
-->						
<!--
						
						<WTROW>
							<WTSTATIC col="1"/>
		 					<WTRADIO col="2" merge="2" group="Membership" name="3" align="left"/>
							<WTSTATIC col="2" merge="2" label="IntroMembership" bold="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" space="5"/>
							<WTSTATIC col="2" merge="2" space="5"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="11" label="Intro1" check="/DATA/PARAM/@title=11" align="left"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" space="5"/>
							<WTSTATIC col="2" merge="2" space="5"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="12" label="Intro2" check="/DATA/PARAM/@title=12" align="left"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" space="5"/>
							<WTSTATIC col="2" merge="2" space="5"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="13" label="Intro3" check="/DATA/PARAM/@title=13" align="left"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" space="5"/>
							<WTSTATIC col="2" merge="2" space="5"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="14" label="Intro4" check="/DATA/PARAM/@title=14" align="left"/>
						</WTROW>
-->
						<WTROW margin-top="6" margin-bottom="18">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>

						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="MemberName"/>
							<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
							<WTTEXT col="3" value="ATTR(Member.NameLast)" width="290" label="NameLast" size="25"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Email"/>
							<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="Address" />
							<WTTEXT col="3" value="ATTR(Address.Street1)" size="60" required="true">
								<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2"/>
							<WTTEXT col="3" value="ATTR(Address.Street2)" size="60"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="CityState"/>
							<WTTEXT col="3" value="ATTR(Address.City)" size="25" required="true">
								<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
							</WTTEXT>
							<WTTEXT col="3" value="ATTR(Address.State)" size="25" required="true">
								<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="ZipCountry" />
							<WTTEXT col="3" value="ATTR(Address.Zip)" size="10" required="true">
								<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
							</WTTEXT>
							<WTCOMBO col="3" value="ATTR(Address.CountryID)">
								<WTOPTION id="224" label="UnitedStates"/>
							</WTCOMBO>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Phone1"/>
							<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30" required="true">
								<WTEXIT>if(this.value==''){alert('Day Phone Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Phone2"/>
							<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="NewLogon"/>
							<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="NewPassword"/>
							<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
<!--						
						<WTROW>
				 			<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="SelectPayment" fontsize="3" fontcolor="blue" bold="true"/>
-->
<!--
				 				<WTCODEGROUP>
				 					<WTRADIO group="PayType" name="1" check="/DATA/PARAM/@paytype=1">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(1);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="2" check="/DATA/PARAM/@paytype=2">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(2);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
-->	
<!--
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="5" check="/DATA/PARAM/@paytype=5">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(5);</WTCLICK>
									</WTIMAGE>
-->									
<!--									
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="7" check="/DATA/PARAM/@paytype=7">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType7.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(7);</WTCLICK>
									</WTIMAGE>
-->									
<!--
				 				</WTCODEGROUP>
				 			</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
-->						
<!--
						<WTROW id="CardRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" required="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
-->
<!--
						<WTROW id="CheckRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" align="center" fontsize="3">
										<WTSTATIC label="Check0" newline="1" bold="true"/>
										<WTSTATIC label="Check1" newline="1" fontcolor="red"/>
										<WTSTATIC label="Check2" newline="1" fontcolor="red"/>
-->
<!--										<WTSTATIC label="Check3"/>-->
<!--
									</WTSTATIC>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1" tag="CheckBank"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckName"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckRoute"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" size="10" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAccount"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true" class="prompt"/>
									<WTSTATIC col="2" label="CheckAccount1"/>
								</WTROW>
								<WTROW>
									<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
								</WTROW>
-->								
<!--
								<WTROW>
									<WTSTATIC col="1" tag="CheckAcctType"/>
									<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
								</WTROW>
-->
<!--
								<WTROW>
									<WTIMAGE col="2" merge="2" align="center" value="CONST(checkref.gif)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
-->
<!--
						<WTROW id="CashRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" merge="2" align="center" fontsize="3">
										<WTSTATIC newline="1"/>
										<WTSTATIC label="MoneyOrder0" newline="1" bold="true"/>
										<WTSTATIC label="MoneyOrder1" newline="2" bold="true"/>
										<WTSTATIC label="MoneyOrder2" newline="1"/>
										<WTSTATIC label="MoneyOrder4" newline="1"/>
										<WTSTATIC label="MoneyOrder5" newline="2"/>
										<WTSTATIC label="MoneyOrder6" newline="1" fontcolor="red" bold="true"/>
										<WTSTATIC label="MoneyOrder7" fontcolor="red" bold="true"/>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
-->
<!--
						<WTROW margin-top="18">
							<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
						</WTROW>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
-->						
						<WTROW margin-top="2">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC value="PARAM(ReferredBy)" bold="true"/>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-top="12" margin-bottom="12">
							<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
								<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="1" merge="3" value="CONST(Cancel)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="MemberAdded" align="center" class="PageHeading"/>
						</WTROW>
<!--						
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="3" value="CONST(Payment)" align="center">
								<WTCLICK>window.location = 'http://www.wix.com/shallowell07/securpaymentcenter';</WTCLICK>
							</WTBUTTON>
						</WTROW>
-->						
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Upgrade Page for Wealth Resource Network -->
		<!--============================================================================================-->
		<WTWEBPAGE name="0458u" caption="Upgrade Member" navbar="false" footer="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0458u">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Upgrade" datatype="number"/>
			<WTPARAM name="OldTitle" datatype="number"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="Result" datatype="text"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(7)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(7)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(OldTitle)" value="ATTR(Title)"/>
				</WTOBJECT>	
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;upgrade.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
					<!-- Upgrade to Regular Membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(39.95)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
						<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Title)" oper="not-equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(MinTitle)" value="PARAM(Title)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(2)"/>
						<WTPARAM name="reqResult" direction="return" datatype="text"/>
					</WTMETHOD>
					<!-- Send notice to Referrer -->
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID + "&amp;msg=" + CStr(reqTitle)
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
				</WTOBJECT>	
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(1)"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(101)"/>
							<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Upgrade)" value="CONST(1)"/>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>
				<WTCOLUMN width="650" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Upgrade)" oper="equal" value="CONST(0)"/>
					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(OldTitle)" oper="not-equal" value="CONST(11)"/>
						<WTCONDITION expr="PARAM(OldTitle)" oper="not-equal" value="CONST(12)" connector="and"/>
						<WTCONDITION expr="PARAM(OldTitle)" oper="not-equal" value="CONST(13)" connector="and"/>
						<WTCONDITION expr="PARAM(OldTitle)" oper="not-equal" value="CONST(14)" connector="and"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="2" label="NoUpgrade" align="center" class="PageHeading"/>
						</WTROW>
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(11)"/>
						<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(12)" connector="or"/>
						<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(13)" connector="or"/>
						<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(14)" connector="or"/>
						<WTROW margin-top="18" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(11)"/>
							<WTROW margin-bottom="12">
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="1" label="RegularMembership" check="1"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="12" label="Intro1-2"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="13" label="Intro1-3"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="14" label="Intro1-4"/>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(12)"/>
							<WTROW margin-bottom="12">
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="1" label="RegularMembership" check="1"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="13" label="Intro2-3"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="14" label="Intro2-4"/>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(13)"/>
							<WTROW margin-bottom="12">
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="1" label="RegularMembership" check="1"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="14" label="Intro3-4"/>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(OldTitle)" oper="equal" value="CONST(14)"/>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
		 						<WTRADIO col="2" group="Title" name="1" label="RegularMembership" check="1"/>
							</WTROW>
						</WTCODEGROUP>

						<WTROW margin-top="12" margin-bottom="18">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>

						<WTROW margin-top="12" margin-bottom="12">
							<WTBUTTON col="1" merge="2" value="CONST(Upgrade)" align="center">
								<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="1" merge="2" value="CONST(Cancel)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Upgrade)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="24">
						<WTSTATIC col="1" merge="2" label="MemberUpgraded" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

<!-- Custom Enrollment Page for To The Nines -->
		<!--============================================================================================-->
		<WTWEBPAGE name="04101" caption="New Consultant" navbar="false" focus="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="04101">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="IsAdded" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="Title" datatype="number"/>

			<WTPARAM name="M" datatype="number"/>

			<WTPARAM name="Street12" datatype="text"/>
			<WTPARAM name="Street22" datatype="text"/>
			<WTPARAM name="City2" datatype="text"/>
			<WTPARAM name="State2" datatype="text"/>
			<WTPARAM name="Zip2" datatype="text"/>

			<WTINCLUDE name="Billing.asp"/>
			
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="CONST(1)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>
				<WTSETATTRIBUTE name="CONST(tmpDescription)" value="CONST(&quot;&quot;)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="PARAM(M)" value="CONST(0)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="NewMember">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>
			
			<WTSUB name="LoadLists">
<!--
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
-->
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;enroll.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)"/>
				<WTSETATTRIBUTE name="CONST(tmpPhone2)" value="FORM(Phone2)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone1)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTCONDITION expr="CONST(tmpPhone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(2)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(2)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP> <!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="ATTR(CardName)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street12)"/>
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street22)"/>
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City2)"/>
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State2)"/>
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip2)"/>
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCALLSUB name="tmpDescription = BillingPayment( oBilling )"/>
				</WTOBJECT>
				<!-- Add a Payout Record for each new member -->
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-CHECK)"/>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)"/>
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)"/>
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)"/>
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)"/>
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)"/>
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(PayID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(PayID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="reqPayID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="AddMember">
				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>	

				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
				</WTOBJECT>
<WTCUSTOM>
MemberName = ""
TitleName = ""
Phone = ""
Email = ""
Market = ""
</WTCUSTOM>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Title)" value="FORM(Title)"/>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(TaxIDType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)"/>
					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEF&quot;)"/>

					<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
					<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(ReferID)"/>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>

					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(39)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(288)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(2)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(418)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(3)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(568)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(4)"/>
					</WTSETATTRIBUTE>
<WTCUSTOM>
tmpPrice = .InitPrice
MemberName = .NameFirst + " " + .NameLast 
Select Case .Title
Case 1: TitleName = "Preferred Member"
Case 2: TitleName = "Retail Consultant"
Case 3: TitleName = "Senior Retail Consultant"
Case 4: TitleName = "Premier Retail Consultant"
End Select
Phone = .Phone1
Email = .Email
</WTCUSTOM>
					<WTMETHOD name="Add">
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)" connector="and"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
					
					<!-- Send notice to Referrer -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Send notice to Company -->
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0447.asp?MemberID=" &amp; reqMemberID  &amp; "&amp;title=" + TitleName 
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>	
				
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-SHIPPING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
<WTCUSTOM>
Market = .City + ", " + .State 
</WTCUSTOM>
					<WTMETHOD name="Add">
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>	
				
				<WTOBJECT name="Signature" project="ptsSignatureUser" class="CSignature">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SignatureID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(Language)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(UseType)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="ATTR(UseID)" value="CONST(1)"/>
<WTCUSTOM>
tmp = CHR(60)+"p"+CHR(62)+CHR(60)+"img align="+CHR(34)+"left"+CHR(34)+" border="+CHR(34)+"0"+CHR(34)+" height="+CHR(34)+"90"+CHR(34)+" hspace="+CHR(34)+"10"+CHR(34)+" src="+CHR(34)+"images/member/" + CSTR(reqMemberID) + ".jpg"+CHR(34)+" vspace="+CHR(34)+"5"+CHR(34)+" /"+CHR(62)+CHR(38)+"nbsp;"+CHR(38)+"nbsp;"
tmp = tmp + CHR(60)+"font color="+CHR(34)+"#808080"+CHR(34)+" face="+CHR(34)+"Arial"+CHR(34)+" size="+CHR(34)+"3"+CHR(34)+CHR(62)+""
tmp = tmp + CHR(60)+"b"+CHR(62)+CHR(38)+"nbsp;"+CHR(38)+"nbsp; " + MemberName + CHR(38)+"nbsp;"+CHR(60)+"/b"+CHR(62)+CHR(60)+"/p"+CHR(62)+CHR(60)+"p"+CHR(62)+""
tmp = tmp + CHR(60)+"p"+CHR(62)+CHR(38)+"nbsp;"+CHR(38)+"nbsp; " + TitleName + CHR(38)+"nbsp;"+CHR(60)+"/p"+CHR(62)+""
tmp = tmp + CHR(60)+"p"+CHR(62)+CHR(38)+"nbsp;"+CHR(60)+"/p"+CHR(62)+CHR(60)+"font size="+CHR(34)+"2"+CHR(34)+CHR(62)+""
tmp = tmp + CHR(60)+"p"+CHR(62)+CHR(38)+"nbsp;"+CHR(38)+"nbsp; Primary Phone: " + Phone + CHR(38)+"nbsp;"+CHR(60)+"br"+CHR(62)+""
tmp = tmp + CHR(38)+"nbsp;"+CHR(38)+"nbsp; Email: "+CHR(60)+"a href="+CHR(34)+"mailto:" + Email + CHR(34)+CHR(62)+"" + Email + CHR(60)+"/a"+CHR(62)+CHR(38)+"nbsp;"+CHR(60)+"/p"+CHR(62)+""
tmp = tmp + CHR(60)+"p"+CHR(62)+CHR(38)+"nbsp;"+CHR(60)+"/p"+CHR(62)+CHR(60)+"p"+CHR(62)+CHR(38)+"nbsp;"+CHR(38)+"nbsp;"+CHR(60)+"br/"+CHR(62)+"" + Market + CHR(60)+"/p"+CHR(62)+""
tmp = tmp + CHR(60)+"p"+CHR(62)+CHR(38)+"nbsp;"+CHR(60)+"/p"+CHR(62)+CHR(60)+"p"+CHR(62)+"" + Welcome + CHR(60)+"/p"+CHR(62)+CHR(60)+"/font"+CHR(62)+CHR(60)+"/font"+CHR(62)+""

.Data = tmp

Set oFileSys = server.CreateObject("Scripting.FileSystemObject")
oFileSys.CopyFile reqSysWebDirectory + "Images\Company/1\consultant.jpg", reqSysWebDirectory + "Images\Member\" + CStr(reqMemberID) + ".jpg"
Set oFileSys = Nothing
</WTCUSTOM>					
					<WTMETHOD name="Add">
						<WTPARAM name="SignatureID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<!-- Add the payment record -->
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(PAYSTATUS-SUBMITTED)"/>
					<WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="ATTR(Total)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="ATTR(Description)" value="CONST(tmpDescription)"/>
					<WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(TitleName + &quot; Enrollment&quot;)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="PaymentID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<!-- New Member Activation Processing -->
<!--
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
-->				
			</WTSUB>
			
			<WTSUB name="LoadMember">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTSETATTRIBUTE name="PARAM(Street12)" value="FORM(Street1)"/>
				<WTSETATTRIBUTE name="PARAM(Street22)" value="FORM(Street2)"/>
				<WTSETATTRIBUTE name="PARAM(City2)" value="FORM(City2)"/>
				<WTSETATTRIBUTE name="PARAM(State2)" value="FORM(State2)"/>
				<WTSETATTRIBUTE name="PARAM(Zip2)" value="FORM(Zip2)"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewMember">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTCALLSUB>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidBilling">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="PARAM(IsAdded)" value="CONST(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>
			
			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="210" align="right"/>
				<WTCOLUMN width="490" align="left"/>

				<WTFUNCTION name="ToggleType()">
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype; 
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].checked) {
								paytype = payobj[i].value;
								i = l;
							}
						}
						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>

<!--				<WTLOAD>ToggleType();</WTLOAD>-->

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(PayID)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>
				
				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="24" margin-bottom="24">
						<WTSTATIC col="1" merge="3" label="ReferralRequired" align="left" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>				
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAdded)" oper="equal" value="CONST(0)"/>

						<WTROW margin-top="2">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC value="PARAM(ReferredBy)" bold="true"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
						</WTROW>
						<WTROW margin-bottom="12">
							<WTCHECK col="1" merge="3" value="PARAM(IsAgree)" align="center" bold="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="1" check="/DATA/PARAM/@title=1" align="left"/>
							<WTSTATIC col="2" merge="2" label="Title1a" bold="true"/>
							<WTSTATIC col="2" merge="2" label="Title1b"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="2" check="/DATA/PARAM/@title=2" align="left"/>
							<WTSTATIC col="2" merge="2" label="Title2a" bold="true"/>
							<WTSTATIC col="2" merge="2" label="Title2b"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="3" check="/DATA/PARAM/@title=3" align="left"/>
							<WTSTATIC col="2" merge="2" label="Title3a" bold="true"/>
							<WTSTATIC col="2" merge="2" label="Title3b"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
		 					<WTRADIO col="2" merge="2" group="Title" name="4" check="/DATA/PARAM/@title=4" align="left"/>
							<WTSTATIC col="2" merge="2" label="Title4a" bold="true"/>
							<WTSTATIC col="2" merge="2" label="Title4b"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="18">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>

						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="MemberName"/>
							<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true"/>
							<WTTEXT col="3" value="ATTR(Member.NameLast)" width="290" label="NameLast" size="25"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Email"/>
							<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Phone1"/>
							<WTTEXT col="3" value="ATTR(Member.Phone1)" size="30" required="true">
								<WTEXIT>if(this.value==''){alert('Day Phone Required!');}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="Phone2"/>
							<WTTEXT col="3" value="ATTR(Member.Phone2)" size="30"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="SSN"/>
							<WTTEXT col="3" value="ATTR(Member.TaxID)" required="true"/>
						</WTROW>
						
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" />
							<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="Address" bold="true"/>
							<WTTEXT col="3" value="ATTR(Address.Street1)" size="60" required="true">
								<WTEXIT>if(this.value==''){alert('Street Required!');} if( getElementById('Street12').value == ''){getElementById('Street12').value = this.value}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2"/>
							<WTTEXT col="3" value="ATTR(Address.Street2)" size="60">
								<WTEXIT>if( getElementById('Street22').value == ''){getElementById('Street22').value = this.value}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="CityState"/>
							<WTTEXT col="3" value="ATTR(Address.City)" size="25" required="true">
								<WTEXIT>if(this.value==''){alert('City Required!');} if( getElementById('City2').value == ''){getElementById('City2').value = this.value}</WTEXIT>
							</WTTEXT>
							<WTTEXT col="3" value="ATTR(Address.State)" size="25" required="true">
								<WTEXIT>if(this.value==''){alert('State Required!');} if( getElementById('State2').value == ''){getElementById('State2').value = this.value}</WTEXIT>
							</WTTEXT>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="ZipCountry" />
							<WTTEXT col="3" value="ATTR(Address.Zip)" size="10" required="true">
								<WTEXIT>if(this.value==''){alert('Zip Code Required!');} if( getElementById('Zip2').value == ''){getElementById('Zip2').value = this.value}</WTEXIT>
							</WTTEXT>
<!--							<WTCOMBO col="3" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>-->
							<WTCOMBO col="3" value="ATTR(Address.CountryID)">
								<WTOPTION id="224" label="UnitedStates"/>
							</WTCOMBO>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="NewLogon"/>
							<WTSTATIC col="3">
								<WTCODEGROUP><WTTEXT value="ATTR(Member.NewLogon)" size="20"/></WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC label="Domain" bold="true"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="NewPassword"/>
							<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="12">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
				 			<WTSTATIC col="1" merge="3" align="center">
				 				<WTCODEGROUP>
				 					<WTRADIO group="PayType" name="1" check="/DATA/PARAM/@paytype=1">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(1);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="2" check="/DATA/PARAM/@paytype=2">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(2);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
<!--				 				
				 				<WTCODEGROUP>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="5" check="/DATA/PARAM/@paytype=5">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(5);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
-->				 				
				 			</WTSTATIC>
						</WTROW>
						<WTROW id="CardRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>

								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" required="true"/>
								</WTROW>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="Address2" bold="true"/>
									<WTTEXT col="2" value="PARAM(Street12)" size="40" required="true">
										<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Street22)" size="20"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CityStateZip"/>
									<WTTEXT col="2" value="PARAM(City2)" size="25" required="true">
										<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(State2)" size="15" required="true">
										<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Zip2)" size="8" required="true">
										<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
<!--
								<WTROW>
									<WTSTATIC col="1" tag="ZipCountry" />
									<WTTEXT col="2" value="PARAM(Zip2)" size="10" required="true">
										<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryID2)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
								</WTROW>
-->
							</WTTABLE>
						</WTROW>
<!--						
						<WTROW id="CheckRows">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckBank"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckName"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckRoute"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" size="10" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAccount"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAcctType"/>
									<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
								</WTROW>
								<WTROW>
									<WTIMAGE col="2" merge="2" align="center" value="CONST(checkref.gif)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW margin-top="12">
							<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
						</WTROW>
-->						
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
						</WTROW>

						<WTROW margin-top="2">
							<WTSTATIC col="1" merge="3" align="center">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC value="PARAM(ReferredBy)" bold="true"/>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-top="12" margin-bottom="12">
							<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
								<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="1" merge="3" value="CONST(Cancel)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAdded)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="MemberAdded" align="center" class="PageHeading"/>
						</WTROW>
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0413" caption="Activate Member" navbar="false" aspstyle="GenerateWebASP.xsl" 
		xslstyle="GenerateWebXSLAdd.xsl">
		<!--============================================================================================-->
			<WTPARAM name="Enroll" datatype="number"/>		<!-- Pass in from other page -->
			<WTPARAM name="Txn" datatype="number"/>			<!-- Pass in from other page -->
			<WTPARAM name="MemberID" datatype="number"/>		<!-- Pass in from other page -->
			<WTPARAM name="Membership" datatype="number"/>	<!-- Pass in from other page -->
			<WTPARAM name="Status" datatype="number"/>		<!-- Pass in from other page -->
			<WTPARAM name="Level" datatype="number"/>        <!-- Pass in from other page - Upgrade Only -->
			<WTPARAM name="Title" datatype="text"/>        

			<WTINCLUDE name="MemberOptions.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTSUB name="DeleteMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Delete">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="MemberActivate">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="SYS(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(CompanyTrialDays)" value="ATTR(TrialDays)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(.Options)"/>
						<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(PaidName)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price2)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail2)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(.Options2)"/>
						<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(PaidName2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price3)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail3)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(.Options3)"/>
						<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(PaidName3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(.ReferralID)" oper="not-equal" value="CONST(0)"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(YES)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MEMBER-PAID)">
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="SYSCON(ACCT-BUSINESS)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Status)" value="PARAM(Status)">
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="SYSCON(ACCT-INDIVIDUAL)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
								<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-INACTIVE)" connector="or"/>
								<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MEMBER-PAID)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-FREE)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(CompanyTrialDays)" oper="equal" value="CONST(0)"/>
									<WTCONDITION expr="ATTR(TrialDays)" oper="not-equal" value="CONST(0)" connector="or"/>
									<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MEMBER-PAID)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(CompanyTrialDays)" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="ATTR(TrialDays)" oper="equal" value="CONST(0)" connector="and"/>
									<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MEMBER-TRIAL)"/>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="CONST(OldStatus)" value="ATTR(Status)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="PARAM(Status)">
							<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="CONST(NewStatus)" value="ATTR(Status)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
							<WTCONDITION expr="CONST(CompanyTrialDays)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTCONDITION expr="ATTR(TrialDays)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(CompanyTrialDays)"/>
							<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;d&quot;, CompanyTrialDays, reqSysDate))"/>
							<WTSETATTRIBUTE name="CONST(tmpUpgraded)" value="CONST(&quot;TRIAL&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpgraded)" value="CONST(&quot;TRIAL&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
							<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
							<WTSETATTRIBUTE name="CONST(tmpUpgraded)" value="CONST(&quot;PAID&quot;)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="CONST(OldLevel)" value="ATTR(Level)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="PARAM(Level)">
							<WTCONDITION expr="PARAM(Level)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)">
							<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="CONST(NewLevel)" value="ATTR(Level)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
						<WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(tmpRetail)"/>
						<WTSETATTRIBUTE name="ATTR(VisitDate)" value="CONST(Now)"/>
						<WTSETATTRIBUTE name="ATTR(StatusChange)" value="SYSCON(NO)"/>
						<WTSETATTRIBUTE name="ATTR(StatusDate)" value="SYSCON(NO)"/>
						<WTSETATTRIBUTE name="ATTR(EndDate)" value="SYSCON(NO)"/>
						<WTSETATTRIBUTE name="SYS(UserMode)" value="ATTR(Status)"/>
						<WTSETCACHE name="SYS(UserMode)" value="SYS(UserMode)"/>

						<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Member.Options)"/>
						<!-- Set Member Sales Options -->
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(Replace(reqSysUserOptions, &quot;E&quot;, &quot;&quot;))">
							<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;E&quot;))" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<!-- Set Member Project Options -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(InStr(reqSysUserOptions,&quot;F&quot;))" oper="greater" value="CONST(0)"/>
							<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(Replace(reqSysUserOptions, &quot;F&quot;, &quot;&quot;))">
								<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;F&quot;))" oper="equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(reqSysUserOptions + &quot;f&quot;)">
								<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;f&quot;))" oper="greater" value="CONST(0)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<!-- If not Bill Member, don't show payments -->
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="CONST(Replace(reqSysUserOptions, &quot;V&quot;, &quot;&quot;))">
							<WTCONDITION expr="CONST(tmpBilling)" oper="not-equal" value="SYSCON(MEMBER-BILL)"/>
						</WTSETATTRIBUTE>
						<WTSETCACHE name="SYS(UserOptions)" value="SYS(UserOptions)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)"/>
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<!-- set all the member's options for pages and training buddy image -->
					<WTCALLSUB name="SetMemberOptions reqSysMemberID, reqSysCompanyID, reqSysLanguage"/>
				</WTOBJECT>

				<WTOBJECT name="Note" project="ptsNoteUser" class="CNote">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)" connector="and"/>
					<WTCONDITION expr="CONST(tmpUpgraded)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="NoteID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;TRIAL Upgraded to &quot; + tmpUpgraded + &quot; (IP:&quot; + Request.ServerVariables(&quot;REMOTE_ADDR&quot;) + &quot;)&quot;)" >
						<WTCONDITION expr="CONST(OldStatus)" oper="equal" value="SYSCON(MEMBER-TRIAL)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;FREE Upgraded to &quot; + tmpUpgraded + &quot; (IP:&quot; + Request.ServerVariables(&quot;REMOTE_ADDR&quot;) + &quot;)&quot;)" >
						<WTCONDITION expr="CONST(OldStatus)" oper="equal" value="SYSCON(MEMBER-FREE)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;REACTIVATED&quot; + &quot; (IP:&quot; + Request.ServerVariables(&quot;REMOTE_ADDR&quot;) + &quot;)&quot;)" >
						<WTCONDITION expr="CONST(OldStatus)" oper="equal" value="SYSCON(MEMBER-INACTIVE)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(&quot;LEVEL Upgraded from &quot; + OldLevel + &quot; to &quot; + NewLevel + &quot; (IP:&quot; + Request.ServerVariables(&quot;REMOTE_ADDR&quot;) + &quot;)&quot;)" >
						<WTCONDITION expr="CONST(OldStatus)" oper="equal" value="CONST(NewStatus)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(AuthUserID)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(NoteDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="CONST(4)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="NoteID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
			    </WTOBJECT>
				<!-- New Member Activation Processing -->
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(6)"/>
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(7)" connector="or"/>
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="SYS(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(100)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="SendMail">
				<WTCODEGROUP>
					<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpAuthUser)" value="ATTR(AuthUserID)"/>
						<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
						<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
						<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
						<WTSETATTRIBUTE name="CONST(tmpMasterID)" value="ATTR(MasterID)"/>
<WTCUSTOM>
						tmpMemberAdded = .NameLast + &quot;, &quot; + .NameFirst
</WTCUSTOM>
				
					</WTOBJECT>
					<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
						<WTMETHOD name="FetchCompany">
							<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompanyID)"/>
						</WTMETHOD>			
						<WTMETHOD name="Load">
							<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
					</WTOBJECT>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpAuthUser)" oper="greater" value="CONST(0)" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(YES)"/>
						<WTRETURN>
							<WTCONDITION expr="IsAnonymous"/>
							<WTLINK name="0105" return="false">
								<WTPARAM name="AuthUserID" value="CONST(tmpAuthUser)"/>
								<WTPARAM name="MailReturnURL" value="CONST(&quot;0430.asp?MemberID=&quot; &amp; tmpMemberID &amp; &quot;%26Enroll=&quot; &amp; reqEnroll)"/>
							</WTLINK>
						</WTRETURN>
						<WTRETURN>
							<WTCONDITION expr="NotAnonymous"/>
							<WTLINK name="0105" return="false">
								<WTPARAM name="AuthUserID" value="CONST(tmpAuthUser)"/>
								<WTPARAM name="MailReturnURL" value="CONST(&quot;0402.asp?CompanyID=&quot; &amp; tmpCompanyID &amp; &quot;%26MemberAdded=&quot; &amp; tmpMemberAdded)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="equal" value="SYSCON(NO)"/>
						<WTRETURN>
							<WTCONDITION expr="IsAnonymous"/>
							<WTLINK name="0430" return="false">
								<WTPARAM name="MemberID" value="CONST(tmpMemberID)"/>
								<WTPARAM name="Enroll" value="PARAM(Enroll)"/>
							</WTLINK>
						</WTRETURN>
						<WTRETURN>
							<WTCONDITION expr="NotAnonymous"/>
							<WTLINK name="0402" return="false">
								<WTPARAM name="CompanyID" value="CONST(tmpCompanyID)"/>
								<WTPARAM name="MasterID" value="CONST(tmpMasterID)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(YES)"/>
					<!-- New Enrollments are activated and redirected to the 0430 Confirmation page -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Txn)" oper="equal" value="SYSCON(YES)"/>
						<WTCALLSUB name="MemberActivate"/>
  		 				<WTCALLSUB name="SendMail"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Txn)" oper="equal" value="SYSCON(NO)"/>
						<WTCALLSUB name="DeleteMember"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)"/>
					<!-- Upgrades are activated and the Confirmation is displayed on this page -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Txn)" oper="equal" value="SYSCON(YES)"/>
						<WTCALLSUB name="MemberActivate"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTACTION>
			 			
			<WTACTION id="3" name="Cancel" type="Continue">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="SYSCON(YES)"/>
					<WTRETURN>
						<WTLINK name="0404" return="false"/>
					</WTRETURN>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="SYSCON(NO)" />
					<WTRETURN>
						<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(YES)" />
						<WTLINK name="0000" return="false"/>
					</WTRETURN>
					<WTRETURN>
						<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)"/>
						<WTLINK name="0404" return="false"/>
					</WTRETURN>
				</WTCODEGROUP>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="center"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="SYSCON(YES)"/>
					<WTROW margin-top="48">
						<WTSTATIC col="1" class="PageHeading">
							<WTSTATIC label="Congratulations" space="3"/>
							<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
							<WTSTATIC value="ATTR(Member.NameLast)" newline="2"/>
							<WTSTATIC label="InactiveConfirm">
								<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-INACTIVE)"/>
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
								<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)" connector="or"/>
								<WTSTATIC label="UpgradedConfirm" space="1"/>
								<WTSTATIC label="Trial" space="1">
									<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
								</WTSTATIC>
								<WTSTATIC value="PARAM(Title)" space="1"/>
								<WTSTATIC label="Membership"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="48">
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="SYSCON(NO)"/>
					<WTSTATIC col="1" label="FailConfirm" class="PageHeading"/>
				</WTROW>

				<WTROW margin-top="36" margin-bottom="24">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="NotAnonymous"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(Continue)" align="center">
						<WTCONDITION expr="IsAnonymous"/>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="0431" caption="Icon Options" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0431">
			<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="Options" datatype="text" />
			<WTPARAM name="IconE" datatype="number" />
			<WTPARAM name="IconF" datatype="number" />
			<WTPARAM name="IconG" datatype="number" />
			<WTPARAM name="IconH" datatype="number" />
			<WTPARAM name="IconI" datatype="number" />
			<WTPARAM name="IconK" datatype="number" />
			<WTPARAM name="IconL" datatype="number" />
			<WTPARAM name="Icon2" datatype="number" />
			<WTPARAM name="Icon6" datatype="number" />
			<WTPARAM name="Icon_a" datatype="number" />
			<WTPARAM name="Icon_h" datatype="number" />
			<WTPARAM name="Icon_o" datatype="number" />
			<WTPARAM name="Icon_w" datatype="number" />
			<WTPARAM name="Icon_ex" datatype="number" />
			<WTPARAM name="Icon_p" datatype="number" />

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpIcons)" value="ATTR(Icons)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
				Select Case tmpLevel
					Case 0: reqOptions = .FreeOptions + tmpOptions
					Case 1: reqOptions = .Options + tmpOptions
					Case 2: reqOptions = .Options2 + tmpOptions
					Case 3: reqOptions = .Options3 + tmpOptions
				End Select	

'reqOptions = "IGowH2hE6KLaFx"

				x = 1
				While tmpIcons &lt;&gt; ""
					tmpIcon = Left(tmpIcons,1)
					tmpIcons = Mid(tmpIcons,2)
					Select Case tmpIcon
						Case "I": reqIconI = x
						Case "G": reqIconG = x
						Case "o": reqIcon_o = x
						Case "w": reqIcon_w = x
						Case "H": reqIconH = x
						Case "2": reqIcon2 = x
						Case "h": reqIcon_h = x
						Case "E": reqIconE = x
						Case "6": reqIcon6 = x
						Case "K": reqIconK = x
						Case "L": reqIconL = x
						Case "a": reqIcon_a = x
						Case "F": reqIconF = x
						Case "/": reqIcon_ex = x
						Case "[": reqIcon_p = x
					End Select
					x = x + 1
				Wend
</WTCUSTOM>
				</WTOBJECT>

			</WTSUB>

			<WTSUB name="UpdateMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
<WTCUSTOM>
				'Create array of 20 spaces
				aIcons = split(" , , , , , , , , , , , , , , , , , , , ", ",")
				x = 0
				total = UBOUND(aIcons) 
				While x &lt; total
					Select Case x
						Case 0: pos = reqIconI
							tmpIcon = "I"
						Case 1: pos = reqIconG
							tmpIcon = "G"
						Case 2: pos = reqIcon_o
							tmpIcon = "o"
						Case 3: pos = reqIcon_w
							tmpIcon = "w"
						Case 4: pos = reqIconH
							tmpIcon = "H"
						Case 5: pos = reqIcon2
							tmpIcon = "2"
						Case 6: pos = reqIcon_h
							tmpIcon = "h"
						Case 7: pos = reqIconE
							tmpIcon = "E"
						Case 8: pos = reqIcon6
							tmpIcon = "6"
						Case 9: pos = reqIconK
							tmpIcon = "K"
						Case 10: pos = reqIconL
							tmpIcon = "L"
						Case 11: pos = reqIcon_a
							tmpIcon = "a"
						Case 12: pos = reqIconF
							tmpIcon = "F"
						Case 13: pos = reqIcon_ex
							tmpIcon = "/"
						Case 14: pos = reqIcon_p
							tmpIcon = "["
					End Select
					If IsNumeric(pos) AND pos &gt;= 1 AND pos &lt;= total Then
						If aIcons(pos-1) = " " Then aIcons(pos-1) = tmpIcon
					End If 
					x = x + 1
				Wend
				tmpIcons = ""
				For x = 0 to total
					tmpIcon = aIcons(x)
					If tmpIcon &lt;&gt; "" Then tmpIcons = tmpIcons + tmpIcon
				Next
				.Icons = tmpIcons
</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember" />
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember" />
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right" />
				<WTCOLUMN width="440" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Member" value="ATTR(Member.MemberName)" class="PageHeading" align="left">
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
								<WTLINK name="Tutorial" target="Tutorial">
									<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-ICONS)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
									<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="IconText" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'I'))"/>
					<WTSTATIC col="1" tag="MyInfo"/>
					<WTTEXT col="2" value="PARAM(IconI)" size="1"/>
					<WTIMAGE col="2" value="CONST(IconI.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'G'))"/>
					<WTSTATIC col="1" tag="Mentoring"/>
					<WTTEXT col="2" value="PARAM(IconG)" size="1"/>
					<WTIMAGE col="2" value="CONST(IconG.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'o'))"/>
					<WTSTATIC col="1" tag="Genealogy"/>
					<WTTEXT col="2" value="PARAM(Icon_o)" size="1"/>
					<WTIMAGE col="2" value="CONST(Icon_o.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'w'))"/>
					<WTSTATIC col="1" tag="Finances"/>
					<WTTEXT col="2" value="PARAM(Icon_w)" size="1"/>
					<WTIMAGE col="2" value="CONST(Icon_w.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'H'))"/>
					<WTSTATIC col="1" tag="Goals"/>
					<WTTEXT col="2" value="PARAM(IconH)" size="1"/>
					<WTIMAGE col="2" value="CONST(IconH.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, '2'))"/>
					<WTSTATIC col="1" tag="Calendar"/>
					<WTTEXT col="2" value="PARAM(Icon2)" size="1"/>
					<WTIMAGE col="2" value="CONST(Icon2.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'h'))"/>
					<WTSTATIC col="1" tag="Leads"/>
					<WTTEXT col="2" value="PARAM(Icon_h)" size="1"/>
					<WTIMAGE col="2" value="CONST(Icon_h.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
					<WTSTATIC col="1" tag="Sales"/>
					<WTTEXT col="2" value="PARAM(IconE)" size="1"/>
					<WTIMAGE col="2" value="CONST(IconE.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, '6'))"/>
					<WTSTATIC col="1" tag="Customers"/>
					<WTTEXT col="2" value="PARAM(Icon6)" size="1"/>
					<WTIMAGE col="2" value="CONST(Icon6.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'K'))"/>
					<WTSTATIC col="1" tag="Classes"/>
					<WTTEXT col="2" value="PARAM(IconK)" size="1"/>
					<WTIMAGE col="2" value="CONST(IconK.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'L'))"/>
					<WTSTATIC col="1" tag="Assessments"/>
					<WTTEXT col="2" value="PARAM(IconL)" size="1"/>
					<WTIMAGE col="2" value="CONST(IconL.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'a'))"/>
					<WTSTATIC col="1" tag="Resources"/>
					<WTTEXT col="2" value="PARAM(Icon_a)" size="1"/>
					<WTIMAGE col="2" value="CONST(Icon_a.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'F'))"/>
					<WTSTATIC col="1" tag="Projects"/>
					<WTTEXT col="2" value="PARAM(IconF)" size="1"/>
					<WTIMAGE col="2" value="CONST(IconF.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, '/'))"/>
					<WTSTATIC col="1" tag="Expenses"/>
					<WTTEXT col="2" value="PARAM(Icon_ex)" size="1"/>
					<WTIMAGE col="2" value="CONST(Icon_ex.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, '['))"/>
					<WTSTATIC col="1" tag="Performance"/>
					<WTTEXT col="2" value="PARAM(Icon_p)" size="1"/>
					<WTIMAGE col="2" value="CONST(Performance48.gif)" imgalign="absmiddle"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center" />
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center" />
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0416" caption="Conference Access" contentpage="true" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
<!--				<WTCONDITION expr="NotConferencing" connector="and"/>-->
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;ConfHelp.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="Conferencing" align="left" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="ConferencingText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="ConfLine"/>
					<WTSTATIC col="2" bold="true">
						<WTSTATIC value="ATTR(Member.ConfLine)">
							<WTCONDITION expr="ATTR(Member.ConfLine)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
						<WTSTATIC label="Inactive">
							<WTCONDITION expr="ATTR(Member.ConfLine)" oper="not-exist"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
    <WTWEBPAGE name="0417" page-left="10" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="IsClass" datatype="number"/>
			<WTPARAM name="IsAssess" datatype="number"/>
			<WTPARAM name="IsCertify" datatype="number"/>
			<WTPARAM name="IsGoal" datatype="number"/>
			<WTPARAM name="IsProject" datatype="number"/>
			<WTPARAM name="IsSales" datatype="number"/>
			<WTPARAM name="IsSignIn" datatype="number"/>
			<WTPARAM name="IsActivity" datatype="number"/>
			<WTPARAM name="IsResult" datatype="number"/>
			<WTPARAM name="Options" datatype="text" />
      <WTPARAM name="Txn" datatype="number"/>
      <WTPARAM name="MemberName" datatype="text" />

      <!-- CHECK FOR ILLEGAL ACCESS -->
<!--
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
-->
      <WTSUB name="LoadMember">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="PARAM(MemberName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
          <WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
          <WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(Options)"/>
          <WTCUSTOM>
            tmp = .NotifyMentor
            If InStr(tmp, "A") &gt; 0 Then reqIsClass = 1
            If InStr(tmp, "B") &gt; 0 Then reqIsAssess = 1
            If InStr(tmp, "C") &gt; 0 Then reqIsCertify = 1
            If InStr(tmp, "D") &gt; 0 Then reqIsGoal = 1
            If InStr(tmp, "E") &gt; 0 Then reqIsProject = 1
            If InStr(tmp, "F") &gt; 0 Then reqIsSales = 1
            If InStr(tmp, "G") &gt; 0 Then reqIsSignIn = 1
            If InStr(tmp, "H") &gt; 0 Then reqIsActivity = 1
            If InStr(tmp, "I") &gt; 0 Then reqIsResult = 1
          </WTCUSTOM>
        </WTOBJECT>
        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCUSTOM>
            Select Case tmpLevel
            Case 0: reqOptions = .FreeOptions + tmpOptions
            Case 1: reqOptions = .Options + tmpOptions
            Case 2: reqOptions = .Options2 + tmpOptions
            Case 3: reqOptions = .Options3 + tmpOptions
            End Select
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
        <WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
	tmp = ""
	If reqIsClass = 1 Then tmp = tmp + "A"
	If reqIsAssess = 1 Then tmp = tmp + "B"
	If reqIsCertify = 1 Then tmp = tmp + "C"
	If reqIsGoal = 1 Then tmp = tmp + "D"
	If reqIsProject = 1 Then tmp = tmp + "E"
	If reqIsSales = 1 Then tmp = tmp + "F"
	If reqIsSignIn = 1 Then tmp = tmp + "G"
	If reqIsActivity = 1 Then tmp = tmp + "H"
	If reqIsResult = 1 Then tmp = tmp + "I"
	.NotifyMentor = tmp
</WTCUSTOM>
					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
          <WTCALLSUB name="LoadMember"/>
				</WTOBJECT>
<!--
				<WTRETURN>
 					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
-->        
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" align="center" class="PageHeading">
            <WTSTATIC label="MentorNotification" space="1"/>
            <WTSTATIC label="Updated" fontcolor="red">
              <WTCONDITION expr="PARAM(Txn)" oper="not-equal" value="CONST(0)"/>
            </WTSTATIC>
            <WTSTATIC newline="1"/>
            <WTSTATIC value="PARAM(MemberName)"/>
          </WTSTATIC>
        </WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="left" label="MentorNotifyText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTCHECK col="1" value="PARAM(IsSignIn)" label="IsSignIn" align="left"/>
				</WTROW>
        <WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'K'))"/>
					<WTCHECK col="1" value="PARAM(IsClass)" label="IsClass" align="left"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'L'))"/>
					<WTCHECK col="1" value="PARAM(IsAssess)" label="IsAssess" align="left"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'L'))"/>
					<WTCHECK col="1" value="PARAM(IsCertify)" label="IsCertify" align="left"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'H'))"/>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(IsGoal)" label="IsGoal" align="left"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'F'))"/>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'f'))" connector="or"/>
					<WTCHECK col="1" value="PARAM(IsProject)" label="IsProject" align="left"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
					<WTCHECK col="1" value="PARAM(IsSales)" label="IsSales" align="left"/>
				</WTROW>
        <WTCODEGROUP>
					<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'l'))"/>
					<WTROW>
						<WTCHECK col="1" value="PARAM(IsActivity)" label="IsActivity" align="left"/>
					</WTROW>
					<WTROW>
						<WTCHECK col="1" value="PARAM(IsResult)" label="IsResult" align="left"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="6">
					<WTBUTTON col="1" action="1" value="CONST(Update)" align="center"/>
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--==================================================================================================-->
		<WTWEBPAGE name="0418" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl" langfile="0418">
		<!--==================================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Notify" datatype="number"/>
			<WTPARAM name="ID" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text"/>  <!-- NOT USED -->
			<WTPARAM name="IP" datatype="text"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;MENTOR NOTICE: &quot; + .NameFirst + &quot; &quot; + .NameLast + &quot; - &quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNotifyMentor)" value="ATTR(NotifyMentor)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SIGNIN)"/>
						<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Signed In&quot;)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CLASS)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;A&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ASSESS)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;B&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;C&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;D&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-PROJECT)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;E&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SALES)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;F&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SIGNIN)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;G&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ACTIVITY)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;H&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-RESULT)"/>
						<WTCONDITION expr="CONST(InStr(tmpNotifyMentor, &quot;I&quot;))" oper="equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MentorID)" oper="equal" value="CONST(0)"/>
						<WTCUSTOM>response.end</WTCUSTOM>
					</WTCODEGROUP>

          <WTCODEGROUP>
						<WTCONDITION expr="ATTR(MentorID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="ATTR(MentorID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email2)"/>
						<WTSETATTRIBUTE name="CONST(tmpMsgTo)" value="ATTR(MemberID)">
							<WTCONDITION expr="ATTR(IsMsg)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CLASS)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Class&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Assessment" project="ptsAssessmentUser" class="CAssessment">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ASSESS)"/>
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)" connector="or"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AssessmentID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Notify)" value="SYSCON(NOTIFYMENTOR-CERTIFY)">
						<WTCONDITION expr="ATTR(IsCertify)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Assessment&quot;)">
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ASSESS)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Certification&quot;)">
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAssessment" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTOBJECT name="MemberAssess" project="ptsMemberAssessUser" class="CMemberAssess">
          <WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)"/>
          <WTMETHOD name="CheckAssessment">
            <WTPARAM name="tmpMemberAssessID" direction="return" datatype="number"/>
            <WTPARAM name="AssessmentID" direction="input" value="PARAM(ID)"/>
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpMemberAssessID)" oper="not-equal" value="CONST(0)"/>
            <WTMETHOD name="Load">
              <WTPARAM name="MemberAssessID" direction="input" value="CONST(tmpMemberAssessID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot; - PASSED&quot;)">
              <WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(1)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot; - FAILED&quot;)">
              <WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(2)"/>
            </WTSETATTRIBUTE>
            <WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot; &quot; + .Result)"/>
          </WTCODEGROUP>
        </WTOBJECT>

        <WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Goal&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-PROJECT)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Project&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Prospect" project="ptsProspectUser" class="CProspect">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SALES)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Sale&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProspect" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Metric" project="ptsMetricUser" class="CMetric">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ACTIVITY)"/>
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-RESULT)" connector="or"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MetricID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Logged Activity&quot;)">
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ACTIVITY)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Logged Result&quot;)">
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-RESULT)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMetric" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompany)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
				</WTOBJECT>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender" msgto="tmpMsgTo"/>
			   
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>

				<WTROW>
					<WTSTATIC col="1" class="PageHeading">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CLASS)"/>
							<WTSTATIC tag="ClassComplete" value="ATTR(Session.CourseName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ASSESS)"/>
							<WTSTATIC tag="AssessComplete" value="ATTR(Assessment.AssessmentName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)"/>
							<WTSTATIC tag="CertifyComplete" value="ATTR(Assessment.AssessmentName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
							<WTSTATIC tag="GoalComplete" value="ATTR(Goal.GoalName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-PROJECT)"/>
							<WTSTATIC tag="ProjectComplete" value="ATTR(Project.ProjectName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SALES)"/>
							<WTSTATIC tag="SaleComplete" value="ATTR(Prospect.ProspectName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SIGNIN)"/>
							<WTSTATIC tag="SignedIn" value="ATTR(Member.NameFirst)" space="1"/>
							<WTSTATIC value="ATTR(Member.NameLast)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ACTIVITY)"/>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-RESULT)" connector="or"/>
							<WTSTATIC tag="Activity">
								<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ACTIVITY)"/>
							</WTSTATIC>
							<WTSTATIC tag="Result">
								<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-RESULT)"/>
							</WTSTATIC>
							<WTSTATIC value="ATTR(Metric.Qty)">
								<WTCONDITION expr="ATTR(Metric.Qty)" oper="not-equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC value="ATTR(Metric.MetricTypeName)" space="2"/>
							<WTSTATIC value="ATTR(Metric.Note)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Metric.InputValues)" oper="not-equal" value="CONST('')"/>
								<WTSTATIC newline="1"/>
								<WTSTATIC value="ATTTR(Metric.InputValues)"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTSTATIC newline="1"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="not-equal" value="SYSCON(NOTIFYMENTOR-SIGNIN)"/>
							<WTSTATIC tag="CompletedBy" value="ATTR(Member.NameFirst)" space="1"/>
							<WTSTATIC value="ATTR(Member.NameLast)" newline="1"/>
						</WTCODEGROUP>
						<WTSTATIC tag="Date" value="SYS(Date)" space="1"/>
						<WTSTATIC value="SYS(Time)" space="1"/>
						<WTSTATIC value="CONST(CST)" newline="1"/>
						<WTSTATIC tag="Email" value="ATTR(Member.Email)" newline="1"/>
						<WTSTATIC tag="Phone" value="ATTR(Member.Phone1)" newline="1"/>
						<WTSTATIC tag="IP" value="PARAM(IP)" newline="1">
							<WTCONDITION expr="PARAM(IP)" oper="not-equal" value="CONST('')"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================-->
		<WTWEBPAGE name="0438" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl" langfile="0438">
		<!--==================================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Notify" datatype="number"/>
			<WTPARAM name="ID" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text"/>  <!-- NOT USED -->

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpMsgTo)" value="ATTR(MemberID)">
							<WTCONDITION expr="ATTR(IsMsg)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;MEMBER NOTICE: &quot; + .NameFirst + &quot; &quot; + .NameLast + &quot; - &quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpNotifyMentor)" value="ATTR(NotifyMentor)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SIGNIN)"/>
						<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Signed In&quot;)"/>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CLASS)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Class&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Assessment" project="ptsAssessmentUser" class="CAssessment">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ASSESS)"/>
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)" connector="or"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AssessmentID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Notify)" value="SYSCON(NOTIFYMENTOR-CERTIFY)">
						<WTCONDITION expr="ATTR(IsCertify)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Assessment&quot;)">
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ASSESS)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Certification&quot;)">
						<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAssessment" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Goal" project="ptsGoalUser" class="CGoal">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="GoalID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Goal&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGoal" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Project" project="ptsProjectUser" class="CProject">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-PROJECT)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="ProjectID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Project&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProject" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Prospect" project="ptsProspectUser" class="CProspect">
					<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SALES)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="ProspectID" direction="input" value="PARAM(ID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(tmpSubject + &quot;Completed Sale&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlProspect" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompany)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
				</WTOBJECT>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender" msgto="tmpMsgTo"/>
			   
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>

				<WTROW>
					<WTSTATIC col="1" class="PageHeading">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CLASS)"/>
							<WTSTATIC tag="ClassComplete" value="ATTR(Session.CourseName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-ASSESS)"/>
							<WTSTATIC tag="AssessComplete" value="ATTR(Assessment.AssessmentName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-CERTIFY)"/>
							<WTSTATIC tag="CertifyComplete" value="ATTR(Assessment.AssessmentName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-GOAL)"/>
							<WTSTATIC tag="GoalComplete" value="ATTR(Goal.GoalName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-PROJECT)"/>
							<WTSTATIC tag="ProjectComplete" value="ATTR(Project.ProjectName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SALES)"/>
							<WTSTATIC tag="SaleComplete" value="ATTR(Prospect.ProspectName)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="equal" value="SYSCON(NOTIFYMENTOR-SIGNIN)"/>
							<WTSTATIC tag="SignedIn" value="ATTR(Member.NameFirst)" space="1"/>
							<WTSTATIC value="ATTR(Member.NameLast)"/>
						</WTCODEGROUP>
						<WTSTATIC newline="1"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Notify)" oper="not-equal" value="SYSCON(NOTIFYMENTOR-SIGNIN)"/>
							<WTSTATIC tag="CompletedBy" value="ATTR(Member.NameFirst)" space="1"/>
							<WTSTATIC value="ATTR(Member.NameLast)" newline="1"/>
						</WTCODEGROUP>
						<WTSTATIC tag="Date" value="SYS(Date)" space="1"/>
						<WTSTATIC value="SYS(Time)" space="1"/>
						<WTSTATIC value="CONST(CST)" newline="1"/>
						<WTSTATIC tag="Email" value="ATTR(Member.Email)" newline="1"/>
						<WTSTATIC tag="Phone" value="ATTR(Member.Phone1)"/>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0419" caption="Membership Information" navbar="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Error" datatype="number"/>
			<WTPARAM name="Upgrade" datatype="number"/>

			<WTINCLUDE name="Company.asp"/>
			<WTINCLUDE name="CompanyHeader.asp"/>
			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
			 		<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
			 		<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTCALLSUB name="GetCompany(reqCompanyID)"/>
					<!-- Set Company Header -->
					<WTCALLSUB name="SetCompanyHeader reqSysCompanyID, reqSysLanguage"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Error)" oper="not-equal" value="CONST(0)"/>
					<WTERROR number="10112" message="Oops, The selected feature is not available with your membership. Please review the available upgrade options."/>
				</WTCODEGROUP>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Upgrade)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)"/>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-FREE)" connector="and" paren="start"/>
						<WTCONDITION expr="ATTR(Level)" oper="not-equal" value="CONST(1)" connector="or" paren="end"/>
<!--
						<WTCONDITION expr="ATTR(Level)" oper="not-equal" value="CONST(1)" connector="and"/>
						<WTCONDITION expr="ATTR(Billing)" oper="equal" value="SYSCON(MEMBER-BILL-MEMBER)" connector="and"/>
-->
					</WTSETATTRIBUTE>
<!--
					<WTSETATTRIBUTE name="PARAM(Upgrade)" value="CONST(0)">
						<WTCONDITION expr="IsMember"/>
						<WTCONDITION expr="NotUpgrade" connector="and"/>
					</WTSETATTRIBUTE>
-->					
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Membership.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Upgrade" type="Upgrade">
				<WTRETURN>
					<WTLINK name="0405" return="false"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTLINK name="0404" return="false"/>
				</WTRETURN>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750"/>

				<WTROW margin-top="6"/>
				<WTROW>
					<WTBUTTON col="1" action="1" value="CONST(Upgrade)" align="center" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Upgrade)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(ReturnHome)" align="center" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Error)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Error)" oper="equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="6">
					<WTBUTTON col="1" action="1" value="CONST(Upgrade)" align="center">
						<WTCONDITION expr="PARAM(Upgrade)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(ReturnHome)" align="center">
						<WTCONDITION expr="PARAM(Error)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Error)" oper="equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0420" caption="Intro" navbar="false" header="false" footer="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTINCLUDE name="MemberOptions.asp"/>
			
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCALLSUB name="tmpIntroPage = GetMemberOptions(&quot;IP&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpIntroPage)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; &amp; reqCompanyID )"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="0421" page-left="10" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FaceBook" datatype="text"/>
			<WTPARAM name="Twitter" datatype="text"/>
			<WTPARAM name="Google" datatype="text"/>
			<WTPARAM name="Pinterest" datatype="text"/>
			<WTPARAM name="Tumblr" datatype="text"/>
			<WTPARAM name="LinkedIn" datatype="text"/>
			<WTPARAM name="MySpace" datatype="text"/>
			<WTPARAM name="Skype" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
			<!-- CHECK FOR ILLEGAL ACCESS -->
<!--
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTGETCACHE name="CONST(Options2)" value="OPTIONS2" />
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(CLng(.MentorID))" oper="not-equal" value="SYS(MemberID)"/>
					<WTCONDITION expr="CONST(InStr(Options2,&quot;V&quot;))" oper="equal" value="CONST(0)" connector="and"/>
					<WTRETURN>
						<WTLINK name="0101" return="false">
							<WTPARAM name="ActionCode" value="CONST(9)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
			</WTCODEGROUP>
-->
					<WTCODEGROUP>
						<WTCUSTOM>
							aSocNets = split(.SocNet, ":")
							total = UBOUND(aSocNets)
							For x = 0 to total
								aSocNet = split(aSocNets(x), ";")
								Select Case aSocNet(0)
								Case "FB": reqFaceBook = aSocNet(1)
								Case "TW": reqTwitter = aSocNet(1)
								Case "GO": reqGoogle = aSocNet(1)
								Case "PI": reqPinterest = aSocNet(1)
								Case "TU": reqTumblr = aSocNet(1)
								Case "LI": reqLinkedIn = aSocNet(1)
								Case "MS": reqMySpace = aSocNet(1)
								Case "SK": reqSkype = aSocNet(1)
								End Select
							Next
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
					<WTMETHOD name="ListOwnerType">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" bold="true">
						<WTSTATIC value="CONST(#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" space="3"/>
						<WTSTATIC value="ATTR(Member.Status)">
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Member.Status)" fontcolor="green">
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-FREE)" connector="or"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Member.Status)" fontcolor="red">
							<WTCONDITION expr="ATTR(Member.Status)" oper="greater" value="SYSCON(MEMBER-FREE)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Member.IsCompany)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" value="ATTR(Member.CompanyName)"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" value="ATTR(Member.Email)" fontcolor="blue">
						<WTLINK name="ATTR(Member.Email)" type="mail"/>
					</WTSTATIC>
				</WTROW>
				
				<WTREPEAT entity="Address">
					<WTROW>
						<WTSTATIC col="1">
							<WTSTATIC value="DATA(Address.Street1)" space="1"/>
							<WTSTATIC value="DATA(Address.Street2)" newline="1"/>
							<WTSTATIC value="DATA(Address.City)" space="1"/>
							<WTSTATIC value="DATA(Address.State)" space="1"/>
							<WTSTATIC value="DATA(Address.Zip)" space="1"/>
							<WTSTATIC value="DATA(Address.CountryName)"/>
						</WTSTATIC>
					</WTROW>
				</WTREPEAT>

				<WTROW>
					<WTCONDITION expr="ATTR(Member.Phone1)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1">
						<WTSTATIC value="CONST(M:)"/>
						<WTSTATIC value="ATTR(Member.Phone1)" space="3"/>
						<WTSTATIC value="CONST(D:)"/>
						<WTSTATIC value="ATTR(Member.Phone2)" space="3"/>
						<WTSTATIC value="CONST(N:)"/>
						<WTSTATIC value="ATTR(Member.Fax)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1">
						<WTSTATIC value="ATTR(Member.EnrollDate)" space="3"/>
						<WTSTATIC value="ATTR(Member.VisitDate)" fontcolor="purple"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(FaceBook)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="FaceBookUser"/>
					<WTSTATIC col="1" value="PARAM(FaceBook)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Twitter)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="TwitterUser"/>
					<WTSTATIC col="1" value="PARAM(Twitter)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Google)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="GoogleUser"/>
					<WTSTATIC col="1" value="PARAM(Google)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Pinterest)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="PinterestUser"/>
					<WTSTATIC col="1" value="PARAM(Pinterest)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Tumblr)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="TumblrUser"/>
					<WTSTATIC col="1" value="PARAM(Tumblr)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(LinkedIn)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="LinkedInUser"/>
					<WTSTATIC col="1" value="PARAM(LinkedIn)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(MySpace)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="MySpaceUser"/>
					<WTSTATIC col="1" value="PARAM(MySpace)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Skype)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="SkypeUser"/>
					<WTSTATIC col="1" value="PARAM(Skype)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" label="Referrals" align="center" bold="true">
						<WTLINK name="0408" nodata="true" target="Referrals">
							<WTCONDITION expr="ATTR(Member.IsDiscount)" oper="not-equal" value="CONST(0)"/>
							<WTPARAM name="ReferralID" value="PARAM(MemberID)"/>
				 			<WTPARAM name="contentpage" value="CONST(3)"/>
				 			<WTPARAM name="popup" value="CONST(1)"/>
						</WTLINK>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="0421c" page-left="10" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="250" margin-width="0" navbar-width="0" content-width="250" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0421c" secured="52">
      <!--============================================================================================-->
      <WTPARAM name="M" datatype="number"/>

      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(M)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <!-- CHECK FOR ILLEGAL ACCESS -->
			    <WTCODEGROUP>
				    <WTCONDITION expr="IsMemberOnly"/>
				    <WTCONDITION expr="CONST(CLng(.ReferralID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				    <WTRETURN>
					    <WTLINK name="0101" return="false">
						    <WTPARAM name="ActionCode" value="CONST(9)"/>
					    </WTLINK>
				    </WTRETURN>
			    </WTCODEGROUP>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
          <WTMETHOD name="ListOwnerType">
            <WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
            <WTPARAM name="OwnerID" direction="input" value="PARAM(M)"/>
            <WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(13)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="250" align="center"/>

        <WTROW margin-top="6" margin-bottom="3">
          <WTSTATIC col="1" bold="true">
            <WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
            <WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
            <WTSTATIC value="CONST(#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)"/>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="3">
          <WTCONDITION expr="ATTR(Member.IsCompany)" oper="not-equal" value="CONST(0)"/>
          <WTSTATIC col="1" value="ATTR(Member.CompanyName)"/>
        </WTROW>
        <WTROW margin-bottom="3">
          <WTSTATIC col="1" value="ATTR(Member.Email)" fontcolor="blue">
            <WTLINK name="ATTR(Member.Email)" type="mail"/>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" tag="Phone" value="ATTR(Member.Phone1)"/>
        </WTROW>

        <WTREPEAT entity="Address">
          <WTROW>
            <WTSTATIC col="1">
              <WTSTATIC value="DATA(Address.Street1)" space="1"/>
              <WTSTATIC value="DATA(Address.Street2)" newline="1"/>
              <WTSTATIC value="DATA(Address.City)" space="1"/>
              <WTSTATIC value="DATA(Address.State)" space="1"/>
              <WTSTATIC value="DATA(Address.Zip)" newline="1"/>
              <WTSTATIC value="DATA(Address.CountryName)"/>
            </WTSTATIC>
          </WTROW>
        </WTREPEAT>

        <WTROW margin-top="6">
          <WTSTATIC col="1" fontcolor="purple">
            <WTSTATIC tag="Joined" value="ATTR(Member.EnrollDate)" newline="1"/>
            <WTSTATIC tag="Visited" value="ATTR(Member.VisitDate)"/>
          </WTSTATIC>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="12">
          <WTBUTTON col="1" value="CONST(Close)" align="center" btnclass="smbutton">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--============================================================================================-->
		<WTWEBPAGE name="0406" caption="Existing Email" navbar="false" aspstyle="GenerateWebASP.xsl" 
		xslstyle="GenerateWebXSLAdd.xsl" langfile="0406">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Email" datatype="text"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
			</WTACTION>

			<WTACTION id="2" name="Email" type="Email">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpAuthUser)" value="ATTR(AuthUserID)"/>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="0105" return="false">
						<WTPARAM name="AuthUserID" value="CONST(tmpAuthUser)"/>
						<WTPARAM name="MailReturnURL" value="CONST(&quot;0000.asp&quot;)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN>
					<WTLINK name="0402" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="center"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)"/>
					<WTROW margin-top="48">
						<WTSTATIC col="1" label="EmailExists" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-top="24">
						<WTSTATIC col="1" value="PARAM(Email)" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24">
						<WTSTATIC col="1" label="EnterNewEmail" class="PageHeading"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="less" value="CONST(0)"/>
					<WTROW margin-top="48">
						<WTSTATIC col="1" label="EmailSuspended" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-top="24">
						<WTSTATIC col="1" value="PARAM(Email)" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24">
						<WTSTATIC col="1" label="ContactSupport" class="PageHeading"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="36" margin-bottom="24">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="NotAnonymous"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(Continue)" align="center">
						<WTCONDITION expr="IsAnonymous"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="2" value="CONST(EmailLogon)" align="center">
						<WTCONDITION expr="IsAnonymous"/>
						<WTCONDITION expr="PARAM(MemberID)" oper="greater" value="CONST(0)" connector="and"/>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0421x" caption="Member Info" navbar="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
					<WTMETHOD name="ListOwnerType">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="60" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="470" align="left"/>
				<WTCOLUMN width="60"/>
	
				<WTROW margin-top="12">	
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="left" tag="Member" value="ATTR(Member.CompanyName)" class="PageHeading"/>
				</WTROW>
				
				<WTROW margin-top="2" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="MemberID"/>
					<WTSTATIC col="3" value="ATTR(Member.MemberID)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="MemberName"/>
					<WTSTATIC col="3" value="ATTR(Member.MemberName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="CompanyName"/>
					<WTSTATIC col="3" value="ATTR(Member.CompanyName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Status"/>
					<WTSTATIC col="3">
						<WTSTATIC value="ATTR(Member.Status)" fontcolor="green">
							<WTCONDITION expr="ATTR(Member.Status)" oper="less-equal" value="SYSCON(MEMBER-FREE)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Member.Status)" fontcolor="red">
							<WTCONDITION expr="ATTR(Member.Status)" oper="greater" value="SYSCON(MEMBER-FREE)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Email"/>
					<WTSTATIC col="3" value="ATTR(Member.Email)">
						<WTLINK name="ATTR(Member.Email)" type="mail"/>
					</WTSTATIC>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="EnrollDate"/>
					<WTSTATIC col="3" value="ATTR(Member.EnrollDate)"/>
				</WTROW>

				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTREPEAT entity="Address">
					<WTROW>
						<WTSTATIC col="1">
							<WTSTATIC value="DATA(Address.Street1)" space="1"/>
							<WTSTATIC value="DATA(Address.Street2)" space="1"/>
							<WTSTATIC value="DATA(Address.City)" space="1"/>
							<WTSTATIC value="DATA(Address.State)" space="1"/>
							<WTSTATIC value="DATA(Address.Zip)" space="1"/>
							<WTSTATIC value="DATA(Address.CountryName)"/>
						</WTSTATIC>
					</WTROW>
				</WTREPEAT>
				
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1" merge="2"/>
					<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Phone1"/>
					<WTSTATIC col="3" value="ATTR(Member.Phone1)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Phone2"/>
					<WTSTATIC col="3" value="ATTR(Member.Phone2)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Fax"/>
					<WTSTATIC col="3" value="ATTR(Member.Fax)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="4" align="center" action="1" value="Close">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0422" caption="Add Member" navbar="false" worker="true" aspstyle="GenerateWebASP.xsl"> 
		<!--============================================================================================-->
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="R" datatype="text"/>
			<WTPARAM name="First" datatype="text"/>
			<WTPARAM name="Last" datatype="text"/>
			<WTPARAM name="Email" datatype="text"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Level" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="Role" datatype="text"/>
			<WTPARAM name="Secure" datatype="text"/>
			<WTPARAM name="Billing" datatype="text"/>
			<WTPARAM name="Logon" datatype="number"/>
			<WTPARAM name="TT" datatype="number"/>
			<WTPARAM name="TI" datatype="text"/>
			<WTPARAM name="CN" datatype="text"/>
			<WTPARAM name="P1" datatype="text"/>
			<WTPARAM name="P2" datatype="text"/>
			<WTPARAM name="P3" datatype="text"/>
			<WTPARAM name="LG" datatype="text"/>
			<WTPARAM name="PW" datatype="text"/>
			<!-- Upline -->
			<WTPARAM name="Sponsor" datatype="text"/>
			<WTPARAM name="Refer" datatype="text"/>
			<WTPARAM name="Mentor" datatype="text"/>
			<WTPARAM name="SponsorID" datatype="number"/>
			<WTPARAM name="ReferralID" datatype="number"/>
			<WTPARAM name="MentorID" datatype="number"/>
			<!-- Payout Method -->
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<!-- Address -->
			<WTPARAM name="Street1" datatype="text"/>
			<WTPARAM name="Street2" datatype="text"/>
			<WTPARAM name="City" datatype="text"/>
			<WTPARAM name="State" datatype="text"/>
			<WTPARAM name="Zip" datatype="text"/>
			<WTPARAM name="CountryID" datatype="number"/>
			<!-- Membership Options -->
			<WTPARAM name="Price" datatype="currency"/>
			<WTPARAM name="iPrice" datatype="currency"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="Options2" datatype="text"/>

			<WTINCLUDE name="Wallet.asp"/>

			
			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>LogFile "0422", Request.QueryString</WTCUSTOM>
<WTCUSTOM>
	If reqStatus &lt; 0 OR reqStatus &gt; 5 Then reqStatus = 1
	If reqLevel &lt; 0 OR reqLevel &gt; 3 Then reqLevel = 1
	If reqC = 0 Then
		LogFile "0422", "Error - Missing Company"
		response.write "Error - Missing Company"
		response.end
	End If
	If Len(reqFirst) = 0 Then
		LogFile "0422", "Error - Missing First Name"
		response.write "Error - Missing First Name"
		response.end
	End If
	If Len(reqLast) = 0 Then
		LogFile "0422", "Error - Missing Last Name"
		response.write "Error - Missing Last Name"
		response.end
	End If
	If Len(reqEmail) = 0 Then
		LogFile "0422", "Error - Missing Email Address"
		response.write "Error - Missing Email Address"
		response.end
	End If
	If Len(reqEmail) &gt; 80 Then
		LogFile "0422", "Error - Email Address Too Long (80 max.)"
		response.write "Error - Email Address Too Long (80 max.)"
		response.end
	End If
	If Len(reqR) &gt; 15 Then
		LogFile "0422", "Error - Reference # Too Long (15 max.)"
		response.write "Error - Reference # Too Long (15 max.)"
		response.end
	End If
</WTCUSTOM>					
				<WTSETATTRIBUTE name="CONST(MemberID)" value="CONST(0)"/>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
	If .Status &lt;&gt; "2" Then
		LogFile "0422", "Error - Inactive Company"
		response.write "Error - Inactive Company"
		response.end
	End If
</WTCUSTOM>					
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
					<!-- Get the Price if not specified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Price)" oper="equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(1)" connector="or"/>
							<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price)"/>
							<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price2)"/>
							<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail2)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price3)"/>
							<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail3)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<!-- Get the US or Intl Price if specified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Price)" oper="not-equal" value="CONST(0)"/>
						<!-- If Country is US or not specified -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(CountryID)" oper="equal" value="CONST(224)" connector="or"/>
							<WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price)"/>
							<WTSETATTRIBUTE name="CONST(tmpRetail)" value="CONST(0)"/>
						</WTCODEGROUP>
						<!-- If Country is Intl -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(224)" connector="and"/>
							<!-- Use Intl price if specified -->
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(iPrice)" oper="not-equal" value="CONST(0)"/>
								<WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(iPrice)"/>
							</WTCODEGROUP>
							<!-- Use US price if Intl not specified -->
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(iPrice)" oper="equal" value="CONST(0)"/>
								<WTSETATTRIBUTE name="CONST(tmpPrice)" value="PARAM(Price)"/>
							</WTCODEGROUP>
							<WTSETATTRIBUTE name="CONST(tmpRetail)" value="CONST(0)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpInitPrice)" value="ATTR(InitPrice)"/>
					<WTSETATTRIBUTE name="CONST(tmpBilling)" value="ATTR(Billing)"/>
					<WTSETATTRIBUTE name="CONST(tmpDiscount)" value="ATTR(Discount)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="ATTR(IsDiscount)"/>
					<WTSETATTRIBUTE name="CONST(tmpPromoID)" value="ATTR(PromoCode)"/>
					<WTSETATTRIBUTE name="CONST(tmpAccessLimit)" value="ATTR(AccessLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberLimit)" value="ATTR(MemberLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpTrialDays)" value="ATTR(TrialDays)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsNewEmail)" value="ATTR(IsNewEmail)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Level)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
				</WTOBJECT>

				<!-- Check for Payout Method -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpPayQuicker)" value="CONST(PayQuickerCountry( reqCountryID ))"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayQuicker)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(PayType)" value="SYSCON(BILL-COMMTYPE-WALLET-PAYQUICKER)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayQuicker)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(PayType)" value="SYSCON(BILL-COMMTYPE-WALLET-IPAYOUT)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<!-- Create Payout Method Record -->
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(PayType)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-COMMTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-CHECK)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-COMMTYPE-WALLET-PAYQUICKER)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-PAYQUICKER)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Email)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-COMMTYPE-WALLET-IPAYOUT)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-IPAYOUT)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpWalletType)" oper="equal" value="CONST(11)"/>
							<WTCONDITION expr="PARAM(LG)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTCONDITION expr="PARAM(First)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTCONDITION expr="PARAM(Last)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTCONDITION expr="PARAM(Email)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTCUSTOM>
								result = iPayout_RegisterUser( tmpWalletAcct, reqLG, reqFirst, reqLast, reqEmail )
								If result = "" Then .CardName = reqLG
							</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="PARAM(First)" />
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="PARAM(Last)" />
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="PARAM(Street1)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="PARAM(Street2)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="PARAM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="PARAM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="PARAM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="PARAM(CountryID)" />
					<WTMETHOD name="Add">
						<WTPARAM name="reqPayID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- Validate Member Reference Number and Email Address -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">

					<!-- Lookup referring member -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Refer)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTMETHOD name="FetchRef">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Reference" direction="input" value="PARAM(Refer)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(ReferralID)" value="ATTR(MemberID)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)"/>
							<WTCUSTOM>
								LogFile "0422", "Error - Invalid Refer Reference Number"
								response.write "Error - Invalid Refer Reference Number"
								response.end
							</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Mentor)" oper="equal" value="PARAM(Refer)"/>
						<WTCONDITION expr="PARAM(Mentor)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTSETATTRIBUTE name="PARAM(MentorID)" value="PARAM(ReferralID)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="PARAM(Refer)"/>
						<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTSETATTRIBUTE name="PARAM(SponsorID)" value="PARAM(ReferralID)"/>
					</WTCODEGROUP>

					<!-- Lookup sponsoring member -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Sponsor)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(SponsorID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTMETHOD name="FetchRef">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Reference" direction="input" value="PARAM(Sponsor)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(SponsorID)" value="ATTR(MemberID)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
	LogFile "0422", "Error - Invalid Sponsor Reference Number"
	response.write "Error - Invalid Sponsor Reference Number"
	response.end
</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>
					
					<!-- Lookup Mentoring member -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Mentor)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(MentorID)" oper="equal" value="CONST(0)" connector="and"/>
						<WTMETHOD name="FetchRef">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Reference" direction="input" value="PARAM(Mentor)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(MentorID)" value="ATTR(MemberID)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
	LogFile "0422", "Error - Invalid Mentor Reference Number"
	response.write "Error - Invalid Mentor Reference Number"
	response.end
</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Validate Unique Member Reference Number -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(R)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTMETHOD name="FetchRef">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Reference" direction="input" value="PARAM(R)"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)"/>
							<WTRETURN>
								<WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST(0)"/>
								<WTLINK name="0105" return="false">
									<WTPARAM name="AuthUserID" value="ATTR(AuthUserID)"/>
								</WTLINK>
							</WTRETURN>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Logon)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
	LogFile "0422", "Error - Existing Member Reference Number"
	response.write "Error - Existing Member Reference Number"
	response.end
</WTCUSTOM>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<!-- Validate Unique Member Email Address -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(tmpOptions,&quot;k&quot;))" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="ExistEmail">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Email" direction="input" value="PARAM(Email)"/>
							<WTPARAM name="MemberID" direction="return" datatype="number"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(MemberID)" oper="greater" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Logon)" oper="not-equal" value="CONST(0)"/>
								<WTMETHOD name="Load">
									<WTPARAM name="MemberID" direction="input" value="CONST(MemberID)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTRETURN>
									<WTLINK name="0105" return="false">
										<WTPARAM name="AuthUserID" value="ATTR(AuthUserID)"/>
									</WTLINK>
								</WTRETURN>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Logon)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
	LogFile "0422", "Error - Existing Email Address"
	response.write "Error - Existing Email Address"
	response.end
</WTCUSTOM>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>	
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(MemberID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Pre-set attributes from system settings	-->
					<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
					<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
					<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
					<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>

					<!-- Payout Method Record -->
					<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>

					<!-- Pre-set attributes from parameters	-->
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(C)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="PARAM(Status)"/>
					<WTSETATTRIBUTE name="ATTR(Level)" value="PARAM(Level)"/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="PARAM(First)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="PARAM(Last)"/>
					<WTSETATTRIBUTE name="ATTR(Email)" value="PARAM(Email)"/>
					<WTSETATTRIBUTE name="ATTR(Reference)" value="PARAM(R)"/>
					<WTSETATTRIBUTE name="ATTR(Referral)" value="PARAM(Refer)"/>
					<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
					<WTSETATTRIBUTE name="ATTR(Role)" value="PARAM(Role)"/>
					<WTSETATTRIBUTE name="ATTR(Secure)" value="PARAM(Secure)"/>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(MentorID)"/>
					<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferralID)"/>
					<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(SponsorID)"/>
					<WTSETATTRIBUTE name="ATTR(TaxIDType)" value="PARAM(TT)"/>
					<WTSETATTRIBUTE name="ATTR(TaxID)" value="PARAM(TI)"/>
					<WTSETATTRIBUTE name="ATTR(Phone1)" value="PARAM(P1)"/>
					<WTSETATTRIBUTE name="ATTR(Phone2)" value="PARAM(P2)"/>
					<WTSETATTRIBUTE name="ATTR(Fax)" value="PARAM(P3)"/>
					<WTSETATTRIBUTE name="ATTR(NewLogon)" value="PARAM(LG)"/>
					<WTSETATTRIBUTE name="ATTR(NewPassword)" value="PARAM(PW)"/>
					<WTSETATTRIBUTE name="ATTR(Title)" value="PARAM(Title)"/>
					<WTSETATTRIBUTE name="ATTR(Options2)" value="PARAM(Options2)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CN)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="PARAM(CN)"/>
						<WTSETATTRIBUTE name="ATTR(IsCompany)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
						<WTCONDITION expr="PARAM(CN)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
<WTCUSTOM>
.CompanyName = Left(.CompanyName, 60)
.NameFirst = Left(.NameFirst, 30)
.NameLast = Left(.NameLast, 30)
</WTCUSTOM>
					<!-- Pre-set attributes from company into member account -->
					<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(tmpBilling)">
						<WTCONDITION expr="PARAM(Billing)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Billing)" value="PARAM(Billing)">
						<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpInitPrice)"/>
					<WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(tmpRetail)"/>
					<WTSETATTRIBUTE name="ATTR(Discount)" value="CONST(tmpDiscount)"/>
					<WTSETATTRIBUTE name="ATTR(IsDiscount)" value="CONST(tmpIsDiscount)"/>
					<WTSETATTRIBUTE name="ATTR(PromoID)" value="CONST(tmpPromoID)"/>
					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(tmpAccessLimit)"/>
					<WTSETATTRIBUTE name="ATTR(QuizLimit)" value="CONST(tmpQuizLimit)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(tmpTrialDays)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;d&quot;, tmpTrialDays, reqSysDate))"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
					<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>

					<WTMETHOD name="Add">
						<WTPARAM name="NewMemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="ATTR(Member.Title)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
							<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="CONST(NewMemberID)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(oMember.Title)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTOBJECT>
					</WTCODEGROUP>

					<WTHTTP>
						<WTCONDITION expr="ATTR(AuthUserID)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpIsNewEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTLINK name="0105">
							<WTPARAM name="AuthUserID" value="ATTR(AuthUserID)"/>
						</WTLINK>
					</WTHTTP>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(NewMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(Street1)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(NewMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Street1)" value="PARAM(Street1)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="PARAM(Street2)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="PARAM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="PARAM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="PARAM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="PARAM(CountryID)" />
					<WTMETHOD name="Add">
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- Custom Company Activation Processing -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Status" direction="input" value="CONST(100)"/>
							<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(NewMemberID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>

<WTCUSTOM>
	If Len(xmlError) = 0 Then
		response.write NewMemberID
	Else
		LogFile "0422", "Error - " + xmlError
		response.write "Error - " + xmlError
	End If
	response.end
</WTCUSTOM>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0428" caption="Update Member Status" navbar="false" worker="true" aspstyle="GenerateWebASP.xsl"> 
		<!--============================================================================================-->
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="R" datatype="text"/>
			<WTPARAM name="S" datatype="number"/>
			<WTPARAM name="L" datatype="number"/>
			<WTPARAM name="G" datatype="number"/>
			<WTPARAM name="SC" datatype="number"/>
			<WTPARAM name="SD" datatype="date"/>
			<WTPARAM name="M" datatype="text"/>
			<WTPARAM name="E" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>LogFile "0428", Request.QueryString</WTCUSTOM>
<WTCUSTOM>
		If reqS &lt; 0 OR reqS &gt; 5 Then reqS = 1
		If reqL &lt; 0 OR reqL &gt; 3 Then reqL = 1
		If reqS = 1 OR reqS = 2 Then
			If reqL = 0 Then reqL = 1
		End If	
		If reqS = 3 Then reqL = 0 
</WTCUSTOM>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="FetchRef">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
						<WTPARAM name="Reference" direction="input" value="PARAM(R)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpMemberID)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
					response.write "0 - Member Not Found"
					response.end
</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpMentorID)" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(&quot;0&quot;)" connector="and"/>
						<WTMETHOD name="FetchRef">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
							<WTPARAM name="Reference" direction="input" value="PARAM(M)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpMentorID)" value="ATTR(MemberID)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpMentorID)" oper="equal" value="CONST(0)"/>
<WTCUSTOM>
						response.write "0 - Mentor Not Found"
						response.end
</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>
					
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpMemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Status)" value="PARAM(S)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="PARAM(L)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="SYSCON(MEMBER-STATUS-PAID)"/>
								<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-STATUS-PAID)" connector="and"/>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="SYSCON(MEMBER-STATUS-TRIAL)"/>
								<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-STATUS-TRIAL)" connector="and"/>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DateAdd(&quot;d&quot;,.TrialDays,reqSysDate))"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(G)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(E)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Email)" value="CONST(Left(reqE,80))"/>
							<WTSETATTRIBUTE name="ATTR(Email2)" value="CONST(Left(reqE,80))"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(SC)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(StatusChange)" value="PARAM(SC)"/>
							<WTSETATTRIBUTE name="ATTR(StatusDate)" value="PARAM(SD)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(MentorID)" value="CONST(tmpMentorID)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(&quot;0&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(MentorID)" value="CONST(0)"/>
						</WTCODEGROUP>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>	
<WTCUSTOM>
			response.write 1
			response.end
</WTCUSTOM>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0422u" caption="Bulk Add Members" action="false" submit="0422Upload.asp" type="multi"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0422u" language="false">
			<!--=============================================================================================-->
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			<WTPARAM name="NewMembers" datatype="number"/>
			<WTPARAM name="Company" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>DoError reqUploadError, "Bulk Add", reqUploadErrorDesc</WTCUSTOM>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(NewMembers)" oper="less" value="CONST(0)"/>
				<WTCUSTOM>DoError reqUploadError, "Bulk Add", " No Members Successfully Added!"</WTCUSTOM>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(NewMembers)" oper="greater" value="CONST(0)"/>
				<WTCUSTOM>DoError reqUploadError, "Bulk Add", reqNewMembers &amp; " Members Successfully Added!"</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETCACHE name="COMPANYID" value="PARAM(Company)"/>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Company)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" label="NoCompany" class="PageHeading" align="center" fontcolor="red"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" label="BulkAddMembers" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" label="BulkAddMembersText" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTFILE col="1" value="upload" align="center" size="40"/>
						<WTBUTTON col="1" align="center" default="true" action="1" value="CONST(Submit)"/>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0423" caption="Bulk Add Members" action="false" submit="0423Upload.asp" type="multi" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0423" language="false">
		<!--=============================================================================================-->
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			<WTPARAM name="NewMembers" datatype="number"/>
			<WTPARAM name="Company" datatype="number"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
<WTCUSTOM>DoError reqUploadError, "Bulk Add", reqUploadErrorDesc</WTCUSTOM>
			</WTCODEGROUP>
	
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(NewMembers)" oper="less" value="CONST(0)"/>
<WTCUSTOM>DoError reqUploadError, "Bulk Add", " No Members Successfully Added!"</WTCUSTOM>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(NewMembers)" oper="greater" value="CONST(0)"/>
<WTCUSTOM>DoError reqUploadError, "Bulk Add", reqNewMembers &amp; " Members Successfully Added!"</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETCACHE name="COMPANYID" value="PARAM(Company)"/>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>
				
				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Company)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" label="NoCompany" class="PageHeading" align="center" fontcolor="red"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTSTATIC col="1" label="BulkAddMembers" class="PageHeading"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" label="BulkAddMembersText" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTFILE col="1" value="upload" align="center" size="40"/>
						<WTBUTTON col="1" align="center" default="true" action="1" value="CONST(Submit)"/>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--==================================================================-->
		<WTWEBPAGE name="0424" caption="My Mentor" header="false" footer="false" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MentorID" datatype="number"/>
			<WTPARAM name="Updated" datatype="number"/>
			<WTPARAM name="NewMentor" datatype="text"/>

			<WTINCLUDE name="Label.asp"/>
			<WTINCLUDE name="Comm.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadMentor">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MentorID)" value="ATTR(MentorID)"/>
					<WTCALLSUB name="LoadNewMentor">
						<WTCONDITION expr="PARAM(MentorID)" oper="not-equal" value="CONST(0)"/>
					</WTCALLSUB>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;mentor.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; &amp; reqSysCompanyID )"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadNewMentor">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MentorID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(NewMentor)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="New">
				<WTSETATTRIBUTE name="CONST(tmpMentorID)" value="FORM(MentorID)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpMentorID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(NameFirst)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10113" message="Oops, The selected Mentor # does not exist."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Member.Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompany)" value="ATTR(Member.CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Member.Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Member.Level)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email2)"/>
					<WTSETATTRIBUTE name="CONST(tmpMsgTo)" value="ATTR(MemberID)">
						<WTCONDITION expr="ATTR(IsMsg)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(NewMentor)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompany)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(FreeOptions)">
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options)">
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options2)">
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(CompanyOptions)" value="ATTR(Options3)">
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpMentorID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="CONST(CompanyOptions + MemberOptions)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;g&quot;))" oper="equal" value="CONST(0)"/>
						<WTERROR number="10114" message="Oops, The selected Mentor is not able to be a Mentor with their current membership."/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompany)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Updated)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(MentorID)" value="CONST(tmpMentorID)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Member.Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
<!--					<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Phone1 + &quot; &quot; + .Phone2 + &quot;&lt;BR&gt;&quot; + .Street + &quot; &quot; + .Unit + &quot;&lt;BR&gt;&quot; + .City + &quot;, &quot; + .State + &quot; &quot; + .Zip + &quot; &quot; + .Country)"/>-->
					<WTSETATTRIBUTE name="CONST(tmpBody)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
				If tmpMentorID &lt;&gt; 0 Then
					filename = "Language\Member[" + reqSysLanguage + "].xml"
					tmpSubject = GetLabel( filename, "NewMentoree") + ": " + tmpSubject

					If InStr(tmpTo, "@") &gt; 0 Then
						If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
						SendEmail reqSysCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
					End If	
					If tmpMsgTo &lt;&gt; "" Then
						SendMsg 1, tmpMsgTo, tmpSubject, tmpBody 
					End If
				End If	
</WTCUSTOM>
				</WTOBJECT>
				<WTCALLSUB name="LoadMentor"/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>

				<WTSTATIC label="NewMentoree"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Updated)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTTABLE col="1">
							<WTCOLUMN width="100" align="center"/>
							<WTCOLUMN width="500" align="left"/>
							<WTROW>
								<WTIMAGE col="1" value="CONST(mentorlg.gif)" align="center"/>
								<WTSTATIC col="2" label="SelectMentor" class="Prompt"/>
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(NewMentor)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" align="center" class="PageHeading">
							<WTSTATIC tag="YourMentor"/>
							<WTSTATIC value="PARAM(NewMentor)"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTTEXT  col="1" value="ATTR(Member.MentorID)" size="3" prespace="false"/>
						<WTBUTTON col="1" action="1" value="CONST(Update)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Updated)" oper="equal" value="CONST(1)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTTABLE col="1">
							<WTCOLUMN width="100" align="center"/>
							<WTCOLUMN width="500" align="left"/>
							<WTROW>
								<WTIMAGE col="1" value="CONST(mentorlg.gif)" align="center"/>
								<WTSTATIC col="2" class="PageHeading">
									<WTSTATIC tag="NewMentor" space="1"/>
									<WTSTATIC value="PARAM(NewMentor)"/>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="6" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--**************************************Image Upload Page**************************************-->
		<!--=============================================================================================-->
		<WTWEBPAGE name="0425" contentpage="true" caption="Upload File" action="false" submit="0425Upload.asp" type="multi" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--=============================================================================================-->
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
<WTCUSTOM>
					DoError reqUploadError, "Upload", reqUploadErrorDesc
</WTCUSTOM>
			</WTCODEGROUP>
	
	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="300" align="left"/>
				<WTCOLUMN width="150" align="left"/>

				<WTROW margin-top="19">
					<WTSTATIC col="1" merge="3" label="UploadImageHeader" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="19">
					<WTSTATIC col="1" merge="3" label="UploadImageText" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="19">
					<WTSTATIC col="1"/>
					<WTFILE col="2"  align="center" value="upload" accept="*.jpg, *.gif"/>
					<WTBUTTON col="2" align="center" default="true" action="1" value="CONST(Submit)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0426" caption="Identification" navbar="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="Total" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTDATATXN name="Question"/>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpAnswers)" value="ATTR(Identification)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpQuestions)" value="ATTR(Identification)"/>
				</WTOBJECT>
<WTCUSTOM>
	aQuestions = split(tmpQuestions, VBCrLf)
	aAnswers = split(tmpAnswers, ",")
	reqTotal = UBOUND(aQuestions)
	xmlQuestion = "&lt;PTSQUESTIONS&gt;"
	For x = 0 to reqTotal
		question = aQuestions(x)
		If question &lt;&gt; "" Then
			If UBOUND(aAnswers) &gt;= x Then answer = aAnswers(x) Else answer = ""
			xmlQuestion = xmlQuestion + "&lt;PTSQUESTION " + "id=" + chr(34) &amp; x+1 &amp; chr(34) + " question=" + chr(34) &amp; question &amp; chr(34) + " answer=" + chr(34) &amp; answer &amp; chr(34) + "/&gt;"
		End If
    Next
	xmlQuestion = xmlQuestion + "&lt;/PTSQUESTIONS&gt;"
</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>
			 			
			<WTACTION id="1" name="Update" type="Update">
				<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
<WTCUSTOM>
		cnt = 0
		tmpAnswers = ""	
		For x = 1 to reqTotal + 1
		    answer = ""
			answer = Request.Form.Item(CStr(x))
			tmpAnswers = tmpAnswers + answer + ","
			If answer &lt;&gt; "" Then cnt = cnt + 1
		Next
		tmpAnswers = Left(tmpAnswers, 150)
		If cnt &lt; 5 Then DoError -2147220522, "", "Oops, Please answer 5 or more questions."
</WTCUSTOM>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Identification)" value="CONST(tmpAnswers)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="right"/>
				<WTCOLUMN width="350" align="left"/>
				
				<WTROW>
					<WTHIDDEN value="PARAM(Total)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC label="Identification"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Updated" fontcolor="red"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="IdentificationText" align="center" class="prompt"/>
				</WTROW>

				<WTREPEAT entity="Question">
					<WTROW margin-top="3">
						<WTSTATIC col="1" value="DATA(Question)" space="2"/>
						<WTTEXT col="2" name="&lt;xsl:value-of select=&quot;position()&quot;/&gt;" value="DATA(@answer)" size="15"/>
					</WTROW>
				</WTREPEAT>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_0426" caption="Member Identification" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="Total" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="m_0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTDATATXN name="Question"/>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpAnswers)" value="ATTR(Identification)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpQuestions)" value="ATTR(Identification)"/>
				</WTOBJECT>
				<WTCUSTOM>
					aQuestions = split(tmpQuestions, VBCrLf)
					aAnswers = split(tmpAnswers, ",")
					reqTotal = UBOUND(aQuestions)
					xmlQuestion = "&lt;PTSQUESTIONS&gt;"
					For x = 0 to reqTotal
					question = aQuestions(x)
					If question &lt;&gt; "" Then
					If UBOUND(aAnswers) &gt;= x Then answer = aAnswers(x) Else answer = ""
					xmlQuestion = xmlQuestion + "&lt;PTSQUESTION " + "id=" + chr(34) &amp; x+1 &amp; chr(34) + " question=" + chr(34) &amp; question &amp; chr(34) + " answer=" + chr(34) &amp; answer &amp; chr(34) + "/&gt;"
					End If
					Next
					xmlQuestion = xmlQuestion + "&lt;/PTSQUESTIONS&gt;"
				</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(1)"/>
				<WTCUSTOM>
					cnt = 0
					tmpAnswers = ""
					For x = 1 to reqTotal + 1
					answer = ""
					answer = Request.Form.Item(CStr(x))
					tmpAnswers = tmpAnswers + answer + ","
					If answer &lt;&gt; "" Then cnt = cnt + 1
					Next
					tmpAnswers = Left(tmpAnswers, 150)
					If cnt &lt; 5 Then DoError -2147220522, "", "Oops, Please answer 5 or more questions."
				</WTCUSTOM>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Identification)" value="CONST(tmpAnswers)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(Total)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTSTATIC label="Identification"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(1)"/>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Updated" fontcolor="red"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" label="IdentificationText" align="center" class="prompt"/>
				</WTROW>

				<WTREPEAT entity="Question">
					<WTROW margin-top="3">
						<WTSTATIC col="1" value="DATA(Question)" space="2"/>
					</WTROW>
					<WTROW>
						<WTTEXT col="1" name="&lt;xsl:value-of select=&quot;position()&quot;/&gt;" value="DATA(@answer)" size="15"/>
					</WTROW>
				</WTREPEAT>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0427" caption="Identification" action="1" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Question" datatype="text"/>
			<WTPARAM name="Answer" datatype="text"/>
			<WTPARAM name="Try" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpAnswers)" value="ATTR(Identification)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpQuestions)" value="ATTR(Identification)"/>
				</WTOBJECT>
<WTCUSTOM>
   'Check if we have any answers
	tmp = Replace(tmpAnswers, ",", "" )
	If tmp = "" Then 
		reqTry = -1
	Else	
		'Get all member question numbers
		aQuestions = split(tmpQuestions, VBCrLf)
		aAnswers = split(tmpAnswers, ",")
		total = UBOUND(aAnswers)
		reqAnswer = ""
		While reqAnswer = ""
			randomize
			x = Int((total * Rnd) + 1)
			reqAnswer = aAnswers(x)
		Wend
		reqQuestion = aQuestions(x)
	End If
</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Try)" value="CONST(1)"/>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>
			 			
			<WTACTION id="1" name="Update" type="Update">
<WTCUSTOM>
		answer = Request.Form.Item("A")
		If LCase(answer) = LCase(reqAnswer) Then
			reqTry = 0
		Else
			reqTry = reqTry + 1
			LoadMember()
		End If
</WTCUSTOM>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(Answer)"/>
					<WTHIDDEN value="PARAM(Try)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" label="Identification" align="center" class="PageHeading"/>
				</WTROW>

				<!-- Check if the member has entered any identification answers -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(-1)"/>
					<WTROW margin-top="12" margin-bottom="18">
						<WTSTATIC col="1" align="center" class="prompt">
							<WTSTATIC label="NoAnswers" bold="true" fontcolor="red"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" action="1" value="CONST(Continue)" align="center">
							<WTCLICK>
								var url, win
								url = "0426.asp?memberid=" + document.getElementById('MemberID').value;
								win = window.open(url);
								win.focus();
								window.close();
							</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Try)" oper="not-equal" value="CONST(-1)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Try)" oper="greater-equal" value="CONST(1)"/>
						<WTCONDITION expr="PARAM(Try)" oper="less-equal" value="CONST(3)" connector="and"/>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" label="AnswerText" align="center" class="prompt"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1" value="PARAM(Question)"/>
							<WTTEXT col="1" name="A" size="15"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Try)" oper="not-equal" value="CONST(1)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" align="center" class="prompt">
								<WTSTATIC label="IdentifySuccess" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="Try2" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Try3" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Try4" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" action="1" value="CONST(Submit)" align="center">
							<WTCONDITION expr="PARAM(Try)" oper="greater-equal" value="CONST(1)"/>
							<WTCONDITION expr="PARAM(Try)" oper="less-equal" value="CONST(3)" connector="and"/>
						</WTBUTTON>
						<WTBUTTON col="1" action="1" value="CONST(Cancel)" align="center">
							<WTCONDITION expr="PARAM(Try)" oper="greater" value="CONST(3)"/>
							<WTCLICK>
								window.opener.doSubmit(3,"");
								window.close();
							</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" action="1" value="CONST(Continue)" align="center">
							<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(0)"/>
							<WTCLICK>
								window.opener.document.getElementById('Identify').value = -1; 
								window.opener.doSubmit(0,"");
								window.close();
							</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_0427" caption="Student Identification" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Question" datatype="text"/>
			<WTPARAM name="Answer" datatype="text"/>
			<WTPARAM name="Try" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="m_0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpAnswers)" value="ATTR(Identification)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpQuestions)" value="ATTR(Identification)"/>
				</WTOBJECT>
				<WTCUSTOM>
					'Check if we have any answers
					tmp = Replace(tmpAnswers, ",", "" )
					If tmp = "" Then
					reqTry = -1
					Else
					'Get all member question numbers
					aQuestions = split(tmpQuestions, VBCrLf)
					aAnswers = split(tmpAnswers, ",")
					total = UBOUND(aAnswers)
					reqAnswer = ""
					While reqAnswer = ""
					randomize
					x = Int((total * Rnd) + 1)
					reqAnswer = aAnswers(x)
					Wend
					reqQuestion = aQuestions(x)
					End If
				</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Try)" value="CONST(1)"/>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCUSTOM>
					answer = Request.Form.Item("A")
					If LCase(answer) = LCase(reqAnswer) Then
					reqTry = 0
					Else
					reqTry = reqTry + 1
					LoadMember()
					End If
				</WTCUSTOM>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(Answer)"/>
					<WTHIDDEN value="PARAM(Try)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" label="Identification" align="center" class="PageHeading"/>
				</WTROW>

				<!-- Check if the member has entered any identification answers -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(-1)"/>
					<WTROW margin-top="12" margin-bottom="18">
						<WTSTATIC col="1" align="center" class="prompt">
							<WTSTATIC label="NoAnswers" bold="true" fontcolor="red"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" action="1" value="CONST(Continue)" align="center">
							<WTCLICK>
								var url, win
								url = "m_0426.asp?memberid=" + document.getElementById('MemberID').value;
								win = window.open(url);
								win.focus();
								window.close();
							</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Try)" oper="not-equal" value="CONST(-1)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Try)" oper="greater-equal" value="CONST(1)"/>
						<WTCONDITION expr="PARAM(Try)" oper="less-equal" value="CONST(3)" connector="and"/>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" label="AnswerText" align="center" class="prompt"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1" value="PARAM(Question)"/>
							<WTTEXT col="1" name="A" size="15"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Try)" oper="not-equal" value="CONST(1)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" align="center" class="prompt">
								<WTSTATIC label="IdentifySuccess" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="Try2" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Try3" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Try4" fontcolor="red">
									<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" action="1" value="CONST(Submit)" align="center">
							<WTCONDITION expr="PARAM(Try)" oper="greater-equal" value="CONST(1)"/>
							<WTCONDITION expr="PARAM(Try)" oper="less-equal" value="CONST(3)" connector="and"/>
						</WTBUTTON>
						<WTBUTTON col="1" action="1" value="CONST(Cancel)" align="center">
							<WTCONDITION expr="PARAM(Try)" oper="greater" value="CONST(3)"/>
							<WTCLICK>
								window.opener.doSubmit(3,"");
								window.close();
							</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" action="1" value="CONST(Continue)" align="center">
							<WTCONDITION expr="PARAM(Try)" oper="equal" value="CONST(0)"/>
							<WTCLICK>
								window.opener.document.getElementById('Identify').value = -1;
								window.opener.doSubmit(0,"");
								window.close();
							</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0429" caption="Easy Mode" navbar="false" worker="true" aspstyle="GenerateWebASP.xsl"> 
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTINCLUDE name="MemberOptions.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Member.Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Member.Level)"/>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Member.Options)"/>
					<!-- If we in Expert Mode, change to Easy Mode and get easy options -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;*&quot;))" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Member.Options)" value="CONST(&quot;*&quot; + .Options)"/>
						<WTSETCACHE name="SYS(MenuBarState)" value="CONST(&quot;01&quot;)"/>
					</WTCODEGROUP>
					<!-- If we in Easy Mode, change to Expert Mode and get normal options -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(MemberOptions,&quot;*&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Member.Options)" value="CONST(Replace(.Options, &quot;*&quot;, &quot;&quot; ))"/>
						<WTSETCACHE name="SYS(MenuBarState)" value="CONST(&quot;012&quot;)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(MemberOptions)" value="ATTR(Member.Options)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="SYS(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>

					<!-- Get the Users Options -->
					<WTCALLSUB name="reqSysUserOptions = GetUserOptions(reqSysUserOptions, MemberOptions)"/>

					<!-- If we are in Easy Mode, Get the Easy Options for this user -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="IsEasyMode"/>
						<WTSETCACHE name="SYS(MenuBarState)" value="ATTR(MenuEasy)"/>
						<WTCALLSUB name="reqSysUserOptions = GetEasyOptions(reqSysUserOptions, .EasyOptions)"/>
					</WTCODEGROUP>
-->
					<WTSETCACHE name="SYS(UserOptions)" value="SYS(UserOptions)"/>

				</WTOBJECT>

				<WTRETURN/>

			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0430" caption="Membership Confirmation" navbar="false" footer="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Enroll" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpBillingID)" value="ATTR(BillingID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Addresss" project="ptsAddressUser" class="CAddresss">
					<WTMETHOD name="ListOwnerType">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddresss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="CONST(tmpBillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(tmpBillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;XXXXXXXXXXXX&quot; &amp; Right(.CardNumber, 4))"/>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;XXX&quot;)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Continue" type="Continue">
				<WTRETURN>
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(YES)"/>
					<WTLINK name="0101" secure="false"/>
				</WTRETURN>
				<WTRETURN>
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)"/>
					<WTLINK name="0404" secure="false"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="10" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="470" align="left"/>
				<WTCOLUMN width="10"/>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(YES)"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="left" class="PageHeading">
						<WTSTATIC label="EnrollPaidText">
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
						</WTSTATIC>
						<WTSTATIC label="EnrollTrialText">
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
						</WTSTATIC>
						<WTSTATIC label="EnrollFreeText">
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-FREE)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(Enroll)" oper="equal" value="SYSCON(NO)"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" merge="2" align="left" class="PageHeading">
						<WTSTATIC label="UpgradePaidText">
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-PAID)"/>
						</WTSTATIC>
						<WTSTATIC label="UpgradeTrialText">
							<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="MemberID"/>
					<WTSTATIC col="3" value="ATTR(Member.MemberID)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="MemberName"/>
					<WTSTATIC col="3" value="ATTR(Member.MemberName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="CompanyName"/>
					<WTSTATIC col="3" value="ATTR(Member.CompanyName)"/>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Email"/>
					<WTSTATIC col="3" value="ATTR(Member.Email)"/>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="EnrollDate"/>
					<WTSTATIC col="3" value="ATTR(Member.EnrollDate)"/>
				</WTROW>

				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTREPEAT entity="Address">
					<WTROW>
						<WTSTATIC col="1">
							<WTSTATIC value="DATA(Address.Street1)" space="1"/>
							<WTSTATIC value="DATA(Address.Street2)" space="1"/>
							<WTSTATIC value="DATA(Address.City)" space="1"/>
							<WTSTATIC value="DATA(Address.State)" space="1"/>
							<WTSTATIC value="DATA(Address.Zip)" space="1"/>
							<WTSTATIC value="DATA(Address.CountryName)"/>
						</WTSTATIC>
					</WTROW>
				</WTREPEAT>
				
				<WTROW margin-top="3" margin-bottom="3">
					<WTSTATIC col="1" merge="2"/>
					<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Phone1"/>
					<WTSTATIC col="3" value="ATTR(Member.Phone1)"/>
					<WTSTATIC col="3" tag="Phone2"/>
					<WTSTATIC col="3" value="ATTR(Member.Phone2)" prespace="false"/>
					<WTSTATIC col="3" tag="Fax"/>
					<WTSTATIC col="3" value="ATTR(Member.Fax)" prespace="false"/>
				</WTROW>
				
				<WTCODEGROUP>	
					<WTCONDITION expr="ATTR(Member.BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="3" margin-bottom="3">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" tag="PayType"/>
						<WTSTATIC col="3" value="ATTR(Billing.PayType)" enum="true"/>
					</WTROW>
				
					<WTCODEGROUP>	
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
						<WTROW margin-top="3" margin-bottom="3">
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CardType"/>
							<WTSTATIC col="3" value="ATTR(Billing.CardType)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CardNumber"/>
							<WTSTATIC col="3" value="ATTR(Billing.CardNumber)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CardDate"/>
							<WTSTATIC col="3" value="ATTR(Billing.CardMo)" />
							<WTSTATIC col="3" value="ATTR(Billing.CardYr)" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CardName"/>
							<WTSTATIC col="3" value="ATTR(Billing.CardName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CardCode"/>
							<WTSTATIC col="3" value="ATTR(Billing.CardCode)"/>
						</WTROW>
					</WTCODEGROUP>	

					<WTCODEGROUP>	
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="3" margin-bottom="3">
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CheckBank"/>
							<WTSTATIC col="3" value="ATTR(Billing.CheckBank)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CheckRoute"/>
							<WTSTATIC col="3" value="ATTR(Billing.CheckRoute)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CheckAccount"/>
							<WTSTATIC col="3" value="ATTR(Billing.CheckAccount)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CheckNumber"/>
							<WTSTATIC col="3" value="ATTR(Billing.CheckNumber)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" tag="CheckName"/>
							<WTSTATIC col="3" value="ATTR(Billing.CheckName)"/>
						</WTROW>
					</WTCODEGROUP>	

					<WTROW margin-top="3" margin-bottom="3">
						<WTSTATIC col="1"/>
						<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>	

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="4" align="center" action="1" value="Continue"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0432" caption="Member Enroll" navbar="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="0432">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>  <!-- CompanyID -->
			<WTPARAM name="MemberID" datatype="number"/>   <!-- Sponsor MemberID -->
			<WTPARAM name="S" datatype="number" />         <!-- Member Status -->
			<WTPARAM name="L" datatype="number" />         <!-- Member Level -->
			<WTPARAM name="T" datatype="number" />         <!-- Member Title # -->
			<WTPARAM name="G" datatype="text" />           <!-- Member Group -->
			<WTPARAM name="A" datatype="number" />		   <!-- Auto Ship flag -->

			<WTPARAM name="SalesOrderID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text"/>
			<WTPARAM name="Total" datatype="currency"/>
			<WTPARAM name="CardZip" datatype="text"/>
			<WTPARAM name="ProcessPayment" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="Sponsor" datatype="text"/>

			<WTINCLUDE name="Billing.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(S)" oper="less" value="CONST(1)"/>
					<WTCONDITION expr="PARAM(S)" oper="greater" value="CONST(3)" connector="or"/>
					<WTSETATTRIBUTE name="PARAM(S)" value="CONST(3)"/>
					<WTSETATTRIBUTE name="PARAM(L)" value="CONST(0)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(L)" oper="less" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(L)" oper="greater" value="CONST(3)" connector="or"/>
					<WTSETATTRIBUTE name="PARAM(L)" value="CONST(0)">
						<WTCONDITION expr="PARAM(S)" oper="equal" value="CONST(3)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(L)" value="CONST(1)">
						<WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(3)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="GetUserOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(FreeOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>
			
			<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCountry">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadOrder">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
<!--					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>-->
					<WTSETATTRIBUTE name="ATTR(TaxIDType)" value="CONST(1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<!-- get sponsor name-->
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Sponsor)" value="CONST(.NameFirst +  &quot; &quot; + .NameLast)" />
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCALLSUB name="LoadCountry"/>
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTSETATTRIBUTE name="PARAM(Total)" value="ATTR(Total)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrder" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
					<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)"/>
					</WTOBJECT>
					<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
						<WTMETHOD name="FetchCompany">
							<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
						</WTMETHOD>			
						<WTMETHOD name="Load">
							<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
					</WTOBJECT>
				</WTCODEGROUP>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(PAYTYPE-VISA)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Enroll&quot; + CStr(reqS) + CStr(reqL) + &quot;.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ReloadMember">
				<WTCALLSUB name="LoadOrder"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Icons)" value="FORM(Icons)"/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(TaxIDType)" value="FORM(TaxIDType)" />
					<WTSETATTRIBUTE name="ATTR(TaxID)" value="FORM(TaxID)" />
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)" />
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="FORM(CompanyName)" />
					<WTSETATTRIBUTE name="ATTR(Phone1)" value="FORM(Phone1)" />
					<WTSETATTRIBUTE name="ATTR(Phone2)" value="FORM(Phone2)" />
					<WTSETATTRIBUTE name="ATTR(Fax)" value="FORM(Fax)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>	
				<WTCALLSUB name="LoadCountry"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)" />
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
					<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
					<WTSETATTRIBUTE name="ATTR(CheckNumber)" value="FORM(CheckNumber)" />
					<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="greater" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(3)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least three characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
		 			<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>
			
			<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidEmail">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="ExistEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTERROR number="10104" message="Oops, Email Address Already Exists." />
					</WTCODEGROUP>
				</WTOBJECT>	
			</WTSUB>
			
			<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="Join">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>

					<!-- Validate Card Number if paying by Credit Card -->
					<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

					<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
						<WTMETHOD name="ValidCheckRoute">
							<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
							<WTPARAM name="result" direction="return" datatype="number" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
							<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
						</WTCODEGROUP>
					</WTOBJECT>

					<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
						<WTMETHOD name="ValidCardNumber">
							<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
							<WTPARAM name="result" direction="return" datatype="number" />
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
							<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
							<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- card matches selected type -->
							<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
							<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
							<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
							<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Visa -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(1)" />
							<WTCONDITION expr="NotPaymentVisa" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Mastercard -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(2)" />
							<WTCONDITION expr="NotPaymentMC" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Discover -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(3)" />
							<WTCONDITION expr="NotPaymentDiscover" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- Amex -->
							<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(4)" />
							<WTCONDITION expr="NotPaymentAmex" connector="and"/>
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
						<WTCODEGROUP> <!-- All other credit cards are not allowed -->
							<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
							<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
						</WTCODEGROUP>
					</WTOBJECT>

					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors" />
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
						<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
						<WTCODEGROUP> <!-- check for current card date -->
							<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
							<WTERROR number="10013" message="Oops, Invalid Credit Card Date." />
						</WTCODEGROUP>
					</WTCODEGROUP>

					<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
						<WTCONDITION expr="NoErrors" />
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CHECK)" connector="and"/>
						<WTMETHOD name="Load">
							<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
							<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
							<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
							<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
							<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
							<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
							<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
							<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
							<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
							<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
							<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
							<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
							<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
							<WTSETATTRIBUTE name="ATTR(CheckNumber)" value="FORM(CheckNumber)" />
							<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
						</WTCODEGROUP>
						<WTMETHOD name="Validate">
							<WTPARAM name="New" direction="input" value="CONST(1)" />
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
						</WTMETHOD>
						<WTMETHOD name="Save">
		 					<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>		
						<WTMETHOD name="Add">
		 					<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTCALLSUB name="tmpDescription = BillingPayment( oBilling )"/>
					</WTOBJECT>
				</WTCODEGROUP>

				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>	

				<!-- Get all the Company default values for a new member -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTCONDITION expr="NoErrors" />
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(1)" connector="or"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price2)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail2)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="ATTR(Price3)"/>
						<WTSETATTRIBUTE name="CONST(tmpRetail)" value="ATTR(Retail3)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpInitPrice)" value="ATTR(InitPrice)"/>
					<WTSETATTRIBUTE name="CONST(tmpBilling)" value="ATTR(Billing)"/>
					<WTSETATTRIBUTE name="CONST(tmpDiscount)" value="ATTR(Discount)"/>
					<WTSETATTRIBUTE name="CONST(tmpIsDiscount)" value="ATTR(IsDiscount)"/>
					<WTSETATTRIBUTE name="CONST(tmpPromoID)" value="ATTR(PromoCode)"/>
					<WTSETATTRIBUTE name="CONST(tmpAccessLimit)" value="ATTR(AccessLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpQuizLimit)" value="ATTR(QuizLimit)"/>
					<WTSETATTRIBUTE name="CONST(tmpTrialDays)" value="ATTR(TrialDays)"/>
				</WTOBJECT>

				<!-- Set new member values, validate contact info and add the new member -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors" />
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(TaxIDType)" value="FORM(TaxIDType)" />
					<WTSETATTRIBUTE name="ATTR(TaxID)" value="FORM(TaxID)" />
					<WTSETATTRIBUTE name="ATTR(Email)" value="FORM(Email)" />
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="FORM(CompanyName)" />
<!--
					<WTSETATTRIBUTE name="ATTR(Street)" value="FORM(Street)" />
					<WTSETATTRIBUTE name="ATTR(Unit)" value="FORM(Unit)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(Country)" value="FORM(Country)" />
-->					
					<WTSETATTRIBUTE name="ATTR(Phone1)" value="FORM(Phone1)" />
					<WTSETATTRIBUTE name="ATTR(Phone2)" value="FORM(Phone2)" />
					<WTSETATTRIBUTE name="ATTR(Fax)" value="FORM(Fax)" />

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(TaxIDType)" oper="equal" value="CONST(&quot;0&quot;)"/>
						<WTCONDITION expr="ATTR(TaxID)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10011" message="Oops, Identification Number is Required."/>
					</WTCODEGROUP>
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Street)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="ATTR(City)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTCONDITION expr="ATTR(State)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTCONDITION expr="ATTR(Zip)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTCONDITION expr="ATTR(CountryID)" oper="equal" value="CONST(0)" connector="or"/>
						<WTERROR number="10005" message="Oops, Full Address is Required."/>
					</WTCODEGROUP>
-->					
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Phone1)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="ATTR(Phone2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTCONDITION expr="ATTR(Fax)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="10006" message="Oops, At Least 1 Phone Number is Required."/>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(MemberID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(MemberID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(MemberID)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="PARAM(S)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="PARAM(L)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="PARAM(T)"/>
						<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(G)"/>
						<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(FormatDateTime(.EnrollDate,2))"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
						<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpInitPrice)"/>
						<WTSETATTRIBUTE name="ATTR(Retail)" value="CONST(tmpRetail)"/>
						<WTSETATTRIBUTE name="ATTR(Discount)" value="CONST(tmpDiscount)"/>
						<WTSETATTRIBUTE name="ATTR(IsDiscount)" value="CONST(tmpIsDiscount)"/>
						<WTSETATTRIBUTE name="ATTR(PromoID)" value="CONST(tmpPromoID)"/>
						<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(tmpAccessLimit)"/>
						<WTSETATTRIBUTE name="ATTR(QuizLimit)" value="CONST(tmpQuizLimit)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(tmpBilling)">
							<WTCONDITION expr="PARAM(S)" oper="not-equal" value="SYSCON(MEMBER-FREE)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(0)">
							<WTCONDITION expr="PARAM(S)" oper="equal" value="SYSCON(MEMBER-FREE)"/>
						</WTSETATTRIBUTE>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(S)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
							<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(tmpTrialDays)"/>
							<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;d&quot;, tmpTrialDays, reqSysDate))"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
						<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>

						<WTSETATTRIBUTE name="ATTR(IsCompany)" value="CONST(&quot;1&quot;)">
							<WTCONDITION expr="ATTR(CompanyName)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
							<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
						<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFG&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Timezone)" value="CONST(-6)"/>
<!--
						<WTSETATTRIBUTE name="ATTR(Options)" value="CONST(&quot;*&quot;)">
							<WTCONDITION expr="IsEasy"/>
						</WTSETATTRIBUTE>
-->						
						<WTMETHOD name="Add">
							<WTPARAM name="tmpMemberID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>

						<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
							<WTCONDITION expr="NoErrors"/>
							<WTMETHOD name="Load">
								<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
							<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(tmpMemberID)"/>
							<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
							<WTSETATTRIBUTES/>
							<WTMETHOD name="Add">
								<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTOBJECT>	
						
						<WTCODEGROUP>
	 						<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="ATTR(Member.Title)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
								<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="CONST(tmpMemberID)"/>
								<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
								<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(oMember.Title)"/>
								<WTMETHOD name="Add">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>

					</WTCODEGROUP>
				</WTOBJECT>

				<!-- Get the purchased product name for the payment information -->
				<WTOBJECT name="SalesItems" project="ptsSalesItemUser" class="CSalesItems">
					<WTMETHOD name="ListSalesOrder">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
					</WTMETHOD>
<WTCUSTOM>
				tmpPurpose = oSalesItems.Item(1).ProductName
</WTCUSTOM>
				</WTOBJECT>

				<!-- Add the payment record -->
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerType)" value="ENTITY(SalesOrder)"/>
					<WTSETATTRIBUTE name="ATTR(Payment.OwnerID)" value="PARAM(SalesOrderID)"/>
					<WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(tmpPayType)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(PAYSTATUS-SUBMITTED)"/>
					<WTSETATTRIBUTE name="ATTR(Amount)" value="PARAM(Total)"/>
					<WTSETATTRIBUTE name="ATTR(Total)" value="PARAM(Total)"/>
					<WTSETATTRIBUTE name="ATTR(Description)" value="CONST(tmpDescription)"/>
					<WTSETATTRIBUTE name="ATTR(Purpose)" value="CONST(tmpPurpose)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="PaymentID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- Update the SalesOrder MemberID and recurring salesitems -->
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="CONST(tmpMemberID)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Update Recurring SalesItems for payment -->
					<WTMETHOD name="UpdateRecurring">
						<WTPARAM name="OrderDate" direction="input" value="CONST(Date())"/>
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(SalesOrderID)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- Update the new member genealogy if enabled -->
				<WTOBJECT name="Downline" project="ptsDownlineUser" class="CDownline">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="IsGenealogy" connector="and"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(tmpMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Build">
						<WTPARAM name="Line" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ParentID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ChildID" direction="input" value="CONST(tmpMemberID)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCALLSUB name="ReloadMember">
					<WTCONDITION expr="IsErrors" />
				</WTCALLSUB>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
<WTCUSTOM>
				If Request.Form.Item("ProcessPayment") = 1 Then
					tmpReturnURL = "5254.asp?SalesOrderID=" &amp; reqSalesOrderID &amp; "%26autoship=" + CStr(reqA)
					Response.Redirect "1004.asp?PaymentID=" &amp; PaymentID &amp; "&amp;Acct=" &amp; tmpAcct &amp; "&amp;TxnReturnURL=" &amp; tmpReturnURL
				Else
					Response.Redirect "5254.asp?SalesOrderID=" &amp; reqSalesOrderID &amp; "&amp;txn=1&amp;member=1&amp;autoship=" + CStr(reqA)
				End If
</WTCUSTOM>
				</WTCODEGROUP>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
<!--				<WTSETATTRIBUTE name="PARAM(ProcessPayment)" value="CONST(1)"/>-->
				<WTGETCACHE name="PARAM(SalesOrderID)" value="CONST(SHOPPINGCART)" datatype="number"/>
				<WTCALLSUB name="LoadOrder"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
					<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
				</WTCODEGROUP>
				<WTCALLSUB name="GetUserOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidEmail">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="NotDuplicateEmail" connector="and"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="Join">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ReLoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="right" />
				<WTCOLUMN width="550" align="left" />

				<WTSTATIC label="TaxIDType1"/>
				<WTSTATIC label="TaxIDType2"/>
				<WTSTATIC label="TaxIDType3"/>
				<WTSTATIC label="TaxIDType4"/>

				<WTROW>
					<WTHIDDEN value="PARAM(SalesOrderID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(PaymentOptions)"/>
					<WTHIDDEN value="PARAM(Total)"/>
					<WTHIDDEN value="PARAM(ProcessPayment)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var countryid = document.getElementById('CountryID').value;
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype; 
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].checked) {
								paytype = payobj[i].value;
								i = l;
							}
						}
						if (paytype == 5) {
							if ( countryid != 224 ) {
								paytype = 1;
								document.getElementById('PayType').value = paytype;
								alert("Electronic Checks not available outside the United States");
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">	
					var payobj = Member.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>

				<WTLOAD>ToggleType();</WTLOAD>

				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
				<WTROW>
					<WTCHECK col="1" merge="2" value="PARAM(IsAgree)" label="IsAgree" align="center"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Sponsor" align="center" fontsize="4"/>
					<WTSTATIC col="1" merge="2" value="PARAM(Sponsor)" fontsize="4"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Name" />
					<WTTEXT col="2" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" required="true" />
					<WTTEXT col="2" value="ATTR(Member.NameLast)" width="350" label="NameLast" size="25" required="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="TaxID"/>
					<WTCOMBO col="2" value="ATTR(Member.TaxIDType)"/>
					<WTTEXT col="2" value="ATTR(Member.TaxID)" required="true">
						<WTEXIT>if(this.value==''){alert('Identification Required!');}</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Email" />
					<WTTEXT col="2" value="ATTR(Member.Email)" size="58" required="true" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CompanyName"/>
					<WTTEXT col="2" value="ATTR(Member.CompanyName)" size="58"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address" />
					<WTTEXT col="2" value="ATTR(Address.Street1)" size="60" required="true">
						<WTEXIT>if(this.value==''){alert('Street Required!');}</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Address.Street2)" size="60" required="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CityState"/>
					<WTTEXT col="2" value="ATTR(Address.City)" size="25" required="true">
						<WTEXIT>if(this.value==''){alert('City Required!');}</WTEXIT>
					</WTTEXT>
					<WTTEXT col="2" value="ATTR(Address.State)" size="25" required="true">
						<WTEXIT>if(this.value==''){alert('State Required!');}</WTEXIT>
					</WTTEXT>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="ZipCountry" />
					<WTTEXT col="2" value="ATTR(Address.Zip)" size="10" required="true">
						<WTEXIT>if(this.value==''){alert('Zip Code Required!');}</WTEXIT>
					</WTTEXT>
					<WTCOMBO col="2" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" required="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone1" />
					<WTTEXT col="2" value="ATTR(Member.Phone1)" size="15" required="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone2" />
					<WTTEXT col="2" value="ATTR(Member.Phone2)" size="15" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Fax"/>
					<WTTEXT col="2" value="ATTR(Member.Fax)" size="15"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="LogonText" class="prompt"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="NewLogon"/>
					<WTTEXT col="2" value="ATTR(Member.NewLogon)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="NewPassword"/>
					<WTTEXT col="2" value="ATTR(Member.NewPassword)" size="20"/>
				</WTROW>
				
				<!--*************************************************************************************-->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" label="PaymentInfo" class="PageHeading" align="center" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Amount" height="18" />
						<WTSTATIC col="2" value="ATTR(SalesOrder.Amount)" bold="true" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(SalesOrder.Discount)" oper="not-equal" value="CONST('$0.00')" />
						<WTSTATIC col="1" tag="Discount" height="18" />
						<WTSTATIC col="2" value="ATTR(SalesOrder.Discount)" bold="true" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Tax" height="18" />
						<WTSTATIC col="2" value="ATTR(SalesOrder.Tax)" bold="true" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(SalesOrder.Shipping)" oper="not-equal" value="CONST('$0.00')" />
						<WTSTATIC col="1" tag="Shipping" height="18" />
						<WTSTATIC col="2" value="ATTR(SalesOrder.Shipping)" bold="true" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Total" height="24" />
						<WTSTATIC col="2" value="ATTR(SalesOrder.Total)" bold="true" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>

					<WTROW>
				 		<WTSTATIC col="1" merge="2" align="center">
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentVisa"/>
				 				<WTRADIO group="PayType" name="1" check="/DATA/TXN/PTSBILLING/@paytype=1">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(1);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentMC"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="2" check="/DATA/TXN/PTSBILLING/@paytype=2">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(2);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentDiscover"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="3" check="/DATA/TXN/PTSBILLING/@paytype=3">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(3);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentAmex"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="4" check="/DATA/TXN/PTSBILLING/@paytype=4">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(4);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="_IsPaymentCheck"/>
								<WTSTATIC space="3"/>
				 				<WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
									<WTCLICK>ToggleType();</WTCLICK>
				 				</WTRADIO>
								<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
									<WTCLICK>CheckType(5);</WTCLICK>
								</WTIMAGE>
				 			</WTCODEGROUP>
				 			<WTCODEGROUP>
								<WTCONDITION expr="IsEmployee"/>
				 				<WTCODEGROUP>
									<WTCONDITION expr="_IsPaymentCash"/>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="7" check="/DATA/TXN/PTSBILLING/@paytype=7">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType7.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(7);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 				<WTCODEGROUP>
									<WTCONDITION expr="_IsPaymentPO"/>
									<WTSTATIC space="3"/>
				 					<WTRADIO group="PayType" name="8" check="/DATA/TXN/PTSBILLING/@paytype=8">
										<WTCLICK>ToggleType();</WTCLICK>
				 					</WTRADIO>
									<WTIMAGE value="CONST(PayType8.gif)" imgalign="absmiddle">
										<WTCLICK>CheckType(8);</WTCLICK>
									</WTIMAGE>
				 				</WTCODEGROUP>
				 			</WTCODEGROUP>
				 		</WTSTATIC>
					</WTROW>

					<WTROW id="CardRows">
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="200" align="right"/>
							<WTCOLUMN width="550" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
									<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
								</WTTEXT>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardDate"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
								<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardName"/>
								<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardCode"/>
								<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CardZip"/>
								<WTTEXT col="2" value="PARAM(CardZip)" required="true"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW id="CheckRows">
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="200" align="right"/>
							<WTCOLUMN width="550" align="left"/>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckBank"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckRoute"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckAccount"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckNumber"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="CheckName"/>
								<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
							</WTROW>
							<WTROW>
								<WTIMAGE col="1" merge="2" align="center" value="CONST(checkref.gif)"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12">
						<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
					</WTROW>

				</WTCODEGROUP>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="3" value="CONST(Join)" align="center">
						<WTCLICK>doSubmit(2,&quot;&quot;); this.disabled = true</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="0433" caption="Auto Ship" footer="false" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0433">
			<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="ActiveID" datatype="number" />
			<WTPARAM name="DeleteID" datatype="number" />
			<WTPARAM name="BillingID" datatype="number" />
			<WTPARAM name="BillTo" datatype="text" />

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(ActiveID)" oper="not-equal" value="CONST(0)"/>
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="SetAutoShip">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(ActiveID)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="0433" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(DeleteID)" oper="not-equal" value="CONST(0)"/>
				<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
					<WTMETHOD name="Delete">
						<WTPARAM name="SalesOrderID" direction="input" value="PARAM(DeleteID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="0433" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
					With oBilling
						Select Case .PayType
						Case "1"   'Credit Card
							Select Case .CardType
							Case 1
								tmpCardType = "Visa"
							Case 2
								tmpCardType = "MasterCard"
							Case 3
								tmpCardType = "Discover"
							Case 4
								tmpCardType = "Amex"
							End Select
							reqBillTo = tmpCardType + ", ************" + Right(.CardNumber,4) + ", " + .CardMo + "/" + .CardYr + ", " + .CardName
						Case "2"  'Check
							reqBillTo = .CheckBank + ", ************" + Right(.CheckAccount,4)+ ", " + .CheckName
						Case "3"  'Cash
							reqBillTo = "Cash"
						Case "4"  'No Payment
							reqBillTo = "None"
						End Select
					End With
</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
					<WTMETHOD name="ListAutoShip">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSalesOrders" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(AutoShipDate)" value="FORM(AutoShipDate)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember" />
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateMember"/>
				<WTCALLSUB name="LoadMember"/>
			</WTACTION>

			<WTACTION id="3" name="Billing" type="Update">
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="ContentPage" value="CONST(3)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="2" name="AddBilling" type="Update">
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="AutoShip" value="CONST(1)"/>
						<WTPARAM name="ContentPage" value="CONST(3)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="375" align="left" />
				<WTCOLUMN width="375" align="right" />
				
				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="left">
						<WTSTATIC tag="AutoShips"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="AutoShipText" align="left" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" merge="2" value="CONST(arrowright.gif)" align="center" valign="top" imgalign="absmiddle"/>
					<WTSTATIC col="1" merge="2" label="AutoTextDate"/>
					<WTTEXT col="1" merge="2" value="ATTR(Member.AutoShipDate)"/>
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" btnclass="smbutton"/>
					<WTBUTTON col="1" merge="2" action="0" value="CONST(Refresh)" btnclass="smbutton"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(BillTo)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" merge="2" label="BillingText" align="center"/>
					<WTSTATIC col="1" merge="2" value="PARAM(BillTo)" bold="true"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Edit)" btnclass="smbutton"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(BillTo)" oper="equal" value="CONST('')"/>
					<WTSTATIC col="1" merge="2" label="AddBillingText" align="center"/>
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" btnclass="smbutton"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="right">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle">
								<WTLINK name="5250" target="NewAutoShip">
									<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)" />
									<WTPARAM name="MemberID" value="PARAM(MemberID)" />
									<WTPARAM name="N" value="CONST(1)" />
									<WTPARAM name="A" value="CONST(1)" />
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NewAutoShip">
							<WTLINK name="5250" target="NewAutoShip">
								<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)" />
								<WTPARAM name="MemberID" value="PARAM(MemberID)" />
								<WTPARAM name="N" value="CONST(1)" />
								<WTPARAM name="A" value="CONST(1)" />
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTSTATIC label="DeactivateAutoShip"/>
				<WTSTATIC label="ActivateAutoShip"/>
				<WTSTATIC label="EditAutoShip"/>
				<WTSTATIC label="DeleteAutoShip"/>

				<WTROW margin-bottom="6">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="SalesOrder">
						<WTCOLUMN width="3" align="left" valign="top"/>
						<WTCOLUMN width="12" align="left" valign="top" label="OrderDate" />
						<WTCOLUMN width="10" align="left" valign="top" label="Amount" />
						<WTCOLUMN width="72" align="left" valign="top" label="Notes" />
						<WTCOLUMN width="3" align="left" valign="top" />
						<WTROW>
							<WTSTATIC col="1" valign="top" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsActive)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(arrowright.gif)" alt="DeactivateAutoShip" valign="top" imgalign="absmiddle">
										<WTLINK name="0433" return="false">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ActiveID" value="CONST(-1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(IsActive)" oper="equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(arrowrightgray.gif)" alt="ActivateAutoShip" valign="top" imgalign="absmiddle">
										<WTLINK name="0433" return="false">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ActiveID" value="DATA(SalesOrderID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" valign="top">
								<WTSTATIC value="DATA(SalesOrder.OrderDate)">
									<WTCONDITION expr="IsEmployee"/>
									<WTLINK name="5203"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="DATA(SalesOrder.OrderDate)">
									<WTCONDITION expr="NotEmployee"/>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(edit.gif)" alt="EditAutoShip" valign="top" imgalign="absmiddle">
										<WTLINK name="5251" target="ShoppingCart" return="false">
											<WTPARAM name="ShoppingCartID" value="DATA(SalesOrderID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" valign="top">
								<WTSTATIC value="DATA(SalesOrder.Total)">
									<WTCONDITION expr="IsEmployee"/>
									<WTLINK name="5203"><WTPARAM name="SalesOrderID" value="DATA(SalesOrder.SalesOrderID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="DATA(SalesOrder.Total)">
									<WTCONDITION expr="NotEmployee"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(SalesOrder.Notes)" valign="top"/>
							<WTSTATIC col="5" valign="top">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(trash.gif)" alt="DeleteAutoShip" valign="top" imgalign="absmiddle">
										<WTLINK name="0433" return="false">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="DeleteID" value="DATA(SalesOrderID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW>
							<WTCONDITION expr="DATA(Valid)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="4" fontcolor="red">
								<WTSTATIC label="SalesOrderValid1">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesOrderValid2">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesOrderValid3">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesOrderValid4">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesOrderValid12">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(12)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesOrderValid13">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(13)"/>
								</WTSTATIC>
								<WTSTATIC label="SalesOrderValid14">
									<WTCONDITION expr="DATA(Valid)" oper="equal" value="CONST(14)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0434" caption="Find Email" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0434">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="text"/>
			<WTPARAM name="Email" datatype="text"/>
		   
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ListEmail">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Email" direction="input" value="PARAM(Email)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left"/>
				
				<WTFUNCTION name="SelectEmail(id)">
					window.opener.document.getElementById('MemberID').value = id; 
					window.opener.doSubmit(0,"");
					window.close();
				</WTFUNCTION>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSMEMBERS/PTSMEMBER))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoMember" class="prompt" align="left"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSMEMBERS/PTSMEMBER))" oper="greater" value="CONST(0)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="SelectEmailMember" class="prompt" align="left"/>
					</WTROW>
					
					<WTROW>
						<WTRECORDSET col="1" merge="2" entity="Member">
							<WTCOLUMN width="30" align="center"/>
							<WTCOLUMN width="70" align="left"/>
							<WTROW margin-top="3" margin-bottom="3">
								<WTBUTTON col="1" value="CONST(SelectMe)" align="center" btnclass="smbutton">
									<WTCLICK escape="false">SelectEmail(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;);</WTCLICK>
								</WTBUTTON>
								<WTSTATIC col="2">
									<WTSTATIC value="DATA(Member.NameFirst)" space="1"/>
									<WTSTATIC value="DATA(Member.NameLast)"/>
					 			</WTSTATIC>
							</WTROW>						
						</WTRECORDSET>
					</WTROW>
				</WTCODEGROUP>				

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0435" caption="Check Member" navbar="false" worker="true" aspstyle="GenerateWebASP.xsl"> 
		<!--============================================================================================-->
			<WTPARAM name="C" datatype="number"/>  <!-- CompanyID -->
			<WTPARAM name="R" datatype="text"/>    <!-- Member Reference # -->
			<WTPARAM name="X" datatype="number"/>  <!-- Return XML Data flag --> 

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
		If reqC = 0 Then
			response.write "0 - Missing Company"
			response.end
		End If
		If Len(reqR) = "" Then
			response.write "0 - Missing Reference"
			response.end
		End If
</WTCUSTOM>					
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="FetchRef">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(C)"/>
						<WTPARAM name="Reference" direction="input" value="PARAM(R)"/>
					</WTMETHOD>
<WTCUSTOM>
			If .MemberID = "" Then
				response.write "0"
				response.end
			End If
</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(X)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="ATTR(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>

<WTCUSTOM>
					s = "&lt;MEMBER"
					s = s + " memberid=" + Chr(34) + .memberid + Chr(34)
					s = s + " status=" + Chr(34) + .status + Chr(34)
					s = s + " level=" + Chr(34) + .level + Chr(34)
					s = s + " reference=" + Chr(34) + CleanXML(.reference) + Chr(34)
					s = s + " namefirst=" + Chr(34) + CleanXML(.namefirst) + Chr(34)
					s = s + " namelast=" + Chr(34) + CleanXML(.namelast) + Chr(34)
					If .IsCompany = "1" Then s = s + " companyname=" + Chr(34) + CleanXML(.companyname) + Chr(34)
					If Len(.Email) &gt; 0 Then s = s + " email=" + Chr(34) + CleanXML(.email) + Chr(34)
					If Len(.Email2) &gt; 0 Then s = s + " email2=" + Chr(34) + CleanXML(.email2) + Chr(34)
					If Len(.Phone1) &gt; 0 Then s = s + " phone1=" + Chr(34) + CleanXML(.phone1) + Chr(34)
					If Len(.Phone2) &gt; 0 Then s = s + " phone2=" + Chr(34) + CleanXML(.phone2) + Chr(34)
					If Len(.Fax) &gt; 0 Then s = s + " fax=" + Chr(34) + CleanXML(.fax) + Chr(34)
					s = s + " enrolldate=" + Chr(34) + .enrolldate + Chr(34)
					s = s + " trialdays=" + Chr(34) + .trialdays + Chr(34)
					s = s + " visitdate=" + Chr(34) + .visitdate + Chr(34)
					s = s + " secure=" + Chr(34) + .secure + Chr(34)
</WTCUSTOM>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(MentorID)" oper="not-equal" value="CONST(0)"/>
							<WTMETHOD name="Load">
								<WTPARAM name="MemberID" direction="input" value="ATTR(MentorID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
<WTCUSTOM>
						s = s + " mentor-reference=" + Chr(34) + .reference + Chr(34)
						s = s + " mentor-namefirst=" + Chr(34) + CleanXML(.namefirst) + Chr(34)
						s = s + " mentor-namelast=" + Chr(34) + CleanXML(.namelast) + Chr(34)
</WTCUSTOM>
						</WTCODEGROUP>
<WTCUSTOM>
					s = s + " /&gt;"
</WTCUSTOM>

					</WTCODEGROUP>
<WTCUSTOM>
			If reqX = 0 Then
				response.write .MemberID
			Else
				response.ContentType = "text/xml"
				response.write s
			End If	
			response.end
</WTCUSTOM>
				</WTOBJECT>	
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0436" caption="Billing Method" navbar="false" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0436" secured="52" track="0">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="NoClose" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
		   
			<WTSUB name="LoadBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
			</WTACTION>

			<WTACTION id="4" name="RemoveBilling" type="Update">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpBillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="CONST(0)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Delete">
						<WTPARAM name="BillingID" direction="input" value="CONST(tmpBillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadBilling"/>
			</WTACTION>
			
			<WTACTION id="5" name="Billing" type="Update">
				<WTRETURN>
					<WTLINK name="2903" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
<!-- FIX SSL					
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->					
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="7" name="AddBilling" type="Update">
				<WTRETURN>
					<WTLINK name="2902" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
<!-- FIX SSL					
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
				</WTROW>

				<WTSTATIC label="CreditCard"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Cash"/>
				<WTSTATIC label="NoPay"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Check"/>
				<WTSTATIC label="NoComm"/>
				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>

				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" newline="1"/>
						<WTSTATIC label="BillingInfo"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTBUTTON col="1" merge="2" action="7" value="CONST(AddBilling)" align="center"/>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center" btnclass="smbutton">
							<WTCONDITION expr="PARAM(NoClose)" oper="equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTBUTTON col="1" merge="2" action="5" value="CONST(EditBilling)" align="center"/>
						<WTBUTTON col="1" merge="2" action="4" value="CONST(RemoveBilling)" align="center" btnclass="smbutton">
							<WTCONDITION expr="IsManager"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center" btnclass="smbutton">
							<WTCONDITION expr="PARAM(NoClose)" oper="equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="PayType"/>
						<WTSTATIC col="2" value="ATTR(Billing.PayType)" enum="true"/>
						<WTSTATIC col="2">
							<WTSTATIC label="VerifiedNo" fontcolor="red" fontsize="3">
								<WTCONDITION expr="ATTR(Billing.Verified)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="VerifiedYes" fontcolor="green" fontsize="3">
								<WTCONDITION expr="ATTR(Billing.Verified)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
						</WTSTATIC>
						<WTSTATIC col="2" tag="UpdatedDate" value="ATTR(Billing.UpdatedDate)" fontcolor="purple"/>
					</WTROW>
				
					<WTCODEGROUP>	
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTSTATIC col="2">
								<WTSTATIC label="Visa">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="MasterCard">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Discover">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Amex">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
							<WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
						</WTROW>
						<WTROW>
  						<WTCONDITION expr="ATTR(Billing.Token)" oper="greater" value="CONST(0)"/>
							<WTSTATIC col="1" tag="Token"/>
							<WTSTATIC col="2" value="ATTR(Billing.Token)"/>
						</WTROW>
					</WTCODEGROUP>	

					<WTCODEGROUP>	
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckBank)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckRoute)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckAccount)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckNumber)"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletType"/>
							<WTSTATIC col="2">
                <WTSTATIC label="Wallet">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(10)"/>
                </WTSTATIC>
                <WTSTATIC label="iPayout">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(11)"/>
                </WTSTATIC>
                <WTSTATIC label="PayQuicker">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(12)"/>
								</WTSTATIC>
								<WTSTATIC label="SolidTrust">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(13)"/>
								</WTSTATIC>
                <WTSTATIC label="BitCoin">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(14)"/>
                </WTSTATIC>
                <WTSTATIC label="Neteller">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(15)"/>
                </WTSTATIC>
                <WTSTATIC label="Nexxus">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(16)"/>
                </WTSTATIC>
              </WTSTATIC>
						</WTROW>
						<WTROW>
              <WTCONDITION expr="ATTR(Billing.CardType)" oper="not-equal" value="CONST(10)"/>
              <WTSTATIC col="1" tag="WalletName"/>
              <WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
            </WTROW>
					</WTCODEGROUP>

				</WTCODEGROUP>	
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0436d" caption="Declined Payments" navbar="false" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0436d" track="0">
			<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PaymentID" datatype="number"/>
			<WTPARAM name="Declines" datatype="number"/>
			<WTPARAM name="Cash" datatype="number"/>
			<WTPARAM name="ProcessStatus" datatype="number"/>

			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="PayAmount" datatype="currency"/>
      <WTPARAM name="Wallet" datatype="currency"/>
      <WTPARAM name="WalletNumber" datatype="currency"/>

      <WTDATATXN name="Payment2"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
      <WTINCLUDE name="IP.asp"/>

      <WTSUB name="GetWallet">
        <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
          <WTMETHOD name="WalletTotal">
            <WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
            <WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Result" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            a = Split(Result, ";")
            reqWalletNumber = a(0)
            reqWallet = FormatCurrency(a(0),2)
          </WTCUSTOM>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="ActivateMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ProcessStatus)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Declines)" oper="equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(MEMBER-SUSPENDED)"/>
						<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(MEMBER-PAID)"/>
						<WTSETATTRIBUTE name="PARAM(ProcessStatus)" value="CONST(2)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
        <!-- check this member's bonus and payout qualify status -->
        <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
          <WTMETHOD name="Custom">
            <WTPARAM name="Status" direction="input" value="CONST(503)"/>
            <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
            <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
            <WTPARAM name="Count" direction="return" datatype="number"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

			<WTSUB name="LoadBilling">
        <WTCALLSUB name="GetWallet"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadLists">
				<!-- Order Payments -->
				<WTOBJECT name="Payments" project="ptsPaymentUser" class="CPayments">
					<WTSETATTRIBUTE name="CONST(tmpFromDate)" value="CONST(DateAdd(&quot;yyyy&quot;, -1, reqSysDate))"/>
					<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DateAdd(&quot;d&quot;, 1, reqSysDate))"/>
					<WTMETHOD name="FindMember">
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="CONST(1008)"/>
						<WTPARAM name="Bookmark" direction="input" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="SearchText" direction="input" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="Direction" direction="input" value="CONST(1)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="CONST(tmpFromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="CONST(tmpToDate)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						Set oBilling = server.CreateObject("ptsBillingUser.CBilling")
						For Each oPayment In oPayments
							If oPayment.Status = 4 Then reqDeclines = reqDeclines + 1
							If oPayment.Status &lt; 3 And oPayment.PayType = 7 Then reqCash = reqCash + 1
							If oPayment.PayType &lt;= 5 Then
								PaymentBilling oPayment.Description, oBilling
								With oBilling
									If .PayType = "1" Then   'Credit Card
									Select Case .CardType
									Case 1
									tmpCardType = "Visa"
									Case 2
									tmpCardType = "MasterCard"
									Case 3
									tmpCardType = "Discover"
									Case 4
									tmpCardType = "Amex"
									End Select
									oPayment.Description = tmpCardType + ", ************" + Right(.CardNumber,4) + ", " + .CardMo + "/" + .CardYr + ", " + .CardName
									End If
									If .PayType = "2" Then   'Check
									oPayment.Description = .CheckBank + ", ************" + Right(.CheckAccount,4)+ ", " + .CheckName
									End If
								End With
							End If
						Next
						Set oBilling = Nothing
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayments" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(15)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<!-- Direct Payments -->
				<WTOBJECT name="Payments" project="ptsPaymentUser" class="CPayments">
					<WTMETHOD name="FindOwner">
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="CONST(1008)"/>
						<WTPARAM name="Bookmark" direction="input" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="SearchText" direction="input" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="Direction" direction="input" value="CONST(1)"/>
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						Set oBilling = server.CreateObject("ptsBillingUser.CBilling")
						For Each oPayment In oPayments
							If oPayment.Status = 4 Then reqDeclines = reqDeclines + 1
							If oPayment.PayType &lt;= 5 Then
								PaymentBilling oPayment.Description, oBilling
								With oBilling
									If .PayType = "1" Then   'Credit Card
									Select Case .CardType
									Case 1
									tmpCardType = "Visa"
									Case 2
									tmpCardType = "MasterCard"
									Case 3
									tmpCardType = "Discover"
									Case 4
									tmpCardType = "Amex"
									End Select
									oPayment.Description = tmpCardType + ", ************" + Right(.CardNumber,4) + ", " + .CardMo + "/" + .CardYr + ", " + .CardName
									End If
									If .PayType = "2" Then   'Check
									oPayment.Description = .CheckBank + ", ************" + Right(.CheckAccount,4)+ ", " + .CheckName + ", " + .CheckAcctType
									End If
								End With
							End If
						Next
						Set oBilling = Nothing
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPayment2" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(15)"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;Payment2&quot;)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateMethod">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>reqPayDesc = BillingPayment( oBilling )</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="PARAM(PayType)" value="SYSCON(PAYTYPE-CHECK)"/>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(3)"/>
            <WTSETATTRIBUTE name="PARAM(PayType)" value="SYSCON(PAYTYPE-CASH)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(4)"/>
            <WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
          </WTCODEGROUP>
        </WTOBJECT>
				<WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
					<WTCONDITION expr="PARAM(PayType)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PaymentID" direction="input" value="PARAM(PaymentID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayAmount)" value="ATTR(Total)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="PARAM(PayType)"/>
					<WTSETATTRIBUTE name="ATTR(Description)" value="PARAM(PayDesc)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="SubmitPayment">
        <WTCALLSUB name="GetWallet"/>
        <WTSETATTRIBUTE name="CONST(WalletPrice)" value="CONST(reqPayAmount)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTSETATTRIBUTE name="CONST(WalletPrice)" value="CONST(10)">
            <WTCONDITION expr="CONST(WalletPrice)" oper="equal" value="CONST(11)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(WalletPrice)" value="CONST(25)">
            <WTCONDITION expr="CONST(WalletPrice)" oper="equal" value="CONST(27)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(WalletPrice)" value="CONST(50)">
            <WTCONDITION expr="CONST(WalletPrice)" oper="equal" value="CONST(53)"/>
          </WTSETATTRIBUTE>
        </WTCODEGROUP>
        
        <!-- PROCESS WALLET PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="greater-equal" value="CONST(CCUR(WalletPrice))"/>
          <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(WalletPrice)"/>
          <!-- DEBIT WALLET -->
          <WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PayoutID" direction="input" value="CONST(0)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTCUSTOM>
              IP = Request.ServerVariables("REMOTE_ADDR")
              tmpLocation = GetIPCity( IP )
            </WTCUSTOM>
            <WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
            <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(MemberID)"/>
            <WTSETATTRIBUTE name="ATTR(PayDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(date)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(5)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice * -1)"/>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="PARAM(PaymentID)"/>
            <WTSETATTRIBUTE name="ATTR(Notes)" value="CONST(Left( .Notes + &quot; &quot; + IP + &quot; &quot; + tmpLocation, 500) )"/>
            <WTMETHOD name="Add">
              <WTPARAM name="PayoutID" direction="return" datatype="number"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- UPDATE PAYMENT -->
          <WTOBJECT name="Payment" project="ptsPaymentUser" class="CPayment">
            <WTCONDITION expr="NoErrors"/>
            <WTMETHOD name="Load">
              <WTPARAM name="PaymentID" direction="input" value="PARAM(PaymentID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
            <WTSETATTRIBUTE name="ATTR(PayType)" value="CONST(90)"/>
            <WTSETATTRIBUTE name="ATTR(Status)" value="CONST(3)"/>
            <WTSETATTRIBUTE name="ATTR(Amount)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Total)" value="CONST(BillingPrice)"/>
            <WTSETATTRIBUTE name="ATTR(Reference)" value="CONST(PayoutID)"/>
            <WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
            <WTMETHOD name="Save">
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
          </WTOBJECT>
          <!-- Custom Company Payment Post Processing -->
          <WTCODEGROUP>
            <WTCONDITION expr="NoErrors"/>
            <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
              <WTMETHOD name="Custom">
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="Status" direction="input" value="CONST(99)"/>
                <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(PaymentID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Count" direction="return" datatype="number"/>
              </WTMETHOD>
            </WTOBJECT>
          </WTCODEGROUP>
        </WTCODEGROUP>

        <!-- PROCESS CREDIT CARD PAYMENT ***********************************************************-->
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(CCUR(reqWalletNumber))" oper="less" value="CONST(CCUR(WalletPrice))"/>
          <!-- get company options -->
				  <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					  <WTMETHOD name="FetchCompany">
						  <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					  </WTMETHOD>
					  <WTMETHOD name="Load">
						  <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
					  <WTSETATTRIBUTE name="CONST(tmpPrice1)" value="ATTR(Price)"/>
					  <WTSETATTRIBUTE name="CONST(tmpPrice2)" value="ATTR(Price2)"/>
					  <WTSETATTRIBUTE name="CONST(tmpPrice3)" value="ATTR(Price3)"/>
					  <WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					  <WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
					  <WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					  <WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					  <WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					  <WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					  <WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					  <WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				  </WTOBJECT>
				  <WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(1)"/>
				  <WTCUSTOM>
					  tmpProcessor = 0
					  tmpAcct = ""
					  Select Case reqPayType
					  Case 1, 2, 3, 4	'Process Credit Cards
						  tmpProcessor = tmpCardProcessor
						  tmpAcct = tmpCardAcct
					  Case 5 'Process Electronic Checks
						  tmpProcessor = tmpCheckProcessor
						  tmpAcct = tmpCheckAcct
					  End Select
				  </WTCUSTOM>
				  <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, reqPaymentID, reqPayType, reqPayDesc, reqPayAmount, &quot;&quot;, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
				  <WTCODEGROUP>
					  <WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
					  <WTCUSTOM>reqProcessStatus = 1</WTCUSTOM>
				  </WTCODEGROUP>
				  <WTCODEGROUP>
					  <WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
					  <WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
				  </WTCODEGROUP>
        </WTCODEGROUP>
      </WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
				<WTCALLSUB name="LoadLists"/>
			</WTACTION>

			<WTACTION id="5" name="Billing" type="Update">
				<WTRETURN>
					<WTLINK name="2903" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
						<WTPARAM name="V" value="CONST(1)"/>
					</WTLINK>
					<!-- FIX SSL					
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>

			<WTACTION id="7" name="AddBilling" type="Update">
				<WTRETURN>
					<WTLINK name="2902" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
					<!-- FIX SSL					
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>

			<WTACTION id="8" name="Reprocess" type="Update">
				<WTCALLSUB name="UpDateMethod"/>
				<WTCALLSUB name="SubmitPayment"/>
				<WTCALLSUB name="LoadBilling"/>
				<WTCALLSUB name="LoadLists"/>
				<WTCALLSUB name="ActivateMember">
					<WTCONDITION expr="PARAM(ProcessStatus)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Declines)" oper="equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(PaymentID)"/>
				</WTROW>

				<WTSTATIC label="CreditCard"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Cash"/>
				<WTSTATIC label="NoPay"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Check"/>
				<WTSTATIC label="NoComm"/>
				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>

				<WTSTATIC label="Submitted"/>
				<WTSTATIC label="Pending"/>
				<WTSTATIC label="Approved"/>
				<WTSTATIC label="Declined"/>
				<WTSTATIC label="Returned"/>
				<WTSTATIC label="Cancelled"/>

				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" align="center" class="PageHeading">
						<WTSTATIC label="DeclinedPayments" newline="1" fontsize="4"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;))"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTBUTTON col="1" action="7" value="CONST(AddBilling)" align="center"/>
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTTABLE col="1">
							<WTCOLUMN width="160" align="right"/>
							<WTCOLUMN width="440" align="left"/>

							<WTROW>
								<WTBUTTON col="1" merge="2" action="5" value="CONST(EditBilling)" align="center"/>
								<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
									<WTCLICK>window.close()</WTCLICK>
								</WTBUTTON>
							</WTROW>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" tag="PayType"/>
								<WTSTATIC col="2" value="ATTR(Billing.PayType)" enum="true"/>
								<WTSTATIC col="2">
									<WTSTATIC label="VerifiedNo" fontcolor="red" fontsize="3">
										<WTCONDITION expr="ATTR(Billing.Verified)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC label="VerifiedYes" fontcolor="green" fontsize="3">
										<WTCONDITION expr="ATTR(Billing.Verified)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2" tag="UpdatedDate" value="ATTR(Billing.UpdatedDate)" fontcolor="purple"/>
							</WTROW>

							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardType"/>
									<WTSTATIC col="2">
										<WTSTATIC label="Visa">
											<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
										<WTSTATIC label="MasterCard">
											<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(2)"/>
										</WTSTATIC>
										<WTSTATIC label="Discover">
											<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(3)"/>
										</WTSTATIC>
										<WTSTATIC label="Amex">
											<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(4)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
									<WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
								</WTROW>
							</WTCODEGROUP>

							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(2)"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckBank"/>
									<WTSTATIC col="2" value="ATTR(Billing.CheckBank)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckName"/>
									<WTSTATIC col="2" value="ATTR(Billing.CheckName)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckRoute"/>
									<WTSTATIC col="2" value="ATTR(Billing.CheckRoute)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAccount"/>
									<WTSTATIC col="2" value="ATTR(Billing.CheckAccount)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckNumber"/>
									<WTSTATIC col="2" value="ATTR(Billing.CheckNumber)"/>
								</WTROW>
							</WTCODEGROUP>

							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(4)"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="WalletType"/>
									<WTSTATIC col="2">
										<WTSTATIC label="iPayout">
											<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(11)"/>
										</WTSTATIC>
										<WTSTATIC label="PayQuicker">
											<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(12)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="WalletName"/>
									<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
								</WTROW>
							</WTCODEGROUP>
							<WTROW margin-top="6" margin-bottom="6">
								<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
							</WTROW>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" tag="WalletBalance"/>
                <WTSTATIC col="2" value="PARAM(Wallet)"/>
              </WTROW>
              <WTROW margin-top="6" margin-bottom="6">
                <WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
              </WTROW>
            </WTTABLE>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Declines)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" align="center" class="PageHeading">
							<WTSTATIC label="NoDeclinedPayments">
								<WTCONDITION expr="PARAM(ProcessStatus)" oper="not-equal" value="CONST(2)"/>
							</WTSTATIC>
							<WTSTATIC label="ActivatedMember" fontcolor="red">
								<WTCONDITION expr="PARAM(ProcessStatus)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Declines)" oper="greater" value="CONST(0)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" align="center" label="FixDeclines" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTSTATIC col="1" align="center" class="PageHeading" fontcolor="red">
							<WTSTATIC value="PARAM(Declines)" space="1"/>
							<WTSTATIC label="Declines"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1" align="center" fontsize="3" fontcolor="red">
							<WTSTATIC label="ReprocessDecline1" newline="1"/>
              <WTSTATIC label="ReprocessDecline2" newline="1"/>
              <WTSTATIC label="ReprocessDecline3" newline="1"/>
              <WTSTATIC label="ReprocessDecline4"/>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Cash)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" label="PendingCashPayments" align="center" class="PageHeading" fontcolor="red"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(DATA/TXN/PTSPAYMENTS/PTSPAYMENT))" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" label="OrderPayments" align="center" fontsize="3" class="ColumnTitle"/>
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" graybar="true" entity="Payment">
							<WTCOLUMN width="12" align="left" label="PayDate"/>
							<WTCOLUMN width="16" align="left" label="Amount"/>
							<WTCOLUMN width="17" align="left" label="Status"/>
							<WTCOLUMN width="15" align="left" label="PayType"/>
							<WTCOLUMN width="12" align="left" label="PaidDate"/>
							<WTCOLUMN width="10"  align="center" label="#" />
							<WTCOLUMN width="18" align="center"/>
							<WTROW>
								<WTCONDITION expr="DATA(Payment.Status)" oper="less" value="CONST(4)"/>
								<WTSTATIC col="1" value="DATA(PayDate)"/>
								<WTSTATIC col="2" value="DATA(Total)"/>
								<WTSTATIC col="3" value="DATA(Status)"/>
								<WTSTATIC col="4" value="DATA(PayType)" enum="true"/>
								<WTSTATIC col="5" value="DATA(PaidDate)"/>
								<WTSTATIC col="6" value="DATA(PaymentID)"/>
								<WTSTATIC col="7" value="DATA(Reference)"/>
							</WTROW>
							<WTROW>
								<WTCONDITION expr="DATA(Payment.Status)" oper="greater" value="CONST(3)"/>
								<WTSTATIC col="1" value="DATA(PayDate)" fontcolor="red"/>
								<WTSTATIC col="2" value="DATA(Total)" fontcolor="red"/>
								<WTSTATIC col="3" value="DATA(Status)" fontcolor="red"/>
								<WTSTATIC col="4" value="DATA(PayType)" enum="true" fontcolor="red"/>
								<WTSTATIC col="5" value="DATA(PaidDate)" fontcolor="red"/>
								<WTSTATIC col="6" value="DATA(PaymentID)" fontcolor="red"/>
								<WTSTATIC col="7">
									<WTCODEGROUP>
										<WTBUTTON value="CONST(Reprocess)" btnclass="redbutton">
											<WTCLICK escape="false">document.getElementById('PaymentID').value = &lt;xsl:value-of select=&quot;@paymentid&quot;/&gt;; this.disabled = true; doSubmit(8,&quot;&quot;);</WTCLICK>
										</WTBUTTON>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="7" fontcolor="gray">
									<WTSTATIC value="DATA(Purpose)" space="1"/>
									<WTSTATIC value="DATA(Payment.Description)" space="1"/>
									<WTSTATIC value="DATA(Payment.Notes)" fontcolor="purple">
										<WTCONDITION expr="DATA(Payment.Status)" oper="greater" value="CONST(3)"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(DATA/TXN/PTSPAYMENT2S/PTSPAYMENT2))" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" label="DirectPayments" align="center" fontsize="3" class="ColumnTitle"/>
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" graybar="true" entity="Payment2">
							<WTCOLUMN width="12" align="left" label="PayDate"/>
							<WTCOLUMN width="16" align="left" label="Amount"/>
							<WTCOLUMN width="17" align="left" label="Status"/>
							<WTCOLUMN width="15" align="left" label="PayType"/>
							<WTCOLUMN width="12" align="left" label="PaidDate"/>
							<WTCOLUMN width="10"  align="center" label="#" />
							<WTCOLUMN width="18" align="center"/>
							<WTROW>
								<WTCONDITION expr="DATA(Payment.Status)" oper="less" value="CONST(4)"/>
								<WTSTATIC col="1" value="DATA(PayDate)"/>
								<WTSTATIC col="2" value="DATA(Total)"/>
								<WTSTATIC col="3" value="DATA(Status)"/>
								<WTSTATIC col="4" value="DATA(PayType)" enum="true"/>
								<WTSTATIC col="5" value="DATA(PaidDate)"/>
								<WTSTATIC col="6" value="DATA(PaymentID)"/>
								<WTSTATIC col="7" value="DATA(Reference)"/>
							</WTROW>
							<WTROW>
								<WTCONDITION expr="DATA(Payment.Status)" oper="greater" value="CONST(3)"/>
								<WTSTATIC col="1" value="DATA(PayDate)" fontcolor="red"/>
								<WTSTATIC col="2" value="DATA(Total)" fontcolor="red"/>
								<WTSTATIC col="3" value="DATA(Status)" fontcolor="red"/>
								<WTSTATIC col="4" value="DATA(PayType)" enum="true" fontcolor="red"/>
								<WTSTATIC col="5" value="DATA(PaidDate)" fontcolor="red"/>
								<WTSTATIC col="6" value="DATA(PaymentID)" fontcolor="red"/>
								<WTSTATIC col="7">
									<WTCODEGROUP>
										<WTBUTTON value="CONST(Reprocess)" btnclass="redbutton">
											<WTCLICK escape="false">document.getElementById('PaymentID').value = &lt;xsl:value-of select=&quot;@paymentid&quot;/&gt;; this.disabled = true; doSubmit(8,&quot;&quot;);</WTCLICK>
										</WTBUTTON>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" merge="7" fontcolor="gray">
									<WTSTATIC value="DATA(Payment.Purpose)" space="1"/>
									<WTSTATIC value="DATA(Payment.Description)" space="1"/>
									<WTSTATIC value="DATA(Payment.Notes)" fontcolor="purple">
										<WTCONDITION expr="DATA(Payment.Status)" oper="greater" value="CONST(3)"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
						</WTRECORDSET>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0436e" caption="Declined Email" navbar="false" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0436e" track="0">
			<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Subject" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpFirstName)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpLastName)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;DeclinePayment.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company/&quot; + CStr(tmpCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Len(.Data))" oper="less" value="CONST(10)"/>
						<WTCUSTOM>
     					tmpURL = "http://" + reqSysServerName + reqSysServerPath + "0436d.asp?memberid={id}"
							.Data = "{firstname} {lastname}&lt;p&gt;&lt;a href=""" + tmpURL + """&gt;Click Here to resolve your declined payment.&lt;/a&gt; Your membership will be effected until your declined payment is resolved.&lt;/p&gt;"
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCUSTOM>
					xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqMemberID) )
					xmlHTMLFile = Replace( xmlHTMLFile, "{firstname}", tmpFirstName )
					xmlHTMLFile = Replace( xmlHTMLFile, "{lastname}", tmpLastName )
					reqSubject = "Oops! Your payment was declined."
				</WTCUSTOM>
			</WTACTION>
			<WTACTION id="1" name="Email" type="Update">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email)"/>
          <!-- SET FLAG THAT NOTICE WAS SENT -->
          <WTSETATTRIBUTE name="ATTR(Role)" value="CONST(.Role + &quot;*&quot;)"/>
          <WTMETHOD name="Save">
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)"/>
				</WTOBJECT>
				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="FORM(Subject)"/>
				<WTSETATTRIBUTE name="CONST(tmpBody)" value="FORM(Data)"/>
				<WTCUSTOM>
					SendEmail tmpCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
				</WTCUSTOM>
				<WTCALLSUB name="LogMemberNote reqMemberID, &quot;Declined Payment Notice Emailed&quot;"/>
				<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)"/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="80" align="right"/>
				<WTCOLUMN width="520" align="left"/>

				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC label="DeclinedEmail" newline="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC value="CONST(-)" space="1"/>
						<WTSTATIC value="ATTR(Member.Email)"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="EmailSent" align="center" class="PageHeading" fontcolor="red"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" tag="Subject"/>
						<WTTEXT col="2" value="PARAM(Subject)" size="72"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTSTATIC col="1" tag="Body" align="left"/>
					</WTROW>
					<WTROW margin-top="3">
						<WTMEMO col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" cols="72" rows="12" htmleditor="editor_simple" embedhtml="true"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" action="1" value="CONST(SendEmail)" align="center"/>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_0436" caption="Billing Method" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="m_0436" mobile="MobileHome.asp" secured="98" track="0">
			<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>

			<WTSUB name="LoadBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
			</WTACTION>

			<WTACTION id="5" name="Billing" type="Update">
				<WTRETURN>
					<WTLINK name="m_2903" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
					</WTLINK>
<!-- FIX SSL					
					<WTLINK name="2903" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>

			<WTACTION id="7" name="AddBilling" type="Update">
				<WTRETURN>
					<WTLINK name="m_2902" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					</WTLINK>
<!-- FIX SSL					
					<WTLINK name="2902" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="40" align="right"/>
				<WTCOLUMN width="60" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
				</WTROW>

				<WTSTATIC label="CreditCard"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Cash"/>
				<WTSTATIC label="NoPay"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="Check"/>
				<WTSTATIC label="NoComm"/>
				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>

				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" newline="1"/>
						<WTSTATIC label="BillingInfo"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTBUTTON col="1" merge="2" action="7" value="CONST(AddBilling)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)"/>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="2" action="5" value="CONST(EditBilling)" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="PayType"/>
						<WTSTATIC col="2" value="ATTR(Billing.PayType)" enum="true"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="UpdatedDate"/>
						<WTSTATIC col="2" value="ATTR(Billing.UpdatedDate)"/>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(1)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardType)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
							<WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckBank)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckRoute)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckAccount)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckNumber)"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
						</WTROW>
					</WTCODEGROUP>

				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================-->
		<WTWEBPAGE name="0437" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl" langfile="0437">
		<!--==================================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Type" datatype="number"/>
			<WTPARAM name="Msg" datatype="number"/>
			<WTPARAM name="SponsorName" datatype="text"/>
			<WTPARAM name="NewMemberName" datatype="text"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>		<!--Required Parameter for Mail-->
			<WTPARAM name="Customer" datatype="number"/>
			<WTPARAM name="Leaders" datatype="number"/>
			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpSponsorID)" value="ATTR(ReferralID)">
						<WTCONDITION expr="PARAM(Type)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSponsorID)" value="ATTR(SponsorID)">
						<WTCONDITION expr="PARAM(Type)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSponsorID)" value="ATTR(Sponsor2ID)">
						<WTCONDITION expr="PARAM(Type)" oper="equal" value="CONST(2)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(NewMemberName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Customer)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpMember)" value="CONST(&quot;Member&quot;)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Customer)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpMember)" value="CONST(&quot;Customer&quot;)">
							<WTCONDITION expr="ATTR(Status)" oper="equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="CONST(tmpMember)" value="CONST(&quot;Free Trial&quot;)">
							<WTCONDITION expr="ATTR(Status)" oper="not-equal" value="CONST(1)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpSponsorID)" oper="greater" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpSponsorID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(SponsorName)" value="ATTR(NameFirst)"/>
						<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email2)"/>
						<WTSETATTRIBUTE name="CONST(tmpMsgTo)" value="ATTR(MemberID)">
							<WTCONDITION expr="ATTR(IsMsg)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
				</WTOBJECT>

				<!-- call procedure to get Cc in email(Manager,Director and exec)-->
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
					<WTCONDITION expr="PARAM(Leaders)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Custom">
							<WTPARAM name="Status" direction="input" value="CONST(104)"/>
							<WTPARAM name="CZDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(tmpSponsorID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="tmpCC" direction="return" datatype="text"/>
						</WTMETHOD>
				</WTOBJECT>
				
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="CONST(tmpCompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(mEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;New &quot; + tmpMember + &quot;: &quot; + reqNewMemberName)"/>

				<WTMAIL from="tmpFrom" to="tmpTo" cc="tmpCC" subject="tmpSubject" sender="tmpSender" msgto="tmpMsgTo"/>
			   
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>

				<WTROW margin-top="12">
					<WTSTATIC col="1">
						<WTSTATIC label="Hi" space="1"/>
						<WTSTATIC value="PARAM(SponsorName)"/>
						<WTSTATIC value="CONST(,)" newline="2"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Customer)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC label="NewCustomer">
								<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="NewTrial">
								<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Customer)" oper="equal" value="CONST(0)"/>
							<WTCONDITION expr="PARAM(Msg)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSTATIC label="NewEnrolledMember">
								<WTCONDITION expr="PARAM(Type)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC label="NewSponsoredMember">
								<WTCONDITION expr="PARAM(Type)" oper="equal" value="CONST(1)"/>
								<WTCONDITION expr="PARAM(Type)" oper="equal" value="CONST(2)" connector="or"/>
							</WTSTATIC>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Msg)" oper="equal" value="CONST(1)"/>
							<WTSTATIC label="UpgradeMember"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Msg)" oper="equal" value="CONST(12)"/>
							<WTSTATIC label="UpgradeLevel12"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Msg)" oper="equal" value="CONST(13)"/>
							<WTSTATIC label="UpgradeLevel13"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Msg)" oper="equal" value="CONST(14)"/>
							<WTSTATIC label="UpgradeLevel14"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" value="PARAM(NewMemberName)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(Member.Email)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(Member.Phone1)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" value="ATTR(Member.Phone2)" bold="true"/>
				</WTROW>

				<WTROW margin-top="18">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC value="ATTR(Company.CompanyName)"/>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================-->
		<WTWEBPAGE name="0447" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl" langfile="0447">
		<!--==================================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="NewMemberName" datatype="text"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>		<!--Required Parameter for Mail-->

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(NewMemberName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="CONST(tmpCompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email2)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;New Member: &quot; + reqNewMemberName)"/>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender" msgto="tmpMsgTo"/>
			   
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>

				<WTROW margin-top="12">
					<WTSTATIC col="1" label="NewEnrolledMember"/>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" value="PARAM(NewMemberName)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Title)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="Title" value="PARAM(Title)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="Title" value="ATTR(Member.Title)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Email" value="ATTR(Member.Email)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone1" value="ATTR(Member.Phone1)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone2" value="ATTR(Member.Phone2)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0441" caption="Payout Method" navbar="false" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0441" secured="52" track="0">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
      <WTPARAM name="NoClose" datatype="number"/>
      <WTPARAM name="IsUpdate" datatype="number"/>
      <!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
		   
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(PayID)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="ATTR(Verified)" oper="not-equal" value="SYSCON(BILLING-VERIFIED-LOCKED)" connector="or"/>
            <WTSETATTRIBUTE name="PARAM(IsUpdate)" value="CONST(1)"/>
          </WTCODEGROUP>

          <WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
			</WTACTION>

			<WTACTION id="4" name="RemoveBilling" type="Update">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPayID)" value="ATTR(PayID)"/>
					<WTSETATTRIBUTE name="ATTR(PayID)" value="CONST(0)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Delete">
						<WTPARAM name="BillingID" direction="input" value="CONST(tmpPayID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadBilling"/>
			</WTACTION>

			<WTACTION id="5" name="Billing" type="Update">
				<WTRETURN>
					<WTLINK name="2913" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
<!-- FIX SSL
					<WTLINK name="2913" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="BillingID" value="PARAM(BillingID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="7" name="AddBilling" type="Update">
				<WTRETURN>
					<WTLINK name="2912" nolocaldata="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
<!-- FIX SSL
					<WTLINK name="2912" nolocaldata="true" secure="true">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="contentpage" value="CONST(3)"/>
					</WTLINK>
-->
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
				</WTROW>

				<WTSTATIC label="CreditCard"/>
				<WTSTATIC label="eCheck"/>
				<WTSTATIC label="eWallet"/>
				<WTSTATIC label="Check"/>
				<WTSTATIC label="NoComm"/>
				<WTSTATIC label="Visa"/>
				<WTSTATIC label="MasterCard"/>
				<WTSTATIC label="Checking"/>
				<WTSTATIC label="Savings"/>

				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" newline="1"/>
						<WTSTATIC label="BillingInfo"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTBUTTON col="1" merge="2" action="7" value="CONST(AddBilling)" align="center"/>
						<WTBUTTON col="1" merge="2" action="4" value="CONST(RemoveBilling)" align="center" btnclass="smbutton">
							<WTCONDITION expr="IsManager"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center" btnclass="smbutton">
							<WTCONDITION expr="PARAM(NoClose)" oper="equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="greater" value="CONST(0)"/>
					<WTROW>
						<WTBUTTON col="1" merge="2" action="5" value="CONST(EditBilling)" align="center">
              <WTCONDITION expr="PARAM(IsUpdate)" oper="not-equal" value="CONST(0)"/>
            </WTBUTTON>
            <WTBUTTON col="1" merge="2" value="CONST(Close)" align="center" btnclass="smbutton">
							<WTCONDITION expr="PARAM(NoClose)" oper="equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CommType"/>
						<WTSTATIC col="2" value="ATTR(Billing.CommType)" enum="true"/>
						<WTSTATIC col="2">
							<WTSTATIC label="VerifiedNo" fontcolor="red" fontsize="3">
								<WTCONDITION expr="ATTR(Billing.Verified)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
              <WTSTATIC label="VerifiedYes" fontcolor="green" fontsize="3">
                <WTCONDITION expr="ATTR(Billing.Verified)" oper="equal" value="CONST(2)"/>
              </WTSTATIC>
              <WTSTATIC label="VerifiedLocked" fontcolor="purple" fontsize="3">
                <WTCONDITION expr="ATTR(Billing.Verified)" oper="equal" value="CONST(3)"/>
              </WTSTATIC>
            </WTSTATIC>
						<WTSTATIC col="2" tag="UpdatedDate" value="ATTR(Billing.UpdatedDate)" fontcolor="purple"/>
					</WTROW>
				
					<WTCODEGROUP>	
						<WTCONDITION expr="ATTR(Billing.CommType)" oper="equal" value="CONST(1)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTSTATIC col="2">
								<WTSTATIC label="Visa">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="MasterCard">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Discover">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Amex">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardNumber)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardMo)" />
							<WTSTATIC col="2" value="ATTR(Billing.CardYr)" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardCode)"/>
						</WTROW>
					</WTCODEGROUP>	

					<WTCODEGROUP>	
						<WTCONDITION expr="ATTR(Billing.CommType)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckBank)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckRoute)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckAccount)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckAcctType)" enum="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTSTATIC col="2" value="ATTR(Billing.CheckNumber)"/>
						</WTROW>

					</WTCODEGROUP>	
					<WTCODEGROUP>	
						<WTCONDITION expr="ATTR(Billing.CommType)" oper="equal" value="CONST(3)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="BillingName"/>
							<WTSTATIC col="2" value="ATTR(Billing.BillingName)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="Address"/>
							<WTSTATIC col="2" value="ATTR(Billing.Street1)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" value="ATTR(Billing.Street2)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CityState"/>
							<WTSTATIC col="2" value="ATTR(Billing.City)"/>
							<WTSTATIC col="2" value="ATTR(Billing.State)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="ZipCountry"/>
							<WTSTATIC col="2" value="ATTR(Billing.Zip)"/>
							<WTSTATIC col="2" value="ATTR(Billing.CountryName)"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Billing.CommType)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletType"/>
							<WTSTATIC col="2">
								<WTSTATIC label="iPayout">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(11)"/>
								</WTSTATIC>
								<WTSTATIC label="PayQuicker">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(12)"/>
								</WTSTATIC>
								<WTSTATIC label="SolidTrust">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(13)"/>
								</WTSTATIC>
								<WTSTATIC label="BitCoin">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(14)"/>
								</WTSTATIC>
								<WTSTATIC label="Neteller">
									<WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(15)"/>
								</WTSTATIC>
                <WTSTATIC label="Nexxus">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(16)"/>
                </WTSTATIC>
                <WTSTATIC label="Ether">
                  <WTCONDITION expr="ATTR(Billing.CardType)" oper="equal" value="CONST(17)"/>
                </WTSTATIC>
              </WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletName"/>
							<WTSTATIC col="2" value="ATTR(Billing.CardName)"/>
						</WTROW>
					</WTCODEGROUP>

				</WTCODEGROUP>	
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0439" caption="Page Expired" navbar="false"  footer="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--=============================================================================================-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="center"/>
				<WTROW margin-top="36">
					<WTSTATIC col="1" label="PageExpired" class="PageHeading" newline="2"/>
					<WTSTATIC col="1" label="PageRedirect" >
						<WTLINK name="0000"/>
					</WTSTATIC>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="0440" caption="Training Buddy" contentpage="true" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="61" langfile="0440">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Time" datatype="number"/>
			<WTPARAM name="Visit" datatype="number"/>
			<WTPARAM name="VisitDate" datatype="text"/>
			<WTPARAM name="Date30" datatype="text"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Refresh" datatype="number"/>
			<WTPARAM name="TBImage" datatype="text"/>
			<WTPARAM name="TBPage" datatype="text"/>

			<WTDATATXN name="TB"/>
			<WTINCLUDE name="TB.asp"/>
			<WTINCLUDE name="MemberOptions.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotBuddy" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSUB function="LoadTB(bvLoad)">
				<WTCALLSUB name="reqTBImage = GetMemberOptions(&quot;TBI&quot;)"/>
				<WTCALLSUB name="reqTBPage = GetMemberOptions(&quot;TBP&quot;)"/>
<WTCUSTOM>
		If bvLoad = 0 Then xmlTB = GetTB()
		tmpMemberID = GetCache("TBMEMBERID")
		SetCache "TBMEMBERID", reqMemberID
		If xmlTB = "" OR CStr(reqMemberID) &lt;&gt; tmpMemberID Then bvLoad = 1

		If reqVisitDate = "" Then reqVisitDate = GetCache("VISITDATE")
		If Not IsDate(reqVisitDate) Then
			reqVisit = 0
		Else	
			tmpDays = DateDiff("d", reqVisitDate, Date() )
			If tmpDays &gt;= 30 Then reqVisit = 6
			If tmpDays &lt; 30 Then reqVisit = 5
			If tmpDays &lt; 14 Then reqVisit = 4
			If tmpDays &lt; 7 Then reqVisit = 3
			If tmpDays &lt; 4 Then reqVisit = 2
			If tmpDays &lt;= 1 Then reqVisit = 1
		End If
		tmpHr = Hour( Now() )
		If tmpHr &gt;= 18 Then reqTime = 4
		If tmpHr &lt; 18 Then reqTime = 3
		If tmpHr &lt; 12 Then reqTime = 2
		If tmpHr &lt; 6 Then reqTime = 1
		
		reqDate30 = DateAdd("d", -30, Date() )
</WTCUSTOM>
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="TBCount">
						<WTCONDITION expr="CONST(bvLoad)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="xmlTB" direction="return" datatype="text"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="VisitDate" direction="input" value="PARAM(VisitDate)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(bvLoad)" oper="equal" value="CONST(1)"/>
						<WTCALLSUB name="SetTB(xmlTB)"/>
						<WTSETATTRIBUTE name="PARAM(Refresh)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadTB(0)"/>
			</WTACTION>

			<WTACTION id="1" name="Refresh" type="Update">
				<WTCALLSUB name="LoadTB(1)"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="200" align="right"/>
				<WTCOLUMN width="400" align="left"/>

				<WTSTATIC label="TBInfo"/>

				<WTROW margin-top="3" margin-bottom="6">
					<WTSTATIC col="1" align="right" valign="middle">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(TBPage)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC label="ClickMe" bold="true"/>
<!--							<WTIMAGE value="PARAM(TBImage)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;)" alt="TBInfo">-->
							<WTIMAGE value="CONST(IconG.gif)" alt="TBInfo">
								<WTLINK name="3815" nodata="true" target="TB">
									<WTPARAM name="CompanyID" value="ATTR(Company.CompanyID)"/>
									<WTPARAM name="Page" value="PARAM(TBPage)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(TBPage)" oper="equal" value="CONST('')"/>
<!--							<WTIMAGE value="PARAM(TBImage)" path="CONST(Company/&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@companyid&quot;/&gt;)"/>-->
							<WTIMAGE value="CONST(IconG.gif)"/>
						</WTCODEGROUP>
					</WTSTATIC>
					<WTSTATIC col="2" align="center" valign="center">
						<WTSTATIC bold="true" fontsize="3">
							<WTSTATIC label="Good" space="1"/>
							<WTSTATIC label="EarlyMorning" space="1">
								<WTCONDITION expr="PARAM(Time)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="Morning" space="1">
								<WTCONDITION expr="PARAM(Time)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
							<WTSTATIC label="Afternoon" space="1">
								<WTCONDITION expr="PARAM(Time)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
							<WTSTATIC label="Evening" space="1">
								<WTCONDITION expr="PARAM(Time)" oper="equal" value="CONST(4)"/>
							</WTSTATIC>
							<WTSTATIC value="ATTR(Member.NameFirst)" newline="1"/>
						</WTSTATIC>

						<WTSTATIC bold="true">
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Visit)" oper="equal" value="CONST(0)"/>
								<WTSTATIC label="VisitFirst" fontcolor="darkgreen"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Visit)" oper="equal" value="CONST(1)"/>
								<WTSTATIC label="Visit1Day" fontcolor="darkgreen"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Visit)" oper="equal" value="CONST(2)"/>
								<WTSTATIC label="Visit4Day" fontcolor="darkblue"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Visit)" oper="equal" value="CONST(3)"/>
								<WTSTATIC label="Visit7Day" fontcolor="darkcyan"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Visit)" oper="equal" value="CONST(4)"/>
								<WTSTATIC label="Visit14Day" fontcolor="saddlebrown"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Visit)" oper="equal" value="CONST(5)"/>
								<WTSTATIC label="Visit30Day" fontcolor="orangered"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Visit)" oper="equal" value="CONST(6)"/>
								<WTSTATIC label="Visit31Day" fontcolor="red"/>
							</WTCODEGROUP>
						</WTSTATIC>

						<WTSTATIC newline="1"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Visit)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC tag="LastVisit" fontsize="1"/>
							<WTSTATIC value="PARAM(VisitDate)" fontsize="1" newline="2"/>
						</WTCODEGROUP>

						<WTSTATIC label="CustomerSupport" newline="1" bold="true"/>
						
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Business.CustomerEmail)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC tag="Email"/>
							<WTSTATIC value="ATTR(Business.CustomerEmail)" newline="1"/>
						</WTSTATIC>
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Business.Phone)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC tag="Phone"/>
							<WTSTATIC value="ATTR(Business.Phone)" space="3"/>
						</WTSTATIC>
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Business.Fax)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC tag="Fax"/>
							<WTSTATIC value="ATTR(Business.Fax)" newline="1"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="TraingBuddyText" class="prompt" align="center"/>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="200" align="center"/>
						<WTCOLUMN width="200" align="center"/>

						<WTCODEGROUP>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" label="YourExpectations" fontcolor="white" backcolor="Green" bold="true"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" backcolor="palegreen" valign="top">
<!--
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(TB.Expectation)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(TB.Expectation)" bold="true" space="1"/>
										<WTSTATIC label="Expectation" newline="1">
											<WTLINK name="2811" nodata="true">
												<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
												<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											</WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
-->									
									<WTCODEGROUP>
										<WTSTATIC value="ATTR(TB.GoalTotal)" bold="true" space="1"/>
										<WTSTATIC label="GoalTotal" newline="1">
											<WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(TB.GoalDeclare)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(TB.GoalDeclare)" bold="true" space="1"/>
										<WTSTATIC label="GoalDeclare" newline="1">
											<WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(TB.GoalCommit)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(TB.GoalCommit)" bold="true" space="1"/>
										<WTSTATIC label="GoalCommit" newline="1">
											<WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(TB.GoalComplete)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(TB.GoalComplete)" bold="true" space="1"/>
										<WTSTATIC label="GoalComplete" newline="1">
											<WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(TB.GoalEarly)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(TB.GoalEarly)" bold="true" space="1"/>
										<WTSTATIC label="GoalEarly" newline="1">
											<WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(TB.GoalOntime)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(TB.GoalOntime)" bold="true" space="1"/>
										<WTSTATIC label="GoalOntime" newline="1">
											<WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(TB.GoalLate)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC value="ATTR(TB.GoalLate)" bold="true" space="1"/>
										<WTSTATIC label="GoalLate">
											<WTLINK name="7001" nodata="true"><WTPARAM name="MemberID" value="PARAM(MemberID)"/></WTLINK>
										</WTSTATIC>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTCODEGROUP>
					</WTTABLE>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="30"/>
						<WTCOLUMN width="260" align="center"/>
						<WTCOLUMN width="20"/>
						<WTCOLUMN width="260" align="center"/>
						<WTCOLUMN width="30"/>

						<WTROW margin-top="12">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="SinceVisit" fontcolor="white" backcolor="Green" bold="true"/>
							<WTSTATIC col="3"/>
							<WTSTATIC col="4" label="Since30" fontcolor="white" backcolor="Green" bold="true"/>
						</WTROW>
						
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" backcolor="palegreen" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.CompanyCourseVisit)" oper="equal" value="CONST(0)"/>
									<WTCONDITION expr="ATTR(TB.PublicCoursevisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.CompanyAssessmentVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.PublicAssessmentVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.SurveyVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.SuggestionVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.MessageVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoriteCCVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoritePCVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoriteMPVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoriteMRVisit)" oper="equal" value="CONST(0)" connector="and"/>
									<WTSTATIC label="NoVisit"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.CompanyCourseVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.CompanyCourseVisit)" bold="true" space="1"/>
									<WTSTATIC label="CompanyCourseVisit" newline="1">
										<WTLINK name="1118" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CourseDate" value="PARAM(VisitDate)"/>
											<WTPARAM name="Mode" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.PublicCourseVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.PublicCourseVisit)" bold="true" space="1"/>
									<WTSTATIC label="PublicCoursevisit" newline="1">
										<WTLINK name="1118" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CourseDate" value="PARAM(VisitDate)"/>
											<WTPARAM name="Mode" value="CONST(3)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.CompanyAssessmentVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.CompanyAssessmentVisit)" bold="true" space="1"/>
									<WTSTATIC label="CompanyAssessmentVisit" newline="1">
										<WTLINK name="3112" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
											<WTPARAM name="Mode" value="CONST(9)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.PublicAssessmentVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.PublicAssessmentVisit)" bold="true" space="1"/>
									<WTSTATIC label="PublicAssessmentVisit" newline="1">
										<WTLINK name="3112" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
											<WTPARAM name="Mode" value="CONST(13)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.SurveyVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.SurveyVisit)" bold="true" space="1"/>
									<WTSTATIC label="SurveyVisit" newline="1">
										<WTLINK name="4012" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
											<WTPARAM name="Mode" value="CONST(3)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.SuggestionVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.SuggestionVisit)" bold="true" space="1"/>
									<WTSTATIC label="SuggestionVisit" newline="1">
										<WTLINK name="4512" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="SuggestionDate" value="PARAM(VisitDate)"/>
											<WTPARAM name="Mode" value="CONST(3)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.MessageVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.MessageVisit)" bold="true" space="1"/>
									<WTSTATIC label="MessageVisit" newline="1">
										<WTLINK name="8412" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
											<WTPARAM name="Mode" value="CONST(26)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoriteCCVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoriteCCVisit)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteCCVisit" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(2)"/>
											<WTPARAM name="Mode" value="CONST(32)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoritePCVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoritePCVisit)" bold="true" space="1"/>
									<WTSTATIC label="FavoritePCVisit" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(1)"/>
											<WTPARAM name="Mode" value="CONST(34)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoriteMPVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoriteMPVisit)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteMPVisit" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(4)"/>
											<WTPARAM name="Mode" value="CONST(36)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoriteMRVisit)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoriteMRVisit)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteMRVisit" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(4)"/>
											<WTPARAM name="Mode" value="CONST(38)"/>
											<WTPARAM name="VisitDate" value="PARAM(VisitDate)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3"/>
							<WTSTATIC col="4" backcolor="palegreen" valign="top">
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.CompanyCourse30)" oper="equal" value="CONST(0)"/>
									<WTCONDITION expr="ATTR(TB.PublicCourse30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.CompanyAssessment30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.PublicAssessment30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.Survey30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.Suggestion30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.Message30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoriteCC30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoritePC30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoriteMP30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTCONDITION expr="ATTR(TB.FavoriteMR30)" oper="equal" value="CONST(0)" connector="and"/>
									<WTSTATIC label="No30"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.CompanyCourse30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.CompanyCourse30)" bold="true" space="1"/>
									<WTSTATIC label="CompanyCourse30" newline="1">
										<WTLINK name="1118" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CourseDate" value="PARAM(Date30)"/>
											<WTPARAM name="Mode" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.PublicCourse30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.PublicCourse30)" bold="true" space="1"/>
									<WTSTATIC label="PublicCourse30" newline="1">
										<WTLINK name="1118" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CourseDate" value="PARAM(Date30)"/>
											<WTPARAM name="Mode" value="CONST(3)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.CompanyAssessment30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.CompanyAssessment30)" bold="true" space="1"/>
									<WTSTATIC label="CompanyAssessment30" newline="1">
										<WTLINK name="3112" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
											<WTPARAM name="Mode" value="CONST(10)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.PublicAssessment30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.PublicAssessment30)" bold="true" space="1"/>
									<WTSTATIC label="PublicAssessment30" newline="1">
										<WTLINK name="3112" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
											<WTPARAM name="Mode" value="CONST(14)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.Survey30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.Survey30)" bold="true" space="1"/>
									<WTSTATIC label="Survey30" newline="1">
										<WTLINK name="4012" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
											<WTPARAM name="Mode" value="CONST(4)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.Suggestion30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.Suggestion30)" bold="true" space="1"/>
									<WTSTATIC label="Suggestion30" newline="1">
										<WTLINK name="4512" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="SuggestionDate" value="PARAM(Date30)"/>
											<WTPARAM name="Mode" value="CONST(4)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.Message30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.Message30)" bold="true" space="1"/>
									<WTSTATIC label="Message30" newline="1">
										<WTLINK name="8412" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
											<WTPARAM name="Mode" value="CONST(27)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoriteCC30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoriteCC30)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteCC30" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(2)"/>
											<WTPARAM name="Mode" value="CONST(33)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoritePC30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoritePC30)" bold="true" space="1"/>
									<WTSTATIC label="FavoritePC30" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(1)"/>
											<WTPARAM name="Mode" value="CONST(35)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoriteMP30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoriteMP30)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteMP30" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(4)"/>
											<WTPARAM name="Mode" value="CONST(37)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(TB.FavoriteMR30)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="ATTR(TB.FavoriteMR30)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteMR30" newline="1">
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(4)"/>
											<WTPARAM name="Mode" value="CONST(39)"/>
											<WTPARAM name="VisitDate" value="PARAM(Date30)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="center"/>
						<WTCOLUMN width="15"/>
						<WTCOLUMN width="215" align="center"/>
						<WTCOLUMN width="15"/>
						<WTCOLUMN width="195" align="center"/>

						<WTROW margin-top="18">
							<WTSTATIC col="1" label="YourFavorites" fontcolor="white" backcolor="Navy"/>
							<WTSTATIC col="2"/>
							<WTSTATIC col="3" label="YourCourses" fontcolor="white" backcolor="Navy"/>
							<WTSTATIC col="4"/>
							<WTSTATIC col="5" label="YourAssessments" fontcolor="white" backcolor="Navy"/>
						</WTROW>
						
						<WTROW>
							<WTSTATIC col="1" valign="top" backcolor="PaleTurquoise">
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.FavoriteCompany)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteCompany" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoriteCompany)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="FavoriteCompany" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoriteCompany)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(2)"/>
											<WTPARAM name="Mode" value="CONST(28)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="ATTR(TB.FavoritePublic)" bold="true" space="1"/>
									<WTSTATIC label="FavoritePublic" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoritePublic)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="FavoritePublic" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoritePublic)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(1)"/>
											<WTPARAM name="Mode" value="CONST(29)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="ATTR(TB.FavoriteChat)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteChat" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoriteChat)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="FavoriteChat" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoriteChat)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(3)"/>
											<WTPARAM name="Mode" value="CONST(30)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="ATTR(TB.FavoriteForum)" bold="true" space="1"/>
									<WTSTATIC label="FavoriteForum" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoriteForum)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="FavoriteForum" newline="1">
										<WTCONDITION expr="ATTR(TB.FavoriteForum)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4612" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="RefType" value="CONST(4)"/>
											<WTPARAM name="Mode" value="CONST(31)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2"/>
							<WTSTATIC col="3" backcolor="PaleTurquoise" valign="top">
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.CompanyCourseTotal)" bold="true" space="1"/>
									<WTSTATIC label="CompanyCourseTotal" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyCourseTotal)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="CompanyCourseTotal" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyCourseTotal)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="1212" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(2)"/>
										</WTLINK>
									</WTSTATIC>

									<WTSTATIC value="ATTR(TB.CompanyCourseUnregister)" bold="true" space="1"/>
									<WTSTATIC label="CompanyCourseUnregister" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyCourseUnregister)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="CompanyCourseUnregister" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyCourseUnregister)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="1118" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(2)"/>
										</WTLINK>
									</WTSTATIC>

									<WTSTATIC value="ATTR(TB.CompanyCourseRegister)" bold="true" space="1"/>
									<WTSTATIC label="CompanyCourseRegister" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyCourseRegister)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="CompanyCourseRegister" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyCourseRegister)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="1311" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.PublicCourseRegister)" bold="true" space="1"/>
									<WTSTATIC label="PublicCourseRegister" newline="1">
										<WTCONDITION expr="ATTR(TB.PublicCourseRegister)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="PublicCourseRegister" newline="1">
										<WTCONDITION expr="ATTR(TB.PublicCourseRegister)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="1311" nodata="true">
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4"/>
							<WTSTATIC col="5" valign="top" backcolor="PaleTurquoise">
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.CompanyAssessmentTotal)" bold="true" space="1"/>
									<WTSTATIC label="CompanyAssessmentTotal" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyAssessmentTotal)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="CompanyAssessmentTotal" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyAssessmentTotal)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="3112" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="ATTR(TB.CompanyAssessmentTaken)" bold="true" space="1"/>
									<WTSTATIC label="CompanyAssessmentTaken" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyAssessmentTaken)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="CompanyAssessmentTaken" newline="1">
										<WTCONDITION expr="ATTR(TB.CompanyAssessmentTaken)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="3411" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.PublicAssessmentTaken)" bold="true" space="1"/>
									<WTSTATIC label="PublicAssessmentTaken" newline="1">
										<WTCONDITION expr="ATTR(TB.PublicAssessmentTaken)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="PublicAssessmentTaken" newline="1">
										<WTCONDITION expr="ATTR(TB.PublicAssessmentTaken)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="3411" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CompanyID" value="ATTR(Member.CompanyID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-top="18">
							<WTSTATIC col="1" label="YourSurveys" fontcolor="white" backcolor="Purple"/>
							<WTSTATIC col="2"/>
							<WTSTATIC col="3" label="YourSuggestions" fontcolor="white" backcolor="Purple"/>
							<WTSTATIC col="4"/>
							<WTSTATIC col="5" label="YourMessages" fontcolor="white" backcolor="Purple"/>
						</WTROW>
						
						<WTROW>
							<WTSTATIC col="1" valign="top" backcolor="plum">
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.SurveyTaken)" bold="true" space="1"/>
									<WTSTATIC label="SurveyTaken" newline="1">
										<WTCONDITION expr="ATTR(TB.SurveyTaken)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="SurveyTaken" newline="1">
										<WTCONDITION expr="ATTR(TB.SurveyTaken)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4012" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="ATTR(TB.SurveyUntaken)" bold="true" space="1"/>
									<WTSTATIC label="SurveyUntaken" newline="1">
										<WTCONDITION expr="ATTR(TB.SurveyUntaken)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="SurveyUntaken" newline="1">
										<WTCONDITION expr="ATTR(TB.SurveyUntaken)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4012" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(2)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2"/>
							<WTSTATIC col="3" valign="top" backcolor="plum">
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.SuggestionSubmitted)" bold="true" space="1"/>
									<WTSTATIC label="SuggestionSubmitted" newline="1">
										<WTCONDITION expr="ATTR(TB.SuggestionSubmitted)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="SuggestionSubmitted" newline="1">
										<WTCONDITION expr="ATTR(TB.SuggestionSubmitted)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4512" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.SuggestionReplied)" bold="true" space="1"/>
									<WTSTATIC label="SuggestionReplied" newline="1">
										<WTCONDITION expr="ATTR(TB.SuggestionReplied)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="SuggestionReplied" newline="1">
										<WTCONDITION expr="ATTR(TB.SuggestionReplied)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="4512" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(2)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4"/>
							<WTSTATIC col="5" valign="top" backcolor="plum">
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.MessagePosted)" bold="true" space="1"/>
									<WTSTATIC label="MessagePosted" newline="1">
										<WTCONDITION expr="ATTR(TB.MessagePosted)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="MessagePosted" newline="1">
										<WTCONDITION expr="ATTR(TB.MessagePosted)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="8412" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(24)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC value="ATTR(TB.MessageReplied)" bold="true" space="1"/>
									<WTSTATIC label="MessageReplied" newline="1">
										<WTCONDITION expr="ATTR(TB.MessageReplied)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="MessageReplied" newline="1">
										<WTCONDITION expr="ATTR(TB.MessageReplied)" oper="not-equal" value="CONST(0)"/>
										<WTLINK name="8412" nodata="true">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="Mode" value="CONST(25)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Refresh)" align="center">
						<WTCONDITION expr="PARAM(Refresh)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center">
						<WTCONDITION expr="PARAM(ContentPage)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(ContentPage)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="0445" caption="Member Performance" header="false" footer="false" navbar="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0445" track="0">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Options" datatype="text"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTDATATXN name="Performance"/>
			<WTINCLUDE name="MemberOptions.asp"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
<WTCUSTOM>
					reqFromDate = CDate( DateAdd("m", -1, Date()) )
					reqToDate = CDate( Date() )
</WTCUSTOM>				
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTCALLSUB name="reqOptions = GetUserOptions(.FreeOptions, reqOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						<WTCALLSUB name="reqOptions = GetUserOptions(.Options, reqOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						<WTCALLSUB name="reqOptions = GetUserOptions(.Options2, reqOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						<WTCALLSUB name="reqOptions = GetUserOptions(.Options3, reqOptions)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Performance">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Options" direction="input" value="PARAM(Options)"/>
						<WTPARAM name="xmlPerformance" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="75" align="center"/>
				<WTCOLUMN width="225" align="center"/>
				<WTCOLUMN width="75" align="left"/>
				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP><WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="PerformanceStatistics" newline="1"/>
						<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv, '|', /DATA/TXN/PTSMEMBER/@qv)&quot;/&gt;))" fontcolor="blue">
							<WTCONDITION expr="ATTR(Member.QV)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="3" label="From" align="center" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
					<WTBUTTON col="1" value="View" action="0" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1"/>
					<WTTABLE col="2" valign="top" padding="0" style="border: 1px #5084A2 solid">
						<WTCOLUMN width="50" align="center"/>
						<WTCOLUMN width="175" align="left"/>
						
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
								<WTSTATIC fontcolor="darkblue" bold="true">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
									<WTSTATIC value="ATTR(Member.NameLast)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						
						<WTROW margin-bottom="6">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'g'))"/>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'G'))" connector="or"/>
							<WTSTATIC col="1" value="ATTR(Performance.MentorNotes)"/>
							<WTSTATIC col="2" label="MentorNotes"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'H'))"/>
							<WTSTATIC col="1" value="ATTR(Performance.Goals)"/>
							<WTSTATIC col="2" label="Goals"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'h'))"/>
							<WTSTATIC col="1" value="ATTR(Performance.Contacts)"/>
							<WTSTATIC col="2" label="Contacts"/>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'E'))"/>
							<WTROW>
								<WTSTATIC col="1" value="ATTR(Performance.Prospects)"/>
								<WTSTATIC col="2" label="Prospects"/>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" value="ATTR(Performance.ProspectsActive)"/>
								<WTSTATIC col="2" label="ProspectsActive"/>
							</WTROW>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" value="ATTR(Performance.ProspectNotes)"/>
								<WTSTATIC col="2" label="ProspectNotes"/>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, '6'))"/>
							<WTROW>
								<WTSTATIC col="1" value="ATTR(Performance.Customers)"/>
								<WTSTATIC col="2" label="Customers"/>
							</WTROW>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" value="ATTR(Performance.CustomerNotes)"/>
								<WTSTATIC col="2" label="CustomerNotes"/>
							</WTROW>
						</WTCODEGROUP>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'K'))"/>
							<WTSTATIC col="1" value="ATTR(Performance.Courses)"/>
							<WTSTATIC col="2" label="Courses"/>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(contains)" value="CONST((/DATA/PARAM/@options, 'L'))"/>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" value="ATTR(Performance.Assessments)"/>
								<WTSTATIC col="2" label="Assessments"/>
							</WTROW>
							<WTROW margin-bottom="6">
								<WTSTATIC col="1" value="ATTR(Performance.Certifications)"/>
								<WTSTATIC col="2" label="Certifications"/>
							</WTROW>
						</WTCODEGROUP>
						
					</WTTABLE>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0460" caption="Membership Reports" navbar="false" header="false" footer="false" wrapper="wrapper750b"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0460" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="ChartSource" datatype="text"/>
			<WTPARAM name="Unit" datatype="text"/>
			<WTPARAM name="ImageMap" datatype="text"/>
			
			<WTINCLUDE name="ChartURL.asp"/>

      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqReport &lt; 1 OR reqReport &gt; 6 Then reqReport = 1
				If IsDate(reqFromDate) AND IsDate(reqToDate) Then
					tmpDays = DateDiff("d", reqFromDate, reqToDate )
					If tmpDays &lt;= 31 Then reqUnit = "day"
					If tmpDays &gt; 31 AND tmpDays &lt;= 180 Then reqUnit = "week"
					If tmpDays &gt; 180 AND tmpDays &lt;= 365 Then reqUnit = "month"
					If tmpDays &gt; 365 Then reqUnit = "quarter"
				Else
					reqFromDate = CDate( DateAdd("d", -1, Date()) )
					reqToDate = CDate( Date() )
					reqUnit = "day"	
				End If
</WTCUSTOM>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ReportMembership">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportNewEnrollment">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Unit" direction="input" value="PARAM(Unit)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportTotalEnrollment">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Unit" direction="input" value="PARAM(Unit)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportBilling">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportVisit">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
						<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportVisitStatus">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
						<WTCONDITION expr="PARAM(Option)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Option)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportAuthLog">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(6)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
<WTCUSTOM>
				tmpData = ""
				tmpLabels = ""
				Dim extraData
				ReDim extraData(oMembers.Count)
				counter = LBound(extraData)
				For Each oMember in oMembers
					With oMember
						If reqReport &lt;&gt; 6 Then reqCount = reqCount + .Quantity
						Select Case reqReport
						Case 1:
							tmpLabels = tmpLabels + .Status + "|"
							tmpData = tmpData + .Quantity + "|"
							extraData(counter) = .MemberID
						Case 2:
							.EnrollDate = FormatDateTime(.EnrollDate,2)
							tmpLabels = tmpLabels + Left(.EnrollDate,Len(.EnrollDate)-5) + "|"
							tmpData = tmpData + .Quantity + "|"
						Case 3:
							.EnrollDate = FormatDateTime(.EnrollDate,2)
							tmpLabels = tmpLabels + Left(.EnrollDate,Len(.EnrollDate)-5) + "|"
							tmpData = tmpData + .Quantity + "|"
						Case 4:
							tmpLabels = tmpLabels + .Billing + "|"
							tmpData = tmpData + .Quantity + "|"
							extraData(counter) = .MemberID
						Case 5:
							tmpLabels = tmpLabels + .Amount + "|"
							tmpData = tmpData + .Quantity + "|"
							extraData(counter) = .MemberID
						Case 6:
							reqCount = reqCount + 1
						End Select
					End With
					counter = counter + 1
				Next

				'Remove last | delimiter
				If tmpData &lt;&gt; "" And Right(tmpData,1) = "|" Then tmpData = Left(tmpData, Len(tmpData)-1 )
				If tmpLabels &lt;&gt; "" And Right(tmpLabels,1) = "|" Then tmpLabels = Left(tmpLabels, Len(tmpLabels)-1 )

				reqCount = FormatNumber(reqCount,0)
				tmpImageMapURL = "0461.asp?Report=" &amp; reqReport &amp; "&amp;FromDate=" &amp; reqFromDate &amp; "&amp;ToDate=" &amp; reqToDate &amp; "&amp;CompanyID=" &amp; reqCompanyID &amp; "&amp;Option=" &amp; reqOption

				'---ChartURL( Type, Width, Height, StartDate, EndDate, Unit, LangFile, Data, Title, XTitle, YTitle )
				Select Case reqReport
				Case 1:
					ChartLabels "0460Chart1", tmpLabels, "", "", "", ""
					reqChartSource = ChartImageMap( "pie", 750, 400, "", "", "", tmpData, tmpLabels, "", "", "", extraData, reqImageMap, tmpImageMapURL)
				Case 2:
					reqChartSource = "Chart.asp?type=line&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;labels=" + tmpLabels
				Case 3:
					reqChartSource = "Chart.asp?type=bar&amp;width=750&amp;height=400&amp;data=" + tmpData + "&amp;labels=" + tmpLabels
				Case 4:
					ChartLabels "0460Chart2", tmpLabels, "", "", "", ""
					reqChartSource = ChartImageMap( "pie", 750, 400, "", "", "", tmpData, tmpLabels, "", "", "", extraData, reqImageMap, tmpImageMapURL)
				Case 5:
					ChartLabels "0460Chart3", tmpLabels, "", "", "", ""
					reqChartSource = ChartImageMap( "pie", 750, 400, "", "", "", tmpData, tmpLabels, "", "", "", extraData, reqImageMap, tmpImageMapURL)
				End Select
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(6)"/>
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="600" align="left"/>
				
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="AllMembers" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" value="ATTR(Company.CompanyName)" class="PageHeading" align="center"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="MembershipReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" label="NewEnrollmentReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(3)"/>
					<WTSTATIC col="1" merge="2" label="TotalEnrollmentReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
					<WTSTATIC col="1" merge="2" label="BillingReport" class="PageHeading" align="center"/>
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="VisitReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
							<WTSTATIC label="AllMemberships">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC label="Paid">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="Trial">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
							<WTSTATIC label="Free">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(6)"/>
					<WTSTATIC col="1" merge="2" label="AuthLogReport" class="PageHeading" align="center"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="not-equal" value="CONST(5)"/>
					<WTCONDITION expr="PARAM(Report)" oper="not-equal" value="CONST(6)" connector="and"/>
					<WTSTATIC col="1" merge="2" align="center" class="BoldText">
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>
				
				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Count)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="NoReportData" class="PageHeading" align="center"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>

					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(Report)" oper="not-equal" value="CONST(6)"/>
						<WTCONDITION expr="PARAM(ImageMap)" oper="equal" value="CONST('')" connector="and"/>
						<WTIMAGE col="1" merge="2" align="center" value="PARAM(ChartSource)" path="../.."/>
					</WTROW>
				
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(ImageMap)" oper="not-equal" value="CONST('')"/>
						<WTIMAGE col="1" merge="2" align="center" value="PARAM(ChartSource)" path="charts" usemap="Map1"/>
						<WTMAP col="1" merge="2" align="center" name="Map1" areahtml="PARAM(ImageMap)"/>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Report)" oper="not-equal" value="CONST(3)"/>
						<WTCONDITION expr="PARAM(Report)" oper="not-equal" value="CONST(6)" connector="and"/>
						<WTSTATIC col="1" merge="2" align="center" tag="TotalMembers" value="PARAM(Count)" class="PageHeading"/>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(6)"/>
						<WTROW>
							<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
								<WTCOLUMN width="10" align="left" valign="top" label="#"/>
								<WTCOLUMN width="40" align="left" valign="top" label="MemberName"/>
								<WTCOLUMN width="40" align="left" valign="top" label="CompanyName"/>
								<WTCOLUMN width="10" align="right" valign="top" label="Quantity"/>
								<WTROW>
									<WTCONDITION expr="DATA(Member.MemberID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC col="1" value="DATA(Member.MemberID)">
										<WTLINK name="0403" target="Member">
											<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="2" value="DATA(Member.MemberName)">
										<WTLINK name="0403" target="Member">
											<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="3" value="DATA(Member.CompanyName)"/>
									<WTSTATIC col="4" value="DATA(Member.Quantity)"/>
								</WTROW>
							</WTRECORDSET>
						</WTROW>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="2" align="left" label="ExemptMembers" class="PageHeading"/>
						</WTROW>
						<WTROW>
							<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
								<WTCOLUMN width="10" align="left" valign="top" label="#"/>
								<WTCOLUMN width="40" align="left" valign="top" label="MemberName"/>
								<WTCOLUMN width="40" align="left" valign="top" label="CompanyName"/>
								<WTCOLUMN width="10" align="right" valign="top" label="Quantity"/>
								<WTROW>
									<WTCONDITION expr="DATA(Member.MemberID)" oper="less" value="CONST(0)"/>
									<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;@memberid*-1&quot;/&gt;)">
										<WTLINK name="0403" target="Member">
											<WTPARAM name="MemberID" value="CONST(&lt;xsl:value-of select=&quot;@memberid*-1&quot;/&gt;)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="2" value="DATA(Member.MemberName)">
										<WTLINK name="0403" target="Member">
											<WTPARAM name="MemberID" value="CONST(&lt;xsl:value-of select=&quot;@memberid*-1&quot;/&gt;)"/>
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC col="3" value="DATA(Member.CompanyName)"/>
									<WTSTATIC col="4" value="DATA(Member.Quantity)"/>
								</WTROW>
							</WTRECORDSET>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="2" align="left" tag="TotalMembers" value="PARAM(Count)" class="PageHeading"/>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0461" caption="Membership Detail Reports" navbar="false" language="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0461" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="IDField" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Unit" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqReport &lt;&gt; 1 AND reqReport &lt;&gt; 4  AND reqReport &lt;&gt; 5 Then reqReport = 1
				Select Case reqReport
				Case 1: reqUnit = "Status" &amp; reqIDField
				Case 4: reqUnit = "Billing" &amp; reqIDField
				Case 5: reqUnit = "Visit" &amp; reqIDField
				End Select
</WTCUSTOM>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="ReportMembershipDetail">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(IDField)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportBillingDetail">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Billing" direction="input" value="PARAM(IDField)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportVisitDetail">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
						<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="IDField" direction="input" value="PARAM(IDField)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportVisitDetailStatus">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
						<WTCONDITION expr="PARAM(Option)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="IDField" direction="input" value="PARAM(IDField)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Option)"/>
					</WTMETHOD>
<WTCUSTOM>
				xmlData = ""
				For Each oMember in oMembers
					reqCount = reqCount + 1
				Next
				reqCount = FormatNumber(reqCount,0)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="600" align="left"/>

				<WTSTATIC label="Status0"/>
				<WTSTATIC label="Status1"/>
				<WTSTATIC label="Status2"/>
				<WTSTATIC label="Status3"/>
				<WTSTATIC label="Status4"/>
				<WTSTATIC label="Status5"/>
				<WTSTATIC label="Billing0"/>
				<WTSTATIC label="Billing1"/>
				<WTSTATIC label="Billing2"/>
				<WTSTATIC label="Billing3"/>
				<WTSTATIC label="Billing4"/>
				<WTSTATIC label="Billing5"/>
				<WTSTATIC label="Visit1"/>
				<WTSTATIC label="Visit3"/>
				<WTSTATIC label="Visit7"/>
				<WTSTATIC label="Visit14"/>
				<WTSTATIC label="Visit30"/>
				<WTSTATIC label="Visit31"/>
				<WTSTATIC label="Visit32"/>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="AllMembers" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" value="ATTR(Company.CompanyName)" class="PageHeading" align="center"/>
				</WTROW>
				
				<WTROW margin-bottom="3">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="MembershipReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(4)"/>
					<WTSTATIC col="1" merge="2" label="BillingReport" class="PageHeading" align="center"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="VisitReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
							<WTSTATIC label="AllMemberships">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(0)"/>
							</WTSTATIC>
							<WTSTATIC label="Paid">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(1)"/>
							</WTSTATIC>
							<WTSTATIC label="Trial">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(2)"/>
							</WTSTATIC>
							<WTSTATIC label="Free">
								<WTCONDITION expr="PARAM(Option)" oper="equal" value="CONST(3)"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" merge="2" label="PARAM(Unit)" class="PageHeading" align="center"/>
				</WTROW>

				<WTROW margin-bottom="3">
					<WTCONDITION expr="PARAM(Report)" oper="not-equal" value="CONST(5)"/>
					<WTSTATIC col="1" merge="2" align="center" class="BoldText">
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Member">
						<WTCOLUMN width="8" align="left" valign="top" label="#"/>
						<WTCOLUMN width="35" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="35" align="left" valign="top" label="CompanyName"/>
						<WTCOLUMN width="22" align="left" valign="top"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Member.MemberID)"/>
							<WTSTATIC col="2" value="DATA(Member.MemberName)">
								<WTLINK name="0403" target="Member">
									<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Member.CompanyName)"/>
							<WTSTATIC col="4">
								<WTSTATIC value="DATA(Member.VisitDate)">
									<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(5)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTCODEGROUP>
					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="2" align="left" tag="TotalMembers" value="PARAM(Count)" class="PageHeading"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="0450" caption="Mentor Team" langfile="0450"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Level" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="MentorTeam">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="left"/>
				<WTCOLUMN width="50" align="left"/>
				<WTCOLUMN width="50" align="left"/>
				<WTCOLUMN width="50" align="left"/>
				<WTCOLUMN width="275" align="left"/>
				<WTCOLUMN width="150" align="right"/>

				<WTSTATIC label="mentoring"/>
				<WTSTATIC label="ViewMentor"/>
<!--
				<WTROW>
					<WTSTATIC col="1" merge="5" class="PageHeading" align="left">
						<WTSTATIC tag="MentorTeam"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
					<WTSTATIC col="6" label="LinkMentor" class="PageHeading" align="right">	
					 	<WTCONDITION expr="SYS(Memberid)" oper="not-equal" value="PARAM(MemberID)"/>
					 	<WTCONDITION expr="ATTR(Member.MentorID)" oper="greater" value="CONST(0)" connector="and"/>
					 	<WTLINK name="0450" return="false">
					 		<WTPARAM name="MemberID" value="ATTR(Member.MentorID)"/>
					 		<WTPARAM name="Level" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level - 1&quot;/&gt;)"/>
					 	</WTLINK>					 	
					</WTSTATIC>
				</WTROW>
-->
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" merge="3" value="CONST(mentoringteamlg.gif)" align="center"/>
					<WTTABLE col="4" merge="3">
						<WTCOLUMN width="425" align="left"/>
						<WTROW>
							<WTSTATIC col="1" align="center" class="PageHeading">
								<WTSTATIC tag="MentorTeam"/>
								<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
								<WTSTATIC value="ATTR(Member.NameLast)"/>
								<WTSTATIC>	
					 				<WTCONDITION expr="SYS(Memberid)" oper="not-equal" value="PARAM(MemberID)"/>
					 				<WTCONDITION expr="ATTR(Member.MentorID)" oper="greater" value="CONST(0)" connector="and"/>
									<WTSTATIC space="2"/>	
									<WTCODEGROUP>
										<WTIMAGE value="CONST(mentoringteam.gif)" alt="ViewMentor" imgalign="absmiddle">
					 						<WTLINK name="0450" return="false">
					 							<WTPARAM name="MemberID" value="ATTR(Member.MentorID)"/>
					 							<WTPARAM name="Level" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level - 1&quot;/&gt;)"/>
					 						</WTLINK>					 	
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC space="2"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(mentormd.gif)" alt="mentoring" imgalign="absmiddle">
					 					<WTLINK name="0410" return="false">
					 						<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
					 						<WTPARAM name="M" value="ATTR(Member.MentorID)"/>
					 					</WTLINK>					 	
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" label="MentorTeamText" class="prompt"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Count)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="6" label="NoMentorTeam" class="PageHeading" align="center"/>
				</WTROW>

				<WTREPEAT entity="Member">
					<WTFILTER name="DATA(Member.MentorID)" oper="equal" value="PARAM(MemberID)"/>	
					<WTROW class="graybar">
						<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 1&quot;/&gt;)" valign="top"/>
						<WTSTATIC col="2" merge="5">
							<WTSTATIC value="DATA(Member.CompanyName)" bold="true" space="1">
								<WTLINK name="0450" return="false">
								<WTPARAM name="MemberID" value="DATA(Member.MemberID)"/><WTPARAM name="Level" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 1&quot;/&gt;)"/></WTLINK>
							</WTSTATIC>
							<WTSTATIC value="DATA(Member.Phone1)" space="1"/>
							<WTSTATIC value="DATA(Member.Email)" space="1">
								<WTLINK name="DATA(Member.Email)" type="mail"/>
							</WTSTATIC>
							<WTSTATIC value="DATA(Member.EnrollDate)" space="1"/>
							<WTSTATIC value="DATA(Member.VisitDate)" fontcolor="purple"/>
						</WTSTATIC>
					</WTROW>

					<WTREPEAT entity="Member">
						<WTFILTER name="DATA(Member.MentorID)" oper="equal" value="DATA(Current.MemberID)"/>
						<WTROW>
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 2&quot;/&gt;)" valign="top"/>
							<WTSTATIC col="2"/>
							<WTSTATIC col="3" merge="4">
								<WTSTATIC value="DATA(Member.CompanyName)" bold="true" space="1">
									<WTLINK name="0450" return="false"><WTPARAM name="MemberID" value="DATA(Member.MemberID)"/><WTPARAM name="Level" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 2&quot;/&gt;)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="DATA(Member.Phone1)" space="1"/>
								<WTSTATIC value="DATA(Member.Email)" space="1">
									<WTLINK name="DATA(Member.Email)" type="mail"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Member.EnrollDate)" space="1"/>
								<WTSTATIC value="DATA(Member.VisitDate)" fontcolor="purple"/>
							</WTSTATIC>
						</WTROW>

						<WTREPEAT entity="Member">
							<WTFILTER name="DATA(Member.MentorID)" oper="equal" value="DATA(Current.MemberID)"/>
							<WTROW class="graybar">
								<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 3&quot;/&gt;)" valign="top"/>
								<WTSTATIC col="2" merge="2"/>
								<WTSTATIC col="4" merge="3">
									<WTSTATIC value="DATA(Member.CompanyName)" bold="true" space="1">
										<WTLINK name="0450" return="false"><WTPARAM name="MemberID" value="DATA(Member.MemberID)"/><WTPARAM name="Level" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 3&quot;/&gt;)"/></WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Member.Phone1)" space="1"/>
									<WTSTATIC value="DATA(Member.Email)" space="1">
										<WTLINK name="DATA(Member.Email)" type="mail"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Member.EnrollDate)" space="1"/>
									<WTSTATIC value="DATA(Member.VisitDate)" fontcolor="purple"/>
								</WTSTATIC>
							</WTROW>

							<WTREPEAT entity="Member">
								<WTFILTER name="DATA(Member.MentorID)" oper="equal" value="DATA(Current.MemberID)"/>
								<WTROW>
									<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 4&quot;/&gt;)" valign="top"/>
									<WTSTATIC col="2" merge="3"/>
									<WTSTATIC col="5" merge="2">
										<WTSTATIC value="DATA(Member.CompanyName)" bold="true" space="1">
											<WTLINK name="0450" return="false"><WTPARAM name="MemberID" value="DATA(Member.MemberID)"/><WTPARAM name="Level" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 4&quot;/&gt;)"/></WTLINK>
										</WTSTATIC>
										<WTSTATIC value="DATA(Member.Phone1)" space="1"/>
										<WTSTATIC value="DATA(Member.Email)" space="1">
											<WTLINK name="DATA(Member.Email)" type="mail"/>
										</WTSTATIC>
										<WTSTATIC value="DATA(Member.EnrollDate)" space="1"/>
										<WTSTATIC value="DATA(Member.VisitDate)" fontcolor="purple"/>
									</WTSTATIC>
								</WTROW>
				
							</WTREPEAT>
						</WTREPEAT>
					</WTREPEAT>
				</WTREPEAT>

				<WTROW margin-top="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="12">
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="6" align="left" tag="TotalMembers" value="PARAM(Count)"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0451" caption="Team Members" action="5" navbar="false" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--==================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Max" datatype="number"/>
			<WTPARAM name="RemoveID" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(RemoveID)" oper="not-equal" value="CONST(0)"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="RemoveMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(RemoveID)"/>
						<WTPARAM name="Status" direction="input" value="SYSCON(REMOVE-GROUP)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>
		   
			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(MemberName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XMLFind">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
				<WTMETHOD name="FindGroup">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="GroupID" direction="input" value="PARAM(GroupID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XMLFind">
					<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTFUNCTION name="ViewMember(id)">
					var url, win;
					url = "0421.asp?memberid=" + id
		            win = window.open(url,"MemberInfo","top=100,left=100,height=200,width=330,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTSTATIC label="TeamStats"/>
				<WTSTATIC label="ViewInfo"/>
				<WTSTATIC label="GroupAdmin"/>
				<WTSTATIC label="RemoveGroup"/>
				<WTSTATIC label="PaidMembership"/>
				<WTSTATIC label="TrialMembership"/>
				<WTSTATIC label="FreeMembership"/>
				<WTSTATIC label="SuspendedMembership"/>

				<WTROW>
					<WTSTATIC col="1" label="TeamMembers" class="PageHeading" align="left"/>
				</WTROW>
					
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Members.FindTypeID)" translate="true">
						<WTOPTION id="419" label="MemberName"/>
						<WTOPTION id="401" label="MemberID"/>
						<WTOPTION id="430" label="Email"/>
						<WTOPTION id="435" label="Status"/>
						<WTOPTION id="438" label="EnrollDate"/>
						<WTOPTION id="471" label="Role"/>
					</WTCOMBO>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
					<WTIMAGE col="1" value="CONST(performance32.gif)" alt="TeamStats" imgalign="absmiddle">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTLINK name="12203" nodata="true" target="GroupStats"><WTPARAM name="GroupID" value="PARAM(GroupID)"/></WTLINK>
					</WTIMAGE>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="true" entity="Member">
						<WTCOLUMN width="30" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="35" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="8" align="center" valign="top" label="Status"/>
						<WTCOLUMN width="12" align="center" valign="top" label="EnrollDate"/>
						<WTCOLUMN width="15" align="center" valign="top" label="VisitDate"/>
<!--						<WTCOLUMN width="4" align="right" valign="top"/>-->
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Member.MemberName)" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview.gif)" alt="ViewInfo" imgalign="absmiddle">
										<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Member.Email)"/>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Status1.gif)" alt="PaidMembership" imgalign="absmiddle"/>
									<WTCONDITION expr="DATA(Member.Status)" oper="less" value="SYSCON(MEMBER-TRIAL)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Status2.gif)" alt="TrialMembership" imgalign="absmiddle"/>
									<WTCONDITION expr="DATA(Member.Status)" oper="equal" value="SYSCON(MEMBER-TRIAL)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Status3.gif)" alt="FreeMembership" imgalign="absmiddle"/>
									<WTCONDITION expr="DATA(Member.Status)" oper="equal" value="SYSCON(MEMBER-FREE)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Status4.gif)" alt="SuspendedMembership" imgalign="absmiddle"/>
									<WTCONDITION expr="DATA(Member.Status)" oper="greater" value="SYSCON(MEMBER-FREE)"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Member.Level)"/>
							</WTSTATIC>
							<WTSTATIC col="4" value="DATA(Member.EnrollDate)"/>
							<WTSTATIC col="5" value="DATA(Member.VisitDate)"/>
<!--							
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="DATA(MemberID)"/>
									<WTIMAGE value="CONST(GrpAdmin.gif)" alt="GroupAdmin" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="DATA(MemberID)"/>
									<WTIMAGE value="CONST(Trash.gif)" alt="RemoveGroup" imgalign="absmiddle">
										<WTLINK name="0451" return="false">
											<WTPARAM name="GroupID" value="PARAM(GroupID)"/>
											<WTPARAM name="RemoveID" value="DATA(MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
-->
						</WTROW>
					</WTRECORDSET>
				</WTROW>
<!--				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
-->
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0470" caption="Sales Team" header="false" navbar="false" footer="false" langfile="0470" wrapper="wrapper750"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52" track="0">
		<!--============================================================================================-->
			<WTPARAM name="Line" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Level" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="ParentID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Levels" datatype="number"/>
			<WTPARAM name="Only" datatype="number"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="QV" datatype="number"/>
			<WTPARAM name="URL" datatype="text"/>
			<WTPARAM name="Install" datatype="number"/>
			<WTPARAM name="Downline1" datatype="number"/>
			<WTPARAM name="Downline2" datatype="number"/>
			<WTPARAM name="Downline3" datatype="number"/>
			<WTPARAM name="Downline4" datatype="number"/>
			<WTPARAM name="Downline5" datatype="number"/>
			<WTPARAM name="DownlineB" datatype="number"/>
<!--		<WTPARAM name="Total" datatype="number"/>-->
      <WTPARAM name="Dashboard" datatype="text"/>

      <WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="SearchType" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="Err" datatype="number"/>
			<WTPARAM name="TopMemberID" datatype="number"/>

			<WTPARAM name="MemberBV" datatype="text"/>
			<WTPARAM name="MemberQV" datatype="text"/>
			<WTPARAM name="ViewInfo" datatype="number"/>
			<WTPARAM name="ViewCodes" datatype="number"/>

			<WTPARAM name="MemberDesc" datatype="text"/>
			<WTPARAM name="Lines" datatype="text"/>
			<WTPARAM name="Binary" datatype="number"/>
			<WTPARAM name="QVLeft" datatype="text"/>
			<WTPARAM name="QVRight" datatype="text"/>
			<WTPARAM name="BVLeft" datatype="text"/>
			<WTPARAM name="BVRight" datatype="text"/>

			<WTDATATXN name="Level0"/>
			<WTDATATXN name="Level1"/>
			<WTDATATXN name="Level2"/>
			<WTDATATXN name="Level3"/>

			<WTJAVASCRIPT name="jquery-1.5.1.min.js"/>
			<WTJAVASCRIPT name="wz_jsgraphics.js"/>
<!--
			<WTSTYLESHEET name="jquery.shadow.css"/>
			<WTJAVASCRIPT name="jquery-corner.js"/>
			<WTJAVASCRIPT name="jquery.shadow.js"/>
-->

      <!-- CHECK FOR ILLEGAL ACCESS -->
			<WTSUB name="CheckUpline">
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(1)"/>
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)" connector="or"/>
						<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
							<WTMETHOD name="CheckUpline">
								<WTPARAM name="SponsorID" direction="input" value="SYS(MemberID)"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="Status" direction="input" value="PARAM(Line)"/>
								<WTPARAM name="Result" direction="return" datatype="number"/>
							</WTMETHOD>
						</WTOBJECT>
						<WTRETURN>
							<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
							<WTLINK name="0101" return="false">
								<WTPARAM name="ActionCode" value="CONST(9)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="SetCompanyOptions">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
					<WTSETATTRIBUTE name="PARAM(ViewCodes)" value="CONST(7)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(13)"/>
					<WTSETATTRIBUTE name="PARAM(ViewCodes)" value="CONST(5)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(14)"/>
          <WTSETATTRIBUTE name="PARAM(ViewCodes)" value="CONST(6)"/>
          <WTSETATTRIBUTE name="PARAM(Dashboard)" value="CONST(&quot;13504&quot;)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(17)"/>
          <WTSETATTRIBUTE name="PARAM(ViewCodes)" value="CONST(6)"/>
          <WTSETATTRIBUTE name="PARAM(Dashboard)" value="CONST(&quot;13804&quot;)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
          <WTSETATTRIBUTE name="PARAM(ViewCodes)" value="CONST(2)"/>
          <WTSETATTRIBUTE name="PARAM(Dashboard)" value="CONST(&quot;13904&quot;)"/>
        </WTCODEGROUP>
      </WTSUB>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Err)" oper="equal" value="CONST(1)"/>
				<WTERROR number="10121" message="Oops, Downline member not found. Be more specific."/>
			</WTCODEGROUP>
			<WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(SearchType)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(SearchType)" value="CONST(1)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(TopMemberID)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(TopMemberID)" value="PARAM(MemberID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsEmployee"/>
				<WTSETATTRIBUTE name="PARAM(ViewInfo)" value="CONST(1)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTGETCACHE name="CONST(Options2)" value="OPTIONS2" />
				<WTSETATTRIBUTE name="PARAM(ViewInfo)" value="CONST(1)">
					<WTCONDITION expr="CONST(InStr(Options2,&quot;V&quot;))" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
<WTCUSTOM>
reqInstall = GetCache("INSTALL")
If reqSysUserGroup = 0 OR reqSysUserGroup &gt; 52 Then
	Response.write "Unauthorized Access!" 
	Response.end
End If	
</WTCUSTOM>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
<WTCUSTOM>
If reqLine = 0 Then
'	reqLine = 2 
	reqDownline1 = 1
	reqDownline2 = 1
	reqDownline3 = 1
	reqDownline4 = 1
	reqDownline5 = 1
End If
</WTCUSTOM>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Levels)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Levels)" value="CONST(1)"/>
			</WTCODEGROUP>

			<WTSUB name="GetDownlines">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						Downlines = .TBPage
						If Downlines &lt;&gt; "" Then
							If InStr(Downlines, "1" ) &gt; 0 Then reqDownline1 = 1 Else reqDownline1 = 0
							If InStr(Downlines, "2" ) &gt; 0 Then reqDownline2 = 1 Else reqDownline2 = 0
							If InStr(Downlines, "3" ) &gt; 0 Then reqDownline3 = 1 Else reqDownline3 = 0
							If InStr(Downlines, "4" ) &gt; 0 Then reqDownline4 = 1 Else reqDownline4 = 0
							If InStr(Downlines, "5" ) &gt; 0 Then reqDownline5 = 1 Else reqDownline5 = 0
							If InStr(Downlines, "B" ) &gt; 0 Then reqDownlineB = 1 Else reqDownlineB = 0
							If reqLine = 0 Then
								pos = InStr(Downlines, "*" )
								If pos &gt; 0 Then
									reqLine = CLng( MID(Downlines, pos+1, 1) )
									If reqLine = 5 Then
										If InStr( Downlines, "5" ) = 0 And InStr( Downlines, "B" ) = 0 Then
											reqLine = Left(DownLines, 1 )
										End If
									Else
										If InStr( Downlines, CStr(reqLine) ) = 0 Then
											reqLine = Left(DownLines, 1 )
										End If
									End If
								End If	
							End If
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCoption" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB function="BuildTree( oSrc, MemberID, Pos, Level )">
				<WTCUSTOM>
					tmpNode = ""
					For Each oItem In oSrc.selectNodes("/PTSMEMBERS/PTSMEMBER[@sponsorid=" + CStr(MemberID) + " and @phone1=" + Cstr(Pos) + "]" )
					If tmpNode = "" Then
					With oItem
					attrMemberID = .getAttribute("memberid")
					attrMemberName = .getAttribute("membername")
					attrEnrollDate = .getAttribute("enrolldate")
					attrVisitDate = .getAttribute("visitdate")
					attrStatus = .getAttribute("status")
					attrTitle = .getAttribute("title")
					attrBV = .getAttribute("bv")
					attrQV = .getAttribute("qv")
					attrQualify = .getAttribute("email")
					attrIdentification = .getAttribute("identification")
					End With
					pos = InStr(attrMemberName, " " )
					If pos = 0 Then tmpFirst = attrMemberName Else tmpFirst = Left(attrMemberName, pos-1)
					attrMemberName = CleanXML( attrMemberName )
					attrIdentification = CleanXML( attrIdentification )
					tmpFirst = CleanXML( tmpFirst )
					tmpQV = FormatCurrency(attrQV, 0)
					tmpBV = FormatNumber(attrBV, 0)
					tmpNode = "&lt;NODE"
							tmpNode = tmpNode &amp; " memberid=""" &amp; attrMemberID &amp; """ first=""" &amp; tmpFirst &amp; """ status=""" &amp; attrStatus &amp; """ qualify=""" &amp; attrQualify &amp; """ title=""" &amp; attrTitle &amp; """"
							tmpNode = tmpNode &amp; " desc=""" &amp; attrMemberName &amp; " (#" &amp; attrMemberID &amp; ") " &amp; tmpBV &amp; "|" &amp; tmpQV &amp; " - " &amp; attrIdentification &amp; " - " &amp; attrEnrollDate &amp; " - " &amp; attrVisitDate &amp; """"
							tmpNode = tmpNode &amp; "/&gt;"

							If Level = 0 Then
								xmlLevel0 = xmlLevel0 + tmpNode
								tmpLevel0Cnt = tmpLevel0Cnt + 1
								tmpCnt = tmpLevel0Cnt
							End If
							If Level = 1 Then
								xmlLevel1 = xmlLevel1 + tmpNode
								tmpLevel1Cnt = tmpLevel1Cnt + 1
								tmpCnt = tmpLevel1Cnt
							End If
							If Level = 2 Then
								xmlLevel2 = xmlLevel2 + tmpNode
								tmpLevel2Cnt = tmpLevel2Cnt + 1
								tmpCnt = tmpLevel2Cnt
							End If
							If Level = 3 Then
								xmlLevel3 = xmlLevel3 + tmpNode
								tmpLevel3Cnt = tmpLevel3Cnt + 1
								tmpCnt = tmpLevel3Cnt
							End If
							If reqLines &lt;&gt; "" Then reqLines = reqLines + "|"
							reqLines = reqLines + CStr(Level) + "," + CStr(tmpCnt)
							If Level &lt; 3 Then
								BuildTree oSrc, attrMemberID, 0, Level + 1
								BuildTree oSrc, attrMemberID, 1, Level + 1
							End If
						End If
					Next
					If tmpNode = "" Then
						If Level = 0 Then
							xmlLevel0 = xmlLevel0 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel0Cnt = tmpLevel0Cnt + 1
							xmlLevel1 = xmlLevel1 + "&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel1Cnt = tmpLevel1Cnt + 2
							xmlLevel2 = xmlLevel2 + "&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel2Cnt = tmpLevel2Cnt + 4
							xmlLevel3 = xmlLevel3 + "&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 8
							tmpCnt = tmpLevel0Cnt
						End If
						If Level = 1 Then
							xmlLevel1 = xmlLevel1 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel1Cnt = tmpLevel1Cnt + 1
							xmlLevel2 = xmlLevel2 + "&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel2Cnt = tmpLevel2Cnt + 2
							xmlLevel3 = xmlLevel3 + "&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 4
							tmpCnt = tmpLevel1Cnt
						End If
						If Level = 2 Then
							xmlLevel2 = xmlLevel2 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel2Cnt = tmpLevel2Cnt + 1
							xmlLevel3 = xmlLevel3 + "&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 2
							tmpCnt = tmpLevel2Cnt
						End If
						If Level = 3 Then
							xmlLevel3 = xmlLevel3 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 1
							tmpCnt = tmpLevel3Cnt
						End If
						If reqLines &lt;&gt; "" Then reqLines = reqLines + "|"
						reqLines = reqLines + CStr(Level) + "," + CStr(tmpCnt)
					End If
				</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
<!--				
				<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
				</WTSETATTRIBUTE>
-->				
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="less" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpStatus)" value="CONST(1001)">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(-1)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="CONST(tmpStatus)" value="CONST(1002)">
							<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(-2)"/>
						</WTSETATTRIBUTE>
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="MemberID" direction="input" value="PARAM(TopMemberID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(tmpStatus)"/>
							<WTPARAM name="reqMemberID" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTCALLSUB name="SetCompanyOptions"/>
					<WTCALLSUB name="GetDownlines"/>
<WTCUSTOM>
	reqMemberDesc =  .NameFirst + " " + .NameLast + " (#" + .MemberID + ") " + .EnrollDate + " - " + .VisitDate
	reqURL = "Sections/Company/" &amp; reqCompanyID &amp; "/CompPlan.pdf"
	tmpOptions = .Options2
	If reqCompanyID = 9 Then
		tmpB = InStr( tmpOptions, "B" )
		If tmpB = 0 Then
			reqDownlineB = 0
			If reqLine = 0 Then reqLine = 1
		Else
			reqDownlineB = 1
			If reqLine = 0 Then reqLine = 5
		End If
	End If
	reqMemberBV = FormatCurrency(.BV2, 0 )
	reqMemberQV = FormatCurrency(.QV2, 0 )
</WTCUSTOM>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(ReferralID)">
		 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-ENROLLER)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(SponsorID)">
		 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(MentorID)">
		 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-MENTOR)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(Sponsor2ID)">
		 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR2)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(Sponsor3ID)">
		 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR3)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR3)"/>
						<WTCONDITION expr="PARAM(DownlineB)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(Binary)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="PARAM(Levels)" value="CONST(4)"/>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(1000)"/>
							<WTPARAM name="Result" direction="return" datatype="text"/>
						</WTMETHOD>
						<WTCODEGROUP>
							<WTCUSTOM>
								If InStr( Result, ",") &gt; 0 Then
								a = Split(Result, ",")
								reqQVLeft = FormatCurrency(a(0),0)
								reqQVRight = FormatCurrency(a(1),0)
								reqBVLeft = FormatNumber(a(2),0)
								reqBVRight = FormatNumber(a(3),0)
								End If
							</WTCUSTOM>
						</WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTCALLSUB name="CheckUpline"/>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="Genealogy">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Line)"/>
						<WTPARAM name="Level" direction="input" value="PARAM(Levels)"/>
						<WTPARAM name="Title" direction="input" value="PARAM(Title)"/>
						<WTPARAM name="QV" direction="input" value="PARAM(QV)"/>
					</WTMETHOD>
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR)"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)" connector="and"/>
<WTCUSTOM>
	For Each oItem in oMembers
		With oItem
			aValue = split(.Phone1, ",")
			.BV4 = aValue(0) 'downline count
			.BusAccts = aValue(1) 'sponsor team
			.MaxMembers = aValue(2)   'leg title
		End With
	Next
</WTCUSTOM>
					</WTCODEGROUP>
-->					
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XMLGenealogy">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
						<WTCUSTOM>
							Set oSrc = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
							oSrc.loadXML xmlMembers
							xmlLevel0 = "&lt;NODES level=""0""&gt;"
							xmlLevel1 = "&lt;NODES level=""1""&gt;"
							xmlLevel2 = "&lt;NODES level=""2""&gt;"
							xmlLevel3 = "&lt;NODES level=""3""&gt;"
							reqLines = ""
							tmpLevel0Cnt = 0
							tmpLevel1Cnt = 0
							tmpLevel2Cnt = 0
							tmpLevel3Cnt = 0
							BuildTree oSrc, reqMemberID, 0, 0
							BuildTree oSrc, reqMemberID, 1, 0
							xmlLevel0 = xmlLevel0 + "&lt;/NODES&gt;"
							xmlLevel1 = xmlLevel1 + "&lt;/NODES&gt;"
							xmlLevel2 = xmlLevel2 + "&lt;/NODES&gt;"
							xmlLevel3 = xmlLevel3 + "&lt;/NODES&gt;"
							Set oSrc = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="MemberTitles" project="ptsMemberTitleUser" class="CMemberTitles">
					<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="ListMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XMLGenealogy">
						<WTPARAM name="xmlMemberTitles" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Titles" project="ptsTitleUser" class="CTitles">
					<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlTitles" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="5" name="Find" type="Find">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="SearchDownline">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SponsorID" direction="input" value="PARAM(TopMemberID)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(SearchType)"/>
						<WTPARAM name="MemberName" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Level" direction="input" value="PARAM(Line)"/>
						<WTPARAM name="Result" direction="return" datatype="text"/>
					</WTMETHOD>
<WTCUSTOM>
SearchError = 0
aResult = Split(Result, ":" )
If aResult(0) &lt;&gt; "0" Then
	reqMemberID = CLng(aResult(0))
	reqPos = CLng(aResult(1))
	reqLevel = CLng(aResult(2))
Else
	SearchError = 1
End If
url = "0470.asp?memberid=" + CSTR(reqMemberID) + "&amp;level=" + CSTR(reqLevel) + "&amp;line=" + CSTR(reqLine) + "&amp;levels=" + CSTR(reqLevels) + "&amp;only=" + CSTR(reqOnly) + "&amp;title=" + CSTR(reqTitle) + "&amp;qv=" + CSTR(reqQV) + "&amp;topmemberid=" + CSTR(reqTopMemberID) + "&amp;pos=" + CSTR(reqPos) + "&amp;err=" + CSTR(SearchError) + "&amp;result=" + Result
Response.Redirect url
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="15" align="left"/>
				<WTCOLUMN width="25" align="left"/>
				<WTCOLUMN width="25" align="left"/>
				<WTCOLUMN width="25" align="left"/>
				<WTCOLUMN width="360" align="left"/>
				<WTCOLUMN width="300" align="right"/>

				<WTSTATIC label="ViewParent"/>
				<WTSTATIC label="GoParent"/>
				<WTSTATIC label="ViewInfo"/>
				<WTSTATIC label="ViewTeams"/>
				<WTSTATIC label="FastTrack"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(Level)"/>
					<WTHIDDEN value="PARAM(Only)"/>
					<WTHIDDEN value="PARAM(QV)"/>
					<WTHIDDEN value="PARAM(Title)"/>
					<WTHIDDEN value="PARAM(TopMemberID)"/>
					<WTHIDDEN value="PARAM(Lines)"/>
          <WTHIDDEN value="PARAM(Binary)"/>
          <WTHIDDEN value="PARAM(Dashboard)"/>
        </WTROW>

        <WTFUNCTION name="ViewDashboard(id)">
          var url, win, db;
          db = document.getElementById('Dashboard').value
          url = db + ".asp?memberid=" + id 
          win = window.open(url,"Performance","top=100,left=100,height=650,width=450,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>
        <WTFUNCTION name="ViewMember(id)">
          var url, win;
          url = "0421.asp?memberid=" + id
          win = window.open(url,"MemberInfo","top=100,left=100,height=200,width=330,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>
        <WTFUNCTION name="ShowBinaryLegend()">
          var url, win;
          url = "m_Page.asp?Page=BinaryLegend"
          win = window.open(url,"Legend","top=100,left=100,height=300,width=200,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>

        <WTFUNCTION name="ViewDownlines(id)">
					var url, win, company;
					company = document.getElementById('CompanyID').value
					url = "5409.asp?memberid=" + id + "&amp;companyid=" + company
					win = window.open(url,"Downlines","top=100,left=100,height=300,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewTeams(id)">
					var url, win;
					url = "5404.asp?memberid=" + id
		            win = window.open(url,"Teams","top=100,left=100,height=200,width=320,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>
				
				<WTFUNCTION name="ViewSponsorTeams(id)">
					var url, win, company;
					company = document.getElementById('CompanyID').value
					url = "0471.asp?memberid=" + id + "&amp;companyid=" + company
					if( company == 9 ) { url = url + "&amp;s2=1" }
					win = window.open(url,"Teams","top=100,left=100,height=200,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTFUNCTION name="NewGenealogy(id,lvl)">
					var level, line, levels, only, url, title, qv;
					if(id==0) { id = document.getElementById('MemberID').value };
					level = document.getElementById('Level').value;
					level = parseInt(level) + parseInt(lvl);
					line = document.getElementById('Line').value;
					levels = document.getElementById('Levels').value;
					only = document.getElementById('Only').value;
					title = document.getElementById('Title').value;
					qv = document.getElementById('QV').value;
					tm = document.getElementById('TopMemberID').value;
					url = "0470.asp?memberid=" + id + '&amp;level=' + level + '&amp;line=' + line + '&amp;levels=' + levels + '&amp;only=' + only + '&amp;title=' + title + '&amp;qv=' + qv + '&amp;topmemberid=' + tm;
					window.location = url;
				</WTFUNCTION>

				<WTFUNCTION name="GoTop()">
					var member = document.getElementById('TopMemberID').value;
					NewGenealogy(member,-1);
				</WTFUNCTION>

				<WTFUNCTION name="AddMember(sponsor,pos)">
					var company = document.getElementById('CompanyID').value;
					var member = document.getElementById('TopMemberID').value;
					var url = "Enroll.asp?c=" + company + "&amp;m=" + member + "&amp;s3=" + sponsor + "&amp;pos=" + pos
					if( company == 9 ) { url = url + "&amp;option=1" }
					if( company == 12 ) { url = "13201.asp?m=" + member }
					var win = window.open(url,"Enroll");
					win.focus();
				</WTFUNCTION>

				<WTFUNCTION name="DrawLines()">
					var adjx = -1;
					var adjy = 5;
					var jg = new jsGraphics('BinaryTree');
					var coords = document.getElementById('Lines').value
					jg.setColor('#cccccc');
					var parts = coords.split('|');
					for (i = 0; i &lt; parts.length; i++) {
					if (parts[i] != '') {
					var line = parts[i].split(',');
					var level = parseInt(line[0]);
					var pos = parseInt(line[1]);
					var x2 = pos;
					var y2 = level;
					var x1 = 0;
					var y1 = 0;
					var width, topwidth;
					if( level == 0 ) {width = 46 * 8; topwidth = 46 * 16;}
					if( level == 1 ) {width = 46 * 4; topwidth = 46 * 8;}
					if( level == 2 ) {width = 46 * 2; topwidth = 46 * 4;}
					if( level == 3 ) {width = 46 * 1; topwidth = 46 * 2;}
					//alert(level + ':' + pos);
					x2 = (x2 * width) - (width/2);
					x1 = (Math.round(pos/2) * topwidth) - (topwidth/2);
					var y2 = ((y2 + 1) * 60) - 5;
					var y1 = (level * 60) + 30;
					//alert(x1 + ':' + y1 + ' - ' + x2 + ':' + y2);

					jg.drawLine(x1 + adjx, y1 + adjy, x2 + adjx, y2 + adjy);
					}
					}
					jg.paint();
				</WTFUNCTION>
				<WTFUNCTION name="InitBinary()">
					$(document).ready(function () {
						var binary = document.getElementById('Binary').value
						if( binary != 0) { DrawLines(); }
					});
				</WTFUNCTION>

				<WTLOAD>
					InitBinary();
				</WTLOAD>

				<WTROW>
					<WTIMAGE col="1" merge="2" value="CONST(Icon_o.gif)" align="center" class="PageHeader"/>
					<WTTABLE col="3" merge="4">
						<WTCOLUMN width="710" align="left"/>
						<WTROW>
							<WTSTATIC col="1" align="center" class="PageHeading">
								<WTCODEGROUP><WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/></WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
								<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;))"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Status)" oper="not-equal" value="CONST(1)"/>
										<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Status)" oper="equal" value="CONST(1)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(Member.Qualify)" oper="less-equal" value="CONST(1)"/>
											<WTIMAGE value="CONST(Status-1.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(Member.Qualify)" oper="greater" value="CONST(1)"/>
											<WTIMAGE value="CONST(Status1.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
					 				<WTCONDITION expr="ATTR(Member.IsMaster)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(FastTrack.gif)" alt="FastTrack" imgalign="absmiddle"/>
								</WTCODEGROUP>
                <!-- View Dashboard -->
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Dashboard)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC space="1"/>
                  <WTIMAGE value="CONST(performance.gif)" alt="ViewDashboard" imgalign="absmiddle">
                    <WTLINK name="ViewDashboard(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
                  </WTIMAGE>
                </WTCODEGROUP>

                <!-- View Coded Teams -->
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(ViewCodes)" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="ATTR(Member.Status)" oper="less-equal" value="CONST(4)" connector="and"/>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="greater-equal" value="PARAM(ViewCodes)"/>
										<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
											<WTLINK name="ViewDownlines(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.Title)" oper="less" value="PARAM(ViewCodes)"/>
										<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
											<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="0403" return="false" target="new">
											<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
<!--								
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
					 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)"/>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@bv4&quot;/&gt;))"/>
								</WTCODEGROUP>
-->								
<!--
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
										<WTLINK name="0475" return="false" target="Finances">
											<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
											<WTPARAM name="Code" value="CONST(3)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
-->
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Member.BV)" oper="not-equal" value="CONST(0)"/>
										<WTCONDITION expr="ATTR(Member.QV)" oper="not-equal" value="CONST(0)" connector="or"/>
										<WTCONDITION expr="ATTR(Member.Status)" oper="not-equal" value="CONST(6)" connector="and"/>
										<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv, '|', /DATA/TXN/PTSMEMBER/@qv)&quot;/&gt;))" fontcolor="blue">
					 						<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(1)"/>
					 						<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(3)" connector="or"/>
										</WTSTATIC>
									</WTCODEGROUP>
<!--
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@memberbv, '|', /DATA/PARAM/@memberqv)&quot;/&gt;))" fontcolor="blue">
					 					<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
-->
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv2, '|', /DATA/TXN/PTSMEMBER/@qv2)&quot;/&gt;))" fontcolor="blue">
										<WTCONDITION expr="ATTR(Member.QV2)" oper="not-equal" value="CONST(0)"/>
										<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)" connector="and"/>
									</WTSTATIC>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv3, '|', /DATA/TXN/PTSMEMBER/@qv3)&quot;/&gt;))" fontcolor="blue">
										<WTCONDITION expr="ATTR(Member.QV3)" oper="not-equal" value="CONST(0)"/>
										<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(4)" connector="and"/>
									</WTSTATIC>
<!--									
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv4, '|', /DATA/TXN/PTSMEMBER/@qv4)&quot;/&gt;))" fontcolor="blue">
										<WTCONDITION expr="ATTR(Member.QV4)" oper="not-equal" value="CONST(0)"/>
					 					<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(5)" connector="and"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
										<WTIMAGE value="CONST(Team&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@busaccts&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
										<WTIMAGE value="CONST(Leg&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@maxmembers&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
									</WTCODEGROUP>
-->									
								</WTCODEGROUP>
								<WTSTATIC value="CONST(-)" space="1"/>
								<WTSTATIC label="EnrollerDownline">
					 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTCODEGROUP>
					 				<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)"/>
									<WTSTATIC label="SponsorDownline"/>
								</WTCODEGROUP>
								<WTSTATIC label="MentorDownline">
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(4)"/>
									<WTSTATIC label="Sponsor2Downline"/>
								</WTCODEGROUP>
<!--								
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(5)"/>
									<WTSTATIC label="Sponsor3Downline">
										<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC label="BinaryDownline">
										<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
									</WTSTATIC>
								</WTCODEGROUP>
-->								
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
							<WTSTATIC col="1" label="GenealogyText" class="prompt PageHeader"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1" align="center" bold="true" class="PageHeader">
								<WTSTATIC tag="QVLeft"/>
								<WTSTATIC value="PARAM(BVLeft)"/>
								<WTSTATIC value="CONST(|)"/>
								<WTSTATIC value="PARAM(QVLeft)"/>
								<WTSTATIC space="5"/>
								<WTSTATIC space="5"/>
								<WTSTATIC space="5"/>
								<WTSTATIC tag="QVRight"/>
								<WTSTATIC value="PARAM(BVRight)"/>
								<WTSTATIC value="CONST(|)"/>
								<WTSTATIC value="PARAM(QVRight)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
			 				<WTCONDITION expr="PARAM(Only)" oper="not-equal" value="CONST(0)"/>
							<WTHIDDEN value="PARAM(Line)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
<!--
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
-->
        <WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="6" align="center">
						<WTSTATIC label="DisplayGenealogy" space="1"/>
						<WTCODEGROUP>
					 		<WTCONDITION expr="PARAM(Only)" oper="equal" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCOMBO value="PARAM(Line)">
									<WTOPTION id="1" label="EnrollerDownline">
					 					<WTCONDITION expr="PARAM(Downline1)" oper="equal" value="CONST(1)"/>
									</WTOPTION>
                  <WTOPTION id="2" label="SponsorDownline">
                    <WTCONDITION expr="PARAM(Downline2)" oper="equal" value="CONST(1)"/>
                    <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(NEXXUS)" connector="and"/>
                  </WTOPTION>
                  <WTOPTION id="2" label="TeamDownline">
                    <WTCONDITION expr="PARAM(Downline2)" oper="equal" value="CONST(1)"/>
                    <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)" connector="and"/>
                  </WTOPTION>
                  <WTOPTION id="4" label="Sponsor2Downline">
					 					<WTCONDITION expr="PARAM(Downline4)" oper="equal" value="CONST(1)"/>
									</WTOPTION>
									<WTOPTION id="5" label="Sponsor3Downline">
										<WTCONDITION expr="PARAM(Downline5)" oper="equal" value="CONST(1)"/>
									</WTOPTION>
									<WTOPTION id="5" label="BinaryDownline">
										<WTCONDITION expr="PARAM(DownlineB)" oper="equal" value="CONST(1)"/>
									</WTOPTION>
									<WTOPTION id="3" label="MentorDownline">
					 					<WTCONDITION expr="PARAM(Downline3)" oper="equal" value="CONST(1)"/>
									</WTOPTION>
								</WTCOMBO>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTSTATIC label="for" space="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCOMBO value="PARAM(Levels)">
								<WTOPTION id="1" label="1Level"/>
								<WTOPTION id="2" label="2Levels"/>
								<WTOPTION id="3" label="3Levels"/>
								<WTOPTION id="4" label="4Levels"/>
							</WTCOMBO>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTBUTTON value="CONST(View)" btnclass="smbutton">
								<WTCLICK>NewGenealogy(0,0);</WTCLICK>
							</WTBUTTON>
						</WTCODEGROUP>
<!--						
						<WTSTATIC space="1"/>
						<WTSTATIC label="MinTitle" space="1"/>
						<WTCODEGROUP>
							<WTCOMBO value="PARAM(Title)" datapath="/DATA/TXN/PTSTITLES/ENUM" setselected="true"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="MinQV" space="1"/>
						<WTCODEGROUP>
							<WTTEXT value="PARAM(QV)" size="2"/>
						</WTCODEGROUP>
-->						
<!--
						<WTCODEGROUP>
					 		<WTCONDITION expr="PARAM(ParentID)" oper="greater" value="CONST(0)"/>
							<WTSTATIC space="2"/>	
							<WTIMAGE value="CONST(Parent.gif)" alt="ViewParent" imgalign="absmiddle">
								<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;/DATA/PARAM/@parentid&quot;/&gt;)" click="true" />
							</WTIMAGE>
						</WTCODEGROUP>
-->						
						<WTSTATIC>	
					 		<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					 		<WTCONDITION expr="PARAM(TopMemberID)" oper="not-equal" value="PARAM(MemberID)" connector="or"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(ParentID)" oper="greater" value="CONST(0)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
                  <WTSTATIC space="1"/>
                  <WTIMAGE value="CONST(mentoringteam.gif)" alt="GoParent" imgalign="absmiddle">
										<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;/DATA/PARAM/@parentid&quot;/&gt;, -1)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC space="1"/>
                  <WTBUTTON value="CONST(UpOne)" btnclass="smbutton">
										<WTCLICK escape="false">NewGenealogy(&lt;xsl:value-of select=&quot;/DATA/PARAM/@parentid&quot;/&gt;, -1)</WTCLICK>
									</WTBUTTON>
                  <WTSTATIC space="1"/>
                  <WTBUTTON value="CONST(GoTop)" btnclass="smbutton">
										<WTCLICK escape="false">GoTop()</WTCLICK>
									</WTBUTTON>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
                <WTSTATIC space="1"/>
                <WTBUTTON value="CONST(BottomLeft)" btnclass="smbutton">
									<WTCLICK escape="false">NewGenealogy(-1, -1)</WTCLICK>
								</WTBUTTON>
                <WTSTATIC space="1"/>
                <WTBUTTON value="CONST(BottomRight)" btnclass="smbutton">
									<WTCLICK escape="false">NewGenealogy(-2, -1)</WTCLICK>
								</WTBUTTON>
							</WTCODEGROUP>
						</WTSTATIC>

						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCOMBO value="PARAM(SearchType)">
									<WTOPTION id="1" label="SearchMemberName"/>
									<WTOPTION id="2" label="SearchMemberID"/>
								</WTCOMBO>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTTEXT value="PARAM(SearchText)" size="10"/>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTCODEGROUP>
								<WTBUTTON action="5" value="CONST(Search)" btnclass="smbutton"/>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(LearnMore.gif)">
									<WTLINK name="Page" target="Help">
										<WTPARAM name="Page" value="CONST(SalesTeam)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
							<WTSTATIC space="1"/>
							<WTBUTTON value="CONST(Close)" align="right" btnclass="smbutton">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTCODEGROUP>

					</WTSTATIC>
				</WTROW>
<!--
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
-->
				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Count)" oper="equal" value="CONST(0)" connector="and"/>
					<WTSTATIC col="1" merge="6" label="NoGenealogy" class="PageHeading" align="center"/>
				</WTROW>

				<WTSTATIC label="SponsorTeam"/>
				<WTSTATIC label="LegTitle"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTTABLE col="1" merge="6">
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>

							<WTDIVISION id="BinaryTree" style="position:relative ">
								<WTROW height="60">
									<WTSTATIC col="1" merge="16" valign="top">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@status&quot;/&gt;.gif)"/>
											<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberdesc&quot;/&gt;"/>
											<WTIMAGE value="CONST(Qualify&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@qualify&quot;/&gt;.gif)"/>
											<WTSTATIC newline="1"/>
											<WTSTATIC value="ATTR(Member.NameFirst)" fontsize="1"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW height="60">
									<WTREPEAT xpath="/DATA/TXN/NODES[@level=0]/NODE">
										<WTSTATIC col="1" merge="8" valign="top">
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Title)" oper="exist" />
												<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
												<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;">
													<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
												</WTIMAGE>
												<WTIMAGE value="CONST(Qualify&lt;xsl:value-of select=&quot;@qualify&quot;/&gt;.gif)"/>
												<WTSTATIC newline="1"/>
												<WTSTATIC value="DATA(First)" fontsize="1"/>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
												<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member">
													<WTLINK name="AddMember(&lt;xsl:value-of select=&quot;@sponsorid&quot;/&gt;,&lt;xsl:value-of select=&quot;@pos&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTREPEAT>
								</WTROW>
								<WTROW height="60">
									<WTREPEAT xpath="/DATA/TXN/NODES[@level=1]/NODE">
										<WTSTATIC col="1" merge="4" valign="top">
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Title)" oper="exist" />
												<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
												<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;">
													<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
												</WTIMAGE>
												<WTIMAGE value="CONST(Qualify&lt;xsl:value-of select=&quot;@qualify&quot;/&gt;.gif)"/>
												<WTSTATIC newline="1"/>
												<WTSTATIC value="DATA(First)" fontsize="1"/>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
												<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member">
													<WTLINK name="AddMember(&lt;xsl:value-of select=&quot;@sponsorid&quot;/&gt;,&lt;xsl:value-of select=&quot;@pos&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTREPEAT>
								</WTROW>
								<WTROW height="60">
									<WTREPEAT xpath="/DATA/TXN/NODES[@level=2]/NODE">
										<WTSTATIC col="1" merge="2" valign="top">
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Title)" oper="exist" />
												<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
												<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;">
													<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
												</WTIMAGE>
												<WTIMAGE value="CONST(Qualify&lt;xsl:value-of select=&quot;@qualify&quot;/&gt;.gif)"/>
												<WTSTATIC newline="1"/>
												<WTSTATIC value="DATA(First)" fontsize="1"/>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
												<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member">
													<WTLINK name="AddMember(&lt;xsl:value-of select=&quot;@sponsorid&quot;/&gt;,&lt;xsl:value-of select=&quot;@pos&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTREPEAT>
								</WTROW>
								<WTROW height="60">
									<WTREPEAT xpath="/DATA/TXN/NODES[@level=3]/NODE">
										<WTSTATIC col="1" valign="top">
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Title)" oper="exist" />
												<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
												<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;">
													<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
												</WTIMAGE>
												<WTIMAGE value="CONST(Qualify&lt;xsl:value-of select=&quot;@qualify&quot;/&gt;.gif)"/>
												<WTSTATIC newline="1"/>
												<WTSTATIC value="DATA(First)" fontsize="1"/>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
												<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member">
													<WTLINK name="AddMember(&lt;xsl:value-of select=&quot;@sponsorid&quot;/&gt;,&lt;xsl:value-of select=&quot;@pos&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTREPEAT>
								</WTROW>
							</WTDIVISION>
						</WTTABLE>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
					<WTREPEAT entity="Member">
						<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="PARAM(MemberID)"/>
						<WTROW>
							<WTDIVIDER col="1" merge="6" height="1" color="mediumblue"/>
						</WTROW>
						<WTROW class="bluebar" height="40">
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 1&quot;/&gt;)"/>
							<WTSTATIC col="2" merge="5">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
									<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
								</WTSTATIC>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
									<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Email)" oper="less-equal" value="CONST(1)"/>
										<WTIMAGE value="CONST(Status-1.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Email)" oper="greater" value="CONST(1)"/>
										<WTIMAGE value="CONST(Status1.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
								</WTCODEGROUP>
                <!-- View Dashboard -->
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Dashboard)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC space="1"/>
                  <WTIMAGE value="CONST(performance.gif)" alt="ViewDashboard" imgalign="absmiddle">
                    <WTLINK name="ViewDashboard(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTCODEGROUP>
									<WTCONDITION expr="PARAM(ViewCodes)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
										<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
<!--								
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
										<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
-->
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="0403" return="false" target="new">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTSTATIC value="DATA(Member.Identification)" space="2"/>
								<!--							<WTSTATIC value="DATA(Member.Phone1)" space="1"/>-->
								<!--							<WTSTATIC value="DATA(Member.Email)" space="1"/>-->
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Member.EnrollDate)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Member.VisitDate)"/>
									<WTSTATIC space="1"/>
								</WTSTATIC>
								<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,'|',@qv)&quot;/&gt;))" fontcolor="blue"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
										<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTREPEAT entity="Member">
							<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="DATA(Current.MemberID)"/>
							<WTROW>
								<WTSTATIC col="1" merge="2"/>
								<WTDIVIDER col="3" merge="4" height="1" color="goldenrod"/>
							</WTROW>
							<WTROW height="40">
								<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 2&quot;/&gt;)"/>
								<WTSTATIC col="2"/>
								<WTSTATIC col="3" merge="4" class="yellowbar">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
										<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
									</WTSTATIC>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
										<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Email)" oper="less-equal" value="CONST(1)"/>
											<WTIMAGE value="CONST(Status-1.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Email)" oper="greater" value="CONST(1)"/>
											<WTIMAGE value="CONST(Status1.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
									</WTCODEGROUP>
                  <!-- View Dashboard -->
                  <WTCODEGROUP>
                    <WTCONDITION expr="PARAM(Dashboard)" oper="not-equal" value="CONST('')"/>
                    <WTSTATIC space="1"/>
                    <WTIMAGE value="CONST(performance.gif)" alt="ViewDashboard" imgalign="absmiddle">
                      <WTLINK name="ViewDashboard(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
                    </WTIMAGE>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
										<WTCONDITION expr="PARAM(ViewCodes)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
											<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
<!--									
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
											<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
-->									
									<WTCODEGROUP>
										<WTCONDITION expr="IsEmployee"/>
										<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
										<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
											<WTLINK name="0403" return="false" target="new">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="2"/>
									<WTSTATIC value="DATA(Member.Identification)" space="2"/>
									<!--								<WTSTATIC value="DATA(Member.Phone1)" space="1"/>-->
									<!--								<WTSTATIC value="DATA(Member.Email)" space="1"/>-->
									<WTSTATIC fontcolor="purple">
										<WTSTATIC value="DATA(Member.EnrollDate)"/>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(Member.VisitDate)"/>
										<WTSTATIC space="1"/>
									</WTSTATIC>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,'|',@qv)&quot;/&gt;))" fontcolor="blue"/>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
											<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<WTREPEAT entity="Member">
								<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="DATA(Current.MemberID)"/>
								<WTROW>
									<WTSTATIC col="1" merge="3"/>
									<WTDIVIDER col="4" merge="3" height="1" color="firebrick"/>
								</WTROW>
								<WTROW height="40">
									<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 3&quot;/&gt;)"/>
									<WTSTATIC col="2" merge="2"/>
									<WTSTATIC col="4" merge="3" class="redbar">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
											<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
										</WTSTATIC>
										<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
											<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Email)" oper="less-equal" value="CONST(1)"/>
												<WTIMAGE value="CONST(Status-1.gif)" imgalign="absmiddle"/>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Email)" oper="greater" value="CONST(1)"/>
												<WTIMAGE value="CONST(Status1.gif)" imgalign="absmiddle"/>
											</WTCODEGROUP>
										</WTCODEGROUP>
                    <!-- View Dashboard -->
                    <WTCODEGROUP>
                      <WTCONDITION expr="PARAM(Dashboard)" oper="not-equal" value="CONST('')"/>
                      <WTSTATIC space="1"/>
                      <WTIMAGE value="CONST(performance.gif)" alt="ViewDashboard" imgalign="absmiddle">
                        <WTLINK name="ViewDashboard(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
                      </WTIMAGE>
                    </WTCODEGROUP>
                    <WTCODEGROUP>
											<WTCONDITION expr="PARAM(ViewCodes)" oper="not-equal" value="CONST(0)"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
												<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
<!--										
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
												<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
-->										
										<WTCODEGROUP>
											<WTCONDITION expr="IsEmployee"/>
											<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
											<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
												<WTLINK name="0403" return="false" target="new">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="2"/>
										<WTSTATIC value="DATA(Member.Identification)" space="2"/>
										<!--									<WTSTATIC value="DATA(Member.Phone1)" space="1"/>-->
										<!--									<WTSTATIC value="DATA(Member.Email)" space="1"/>-->
										<WTSTATIC fontcolor="purple">
											<WTSTATIC value="DATA(Member.EnrollDate)"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(Member.VisitDate)"/>
											<WTSTATIC space="1"/>
										</WTSTATIC>
										<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,'|',@qv)&quot;/&gt;))" fontcolor="blue"/>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
												<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>

								<WTREPEAT entity="Member">
									<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="DATA(Current.MemberID)"/>
									<WTROW>
										<WTSTATIC col="1" merge="4"/>
										<WTDIVIDER col="5" merge="2" height="1" color="green"/>
									</WTROW>
									<WTROW height="40">
										<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 4&quot;/&gt;)"/>
										<WTSTATIC col="2" merge="3"/>
										<WTSTATIC col="5" merge="2" class="greenbar">
											<WTCODEGROUP>
												<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
											</WTCODEGROUP>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
												<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
											</WTSTATIC>
											<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(1)"/>
												<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(1)"/>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Email)" oper="less-equal" value="CONST(1)"/>
													<WTIMAGE value="CONST(Status-1.gif)" imgalign="absmiddle"/>
												</WTCODEGROUP>
												<WTCODEGROUP>
													<WTCONDITION expr="DATA(Email)" oper="greater" value="CONST(1)"/>
													<WTIMAGE value="CONST(Status1.gif)" imgalign="absmiddle"/>
												</WTCODEGROUP>
											</WTCODEGROUP>
                      <!-- View Dashboard -->
                      <WTCODEGROUP>
                        <WTCONDITION expr="PARAM(Dashboard)" oper="not-equal" value="CONST('')"/>
                        <WTSTATIC space="1"/>
                        <WTIMAGE value="CONST(performance.gif)" alt="ViewDashboard" imgalign="absmiddle">
                          <WTLINK name="ViewDashboard(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
                        </WTIMAGE>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
												<WTCONDITION expr="PARAM(ViewCodes)" oper="not-equal" value="CONST(0)"/>
												<WTSTATIC space="1"/>
												<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
													<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTCODEGROUP>
<!--											
											<WTCODEGROUP>
												<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
												<WTSTATIC space="1"/>
												<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
													<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTCODEGROUP>
-->											
											<WTCODEGROUP>
												<WTCONDITION expr="IsEmployee"/>
												<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
												<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
												<WTSTATIC space="1"/>
												<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
													<WTLINK name="0403" return="false" target="new">
														<WTPARAM name="MemberID" value="DATA(MemberID)"/>
														<WTPARAM name="ContentPage" value="CONST(3)"/>
														<WTPARAM name="Popup" value="CONST(1)"/>
													</WTLINK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTSTATIC space="2"/>
											<WTSTATIC value="DATA(Member.Identification)" space="2"/>
											<!--										<WTSTATIC value="DATA(Member.Phone1)" space="1"/>-->
											<!--										<WTSTATIC value="DATA(Member.Email)" space="1"/>-->
											<WTSTATIC fontcolor="purple">
												<WTSTATIC value="DATA(Member.EnrollDate)"/>
												<WTSTATIC space="1"/>
												<WTSTATIC value="DATA(Member.VisitDate)"/>
												<WTSTATIC space="1"/>
											</WTSTATIC>
											<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,'|',@qv)&quot;/&gt;))" fontcolor="blue"/>
											<WTCODEGROUP>
												<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
												<WTSTATIC space="1"/>
												<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
													<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTROW>
								</WTREPEAT>
							</WTREPEAT>
						</WTREPEAT>
					</WTREPEAT>
				</WTCODEGROUP>

				<WTROW margin-top="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTSTATIC col="1" merge="4" align="left">
						<WTSTATIC tag="TotalMembers" value="PARAM(Count)" space="5">
							<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
<!--
						<WTCODEGROUP><WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="CompPlan" bold="true" fontsize="2">
							<WTLINK name="PARAM(URL)" type="anchor" target="new"/>
						</WTSTATIC>
-->						
					</WTSTATIC>
          <WTBUTTON col="5" merge="2" value="CONST(Legend)" align="right" btnclass="smbutton">
            <WTCONDITION expr="PARAM(Binary)" oper="not-equal" value="CONST(0)"/>
            <WTCLICK>ShowBinaryLegend()</WTCLICK>
          </WTBUTTON>
          <WTBUTTON col="5" merge="2" value="CONST(Close)" align="right" btnclass="smbutton">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

				<WTROW margin-top="6" margin-bottom="12">
					<WTCONDITION expr="PARAM(Binary)" oper="equal" value="CONST(0)"/>
					<WTTABLE col="1" merge="6" firstrow="false">
<!--
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="215" align="right"/>
-->						
						<WTCOLUMN width="50"/>
						<WTCOLUMN width="265" align="left"/>
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="180" align="right"/>
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="110" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
<!--
							<WTTABLE col="2" valign="top" firstrow="false" border="1">
								<WTCOLUMN width="215"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="20" align="right"/>
										<WTCOLUMN width="110" align="left"/>
										<WTCOLUMN width="85" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="3" label="Statistics" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTREPEAT entity="Downtitle">
											<WTROW margin-bottom="2">
												<WTIMAGE col="1" value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" align="center" valign="top"/>
												<WTSTATIC col="2" align="left">
													<WTSTATIC value="DATA(TitleName)" bold="true" space="1"/>
												</WTSTATIC>
												<WTSTATIC col="3" align="left">
													<WTSTATIC value="DATA(Cnt)" bold="true" space="1"/>
													<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@leg&quot;/&gt; legs))" fontcolor="purple"/>
												</WTSTATIC>
											</WTROW>
										</WTREPEAT>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
											<WTROW margin-bottom="2">
												<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
											</WTROW>
											<WTROW margin-bottom="2">
												<WTSTATIC col="1"/>
												<WTSTATIC col="2" label="Total" bold="true" align="left"/>
												<WTSTATIC col="3" value="PARAM(Total)" bold="true" align="left"/>
											</WTROW>
										</WTCODEGROUP>
									</WTTABLE>
								</WTROW>
							</WTTABLE>
							<WTSTATIC col="3"/>
-->							
							<WTTABLE col="2" valign="top" firstrow="false" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="265"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="30" align="center"/>
										<WTCOLUMN width="165" align="left"/>
										<WTCOLUMN width="70" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="3" label="Advancement" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTREPEAT entity="MemberTitle">
											<WTROW margin-bottom="2">
												<WTIMAGE col="1" value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" align="center" valign="top"/>
												<WTSTATIC col="2" align="left">
													<WTSTATIC value="DATA(TitleName)" bold="true"/>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(IsEarned)" oper="equal" value="CONST(0)"/>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(yellowchecksm.gif)" imgalign="absmiddle"/>
													</WTCODEGROUP>
													<WTCODEGROUP>
														<WTCONDITION expr="IsEmployee"/>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
															<WTLINK name="5703" return="false" target="new">
																<WTPARAM name="MemberTitleID" value="DATA(MemberTitleID)"/>
															</WTLINK>
														</WTIMAGE>
													</WTCODEGROUP>
												</WTSTATIC>
												<WTSTATIC col="3" align="left">
													<WTSTATIC value="DATA(TitleDate)" fontcolor="purple"/>
												</WTSTATIC>
											</WTROW>
										</WTREPEAT>
									</WTTABLE>
								</WTROW>
							</WTTABLE>

							<WTSTATIC col="3"/>
							<WTTABLE col="4" valign="top" firstrow="false" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="180"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="30" align="center"/>
										<WTCOLUMN width="150" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="2" label="Title" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTREPEAT xpath="/DATA/TXN/PTSTITLES/ENUM">
											<WTROW margin-bottom="2">
												<WTCONDITION expr="DATA(ID)" oper="not-equal" value="CONST(0)"/>
												<WTIMAGE col="1" value="CONST(Title&lt;xsl:value-of select=&quot;@id&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" align="center" valign="top"/>
												<WTSTATIC col="2"/>
												<WTSTATIC col="2" value="DATA(Name)"/>
											</WTROW>
										</WTREPEAT>
									</WTTABLE>
								</WTROW>
							</WTTABLE>
							
							<WTSTATIC col="5"/>
							<WTTABLE col="6" valign="top" firstrow="false" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="140"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="30" align="center"/>
										<WTCOLUMN width="110" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="2" label="Status" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status1.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2">
												<WTSTATIC label="Active">
													<WTCONDITION expr="ATTR(Coption.PaidName)" oper="equal" value="CONST('')"/>
												</WTSTATIC>
												<WTSTATIC value="ATTR(Coption.PaidName)">
													<WTCONDITION expr="ATTR(Coption.PaidName)" oper="not-equal" value="CONST('')"/>
												</WTSTATIC>
											</WTSTATIC>
										</WTROW>

                    <WTROW margin-bottom="2">
                      <WTIMAGE col="1" value="CONST(Status-1.gif)" align="center"/>
                      <WTSTATIC col="2"/>
                      <WTSTATIC col="2" label="Status-1"/>
                    </WTROW>

                    <WTROW margin-bottom="2">
                      <WTCONDITION expr="ATTR(Coption.TrialDays)" oper="not-equal" value="CONST(0)"/>
                      <WTIMAGE col="1" value="CONST(Status2.gif)" align="center"/>
                      <WTSTATIC col="2"/>
                      <WTSTATIC col="2" label="Status2"/>
                    </WTROW>

                    <WTROW margin-bottom="2">
					 						<WTCONDITION expr="ATTR(Coption.IsFree)" oper="not-equal" value="CONST(0)"/>
											<WTIMAGE col="1" value="CONST(Status3.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2">
												<WTSTATIC label="Status3">
													<WTCONDITION expr="ATTR(Coption.FreeName)" oper="equal" value="CONST('')"/>
												</WTSTATIC>
												<WTSTATIC value="ATTR(Coption.FreeName)">
													<WTCONDITION expr="ATTR(Coption.FreeName)" oper="not-equal" value="CONST('')"/>
												</WTSTATIC>
											</WTSTATIC>
										</WTROW>										
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status4.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status4"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status5.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status5"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status6.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status6"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status7.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status7"/>
										</WTROW>
									</WTTABLE>
								</WTROW>
							</WTTABLE>
							
						</WTROW>
					</WTTABLE>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
		<WTWEBPAGE name="0470b" caption="MyGenealogy" navbar="false" footer="false" langfile="0470b"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="Line" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Level" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="ParentID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Levels" datatype="number"/>
			<WTPARAM name="Only" datatype="number"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="QV" datatype="number"/>
			<WTPARAM name="URL" datatype="text"/>
			<WTPARAM name="Install" datatype="number"/>
			<WTPARAM name="Downline1" datatype="number"/>
			<WTPARAM name="Downline2" datatype="number"/>
			<WTPARAM name="Downline3" datatype="number"/>
			<WTPARAM name="Downline4" datatype="number"/>
			<WTPARAM name="Downline5" datatype="number"/>
			<!-- <WTPARAM name="Total" datatype="number"/>-->

			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="SearchType" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="Err" datatype="number"/>
			<WTPARAM name="TopMemberID" datatype="number"/>

			<WTPARAM name="MemberBV" datatype="text"/>
			<WTPARAM name="MemberQV" datatype="text"/>
			<WTPARAM name="ViewInfo" datatype="number"/>

			<WTPARAM name="MemberDesc" datatype="text"/>
			<WTPARAM name="Lines" datatype="text"/>

			<WTDATATXN name="Level0"/>
			<WTDATATXN name="Level1"/>
			<WTDATATXN name="Level2"/>
			<WTDATATXN name="Level3"/>

			<WTSTYLESHEET name="jquery.shadow.css"/>
			<WTJAVASCRIPT name="jquery-1.5.1.min.js"/>
			<WTJAVASCRIPT name="jquery-corner.js"/>
			<WTJAVASCRIPT name="jquery.shadow.js"/>
			<WTJAVASCRIPT name="wz_jsgraphics.js"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<!--
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="CheckUpline">
						<WTPARAM name="SponsorID" direction="input" value="SYS(MemberID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="CONST(Result)" oper="equal" value="CONST(0)"/>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
-->
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Err)" oper="equal" value="CONST(1)"/>
				<WTERROR number="10121" message="Oops, Downline member not found. Be more specific."/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SearchType)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(SearchType)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(TopMemberID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(TopMemberID)" value="PARAM(MemberID)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTSETATTRIBUTE name="PARAM(ViewInfo)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTGETCACHE name="CONST(Options2)" value="OPTIONS2" />
					<WTSETATTRIBUTE name="PARAM(ViewInfo)" value="CONST(1)">
						<WTCONDITION expr="CONST(InStr(Options2,&quot;V&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTCUSTOM>
					reqInstall = GetCache("INSTALL")
					If reqSysUserGroup = 0 OR reqSysUserGroup &gt; 52 Then
					Response.write "Unauthorized Access!"
					Response.end
					End If
				</WTCUSTOM>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCUSTOM>
					If reqLine = 0 Then
					reqLine = 2
					reqDownline1 = 1
					reqDownline2 = 1
					reqDownline3 = 1
					reqDownline4 = 1
					reqDownline5 = 1
					If reqInstall = 1 AND reqSysCompanyID = 7 Then reqLine = 1
					End If
				</WTCUSTOM>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Levels)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Levels)" value="CONST(1)"/>
			</WTCODEGROUP>

			<WTSUB name="GetDownlines">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						Downlines = .TBPage
						If Downlines &lt;&gt; "" Then
						If InStr(Downlines, "1" ) &gt; 0 Then reqDownline1 = 1 Else reqDownline1 = 0
						If InStr(Downlines, "2" ) &gt; 0 Then reqDownline2 = 1 Else reqDownline2 = 0
						If InStr(Downlines, "3" ) &gt; 0 Then reqDownline3 = 1 Else reqDownline3 = 0
						If InStr(Downlines, "4" ) &gt; 0 Then reqDownline4 = 1 Else reqDownline4 = 0
						If InStr(Downlines, "5" ) &gt; 0 Then reqDownline5 = 1 Else reqDownline5 = 0
						If reqLine = 0 Then
						pos = InStr(Downlines, "*" )
						If pos &gt; 0 Then reqLine = CLng( MID(Downlines, pos+1, 1) )
						End If
						If InStr( Downlines, CStr(reqLine) ) = 0 Then
						reqLine = Left(DownLines, 1 )
						End If
						End If
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCoption" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB function="BuildTree( oSrc, MemberID, Pos, Level )">
				<WTCUSTOM>
					tmpNode = ""
					For Each oItem In oSrc.selectNodes("/PTSMEMBERS/PTSMEMBER[@sponsorid=" + CStr(MemberID) + " and @phone1=" + Cstr(Pos) + "]" )
						If tmpNode = "" Then
							With oItem
								attrMemberID = .getAttribute("memberid")
								attrMemberName = .getAttribute("membername")
								attrEnrollDate = .getAttribute("enrolldate")
								attrVisitDate = .getAttribute("visitdate")
								attrStatus = .getAttribute("status")
								attrTitle = .getAttribute("title")
								attrBV = .getAttribute("bv")
								attrQV = .getAttribute("qv")
								attrIdentification = .getAttribute("identification")
							End With
							tmpNode = "&lt;NODE"
							tmpNode = tmpNode &amp; " memberid=""" &amp; attrMemberID &amp; """ status=""" &amp; attrStatus &amp; """ title=""" &amp; attrTitle &amp; """"
							tmpNode = tmpNode &amp; " desc=""" &amp; attrMemberName &amp; " - " &amp; attrQV &amp; " - " &amp; attrIdentification &amp; " - " &amp; attrEnrollDate &amp; " - " &amp; attrVisitDate &amp; """"
							tmpNode = tmpNode &amp; "/&gt;"

							If Level = 0 Then
								xmlLevel0 = xmlLevel0 + tmpNode
								tmpLevel0Cnt = tmpLevel0Cnt + 1
								tmpCnt = tmpLevel0Cnt
							End If
							If Level = 1 Then
								xmlLevel1 = xmlLevel1 + tmpNode
								tmpLevel1Cnt = tmpLevel1Cnt + 1
								tmpCnt = tmpLevel1Cnt
							End If
							If Level = 2 Then
								xmlLevel2 = xmlLevel2 + tmpNode
								tmpLevel2Cnt = tmpLevel2Cnt + 1
								tmpCnt = tmpLevel2Cnt
							End If
							If Level = 3 Then
								xmlLevel3 = xmlLevel3 + tmpNode
								tmpLevel3Cnt = tmpLevel3Cnt + 1
								tmpCnt = tmpLevel3Cnt
							End If
							If reqLines &lt;&gt; "" Then reqLines = reqLines + "|"
							reqLines = reqLines + CStr(Level) + "," + CStr(tmpCnt)
							If Level &lt; 3 Then
								BuildTree oSrc, attrMemberID, 0, Level + 1
								BuildTree oSrc, attrMemberID, 1, Level + 1
							End If
						End If
					Next
					If tmpNode = "" Then
						If Level = 0 Then
							xmlLevel0 = xmlLevel0 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel0Cnt = tmpLevel0Cnt + 1
							xmlLevel1 = xmlLevel1 + "&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel1Cnt = tmpLevel1Cnt + 2
							xmlLevel2 = xmlLevel2 + "&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel2Cnt = tmpLevel2Cnt + 4
							xmlLevel3 = xmlLevel3 + "&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 8
							tmpCnt = tmpLevel0Cnt
						End If
						If Level = 1 Then
							xmlLevel1 = xmlLevel1 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel1Cnt = tmpLevel1Cnt + 1
							xmlLevel2 = xmlLevel2 + "&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel2Cnt = tmpLevel2Cnt + 2
							xmlLevel3 = xmlLevel3 + "&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 4
							tmpCnt = tmpLevel1Cnt
						End If
						If Level = 2 Then
							xmlLevel2 = xmlLevel2 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel2Cnt = tmpLevel2Cnt + 1
							xmlLevel3 = xmlLevel3 + "&lt;NODE/&gt;&lt;NODE/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 2
							tmpCnt = tmpLevel2Cnt
						End If
						If Level = 3 Then
							xmlLevel3 = xmlLevel3 + "&lt;NODE sponsorid=""" &amp; MemberID &amp; """ pos=""" &amp; Pos &amp; """/&gt;"
							tmpLevel3Cnt = tmpLevel3Cnt + 1
							tmpCnt = tmpLevel3Cnt
						End If
						If reqLines &lt;&gt; "" Then reqLines = reqLines + "|"
						reqLines = reqLines + CStr(Level) + "," + CStr(tmpCnt)
					End If
				</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
<!--				
				<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
				</WTSETATTRIBUTE>
-->				
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTCUSTOM>
						reqMemberDesc =  .NameFirst + " " + .NameLast + " - " + .QV4 + " - " + .EnrollDate + " - " + .VisitDate
						reqURL = "Sections/Company/" &amp; reqCompanyID &amp; "/CompPlan.pdf"
						If reqLine = 0 Then
						'	If reqInstall = 1 AND reqCompanyID = 7 AND .Level = 3 Then reqLine = 4 Else reqLine = 2
						End If
						reqMemberBV = FormatCurrency(.BV2, 0 )
						reqMemberQV = FormatCurrency(.QV2, 0 )
					</WTCUSTOM>
					<WTCALLSUB name="GetDownlines"/>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(ReferralID)">
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-ENROLLER)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(SponsorID)">
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(MentorID)">
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-MENTOR)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(Sponsor2ID)">
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR2)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(Sponsor3ID)">
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR3)"/>
					</WTSETATTRIBUTE>
<!-- Binary -->
					<WTSETATTRIBUTE name="PARAM(ParentID)" value="ATTR(Sponsor3ID)"/>
					<WTSETATTRIBUTE name="PARAM(Line)" value="SYSCON(GENEALOGY-SPONSOR3)"/>
					<WTSETATTRIBUTE name="PARAM(Levels)" value="CONST(4)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="Genealogy">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Line)"/>
						<WTPARAM name="Level" direction="input" value="PARAM(Levels)"/>
						<WTPARAM name="Title" direction="input" value="PARAM(Title)"/>
						<WTPARAM name="QV" direction="input" value="PARAM(QV)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Line)" oper="equal" value="SYSCON(GENEALOGY-SPONSOR)"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)" connector="and"/>
						<WTCUSTOM>
							For Each oItem in oMembers
							With oItem
							aValue = split(.Phone1, ",")
							.BV4 = aValue(0) 'downline count
							.BusAccts = aValue(1) 'sponsor team
							.MaxMembers = aValue(2)   'leg title
							End With
							Next
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XMLGenealogy">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCODEGROUP>
<WTCUSTOM>
	Set oSrc = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oSrc.loadXML xmlMembers
	xmlLevel0 = "&lt;NODES level=""0""&gt;"
	xmlLevel1 = "&lt;NODES level=""1""&gt;"
	xmlLevel2 = "&lt;NODES level=""2""&gt;"
	xmlLevel3 = "&lt;NODES level=""3""&gt;"
	reqLines = ""
	tmpLevel0Cnt = 0
	tmpLevel1Cnt = 0
	tmpLevel2Cnt = 0
	tmpLevel3Cnt = 0
	BuildTree oSrc, reqMemberID, 0, 0
	BuildTree oSrc, reqMemberID, 1, 0
	xmlLevel0 = xmlLevel0 + "&lt;/NODES&gt;"
	xmlLevel1 = xmlLevel1 + "&lt;/NODES&gt;"
	xmlLevel2 = xmlLevel2 + "&lt;/NODES&gt;"
	xmlLevel3 = xmlLevel3 + "&lt;/NODES&gt;"
	Set oSrc = Nothing
</WTCUSTOM>
					</WTCODEGROUP>


				</WTOBJECT>
				<WTOBJECT name="MemberTitles" project="ptsMemberTitleUser" class="CMemberTitles">
					<WTMETHOD name="ListMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XMLGenealogy">
						<WTPARAM name="xmlMemberTitles" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Titles" project="ptsTitleUser" class="CTitles">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlTitles" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="5" name="Find" type="Find">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="SearchDownline">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SponsorID" direction="input" value="PARAM(TopMemberID)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(SearchType)"/>
						<WTPARAM name="MemberName" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Level" direction="input" value="PARAM(Line)"/>
						<WTPARAM name="Result" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCUSTOM>
						SearchError = 0
						aResult = Split(Result, ":" )
						If aResult(0) &lt;&gt; "0" Then
						reqMemberID = CLng(aResult(0))
						reqPos = CLng(aResult(1))
						reqLevel = CLng(aResult(2))
						Else
						SearchError = 1
						End If
						url = "0470.asp?memberid=" + CSTR(reqMemberID) + "&amp;level=" + CSTR(reqLevel) + "&amp;line=" + CSTR(reqLine) + "&amp;levels=" + CSTR(reqLevels) + "&amp;only=" + CSTR(reqOnly) + "&amp;title=" + CSTR(reqTitle) + "&amp;qv=" + CSTR(reqQV) + "&amp;topmemberid=" + CSTR(reqTopMemberID) + "&amp;pos=" + CSTR(reqPos) + "&amp;err=" + CSTR(SearchError) + "&amp;result=" + Result
						Response.Redirect url
					</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="left"/>
				<WTCOLUMN width="50" align="left"/>
				<WTCOLUMN width="50" align="left"/>
				<WTCOLUMN width="50" align="left"/>
				<WTCOLUMN width="275" align="left"/>
				<WTCOLUMN width="300" align="right"/>

				<WTSTATIC label="ViewParent"/>
				<WTSTATIC label="GoParent"/>
				<WTSTATIC label="ViewInfo"/>
				<WTSTATIC label="ViewTeams"/>
				<WTSTATIC label="FastTrack"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(Level)"/>
					<WTHIDDEN value="PARAM(Only)"/>
					<WTHIDDEN value="PARAM(QV)"/>
					<WTHIDDEN value="PARAM(Title)"/>
					<WTHIDDEN value="PARAM(TopMemberID)"/>
					<WTHIDDEN value="PARAM(Lines)"/>
				</WTROW>

				<WTFUNCTION name="ViewMember(id)">
					var url, win;
					url = "0421.asp?memberid=" + id
					win = window.open(url,"MemberInfo","top=100,left=100,height=200,width=330,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTFUNCTION name="ViewDownlines(id)">
					var url, win, company;
					company = document.getElementById('CompanyID').value
					if( company == 5 ) {
					url = "5408.asp?memberid=" + id + "&amp;companyid=" + company
					}
					win = window.open(url,"Downlines","top=100,left=100,height=300,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>
				<WTFUNCTION name="ViewTeams(id)">
					var url, win;
					url = "5404.asp?memberid=" + id
					win = window.open(url,"Teams","top=100,left=100,height=200,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>

				<WTFUNCTION name="ViewSponsorTeams(id)">
					var url, win, company;
					company = document.getElementById('CompanyID').value
					url = "0471.asp?memberid=" + id + "&amp;companyid=" + company
					if( company == 9 ) { url = url + "&amp;s2=1" }
					win = window.open(url,"Teams","top=100,left=100,height=200,width=300,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTFUNCTION name="NewGenealogy(id,lvl)">
					var level, line, levels, only, url, title, qv;
					if(id==0) { id = document.getElementById('MemberID').value };
					level = document.getElementById('Level').value;
					level = parseInt(level) + parseInt(lvl);
					line = document.getElementById('Line').value;
					levels = document.getElementById('Levels').value;
					only = document.getElementById('Only').value;
					title = document.getElementById('Title').value;
					qv = document.getElementById('QV').value;
					tm = document.getElementById('TopMemberID').value;
					url = "0470b.asp?memberid=" + id + '&amp;level=' + level + '&amp;line=' + line + '&amp;levels=' + levels + '&amp;only=' + only + '&amp;title=' + title + '&amp;qv=' + qv + '&amp;topmemberid=' + tm;
					window.location = url;
				</WTFUNCTION>

				<WTFUNCTION name="DrawLines()">
					var adjx = -1;
					var adjy = 77;
					var jg = new jsGraphics('BinaryTree');
					var coords = document.getElementById('Lines').value
					jg.setColor('#000000');
					var parts = coords.split('|');
					for (i = 0; i &lt; parts.length; i++) {
					if (parts[i] != '') {
					var line = parts[i].split(',');
					var level = parseInt(line[0]);
					var pos = parseInt(line[1]);
					var x2 = pos;
					var y2 = level;
					var x1 = 0;
					var y1 = 0;
					var width, topwidth;
					if( level == 0 ) {width = 46 * 8; topwidth = 46 * 16;}
					if( level == 1 ) {width = 46 * 4; topwidth = 46 * 8;}
					if( level == 2 ) {width = 46 * 2; topwidth = 46 * 4;}
					if( level == 3 ) {width = 46 * 1; topwidth = 46 * 2;}
					//alert(level + ':' + pos);
					x2 = (x2 * width) - (width/2);
					x1 = (Math.round(pos/2) * topwidth) - (topwidth/2);
					var y2 = (y2 + 1) * 60;
					var y1 = (level * 60) + 26;
					//alert(x1 + ':' + y1 + ' - ' + x2 + ':' + y2);

					jg.drawLine(x1 + adjx, y1 + adjy, x2 + adjx, y2 + adjy);
					}
					}
					jg.paint();
				</WTFUNCTION>
				<WTFUNCTION name="InitBinary()">
					$(document).ready(function () {
					var binary = document.getElementById('Binary').value
					if( binary != 0) { DrawLines(); }
					});
				</WTFUNCTION>

				<WTLOAD>
					InitBinary();
				</WTLOAD>

				<WTROW>
					<WTIMAGE col="1" merge="3" value="CONST(Icon_o.gif)" align="center"/>
					<WTTABLE col="4" merge="3">
						<WTCOLUMN width="625" align="left"/>
						<WTROW>
							<WTSTATIC col="1" align="center" class="PageHeading">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
								<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;))" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Member.IsMaster)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(FastTrack.gif)" alt="FastTrack" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
									<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
										<WTLINK name="ViewDownlines(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
									<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
										<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="0403" return="false" target="new">
											<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)"/>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@bv4&quot;/&gt;))"/>
								</WTCODEGROUP>
								<!--
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
										<WTLINK name="0475" return="false" target="Finances">
											<WTPARAM name="MemberID" value="ATTR(Member.MemberID)"/>
											<WTPARAM name="Code" value="CONST(3)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
-->
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Member.BV)" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="ATTR(Member.QV)" oper="not-equal" value="CONST(0)" connector="or"/>
									<WTCONDITION expr="ATTR(Member.Status)" oper="not-equal" value="CONST(6)" connector="and"/>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv, ' | ', /DATA/TXN/PTSMEMBER/@qv)&quot;/&gt;))" fontcolor="blue">
										<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(3)" connector="or"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/PARAM/@memberbv, '|', /DATA/PARAM/@memberqv)&quot;/&gt;))" fontcolor="blue">
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv3, '|', /DATA/TXN/PTSMEMBER/@qv3)&quot;/&gt;))" fontcolor="blue">
									<WTCONDITION expr="ATTR(Member.QV3)" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(4)" connector="and"/>
								</WTSTATIC>
								<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(/DATA/TXN/PTSMEMBER/@bv4, '|', /DATA/TXN/PTSMEMBER/@qv4)&quot;/&gt;))" fontcolor="blue">
									<WTCONDITION expr="ATTR(Member.QV4)" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(5)" connector="and"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
									<WTIMAGE value="CONST(Team&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@busaccts&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
									<WTIMAGE value="CONST(Leg&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@maxmembers&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
								</WTCODEGROUP>
								<WTSTATIC value="CONST(-)" space="1"/>
								<WTSTATIC label="EnrollerDownline">
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(2)"/>
									<WTSTATIC label="CommunityMatrix">
										<WTCONDITION expr="PARAM(Install)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)" connector="and"/>
									</WTSTATIC>
									<WTSTATIC label="SponsorDownline">
										<WTCONDITION expr="PARAM(Install)" oper="not-equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(7)" connector="or"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTSTATIC label="MentorDownline">
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(4)"/>
									<WTSTATIC label="IntroMatrix">
										<WTCONDITION expr="PARAM(Install)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)" connector="and"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Line)" oper="equal" value="CONST(5)"/>
									<WTSTATIC label="2ByInfinity"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="3" margin-bottom="3">
							<WTSTATIC col="1" label="GenealogyText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="PARAM(Only)" oper="not-equal" value="CONST(0)"/>
							<WTHIDDEN value="PARAM(Line)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
<!--				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="6" align="center">
						<WTSTATIC label="DisplayGenealogy" space="1"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Only)" oper="equal" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCOMBO value="PARAM(Line)">
									<WTOPTION id="1" label="EnrollerDownline">
										<WTCONDITION expr="PARAM(Downline1)" oper="equal" value="CONST(1)"/>
									</WTOPTION>
									<WTOPTION id="2" label="CommunityMatrix">
										<WTCONDITION expr="PARAM(Downline2)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(Install)" oper="equal" value="CONST(1)" connector="and"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)" connector="and"/>
									</WTOPTION>
									<WTOPTION id="2" label="SponsorDownline">
										<WTCONDITION expr="PARAM(Downline2)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(Install)" oper="not-equal" value="CONST(1)" connector="and" paren="start"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(7)" connector="or" paren="end"/>
									</WTOPTION>
									<WTOPTION id="4" label="IntroMatrix">
										<WTCONDITION expr="PARAM(Downline4)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(Install)" oper="equal" value="CONST(1)" connector="and"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)" connector="and"/>
									</WTOPTION>
									<WTOPTION id="5" label="2ByInfinity">
										<WTCONDITION expr="PARAM(Downline5)" oper="equal" value="CONST(1)"/>
										<WTCONDITION expr="PARAM(Install)" oper="equal" value="CONST(1)" connector="and"/>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)" connector="and"/>
									</WTOPTION>
									<WTOPTION id="3" label="MentorDownline">
										<WTCONDITION expr="PARAM(Downline3)" oper="equal" value="CONST(1)"/>
									</WTOPTION>
								</WTCOMBO>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTSTATIC label="for" space="1"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCOMBO value="PARAM(Levels)">
								<WTOPTION id="1" label="1Level"/>
								<WTOPTION id="2" label="2Levels"/>
								<WTOPTION id="3" label="3Levels"/>
								<WTOPTION id="4" label="4Levels"/>
							</WTCOMBO>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTBUTTON value="CONST(View)" btnclass="smbutton">
								<WTCLICK>NewGenealogy(0,0);</WTCLICK>
							</WTBUTTON>
						</WTCODEGROUP>
						<WTSTATIC>
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							<WTCONDITION expr="PARAM(TopMemberID)" oper="not-equal" value="PARAM(MemberID)" connector="or"/>
							<WTSTATIC space="1"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(ParentID)" oper="greater" value="CONST(0)"/>
								<WTIMAGE value="CONST(mentoringteam.gif)" alt="GoParent" imgalign="absmiddle">
									<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;/DATA/PARAM/@parentid&quot;/&gt;, -1)" click="true" />
								</WTIMAGE>
								<WTSTATIC space="1"/>
							</WTCODEGROUP>
						</WTSTATIC>

						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTCOMBO value="PARAM(SearchType)">
								<WTOPTION id="1" label="SearchMemberName"/>
								<WTOPTION id="2" label="SearchMemberID"/>
							</WTCOMBO>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTTEXT value="PARAM(SearchText)" size="10"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTBUTTON action="5" value="CONST(Search)" btnclass="smbutton"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(SalesTeam)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTCODEGROUP>
							<WTBUTTON value="CONST(Close)" align="right" btnclass="smbutton">
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTCODEGROUP>

					</WTSTATIC>
				</WTROW>
-->				
<!--
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
-->
				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Count)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="6" label="NoGenealogy" class="PageHeading" align="center"/>
				</WTROW>

				<WTSTATIC label="SponsorTeam"/>
				<WTSTATIC label="LegTitle"/>

				<WTCODEGROUP>
				<WTDIVISION id="BinaryTree">
					<WTROW margin-top="12">
						<WTTABLE col="1" merge="6">
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>
							<WTCOLUMN width="46" align="center"/>

							<WTROW height="60">
								<WTSTATIC col="1" merge="16" valign="top">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberdesc&quot;/&gt;"/>
										<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@status&quot;/&gt;.gif)"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
							<WTROW height="60">
								<WTREPEAT xpath="/DATA/TXN/NODES[@level=0]/NODE">
									<WTSTATIC col="1" merge="8" valign="top">
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Title)" oper="exist" />
											<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;"/>
											<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
											<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member"/>
										</WTCODEGROUP>
									</WTSTATIC> 
								</WTREPEAT>
							</WTROW>
							<WTROW height="60">
								<WTREPEAT xpath="/DATA/TXN/NODES[@level=1]/NODE">
									<WTSTATIC col="1" merge="4" valign="top">
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Title)" oper="exist" />
											<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;"/>
											<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
											<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTREPEAT>
							</WTROW>
							<WTROW height="60">
								<WTREPEAT xpath="/DATA/TXN/NODES[@level=2]/NODE">
									<WTSTATIC col="1" merge="2" valign="top">
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Title)" oper="exist" />
											<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;"/>
											<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
											<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTREPEAT>
							</WTROW>
							<WTROW height="60">
								<WTREPEAT xpath="/DATA/TXN/NODES[@level=3]/NODE">
									<WTSTATIC col="1" valign="top">
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Title)" oper="exist" />
											<WTIMAGE value="CONST(Titleb&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" altx="&lt;xsl:value-of select=&quot;@desc&quot;/&gt;"/>
											<WTIMAGE value="CONST(Statusb&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SponsorID)" oper="exist" />
											<WTIMAGE value="CONST(OpenNode.png)" altx="Click to add new member"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTREPEAT>
							</WTROW>
						</WTTABLE>
					</WTROW>
				</WTDIVISION>
				</WTCODEGROUP>
			<!--
				<WTREPEAT entity="Member">
					<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="PARAM(MemberID)"/>
					<WTROW>
						<WTDIVIDER col="1" merge="6" height="1" color="mediumblue"/>
					</WTROW>
					<WTROW class="bluebar" height="24">
						<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 1&quot;/&gt;)" valign="top"/>
						<WTSTATIC col="2" merge="5">
							<WTCODEGROUP>
								<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@titleb&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
								<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
							</WTSTATIC>
							<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(5)" />
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Email)" oper="equal" value="CONST(1)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(FastTrack.gif)" alt="FastTrack" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
										<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true"/>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
								<WTSTATIC space="1"/>
								<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
									<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="IsEmployee"/>
								<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
								<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
								<WTSTATIC space="1"/>
								<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
									<WTLINK name="0403" return="false" target="new">
										<WTPARAM name="MemberID" value="DATA(MemberID)"/>
										<WTPARAM name="ContentPage" value="CONST(3)"/>
										<WTPARAM name="Popup" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
							<WTSTATIC space="2"/>
							<WTSTATIC value="DATA(Member.Identification)" space="2"/>
							<WTSTATIC fontcolor="purple">
								<WTSTATIC value="DATA(Member.EnrollDate)"/>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Member.VisitDate)"/>
								<WTSTATIC space="1"/>
							</WTSTATIC>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Member.Status)" oper="less" value="CONST(5)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
									<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@bv4&quot;/&gt;))"/>
								</WTCODEGROUP>
								<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,' | ',@qv)&quot;/&gt;))" fontcolor="blue"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
									<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Team&lt;xsl:value-of select=&quot;@busaccts&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="SponsorTeam"/>
									<WTIMAGE value="CONST(Leg&lt;xsl:value-of select=&quot;@maxmembers&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="LegTitle"/>
								</WTCODEGROUP>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
								<WTSTATIC space="1"/>
								<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
									<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<WTREPEAT entity="Member">
						<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="DATA(Current.MemberID)"/>
						<WTROW>
							<WTSTATIC col="1" merge="2"/>
							<WTDIVIDER col="3" merge="4" height="1" color="goldenrod"/>
						</WTROW>
						<WTROW height="24">
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 2&quot;/&gt;)" valign="top"/>
							<WTSTATIC col="2"/>
							<WTSTATIC col="3" merge="4" class="yellowbar">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@titleb&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
									<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
								</WTSTATIC>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(5)" />
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Email)" oper="equal" value="CONST(1)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(FastTrack.gif)" alt="FastTrack" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
											<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true"/>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
										<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
										<WTLINK name="0403" return="false" target="new">
											<WTPARAM name="MemberID" value="DATA(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTSTATIC value="DATA(Member.Identification)" space="2"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Member.EnrollDate)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Member.VisitDate)"/>
									<WTSTATIC space="1"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Member.Status)" oper="less" value="CONST(5)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
										<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
										<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@bv4&quot;/&gt;))"/>
									</WTCODEGROUP>
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,' | ',@qv)&quot;/&gt;))" fontcolor="blue"/>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
										<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Team&lt;xsl:value-of select=&quot;@busaccts&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="SponsorTeam"/>
										<WTIMAGE value="CONST(Leg&lt;xsl:value-of select=&quot;@maxmembers&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="LegTitle"/>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
										<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTREPEAT entity="Member">
							<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="DATA(Current.MemberID)"/>
							<WTROW>
								<WTSTATIC col="1" merge="3"/>
								<WTDIVIDER col="4" merge="3" height="1" color="firebrick"/>
							</WTROW>
							<WTROW height="24">
								<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 3&quot;/&gt;)" valign="top"/>
								<WTSTATIC col="2" merge="2"/>
								<WTSTATIC col="4" merge="3" class="redbar">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@titleb&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
										<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
									</WTSTATIC>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(5)" />
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Email)" oper="equal" value="CONST(1)"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(FastTrack.gif)" alt="FastTrack" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
												<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true"/>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
											<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="IsEmployee"/>
										<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
										<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
											<WTLINK name="0403" return="false" target="new">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="2"/>
									<WTSTATIC value="DATA(Member.Identification)" space="2"/>
									<WTSTATIC fontcolor="purple">
										<WTSTATIC value="DATA(Member.EnrollDate)"/>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(Member.VisitDate)"/>
										<WTSTATIC space="1"/>
									</WTSTATIC>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Member.Status)" oper="less" value="CONST(5)"/>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
											<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
											<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@bv4&quot;/&gt;))"/>
										</WTCODEGROUP>
										<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,' | ',@qv)&quot;/&gt;))" fontcolor="blue"/>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
											<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Team&lt;xsl:value-of select=&quot;@busaccts&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="SponsorTeam"/>
											<WTIMAGE value="CONST(Leg&lt;xsl:value-of select=&quot;@maxmembers&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="LegTitle"/>
										</WTCODEGROUP>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
											<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<WTREPEAT entity="Member">
								<WTFILTER name="DATA(Member.SponsorID)" oper="equal" value="DATA(Current.MemberID)"/>
								<WTROW>
									<WTSTATIC col="1" merge="4"/>
									<WTDIVIDER col="5" merge="2" height="1" color="green"/>
								</WTROW>
								<WTROW height="24">
									<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/PARAM/@level + 4&quot;/&gt;)" valign="top"/>
									<WTSTATIC col="2" merge="3"/>
									<WTSTATIC col="5" merge="2" class="greenbar">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;@titleb&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
										</WTCODEGROUP>
										<WTSTATIC space="1"/>
										<WTSTATIC value="DATA(Member.MemberName)" bold="true" space="1">
											<WTLINK name="NewGenealogy(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;,1)" click="true" />
										</WTSTATIC>
										<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;))" space="1"/>
										<WTCODEGROUP>
											<WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(CompanyID)" oper="equal" value="CONST(5)" />
											<WTCODEGROUP>
												<WTCONDITION expr="DATA(Email)" oper="equal" value="CONST(1)"/>
												<WTSTATIC space="1"/>
												<WTIMAGE value="CONST(FastTrack.gif)" alt="FastTrack" imgalign="absmiddle"/>
											</WTCODEGROUP>
											<WTSTATIC space="1"/>
											<WTCODEGROUP>
												<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
													<WTLINK name="ViewTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true"/>
												</WTIMAGE>
											</WTCODEGROUP>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(genealogy.gif)" alt="ViewTeams" imgalign="absmiddle">
												<WTLINK name="ViewSponsorTeams(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="IsEmployee"/>
											<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
											<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
												<WTLINK name="0403" return="false" target="new">
													<WTPARAM name="MemberID" value="DATA(MemberID)"/>
													<WTPARAM name="ContentPage" value="CONST(3)"/>
													<WTPARAM name="Popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTSTATIC space="2"/>
										<WTSTATIC value="DATA(Member.Identification)" space="2"/>
										<WTSTATIC fontcolor="purple">
											<WTSTATIC value="DATA(Member.EnrollDate)"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(Member.VisitDate)"/>
											<WTSTATIC space="1"/>
										</WTSTATIC>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(Member.Status)" oper="less" value="CONST(5)"/>
											<WTCODEGROUP>
												<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
												<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
												<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@bv4&quot;/&gt;))"/>
											</WTCODEGROUP>
											<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;concat(@bv,' | ',@qv)&quot;/&gt;))" fontcolor="blue"/>
											<WTCODEGROUP>
												<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(5)"/>
												<WTCONDITION expr="DATA(Phone1)" oper="not-equal" value="CONST('')" connector="and"/>
												<WTSTATIC space="1"/>
												<WTIMAGE value="CONST(Team&lt;xsl:value-of select=&quot;@busaccts&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="SponsorTeam"/>
												<WTIMAGE value="CONST(Leg&lt;xsl:value-of select=&quot;@maxmembers&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" alt="LegTitle"/>
											</WTCODEGROUP>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(ViewInfo)" oper="not-equal" value="CONST(0)"/>
											<WTSTATIC space="1"/>
											<WTIMAGE value="CONST(Preview.gif)" alt="ViewInfo" imgalign="absmiddle">
												<WTLINK name="ViewMember(&lt;xsl:value-of select=&quot;@memberid&quot;/&gt;)" click="true" />
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTREPEAT>
						</WTREPEAT>
					</WTREPEAT>
				</WTREPEAT>
-->
				<WTROW margin-top="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="3">
					<WTSTATIC col="1" merge="5" align="left">
						<WTSTATIC tag="TotalMembers" value="PARAM(Count)" space="5">
							<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
						<!--
						<WTCODEGROUP><WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="CompPlan" bold="true" fontsize="2">
							<WTLINK name="PARAM(URL)" type="anchor" target="new"/>
						</WTSTATIC>
-->
					</WTSTATIC>
					<WTBUTTON col="6" value="CONST(Close)" align="right" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="12">
					<WTTABLE col="1" merge="6" firstrow="false">
						<!--
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="215" align="right"/>
-->
						<WTCOLUMN width="50"/>
						<WTCOLUMN width="265" align="left"/>
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="180" align="right"/>
						<WTCOLUMN width="10"/>
						<WTCOLUMN width="110" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<!--
							<WTTABLE col="2" valign="top" firstrow="false" border="1">
								<WTCOLUMN width="215"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="20" align="right"/>
										<WTCOLUMN width="110" align="left"/>
										<WTCOLUMN width="85" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="3" label="Statistics" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTREPEAT entity="Downtitle">
											<WTROW margin-bottom="2">
												<WTIMAGE col="1" value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" align="center" valign="top"/>
												<WTSTATIC col="2" align="left">
													<WTSTATIC value="DATA(TitleName)" bold="true" space="1"/>
												</WTSTATIC>
												<WTSTATIC col="3" align="left">
													<WTSTATIC value="DATA(Cnt)" bold="true" space="1"/>
													<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;@leg&quot;/&gt; legs))" fontcolor="purple"/>
												</WTSTATIC>
											</WTROW>
										</WTREPEAT>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(Total)" oper="not-equal" value="CONST(0)"/>
											<WTROW margin-bottom="2">
												<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)"/>
											</WTROW>
											<WTROW margin-bottom="2">
												<WTSTATIC col="1"/>
												<WTSTATIC col="2" label="Total" bold="true" align="left"/>
												<WTSTATIC col="3" value="PARAM(Total)" bold="true" align="left"/>
											</WTROW>
										</WTCODEGROUP>
									</WTTABLE>
								</WTROW>
							</WTTABLE>
							<WTSTATIC col="3"/>
-->
							<WTTABLE col="2" valign="top" firstrow="false" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="265"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="30" align="center"/>
										<WTCOLUMN width="165" align="left"/>
										<WTCOLUMN width="70" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="3" label="Advancement" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTREPEAT entity="MemberTitle">
											<WTROW margin-bottom="2">
												<WTIMAGE col="1" value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" align="center" valign="top"/>
												<WTSTATIC col="2" align="left">
													<WTSTATIC value="DATA(TitleName)" bold="true"/>
													<WTCODEGROUP>
														<WTCONDITION expr="DATA(IsEarned)" oper="equal" value="CONST(0)"/>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(yellowchecksm.gif)" imgalign="absmiddle"/>
													</WTCODEGROUP>
													<WTCODEGROUP>
														<WTCONDITION expr="IsEmployee"/>
														<WTSTATIC space="1"/>
														<WTIMAGE value="CONST(Edit.gif)" imgalign="absmiddle">
															<WTLINK name="5703" return="false" target="new">
																<WTPARAM name="MemberTitleID" value="DATA(MemberTitleID)"/>
															</WTLINK>
														</WTIMAGE>
													</WTCODEGROUP>
												</WTSTATIC>
												<WTSTATIC col="3" align="left">
													<WTSTATIC value="DATA(TitleDate)" fontcolor="purple"/>
												</WTSTATIC>
											</WTROW>
										</WTREPEAT>
									</WTTABLE>
								</WTROW>
							</WTTABLE>

							<WTSTATIC col="3"/>
							<WTTABLE col="4" valign="top" firstrow="false" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="180"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="30" align="center"/>
										<WTCOLUMN width="150" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="2" label="Title" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTREPEAT xpath="/DATA/TXN/PTSTITLES/ENUM">
											<WTROW margin-bottom="2">
												<WTCONDITION expr="DATA(ID)" oper="not-equal" value="CONST(0)"/>
												<WTIMAGE col="1" value="CONST(Title&lt;xsl:value-of select=&quot;@id&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;" align="center" valign="top"/>
												<WTSTATIC col="2"/>
												<WTSTATIC col="2" value="DATA(Name)"/>
											</WTROW>
										</WTREPEAT>
									</WTTABLE>
								</WTROW>
							</WTTABLE>

							<WTSTATIC col="5"/>
							<WTTABLE col="6" valign="top" firstrow="false" style="border: 1px #5084A2 solid">
								<WTCOLUMN width="140"/>
								<WTROW>
									<WTTABLE col="1" valign="top" firstrow="false">
										<WTCOLUMN width="30" align="center"/>
										<WTCOLUMN width="110" align="left"/>
										<WTROW margin-bottom="3">
											<WTSTATIC col="1" merge="2" label="Status" bold="true" align="center" fontsize="2" backcolor="SYS(light)"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status1.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2">
												<WTSTATIC label="Active">
													<WTCONDITION expr="ATTR(Coption.PaidName)" oper="equal" value="CONST('')"/>
												</WTSTATIC>
												<WTSTATIC value="ATTR(Coption.PaidName)">
													<WTCONDITION expr="ATTR(Coption.PaidName)" oper="not-equal" value="CONST('')"/>
												</WTSTATIC>
											</WTSTATIC>
										</WTROW>

										<WTROW margin-bottom="2">
											<WTCONDITION expr="ATTR(Coption.TrailDays)" oper="not-equal" value="CONST(0)"/>
											<WTIMAGE col="1" value="CONST(Status2.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status2"/>
										</WTROW>

										<WTROW margin-bottom="2">
											<WTCONDITION expr="ATTR(Coption.IsFree)" oper="not-equal" value="CONST(0)"/>
											<WTIMAGE col="1" value="CONST(Status3.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2">
												<WTSTATIC label="Status3">
													<WTCONDITION expr="ATTR(Coption.FreeName)" oper="equal" value="CONST('')"/>
												</WTSTATIC>
												<WTSTATIC value="ATTR(Coption.FreeName)">
													<WTCONDITION expr="ATTR(Coption.FreeName)" oper="not-equal" value="CONST('')"/>
												</WTSTATIC>
											</WTSTATIC>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status4.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status4"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status5.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status5"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status6.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status6"/>
										</WTROW>
										<WTROW margin-bottom="2">
											<WTIMAGE col="1" value="CONST(Status7.gif)" align="center"/>
											<WTSTATIC col="2"/>
											<WTSTATIC col="2" label="Status7"/>
										</WTROW>
									</WTTABLE>
								</WTROW>
							</WTTABLE>

						</WTROW>
					</WTTABLE>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Sponsor Team Summary -->
		<!--==========================================================================================-->
		<WTWEBPAGE name="0471" page-width="100%" header="false" navbar="false" footer="false" viewport="width=device-width"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0471">
			<!--==========================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="S1" datatype="number"/>
			<WTPARAM name="S2" datatype="number"/>
			<WTPARAM name="S3" datatype="number"/>
			<WTPARAM name="S1Count" datatype="number"/>
			<WTPARAM name="S2Count" datatype="number"/>
			<WTPARAM name="S3Count" datatype="number"/>
			<WTPARAM name="S1Member" datatype="text"/>
			<WTPARAM name="S2Member" datatype="text"/>
			<WTPARAM name="S3Member" datatype="text"/>
			<WTPARAM name="Title" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(tmpSponsor1ID)" value="ATTR(SponsorID)"/>
					<WTSETATTRIBUTE name="CONST(tmpSponsor2ID)" value="ATTR(Sponsor2ID)"/>
					<WTSETATTRIBUTE name="CONST(tmpSponsor3ID)" value="ATTR(Sponsor3ID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(S1)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpSponsor1ID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpSponsor1ID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(S1Member)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(S2)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpSponsor2ID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpSponsor2ID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(S2Member)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpSponsor3ID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="CONST(tmpSponsor3ID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(S3Member)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Custom">
						<WTCONDITION expr="PARAM(S1)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(205)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(1)"/>
						<WTPARAM name="reqS1Count" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="Custom">
						<WTCONDITION expr="PARAM(S2)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(205)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(2)"/>
						<WTPARAM name="reqS2Count" direction="return" datatype="number"/>
					</WTMETHOD>
					<WTMETHOD name="Custom">
						<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(205)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(3)"/>
						<WTPARAM name="reqS3Count" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="40" align="center"/>
				<WTCOLUMN width="125" align="center"/>
				<WTCOLUMN width="60" align="center"/>
				<WTCOLUMN width="75" align="left"/>

				<WTFUNCTION name="ViewTeam(sponsor)">
					var url, win;
					url = "0472.asp?memberid=" + document.getElementById('MemberID').value + "&amp;companyid=" + document.getElementById('CompanyID').value + "&amp;sponsor=" + sponsor
					win = window.open(url,"TeamMembers","top=50,left=100,height=500,width=500,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=1");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="4" class="PageHeading" align="center">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="4" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW height="18">
					<WTSTATIC col="1" label="Team" bold="true"/>
					<WTSTATIC col="2" label="Upline" bold="true"/>
					<WTSTATIC col="3" label="Members" bold="true"/>
				</WTROW>
				<WTROW height="18">
					<WTCONDITION expr="PARAM(S1)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="SponsorTeam1" bold="true"/>
					<WTSTATIC col="2" value="PARAM(S1Member)"/>
					<WTSTATIC col="3" value="PARAM(S1Count)"/>
					<WTBUTTON col="4" value="CONST(View)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(S1Count)" oper="greater" value="CONST(0)"/>
						<WTCLICK>ViewTeam(1)</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW height="18">
					<WTCONDITION expr="PARAM(S2)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="SponsorTeam2" bold="true"/>
					<WTSTATIC col="2" value="PARAM(S2Member)"/>
					<WTSTATIC col="3" value="PARAM(S2Count)"/>
					<WTBUTTON col="4" value="CONST(View)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(S2Count)" oper="greater" value="CONST(0)"/>
						<WTCLICK>ViewTeam(2)</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW height="18">
					<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="SponsorTeam3" bold="true"/>
					<WTSTATIC col="2" value="PARAM(S3Member)"/>
					<WTSTATIC col="3" value="PARAM(S3Count)"/>
					<WTBUTTON col="4" value="CONST(View)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(S3Count)" oper="greater" value="CONST(0)"/>
						<WTCLICK>ViewTeam(3)</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="4" value="CONST(Close)" align="center" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0472" wrapper="false" caption="Find" action="5" header="false" navbar="false" footer="false"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0472">
			<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Sponsor" datatype="number"/>
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(MemberName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
				<WTMETHOD name="FindSponsor">
					<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="CONST(1)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="SponsorID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindSponsor2">
					<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="CONST(2)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="Sponsor2ID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="FindSponsor3">
					<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="CONST(3)"/>
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="Sponsor3ID" direction="input" value="PARAM(MemberID)"/>
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="400" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading">
						<WTSTATIC label="SponsorTeam1">
							<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="SponsorTeam2">
							<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="SponsorTeam3">
							<WTCONDITION expr="PARAM(Sponsor)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader"/>
					<WTCOMBO col="1" value="ATTR(Members.FindTypeID)" prespace="false">
						<WTOPTION id="419" label="MemberName"/>
						<WTOPTION id="401" label="MemberID"/>
						<WTOPTION id="438" label="EnrollDate"/>
					</WTCOMBO>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="15" focus="true" prespace="false"/>
					<WTBUTTON col="1" action="5" value="CONST(View)" default="true" btnclass="smbutton"/>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Member">
						<WTCOLUMN width="40" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Title"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Status"/>
						<WTCOLUMN width="30" align="center" valign="top" label="EnrollDate"/>
						<WTROW height="18">
							<WTSTATIC col="1" value="DATA(MemberName)"/>
							<WTIMAGE col="2" value="CONST(Title&lt;xsl:value-of select=&quot;@title&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;"/>
							<WTIMAGE col="3" value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="4" value="DATA(EnrollDate)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="0475" caption="Finances" contentpage="true" wrapper="wrapper650"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0475" secured="52" track="0">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Options" datatype="text"/>
			<WTPARAM name="Code" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="PaymentPage" datatype="text"/>
      <WTPARAM name="PayoutPage" datatype="text"/>

      <!-- Code = 1 ... Display Sales Order Tab -->
			<!-- Code = 2 ... Display Payments Tab -->
			<!-- Code = 3 ... Display Bonuses Tab -->
			<!-- Code = 4 ... Display Payouts Tab -->
			<!-- Code = 5 ... Display Sales Summary Tab -->
			<!-- Code = 6 ... Display Credits Tab -->

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(3)" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="NotEmployee"/>
            <WTCONDITION expr="ATTR(CompanyID)" oper="not-equal" value="CONST(CSTR(reqSysCompanyID))" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberOnly"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="SYS(UserOptions)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NotMemberOnly"/>
						<WTSETATTRIBUTE name="PARAM(Options)" value="ATTR(Options)"/>
					</WTCODEGROUP>
          <WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="CONST(tmpAuthUserID)" value="ATTR(AuthUserID)"/>
          <WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
				</WTOBJECT>
        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="CONST(tmpCompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NotMemberOnly"/>
					  <WTCODEGROUP>
						  <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						  <WTSETATTRIBUTE name="PARAM(Options)" value="CONST(.FreeOptions + reqOptions)"/>
					  </WTCODEGROUP>
					  <WTCODEGROUP>
						  <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
						  <WTSETATTRIBUTE name="PARAM(Options)" value="CONST(.Options + reqOptions)"/>
					  </WTCODEGROUP>
					  <WTCODEGROUP>
						  <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(2)"/>
						  <WTSETATTRIBUTE name="PARAM(Options)" value="CONST(.Options2 + reqOptions)"/>
					  </WTCODEGROUP>
					  <WTCODEGROUP>
						  <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)"/>
						  <WTSETATTRIBUTE name="PARAM(Options)" value="CONST(.Options3 + reqOptions)"/>
					  </WTCODEGROUP>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpPayoutProcessors)" value="ATTR(PayoutProcessors)"/>
				</WTOBJECT>
					<!-- set payments page to 1021 unless sales order option is off -->
					<WTSETATTRIBUTE name="PARAM(PaymentPage)" value="CONST(&quot;1021&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(PayoutPage)" value="CONST(&quot;0821&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;j&quot;))" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(PaymentPage)" value="CONST(&quot;1022&quot;)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(tmpPayoutProcessors,&quot;10&quot;))" oper="greater" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(PayoutPage)" value="CONST(&quot;0831&quot;)"/>
					</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="500" align="left"/>
				<WTCOLUMN width="150" align="right"/>

				<WTTAB name="MemberTab">
					<WTITEM label="ViewPayouts" width="115">
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;x&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(PayoutPage)" oper="equal" value="CONST(&quot;0821&quot;)" connector="and"/>
						<WTLINK name="JAVA(ShowTab('TabPayouts',1))"/>
					</WTITEM>
					<WTITEM label="ViewWallet" width="115">
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;x&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTCONDITION expr="PARAM(PayoutPage)" oper="equal" value="CONST(&quot;0831&quot;)" connector="and"/>
						<WTLINK name="JAVA(ShowTab('TabPayouts',1))"/>
					</WTITEM>
					<WTITEM label="ViewSalesOrders" width="115">
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;j&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="JAVA(ShowTab('TabSalesOrders',1))"/>
					</WTITEM>
					<WTITEM label="ViewPayments" width="115">
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;V&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="JAVA(ShowTab('TabPayments',1))"/>
					</WTITEM>
					<WTITEM label="ViewCredits" width="115">
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;)&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="JAVA(ShowTab('TabCredits',1))"/>
					</WTITEM>
					<WTITEM label="ViewBonuses" width="115">
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;p&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="JAVA(ShowTab('TabBonuss',1))"/>
					</WTITEM>
					<WTITEM label="ViewSalesSummary" width="115">
						<WTCONDITION expr="CONST(InStr(reqOptions,&quot;N&quot;))" oper="not-equal" value="CONST(0)"/>
						<WTLINK name="JAVA(ShowTab('TabSalesSummary',1))"/>
					</WTITEM>
				</WTTAB>

				<WTFUNCTION name="ShowTab(tab, shw)">
					document.getElementById('TabSalesOrders').style.display = 'none';
					document.getElementById('TabSalesSummary').style.display = 'none';
					document.getElementById('TabPayments').style.display = 'none';
					document.getElementById('TabCredits').style.display = 'none';
					document.getElementById('TabBonuss').style.display = 'none';
					document.getElementById('TabPayouts').style.display = 'none';
					document.getElementById(tab).style.display = '';

					if ( tab == 'TabSalesOrders' ) {
					var src = document.getElementById('SalesOrdersFrame').src
					if (src.indexOf("5221.asp") &lt; 0 ) {
							src = '5221.asp?MemberID=' + document.getElementById('MemberID').value + '&amp;CompanyID=' + document.getElementById('CompanyID').value
							document.getElementById('SalesOrdersFrame').src = src
						}
					}
					if ( tab == 'TabSalesSummary' ) {
					var src = document.getElementById('SalesSummaryFrame').src
					if (src.indexOf("4411.asp") &lt; 0 ) {
							src = '4411.asp?MemberID=' + document.getElementById('MemberID').value 
							document.getElementById('SalesSummaryFrame').src = src
						}
					}
					if ( tab == 'TabPayments' ) {
						var src = document.getElementById('PaymentsFrame').src
						var pay = document.getElementById('PaymentPage').value 
						if (src.indexOf(pay + ".asp") &lt; 0 ) {
							src = pay + '.asp?MemberID=' + document.getElementById('MemberID').value
							document.getElementById('PaymentsFrame').src = src
						}
					}
					if ( tab == 'TabCredits' ) {
						var src = document.getElementById('CreditsFrame').src
						if (src.indexOf("11021.asp") &lt; 0 ) {
							src = '11021.asp?MemberID=' + document.getElementById('MemberID').value + '&amp;CompanyID=' + document.getElementById('CompanyID').value
							document.getElementById('CreditsFrame').src = src
						}
					}
					if ( tab == 'TabBonuss' ) {
					var src = document.getElementById('BonussFrame').src
					if (src.indexOf("0921.asp") &lt; 0 ) {
							src = '0921.asp?OwnerType=4&amp;OwnerID=' + document.getElementById('MemberID').value + '&amp;CompanyID=' + document.getElementById('CompanyID').value
							document.getElementById('BonussFrame').src = src
						}
					}
					if ( tab == 'TabPayouts' ) {
						var src = document.getElementById('PayoutsFrame').src
						var pay = document.getElementById('PayoutPage').value 
						if (src.indexOf(pay + ".asp") &lt; 0 ) {
							src = pay + '.asp?OwnerType=4&amp;OwnerID=' + document.getElementById('MemberID').value 
							document.getElementById('PayoutsFrame').src = src
						}
					}
			    </WTFUNCTION>  
				<WTFUNCTION name="LoadTab()">
					var code = document.getElementById('Code').value
					switch(code)
					{
					case '1':
						MemberTab.setCurrTab('SalesOrders');
						ShowTab('TabSalesOrders',0);
						break;
					case '2':
						MemberTab.setCurrTab('Payments');
						ShowTab('TabPayments',0);
						break;
					case '3':
						MemberTab.setCurrTab('Bonuss');
						ShowTab('TabBonuss',0);
						break;
					case '4':
						MemberTab.setCurrTab('Payouts');
						ShowTab('TabPayouts',0);
						break;
					case '5':
						MemberTab.setCurrTab('SalesSummary');
						ShowTab('TabSalesSummary',0);
						break;
					case '6':
						MemberTab.setCurrTab('Credits');
						ShowTab('TabCredits',0);
						break;
					}
				</WTFUNCTION>  
				<WTLOAD>
					LoadTab();
				</WTLOAD>

				<WTROW>
					<WTHIDDEN value="ATTR(Member.CompanyID)"/>
					<WTHIDDEN value="ATTR(Member.MemberID)"/>
					<WTHIDDEN value="PARAM(Code)"/>
					<WTHIDDEN value="PARAM(PaymentPage)"/>
					<WTHIDDEN value="PARAM(PayoutPage)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" align="left" class="PageHeading">
						<WTCODEGROUP><WTIMAGE value="CONST(Finance.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="2"/>
						<WTSTATIC tag="Finances"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC value="CONST(-)" space="1"/>
						<WTSTATIC value="CONST(#)"/>
						<WTSTATIC value="ATTR(Member.MemberID)"/>
					</WTSTATIC>
					<WTBUTTON col="2" action="3" value="CONST(Return)" align="right" btnclass="smbutton" class="PageHeader">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="2" value="CONST(Close)" align="right" btnclass="smbutton" class="PageHeader">
						<WTCONDITION expr="PARAM(Popup)" oper="greater" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
<!--        
				<WTROW>
					<WTSTATIC col="1" merge="2" label="FinanceText" class="prompt"/>
				</WTROW>
-->
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="left">
						<WTCODEGROUP><WTSTARTTAB name="MemberTab"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW id="TabSalesOrders">
					<WTFRAME col="1" merge="2" src="" name="SalesOrdersFrame" frmclass="FrameNoScroll" frmwidth="650" frmheight="800" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabSalesSummary">
					<WTFRAME col="1" merge="2" src="" name="SalesSummaryFrame" frmclass="FrameNoScroll" frmwidth="650" frmheight="800" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabPayments">
					<WTFRAME col="1" merge="2" src="" name="PaymentsFrame" frmclass="FrameNoScroll" frmwidth="650" frmheight="800" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabBonuss">
					<WTFRAME col="1" merge="2" src="" name="BonussFrame" frmclass="FrameNoScroll" frmwidth="650" frmheight="800" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabPayouts">
					<WTFRAME col="1" merge="2" src="" name="PayoutsFrame" frmclass="FrameNoScroll" frmwidth="650" frmheight="800" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabCredits">
					<WTFRAME col="1" merge="2" src="" name="CreditsFrame" frmclass="FrameNoScroll" frmwidth="650" frmheight="800" label="NoFrameSupport" border="0"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--==================================================================-->
		<WTWEBPAGE name="0490" caption="Fundraising Report" header="false" footer="false" navbar="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0490">
		<!--==================================================================-->
			<WTPARAM name="Rpt" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(CompanyName)"/>
				</WTOBJECT>
				<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
					<WTMETHOD name="FundRaisingSummary">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="FundRaisingDetail">
						<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left"/>

				<WTROW margin-top="6"/>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" label="FundRaisingSummaryReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" label="FundRaisingDetailReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="PARAM(Title)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(1)"/>
					<WTRECORDSET col="1" graybar="true" entity="Member">
						<WTCOLUMN width="40" align="left" valign="top" label="ReferredBy"/>
						<WTCOLUMN width="60" align="left" valign="top" label="Total"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Member.Reference)"/>
							<WTSTATIC col="2" value="DATA(Member.Quantity)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Rpt)" oper="equal" value="CONST(2)"/>
					<WTRECORDSET col="1" graybar="true" entity="Member">
						<WTCOLUMN width="40" align="left" valign="top" label="Family"/>
						<WTCOLUMN width="20" align="left" valign="top" label="EnrollDate"/>
						<WTCOLUMN width="40" align="left" valign="top" label="ReferredBy"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Member.CompanyName)"/>
							<WTSTATIC col="2" value="DATA(Member.EnrollDate)"/>
							<WTSTATIC col="3" value="DATA(Member.Reference)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
<!-- CloudZow Income Calculator -->
		<!--==========================================================================================-->
		<WTWEBPAGE name="0491" page-width="100%" header="false" navbar="false" footer="false" viewport="width=device-width"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0491">
		<!--==========================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="StartDate" datatype="date"/>
			<WTPARAM name="EndDate" datatype="date"/>
			<WTPARAM name="Week" datatype="number"/>

			<WTDATATXN name="IC"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="CloudZow" project="ptsCloudZowUser" class="CCloudZow">
<WTCUSTOM>
	If reqStartDate = "" Then reqStartDate = reqSysDate
	If reqWeek &lt;&gt; 0 Then reqStartDate = DateAdd("ww", reqWeek, reqStartDate)
	x = DatePart("w",reqStartDate)  
	x = x - 2
	If x &lt; 0 Then x = 6
	reqStartDate = DateAdd("d", x * -1, reqStartDate) 
	reqEndDate = DateAdd("d", 6, reqStartDate) 
</WTCUSTOM>
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(16)"/>
						<WTPARAM name="czDate" direction="input" value="PARAM(StartDate)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="result" direction="return" datatype="text"/>
					</WTMETHOD>
<WTCUSTOM>
xmlIC = "&lt;PTSIC " + result + "/&gt;"

Set oData = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
oData.loadXML xmlIC
Set oIC = oData.selectNodes("/PTSIC") 
reqTotal1 = 0
reqTotal2 = 0

For Each oIC In oData.selectNodes("/PTSIC")
	oIC.setAttribute("rc") = FormatCurrency(oIC.getAttribute("rc"), 0)
	oIC.setAttribute("fs") = FormatCurrency(oIC.getAttribute("fs"), 0)
	oIC.setAttribute("t") = FormatCurrency(oIC.getAttribute("t"), 0)
	oIC.setAttribute("l1") = FormatCurrency(oIC.getAttribute("l1"), 0)
	oIC.setAttribute("l2") = FormatCurrency(oIC.getAttribute("l2"), 0)
	oIC.setAttribute("l3") = FormatCurrency(oIC.getAttribute("l3"), 0)
	oIC.setAttribute("m") = FormatCurrency(oIC.getAttribute("m"), 0)
	oIC.setAttribute("total") = FormatCurrency(oIC.getAttribute("total"), 0)
Next	
xmlIC = oData.XML
Set oData = Nothing
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="75" align="right"/>
				<WTCOLUMN width="25" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
						<WTSTATIC label="IncomeCalculator" fontsize="4" newline="1"/>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTCODEGROUP><WTIMAGE value="CONST(Title&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBER/@titleb&quot;/&gt;.gif)" imgalign="absmiddle" path="Company/5"/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" bold="true" align="center">
						<WTSTATIC label="WeekOf" space="1"/>
						<WTSTATIC value="PARAM(StartDate)" space="1"/>
						<WTSTATIC value="CONST(-)" space="1"/>
						<WTSTATIC value="PARAM(EndDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
					<WTROW height="18">
						<WTSTATIC col="1" tag="RC"/>
						<WTSTATIC col="2" value="ATTR(IC.RC)" bold="true"/>
					</WTROW>
					<WTROW height="18">
						<WTSTATIC col="1" tag="FS"/>
						<WTSTATIC col="2" value="ATTR(IC.FS)" bold="true"/>
					</WTROW>
					<WTROW height="18">
						<WTSTATIC col="1" tag="T"/>
						<WTSTATIC col="2" value="ATTR(IC.T)" bold="true"/>
					</WTROW>
					<WTROW height="18">
						<WTSTATIC col="1" tag="L1"/>
						<WTSTATIC col="2" value="ATTR(IC.L1)" bold="true"/>
					</WTROW>
					<WTROW height="18">
						<WTSTATIC col="1" tag="L2"/>
						<WTSTATIC col="2" value="ATTR(IC.L2)" bold="true"/>
					</WTROW>
					<WTROW height="18">
						<WTSTATIC col="1" tag="L3"/>
						<WTSTATIC col="2" value="ATTR(IC.L3)" bold="true"/>
					</WTROW>
					<WTROW height="18">
						<WTSTATIC col="1" tag="M"/>
						<WTSTATIC col="2" value="ATTR(IC.M)" bold="true"/>
					</WTROW>
					<WTROW margin-top="3" margin-bottom="3">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" tag="Total" bold="true"/>
						<WTSTATIC col="2" value="ATTR(IC.Total)" bold="true"/>
					</WTROW>

				<WTROW margin-top="3" margin-bottom="3">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" label="Disclaimer" class="prompt" align="center"/>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" merge="2" tag="WeeksAhead" align="center"/>
					<WTTEXT col="1" value="PARAM(Week)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="m_ActivityTracker" caption="Activity Tracker" page-left="5" page-top="0" navbar="false" header="false" footer="false"
			page-image="bg7.jpg" page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="m_ActivityTracker" mobile="m_ActivityTracker.asp" track="0">
      <!--==================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Header" datatype="text"/>
      <WTPARAM name="MenuBehindColor" datatype="text"/>
      <WTPARAM name="MenuBehindImage" datatype="text"/>
      <WTPARAM name="Title" datatype="text"/>
      <WTPARAM name="PageImage" datatype="text"/>
      <WTPARAM name="C" datatype="number"/>

      <WTPARAM name="HeaderPosition" datatype="number"/>
      <WTPARAM name="HeaderAlign" datatype="number"/>
      <WTPARAM name="MenuAlign" datatype="number"/>
      <WTPARAM name="MenuBackground" datatype="number"/>

      <WTINCLUDE name="CompanyHeader.asp"/>
      <WTINCLUDE name="Portal.asp"/>
      <WTINCLUDE name="MenuColors.asp"/>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <!-- Security Checks -->
      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
          <WTRETURN>
            <WTLINK name="m_15005" return="false"/>
          </WTRETURN>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTCODEGROUP>
        <WTSETATTRIBUTE name="PARAM(C)" value="PARAM(MemberID)">
          <WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(NEXXUS)">
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
        <WTCUSTOM>
          reqHeader = GetHeader( reqCompanyID, 0, "MobileHeader", "" )
          If reqCompanyID = 21 Then reqHeader = "NexxusRewardsMobile.png"
          reqHeader = "company/" + CStr(reqCompanyID) + "/" + reqHeader
        </WTCUSTOM>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(MemberName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTCALLSUB name="GetMenuColors reqCompanyID, GroupID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>

      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="100" align="left"/>

        <WTFUNCTION name="ShowTab(tab, shw)">
          var mid = document.getElementById('MemberID').value;
          var cid = document.getElementById('CompanyID').value;
          var frame, url, frm, src, page, target='', style='', compare=0, load=0, comingsoon=0;

          switch(tab) {
          case 'TabActivity':
            frame = 'ActivityFrame';
            switch(shw) {
              case 1: url = 'm_11711.asp?memberid=' + mid; break;
              case 2: url = 'm_11710.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
              case 3: url = 'm_11712.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
              case 4: url = 'm_12610.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
              case 5: url = 'm_11721.asp?memberid=' + mid; break;
              case 6: url = '11760.asp?mobile=1&amp;memberid=' + mid; target='ActivityReports'; break;
            } break;
          }
          if( target.length &gt; 0 ) {
            win = window.open(url,target,style);
            win.focus();
          }
          else {
            frm = document.getElementById(frame);
            src = frm.src;
            if( compare == 0 ) { compare = url.indexOf('.') }
            page = url.substring(0,compare);
            if (load == 1 || src.indexOf(page) &lt; 0 ) {frm.src = url} else {ShowFrame(tab)}
          }
        </WTFUNCTION>

        <WTFUNCTION name="ShowFrame(tab)">
          //document.getElementById('TabActivity').style.display = 'none';
          //document.getElementById(tab).style.display = '';
        </WTFUNCTION>

        <WTLOAD>
          ShowTab('TabActivity',1);
        </WTLOAD>

        <WTMENU name="UserMenu" type="bar" menuwidth="125" top-color="CONST(MenuTopColor)" top-bgcolor="CONST(MenuTopBGColor)"
						color="CONST(MenuColor)" bgcolor="CONST(MenuBGColor)" shadow-color="CONST(MenuShadowColor)" bdcolor="CONST(MenuBDColor)"
						over-color="CONST(MenuOverColor)" over-bgcolor="CONST(MenuOverBGColor)" divider-color="CONST(MenuDividerColor)" top-bgimg="CONST(MenuTopImage)" bgimg="CONST(MenuImage)">
          <WTITEM width="40" menuwidth="150">
            <WTIMAGE name="Menu2.png" width="29" height="30"/>
            <WTITEM label="mActivities" width="150" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsActivityTracker"/>
              <WTIMAGE name="Activity.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabActivity',1))"/>
            </WTITEM>
            <WTITEM label="mLeaderBoard" width="150" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsActivityTracker"/>
              <WTIMAGE name="leaderboard.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabActivity',2))"/>
            </WTITEM>
            <WTITEM label="mActivityStatistics" width="150" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsActivityContest"/>
              <WTIMAGE name="Contest.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabActivity',3))"/>
            </WTITEM>
            <WTITEM label="mContests" width="150" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsActivityContest"/>
              <WTIMAGE name="Contest.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabActivity',4))"/>
            </WTITEM>
            <WTITEM label="mActivityGoals" width="150" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsActivityTracker"/>
              <WTIMAGE name="Goal.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabActivity',5))"/>
            </WTITEM>
            <WTITEM label="mActivityReports" width="150" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsActivityReports"/>
              <WTIMAGE name="Chart.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabActivity',6))"/>
            </WTITEM>
            <WTITEM label="mSignout" width="150" height="40" menuwidth="150" menuheight="40">
              <WTIMAGE name="close.gif" width="18" height="18"/>
              <WTLINK name="m_15005" nodata="true"/>
            </WTITEM>
          </WTITEM>
          <WTITEM value="CONST(MemberName)" width="220" align="center"/>
          <WTITEM width="40">
            <WTIMAGE name="Refresh2.png" width="29" height="30"/>
            <WTLINK name="JAVA(doSubmit(0,''))"/>
          </WTITEM>
        </WTMENU>

        <WTROW>
          <WTHIDDEN value="PARAM(MemberID)"/>
          <WTHIDDEN value="PARAM(CompanyID)"/>
        </WTROW>

        <WTROW margin-bottom="6">
          <WTIMAGE col="1" align="center" value="PARAM(Header)"/>
        </WTROW>
        <WTROW height="36">
          <WTSTATIC col="1" align="left" valign="top" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
            <WTCODEGROUP>
              <WTSTARTMENU name="UserMenu" type="bar"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

        <!-- ======================================================================= -->
        <WTROW id="TabActivity">
          <WTFRAME col="1" src="" name="ActivityFrame" frmclass="FrameNoScroll" onload="ShowFrame('TaActivity')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->

        <WTROW>
          <WTSTATIC col="1" align="right">
            <WTCODEGROUP>
              <WTTRANSLATE/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

  </WTWEBPAGES>
</WTROOT>