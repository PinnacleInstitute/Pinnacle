<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="25" name="Party" alias="py" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="2501" name="PartyID" type="number" identity="true" min="1" required="true" source="entity"/>
	
		<!--Foreign Keys-->
		<WTATTRIBUTE id="2502" name="ApptID" type="number" source="entity"/>
		
		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="2503" name="PartyName" type="text" length="60" source="join">
			<WTJOIN entity="Appt" name="ApptName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2504" name="StartDate" type="date" source="join">
			<WTJOIN entity="Appt" name="StartDate"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2505" name="StartTime" type="text" length="8" source="join">
			<WTJOIN entity="Appt" name="StartTime"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2506" name="EndDate" type="date" source="join">
			<WTJOIN entity="Appt" name="EndDate"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2507" name="EndTime" type="text" length="8" source="join">
			<WTJOIN entity="Appt" name="EndTime"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="2510" name="NameLast" type="text" length="15" min="1" max="15" source="entity"/>
		<WTATTRIBUTE id="2511" name="NameFirst" type="text" length="15" min="1" max="15" source="entity"/>
		<WTATTRIBUTE id="2512" name="HostName" type="text" length="32" min="1" max="32" source="entity" title="true">
			<WTCOMPUTE name="NameFirst"/>
			<WTCOMPUTE text=" "/>
			<WTCOMPUTE name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2513" name="Email" type="text" length="80" min="1" max="80" source="entity"/>
		<WTATTRIBUTE id="2514" name="IsTrained" type="yesno" source="entity"/>
		<WTATTRIBUTE id="2515" name="Phone" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="2516" name="Location" type="text" length="60" min="1" max="60" source="entity"/>
		<WTATTRIBUTE id="2517" name="Street" type="text" length="60" min="1" max="60" source="entity"/>
		<WTATTRIBUTE id="2518" name="Unit" type="text" length="40" min="1" max="40" source="entity"/>
		<WTATTRIBUTE id="2519" name="City" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="2520" name="State" type="text" length="30" min="1"  max="30" source="entity"/>
		<WTATTRIBUTE id="2521" name="Zip" type="text" length="20" min="1"  max="20" source="entity"/>
		<WTATTRIBUTE id="2522" name="Country" type="text" length="30" min="1"  max="30" source="entity"/>
		<WTATTRIBUTE id="2523" name="IsMap" type="yesno" source="entity"/>
		<WTATTRIBUTE id="2524" name="Message" type="text" length="2000" min="1" max="2000" source="entity" embedhtml="true"/>
		<WTATTRIBUTE id="2525" name="Theme" type="number" source="entity"/>
		<WTATTRIBUTE id="2526" name="CustomTheme" type="number" source="entity"/>
		<WTATTRIBUTE id="2527" name="Sales" type="currency" source="entity"/>
		<WTATTRIBUTE id="2528" name="IsShop" type="yesno" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="2590" name="MemberID" type="number" source="entity" persist="false"/>

		<!--Indexes-->
		<WTINDEX name="ApptID">
			<WTATTRIBUTE name="ApptID"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Party" entity="Party" alias="py"/>
			<WTRELATIONSHIP name="Common" entity="Party" alias="py">
				<WTENTITY name="Appt" entity="Appt" alias="ap">
					<WTATTRIBUTE alias="py" name="ApptID" relalias="ap" relname="ApptID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Member" entity="Party" alias="py">
				<WTENTITY name="Appt" entity="Appt" alias="ap">
					<WTATTRIBUTE alias="py" name="ApptID" relalias="ap" relname="ApptID"/>
				</WTENTITY>
				<WTENTITY name="Calendar" entity="Calendar" alias="ca">
					<WTATTRIBUTE alias="ap" name="CalendarID" relalias="ca" relname="CalendarID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="STATUS-YES" value="3"/>
			<WTSYSCON name="STATUS-NO" value="4"/>
			<WTSYSCON name="STATUS-MAYBE" value="5"/>
		</WTSYSCONS>

	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchPartyID" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(ApptID)" direction="input"/>
			<WTPARAM name="ATTR(PartyID)" direction="output"/>
			<WTDECLARE name="PartyID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="PartyID" value="ATTR(Party.PartyID)"/>
					<WTJOIN name="Party" lock="false"/>
					<WTCONDITION expr="ATTR(Party.ApptID)" oper="equal" value="PARAM(ApptID)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(PartyID)" value="PartyID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE name="FetchMemberID" type="Fetch" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(PartyID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="output"/>
			<WTDECLARE name="MemberID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="MemberID" value="ATTR(Calendar.MemberID)"/>
					<WTJOIN name="Member" lock="false"/>
					<WTCONDITION expr="ATTR(Party.PartyID)" oper="equal" value="PARAM(PartyID)"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(MemberID)" value="MemberID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="DeleteAppt" style="GenerateDataProc.xsl" template="new">
			<WTPARAM name="ATTR(ApptID)" direction="input"/>
			<WTCODEGROUP>
				<WTDELETE>
					<WTJOIN name="Party" lock="true"/>
					<WTCONDITION expr="ATTR(Party.ApptID)" oper="equal" value="PARAM(ApptID)"/>
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================================-->
		<WTPROCEDURE type="List" name="ListMember" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true">
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Party.PartyID)"/>
					<WTATTRIBUTE value="ATTR(Appt.PartyName)"/>
					<WTATTRIBUTE alias="HostName" value="ATTR(Appt.HostName)"/>
					<WTATTRIBUTE value="ATTR(Appt.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Appt.StartTime)"/>
					<WTATTRIBUTE value="ATTR(Party.Sales)"/>
					<WTJOIN name="Member"/>
					<WTCONDITION expr="ATTR(Calendar.MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTORDER name="ATTR(Appt.StartDate)" descend="true"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="CalcSales" type="Command" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(PartyID)" direction="input"/>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--==================================================================-->
		<WTWEBPAGE name="2502" caption="Party Plan" navbar="false" header="false" footer="false" 
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--==================================================================-->
			<WTPARAM name="ApptID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="FetchPartyID">
						<WTPARAM name="ApptID" direction="input" value="PARAM(ApptID)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PartyID)" oper="not-equal" value="CONST(0)"/>
						<WTRETURN>
							<WTLINK name="2503" return="false">
								<WTPARAM name="PartyID" value="ATTR(PartyID)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(ApptID)" value="PARAM(ApptID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlParty" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(ApptID)" value="PARAM(ApptID)"/>
					<WTSETATTRIBUTE name="ATTR(Theme)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(IsShop)" value="CONST(1)">
						<WTCONDITION expr="IsShopping"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTPARAM name="PartyID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlParty" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="2503" return="false">
						<WTPARAM name="PartyID" value="CONST(PartyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="80" align="right"/>
				<WTCOLUMN width="320" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="left">
						<WTCODEGROUP><WTIMAGE value="CONST(plan.gif)" imgalign="absmiddle"/></WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NewParty"/>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
								<WTLINK name="Tutorial" target="Tutorial">
									<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-PLANNER)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
									<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="3" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="HostName"/>
					<WTTEXT col="2" value="ATTR(Party.NameFirst)" width="120" label="NameFirst"/>
					<WTTEXT col="2" value="ATTR(Party.NameLast)" width="200" label="NameLast"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Party.Email)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Party.IsTrained)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="2503" caption="Party Plan" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--==================================================================-->
			<WTPARAM name="PartyID" datatype="number"/>
			<WTPARAM name="Txn" datatype="number"/>
			<WTPARAM name="Code" datatype="number"/>
			<WTPARAM name="URL" datatype="text"/>

			<WTCODEGROUP>
<WTCUSTOM>
	reqURL = "http://" + reqSysServerName + reqSysServerPath + "2503.asp?partyid=" &amp; reqPartyID
</WTCUSTOM>
			</WTCODEGROUP>

			<WTSUB name="LoadParty">
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="PARAM(PartyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="IsAnonymous"/>
						<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(0)">
							<WTCONDITION expr="CONST(CLng(reqCode))" oper="equal" value="CONST(CLng(.ApptID))"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(5)">
							<WTCONDITION expr="CONST(CLng(reqCode))" oper="not-equal" value="CONST(CLng(.ApptID))"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlParty" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTGETCACHE name="CONST(tmpCode)" value="ACCESSCODE"/>
					<WTSETATTRIBUTE name="PARAM(Code)" value="CONST(tmpCode)">
						<WTCONDITION expr="CONST(tmpCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Code)" value="CONST(0)">
						<WTCONDITION expr="CONST(tmpCode)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTCALLSUB name="LoadParty"/>
			</WTACTION>

			<WTACTION id="5" name="Code" type="New">
				<WTSETCACHE name="ACCESSCODE" value="PARAM(Code)"/>
				<WTCALLSUB name="LoadParty"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="PARAM(PartyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlParty" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(2)"/>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTCONDITION expr="IsEmployee"/>
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="Delete">
						<WTPARAM name="PartyID" direction="input" value="PARAM(PartyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="PARAM(Txn)" value="CONST(3)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="PARAM(PartyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlParty" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="80" align="right"/>
				<WTCOLUMN width="320" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(3)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="SuccessfullyDeleted" align="center" class="PageHeading"/>
					</WTROW>
					<WTROW>
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(5)"/>
					<WTROW>
						<WTSTATIC col="1" merge="2" tag="AccessCode" align="center"/>
						<WTTEXT col="1" value="PARAM(Code)" size="4"/>
						<WTSTATIC col="1">
							<WTCODEGROUP>
								<WTIMAGE value="CONST(Tutorial.gif)" imgalign="absmiddle">
									<WTLINK name="Pagex" target="Tutorial">
										<WTPARAM name="Page" value="CONST(MeetingHost)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" action="5" value="CONST(Continue)" align="center"/>
						<WTBUTTON col="1" value="CONST(Close)">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Txn)" oper="less" value="CONST(3)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="IsAnonymous"/>
						<WTCONDITION expr="ATTR(Party.IsTrained)" oper="equal" value="CONST(0)" connector="and"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTSTATIC col="1" merge="2" label="TrainingRequired" align="center" class="PageHeading" fontcolor="red"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW>
						<WTSTATIC col="1" merge="2" class="PageHeading" align="left">
							<WTCODEGROUP><WTIMAGE value="CONST(plan.gif)" imgalign="absmiddle"/></WTCODEGROUP>
							<WTSTATIC space="1"/>
							<WTSTATIC label="Party"/>
							<WTCODEGROUP>
								<WTCONDITION expr="_IsPinnacleTutorial"/>
								<WTCONDITION expr="NotAnonymous" connector="and"/>
								<WTSTATIC space="1"/>
								<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
									<WTLINK name="Tutorial" target="Tutorial">
										<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-PLANNER)"/>
										<WTPARAM name="contentpage" value="CONST(3)"/>
										<WTPARAM name="popup" value="CONST(1)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="IsAnonymous"/>
								<WTSTATIC space="1"/>
								<WTIMAGE value="CONST(Tutorial.gif)" imgalign="absmiddle">
									<WTLINK name="Pagex" target="Tutorial">
										<WTPARAM name="Page" value="CONST(MeetingHost)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Txn)" oper="equal" value="CONST(2)"/>
								<WTSTATIC space="1"/>
								<WTSTATIC label="SuccessfullyUpdated" fontcolor="red" bold="true"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="3" margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" align="center">
							<WTSTATIC value="ATTR(Party.PartyName)" space="2" fontcolor="blue"/>
							<WTSTATIC fontcolor="purple">
								<WTSTATIC value="ATTR(Party.StartDate)" space="2"/>
								<WTSTATIC value="ATTR(Party.StartTime)" space="1"/>
								<WTSTATIC label="to" space="1">
									<WTCONDITION expr="ATTR(Party.StartDate)" oper="not-equal" value="ATTR(Party.EndDate)"/>
									<WTCONDITION expr="ATTR(Party.EndTime)" oper="not-equal" value="CONST('')" connector="or"/>
								</WTSTATIC>
								<WTSTATIC value="ATTR(Party.EndDate)" space="2">
									<WTCONDITION expr="ATTR(Party.StartDate)" oper="not-equal" value="ATTR(Party.EndDate)"/>
								</WTSTATIC>
								<WTSTATIC value="ATTR(Party.EndTime)">
									<WTCONDITION expr="ATTR(Party.EndTime)" oper="not-equal" value="CONST('')"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="3" margin-bottom="3">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="HostName"/>
						<WTTEXT col="2" value="ATTR(Party.NameFirst)" width="120" label="NameFirst"/>
						<WTTEXT col="2" value="ATTR(Party.NameLast)" width="200" label="NameLast"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Email"/>
						<WTTEXT col="2" value="ATTR(Party.Email)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Phone"/>
						<WTTEXT col="2" value="ATTR(Party.Phone)" size="30"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="NotAnonymous"/>
						<WTSTATIC col="1"/>
						<WTCHECK col="2" value="ATTR(Party.IsTrained)"/>
						<WTSTATIC col="2" space="2" bold="true">
							<WTCONDITION expr="ATTR(Party.Sales)" oper="not-equal" value="CONST('$0.00')"/>
							<WTSTATIC tag="Sales"/>
							<WTSTATIC value="ATTR(Party.Sales)"/>
						</WTSTATIC>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
							<WTCONDITION expr="IsActive"/>
						</WTBUTTON>
						<WTBUTTON col="1" value="CONST(Close)">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" action="4" value="CONST(Delete)" msg="ConfirmDelete">
							<WTCONDITION expr="IsActive"/>
							<WTCONDITION expr="NotAnonymous" connector="and"/>
						</WTBUTTON>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTCONDITION expr="NotAnonymous"/>
						<WTCONDITION expr="ATTR(Party.IsTrained)" oper="not-equal" value="CONST(0)" connector="or"/>
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="50" align="center"/>
							<WTCOLUMN width="100" align="center"/>
							<WTCOLUMN width="100" align="center"/>
							<WTCOLUMN width="100" align="center"/>
							<WTCOLUMN width="50" align="center"/>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(Invitation.gif)">
									<WTLINK name="2504" return="false" target="Invitation">
										<WTPARAM name="PartyID" value="PARAM(PartyID)"/>
									</WTLINK>
								</WTIMAGE>
								<WTIMAGE col="3" value="CONST(Guests.gif)">
									<WTLINK name="2611" return="false" target="Guests">
										<WTPARAM name="PartyID" value="PARAM(PartyID)"/>
									</WTLINK>
								</WTIMAGE>
								<WTIMAGE col="4" value="CONST(Noteslg.gif)">
									<WTLINK name="9005" return="false" target="Notes">
										<WTPARAM name="OwnerType" value="ENTITY(Party)"/>
										<WTPARAM name="OwnerID" value="PARAM(PartyID)"/>
										<WTPARAM name="Title" value="ATTR(Party.PartyName)"/>
									</WTLINK>
								</WTIMAGE>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" label="Invitation" bold="true">
									<WTLINK name="2504" return="false" target="Invitations">
										<WTPARAM name="PartyID" value="PARAM(PartyID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC col="3" label="Guests" bold="true">
									<WTLINK name="2611" return="false" target="Guests">
										<WTPARAM name="PartyID" value="PARAM(PartyID)"/>
									</WTLINK>
								</WTSTATIC>
								<WTSTATIC col="4" label="Notes" bold="true">
									<WTLINK name="9005" return="false" target="Notes">
										<WTPARAM name="OwnerType" value="ENTITY(Party)"/>
										<WTPARAM name="OwnerID" value="PARAM(PartyID)"/>
										<WTPARAM name="Title" value="ATTR(Party.PartyName)"/>
									</WTLINK>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr="NotAnonymous"/>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" merge="2" align="center" fontcolor="blue">
								<WTSTATIC tag="hostaccess" bold="true"/>
								<WTSTATIC value="PARAM(URL)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTSTATIC col="1" merge="2" align="center" fontcolor="blue">
								<WTSTATIC tag="AccessCode" bold="true"/>
								<WTSTATIC value="ATTR(Party.ApptID)"/>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="2504" caption="Party Invitation" navbar="false" header="false" footer="false" 
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="2504">
		<!--===============================================================================-->
			<WTPARAM name="PartyID" datatype="number"/>

			<WTSUB name="UpdateParty">
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="PARAM(PartyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlParty" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="PARAM(PartyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlParty" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateParty"/>
			</WTACTION>

			<WTACTION id="2" name="Preview" type="Update">
				<WTCALLSUB name="UpdateParty"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="2506" nolocaldata="true">
						<WTPARAM name="P" value="PARAM(PartyID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTSTATIC label="IsMap"/>
				<WTSTATIC label="IsShop"/>

				<WTROW>
					<WTIMAGE col="1" merge="2" value="CONST(Invitationsm.gif)" align="left" imgalign="absmiddle"/>
					<WTSTATIC col="1" merge="2" align="left">
						<WTSTATIC tag="Invitation" value="ATTR(Party.PartyName)" space="2" fontcolor="blue"/>
						<WTSTATIC fontcolor="purple">
							<WTSTATIC value="ATTR(Party.StartDate)" space="2"/>
							<WTSTATIC value="ATTR(Party.StartTime)" space="1"/>
							<WTSTATIC label="to" space="1">
								<WTCONDITION expr="ATTR(Party.StartDate)" oper="not-equal" value="ATTR(Party.EndDate)"/>
								<WTCONDITION expr="ATTR(Party.EndTime)" oper="not-equal" value="CONST('')" connector="or"/>
							</WTSTATIC>
							<WTSTATIC value="ATTR(Party.EndDate)" space="2">
								<WTCONDITION expr="ATTR(Party.StartDate)" oper="not-equal" value="ATTR(Party.EndDate)"/>
							</WTSTATIC>
							<WTSTATIC value="ATTR(Party.EndTime)">
								<WTCONDITION expr="ATTR(Party.EndTime)" oper="not-equal" value="CONST('')"/>
							</WTSTATIC>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="HostName"/>
					<WTSTATIC col="2" value="ATTR(Party.HostName)" bold="true"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="Theme"/>
					<WTCOMBO  col="2" value="ATTR(Party.Theme)">
						<WTOPTION id="1" label="Theme1"/>
						<WTOPTION id="2" label="Theme2"/>
						<WTOPTION id="3" label="Theme3"/>
						<WTOPTION id="4" label="Theme4"/>
						<WTOPTION id="5" label="Theme5"/>
						<WTOPTION id="6" label="Theme6"/>
						<WTOPTION id="7" label="Theme7"/>
						<WTOPTION id="8" label="Theme8"/>
						<WTOPTION id="9" label="Theme9"/>
						<WTOPTION id="10" label="Theme10"/>
						<WTOPTION id="11" label="Theme11"/>
						<WTOPTION id="12" label="Theme12"/>
						<WTOPTION id="13" label="Theme13"/>
						<WTOPTION id="14" label="Theme14"/>
						<WTOPTION id="15" label="Theme15"/>
						<WTOPTION id="16" label="Theme16"/>
						<WTOPTION id="17" label="Theme17"/>
						<WTOPTION id="18" label="Theme18"/>
						<WTOPTION id="19" label="Theme19"/>
						<WTOPTION id="20" label="Theme20"/>
						<WTOPTION id="21" label="Theme21"/>
						<WTOPTION id="22" label="Theme22"/>
						<WTOPTION id="23" label="Theme23"/>
						<WTOPTION id="24" label="Theme24"/>
						<WTOPTION id="25" label="Theme25"/>
						<WTOPTION id="26" label="Theme26"/>
						<WTOPTION id="27" label="Theme27"/>
						<WTOPTION id="28" label="Theme28"/>
						<WTOPTION id="29" label="Theme29"/>
						<WTOPTION id="30" label="Theme30"/>
						<WTOPTION id="31" label="Theme31"/>
					</WTCOMBO>
					<WTBUTTON col="2" action="2" value="CONST(Preview)"/>
					<WTSTATIC col="2">
						<WTCODEGROUP>
							<WTSTATIC tag="CustomTheme"/>
							<WTTEXT value="ATTR(Party.CustomTheme)" size="2" prespace="false"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="Location"/>
					<WTTEXT col="2" value="ATTR(Party.Location)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Party.Street)" width="294" label="Street" size="40"/>
					<WTTEXT col="2" value="ATTR(Party.Unit)" width="146" label="Unit" size="10"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Party.City)" width="200" label="City" size="25"/>
					<WTTEXT col="2" value="ATTR(Party.State)" width="240" label="State" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Party.Zip)" width="200" label="Zip" size="25"/>
					<WTTEXT col="2" value="ATTR(Party.Country)" width="240" label="Country" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Party.IsMap)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Party.IsShop)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Message" align="left"/>
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Party.Message)" cols="72" rows="8" htmleditor="editor_simple" embedhtml="true"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="2505" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Title" datatype="text"/>
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>
				<WTROW>
					<WTSTATIC col="1" value="PARAM(Title)" class="PageHeading"/>
				</WTROW>
				<WTROW>
					<WTFRAME col="1" src="CONST(2511.asp?MemberID=&lt;xsl:value-of select=&quot;/DATA/PARAM/@memberid&quot;/&gt;&amp;amp;Title=&lt;xsl:value-of select=&quot;/DATA/PARAM/@title&quot;/&gt;)" name="PartysFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="600" label="NoFrameSupport" border="0"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="2506" caption="Invitation Preview" navbar="false" header="false" footer="false" 
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--===============================================================================-->
			<WTPARAM name="P" datatype="number"/>
			<WTPARAM name="G" datatype="number"/>
			<WTPARAM name="Address" datatype="text"/>
			<WTPARAM name="IsShop" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>

			<WTSUB name="LoadInvitation">
				<WTSETATTRIBUTE name="CONST(tmpFirstName)" value="CONST(&quot;Jane&quot;)"/>
				<WTSETATTRIBUTE name="CONST(tmpLastName)" value="CONST(&quot;Smith&quot;)"/>
				<WTOBJECT name="Guest" project="ptsGuestUser" class="CGuest">
					<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="GuestID" direction="input" value="PARAM(G)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(P)" value="ATTR(PartyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpFirstName)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpLastName)" value="ATTR(NameLast)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlGuest" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Party" project="ptsPartyUser" class="CParty">
					<WTMETHOD name="Load">
						<WTPARAM name="PartyID" direction="input" value="PARAM(P)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(IsShop)" value="ATTR(IsShop)"/>
<WTCUSTOM>
			If .CustomTheme &gt; 0 Then
				tmpTheme = .CustomTheme
			Else
				tmpTheme = .Theme
			End If
			tmpPartyName = .PartyName
			tmpHostName = .HostName
			tmpLocation = .Location
			tmpAddress = .Street
			If .Unit &lt;&gt; "" Then tmpAddress = tmpAddress + " " + .Unit
			If .City &lt;&gt; "" Then tmpAddress = tmpAddress + ", " + .City
			If .State &lt;&gt; "" Then tmpAddress = tmpAddress + ", " + .State
			tmpAddress = tmpAddress + " " + .Zip + " " + .Country
			tmpWhen = WeekdayName(Weekday(.StartDate)) + ", "
			tmpWhen = tmpWhen + .StartDate + " " + .StartTime
			If .StartDate &lt;&gt; .EndDate Or .EndTime &lt;&gt; "" Then
				tmpWhen = tmpWhen + " - "
				If .StartDate &lt;&gt; .EndDate Then tmpWhen = tmpWhen + .EndDate + " "
				If .EndTime &lt;&gt; "" Then tmpWhen = tmpWhen + .EndTime
			End If	
			tmpPhone = .Phone
			tmpMessage = .Message
			If .IsMap &lt;&gt; "0" Then reqAddress = tmpAddress 
</WTCUSTOM>
					<WTMETHOD name="FetchMemberID">
						<WTPARAM name="PartyID" direction="input" value="PARAM(P)"/>
						<WTPARAM name="reqMemberID" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Invitation&quot; &amp; tmpTheme &amp; &quot;.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
<WTCUSTOM>
	xmlHTMLFile = Replace( xmlHTMLFile, "{firstname}", CleanXMLComment(tmpFirstName) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{lastname}", CleanXMLComment(tmpLastName) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{partyname}", CleanXMLComment(tmpPartyName) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{hostname}", CleanXMLComment(tmpHostName) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{location}", CleanXMLComment(tmpLocation) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{address}", CleanXMLComment(tmpAddress) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{when}", CleanXMLComment(tmpWhen) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{phone}", CleanXMLComment(tmpPhone) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{message}", CleanXMLComment(tmpMessage) )
</WTCUSTOM>
			</WTSUB>

			<WTSUB function="UpdateGuest(status)">
				<WTOBJECT name="Guest" project="ptsGuestUser" class="CGuest">
					<WTMETHOD name="Load">
						<WTPARAM name="GuestID" direction="input" value="PARAM(G)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(status)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadInvitation"/>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadInvitation"/>
			</WTACTION>

			<WTACTION id="1" name="Yes" type="Update">
				<WTCALLSUB name="UpdateGuest(3)"/>
			</WTACTION>

			<WTACTION id="2" name="No" type="Update">
				<WTCALLSUB name="UpdateGuest(4)"/>
			</WTACTION>

			<WTACTION id="4" name="Maybe" type="Update">
				<WTCALLSUB name="UpdateGuest(5)"/>
			</WTACTION>

			<WTACTION id="5" name="Shopping" type="Update">
				<WTRETURN>
					<WTLINK name="5250" nolocaldata="true">
						<WTPARAM name="C" value="SYS(CompanyID)"/>
						<WTPARAM name="SP" value="PARAM(MemberID)"/>
						<WTPARAM name="PA" value="PARAM(P)"/>
						<WTPARAM name="N" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Return" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(Address)"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTCONDITION expr="ATTR(Guest.Status)" oper="greater-equal" value="SYSCON(STATUS-YES)"/>
					<WTSTATIC col="1" align="center" class="PageHeading" fontcolor="red">
						<WTSTATIC label="RSVPYES">
							<WTCONDITION expr="ATTR(Guest.Status)" oper="equal" value="SYSCON(STATUS-YES)"/>
						</WTSTATIC>
						<WTSTATIC label="RSVPNO">
							<WTCONDITION expr="ATTR(Guest.Status)" oper="equal" value="SYSCON(STATUS-NO)"/>
						</WTSTATIC>
						<WTSTATIC label="RSVPMAYBE">
							<WTCONDITION expr="ATTR(Guest.Status)" oper="equal" value="SYSCON(STATUS-MAYBE)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
					<WTBUTTON col="1" value="CONST(ViewMap)" align="center">
						<WTCONDITION expr="PARAM(Address)" oper="not-equal" value="CONST('')"/>
						<WTCLICK>
							var url, win;
							url = "http://maps.google.com/maps?q=" + document.getElementById('Address').value 
							win = window.open(url);
							win.focus();
						</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
					<WTBUTTON col="1" value="CONST(ViewMap)" align="center">
						<WTCONDITION expr="PARAM(Address)" oper="not-equal" value="CONST('')"/>
						<WTCLICK>
							var url, win;
							url = "http://maps.google.com/maps?q=" + document.getElementById('Address').value 
							win = window.open(url);
							win.focus();
						</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" action="5" value="CONST(Shopping)" align="center">
						<WTCONDITION expr="PARAM(IsShop)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="1" value="CONST(StatusYes)" align="center"/>
					<WTBUTTON col="1" action="2" value="CONST(StatusNo)" align="center"/>
					<WTBUTTON col="1" action="4" value="CONST(StatusMaybe)" align="center"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="2511" caption="Member Parties" contentpage="true" 
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" track="0">
		<!--============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Partys" project="ptsPartyUser" class="CPartys">
					<WTMETHOD name="ListMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlPartys" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTFUNCTION name="EditParty(id)">
					url = "2503.asp?partyid=" + id;
					win = window.open(url,"Party","top=100,left=100,height=325,width=450,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTSTATIC col="1" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(plan32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="Partys"/>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
								<WTLINK name="Tutorial" target="Tutorial">
									<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-PLANNER)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
									<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="3" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" align="center">
						<WTCODEGROUP>
							<WTIMAGE valign="center" value="CONST(Calendar.gif)" imgalign="absmiddle">
								<WTLINK name="Calendar" target="blank">
									<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="NewPartyText">
							<WTLINK name="Calendar" target="blank">
								<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTSTATIC label="ViewSales"/>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Party">
						<WTCOLUMN width="40" align="left" valign="top" label="PartyName"/>
						<WTCOLUMN width="30" align="left" valign="top" label="HostName"/>
						<WTCOLUMN width="18" align="left" valign="top" label="StartDate"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Sales"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Party.PartyName)" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(edit.gif)" valign="top" imgalign="absmiddle">
										<WTLINK click="true" name="CONST(EditParty(&lt;xsl:value-of select=&quot;@partyid&quot;/&gt;))"/>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Party.HostName)"/>
							<WTSTATIC col="3">
								<WTSTATIC value="DATA(Party.StartDate)" space="1"/>
								<WTSTATIC value="DATA(Party.StartTime)"/>
							</WTSTATIC>
<!--							<WTSTATIC col="4" value="DATA(Party.Sales)"/>-->
							<WTIMAGE col="4" value="CONST(preview.gif)" alt="ViewSales" imgalign="absmiddle">
								<WTLINK name="5210" target="PartyOrders"><WTPARAM name="PartyID" value="DATA(Party.PartyID)"/></WTLINK>
							</WTIMAGE>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCONDITION expr="PARAM(Popup)" oper="greater" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>