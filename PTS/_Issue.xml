<WTROOT prefix="pts" system="Pinnacle">
	<WTENTITY id="95" name="Issue" alias="zis" log="false">

		<!--Identity-->
		<WTATTRIBUTE id="9501" name="IssueID" type="number" identity="true" min="1" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="9502" name="CompanyID" type="number" source="entity"/>
		<WTATTRIBUTE id="9503" name="IssueCategoryID" type="number" min="1" source="entity"/>
		<WTATTRIBUTE id="9504" name="SubmitID" type="number" source="entity"/>
		
		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="9505" name="IssueCategoryName" type="text" length="20" min="1" max="20" source="join">
			<WTJOIN entity="IssueCategory" name="IssueCategoryName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9506" name="InputOptions" type="text" length="1000" min="1" max="1000" source="join">
			<WTJOIN entity="IssueCategory" name="InputOptions"/>
			<WTINPUTOPTIONS name="InputOptions" values="InputValues"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="9510" name="IssueDate" type="date" source="entity">
			<WTFORMAT value="m-d-yy h:mm am/pm"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9511" name="IssueName" type="text" length="60" min="1" max="60" required="true" title="true" source="entity"/>
		<WTATTRIBUTE id="9512" name="SubmittedBy" type="text" length="40" min="1" max="40" source="entity"/>
		<WTATTRIBUTE id="9513" name="SubmitType" type="number" source="entity"/>
		<WTATTRIBUTE id="9514" name="Priority" type="number" source="entity">
			<WTENUM id="1" name="High"/>
			<WTENUM id="2" name="Medium"/>
			<WTENUM id="3" name="Low"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9515" name="Description" type="text" length="1000" min="1" max="1000" source="entity"/>
		<WTATTRIBUTE id="9516" name="AssignedTo" type="text" length="15" min="1" max="15" source="entity"/>
		<WTATTRIBUTE id="9517" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Submitted"/>
			<WTENUM id="2" name="Assigned"/>
      <WTENUM id="3" name="InProcess"/>
      <WTENUM id="4" name="Resolved"/>
			<WTENUM id="5" name="Postponed"/>
			<WTENUM id="6" name="Tested"/>
			<WTENUM id="7" name="Deployed"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9518" name="Notes" type="text" length="2000" min="1" max="2000" source="entity"/>
		<WTATTRIBUTE id="9519" name="ChangeDate" type="date" source="entity">
			<WTFORMAT value="m-d-yy h:mm am/pm"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="9520" name="DueDate" type="date" source="entity"/>
		<WTATTRIBUTE id="9521" name="DoneDate" type="date" source="entity"/>
		<WTATTRIBUTE id="9522" name="Variance" type="number" source="entity"/>
		<WTATTRIBUTE id="9523" name="InputValues" type="text" length="500" min="1" max="500" source="entity"/>
		<WTATTRIBUTE id="9524" name="Rating" type="number" source="entity"/>
    <WTATTRIBUTE id="9525" name="Outsource" type="text" length="20" min="1" max="20" source="entity"/>

    <!-- Non Persist Fields -->
		<WTATTRIBUTE id="9590" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="9591" name="ReportFromDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="9592" name="ReportToDate" type="date" source="entity" persist="false"/>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Common" entity="Issue" alias="zis">
				<WTENTITY name="IssueCategory" entity="IssueCategory" alias="zic">
					<WTATTRIBUTE alias="zic" name="IssueCategoryID" relalias="zis" relname="IssueCategoryID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<!--Indexes-->
		<WTINDEX name="CompanyID">
			<WTATTRIBUTE name="CompanyID"/>
		</WTINDEX>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="IssueCategoryName" default="true"/>
			<WTATTRIBUTE name="IssueName" contains="true"/>
			<WTATTRIBUTE name="IssueID"/>
			<WTATTRIBUTE name="SubmittedBy"/>
			<WTATTRIBUTE name="AssignedTo"/>
      <WTATTRIBUTE name="Outsource"/>
      <WTATTRIBUTE name="IssueDate"/>
			<WTATTRIBUTE name="DueDate" />
			<WTATTRIBUTE name="DoneDate" />
			<WTATTRIBUTE name="Priority"/>
		</WTENUM>

		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="STATUS-SUBMITTED" value="1"/>
			<WTSYSCON name="STATUS-ASSIGNED" value="2"/>
      <WTSYSCON name="STATUS-INPROCESS" value="3"/>
      <WTSYSCON name="STATUS-RESOLVED" value="4"/>
      <WTSYSCON name="STATUS-POSTPONED" value="5"/>
			<WTSYSCON name="STATUS-TESTED" value="6"/>
			<WTSYSCON name="STATUS-DEPLOYED" value="7"/>
		</WTSYSCONS>

	</WTENTITY>

	<WTPROCEDURES>
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE name="Count" type="Count" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Issue.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Find" name="FindStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Issue.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(Issue.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Find" name="FindAssigned" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(AssignedTo)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Issue.AssignedTo)" oper="equal" value="PARAM(AssignedTo)" connector="and"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Find" name="FindAssignedStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(AssignedTo)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Issue.AssignedTo)" oper="equal" value="PARAM(AssignedTo)" connector="and"/>
			<WTCONDITION expr="ATTR(Issue.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
		</WTPROCEDURE>

		<WTPROCEDURE type="Find" name="FindSubmit" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(SubmitType)" direction="input" required="false"/>
			<WTPARAM name="ATTR(SubmitID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Issue.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(Issue.SubmitType)" oper="equal" value="PARAM(SubmitType)" connector="and"/>
			<WTCONDITION expr="ATTR(Issue.SubmitID)" oper="equal" value="PARAM(SubmitID)" connector="and"/>
		</WTPROCEDURE>
		<WTPROCEDURE type="Find" name="FindSubmitStatus" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(CompanyID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(SubmitType)" direction="input" required="false"/>
			<WTPARAM name="ATTR(SubmitID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTJOIN name="Common"/>
			<WTCONDITION expr="ATTR(Issue.CompanyID)" oper="equal" value="PARAM(CompanyID)" connector="and"/>
			<WTCONDITION expr="ATTR(Issue.SubmitType)" oper="equal" value="PARAM(SubmitType)" connector="and"/>
			<WTCONDITION expr="ATTR(Issue.SubmitID)" oper="equal" value="PARAM(SubmitID)" connector="and"/>
			<WTCONDITION expr="ATTR(Issue.Status)" oper="equal" value="PARAM(Status)" connector="and"/>
		</WTPROCEDURE>

		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportStatus" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportStatusAssigned" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(AssignedTo)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportStatusDetail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
					<WTATTRIBUTE value="ATTR(Issue.Priority)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
          <WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.Variance)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportStatusAssignedDetail" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(AssignedTo)" direction="input"/>
			<WTPARAM name="ATTR(Status)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
					<WTATTRIBUTE value="ATTR(Issue.Priority)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
					<WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.Variance)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportLate" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
					<WTATTRIBUTE value="ATTR(Issue.Priority)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
					<WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.Variance)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportLateAssigned" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(AssignedTo)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
					<WTATTRIBUTE value="ATTR(Issue.Priority)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
					<WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.Variance)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportRating" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
					<WTATTRIBUTE value="ATTR(Issue.Priority)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
					<WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.Variance)"/>
					<WTATTRIBUTE value="ATTR(Issue.Rating)"/>
					<WTATTRIBUTE value="ATTR(Issue.Notes)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportRatingAssigned" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<!--==================================================================================================-->
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="ATTR(AssignedTo)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
					<WTATTRIBUTE value="ATTR(Issue.Priority)"/>
					<WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
					<WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
					<WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
					<WTATTRIBUTE value="ATTR(Issue.Variance)"/>
					<WTATTRIBUTE value="ATTR(Issue.Rating)"/>
					<WTATTRIBUTE value="ATTR(Issue.Notes)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

    <!--==================================================================================================-->
    <WTPROCEDURE type="List" name="ReportOutsource" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
      <!--==================================================================================================-->
      <WTPARAM name="ATTR(CompanyID)" direction="input"/>
      <WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
      <WTPARAM name="ATTR(ReportToDate)" direction="input"/>
      <WTCODEGROUP>
        <WTSELECT>
          <WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
          <WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
          <WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
          <WTATTRIBUTE value="ATTR(Issue.Priority)"/>
          <WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
          <WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
          <WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.Variance)"/>
          <WTATTRIBUTE value="ATTR(Issue.Rating)"/>
          <WTATTRIBUTE value="ATTR(Issue.Notes)"/>
        </WTSELECT>
      </WTCODEGROUP>
    </WTPROCEDURE>
    <!--==================================================================================================-->
    <WTPROCEDURE type="List" name="ReportOutsourceAssigned" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
      <!--==================================================================================================-->
      <WTPARAM name="ATTR(CompanyID)" direction="input"/>
      <WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
      <WTPARAM name="ATTR(ReportToDate)" direction="input"/>
      <WTPARAM name="ATTR(AssignedTo)" direction="input"/>
      <WTCODEGROUP>
        <WTSELECT>
          <WTATTRIBUTE value="ATTR(Issue.IssueID)"/>
          <WTATTRIBUTE value="ATTR(Issue.IssueName)"/>
          <WTATTRIBUTE value="ATTR(Issue.IssueCategoryName)"/>
          <WTATTRIBUTE value="ATTR(Issue.Priority)"/>
          <WTATTRIBUTE value="ATTR(Issue.IssueDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.SubmittedBy)"/>
          <WTATTRIBUTE value="ATTR(Issue.AssignedTo)"/>
          <WTATTRIBUTE value="ATTR(Issue.Outsource)"/>
          <WTATTRIBUTE value="ATTR(Issue.Status)"/>
          <WTATTRIBUTE value="ATTR(Issue.ChangeDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.DueDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.DoneDate)"/>
          <WTATTRIBUTE value="ATTR(Issue.Variance)"/>
          <WTATTRIBUTE value="ATTR(Issue.Rating)"/>
          <WTATTRIBUTE value="ATTR(Issue.Notes)"/>
        </WTSELECT>
      </WTCODEGROUP>
    </WTPROCEDURE>

  </WTPROCEDURES>

	<WTWEBPAGES>

		<!-- =============================================================================================== -->
    <WTWEBPAGE name="9501" caption="Ticket Manager" action="5" contentpage="true" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52" focus="false" track="0">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="AssignedTo" datatype="text"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				<WTCUSTOM>response.write "System Error! Company # Required"</WTCUSTOM>
			</WTCODEGROUP>
			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(IssueCategoryName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTCODEGROUP>
				<WTCONDITION expr="SYS(UserName)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(AssignedTo)" value="CONST(Left(reqSysUserName,InStr(reqSysUserName,&quot; &quot;)-1))"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="IsManager"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTMETHOD name="Find">
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="FindStatus">
						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotManager"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
					<WTMETHOD name="FindAssigned">
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="AssignedTo" direction="input" value="PARAM(AssignedTo)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="FindAssignedStatus">
						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="AssignedTo" direction="input" value="PARAM(AssignedTo)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTCODEGROUP>
<WTCUSTOM>
				mNow = Now()
				For Each oIssue in oIssues
					With oIssue
						If .Status &lt; 3 Then
							If IsDate(.DueDate) Then
								.Variance = DATEDIFF( "d", .DueDate, mNow )
							End If
							.Quantity = DATEDIFF( "h", .IssueDate, mNow )
						End If
					End With
				Next
</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left"/>

        <WTFUNCTION name="NewTicket()">
          var cid = document.getElementById('CompanyID').value
          var url = "9502.asp?companyid=" + cid
          var win = window.location = url + "&amp;returnurl=9501.asp?companyid=" + cid
        </WTFUNCTION>
        
        <WTROW>
          <WTHIDDEN name="CompanyID" value="PARAM(CompanyID)"/>
        </WTROW>

        <WTROW margin-bottom="12">
          <WTTABLE col="1">
						<WTCOLUMN width="400" align="left"/>
						<WTCOLUMN width="600" align="right"/>
						<WTROW>
							<WTSTATIC col="1" class="PageHeading">
								<WTSTATIC label="FindIssue">
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="SupportTicketManager">
									<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTLINKGROUP col="2" class="PageHeader" align="right">
<!--                
								<WTLINK name="9502" label="NewIssue" class="PageHeadingLink">
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
 								<WTLINK name="9502" label="NewTicket" class="PageHeadingLink">
									<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
-->                
								<WTLINK name="9411" label="Categories" class="PageHeadingLink">
									<WTCONDITION expr="IsManager"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
								<WTLINK name="9510" label="Reports" class="PageHeadingLink">
									<WTCONDITION expr="IsManager"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
								</WTLINK>
							</WTLINKGROUP>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW>
          <WTBUTTON col="1" value="CONST(NewTicket)" align="center">
            <WTCLICK>NewTicket();</WTCLICK>
          </WTBUTTON>
          <WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Issues.FindTypeID)" translate="true" prespace="false"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true" prespace="false"/>
					<WTSTATIC col="1" tag="Status" class="ColumnHeader"/>
					<WTCOMBO col="1" value="PARAM(Status)" prespace="false">
						<WTOPTION id="0" label="All"/>
						<WTOPTION id="1" label="Submitted"/>
            <WTOPTION id="2" label="Assigned"/>
            <WTOPTION id="3" label="InProcess"/>
            <WTOPTION id="4" label="Resolved"/>
						<WTOPTION id="5" label="Postponed"/>
						<WTOPTION id="6" label="Tested"/>
						<WTOPTION id="7" label="Deployed"/>
					</WTCOMBO>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
					<WTBUTTON col="1" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Issue">
						<WTCOLUMN width="18" align="left" valign="top" label="IssueID"/>
						<WTCOLUMN width="42" align="left" valign="top" label="IssueCategory"/>
						<WTCOLUMN width="20" align="left" valign="top" label="SubmittedAssigned"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
						<WTCOLUMN width="10" align="right" valign="top" label="When"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueID)">
								<WTSTATIC fontcolor="red">
									<WTCONDITION expr="DATA(Issue.Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
									<WTSTATIC value="CONST( ()"/>
									<WTSTATIC value="DATA(Issue.Quantity)"/>
									<WTSTATIC value="CONST( hrs.))"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Issue.IssueName)">
									<WTCONDITION expr="DATA(Variance)" oper="less-equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Issue.IssueName)" fontcolor="red">
									<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="9503">
											<WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC fontcolor="red" space="2">
									<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="CONST(()"/>
									<WTSTATIC value="DATA(Variance)"/>
									<WTSTATIC value="CONST(days))"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Issue.SubmittedBy)"/>
							<WTSTATIC col="4" value="DATA(Issue.Priority)"/>
							<WTSTATIC col="5" value="DATA(Issue.DueDate)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueDate)" fontcolor="gray"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="NotManager"/>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="IsManager"/>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle">
										<WTLINK name="9508">
											<WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTSTATIC value="DATA(Issue.IssueCategoryName)" space="2" fontcolor="gray"/>
								<WTSTATIC value="DATA(Issue.ChangeDate)" fontcolor="purple"/>
							</WTSTATIC>
              <WTSTATIC col="3" fontcolor="gray">
                <WTSTATIC tag="To" value="DATA(Issue.AssignedTo)"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(Outsource)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC value="CONST(/)"/>
                  <WTSTATIC value="DATA(Issue.Outsource)"/>
                </WTCODEGROUP>
              </WTSTATIC>
							<WTSTATIC col="4" value="DATA(Issue.Status)" fontcolor="gray"/>
							<WTSTATIC col="5" value="DATA(Issue.DoneDate)" fontcolor="gray"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(Issue.InputValues)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="4" value="DATA(Issue.InputValues)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9502" header="false" navbar="false" footer="false" wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="UserName" datatype="text"/>

 			<WTINCLUDE name="Comm.asp"/>

			<WTSUB name="LoadList">
				<WTOBJECT name="IssueCategorys" project="ptsIssueCategoryUser" class="CIssueCategorys">
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsAnonymous"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PUBLIC)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsMemberOnly"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-GENERAL)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsOrgAdminOnly"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-ADMIN)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsEmployee"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PRIVATE)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Issue.IssueDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.Priority)" value="CONST(2)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.SubmittedBy)" value="CONST(Left(reqSysUserName,InStr(reqSysUserName,&quot; &quot;)-1))"/>
					<WTSETATTRIBUTE name="PARAM(UserName)" value="CONST(Left(reqSysUserName,InStr(reqSysUserName,&quot; &quot;)-1))"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="5" name="Category" type="New">
				<WTSETATTRIBUTE name="CONST(tmpIssueCategoryID)" value="FORM(IssueCategoryID)"/>
				<WTOBJECT name="IssueCategory" project="ptsIssueCategoryUser" class="CIssueCategory">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueCategoryID" direction="input" value="CONST(tmpIssueCategoryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
				</WTOBJECT>
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Issue.InputOptions)" value="CONST(tmpInputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<WTSETATTRIBUTE name="CONST(tmpIssueCategoryID)" value="FORM(IssueCategoryID)"/>
				<WTSETATTRIBUTE name="CONST(tmpAssignedTo)" value="FORM(AssignedTo)"/>
				<WTOBJECT name="IssueCategory" project="ptsIssueCategoryUser" class="CIssueCategory">
					<WTCONDITION expr="CONST(tmpIssueCategoryID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="IssueCategoryID" direction="input" value="CONST(tmpIssueCategoryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpAssignedTo)" value="ATTR(AssignedTo)"/>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
					<WTSETATTRIBUTE name="CONST(tmpCC)" value="ATTR(Email)"/>
				</WTOBJECT>
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.ChangeDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTES/>
<WTCUSTOM>
				If .AssignedTo = "" Then .AssignedTo = tmpAssignedTo
				If .Status = "" Then .Status = 0
				If .Status &lt;= 1 and .AssignedTo &lt;&gt; "" Then .Status = 2
				If .Status &gt;= 3 Then 
					.DoneDate = Date()
					If IsDate(.DueDate) Then .Variance = DATEDIFF("d", .DueDate, .DoneDate)
				End If
</WTCUSTOM>
					<WTINPUTOPTIONS name="CONST(tmpInputOptions)" values="ATTR(InputValues)" secure="23"/>
          
          <WTSETATTRIBUTE name="ATTR(IssueName)" value="CONST(ValidXML(.IssueName))"/>
          <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(ValidXML(.Description))"/>
          <WTMETHOD name="Add">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="IssueID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
  'Get Info for email
  If xmlError = "" Then
  Select Case .Status
  Case 2: tmpSubject = "NEW"
  Case 3: tmpSubject = "INPROCESS"
  Case 4: tmpSubject = "RESOLVED"
  Case 5: tmpSubject = "POSTPONED"
  Case 6: tmpSubject = "CONFIRMED"
  Case 7: tmpSubject = "COMPLETED"
  End Select
  tmpSubject = tmpSubject + " ISSUE #" + CStr(IssueID) + " " + .IssueName
  If .Priority = 1 Then tmpSubject = tmpSubject + " (HIGH PRIORITY)"
  If .DueDate &lt;&gt; "0" Then tmpSubject = tmpSubject + " (DUE: " + .DueDate + ")"
				tmpBody = .Description

				'Email newly assigned employee
				If .Status = 2 AND .AssignedTo &lt;&gt; "" Then
					tmpToName = .AssignedTo
					tmpFromName = .SubmittedBy
				End If

				If .Status &gt;= 3 Then 
					tmpToName = .SubmittedBy
					tmpFromName = .AssignedTo
					tmpBody = tmpBody + "&lt;BR&gt;--------------------------------------------------&lt;BR&gt;" + Replace(.Notes, Chr(13), "&lt;BR&gt;")
				End If
			End If
</WTCUSTOM>
					<WTMETHOD name="XML">
	 					<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList">
 					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
	
				<WTCODEGROUP>
 					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpToName)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>

					<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
					</WTOBJECT>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Email)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					</WTOBJECT>

					<WTOBJECT name="Employee" project="ptsEmployeeUser" class="CEmployee">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--            
						<WTMETHOD name="GetEmail">
							<WTCONDITION expr="CONST(tmpFromName)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTPARAM name="tmpFrom" direction="return" datatype="text"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpFromName)"/>
						</WTMETHOD>
-->            
					</WTOBJECT>
					<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--            
						<WTMETHOD name="GetEmail">
							<WTCONDITION expr="CONST(tmpFromName)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTPARAM name="tmpFrom" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpFromName)"/>
						</WTMETHOD>
-->            
					</WTOBJECT>
<WTCUSTOM>
					If InStr(tmpTo, "@") &gt; 0 Then
  					SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, tmpCC, "", tmpSubject, tmpBody
          End If
</WTCUSTOM>
				</WTCODEGROUP>
				
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="LogStatus()">	
					var obj = document.getElementById('Status');
					var st = obj.options[obj.selectedIndex].text
					var note = document.getElementById('Notes').value;
					var nam = document.getElementById('UserName').value;
					var dt = new Date();
					var strdt = (dt.getMonth()+1) + '/' + dt.getDate() + '/' + dt.getFullYear();
					var hrs = dt.getHours();
					var ampm = 'am';
					var mins = dt.getMinutes()
					if ( mins &lt; 10 ) { mins = '0' + mins }
					if( hrs == 0 ){hrs = 12} 
					else if ( hrs == 12 ) {ampm = 'pm'}
					else if ( hrs > 11 ) {hrs -= 12; ampm = 'pm'}
					if ( note.length > 0 ) { note += '\n' }
					note += st.toUpperCase() + ' by ' + nam  + ' on ' + strdt + ' ' + hrs + ':' +  mins + ampm
					document.getElementById('Notes').value = note
			   </WTFUNCTION>
				<WTFUNCTION name="ViewEmployees()">
					var url, win;
					url = "9504.asp?companyid=" + document.getElementById('CompanyID').value
		            win = window.open(url,"Employees","height=451,width=250,scrollbars=1");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(UserName)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="left">
						<WTSTATIC label="NewIssue">
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="NewTicket">
							<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="IssueDate"/>
					<WTTEXT col="2" value="ATTR(Issue.IssueDate)" size="15"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueCategoryID"/>
					<WTCOMBO col="2" value="ATTR(Issue.IssueCategoryID)" datapath="/DATA/TXN/PTSISSUECATEGORYS/ENUM" setselected="true">
						<WTCHANGE>doSubmit(5,"")</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueName"/>
					<WTTEXT col="2" value="ATTR(Issue.IssueName)" focus="true" size="60"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Issue.InputOptions)" oper="not-equal" value="CONST('')"/>
					<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="23"/>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="SubmittedBy"/>
					<WTTEXT col="2" value="ATTR(Issue.SubmittedBy)"/>
					<WTSTATIC col="2" tag="Priority"/>
					<WTCOMBO col="2" value="ATTR(Issue.Priority)" noprespace="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Issue.Description)" cols="72" rows="8"/>
				</WTROW>
				
				<WTCODEGROUP>
 					<WTCONDITION expr="IsManager"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="AssignedTo"/>
						<WTTEXT col="2" value="ATTR(Issue.AssignedTo)"/>
						<WTIMAGE col="2" value="CONST(employee.gif)" align="center" valign="center">
							<WTLINK name="ViewEmployees()" click="true" />
						</WTIMAGE>
						<WTSTATIC col="2" tag="Status"/>
						<WTCOMBO col="2" value="ATTR(Issue.Status)">
							<WTCHANGE>LogStatus();</WTCHANGE>
						</WTCOMBO>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="DueDate"/>
						<WTTEXT col="2" value="ATTR(Issue.DueDate)"/>
						<WTSTATIC col="2" tag="DoneDate"/>
						<WTTEXT col="2" value="ATTR(Issue.DoneDate)" prespace="false"/>
					</WTROW>
					
					<WTROW>
						<WTSTATIC col="1" merge="2" tag="Notes" align="left"/>
					</WTROW>
					<WTROW>
						<WTMEMO col="1" merge="2" align="left" value="ATTR(Issue.Notes)" cols="72" rows="8"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW>
	 				<WTCONDITION expr="NotManager"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Issue.Status)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9503" header="false" navbar="false" footer="false"  wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52">
		<!--============================================================================================-->
			<WTPARAM name="IssueID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="UserName" datatype="text"/>
			<WTPARAM name="SubmitLink" datatype="text"/>
			<WTPARAM name="OldStatus" datatype="number"/>

 			<WTINCLUDE name="Comm.asp"/>

			<WTSUB name="LoadIssue">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(OldStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="PARAM(UserName)" value="CONST(Left(reqSysUserName,InStr(reqSysUserName,&quot; &quot;)-1))"/>
<!-- FIX: APPLICATION SPECIFIC -->
					<WTSETATTRIBUTE name="PARAM(SubmitLink)" value="CONST(&quot;0403.asp?memberid=&quot; + CSTR(.SubmitID) + &quot;&amp;contentpage=3&amp;popup=1&quot;)">
						<WTCONDITION expr="ATTR(SubmitType)" oper="equal" value="ENTITY(Member)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Quantity)" value="CONST(DATEDIFF(&quot;h&quot;, .IssueDate, Now() ))">
						<WTCONDITION expr="ATTR(Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTSUB>
			<WTSUB name="LoadList">
				<WTOBJECT name="IssueCategorys" project="ptsIssueCategoryUser" class="CIssueCategorys">
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsAnonymous"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PUBLIC)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsMemberOnly"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-GENERAL)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsOrgAdminOnly"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-ADMIN)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTMETHOD name="EnumList">
						<WTCONDITION expr="IsEmployee"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PRIVATE)"/>
						<WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadIssue"/>
			</WTACTION>

			<WTACTION id="5" name="Category" type="New">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="CONST(tmpTo)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(tmpFrom)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(tmpCC)" value="CONST(&quot;&quot;)"/>

				<WTSETATTRIBUTE name="CONST(tmpOldStatus)" value="FORM(OldStatus)"/>
				<WTSETATTRIBUTE name="CONST(tmpStatus)" value="FORM(Status)"/>
				<WTSETATTRIBUTE name="CONST(tmpIssueCategoryID)" value="FORM(IssueCategoryID)"/>
				<WTOBJECT name="IssueCategory" project="ptsIssueCategoryUser" class="CIssueCategory">
					<WTCONDITION expr="CONST(tmpStatus)" oper="not-equal" value="CONST(tmpOldStatus)"/>
					<WTCONDITION expr="CONST(tmpStatus)" oper="greater-equal" value="CONST(2)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="IssueCategoryID" direction="input" value="CONST(tmpIssueCategoryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCC)" value="ATTR(Email)"/>
				</WTOBJECT>

				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Issue.ChangeDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubmitType)" value="ATTR(SubmitType)"/>
					<WTSETATTRIBUTE name="CONST(tmpSubmitID)" value="ATTR(SubmitID)"/>
					<WTSETATTRIBUTE name="CONST(tmpAssignedTo)" value="ATTR(AssignedTo)"/>
					<WTSETATTRIBUTE name="CONST(tmpNotes)" value="ATTR(Notes)"/>
					<WTSETATTRIBUTE name="CONST(tmpLen)" value="CONST(Len(tmpNotes))"/>
					<WTSETATTRIBUTES/>
					<WTINPUTOPTIONS name="ATTR(InputOptions)" values="ATTR(InputValues)" secure="23" />
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="NotManager"/>
						<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
						<WTCONDITION expr="CONST(Left(tmpNotes,tmpLen))" oper="not-equal" value="CONST(Left(.Notes,tmpLen))" connector="and"/>
						<WTERROR number="-2147220503" message="Oops, You cannot change the previous notes."/>
					</WTCODEGROUP>
-->
          <WTCUSTOM>
      If Left(.IssueName,1) = "*" Then .IssueName = Replace(.IssueName,"*","")
			If xmlError = "" Then
				If .Status &lt;= 1 and .AssignedTo &lt;&gt; "" Then .Status = 2

				'Send emails if the status or assigned to name changed
				If .Status &lt;&gt; tmpOldStatus  OR tmpAssignedTo &lt;&gt; .AssignedTo Then
  tmpEmail = .Status
  Select Case .Status
  Case 2: tmpSubject = "NEW"
  Case 3: tmpSubject = "INPROCESS"
  Case 4: tmpSubject = "RESOLVED"
  Case 5: tmpSubject = "POSTPONED"
  Case 6: tmpSubject = "CONFIRMED"
  Case 7: tmpSubject = "COMPLETED"
  End Select
  tmpSubject = tmpSubject + " ISSUE #" + CStr(reqIssueID) + " " + .IssueName
  If .Priority = 1 Then tmpSubject = tmpSubject + " (HIGH PRIORITY)"
  If .DueDate &lt;&gt; "0" Then tmpSubject = tmpSubject + " (DUE: " + .DueDate + ")"
					tmpBody = .Description

					'Email newly assigned employee and manager
					If .Status = 2 Then
						tmpToName = .AssignedTo
						tmpFromName = .SubmittedBy
					End If

					'If the status is resolved+, send email to submitter and manager
					If .Status &gt;= 3 Then 
						tmpToName = .SubmittedBy
						tmpFromName = .AssignedTo
						tmpBody = tmpBody + "&lt;BR&gt;--------------------------------------------------&lt;BR&gt;" + Replace(.Notes, Chr(13), "&lt;BR&gt;")
						If not IsDate(.DoneDate) Then
							.DoneDate = Date()
							If IsDate(.DueDate) Then .Variance = DATEDIFF("d", .DueDate, .DoneDate)
						End If	
					End If
				End If
			End If
</WTCUSTOM>
					<WTMETHOD name="Save">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadIssue">
 					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>

<!-- FIX: APPLICATION SPECIFIC -->
<!-- If Submitter is not an employee, get the submitters email -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
 					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpSubmitType)" oper="equal" value="ENTITY(Member)" connector="and"/>
					<WTCONDITION expr="CONST(tmpEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpSubmitID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)">
						<WTCONDITION expr="CONST(tmpEmail)" oper="equal" value="SYSCON(STATUS-ASSIGNED)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email)">
						<WTCONDITION expr="CONST(tmpEmail)" oper="greater-equal" value="SYSCON(STATUS-RESOLVED)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>

        <WTCODEGROUP>
 					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
					</WTOBJECT>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Email)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					</WTOBJECT>

					<WTOBJECT name="Employee" project="ptsEmployeeUser" class="CEmployee">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTCONDITION expr="CONST(tmpTo)" oper="equal" value="CONST(&quot;&quot;)"/>
							<WTCONDITION expr="CONST(tmpToName)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--            
						<WTMETHOD name="GetEmail">
							<WTCONDITION expr="CONST(tmpFrom)" oper="equal" value="CONST(&quot;&quot;)"/>
							<WTCONDITION expr="CONST(tmpFromName)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTPARAM name="tmpFrom" direction="return" datatype="text"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpFromName)"/>
						</WTMETHOD>
-->            
					</WTOBJECT>
					<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTCONDITION expr="CONST(tmpTo)" oper="equal" value="CONST(&quot;&quot;)"/>
							<WTCONDITION expr="CONST(tmpToName)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--            
						<WTMETHOD name="GetEmail">
							<WTCONDITION expr="CONST(tmpFrom)" oper="equal" value="CONST(&quot;&quot;)"/>
							<WTCONDITION expr="CONST(tmpFromName)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
							<WTPARAM name="tmpFrom" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpFromName)"/>
						</WTMETHOD>
-->            
					</WTOBJECT>
<WTCUSTOM>
					If InStr(tmpTo, "@") &gt; 0 Then
  					SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, tmpCC, "", tmpSubject, tmpBody
          End If
</WTCUSTOM>
				</WTCODEGROUP>

				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Delete">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="LogStatus()">	
					var obj = document.getElementById('Status');
					var st = obj.options[obj.selectedIndex].text
					var note = document.getElementById('Notes').value;
					var nam = document.getElementById('UserName').value;
					var dt = new Date();
					var strdt = (dt.getMonth()+1) + '/' + dt.getDate() + '/' + dt.getFullYear();
					var hrs = dt.getHours();
					var ampm = 'am';
					var mins = dt.getMinutes()
					if ( mins &lt; 10 ) { mins = '0' + mins }
					if( hrs == 0 ){hrs = 12} 
					else if ( hrs == 12 ) {ampm = 'pm'}
					else if ( hrs > 11 ) {hrs -= 12; ampm = 'pm'}
					if ( note.length > 0 ) { note += '\n' }
					note += st.toUpperCase() + ' by ' + nam  + ' on ' + strdt + ' ' + hrs + ':' +  mins + ampm
					document.getElementById('Notes').value = note
			   </WTFUNCTION>
				
				<WTFUNCTION name="AddTimeStamp()">
					var d = new Date();
					var year = d.getFullYear()
					if(year&lt;1000) year+=1900
					var curHour = d.getHours();
					var curMin = d.getMinutes();
					var curAMPM = "am ";
					var curTime = "";
					if (curHour &gt;= 12){
					curHour -= 12;
					curAMPM = "pm ";
					}
					if (curHour == 0) curHour = 12;
					curTime = curHour + ":" + ((curMin &lt; 10) ? "0" : "") + curMin + curAMPM
					document.getElementById('Notes').value = document.getElementById('Notes').value + "\n" + (d.getMonth()+1) + "/" + d.getDate() + "/" + (year+"").substring(2,4) + " " + curTime
				</WTFUNCTION>
				
				<WTFUNCTION name="ViewEmployees()">
					var url, win;
					url = "9504.asp?companyid=" + document.getElementById('CompanyID').value
		            win = window.open(url,"Employees","height=451,width=250,scrollbars=1");
					win.focus();
				</WTFUNCTION>

				<WTFUNCTION name="ShowTab(tab)">
					document.getElementById('TabResponse').style.display = 'none';
					document.getElementById('TabReplies').style.display = 'none';
					document.getElementById(tab).style.display = '';
					if ( tab == 'TabReplies' ) {
					var src = document.getElementById('RepliesFrame').src
					if (src.indexOf("9011.") &lt; 0 ) {
					var id = document.getElementById('IssueID').value
					src = '9011.asp?Height=250&amp;OwnerType=95&amp;OwnerID=' + id + '&amp;Title=' + id
					document.getElementById('RepliesFrame').src = src
					}
					}
				</WTFUNCTION>
				<WTLOAD>
					ShowTab('TabResponse');
				</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(IssueID)"/>
					<WTHIDDEN value="PARAM(UserName)"/>
					<WTHIDDEN value="PARAM(OldStatus)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>
				
				<WTTAB name="IssueTab">
					<WTITEM label="ViewResponse" width="200">
						<WTLINK name="JAVA(ShowTab('TabResponse'))"/>
					</WTITEM>
					<WTITEM label="ViewReplies" width="200">
						<WTLINK name="JAVA(ShowTab('TabReplies'))"/>
					</WTITEM>
				</WTTAB>

				<WTROW>
					<WTSTATIC col="1" merge="2" class="PageHeading" align="left">
						<WTSTATIC tag="Issue">
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC tag="Ticket">
							<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC value="ATTR(Issue.IssueName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="IssueID" height="18"/>
					<WTSTATIC col="2" value="ATTR(Issue.IssueID)"/>
					<WTSTATIC col="2" fontcolor="red">
						<WTCONDITION expr="ATTR(Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
						<WTSTATIC value="CONST(()"/>
						<WTSTATIC value="ATTR(Issue.Quantity)"/>
						<WTSTATIC value="CONST( hrs.))"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueDate"/>
					<WTTEXT col="2" value="ATTR(Issue.IssueDate)" size="15"/>
					<WTSTATIC col="2" tag="Updated" value="ATTR(Issue.ChangeDate)" fontcolor="purple"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueCategoryID"/>
					<WTCOMBO col="2" value="ATTR(Issue.IssueCategoryID)" datapath="/DATA/TXN/PTSISSUECATEGORYS/ENUM" setselected="true">
						<WTCHANGE>doSubmit(5,"")</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueName"/>
					<WTTEXT col="2" value="ATTR(Issue.IssueName)" size="60"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Issue.InputOptions)" oper="not-equal" value="CONST('')"/>
					<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="23"/>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="SubmittedBy"/>
					<WTTEXT col="2" value="ATTR(Issue.SubmittedBy)" size="25"/>
					<WTTEXT col="2" value="ATTR(Issue.SubmitType)" size="1"/>
					<WTTEXT col="2" value="ATTR(Issue.SubmitID)" size="4" prespace="false"/>
					<WTIMAGE col="2" value="CONST(employee.gif)" align="center" valign="center">
						<WTCONDITION expr="PARAM(SubmitLink)" oper="not-equal" value="CONST('')"/>
						<WTLINK name="PARAM(SubmitLink)" type="anchor" target="SubmittedBy"/>
					</WTIMAGE>
					<WTSTATIC col="2" tag="Priority"/>
					<WTCOMBO col="2" value="ATTR(Issue.Priority)" noprespace="true"/>
				</WTROW>
<!--
				<WTROW>
					<WTCONDITION expr="PARAM(SubmitLink)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="SubmitLink">
						<WTLINK name="PARAM(SubmitLink)" type="anchor" target="SubmittedBy"/>
					</WTSTATIC>
				</WTROW>
-->
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Issue.Description)" cols="72" rows="8"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="AssignedTo"/>
					<WTTEXT col="2" value="ATTR(Issue.AssignedTo)"/>
					<WTIMAGE col="2" value="CONST(employee.gif)" align="center" valign="center">
						<WTLINK name="ViewEmployees()" click="true" />
					</WTIMAGE>
					<WTSTATIC col="2" tag="Status"/>
					<WTCOMBO col="2" value="ATTR(Issue.Status)">
						<WTCHANGE>LogStatus();</WTCHANGE>
					</WTCOMBO>
				</WTROW>
        <WTROW>
          <WTSTATIC col="1" tag="Outsource"/>
          <WTTEXT col="2" value="ATTR(Issue.Outsource)"/>
        </WTROW>
        <WTROW>
					<WTCONDITION expr="IsManager"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSTATIC col="1" tag="DueDate"/>
					<WTTEXT col="2" value="ATTR(Issue.DueDate)"/>
					<WTSTATIC col="2" tag="DoneDate"/>
					<WTTEXT col="2" value="ATTR(Issue.DoneDate)" prespace="false"/>
					<WTSTATIC col="2">
						<WTSTATIC value="ATTR(Issue.Variance)"/>
						<WTSTATIC value="CONST( days)"/>
					</WTSTATIC>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="NotManager"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTROW>
						<WTSTATIC col="1" tag="DueDate"/>
						<WTSTATIC col="2" value="ATTR(Issue.DueDate)"/>
						<WTSTATIC col="2" tag="DoneDate"/>
						<WTSTATIC col="2" value="ATTR(Issue.DoneDate)" prespace="false"/>
						<WTSTATIC col="2" value="ATTR(Issue.Variance)"/>
					</WTROW>
					<WTROW>
						<WTHIDDEN value="ATTR(Issue.DueDate)"/>
						<WTHIDDEN value="ATTR(Issue.DoneDate)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" align="left">
						<WTCODEGROUP>
							<WTSTARTTAB name="IssueTab"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<!-- ======================================================================= -->
				<WTSTATIC label="ConfirmMove"/>
				<WTROW id="TabResponse">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6">
							<WTIMAGE col="1" merge="2" value="CONST(clock.gif)" imgalign="absmiddle" prespace="false" align="left">
								<WTLINK click="true" name="CONST(AddTimeStamp())"/>
							</WTIMAGE>
						</WTROW>
						<WTROW margin-top="6">
							<WTMEMO col="1" merge="2" align="left" value="ATTR(Issue.Notes)" cols="72" rows="10"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<!-- ======================================================================= -->
				<WTROW id="TabReplies">
					<WTFRAME col="1" merge="2" src="" name="RepliesFrame" frmclass="FrameNoScroll" frmwidth="600" frmheight="250" label="NoFrameSupport" border="0"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsManager"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="ATTR(Issue.Status)" oper="less-equal" value="SYSCON(STATUS-INPROCESS)" connector="or"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete">
						<WTCONDITION expr="IsManager"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="9504" caption="Employees" focus="false" navbar="false" header="false" footer="false" wrapper="false"
		margin="false" page-width="240" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52">
		<!--===============================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Employees" project="ptsOrgUser" class="CEmployees">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="ListActive">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlEmployees" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Orgs" project="ptsOrgUser" class="COrgs">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="ListActiveUsers">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrgs" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="240" align="left"/>

				<WTFUNCTION name="SetAssigned(V)">
					window.opener.document.getElementById('AssignedTo').value = V;
					window.close();
				</WTFUNCTION>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" label="ClickEmployee" class="Prompt" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" entity="Employee">
						<WTCOLUMN width="100" align="center" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Employee.EmployeeName)">
									<WTLINK click="true" name="CONST(SetAssigned('&lt;xsl:value-of select=&quot;@namefirst&quot;/&gt;');)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" entity="Org">
						<WTCOLUMN width="100" align="center" valign="top"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(Org.ContactName)">
									<WTLINK click="true" name="CONST(SetAssigned('&lt;xsl:value-of select=&quot;@namefirst&quot;/&gt;');)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="9505" header="false" navbar="false" footer="false"  wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="T" datatype="number"/> <!-- SubmitType -->
			<WTPARAM name="I" datatype="number"/> <!-- SubmitID -->
			<WTPARAM name="N" datatype="text"/>   <!-- SubmittedBy -->
			<WTPARAM name="Email" datatype="text"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="AName" datatype="text"/>
			<WTPARAM name="AEmail" datatype="text"/>
			<WTPARAM name="APhone" datatype="text"/>
			<WTPARAM name="AMemberID" datatype="text"/>
      <WTPARAM name="Custom" datatype="number"/>
      <WTPARAM name="Category" datatype="number"/>

      <WTINCLUDE name="Comm.asp"/>

      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
        <WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
      </WTCODEGROUP>

      <!-- Nexxus Custom Lists -->
      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="IsAnonymous"/>
          <WTGETCACHE name="CONST(MerchantID)" value="MERCHANT" datatype="number"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(MerchantID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="PARAM(Custom)" value="SYSCON(USERTYPE-PUBLIC)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Custom)" oper="equal" value="CONST(0)"/>
            <WTGETCACHE name="CONST(ConsumerID)" value="CONSUMER" datatype="number"/>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(ConsumerID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              <WTSETATTRIBUTE name="PARAM(Custom)" value="SYSCON(USERTYPE-CUSTOM1)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="LoadList">
        <WTCODEGROUP>
          <WTCONDITION expr="IsMemberOnly"/>
          <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
            <WTMETHOD name="Load">
              <WTPARAM name="MemberID" direction="input" value="SYS(MemberID)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
          </WTOBJECT>
        </WTCODEGROUP>
        <WTOBJECT name="IssueCategorys" project="ptsIssueCategoryUser" class="CIssueCategorys">
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Custom)" oper="not-equal" value="CONST(0)" />
            <WTMETHOD name="EnumList">
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="PARAM(Custom)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Custom)" oper="equal" value="CONST(0)" />
            <WTMETHOD name="EnumList">
              <WTCONDITION expr="IsAnonymous"/>
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PUBLIC)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
            <WTCODEGROUP>
              <WTCONDITION expr="IsMemberOnly"/>
              <WTMETHOD name="EnumList">
                <WTCONDITION expr="CONST(tmpLevel)" oper="not-equal" value="CONST(0)" />
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-GENERAL)"/>
                <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTMETHOD name="EnumList">
                <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)" />
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-FREE)"/>
                <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
              </WTMETHOD>
            </WTCODEGROUP>
            <WTMETHOD name="EnumList">
              <WTCONDITION expr="IsOrgAdminOnly"/>
              <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-ADMIN)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
            <WTMETHOD name="EnumList">
              <WTCONDITION expr="IsEmployee"/>
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PRIVATE)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
          </WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

      <WTSUB function="GetCategory(bvIssueCategoryID)">
        <WTOBJECT name="IssueCategory" project="ptsIssueCategoryUser" class="CIssueCategory">
          <WTMETHOD name="Load">
            <WTPARAM name="IssueCategoryID" direction="input" value="CONST(bvIssueCategoryID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
        </WTOBJECT>
        <WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
          <WTSETATTRIBUTES/>
          <WTSETATTRIBUTE name="ATTR(Issue.InputOptions)" value="CONST(tmpInputOptions)"/>
          <WTSETATTRIBUTE name="ATTR(IssueCategoryID)" value="CONST(bvIssueCategoryID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlIssue" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="ATTR(IssueCategoryID)" value="PARAM(Category)"/>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTCALLSUB name="GetCategory(reqCategory)">
          <WTCONDITION expr="PARAM(Category)" oper="not-equal" value="CONST(0)" />
        </WTCALLSUB>
        <WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="5" name="Category" type="New">
				<WTSETATTRIBUTE name="CONST(tmpIssueCategoryID)" value="FORM(IssueCategoryID)"/>
        <WTCALLSUB name="GetCategory(tmpIssueCategoryID)"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
<!-- FIX: APPLICATION SPECIFIC -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="PARAM(I)" value="SYS(MemberID)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AName)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(AEmail)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10132" message="Oops, Please enter your name, email and phone."/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(N)" value="CONST(reqSysUserName)"/>
				<WTSETATTRIBUTE name="CONST(tmpIssueCategoryID)" value="FORM(IssueCategoryID)"/>
				<WTSETATTRIBUTE name="CONST(tmpAssignedTo)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="IssueCategory" project="ptsIssueCategoryUser" class="CIssueCategory">
 					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpIssueCategoryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="IssueCategoryID" direction="input" value="CONST(tmpIssueCategoryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpAssignedTo)" value="ATTR(AssignedTo)"/>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
				</WTOBJECT>
<!-- FIX: APPLICATION SPECIFIC -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
 					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(T)" oper="equal" value="ENTITY(Member)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(N)" value="CONST(Left(.MemberName,40))"/>
					<WTSETATTRIBUTE name="PARAM(Email)" value="ATTR(Email)"/>
				</WTOBJECT>
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
 					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.SubmitType)" value="PARAM(T)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.SubmitID)" value="PARAM(I)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.SubmittedBy)" value="PARAM(N)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.IssueDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.Priority)" value="CONST(2)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.ChangeDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Issue.InputOptions)" value="CONST(tmpInputOptions)"/>
					<WTINPUTOPTIONS name="CONST(tmpInputOptions)" values="ATTR(InputValues)" secure="23"/>
          
          <WTSETATTRIBUTE name="ATTR(IssueName)" value="CONST(ValidXML(.IssueName))"/>
          <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(ValidXML(.Description))"/>
          
          <WTCODEGROUP>
						<WTCONDITION expr="IsAnonymous"/>
<WTCUSTOM>
			tmp = "#" + reqAMemberID + " " + reqAName + " " + reqAEmail + " " + reqAPhone + " ... " + .Description 
			.Description = Left(tmp,1000)
</WTCUSTOM>
					</WTCODEGROUP>

<WTCUSTOM>
			If xmlError = "" Then
				If .AssignedTo = "" Then .AssignedTo = tmpAssignedTo
				If .AssignedTo &lt;&gt; "" Then .Status = 2
				'Email newly assigned employee
				If .Status = 2 AND .AssignedTo &lt;&gt; "" Then
					tmpToName = .AssignedTo
					tmpFromName = .SubmittedBy
					tmpSubject = "NEW ISSUE: " + .IssueName
					tmpBody = .Description
				End If
			End If
</WTCUSTOM>
          <WTMETHOD name="Add">
	 					<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="IssueID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
	 					<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
 					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpToName)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>

					<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
					</WTOBJECT>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Email)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					</WTOBJECT>

					<WTOBJECT name="Employee" project="ptsEmployeeUser" class="CEmployee">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="PARAM(Email)"/>-->
					</WTOBJECT>
					<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="PARAM(Email)"/>-->
					</WTOBJECT>
<WTCUSTOM>
					If InStr(tmpTo, "@") &gt; 0 Then
  					SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
          End If
</WTCUSTOM>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(Email)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="SubmitTicket" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="IssueCategoryID"/>
					<WTCOMBO col="2" value="ATTR(Issue.IssueCategoryID)" datapath="/DATA/TXN/PTSISSUECATEGORYS/ENUM" setselected="true">
						<WTCHANGE>doSubmit(5,"")</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueName"/>
					<WTTEXT col="2" value="ATTR(Issue.IssueName)" focus="true" size="60"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTROW>
						<WTSTATIC col="1" tag="AMemberID"/>
						<WTTEXT col="2" value="PARAM(AMemberID)" size="10"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="AName"/>
						<WTTEXT col="2" value="PARAM(AName)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="AEmail"/>
						<WTTEXT col="2" value="PARAM(AEmail)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="APhone"/>
						<WTTEXT col="2" value="PARAM(APhone)" size="60"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Issue.InputOptions)" oper="not-equal" value="CONST('')"/>
					<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="23"/>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Issue.Description)" cols="72" rows="8"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Submit)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_9505" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" mobile="MobileHome.asp">
		<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="T" datatype="number"/>
			<!-- SubmitType -->
			<WTPARAM name="I" datatype="number"/>
			<!-- SubmitID -->
			<WTPARAM name="N" datatype="text"/>
			<!-- SubmittedBy -->
			<WTPARAM name="Email" datatype="text"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="AName" datatype="text"/>
			<WTPARAM name="AEmail" datatype="text"/>
			<WTPARAM name="APhone" datatype="text"/>
			<WTPARAM name="AMemberID" datatype="text"/>
      <WTPARAM name="Custom" datatype="number"/>

      <WTINCLUDE name="Comm.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
			</WTCODEGROUP>

      <!-- Nexxus Custom Lists -->
      <WTCODEGROUP>
        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
        <WTCODEGROUP>
          <WTCONDITION expr="IsAnonymous"/>
          <WTGETCACHE name="CONST(MerchantID)" value="MERCHANT" datatype="number"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(MerchantID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="PARAM(Custom)" value="SYSCON(USERTYPE-PUBLIC)"/>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Custom)" oper="equal" value="CONST(0)"/>
            <WTGETCACHE name="CONST(ConsumerID)" value="CONSUMER" datatype="number"/>
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(ConsumerID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
              <WTSETATTRIBUTE name="PARAM(Custom)" value="SYSCON(USERTYPE-CUSTOM1)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTSUB name="LoadList">
				<WTOBJECT name="IssueCategorys" project="ptsIssueCategoryUser" class="CIssueCategorys">
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Custom)" oper="not-equal" value="CONST(0)" />
            <WTMETHOD name="EnumList">
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="PARAM(Custom)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(Custom)" oper="equal" value="CONST(0)" />
            <WTMETHOD name="EnumList">
              <WTCONDITION expr="IsAnonymous"/>
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PUBLIC)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
            <WTCODEGROUP>
              <WTCONDITION expr="IsMemberOnly"/>
              <WTMETHOD name="EnumList">
                <WTCONDITION expr="CONST(tmpLevel)" oper="not-equal" value="CONST(0)" />
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-GENERAL)"/>
                <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTMETHOD name="EnumList">
                <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)" />
                <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
                <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-FREE)"/>
                <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
              </WTMETHOD>
            </WTCODEGROUP>
            <WTMETHOD name="EnumList">
              <WTCONDITION expr="IsOrgAdminOnly"/>
              <WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-ADMIN)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
            <WTMETHOD name="EnumList">
              <WTCONDITION expr="IsEmployee"/>
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="UserType" direction="input" value="SYSCON(USERTYPE-PRIVATE)"/>
              <WTPARAM name="xmlIssueCategorys" direction="return" datatype="text"/>
            </WTMETHOD>
          </WTCODEGROUP>
        </WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="5" name="Category" type="New">
				<WTSETATTRIBUTE name="CONST(tmpIssueCategoryID)" value="FORM(IssueCategoryID)"/>
				<WTOBJECT name="IssueCategory" project="ptsIssueCategoryUser" class="CIssueCategory">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueCategoryID" direction="input" value="CONST(tmpIssueCategoryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
				</WTOBJECT>
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Issue.InputOptions)" value="CONST(tmpInputOptions)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<!-- FIX: APPLICATION SPECIFIC -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="PARAM(I)" value="SYS(MemberID)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(AName)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(AEmail)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10132" message="Oops, Please enter your name, email and phone."/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(N)" value="CONST(reqSysUserName)"/>
				<WTSETATTRIBUTE name="CONST(tmpIssueCategoryID)" value="FORM(IssueCategoryID)"/>
				<WTSETATTRIBUTE name="CONST(tmpAssignedTo)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="IssueCategory" project="ptsIssueCategoryUser" class="CIssueCategory">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpIssueCategoryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="IssueCategoryID" direction="input" value="CONST(tmpIssueCategoryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpAssignedTo)" value="ATTR(AssignedTo)"/>
					<WTSETATTRIBUTE name="CONST(tmpInputOptions)" value="ATTR(InputOptions)"/>
				</WTOBJECT>
				<!-- FIX: APPLICATION SPECIFIC -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(T)" oper="equal" value="ENTITY(Member)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(N)" value="CONST(Left(.MemberName,40))"/>
					<WTSETATTRIBUTE name="PARAM(Email)" value="ATTR(Email)"/>
				</WTOBJECT>
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.SubmitType)" value="PARAM(T)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.SubmitID)" value="PARAM(I)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.SubmittedBy)" value="PARAM(N)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.IssueDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.Priority)" value="CONST(2)"/>
					<WTSETATTRIBUTE name="ATTR(Issue.ChangeDate)" value="SYS(Now)"/>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(Issue.InputOptions)" value="CONST(tmpInputOptions)"/>
					<WTINPUTOPTIONS name="CONST(tmpInputOptions)" values="ATTR(InputValues)" secure="23"/>

          <WTSETATTRIBUTE name="ATTR(IssueName)" value="CONST(ValidXML(.IssueName))"/>
          <WTSETATTRIBUTE name="ATTR(Description)" value="CONST(ValidXML(.Description))"/>

          <WTCODEGROUP>
						<WTCONDITION expr="IsAnonymous"/>
						<WTCUSTOM>
							tmp = "#" + reqAMemberID + " " + reqAName + " " + reqAEmail + " " + reqAPhone + " ... " + .Description
							.Description = Left(tmp,1000)
						</WTCUSTOM>
					</WTCODEGROUP>

					<WTCUSTOM>
						If xmlError = "" Then
						If .AssignedTo = "" Then .AssignedTo = tmpAssignedTo
						If .AssignedTo &lt;&gt; "" Then .Status = 2
						'Email newly assigned employee
						If .Status = 2 AND .AssignedTo &lt;&gt; "" Then
						tmpToName = .AssignedTo
						tmpFromName = .SubmittedBy
						tmpSubject = "NEW ISSUE: " + .IssueName
						tmpBody = .Description
						End If
						End If
					</WTCUSTOM>
					<WTMETHOD name="Add">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="IssueID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpToName)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>

					<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
					</WTOBJECT>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Email)"/>
						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Email)"/>
					</WTOBJECT>

					<WTOBJECT name="Employee" project="ptsEmployeeUser" class="CEmployee">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="PARAM(Email)"/>-->
					</WTOBJECT>
					<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="GetEmail">
							<WTPARAM name="tmpTo" direction="return" datatype="text"/>
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="NameFirst" direction="input" value="CONST(tmpToName)"/>
						</WTMETHOD>
<!--						<WTSETATTRIBUTE name="CONST(tmpFrom)" value="PARAM(Email)"/>-->
					</WTOBJECT>
					<WTCUSTOM>
					  If InStr(tmpTo, "@") &gt; 0 Then
  					  SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
            End If
					</WTCUSTOM>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(Email)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="SubmitTicket" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="IssueCategoryID"/>
					<WTCOMBO col="2" value="ATTR(Issue.IssueCategoryID)" datapath="/DATA/TXN/PTSISSUECATEGORYS/ENUM" setselected="true">
						<WTCHANGE>doSubmit(5,"")</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueName"/>
					<WTTEXT col="2" value="ATTR(Issue.IssueName)" focus="true" size="25"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsAnonymous"/>
					<WTROW>
						<WTSTATIC col="1" tag="AMemberID"/>
						<WTTEXT col="2" value="PARAM(AMemberID)" size="10"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="AName"/>
						<WTTEXT col="2" value="PARAM(AName)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="AEmail"/>
						<WTTEXT col="2" value="PARAM(AEmail)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="APhone"/>
						<WTTEXT col="2" value="PARAM(APhone)" size="25"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Issue.InputOptions)" oper="not-equal" value="CONST('')"/>
					<WTINPUTOPTIONS name="InputOptions" values="InputValues" secure="23"/>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
				</WTROW>
				<WTROW>
					<WTMEMO col="1" merge="2" align="left" value="ATTR(Issue.Description)" cols="37" rows="8"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Submit)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
    <WTWEBPAGE name="9506" caption="Support Tickets" action="5" navbar="false" header="false" footer="false" wrapper="wrapper1000"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" focus="false" track="0">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="T" datatype="number"/> <!-- SubmitType -->
			<WTPARAM name="I" datatype="number"/> <!-- SubmitID -->
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="SubmitType" datatype="number"/>
			<WTPARAM name="SubmitID" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(IssueName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
<!-- FIX: APPLICATION SPECIFIC -->
      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
        <WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Member)"/>
        <WTSETATTRIBUTE name="PARAM(I)" value="SYS(MemberID)"/>
      </WTCODEGROUP>
      
      <WTCODEGROUP>
        <WTCONDITION expr="IsAnonymous"/>
        <WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
        <WTGETCACHE name="CONST(MerchantID)" value="MERCHANT" datatype="number"/>
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(MerchantID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Merchant)"/>
          <WTSETATTRIBUTE name="PARAM(I)" value="CONST(MerchantID)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)"/>
          <WTGETCACHE name="CONST(ConsumerID)" value="CONSUMER" datatype="number"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(ConsumerID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Consumer)"/>
            <WTSETATTRIBUTE name="PARAM(I)" value="CONST(ConsumerID)"/>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTCODEGROUP>
				<WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
				<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
				<WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
<WTCUSTOM>
			Response.Write "Unauthorized Access"
			Response.End
</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
				<WTCODEGROUP>
					<WTMETHOD name="FindSubmit">
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SubmitType" direction="input" value="PARAM(T)"/>
						<WTPARAM name="SubmitID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="FindSubmitStatus">
						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SubmitType" direction="input" value="PARAM(T)"/>
						<WTPARAM name="SubmitID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTCODEGROUP>
<WTCUSTOM>
				mNow = Now()
				For Each oIssue in oIssues
					With oIssue
						If .Status &lt; 3 Then
							If IsDate(.DueDate) Then
								.Variance = DATEDIFF( "d", .DueDate, mNow )
							End If
							.Quantity = DATEDIFF( "h", .IssueDate, mNow )
						End If
					End With
				Next
</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left"/>

        <WTFUNCTION name="ViewIssue(id)">
          var url, win;
          url = "9507.asp?issueid=" + id
          win = window.open(url,"PreviewIssue","top=100,left=100,height=500,width=630,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
          win.focus();
        </WTFUNCTION>
        <WTFUNCTION name="NewTicket()">
          var cid = document.getElementById('CompanyID').value;
          var t = document.getElementById('T').value;
          var i = document.getElementById('I').value;
          var ret = '9506.asp?contentpage=3%26popup=1' + '%26companyid=' + cid;
          window.location = "9505.asp?companyid=" + cid + "&amp;t=" + t + "&amp;i=" + i + "&amp;returnurl=" + ret;
        </WTFUNCTION>

        <WTROW>
          <WTHIDDEN value="PARAM(CompanyID)"/>
          <WTHIDDEN value="PARAM(T)"/>
          <WTHIDDEN value="PARAM(I)"/>
        </WTROW>

        <WTROW margin-top="12">
          <WTTABLE col="1">
            <WTCOLUMN width="200" align="left"/>
            <WTCOLUMN width="800" align="left"/>
            <WTROW>
              <WTIMAGE col="1" value="CONST(help72.png)" align="center"/>
              <WTTABLE col="2">
                <WTCOLUMN width="800" align="left"/>
                <WTROW margin-bottom="6">
                  <WTSTATIC col="1" label="SupportTicket" align="center" fontsize="5"/>
                </WTROW>
                <WTROW>
                  <WTSTATIC col="1" class="Prompt">
                    <WTSTATIC label="SupportTicketText" newline="1"/>
                    <WTSTATIC label="RateTicketText" fontcolor="purple" bold="true"/>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTTABLE>
        </WTROW>

        <WTROW margin-top="12" margin-bottom="6">
          <WTBUTTON col="1" value="CONST(AddNewTicket)" align="center">
            <WTCLICK>NewTicket()</WTCLICK>
          </WTBUTTON>
          <WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Issues.FindTypeID)" translate="true" prespace="false"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true" prespace="false"/>
					<WTSTATIC col="1" tag="Status" class="ColumnHeader"/>
					<WTCOMBO col="1" value="PARAM(Status)" prespace="false">
						<WTOPTION id="0" label="All"/>
						<WTOPTION id="1" label="Submitted"/>
            <WTOPTION id="2" label="Assigned"/>
            <WTOPTION id="3" label="InProcess"/>
            <WTOPTION id="4" label="Resolved"/>
						<WTOPTION id="5" label="Postponed"/>
						<WTOPTION id="6" label="Tested"/>
						<WTOPTION id="7" label="Deployed"/>
					</WTCOMBO>
					<WTBUTTON col="1" action="5" value="CONST(Search)" default="true"/>
          <WTBUTTON col="1" value="CONST(Close)">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Issue">
						<WTCOLUMN width="18" align="left" valign="top" label="TicketID"/>
						<WTCOLUMN width="42" align="left" valign="top" label="IssueCategory"/>
						<WTCOLUMN width="20" align="left" valign="top" label="SubmittedAssigned"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
						<WTCOLUMN width="10" align="right" valign="top" label="When"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueID)">
								<WTSTATIC fontcolor="red">
									<WTCONDITION expr="DATA(Issue.Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
									<WTSTATIC value="CONST( ()"/>
									<WTSTATIC value="DATA(Issue.Quantity)"/>
									<WTSTATIC value="CONST( hrs.))"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC value="DATA(Issue.IssueName)">
										<WTCONDITION expr="DATA(Variance)" oper="less-equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Issue.IssueName)" fontcolor="red">
										<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="9503">
												<WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="NotEmployee"/>
									<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
									<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
									<WTSTATIC value="DATA(Issue.IssueName)">
										<WTCONDITION expr="DATA(Variance)" oper="less-equal" value="CONST(0)"/>
									</WTSTATIC>
									<WTSTATIC value="DATA(Issue.IssueName)" fontcolor="red">
										<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="ViewIssue(&lt;xsl:value-of select=&quot;@issueid&quot;/&gt;)" click="true" />
									</WTIMAGE>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC fontcolor="red" space="2">
									<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="CONST(()"/>
									<WTSTATIC value="DATA(Variance)"/>
									<WTSTATIC value="CONST(days))"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Issue.SubmittedBy)"/>
							<WTSTATIC col="4" value="DATA(Issue.Priority)"/>
							<WTSTATIC col="5" value="DATA(Issue.DueDate)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueDate)" fontcolor="gray"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle">
										<WTLINK name="9508">
											<WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTSTATIC value="DATA(Issue.IssueCategoryName)" space="2" fontcolor="gray"/>
								<WTSTATIC value="DATA(Issue.ChangeDate)" fontcolor="purple"/>
							</WTSTATIC>
							<WTSTATIC col="3" value="DATA(Issue.AssignedTo)" fontcolor="gray"/>
							<WTSTATIC col="4" value="DATA(Issue.Status)" fontcolor="gray"/>
							<WTSTATIC col="5" value="DATA(Issue.DoneDate)" fontcolor="gray"/>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(Issue.InputValues)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="4" value="DATA(Issue.InputValues)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!-- =============================================================================================== -->
		<WTWEBPAGE name="m_9506" caption="Support Tickets" page-left="3" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" action="5" focus="false" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" track="0">
		<!-- =============================================================================================== -->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="T" datatype="number"/>
			<!-- SubmitType -->
			<WTPARAM name="I" datatype="number"/>
			<!-- SubmitID -->
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="SubmitType" datatype="number"/>
			<WTPARAM name="SubmitID" datatype="number"/>

			<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(IssueName)">
				<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<!-- FIX: APPLICATION SPECIFIC -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Member)"/>
				<WTSETATTRIBUTE name="PARAM(I)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

      <WTCODEGROUP>
        <WTCONDITION expr="IsAnonymous"/>
        <WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
        <WTGETCACHE name="CONST(MerchantID)" value="MERCHANT" datatype="number"/>
        <WTCODEGROUP>
          <WTCONDITION expr="CONST(MerchantID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Merchant)"/>
          <WTSETATTRIBUTE name="PARAM(I)" value="CONST(MerchantID)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)"/>
          <WTGETCACHE name="CONST(ConsumerID)" value="CONSUMER" datatype="number"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(ConsumerID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="PARAM(T)" value="ENTITY(Consumer)"/>
            <WTSETATTRIBUTE name="PARAM(I)" value="CONST(ConsumerID)"/>
          </WTCODEGROUP>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTCODEGROUP>
				<WTCONDITION expr="NotEmployee"/>
				<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
				<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
				<WTCONDITION expr="PARAM(T)" oper="equal" value="CONST(0)" connector="and"/>
				<WTCUSTOM>
					Response.Write "Unauthorized Access"
					Response.End
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Status)" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="CONST(reqFindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
				<WTCONDITION expr="CONST(reqActionCode)" oper="not-equal" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTMETHOD name="FindSubmit">
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SubmitType" direction="input" value="PARAM(T)"/>
						<WTPARAM name="SubmitID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="FindSubmitStatus">
						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
						<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
						<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
						<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
						<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SubmitType" direction="input" value="PARAM(T)"/>
						<WTPARAM name="SubmitID" direction="input" value="PARAM(I)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTCODEGROUP>
				<WTCUSTOM>
					mNow = Now()
					For Each oIssue in oIssues
					With oIssue
					If .Status &lt; 3 Then
					If IsDate(.DueDate) Then
					.Variance = DATEDIFF( "d", .DueDate, mNow )
					End If
					.Quantity = DATEDIFF( "h", .IssueDate, mNow )
					End If
					End With
					Next
				</WTCUSTOM>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

        <WTFUNCTION name="NewTicket()">
          var c = document.getElementById('CompanyID').value
          var t = document.getElementById('T').value
          var i = document.getElementById('I').value
          var url = "m_9505.asp?companyid=" + c + "&amp;t=" + t + "&amp;i=" + 
          var win = window.location = url + "&amp;returnurl=m_9506.asp?companyid=" + c
        </WTFUNCTION>

        <WTFUNCTION name="ViewIssue(id)">
					var url, win;
					url = "m_9507.asp?issueid=" + id
					win = window.open(url,"PreviewIssue","top=100,left=100,height=500,width=330,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no");
					win.focus();
				</WTFUNCTION>

        <WTROW>
          <WTHIDDEN value="PARAM(CompanyID)"/>
          <WTHIDDEN value="PARAM(T)"/>
          <WTHIDDEN value="PARAM(I)"/>
        </WTROW>

        <WTROW margin-bottom="6">
          <WTSTATIC col="1" label="SupportTicket" align="center" class="PageHeading"/>
				</WTROW>
<!--        
				<WTROW margin-bottom="3">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" class="Prompt" align="center">
						<WTSTATIC label="m_RateTicketText" fontcolor="purple" bold="true"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
-->
        <WTROW margin-bottom="6">
          <WTBUTTON col="1" value="CONST(AddNewTicket)" align="center">
            <WTCLICK>NewTicket();</WTCLICK>
          </WTBUTTON>
        </WTROW>
        <WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="ATTR(Issues.FindTypeID)" translate="true" prespace="false"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader" align="center"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true" prespace="false"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="Status" class="ColumnHeader" align="center"/>
					<WTCOMBO col="1" value="PARAM(Status)" prespace="false">
						<WTOPTION id="0" label="All"/>
						<WTOPTION id="1" label="Submitted"/>
						<WTOPTION id="2" label="Assigned"/>
            <WTOPTION id="3" label="InProcess"/>
            <WTOPTION id="4" label="Resolved"/>
            <WTOPTION id="5" label="Postponed"/>
						<WTOPTION id="6" label="Tested"/>
						<WTOPTION id="7" label="Deployed"/>
					</WTCOMBO>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="SYS(searchtype)" oper="not-equal" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" prevnext="true" entity="Issue">
						<WTCOLUMN width="10" align="left" valign="top" label="#"/>
						<WTCOLUMN width="90" align="left" valign="top" label="Description"/>
						<WTROW height="24">
							<WTSTATIC col="1" value="DATA(IssueID)"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(IssueName)">
									<WTCONDITION expr="DATA(Variance)" oper="less-equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(IssueName)" fontcolor="red">
									<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTIMAGE value="CONST(Preview.gif)" alt="Preview" imgalign="absmiddle">
										<WTLINK name="ViewIssue(&lt;xsl:value-of select=&quot;@issueid&quot;/&gt;)" click="true" />
									</WTIMAGE>
									<WTSTATIC space="1"/>
								</WTCODEGROUP>
								<WTSTATIC fontcolor="red" space="2">
									<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="CONST(()"/>
									<WTSTATIC value="DATA(Variance)"/>
									<WTSTATIC value="CONST(days))"/>
								</WTSTATIC>
								<WTSTATIC value="DATA(Status)" fontcolor="blue"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" fontcolor="gray">
								<WTSTATIC fontcolor="red">
									<WTCONDITION expr="DATA(Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
									<WTSTATIC value="DATA(Quantity)"/>
									<WTSTATIC value="CONST( hrs.)" space="1"/>
								</WTSTATIC>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle">
										<WTLINK name="m_9508">
											<WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTSTATIC value="DATA(IssueDate)" space="2"/>
								<WTSTATIC value="DATA(IssueCategoryName)" fontcolor="gray"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(InputValues)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" value="DATA(InputValues)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="9507" header="false" navbar="false" footer="false" wrapper="wrapper400s"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
		<!--============================================================================================-->
			<WTPARAM name="IssueID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTCONDITION expr="CONST(CLng(.SubmitID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="ATTR(Quantity)" value="CONST(DATEDIFF(&quot;h&quot;, .IssueDate, Now() ))">
						<WTCONDITION expr="ATTR(Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="300" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" value="ATTR(Issue.IssueName)" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="TicketID" height="18"/>
					<WTSTATIC col="2" value="ATTR(Issue.IssueID)" bold="true"/>
					<WTSTATIC col="2" fontcolor="red">
						<WTCONDITION expr="ATTR(Issue.Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
						<WTSTATIC value="CONST(()"/>
						<WTSTATIC value="ATTR(Issue.Quantity)" bold="true"/>
						<WTSTATIC value="CONST( hrs.))"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueDate"/>
					<WTSTATIC col="2" value="ATTR(Issue.IssueDate)" bold="true"/>
					<WTSTATIC col="2" tag="Updated" value="ATTR(Issue.ChangeDate)" fontcolor="purple"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueCategoryID"/>
					<WTSTATIC col="2" value="ATTR(Issue.IssueCategoryName)" bold="true"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="SubmittedBy"/>
					<WTSTATIC col="2" value="ATTR(Issue.SubmittedBy)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Priority"/>
					<WTSTATIC col="2" value="ATTR(Issue.Priority)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" value="ATTR(Issue.Description)" bold="true"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Issue.AssignedTo)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="AssignedTo"/>
					<WTSTATIC col="2" value="ATTR(Issue.AssignedTo)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status"/>
					<WTSTATIC col="2" value="ATTR(Issue.Status)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Issue.DueDate)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="DueDate"/>
					<WTSTATIC col="2" value="ATTR(Issue.DueDate)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Issue.DoneDate)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="DoneDate"/>
					<WTSTATIC col="2" value="ATTR(Issue.DoneDate)" bold="true" prespace="false"/>
					<WTSTATIC col="2" value="ATTR(Issue.Variance)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Notes" align="left"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" value="ATTR(Issue.Notes)" bold="true"/>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_9507" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp">
		<!--============================================================================================-->
			<WTPARAM name="IssueID" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTCONDITION expr="CONST(CLng(.SubmitID))" oper="not-equal" value="SYS(MemberID)" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="ATTR(Quantity)" value="CONST(DATEDIFF(&quot;h&quot;, .IssueDate, Now() ))">
						<WTCONDITION expr="ATTR(Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="33" align="right"/>
				<WTCOLUMN width="67" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" value="ATTR(Issue.IssueName)" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="TicketID" height="18"/>
					<WTSTATIC col="2" value="ATTR(Issue.IssueID)" bold="true"/>
					<WTSTATIC col="2" fontcolor="red">
						<WTCONDITION expr="ATTR(Issue.Status)" oper="less" value="SYSCON(STATUS-RESOLVED)"/>
						<WTSTATIC value="CONST(()"/>
						<WTSTATIC value="ATTR(Issue.Quantity)" bold="true"/>
						<WTSTATIC value="CONST( hrs.))"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueDate"/>
					<WTSTATIC col="2" value="ATTR(Issue.IssueDate)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Updated"/>
					<WTSTATIC col="2" value="ATTR(Issue.ChangeDate)" fontcolor="blue"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="IssueCategoryID"/>
					<WTSTATIC col="2" value="ATTR(Issue.IssueCategoryName)" bold="true"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="SubmittedBy"/>
					<WTSTATIC col="2" value="ATTR(Issue.SubmittedBy)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Priority"/>
					<WTSTATIC col="2" value="ATTR(Issue.Priority)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Description" align="left"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" value="ATTR(Issue.Description)" bold="true"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Issue.AssignedTo)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="AssignedTo"/>
					<WTSTATIC col="2" value="ATTR(Issue.AssignedTo)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status"/>
					<WTSTATIC col="2" value="ATTR(Issue.Status)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Issue.DueDate)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="DueDate"/>
					<WTSTATIC col="2" value="ATTR(Issue.DueDate)" bold="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Issue.DoneDate)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" tag="DoneDate"/>
					<WTSTATIC col="2" value="ATTR(Issue.DoneDate)" bold="true" prespace="false"/>
					<WTSTATIC col="2" value="ATTR(Issue.Variance)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Notes" align="left"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" value="ATTR(Issue.Notes)" bold="true"/>
				</WTROW>

				<WTROW margin-top="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="9508" caption="Ratings" navbar="false" focus="false" 
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--===============================================================================-->
			<WTPARAM name="IssueID" datatype="number"/>
			<WTPARAM name="Feedback" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						pos = InStr(.Notes, &quot;Feedback:&quot;)
						If pos &gt; 0 Then reqFeedback = Mid(.Notes, pos+9)
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Rating)" value="FORM(Rating)"/>
					<WTSETATTRIBUTE name="CONST(Feedback)" value="FORM(Feedback)"/>
					<WTCUSTOM>
						tmpNotes = .Notes
						pos = InStr(tmpNotes, &quot;Feedback:&quot;)
						If pos &gt; 0 Then tmpNotes = Mid(tmpNotes, 1, pos-1) Else tmpNotes = tmpNotes + &quot; &quot;
						tmpNotes = tmpNotes + &quot;Feedback:&quot; + Feedback
						.Notes = tmpNotes
					</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION name="Cancel" type="Update" id="3">
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="75" align="left"/>
				<WTCOLUMN width="600" align="center"/>
				<WTCOLUMN width="75" align="left"/>

				<WTFUNCTION name="SelectRating(rating)">
					document.getElementById('Rating').value = rating;
					for(i = 1; i &lt;= 5; i++){
					if( i &gt; rating){
					document.getElementById( "Rating" + String(i) ).src = "Images/star_empty.gif";
					}else{
					document.getElementById( "Rating" + String(i) ).src = "Images/star_full.gif";
					}
					}
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="ATTR(Issue.Rating)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="6">
					<WTSTATIC col="1" merge="3" label="IssueRating" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" value="ATTR(Issue.IssueName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="RatingInstructions" class="Prompt" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" />
					<WTTABLE col="2" >
						<WTCOLUMN width="330" align="left"/>
						<WTCOLUMN width="54" align="center"/>
						<WTCOLUMN width="54" align="center"/>
						<WTCOLUMN width="54" align="center"/>
						<WTCOLUMN width="54" align="center"/>
						<WTCOLUMN width="54" align="center"/>

						<WTROW margin-bottom="6">
							<WTSTATIC col="1" label="ClickStar" bold="true"/>
							<WTSTATIC col="2" label="P"/>
							<WTSTATIC col="3" label="F"/>
							<WTSTATIC col="4" label="G"/>
							<WTSTATIC col="5" label="GR"/>
							<WTSTATIC col="6" label="E"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="Rating" class="PageHeading"/>
							<WTIMAGE col="2" value="CONST(star_empty.gif)" id="Rating1" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(1)"/>
								<WTCLICK>SelectRating(1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(star_full.gif)" id="Rating1" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(1)"/>
								<WTCLICK>SelectRating(1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(star_empty.gif)" id="Rating2" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(2)"/>
								<WTCLICK>SelectRating(2);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(star_full.gif)" id="Rating2" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(2)"/>
								<WTCLICK>SelectRating(2);</WTCLICK>
							</WTIMAGE>

							<WTIMAGE col="4" value="CONST(star_empty.gif)" id="Rating3" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(3)"/>
								<WTCLICK>SelectRating(3);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="4" value="CONST(star_full.gif)" id="Rating3" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(3)"/>
								<WTCLICK>SelectRating(3);</WTCLICK>
							</WTIMAGE>

							<WTIMAGE col="5" value="CONST(star_empty.gif)" id="Rating4" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(4)"/>
								<WTCLICK>SelectRating(4);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="5" value="CONST(star_full.gif)" id="Rating4" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(4)"/>
								<WTCLICK>SelectRating(4);</WTCLICK>
							</WTIMAGE>

							<WTIMAGE col="6" value="CONST(star_empty.gif)" id="Rating5" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(5)"/>
								<WTCLICK>SelectRating(5);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="6" value="CONST(star_full.gif)" id="Rating5" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(5)"/>
								<WTCLICK>SelectRating(5);</WTCLICK>
							</WTIMAGE>
						</WTROW>

						<WTROW margin-bottom="6" margin-top="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="Feedback" align="left" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTMEMO col="1" merge="6" value="PARAM(Feedback)" rows="6" cols="72"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="3" action="1" value="CONST(Submit)" align="center"/>
					<WTBUTTON col="1" merge="3" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_9508" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" mobile="MobileHome.asp">
			<!--===============================================================================-->
			<WTPARAM name="IssueID" datatype="number"/>
			<WTPARAM name="Feedback" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						pos = InStr(.Notes, &quot;Feedback:&quot;)
						If pos &gt; 0 Then reqFeedback = Mid(.Notes, pos+9)
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssue" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="Issue" project="ptsIssueUser" class="CIssue">
					<WTMETHOD name="Load">
						<WTPARAM name="IssueID" direction="input" value="PARAM(IssueID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Rating)" value="FORM(Rating)"/>
					<WTSETATTRIBUTE name="CONST(Feedback)" value="FORM(Feedback)"/>
					<WTCUSTOM>
						tmpNotes = .Notes
						pos = InStr(tmpNotes, &quot;Feedback:&quot;)
						If pos &gt; 0 Then tmpNotes = Mid(tmpNotes, 1, pos-1) Else tmpNotes = tmpNotes + &quot; &quot;
						tmpNotes = tmpNotes + &quot;Feedback:&quot; + Feedback
						.Notes = tmpNotes
					</WTCUSTOM>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION name="Cancel" type="Update" id="3">
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTFUNCTION name="SelectRating(rating)">
					document.getElementById('Rating').value = rating;
					for(i = 1; i &lt;= 5; i++){
					if( i &gt; rating){
					document.getElementById( "Rating" + String(i) ).src = "Images/star_empty.gif";
					}else{
					document.getElementById( "Rating" + String(i) ).src = "Images/star_full.gif";
					}
					}
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="ATTR(Issue.Rating)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="6">
					<WTSTATIC col="1" label="IssueRating" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="ATTR(Issue.IssueName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="RatingInstructions" class="Prompt" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" >
						<WTCOLUMN width="20" align="center"/>
						<WTCOLUMN width="20" align="center"/>
						<WTCOLUMN width="20" align="center"/>
						<WTCOLUMN width="20" align="center"/>
						<WTCOLUMN width="20" align="center"/>

						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="5" label="Rating" class="PageHeading" align="center"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="5" label="ClickStar" bold="true" align="center"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" label="P"/>
							<WTSTATIC col="2" label="F"/>
							<WTSTATIC col="3" label="G"/>
							<WTSTATIC col="4" label="GR"/>
							<WTSTATIC col="5" label="E"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTIMAGE col="1" value="CONST(star_empty.gif)" id="Rating1" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(1)"/>
								<WTCLICK>SelectRating(1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="1" value="CONST(star_full.gif)" id="Rating1" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(1)"/>
								<WTCLICK>SelectRating(1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(star_empty.gif)" id="Rating2" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(2)"/>
								<WTCLICK>SelectRating(2);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(star_full.gif)" id="Rating2" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(2)"/>
								<WTCLICK>SelectRating(2);</WTCLICK>
							</WTIMAGE>

							<WTIMAGE col="3" value="CONST(star_empty.gif)" id="Rating3" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(3)"/>
								<WTCLICK>SelectRating(3);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(star_full.gif)" id="Rating3" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(3)"/>
								<WTCLICK>SelectRating(3);</WTCLICK>
							</WTIMAGE>

							<WTIMAGE col="4" value="CONST(star_empty.gif)" id="Rating4" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(4)"/>
								<WTCLICK>SelectRating(4);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="4" value="CONST(star_full.gif)" id="Rating4" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(4)"/>
								<WTCLICK>SelectRating(4);</WTCLICK>
							</WTIMAGE>

							<WTIMAGE col="5" value="CONST(star_empty.gif)" id="Rating5" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="less" value="CONST(5)"/>
								<WTCLICK>SelectRating(5);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="5" value="CONST(star_full.gif)" id="Rating5" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Issue.Rating)" oper="greater-equal" value="CONST(5)"/>
								<WTCLICK>SelectRating(5);</WTCLICK>
							</WTIMAGE>
						</WTROW>

						<WTROW margin-bottom="6" margin-top="6">
							<WTDIVIDER col="1" merge="5" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="5" label="Feedback" align="left" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTMEMO col="1" merge="6" value="PARAM(Feedback)" rows="6" cols="35"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Submit)" align="center"/>
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9510" caption="Issue Reports" form="Report" header="false" navbar="false" footer="false"  wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="9510" language="false" secured="52">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number"/>
			  
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(DateAdd(&quot;d&quot;, -7, Date()))"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="CONST(DateAdd(&quot;d&quot;, 1, Date()))"/>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="CreateReport( page, target, options )">
					var url;
					var win;
					url = page + ".asp?companyid=" + Report.CompanyID.value + "&amp;FromDate=" + Report.FromDate.value + "&amp;ToDate=" + Report.ToDate.value;
					if ( options ) url += "&amp;" + options;
					win = window.open(url,target);
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" align="left" merge="2" class="PageHeading">
						<WTSTATIC label="IssueReports">
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="SupportTicketReports">
							<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="IssueReportText" align="left" class="Prompt"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" align="center" tag="ReportOn"/>
					<WTCOMBO col="1" merge="2" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="PrevWeek"/>
						<WTOPTION id="4" label="PrevMonth"/>
						<WTOPTION id="5" label="PrevYear"/>
						<WTOPTION id="6" label="WeekToDate"/>
						<WTOPTION id="7" label="MonthToDate"/>
						<WTOPTION id="8" label="YearToDate"/>
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "4":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "5":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "7":
							fromdate.setDate(1);
							break;
							case "8":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							}
							document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" merge="2" align="center" tag="From"/>
					<WTTEXT col="1" merge="2" value="PARAM(FromDate)" name="FromDate" type="date" size="15"/>
					<WTSTATIC col="1" merge="2" tag="To"/>
					<WTTEXT col="1" merge="2" value="PARAM(ToDate)" name="ToDate" type="date" size="15"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" tag="AssignedTo" align="center" />
					<WTTEXT col="1" merge="2" name="Assigned" size="6" align="center" prespace="false" />
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" merge="2" align="center" value="IssueStatusReport">
						<WTCLICK>CreateReport("9560","Report", "report=1&amp;assigned="+Report.Assigned.value);</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" merge="2" align="center" value="IssueLateReport">
						<WTCLICK>CreateReport("9562","Report", "report=1&amp;assigned="+Report.Assigned.value);</WTCLICK>
					</WTBUTTON>
				</WTROW>
        <WTROW margin-bottom="6">
          <WTBUTTON col="1" merge="2" align="center" value="IssueRatingReport">
            <WTCLICK>CreateReport("9563","Report", "report=1&amp;assigned="+Report.Assigned.value);</WTCLICK>
          </WTBUTTON>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTBUTTON col="1" merge="2" align="center" value="IssueOutsourceReport">
            <WTCLICK>CreateReport("9564","Report", "report=1&amp;assigned="+Report.Assigned.value);</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9560" caption="Issue Reports" navbar="false" footer="false" wrapper="wrapper750"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="9560" language="false" secured="52">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="ChartSource" datatype="text"/>
			<WTPARAM name="Unit" datatype="text"/>
			<WTPARAM name="ImageMap" datatype="text"/>
			<WTPARAM name="Assigned" datatype="text"/>
			
			<WTINCLUDE name="ChartURL.asp"/>
		   
			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqAssigned = "" Then reqReport = 1 Else reqReport = 2
				reqToDate = DateAdd("d",1,reqToDate)
				If IsDate(reqFromDate) AND IsDate(reqToDate) Then
					tmpDays = DateDiff("d", reqFromDate, reqToDate )
					If tmpDays &lt;= 31 Then reqUnit = "day"
					If tmpDays &gt; 31 AND tmpDays &lt;= 90 Then reqUnit = "week"
					If tmpDays &gt; 90 AND tmpDays &lt;= 365 Then reqUnit = "month"
					If tmpDays &gt; 365 Then reqUnit = "quarter"
				Else
					reqFromDate = Date()
					reqToDate = DateAdd("d",1,reqFromDate)
					reqUnit = "day"	
				End If
</WTCUSTOM>
				<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
					<WTMETHOD name="ReportStatus">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportStatusAssigned">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="AssignedTo" direction="input" value="PARAM(Assigned)"/>
					</WTMETHOD>
<WTCUSTOM>
	tmpData = ""
	tmpLabels = ""
	Dim extraData
	ReDim extraData(oIssues.Count)
	counter = LBound(extraData)
	For Each oIssue in oIssues
		With oIssue
			reqCount = reqCount + .Quantity
			Select Case reqReport
			Case 1:
				tmpLabels = tmpLabels + .Status + "|"
				tmpData = tmpData + .Quantity + "|"
				extraData(counter) = .IssueID
			Case 2:
				tmpLabels = tmpLabels + .Status + "|"
				tmpData = tmpData + .Quantity + "|"
				extraData(counter) = .IssueID
			End Select
		End With
		counter = counter + 1
	Next

	'Remove last | delimiter
	If tmpData &lt;&gt; "" And Right(tmpData,1) = "|" Then tmpData = Left(tmpData, Len(tmpData)-1 )
	If tmpLabels &lt;&gt; "" And Right(tmpLabels,1) = "|" Then tmpLabels = Left(tmpLabels, Len(tmpLabels)-1 )

	reqCount = FormatNumber(reqCount,0)
	tmpImageMapURL = "9561.asp?CompanyID=" &amp; reqCompanyID &amp; "&amp;Report=" &amp; reqReport &amp; "&amp;FromDate=" &amp; reqFromDate &amp; "&amp;ToDate=" &amp; reqToDate &amp; "&amp;Assigned=" &amp; reqAssigned

	Select Case reqReport
	Case 1:
		ChartLabels "9560Chart1", tmpLabels, "", "", "", ""
		reqChartSource = ChartImageMap( "pie", 750, 400, "", "", "", tmpData, tmpLabels, "", "", "", extraData, reqImageMap, tmpImageMapURL)
	Case 2:
		ChartLabels "9560Chart1", tmpLabels, "", "", "", ""
		reqChartSource = ChartImageMap( "pie", 750, 400, "", "", "", tmpData, tmpLabels, "", "", "", extraData, reqImageMap, tmpImageMapURL)
	End Select
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="StatusReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="AssignedAll" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="StatusAssignedReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" tag="AssignedTo" value="PARAM(Assigned)" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" class="BoldText">
						<WTSTATIC tag="Changed" space="1"/>
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-top="24" margin-bottom="24">
					<WTCONDITION expr="PARAM(Count)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" label="NoReportData" class="PageHeading" align="center"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)"/>

					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(ImageMap)" oper="not-exist"/>
						<WTIMAGE col="1" align="center" value="PARAM(ChartSource)" path="../.."/>
					</WTROW>
				
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(ImageMap)" oper="not-equal" value="CONST('')"/>
						<WTIMAGE col="1" align="center" value="PARAM(ChartSource)" path="charts" usemap="Map1"/>
						<WTMAP col="1" align="center" name="Map1" areahtml="PARAM(ImageMap)"/>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTSTATIC col="1" align="center" tag="TotalIssues" value="PARAM(Count)" class="PageHeading"/>
					</WTROW>

				</WTCODEGROUP>

				<WTROW margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9561" caption="Issue Detail Reports" header="false" navbar="false" footer="false" wrapper="wrapper750"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="9561" language="false" secured="52">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="IDField" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Unit" datatype="text"/>
			<WTPARAM name="Assigned" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqAssigned = "" Then reqReport = 1 Else reqReport = 2
				Select Case reqReport
				Case 1: reqUnit = "Status" &amp; reqIDField
				Case 2: reqUnit = "Status" &amp; reqIDField
				End Select
</WTCUSTOM>
				<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
					<WTMETHOD name="ReportStatusDetail">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(IDField)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportStatusAssignedDetail">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="AssignedTo" direction="input" value="PARAM(Assigned)"/>
						<WTPARAM name="Status" direction="input" value="PARAM(IDField)"/>
					</WTMETHOD>
<WTCUSTOM>
				xmlData = ""
				mNow = Date()
				For Each oIssue in oIssues
					reqCount = reqCount + 1
					With oIssue
						If .Status &lt; 3 AND IsDate(.DueDate) Then
						.Variance = DATEDIFF( "d", .DueDate, mNow )
						End If
					End With
				Next
				reqCount = FormatNumber(reqCount,0)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTSTATIC label="Status"/>
				<WTSTATIC label="Status0"/>
				<WTSTATIC label="Status1"/>
				<WTSTATIC label="Status2"/>
				<WTSTATIC label="Status3"/>
				<WTSTATIC label="Status4"/>
				<WTSTATIC label="Status5"/>
				<WTSTATIC label="Status6"/>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="StatusReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="AssignedAll" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="StatusAssignedReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" tag="AssignedTo" value="PARAM(Assigned)" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" label="PARAM(Unit)" class="PageHeading" align="center"/>
				</WTROW>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" align="center" class="BoldText">
						<WTSTATIC tag="Changed" space="1"/>
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Issue">
						<WTCOLUMN width="18" align="left" valign="top" label="IssueID"/>
						<WTCOLUMN width="37" align="left" valign="top" label="IssueCategory"/>
						<WTCOLUMN width="25" align="left" valign="top" label="SubmittedAssigned"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
						<WTCOLUMN width="10" align="right" valign="top" label="When"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueID)"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Issue.IssueName)">
									<WTCONDITION expr="DATA(Variance)" oper="less-equal" value="CONST(0)"/>
									<WTLINK name="9503"><WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="DATA(Issue.IssueName)" fontcolor="red">
									<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
									<WTLINK name="9503"><WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC fontcolor="red" space="2">
									<WTCONDITION expr="DATA(Variance)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="CONST(()"/>
									<WTSTATIC value="DATA(Variance)"/>
									<WTSTATIC value="CONST(days))"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" tag="By" value="DATA(Issue.SubmittedBy)"/>
							<WTSTATIC col="4" value="DATA(Issue.Priority)"/>
							<WTSTATIC col="5" value="DATA(Issue.DueDate)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueDate)" fontcolor="gray"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Issue.IssueCategoryName)" space="2" fontcolor="gray"/>
								<WTSTATIC value="DATA(Issue.ChangeDate)" fontcolor="purple"/>
							</WTSTATIC>
              <WTSTATIC col="3" fontcolor="gray">
                <WTSTATIC tag="To" value="DATA(Issue.AssignedTo)"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(Outsource)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC value="CONST(/)"/>
                  <WTSTATIC value="DATA(Issue.Outsource)"/>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="4" value="DATA(Issue.Status)" fontcolor="gray"/>
							<WTSTATIC col="5" value="DATA(Issue.DoneDate)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" align="left" tag="TotalIssues" value="PARAM(Count)" class="PageHeading"/>
				</WTROW>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9562" caption="Late Issues" header="false" navbar="false" footer="false" wrapper="wrapper750"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="9562" language="false" secured="52">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Assigned" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqAssigned = "" Then reqReport = 1 Else reqReport = 2
</WTCUSTOM>
				<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
					<WTMETHOD name="ReportLate">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportLateAssigned">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="AssignedTo" direction="input" value="PARAM(Assigned)"/>
					</WTMETHOD>
<WTCUSTOM>
				xmlData = ""
				mNow = Date()
				For Each oIssue in oIssues
					reqCount = reqCount + 1
					With oIssue
						If .Status &lt; 3 AND IsDate(.DueDate) Then
						.Variance = DATEDIFF( "d", .DueDate, mNow )
						End If
					End With
				Next
				reqCount = FormatNumber(reqCount,0)
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTSTATIC label="Status"/>
				<WTSTATIC label="Status0"/>
				<WTSTATIC label="Status1"/>
				<WTSTATIC label="Status2"/>
				<WTSTATIC label="Status3"/>
				<WTSTATIC label="Status4"/>
				<WTSTATIC label="Status5"/>
				<WTSTATIC label="Status6"/>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="LateReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="AssignedAll" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="LateAssignedReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" tag="AssignedTo" value="PARAM(Assigned)" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" align="center" class="BoldText">
						<WTSTATIC tag="Changed" space="1"/>
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Issue">
						<WTCOLUMN width="18" align="left" valign="top" label="IssueID"/>
						<WTCOLUMN width="37" align="left" valign="top" label="IssueCategory"/>
						<WTCOLUMN width="25" align="left" valign="top" label="SubmittedAssigned"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
						<WTCOLUMN width="10" align="right" valign="top" label="When"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueID)"/>
							<WTSTATIC col="2" fontcolor="red">
								<WTSTATIC value="DATA(Issue.IssueName)" space="2" fontcolor="red">
									<WTLINK name="9503"><WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/></WTLINK>
								</WTSTATIC>
								<WTSTATIC value="CONST(()"/>
								<WTSTATIC value="DATA(Variance)"/>
								<WTSTATIC value="CONST(days))"/>
							</WTSTATIC>
							<WTSTATIC col="3" tag="By" value="DATA(Issue.SubmittedBy)"/>
							<WTSTATIC col="4" value="DATA(Issue.Priority)"/>
							<WTSTATIC col="5" value="DATA(Issue.DueDate)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueDate)" fontcolor="gray"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Issue.IssueCategoryName)" space="2" fontcolor="gray"/>
								<WTSTATIC value="DATA(Issue.ChangeDate)" fontcolor="purple"/>
							</WTSTATIC>
              <WTSTATIC col="3" fontcolor="gray">
                <WTSTATIC tag="To" value="DATA(Issue.AssignedTo)"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(Outsource)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC value="CONST(/)"/>
                  <WTSTATIC value="DATA(Issue.Outsource)"/>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="4" value="DATA(Issue.Status)" fontcolor="gray"/>
							<WTSTATIC col="5" value="DATA(Issue.DoneDate)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" align="left" tag="TotalIssues" value="PARAM(Count)" class="PageHeading"/>
				</WTROW>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="9563" caption="Rating Issues" header="false" navbar="false" footer="false" wrapper="wrapper750"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="9563" language="false" secured="52">
			<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Assigned" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
				<WTCUSTOM>
					'validate all parameters
					If reqAssigned = "" Then reqReport = 1 Else reqReport = 2
				</WTCUSTOM>
				<WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
					<WTMETHOD name="ReportRating">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="ReportRatingAssigned">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="AssignedTo" direction="input" value="PARAM(Assigned)"/>
					</WTMETHOD>
					<WTCUSTOM>
						xmlData = ""
						mNow = Date()
						For Each oIssue in oIssues
						reqCount = reqCount + 1
						With oIssue
						If .Status &lt; 3 AND IsDate(.DueDate) Then
						.Variance = DATEDIFF( "d", .DueDate, mNow )
						End If
						pos = InStr(.Notes, "Feedback:")
						If pos &gt; 0 Then .Notes = Mid(.Notes, pos+9)
						End With
						Next
						reqCount = FormatNumber(reqCount,0)
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlIssues" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTSTATIC label="Status"/>
				<WTSTATIC label="Status0"/>
				<WTSTATIC label="Status1"/>
				<WTSTATIC label="Status2"/>
				<WTSTATIC label="Status3"/>
				<WTSTATIC label="Status4"/>
				<WTSTATIC label="Status5"/>
				<WTSTATIC label="Status6"/>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="RatingReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="AssignedAll" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" label="RatingAssignedReport" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="3">
						<WTSTATIC col="1" tag="AssignedTo" value="PARAM(Assigned)" class="PageHeading" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" align="center" class="BoldText">
						<WTSTATIC tag="Changed" space="1"/>
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Issue">
						<WTCOLUMN width="18" align="left" valign="top" label="IssueID"/>
						<WTCOLUMN width="37" align="left" valign="top" label="IssueCategory"/>
						<WTCOLUMN width="25" align="left" valign="top" label="SubmittedAssigned"/>
						<WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
						<WTCOLUMN width="10" align="right" valign="top" label="When"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueID)"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(Issue.IssueName)"/>
								<WTSTATIC space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="9503">
											<WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" tag="By" value="DATA(Issue.SubmittedBy)"/>
							<WTSTATIC col="4" value="DATA(Issue.Priority)"/>
							<WTSTATIC col="5" value="DATA(Issue.DueDate)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Issue.IssueDate)" fontcolor="gray"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="NotManager"/>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="IsManager"/>
									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle">
										<WTLINK name="9508">
											<WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTSTATIC value="DATA(Issue.IssueCategoryName)" space="2" fontcolor="gray"/>
								<WTSTATIC value="DATA(Issue.ChangeDate)" fontcolor="purple"/>
							</WTSTATIC>
              <WTSTATIC col="3" fontcolor="gray">
                <WTSTATIC tag="To" value="DATA(Issue.AssignedTo)"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(Outsource)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC value="CONST(/)"/>
                  <WTSTATIC value="DATA(Issue.Outsource)"/>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="4" value="DATA(Issue.Status)" fontcolor="gray"/>
							<WTSTATIC col="5" value="DATA(Issue.DoneDate)" fontcolor="gray"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="4" value="DATA(Issue.Notes)" fontcolor="gray"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" align="left" tag="TotalIssues" value="PARAM(Count)" class="PageHeading"/>
				</WTROW>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--==================================================================-->
    <WTWEBPAGE name="9564" caption="Outsource Issues" header="false" navbar="false" footer="false" wrapper="wrapper750"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="9564" language="false" secured="52">
      <!--==================================================================-->
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Report" datatype="number"/>
      <WTPARAM name="FromDate" datatype="date"/>
      <WTPARAM name="ToDate" datatype="date"/>
      <WTPARAM name="Count" datatype="number"/>
      <WTPARAM name="Assigned" datatype="text"/>

      <WTACTION id="0" name="New" type="New">
        <WTCUSTOM>
          'validate all parameters
          If reqAssigned = "" Then reqReport = 1 Else reqReport = 2
        </WTCUSTOM>
        <WTOBJECT name="Issues" project="ptsIssueUser" class="CIssues">
          <WTMETHOD name="ReportOutsource">
            <WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
            <WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
          </WTMETHOD>
          <WTMETHOD name="ReportOutsourceAssigned">
            <WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
            <WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
            <WTPARAM name="AssignedTo" direction="input" value="PARAM(Assigned)"/>
          </WTMETHOD>
          <WTCUSTOM>
            xmlData = ""
            mNow = Date()
            For Each oIssue in oIssues
            reqCount = reqCount + 1
            With oIssue
            If .Status &lt; 3 AND IsDate(.DueDate) Then
            .Variance = DATEDIFF( "d", .DueDate, mNow )
            End If
            pos = InStr(.Notes, "Feedback:")
            If pos &gt; 0 Then .Notes = Mid(.Notes, pos+9)
            End With
            Next
            reqCount = FormatNumber(reqCount,0)
          </WTCUSTOM>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlIssues" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(13)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTACTION>

      <!--************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="750" align="left"/>

        <WTSTATIC label="Status"/>
        <WTSTATIC label="Status0"/>
        <WTSTATIC label="Status1"/>
        <WTSTATIC label="Status2"/>
        <WTSTATIC label="Status3"/>
        <WTSTATIC label="Status4"/>
        <WTSTATIC label="Status5"/>
        <WTSTATIC label="Status6"/>

        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
        </WTROW>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" label="OutsourceReport" class="PageHeading" align="center"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" label="AssignedAll" class="PageHeading" align="center"/>
          </WTROW>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" label="OutsourceAssignedReport" class="PageHeading" align="center"/>
          </WTROW>
          <WTROW margin-bottom="3">
            <WTSTATIC col="1" tag="AssignedTo" value="PARAM(Assigned)" class="PageHeading" align="center"/>
          </WTROW>
        </WTCODEGROUP>

        <WTROW margin-bottom="3">
          <WTSTATIC col="1" align="center" class="BoldText">
            <WTSTATIC tag="Changed" space="1"/>
            <WTSTATIC value="PARAM(FromDate)"/>
            <WTSTATIC value="CONST( - )"/>
            <WTSTATIC value="PARAM(ToDate)"/>
          </WTSTATIC>
        </WTROW>
        <WTROW margin-bottom="6">
          <WTDIVIDER col="1" height="1" color="SYS(divider)"/>
        </WTROW>

        <WTROW>
          <WTRECORDSET col="1" graybar="true" entity="Issue">
            <WTCOLUMN width="18" align="left" valign="top" label="IssueID"/>
            <WTCOLUMN width="37" align="left" valign="top" label="IssueCategory"/>
            <WTCOLUMN width="25" align="left" valign="top" label="SubmittedAssigned"/>
            <WTCOLUMN width="10" align="left" valign="top" label="Priority"/>
            <WTCOLUMN width="10" align="right" valign="top" label="When"/>

            <WTROW>
              <WTSTATIC col="1" value="DATA(Issue.IssueID)"/>
              <WTSTATIC col="2">
                <WTSTATIC value="DATA(Issue.IssueName)"/>
                <WTSTATIC space="1"/>
                <WTCODEGROUP>
                  <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                    <WTLINK name="9503">
                      <WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="3" tag="By" value="DATA(Issue.SubmittedBy)"/>
              <WTSTATIC col="4" value="DATA(Issue.Priority)"/>
              <WTSTATIC col="5" value="DATA(Issue.DueDate)"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1" value="DATA(Issue.IssueDate)" fontcolor="gray"/>
              <WTSTATIC col="2">
                <WTCODEGROUP>
                  <WTCONDITION expr="NotManager"/>
                  <WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="IsManager"/>
                  <WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@rating*2&quot;/&gt;.gif)" imgalign="absmiddle">
                    <WTLINK name="9508">
                      <WTPARAM name="IssueID" value="DATA(Issue.IssueID)"/>
                    </WTLINK>
                  </WTIMAGE>
                </WTCODEGROUP>
                <WTSTATIC space="2"/>
                <WTSTATIC value="DATA(Issue.IssueCategoryName)" space="2" fontcolor="gray"/>
                <WTSTATIC value="DATA(Issue.ChangeDate)" fontcolor="purple"/>
              </WTSTATIC>
              <WTSTATIC col="3" fontcolor="gray">
                <WTSTATIC tag="To" value="DATA(Issue.AssignedTo)"/>
                <WTCODEGROUP>
                  <WTCONDITION expr="DATA(Outsource)" oper="not-equal" value="CONST('')"/>
                  <WTSTATIC value="CONST(/)"/>
                  <WTSTATIC value="DATA(Issue.Outsource)"/>
                </WTCODEGROUP>
              </WTSTATIC>
              <WTSTATIC col="4" value="DATA(Issue.Status)" fontcolor="gray"/>
              <WTSTATIC col="5" value="DATA(Issue.DoneDate)" fontcolor="gray"/>
            </WTROW>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" merge="4" value="DATA(Issue.Notes)" fontcolor="gray"/>
            </WTROW>
          </WTRECORDSET>
        </WTROW>
        <WTROW margin-top="6">
          <WTSTATIC col="1" align="left" tag="TotalIssues" value="PARAM(Count)" class="PageHeading"/>
        </WTROW>

        <WTROW margin-bottom="12" margin-top="12">
          <WTBUTTON col="1" value="CONST(Close)" align="center">
            <WTCLICK>window.close()</WTCLICK>
          </WTBUTTON>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

  </WTWEBPAGES>
</WTROOT>