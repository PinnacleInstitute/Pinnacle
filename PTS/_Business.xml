<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="00" name="Business" alias="bu" audit="false">
		<!--Identity-->
		<WTATTRIBUTE id="0001" name="BusinessID" type="number" identity="true" min="1" required="true" source="entity" />
		<!--Attributes-->
		<WTATTRIBUTE id="0002" name="Install" type="number" source="entity"/>
		<WTATTRIBUTE id="0003" name="BusinessName" type="text" length="30" min="1" max="30" source="entity" required="true" title="true" />
		<WTATTRIBUTE id="0004" name="SystemEmail" type="text" length="80" min="1" max="80" source="entity" required="true" />
		<WTATTRIBUTE id="0005" name="CustomerEmail" type="text" length="80" min="1" max="80" source="entity" required="true" />
		<WTATTRIBUTE id="0006" name="TrainerEmail" type="text" length="80" min="1" max="80" source="entity" required="true" />
		<WTATTRIBUTE id="0007" name="FinanceEmail" type="text" length="80" min="1" max="80" source="entity" required="true" />
		<WTATTRIBUTE id="0008" name="Street" type="text" length="60" min="1" max="60" source="entity" required="true" />
		<WTATTRIBUTE id="0009" name="Unit" type="text" length="40" min="1" max="40" source="entity" />
		<WTATTRIBUTE id="0010" name="City" type="text" length="30" min="1" max="30" source="entity" required="true" />
		<WTATTRIBUTE id="0011" name="State" type="text" length="30" min="1" max="30" source="entity" required="true" />
		<WTATTRIBUTE id="0012" name="Zip" type="text" length="20" min="1" max="20" source="entity" required="true" />
		<WTATTRIBUTE id="0013" name="Country" type="text" length="30" min="1" max="30" source="entity" required="true" />
		<WTATTRIBUTE id="0014" name="Phone" type="text" length="30" min="1" max="30" source="entity" required="true" />
		<WTATTRIBUTE id="0015" name="Fax" type="text" length="30" min="1" max="30" source="entity" required="true" />
		<WTATTRIBUTE id="0016" name="WebSite" type="text" length="255" min="1" max="255" source="entity" />
		<WTATTRIBUTE id="0017" name="TaxRate" type="currency" min="0" max="999999.9999" source="entity">
			<WTFORMAT value="###,##0.0000" />
		</WTATTRIBUTE>
		<WTATTRIBUTE id="0020" name="CardProcessor" type="number" source="entity"/>
		<WTATTRIBUTE id="0021" name="CheckProcessor" type="number" source="entity"/>
		<WTATTRIBUTE id="0022" name="CardAcct" type="text" length="255" min="1" max="255" source="entity" />
		<WTATTRIBUTE id="0023" name="CheckAcct" type="text" length="255" min="1" max="255" source="entity" />
		<WTATTRIBUTE id="0024" name="PayPalAcct" type="text" length="255" min="1" max="255" source="entity" />
		<WTATTRIBUTE id="0025" name="IsNotifyUser" type="yesno" source="entity" />
		<WTATTRIBUTE id="0026" name="PaymentOptions" type="text" length="15" source="entity" language="false"/>
		<WTATTRIBUTE id="0033" name="MiscPay1" type="text" length="30" min="1" max="30" source="entity" />
		<WTATTRIBUTE id="0034" name="MiscPay2" type="text" length="30" min="1" max="30" source="entity" />
		<WTATTRIBUTE id="0035" name="MiscPay3" type="text" length="30" min="1" max="30" source="entity" />
		<WTATTRIBUTE id="0040" name="Languages" type="text" length="1000" min="1" max="1000" source="entity" />
		<WTATTRIBUTE id="0041" name="Options1" type="text" length="60" source="entity" language="false"/>
		<WTATTRIBUTE id="0042" name="Options2" type="text" length="60" source="entity" language="false"/>
		<WTATTRIBUTE id="0043" name="Options3" type="text" length="60" source="entity" language="false"/>
		<WTATTRIBUTE id="0044" name="Options4" type="text" length="60" source="entity" language="false"/>
		<WTATTRIBUTE id="0045" name="Tutorial" type="number" source="entity"/>
		<WTATTRIBUTE id="0046" name="Timezone" type="number" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="0089" name="Rpt" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="0090" name="R1" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0091" name="R2" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0092" name="R3" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0093" name="R4" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0094" name="R5" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0095" name="R6" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0096" name="R7" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0097" name="R8" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0098" name="R9" type="text" length="50" source="entity" persist="false"/>
		<WTATTRIBUTE id="0099" name="R10" type="text" length="50" source="entity" persist="false"/>

		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="MEMBER-BILL-NONE" value="1"/>
			<WTSYSCON name="MEMBER-BILL-MEMBER" value="3"/>
			<WTSYSCON name="TYPE-APPT" value="1" />
			<WTSYSCON name="TYPE-GOAL" value="-70" />
			<WTSYSCON name="TYPE-PROJECT" value="-75" />
			<WTSYSCON name="TYPE-TASK" value="-74" />
			<WTSYSCON name="TYPE-LEAD" value="-22" />
			<WTSYSCON name="TYPE-SALES" value="-81" />
			<WTSYSCON name="TYPE-EVENTS" value="-96" />
			<WTSYSCON name="TYPE-SERVICE" value="-701" />

      <WTSYSCON name="ENROLL-REFER" value="0" />
      <WTSYSCON name="ENROLL-AGREE" value="1" />
			<WTSYSCON name="ENROLL-CONTACT" value="2" />
			<WTSYSCON name="ENROLL-MEMBERSHIP" value="3" />
			<WTSYSCON name="ENROLL-PAYMENT" value="4" />
			<WTSYSCON name="ENROLL-CONFIRM" value="5" />
			<WTSYSCON name="ENROLL-PROCESS" value="6" />
		</WTSYSCONS>

	</WTENTITY>

	
	<!--Procedures-->
	<WTPROCEDURES>
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl" />
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" />
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="Reports" style="GenerateDataProc.xsl" template="new" passthru="true" novalidate="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(Rpt)" direction="input"/>
			<WTPARAM name="ATTR(R1)" direction="input"/>
			<WTPARAM name="ATTR(R2)" direction="input"/>
			<WTPARAM name="ATTR(R3)" direction="input"/>
			<WTPARAM name="ATTR(R4)" direction="input"/>
			<WTPARAM name="ATTR(R5)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Business.BusinessID)"/>
					<WTATTRIBUTE value="ATTR(Business.R1)"/>
					<WTATTRIBUTE value="ATTR(Business.R2)"/>
					<WTATTRIBUTE value="ATTR(Business.R3)"/>
					<WTATTRIBUTE value="ATTR(Business.R4)"/>
					<WTATTRIBUTE value="ATTR(Business.R5)"/>
					<WTATTRIBUTE value="ATTR(Business.R6)"/>
					<WTATTRIBUTE value="ATTR(Business.R7)"/>
					<WTATTRIBUTE value="ATTR(Business.R8)"/>
					<WTATTRIBUTE value="ATTR(Business.R9)"/>
					<WTATTRIBUTE value="ATTR(Business.R10)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--=============================================================================================-->
		<WTWEBPAGE name="Reports" caption="Custom Reports" error="true" body="true" stylesheet="StyleSheet.css" 
			page-top="10" page-left="10" calendar="true" languageurl="LanguageURL" navbar="false" footer="false"
			commonlabels="false" aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl">
			<!--=============================================================================================-->
			<WTPARAM name="C"  datatype="number" />  <!-- CompanyID -->
			<WTPARAM name="M"  datatype="number" />  <!-- MemberID -->
			<WTPARAM name="D" datatype="text" />     <!-- Optional report definition URL -->
			<WTPARAM name="MR" datatype="number" />  <!-- Member Reference -->
			<WTPARAM name="Rpt" datatype="number" /> <!-- selected report # -->
			<WTPARAM name="P1" datatype="text" />    <!-- 1st parameter -->
			<WTPARAM name="P2" datatype="text" />    <!-- 2nd parameter --> 
			<WTPARAM name="P3" datatype="text" />    <!-- 3rd parameter -->
			<WTPARAM name="P4" datatype="text" />    <!-- 4th parameter -->
			<WTPARAM name="P5" datatype="text" />    <!-- 5th parameter -->
			<WTPARAM name="UserName" datatype="text" />   
			<WTPARAM name="RptType" datatype="text" />   
			<WTPARAM name="NewRpt" datatype="number" /> <!-- Newly selected report flag -->
			<WTPARAM name="Mode" datatype="number" /> <!-- Report Process step -->
			<WTPARAM name="Secure" datatype="number" /> 
			<WTPARAM name="ChartSource" datatype="text"/>
			<WTPARAM name="Count" datatype="number"/>
			<WTPARAM name="Test" datatype="number"/>
			<WTPARAM name="Date" datatype="text"/>
			<WTPARAM name="File" datatype="text"/>

			<!-- Mode: 0  ... select report    -->
			<!-- Mode: 1  ... enter parameters -->
			<!-- Mode: 2+ ... get report data  -->

			<WTINCLUDE name="ChartURL.asp"/>

			<WTDATATXN name="Reports"/>
			<WTDATATXN name="Report"/>
			
			<WTCODEGROUP>
<WTCUSTOM>
reqUserName = GetCache("USERNAME")
reqSysUserGroup = Numeric(GetCache("USERGROUP"))
reqSysUserID = Numeric(GetCache("USERID"))
reqSysCompanyID = Numeric(GetCache("COMPANYID"))
reqSysMemberID = Numeric(GetCache("MEMBERID"))
reqSecure = Numeric(GetCache("SECURITYLEVEL"))
reqSysUserOptions = GetCache("USEROPTIONS")
reqDate = CStr(Date()) + " " + CStr(Time())

If reqC = 0 Then reqC = reqSysCompanyID
If reqM = 0 Then reqM = reqSysMemberID
If reqC = 0 AND reqM = 0 Then reqRptType = "system"
</WTCUSTOM>
			</WTCODEGROUP>			

			<WTSUB name="GetMemberReference">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(M)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MR)" value="ATTR(Reference)"/>
				</WTOBJECT>
			</WTSUB>
			
			<WTACTION id="0" name="New" type="New">
				<!-- Set the report type -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(RptType)" value="CONST(&quot;company&quot;)">
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(RptType)" value="CONST(&quot;member&quot;)">
						<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				
				<!-- Check for authorized user for the requested report type -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST(&quot;system&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NotEmployee"/>
						<WTSETATTRIBUTE name="PARAM(RptType)" value="CONST(&quot;&quot;)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST(&quot;company&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NotEmployee"/>
						<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
						<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(RptType)" value="CONST(&quot;&quot;)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST(&quot;member&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NotMember"/>
						<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
						<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
						<WTSETATTRIBUTE name="PARAM(RptType)" value="CONST(&quot;&quot;)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<!-- If unauthorized user or report type, stop -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST(&quot;&quot;)"/>
<WTCUSTOM>
					response.write "Unauthorized Access"
					response.end
</WTCUSTOM>
				</WTCODEGROUP>
<WTCUSTOM>
		'The very first time the mode is (0) waiting for the user to select a report 
		'When the user selects a new report, set the mode to (1) to get the report parameters 
		'If the user already selected a report, and the mode is (2+) get the report data
		If reqNewRpt = 1 Then reqMode = 1
		
		LanguageURL = ""
		SourceURL = ""

		'Get Reports Definition XML file
		If Len(reqD) &gt; 0 Then
			tmpReports = reqD
			If reqTest = 1 Then response.write "&lt;BR&gt;Report Definition: " + tmpReports
		Else	
			If reqC = 0 Then
				tmpReports = "Reports.xml"
			Else
				tmpReports = "sections/company/" + CSTR(reqC) + "/Reports.xml"
			End If
			If reqTest = 1 Then response.write "&lt;BR&gt;Report Definition: " + server.MapPath(tmpReports)

			'Check if report definition file exists
			Set oFileSys = CreateObject("Scripting.FileSystemObject")
			Exists = oFileSys.FileExists( server.MapPath(tmpReports) )
			If Not Exists Then
				Response.Write "&lt;BR&gt;Report Definition File Missing! (" + server.MapPath(tmpReports) + ")"
				Response.End
			End If
			Set oFileSys = Nothing
		End If
		
		'Load Reports Definition XML file
		Set oReports = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
		If InStr(LCASE(tmpReports), "http:" ) = 0 Then
			oReports.load server.MapPath(tmpReports)
		Else		
			oReports.setProperty "ServerHTTPRequest", True
			oReports.async = False
			oReports.load tmpReports
		End If	
		If oReports.parseError &lt;&gt; 0 Then
			Response.Write "Error Loading Reports Definition (" + tmpReports + ") (" + CStr(oReports.parseError) + ")"
			Response.End
		End If

		If reqTest = 1 Then response.write "&lt;BR&gt;Report Type: " + reqRptType

		'delete all reports that the user can't access
		For Each oItem In oReports.selectNodes("/REPORTS/REPORT")
			tmpDeleted = false
			With oItem
				'check if the user can access this type of report (member, company, or system)
				tmptype = .getAttribute("type")
				If reqRptType &lt;&gt; tmpType Then
					oItem.parentNode.removeChild(oItem) 
					tmpDeleted = true
				End If
				'check additional access limits for admins and members (non-employees)
				If reqSysUserGroup &gt; 23 Then
					If tmpDeleted = false Then
						'check if the user can access this security level of report
						tmpSecure = .getAttribute("secure")
						If IsNumeric(tmpSecure) Then
							If CLng(tmpSecure) &gt; reqSecure Then
								oItem.parentNode.removeChild(oItem)
								tmpDeleted = true
							End If	 
						End If	 
					End If	 
					If tmpDeleted = false Then
						'check if the user can access this report option
						tmpOption = .getAttribute("option")
						If Len(tmpOption) &gt; 0 Then
							If InStr(reqSysUserOptions,tmpOption) = 0 Then
								oItem.parentNode.removeChild(oItem) 
								tmpDeleted = true
							End If
						End If
					End If
				End If
			End With
		Next

		'Get URLs for Source and Language
		With oReports.documentElement
			tmpPath = .getAttribute("path")
			tmpLanguage = .getAttribute("language")
			tmpSource = .getAttribute("source")
		End With 

		'Create complete URL path
		If Right(tmpPath,1) &lt;&gt; "/" Then tmpPath = tmpPath + "/"

		'Append language to language URL if not present
		If InStr(LCASE(tmpLanguage), "[") = 0 And InStr(LCASE(tmpLanguage), ".") &gt; 0 Then
			tmpLanguage = Replace(tmpLanguage, ".", "[" + reqSysLanguage + "]." )
		End If 
		'Create complete URL for Language
		LanguageURL = tmpLanguage
		If InStr(LCASE(tmpLanguage), "http:") = 0 Then LanguageURL = tmpPath + tmpLanguage

		If reqTest = 1 Then response.write "&lt;BR&gt;Language: " + LanguageURL

		SourceURL = tmpSource
		If InStr(LCASE(tmpSource), "http:") = 0 Then SourceURL = tmpPath + tmpSource

		If reqTest = 1 Then response.write "&lt;BR&gt;Reports Source: " + SourceURL

		'if a report is selected (mode 1), get the parameters.  if no user parameters set mode to 2
		'if a report is selected and parameters are entered (mode 2+), get the report data
		If reqMode &gt; 0 Then
			'Get selected report element
			Set oReport = oReports.selectSingleNode("/REPORTS/REPORT[@id=" + CSTR(reqRpt) + "]" )
			If Not (oReport Is Nothing) Then
			
				'look for a path and source for the selected report
				rptPath = oReport.getAttribute("path")
				rptSource = oReport.getAttribute("source")
				If Len(rptPath) &gt; 0 Then tmpPath = rptPath
				If Len(rptSource) &gt; 0 Then tmpSource = rptSource
				
				'Create complete URL for Source
				If Right(tmpPath,1) &lt;&gt; "/" Then tmpPath = tmpPath + "/"
				SourceURL = tmpSource
				If InStr(LCASE(tmpSource), "http:") = 0 Then SourceURL = tmpPath + tmpSource

				If reqTest = 1 Then response.write "&lt;BR&gt;Report Source: " + SourceURL

				'Initialize Source URL with report number
				SourceURL = SourceURL + "?r=" + CSTR(reqRpt)
				x = 1
				parms = 0 
				'Walk report parameters to build SourceURL and initialize params
				For Each oItem In oReport.selectNodes("PARAM")
					'Get the user provided value for up to 5 parameters
					Select Case x
						Case 1: val = reqP1
						Case 2: val = reqP2
						Case 3: val = reqP3
						Case 4: val = reqP4
						Case 5: val = reqP5
						Case Else: val = ""
					End Select
					
					'Initialize parameters
					nam = oItem.getAttribute("name")
					typ = oItem.getAttribute("type")
					'Initialize system parameters
					If LCASE(typ) = "system" Then	
						Select Case LCASE(nam)
							Case "companyid": val = CSTR(reqC)
							Case "memberid": val = CSTR(reqM)
							Case "authuserid": val = CSTR(reqSysUserID)
							Case "const": val = ""
							Case "memberref"
								If reqMR = 0 Then GetMemberReference()
								val = CSTR(reqMR)
						End Select	
					Else
						'count user provided (non-system) parameters
						parms = parms + 1	
					End If
					'Initilize parameters if empty and if "init" is provided
					If Len(val) = 0 Then
						init = oItem.getAttribute("init")
						If Len(init) &gt; 0 Then
							If typ = "date" And LEFT(init, 3) = "now" Then
								val = CSTR(Date())
								init = MID(init, 4)
								'increment / decrement date if provided in init (now+7)
								If IsNumeric( init ) Then
									val = DATEADD("d", init, val)
								End If
							Else
								val = init	
							End If
						End If
					End If
					'reassign the initialized value back to the parameter
					Select Case x
						Case 1: reqP1 = val
						Case 2: reqP2 = val
						Case 3: reqP3 = val
						Case 4: reqP4 = val
						Case 5: reqP5 = val
					End Select
					SourceURL = SourceURL + "&amp;" + CSTR(x) + "=" + val
					x = x + 1
					
					'if we getting report data (mode 2+), validate the parameters
					If reqMode &gt;= 2 Then
						req = oItem.getAttribute("required")
						If req &gt; 0 Then
							If Len(val) = 0 Then
								reqMode = 1  'reset mode to get parameters
								DoError -2147220490, "", "Oops, entry is required for {" + nam + "}"
							End If
						End If
					End If
				Next
				'If there are no user provided parameters, get report data (mode 2)
				If parms = 0 Then reqMode = 2
			End If

			If reqMode &gt;= 2 Then
				If reqTest = 1 Then response.write "&lt;BR&gt;Data Source: " + SourceURL
				
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", SourceURL
					oHTTP.send
					xmlReport = oHTTP.responseXML.xml
				End If
				Set oHTTP = Nothing
				
				'Check for an error from the Data Source
				If InStr(xmlReport, "&lt;ERROR&gt;") &gt; 0 Then
					'strip error tags for output
					xmlReport = Replace (xmlReport, "&lt;ERROR&gt;", "")
					xmlReport = Replace (xmlReport, "&lt;/ERROR&gt;", "")
					Response.Write xmlReport
					Response.End
				End If
				
	            'check for a file
		        tmpFile = oReport.getAttribute("file")
				
				'check for a chart
				tmpChart = oReport.getAttribute("chart")
			
				'check for a chart
				tmpChart = oReport.getAttribute("chart")
				
				'Get data count and report totals					
				Set oData = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
				oData.loadXML xmlReport

				'get total rows in data
				Set oRows = oData.selectNodes("/REPORT/DATA") 
				reqCount = oRows.length
				
				'calculate each report total
				For Each oItem In oReport.selectNodes("TOTAL")
				typ = oItem.getAttribute("type")
				Select Case LCASE(typ)
					Case "count"
						oItem.setAttribute("value") = reqCount
					Case "sum", "avg"
						total = 0
						If Len(tmpChart) &gt; 0 Then
							total = 0
							For Each oRow In oRows
							val = oRow.text
							If IsNumeric(val) Then total = total + CLng(val)
							Next
							oItem.setAttribute("value") = total
						Else
							fld = oItem.getAttribute("name")
							total = 0.0
							For Each oRow In oRows
								val = oRow.getAttribute(fld)
								If IsNumeric(val) Then 
								total = total + CCUR(val)
								End If   
							Next
							'calculate average
							If LCASE(typ) = "avg" Then total = (total / reqCount)
	                        
							'format total with decimal precision
							fmt = oItem.getAttribute("format")
							dec = oItem.getAttribute("decimal")
							If IsNull(dec) Then dec = 0
							Select Case fmt
								Case "number"
									oItem.setAttribute("value") = FormatNumber(total,dec)
								Case "currency"
									oItem.setAttribute("value") = FormatCurrency(total,dec)
								Case Else	
									oItem.setAttribute("value") = FormatNumber(total,0)
							End Select      
						End If
				End Select   
				Next

				'format data
				'check how many columns need formatting
				Set oFmts = oReport.selectNodes("COLUMN[@format]") 
				Fmts = oFmts.length
				Set oFmts = Nothing
				'if any columns need formatting
				If Fmts &gt; 0 Then
					'walk through all the rows of data
					For Each oRow In oRows
						'get each formatted column
						For Each oItem In oReport.selectNodes("COLUMN[@format]")
							fld = oItem.getAttribute("name")
							fmt = oItem.getAttribute("format")
							dec = oItem.getAttribute("decimal")
							If IsNull(dec) Then dec = 0
							style = oItem.getAttribute("style")
							If IsNull(style) Then style = 0
							'get the data from the current row for the selected column
							val = oRow.getAttribute(fld)
							'format data
							Select Case fmt
							Case "number"
								oRow.setAttribute(fld) = FormatNumber(val,dec)
							Case "currency"
								oRow.setAttribute(fld) = FormatCurrency(val,dec)
							Case "date"
								oRow.setAttribute(fld) = FormatDateTime(val,style)
							Case "percent"
								oRow.setAttribute(fld) = FormatPercent(val,dec)
							End Select
						Next
					Next
					xmlReport = oData.xml
				End If

				'Save file
				If Len(tmpFile) > 0 And reqCount > 0 Then
					'get full filename
					tmpFilename = "sections/company/" + CSTR(reqC) + "/" + oReport.getAttribute("name") + "." + tmpFile 
					Filename = server.MapPath( tmpFilename )
					reqFile = "http://" + reqSysServerName + reqSysServerPath + tmpFilename

					If reqTest = 1 Then response.write "&lt;BR&gt;Filename: " + Filename

					Set oFileSys = CreateObject("Scripting.FileSystemObject")
					If oFileSys Is Nothing Then
						Response.Write "Scripting.FileSystemObject failed to load"
						Response.End
					End If
					Set oFile = oFileSys.CreateTextFile(Filename, True)
					If oFile Is Nothing Then
						Response.Write "Couldn't create file: " + Filename
						Response.End
					End If

					'create file header
					rec = ""
					For Each oItem In oReport.selectNodes("COLUMN")
						fld = oItem.getAttribute("name")
						rec = rec + """" + fld + """" + ","
					Next
					rec = Left(rec, len(rec)-1)
					oFile.WriteLine( Rec )

					'walk through all the rows of data
					For Each oRow In oRows
						rec = ""
						For Each oItem In oReport.selectNodes("COLUMN")
							fld = oItem.getAttribute("name")
							val = oRow.getAttribute(fld)
							rec = rec + """" + val + """" + ","
						Next
						rec = Left(rec, len(rec)-1)
						oFile.WriteLine( Rec )
					Next
					oFile.Close
					Set oFile = Nothing
					Set oFileSys = Nothing
				End If

				Set oRows = Nothing
				Set oData = Nothing

				'Process chart
				If Len(tmpChart) &gt; 0 Then
					'Initialize chart values
					tmpHeight = 400
					tmpWidth = 750
					tmpLanguage = ""
					tmpTitle = ""
					tmpXTitle = ""
					tmpYTitle = ""

					'check for chart values defined by report
					If NOT IsNull(oReport.getAttribute("height")) Then tmpHeight = oReport.getAttribute("height")
					If NOT IsNull(oReport.getAttribute("width")) Then tmpWidth = oReport.getAttribute("width")
					If NOT IsNull(oReport.getAttribute("translate")) Then tmpLanguage = LanguageURL
					If NOT IsNull(oReport.getAttribute("title")) Then tmpTitle = oReport.getAttribute("title")
					If NOT IsNull(oReport.getAttribute("xtitle")) Then tmpXTitle = oReport.getAttribute("xtitle")
					If NOT IsNull(oReport.getAttribute("ytitle")) Then tmpYTitle = oReport.getAttribute("ytitle")

					'Convert Report Data to data and labels lists
					tmpData = ""
					tmpLabels = ""
					Set oReport = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
					oReport.loadXML xmlReport
					If oReport.parseError &lt;&gt; 0 Then
						Response.Write "Load Report file failed with error code " + CStr(oLanguage.parseError)
						Response.End
					End If
					Set oItems = oReport.selectNodes("REPORT/DATA")
					For Each oItem In oItems
						With oItem
							tmpLabels = tmpLabels + .getAttribute("label") + "|"
							tmpData = tmpData + .Text + "|"
						End With
					Next		
					Set oItems = Nothing
					Set oReport = Nothing

					'Remove last | delimiter
					If tmpData &lt;&gt; "" And Right(tmpData,1) = "|" Then tmpData = Left(tmpData, Len(tmpData)-1 )
					If tmpLabels &lt;&gt; "" And Right(tmpLabels,1) = "|" Then tmpLabels = Left(tmpLabels, Len(tmpLabels)-1 )

					If tmpLanguage &lt;&gt; "" Then ChartLabels tmpLanguage, tmpLabels, "", tmpTitle, tmpXTitle, tmpYTitle
					reqChartSource = "Chart.asp?type=" + tmpChart + "&amp;width=" &amp; tmpWidth &amp; "&amp;height=" &amp; tmpHeight &amp; "&amp;data=" + tmpData + "&amp;labels=" + tmpLabels + "&amp;title=" + tmpTitle + "&amp;xtitle=" + tmpXTitle + "&amp;ytitle=" + tmpYTitle

					'we don't need the report data anymore for this chart
					xmlReport = ""

					If reqTest = 1 Then response.write "&lt;BR&gt;Chart Source: " + reqChartSource
				End If
			End If
		End If
		'save reports definition
		xmlReports = oReports.xml

		'validate reports definition	
		If reqTest = 2 Then
			'-----create a DOM object for the XSL
			xslPage = "ReportsValidate.xsl"
			Set oStyle = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
			oStyle.load server.MapPath(xslPage)
			If oStyle.parseError &lt;&gt; 0 Then
				Response.Write "Reports Load file (oStyle) failed with error code " + CStr(oStyle.parseError)
				Response.End
			End If

			'-----create a DOM object for the Language
			Set oLanguage = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
			oLanguage.setProperty "ServerHTTPRequest", True
			oLanguage.async = False
			oLanguage.load LanguageURL
			If oLanguage.parseError &lt;&gt; 0 Then
				Response.Write "Reports Load file (" + LanguageURL + ") failed with error code " + CStr(oLanguage.parseError)
				Response.End
			End If
			oLanguage.removeChild oLanguage.firstChild
			xmlLanguage = oLanguage.XML
			Set oLanguage = Nothing

			xmlValid = "&lt;VALID&gt;" + xmlReports + xmlLanguage + "&lt;/VALID&gt;"  

			'-----create a DOM object for the XML
			Set oData = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
			oData.loadXML xmlValid
			If oData.parseError &lt;&gt; 0 Then
				Response.Write "Reports Load file (oData) failed with error code " + CStr(oData.parseError)
				Response.Write "<BR/>" + xmlValid
				Response.End
			End If

			Response.Write "&lt;BR&gt;Validating Report Definition...&lt;BR&gt;"
			'-----transform the XML with the XSL
			valid = oData.transformNode(oStyle)
			Response.Write Replace( valid, "NEWLINE", "&lt;BR&gt;")
			Response.Write "...End of Validation&lt;BR&gt;"
			
			Set oData = Nothing
			Set oStyle = Nothing
		End If

		'initialize new-report-selected flag to false
		reqNewRpt = 0
		Set oReport = Nothing
		Set oReports = Nothing
</WTCUSTOM>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
			<WTCODEGROUP>
				<WTTABLE>
					<WTCOLUMN width="150" align="center"/>
					<WTCOLUMN width="250" align="center"/>

					<WTFUNCTION name="NewReport()">
						document.getElementById('NewRpt').value = 1;
					</WTFUNCTION>
					<WTFUNCTION name="ViewReport()">
						var val = document.getElementById('Mode').value;
						document.getElementById('Mode').value = Number(val) + 1;
						doSubmit(0,"");
					</WTFUNCTION>
					<WTFUNCTION name="LoadFile(url)">
						var win;
						win = window.open(url);
						win.focus();
					</WTFUNCTION>

					<WTROW>
						<WTHIDDEN value="PARAM(C)"/>
						<WTHIDDEN value="PARAM(M)"/>
						<WTHIDDEN value="PARAM(MR)"/>
						<WTHIDDEN value="PARAM(NewRpt)"/>
						<WTHIDDEN value="PARAM(Mode)"/>
					</WTROW>

					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="2" class="PageHeading">
							<WTSTATIC tag="SystemReports">
			 					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST('system')"/>
							</WTSTATIC>
							<WTSTATIC tag="CompanyReports">
			 					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST('company')"/>
							</WTSTATIC>
							<WTSTATIC tag="MemberReports">
			 					<WTCONDITION expr="PARAM(RptType)" oper="equal" value="CONST('member')"/>
							</WTSTATIC>
							<WTSTATIC value="PARAM(UserName)"/>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" value="PARAM(Date)" bold="true"/>
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2" label="Select" class="ColumnHeader"/>
						<WTSTATIC col="1">
							<WTCODEGROUP>
								<WTCOMBO value="PARAM(Rpt)" translate="true" datapath="/DATA/TXN/REPORTS/REPORT" setselected="true">
									<WTCHANGE>NewReport()</WTCHANGE>
								</WTCOMBO>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTBUTTON col="1" value="CONST(View)" default="true">
							<WTCLICK>ViewReport()</WTCLICK>
						</WTBUTTON>
<!--						
						<WTBUTTON col="1" value="CONST(Close)" btnclass="smbutton">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
-->						
					</WTROW>
					
					<WTCODEGROUP>
	 					<WTCONDITION expr="PARAM(Mode)" oper="greater" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTVARIABLE name="desc" value="&lt;xsl:value-of select=&quot;/DATA/TXN/REPORTS/REPORT[@id=/DATA/PARAM/@rpt]/@desc&quot;/&gt;"/>
						</WTCODEGROUP>
						<WTROW margin-bottom="6">
		 					<WTCONDITION expr="CONST($desc)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC col="1" merge="2" value="CONST(&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name=$desc]&quot;/&gt;)" align="center" class="prompt"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
	 					<WTCONDITION expr="PARAM(Mode)" oper="greater" value="CONST(0)"/>
						<WTCUSTOMREPORT parms="/DATA/TXN/REPORTS/REPORT[@id=/DATA/PARAM/@rpt]/PARAM"/>
					</WTCODEGROUP>
					<WTROW margin-top="6"/>
					<WTROW margin-top="6" margin-bottom="12">
						<WTCONDITION expr="PARAM(File)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="2" value="PARAM(File)" align="center">
							<WTLINK name="LoadFile('&lt;xsl:value-of select=&quot;/DATA/PARAM/@file&quot;/&gt;')" click="true" />
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="24">
						<WTCONDITION expr="PARAM(Mode)" oper="greater" value="CONST(1)"/>
						<WTCONDITION expr="PARAM(Count)" oper="equal" value="CONST(0)" connector="and"/>
						<WTSTATIC col="1" merge="2" label="NoData" align="center" class="PageHeading"/>
					</WTROW>

				</WTTABLE>
				
				<WTCODEGROUP>
	 				<WTCONDITION expr="PARAM(Mode)" oper="greater" value="CONST(1)"/>
 					<WTCONDITION expr="PARAM(Count)" oper="greater" value="CONST(0)" connector="and"/>
					<WTCODEGROUP>
	 					<WTCONDITION expr="PARAM(ChartSource)" oper="equal" value="CONST('')"/>
						<WTCUSTOMREPORT report="/DATA/TXN/REPORTS/REPORT[@id=/DATA/PARAM/@rpt]" data="/DATA/TXN/REPORT/DATA"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
	 					<WTCONDITION expr="PARAM(ChartSource)" oper="not-equal" value="CONST('')"/>
						<WTCUSTOMREPORT report="/DATA/TXN/REPORTS/REPORT[@id=/DATA/PARAM/@rpt]" chart="/DATA/PARAM/@chartsource"/>
					</WTCODEGROUP>
				</WTCODEGROUP>

			</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="MemberHome" caption="Member System" header="false" navbar="false" footer="false" wrapper="wrapper1000"
			page-color="#777777" margin-width="0" navbar-width="0" content-width="1000"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="MemberHome" secured="52" track="0">
			<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="MenuBehindColor" datatype="text"/>
			<WTPARAM name="MenuBehindImage" datatype="text"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="PageImage" datatype="text"/>
      <WTPARAM name="Wallet" datatype="number"/>
			<WTPARAM name="MenuLogo" datatype="text"/>

      <WTPARAM name="HeaderPosition" datatype="number"/>
			<WTPARAM name="HeaderAlign" datatype="number"/>
			<WTPARAM name="MenuAlign" datatype="number"/>
			<WTPARAM name="MenuBackground" datatype="number"/>

			<WTINCLUDE name="Portal.asp"/>
			<WTINCLUDE name="MenuColors.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(CleanXML(reqSysUserName))"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTGETCACHE name="CONST(GroupID)" value="GROUPID" datatype="number"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NotMemberOnly"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="CONST(GroupID)" value="ATTR(GroupID)"/>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTSETATTRIBUTE name="PARAM(MenuLogo)" value="CONST(&quot;MenuLogo.png&quot;)"/>
        </WTCODEGROUP>

        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpPayoutProcessors)" value="ATTR(PayoutProcessors)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(tmpPayoutProcessors,&quot;10&quot;))" oper="greater" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Wallet)" value="CONST(1)"/>
          </WTCODEGROUP>
        </WTOBJECT>

        <WTCODEGROUP>
					<!-- myTrackerPro -->
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
					<WTSETATTRIBUTE name="PARAM(PageImage)" value="CONST(&quot;bg7.jpg&quot;)"/>
				</WTCODEGROUP>

				<WTCALLSUB name="GetPortal reqCompanyID, GroupID, reqHeaderPosition, reqHeaderAlign, reqMenuAlign, reqMenuBackground"/>
				<WTCALLSUB name="GetMenuColors reqCompanyID, GroupID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left" />

				<WTFUNCTION name="ShowTab(tab, shw)">
          var mid = document.getElementById('MemberID').value;
          var cid = document.getElementById('CompanyID').value;
          var frame, url, frm, src, page, target='', style='', compare=0, load=0;

          switch(tab) {
          case 'TabDashboard':
          frame = 'DashboardFrame';
          switch(shw) {
          case 1: url = 'MemberDashboard.asp?memberid=' + mid; load=1; break;
          case 2: url = 'MobileHome.asp?m=' + mid; target='Mobile'; style='top=100,left=100,height=492,width=322,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no'; break;
          } break;
          case 'TabMarketing':
          frame = 'MarketingFrame';
          switch(shw) {
          case 1: url = '8161.asp?memberid=' + mid; break;
          case 2: url = '8101.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 3: url = '8151.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 4: url = '1412.asp?pagetype=1&amp;contentpage=3&amp;popup=-1&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
						case 5: url = '1412.asp?pagetype=2&amp;contentpage=3&amp;popup=-1&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
						case 6: url = '12410.asp?entity=22&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
						case 7: url = '12410.asp?entity=81&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
						case 8: url = '12410.asp?entity=-81&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
            case 9: url = '12911.asp?memberid=' + mid; break;
            case 10: url = '15612.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
          } break;
          case 'TabProductivity':
          frame = 'ProductivityFrame';
          switch(shw) {
          case 1: url = '11711.asp?memberid=' + mid; break;
          case 2: url = '12610.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
						case 3: url = '0445.asp?memberid=' + mid; target='performance'; style='top=100,left=100,height=350,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no'; break;
						case 4: url = '7001.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
						case 5: url = 'Calendar.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
						case 6: url = '2511.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
						case 7: url = '7501.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3&amp;popup=-1'; break;
            case 8: url = '11760.asp?memberid=' + mid; target='ActivityReports'; break;
            case 9: url = '11721.asp?memberid=' + mid; break;
            case 10: url = '11712.asp?memberid=' + mid; break;
            case 99: url = '11702.asp?memberid=' + mid; load=1; break;
          } break;
          case 'TabLeadership':
          frame = 'LeadershipFrame';
          switch(shw) {
          case 1: url = '0410.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
						case 2: url = '1813.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3&amp;popup=-1'; break;
						case 3: url = '0470.asp?memberid=' + mid; target='genealogy'; break;
						case 4: url = '11710.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
					} break;
					case 'TabTraining':
						frame = 'TrainingFrame';
						switch(shw) {
						case 1: url = '1311.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 2: url = '3411.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 3: url = '1212.asp?mode=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 4: url = '9313.asp?pagetype=7&amp;memberid=' + mid + '&amp;companyid=' + cid; break;
					} break;
					case 'TabFinancial':
						frame = 'FinancialFrame';
						switch(shw) {
						case 1: url = '0475.asp?code=2&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
						case 2: url = '0475.asp?code=1&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
						case 3: url = '0475.asp?code=3&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
						case 4: url = '0475.asp?code=4&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
						case 5: url = '0475.asp?code=5&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
						case 6: url = '0475.asp?code=6&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
						case 7: url = 'money.asp?memberid=' + mid;	target='Money'; break;
						case 8: url = '0408.asp?referralid=' + mid; break;
						} break;
					case 'TabResources':
						frame = 'ResourcesFrame';
						switch(shw) {
						case 1: url = '7014.asp?template=1&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
							case 2: url = '7014.asp?template=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
							case 3: url = '11411.asp?companyid=' + cid + '&amp;groupid=' + mid; break;
							case 4: url = '9301.asp?pagetype=4&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=20; break;
							case 5: url = '9301.asp?pagetype=3&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=20; break;
							case 6: url = '9301.asp?pagetype=5&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=20; break;
							case 7: url = '9301.asp?pagetype=1&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=20; break;
							case 8: url = '9301.asp?pagetype=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=20; break;
							case 9: url = '9301.asp?pagetype=6&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=20; break;
							case 10: url = '8017.asp?parenttype=4&amp;parentid=' + mid; break;
							case 11: url = '1811.asp?memberid=' + mid + '&amp;companyid=' + cid; break;
							case 12: url = '0451.asp?groupid=' + mid + '&amp;companyid=' + cid; break;
							case 13: url = '3854.asp?groupid=' + mid + '&amp;companyid=' + cid + '&amp;popup=-1'; break;
							case 14: url = '1411.asp?pagetype=1&amp;groupid=' + mid + '&amp;companyid=' + cid; compare=19; break;
							case 15: url = '1411.asp?pagetype=2&amp;groupid=' + mid + '&amp;companyid=' + cid; compare=19; break;
							case 16: url = '7711.asp?groupid=' + mid + '&amp;companyid=' + cid; break;
							case 17: url = '11811.asp?companyid=' + cid + '&amp;groupid=' + mid; break;
							case 18: url = '12303.asp?memberid=' + mid; break;
							case 19: url = '11910.asp?memberid=' + mid + '&amp;companyid=' + cid; break;
							case 20: url = 'MenuColors.asp?groupid=' + mid; break;
							case 21: url = '12601.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
							case 22: url = '9301.asp?pagetype=7&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=20; break;
							case 23: url = '8821.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
						} break;
					case 'TabAccount':
						frame = 'AccountFrame';
						switch(shw) {
						case 1: url = '0463.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
							case 2: url = '0436.asp?memberid=' + mid + '&amp;noclose=1'; break;
							case 3: url = '0441.asp?memberid=' + mid + '&amp;noclose=1'; break;
							case 4: url = '9211.asp'; break;
							case 5: url = '0103.asp?contentpage=3&amp;popup=-1'; break;
              case 6: url = '0106.asp?contentpage=3&amp;popup=-1'; break;
              case 7: url = '0107.asp'; load=1; break;
          } break;
          case 'TabHelp':
          frame = 'HelpFrame';
          switch(shw) {
          case 1: url = 'Tutorial.asp?contentpage=3';	target='Tutorial'; break;
          case 2: url = '1713.asp?contentpage=3&amp;popup=1&amp;companyid=' + cid; target='Guide'; break;
          case 3: url = '8013.asp?contentpage=3&amp;companyid=' + cid; break;
					case 4: url = '9506.asp?contentpage=3&amp;popup=1&amp;companyid=' + cid; target='Ticket'; break;
          case 5: url = '4511.asp?contentpage=3'; break;
          case 6: url = '4011.asp?contentpage=3'; break;
          } break;
          }
          if( target.length &gt; 0 ) {
						win = window.open(url,target,style);
						win.focus();
					}
					else {
						if( tab == 'TabDashboard')
							document.getElementById('TopMargin').style.display = 'none';
						else
							document.getElementById('TopMargin').style.display = '';

						frm = document.getElementById(frame);
						src = frm.src;
						if( compare == 0 ) { compare = url.indexOf('.') }
						page = url.substring(0,compare);
						if (load == 1 || src.indexOf(page) &lt; 0 ) {frm.src = url} else {ShowFrame(tab)}
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowFrame(tab)">
					document.getElementById('TabDashboard').style.display = 'none';
					document.getElementById('TabMarketing').style.display = 'none';
					document.getElementById('TabProductivity').style.display = 'none';
					document.getElementById('TabLeadership').style.display = 'none';
					document.getElementById('TabTraining').style.display = 'none';
					document.getElementById('TabFinancial').style.display = 'none';
					document.getElementById('TabResources').style.display = 'none';
					document.getElementById('TabHelp').style.display = 'none';
					document.getElementById('TabAccount').style.display = 'none';
					document.getElementById(tab).style.display = '';
				</WTFUNCTION>

				<WTLOAD>
					ShowTab('TabDashboard',1);
				</WTLOAD>

				<WTMENU name="MemberMenu" type="bar" menuwidth="125" height="30" top-color="CONST(MenuTopColor)" top-bgcolor="CONST(MenuTopBGColor)"
						color="CONST(MenuColor)" bgcolor="CONST(MenuBGColor)" shadow-color="CONST(MenuShadowColor)" bdcolor="CONST(MenuBDColor)"
						over-color="CONST(MenuOverColor)" over-bgcolor="CONST(MenuOverBGColor)" divider-color="CONST(MenuDividerColor)" top-bgimg="CONST(MenuTopImage)" bgimg="CONST(MenuImage)">
          <WTITEM label="mDashboard" menuwidth="200" width="75">
						<WTIMAGE name="Home.gif" width="18" height="18"/>
						<WTITEM value="PARAM(Title)">
							<WTIMAGE name="Home.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabDashboard',1))"/>
						</WTITEM>
						<WTITEM label="mMobile">
							<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(7)"/>
							<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(18)" connector="or"/>
							<WTIMAGE name="Mobile.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabDashboard',2))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mProductivity" width="125" menuwidth="140">
						<WTCONDITION expr="IsPersonal"/>
						<WTIMAGE name="Activity.gif" width="18" height="18"/>
						<WTITEM label="mActivities">
							<WTCONDITION expr="IsActivityTracker"/>
							<WTIMAGE name="Activity.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',1))"/>
						</WTITEM>
            <WTITEM label="mLeaderBoard">
              <WTCONDITION expr="IsActivityTracker"/>
              <WTIMAGE name="leaderboard.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabLeadership',4))"/>
            </WTITEM>
            <WTITEM label="mContests">
							<WTCONDITION expr="IsActivityContest"/>
							<WTIMAGE name="Contest.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',2))"/>
						</WTITEM>
            <WTITEM label="mActivityStatistics">
              <WTCONDITION expr="IsActivityTracker"/>
              <WTIMAGE name="Goal.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabProductivity',10))"/>
            </WTITEM>
            <WTITEM label="mActivityGoals">
              <WTCONDITION expr="IsActivityTracker"/>
              <WTIMAGE name="Goal.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabProductivity',9))"/>
            </WTITEM>
            <WTITEM label="mActivityReports">
							<WTCONDITION expr="IsActivityReports"/>
							<WTIMAGE name="Chart.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',8))"/>
						</WTITEM>
						<WTITEM label="mPerformance">
							<WTCONDITION expr="IsPerformance"/>
							<WTIMAGE name="Performance.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',3))"/>
						</WTITEM>
						<WTITEM label="mGoals">
							<WTCONDITION expr="IsGoals"/>
							<WTIMAGE name="Goal.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',4))"/>
						</WTITEM>
						<WTITEM label="mCalendar">
							<WTCONDITION expr="IsCalendar"/>
							<WTIMAGE name="Calendar.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',5))"/>
						</WTITEM>
						<WTITEM label="mParty">
							<WTCONDITION expr="IsPartyPlan"/>
							<WTIMAGE name="Plan.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',6))"/>
						</WTITEM>
						<WTITEM label="mProjects">
							<WTCONDITION expr="IsProjects"/>
							<WTCONDITION expr="IsSecureProjects" connector="or"/>
							<WTIMAGE name="Project.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',7))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mMarketing" width="110">
						<WTCONDITION expr="IsMarketing"/>
						<WTIMAGE name="Prospect.gif" width="18" height="18"/>
						<WTITEM label="mLeads">
							<WTCONDITION expr="IsSuspect"/>
							<WTIMAGE name="Suspect.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',1))"/>
						</WTITEM>
						<WTITEM label="mProspects">
							<WTCONDITION expr="IsSales"/>
							<WTIMAGE name="Prospect.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',2))"/>
						</WTITEM>
						<WTITEM label="mCustomers">
							<WTCONDITION expr="IsService"/>
							<WTIMAGE name="Customer.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',3))"/>
						</WTITEM>
						<WTDIVIDER/>
            <WTITEM label="mLeadAds">
              <WTCONDITION expr="IsLeadAds"/>
              <WTIMAGE name="LeadAd.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabMarketing',10))"/>
            </WTITEM>
            <WTITEM label="mLeadPages">
              <WTCONDITION expr="IsLeadPrograms"/>
              <WTIMAGE name="LeadPage.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabMarketing',4))"/>
            </WTITEM>
            <WTITEM label="mPresentations">
							<WTCONDITION expr="IsPresentations"/>
							<WTIMAGE name="Presentation.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',5))"/>
						</WTITEM>
<!--						
						<WTITEM label="mWebsites">
							<WTCONDITION expr="IsLeadPrograms"/>
							<WTCONDITION expr="IsPresentations" connector="or"/>
							<WTIMAGE name="MemberDomain.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',9))"/>
						</WTITEM>
-->						
						<WTITEM label="mFolders" menuwidth="100">
							<WTCONDITION expr="IsSuspect"/>
							<WTCONDITION expr="IsSales" connector="or"/>
							<WTCONDITION expr="IsService" connector="or"/>
							<WTIMAGE name="GrpDocs.gif" width="18" height="18"/>
							<WTITEM label="mContactFolders">
								<WTCONDITION expr="IsSuspect"/>
								<WTLINK name="JAVA(ShowTab('TabMarketing',6))"/>
							</WTITEM>
							<WTITEM label="mProspectFolders">
								<WTCONDITION expr="IsSales"/>
								<WTLINK name="JAVA(ShowTab('TabMarketing',7))"/>
							</WTITEM>
							<WTITEM label="mCustomerFolders">
								<WTCONDITION expr="IsService"/>
								<WTLINK name="JAVA(ShowTab('TabMarketing',8))"/>
							</WTITEM>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mTraining" menuwidth="150">
						<WTCONDITION expr="IsTraining"/>
						<WTIMAGE name="Class.gif" width="18" height="18"/>
						<WTITEM label="mGroupTraining">
							<WTCONDITION expr="IsGrpTraining"/>
							<WTIMAGE name="TeamTraining.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabTraining',4))"/>
						</WTITEM>
						<WTITEM label="mClasses">
							<WTCONDITION expr="IsClasses"/>
							<WTIMAGE name="Class.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabTraining',1))"/>
						</WTITEM>
						<WTITEM label="mAssessments">
							<WTCONDITION expr="IsAssessments"/>
							<WTIMAGE name="Assessment.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabTraining',2))"/>
						</WTITEM>
						<WTITEM label="mCourses">
							<WTCONDITION expr="IsCatalog"/>
							<WTIMAGE name="Catalog.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabTraining',3))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mLeadership" width="115">
						<WTCONDITION expr="IsMentoring"/>
						<WTCONDITION expr="IsGenealogy" connector="or"/>
						<WTIMAGE name="Mentor.gif" width="18" height="18"/>
						<WTITEM label="mMentoring">
							<WTCONDITION expr="IsMentoring"/>
							<WTIMAGE name="Mentor.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabLeadership',1))"/>
						</WTITEM>
						<WTITEM label="mNewsletters">
							<WTCONDITION expr="IsNewsLetter"/>
							<WTIMAGE name="NewsLetter.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabLeadership',2))"/>
						</WTITEM>
						<WTITEM label="mSalesTeam">
							<WTCONDITION expr="IsGenealogy"/>
							<WTIMAGE name="Genealogy.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabLeadership',3))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mFinancial" menuwidth="150">
						<WTCONDITION expr="IsFinances"/>
						<WTCONDITION expr="IsExpenseManager" connector="or"/>
						<WTIMAGE name="Finance.gif" width="18" height="18"/>
            <WTITEM label="mWallet">
              <WTCONDITION expr="IsPayouts"/>
              <WTCONDITION expr="PARAM(Wallet)" oper="not-equal" value="CONST(0)" connector="and"/>
              <WTIMAGE name="Payout.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabFinancial',4))"/>
            </WTITEM>
            <WTITEM label="mPayouts">
              <WTCONDITION expr="IsPayouts"/>
              <WTCONDITION expr="PARAM(Wallet)" oper="equal" value="CONST(0)" connector="and"/>
              <WTIMAGE name="Payout.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabFinancial',4))"/>
            </WTITEM>
            <WTITEM label="mPayments">
							<WTCONDITION expr="IsPayments"/>
							<WTIMAGE name="Finance.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabFinancial',1))"/>
						</WTITEM>
						<WTITEM label="mCredits">
							<WTCONDITION expr="IsCredit"/>
							<WTIMAGE name="Credit.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabFinancial',6))"/>
						</WTITEM>
						<WTITEM label="mSalesOrders">
							<WTCONDITION expr="IsSalesOrders"/>
							<WTIMAGE name="ShoppingCart.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabFinancial',2))"/>
						</WTITEM>
            <WTITEM label="mBonuses">
              <WTCONDITION expr="IsCommissions"/>
              <WTIMAGE name="Sales.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabFinancial',3))"/>
            </WTITEM>
            <WTITEM label="mSalesSummary">
							<WTCONDITION expr="IsSalesSummary"/>
							<WTIMAGE name="SalesSummary.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabFinancial',5))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsExpenseManager"/>
						</WTDIVIDER>
						<WTITEM label="mExpenses">
							<WTCONDITION expr="IsExpenseManager"/>
							<WTIMAGE name="Calculator.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabFinancial',7))"/>
						</WTITEM>
						<WTITEM label="mReferrals">
							<WTCONDITION expr="IsReferralProgram"/>
							<WTIMAGE name="Genealogy.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabFinancial',8))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mResources" menuwidth="210" width="120">
						<WTCONDITION expr="IsResources"/>
						<WTIMAGE name="Resource.gif" width="18" height="18"/>
						<WTITEM label="mGroupMembers">
							<WTCONDITION expr="IsGrpMembers"/>
							<WTIMAGE name="MyInfo.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',12))"/>
						</WTITEM>
						<WTITEM label="mGroupEmails">
							<WTCONDITION expr="IsGrpMembers"/>
							<WTIMAGE name="Email.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',23))"/>
						</WTITEM>
						<WTITEM label="mGroupContests">
							<WTCONDITION expr="IsContestCreater"/>
							<WTIMAGE name="Contest.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',21))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsSuccessTracks"/>
						</WTDIVIDER>
						<WTITEM label="mSuccessTracks" menuwidth="125">
							<WTCONDITION expr="IsSuccessTracks"/>
							<WTIMAGE name="Goal.gif" width="18" height="18"/>
							<WTITEM label="mMemberTracks">
								<WTLINK name="JAVA(ShowTab('TabResources',1))"/>
							</WTITEM>
							<WTITEM label="mCustomerTracks">
								<WTLINK name="JAVA(ShowTab('TabResources',2))"/>
							</WTITEM>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsEmailTemplates"/>
						</WTDIVIDER>
						<WTITEM label="mDripCampaigns">
							<WTCONDITION expr="IsDripCampaigns"/>
							<WTIMAGE name="Email.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',3))"/>
						</WTITEM>
						<WTITEM label="mEmailTemplates" menuwidth="150">
							<WTCONDITION expr="IsEmailTemplates"/>
							<WTIMAGE name="Email.gif" width="18" height="18"/>
							<WTITEM label="mContactEmails">
								<WTCONDITION expr="IsSuspect"/>
								<WTLINK name="JAVA(ShowTab('TabResources',4))"/>
							</WTITEM>
							<WTITEM label="mProspectEmails">
								<WTCONDITION expr="IsSales"/>
								<WTLINK name="JAVA(ShowTab('TabResources',5))"/>
							</WTITEM>
							<WTITEM label="mCustomerEmails">
								<WTCONDITION expr="IsService"/>
								<WTLINK name="JAVA(ShowTab('TabResources',6))"/>
							</WTITEM>
							<WTDIVIDER/>
							<WTITEM label="mLeadEmails">
								<WTCONDITION expr="IsLeadPrograms"/>
								<WTLINK name="JAVA(ShowTab('TabResources',7))"/>
							</WTITEM>
							<WTITEM label="mPresentationEmails">
								<WTCONDITION expr="IsPresentations"/>
								<WTLINK name="JAVA(ShowTab('TabResources',8))"/>
							</WTITEM>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsInfoPages"/>
						</WTDIVIDER>
						<WTITEM label="mInfoPages">
							<WTCONDITION expr="IsInfoPages"/>
							<WTIMAGE name="Doc.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',9))"/>
						</WTITEM>
						<WTITEM label="mUploadDocs">
							<WTCONDITION expr="IsDocuments"/>
							<WTIMAGE name="Doc.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',10))"/>
						</WTITEM>
						<WTITEM label="mGroupTraining">
							<WTCONDITION expr="IsGrpTraining"/>
							<WTIMAGE name="TeamTraining.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',22))"/>
						</WTITEM>
						<WTITEM label="mNewsletters">
							<WTCONDITION expr="IsPublishNewsletter"/>
							<WTIMAGE name="NewsLetter.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',11))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsGrpOptions"/>
						</WTDIVIDER>
						<WTITEM label="mGroupOptions">
							<WTCONDITION expr="IsGrpOptions"/>
							<WTIMAGE name="GrpOptions.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',13))"/>
						</WTITEM>
						<WTITEM label="mOptions">
							<WTIMAGE name="Setup.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',18))"/>
						</WTITEM>
						<WTITEM label="mMenuColors">
							<WTIMAGE name="Colors.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',20))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsGrpLeadPage"/>
						</WTDIVIDER>
						<WTITEM label="mGroupLeadPages">
							<WTCONDITION expr="IsGrpLeadPage"/>
							<WTIMAGE name="GrpDocs.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',14))"/>
						</WTITEM>
						<WTITEM label="mGroupPresentations">
							<WTCONDITION expr="IsGrpPresentation"/>
							<WTIMAGE name="GrpDocs.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',15))"/>
						</WTITEM>
						<WTITEM label="mGroupSalesCampaigns">
							<WTCONDITION expr="IsGrpSalesCampaign"/>
							<WTIMAGE name="GrpCampaigns.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',16))"/>
						</WTITEM>
						<WTDIVIDER/>
						<WTITEM label="mGroupActivities">
							<WTIMAGE name="SalesSummary.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',17))"/>
						</WTITEM>
						<WTITEM label="mSharedResources">
							<WTIMAGE name="Resource.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabResources',19))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mAccount" menuwidth="150">
						<WTIMAGE name="MyInfo.gif" width="18" height="18"/>
						<WTITEM label="mProfile">
							<WTCONDITION expr="IsInfo"/>
							<WTIMAGE name="MyInfo.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',1))"/>
						</WTITEM>
						<WTITEM label="mBillingMethod">
							<WTCONDITION expr="IsPayments"/>
							<WTIMAGE name="Finance.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',2))"/>
						</WTITEM>
						<WTITEM label="mPayoutMethod">
							<WTCONDITION expr="IsPayouts"/>
							<WTIMAGE name="Payout.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',3))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsShortcuts"/>
						</WTDIVIDER>
						<WTITEM label="mShortcuts">
							<WTCONDITION expr="IsShortcuts"/>
							<WTIMAGE name="Shortcut.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',4))"/>
						</WTITEM>
						<WTDIVIDER/>
						<WTITEM label="mChangeLogon">
							<WTCONDITION expr="CanChangeLogon"/>
							<WTCONDITION expr="IsChangeLogon" connector="and"/>
							<WTIMAGE name="logon.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',5))"/>
						</WTITEM>
            <WTITEM label="mChangePassword">
              <WTIMAGE name="logon.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabAccount',6))"/>
            </WTITEM>
            <WTITEM label="m2FA">
              <WTIMAGE name="logon.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabAccount',7))"/>
            </WTITEM>
          </WTITEM>
					<WTITEM label="mHelp" menuwidth="175">
						<WTIMAGE name="Help.gif" width="18" height="18"/>
						<WTITEM label="mTutorial">
							<WTCONDITION expr="IsPinnacleTutorial"/>
							<WTIMAGE name="Help.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',1))"/>
						</WTITEM>
						<WTITEM label="mFAQ">
							<WTCONDITION expr="IsSupportFAQ"/>
							<WTIMAGE name="Question.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',2))"/>
						</WTITEM>
						<WTITEM label="mDocs">
							<WTCONDITION expr="IsSupportDocs"/>
							<WTIMAGE name="Help.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',3))"/>
						</WTITEM>
						<WTITEM label="mTickets">
							<WTCONDITION expr="IsSupportTicket"/>
							<WTIMAGE name="SupportTicket.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',4))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsSuggestion"/>
							<WTCONDITION expr="IsSurvey" connector="or"/>
						</WTDIVIDER>
						<WTITEM label="mSuggestions">
							<WTCONDITION expr="IsSuggestion"/>
							<WTIMAGE name="suggestion.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',5))"/>
						</WTITEM>
						<WTITEM label="mSurveys">
							<WTCONDITION expr="IsSurvey"/>
							<WTIMAGE name="suggestion.gif" width="18" height="18"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',6))"/>
						</WTITEM>
						<WTDIVIDER/>
						<WTITEM label="mSignout">
							<WTIMAGE name="close.gif" width="18" height="18"/>
							<WTLINK name="0101" nodata="true">
								<WTPARAM name="ActionCode" value="CONST(9)"/>
							</WTLINK>
						</WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW>
          <WTHIDDEN value="PARAM(MemberID)"/>
          <WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(HeaderPosition)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" align="left" valign="top" value="SYS(headerimage)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
							<WTLINK name="ShowTab('TabDashboard',1)" click="true" />
						</WTIMAGE>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(1)"/>
						<WTIMAGE col="1" align="center" valign="top" value="SYS(headerimage)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
							<WTLINK name="ShowTab('TabDashboard',1)" click="true" />
						</WTIMAGE>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(2)"/>
						<WTIMAGE col="1" align="right" valign="top" value="SYS(headerimage)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
							<WTLINK name="ShowTab('TabDashboard',1)" click="true" />
						</WTIMAGE>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MenuBackground)" oper="equal" value="CONST(0)"/>
					<WTROW>
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="PARAM(MenuBehindColor)" />
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(0)"/>
						<WTSTATIC col="1" align="left" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
              <WTCODEGROUP><WTSTARTMENU name="MemberMenu" type="bar"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(1)"/>
						<WTSTATIC col="1" align="center" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
							<WTCODEGROUP><WTSTARTMENU name="MemberMenu" type="bar"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(2)"/>
						<WTSTATIC col="1" align="right" valign="middle" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(MenuLogo)" oper="not-equal" value="CONST('')"/>
                <WTDIVISION style="float:left; margin-left:20px;">
                  <WTIMAGE value="PARAM(MenuLogo)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
                    <WTLINK name="ShowTab('TabDashboard',1)" click="true" />
                  </WTIMAGE>
                </WTDIVISION>
                <WTDIVISION style="float:right">
                  <WTSTARTMENU name="MemberMenu" type="bar"/>
                </WTDIVISION>
              </WTCODEGROUP>
              <WTCODEGROUP>
                <WTCONDITION expr="PARAM(MenuLogo)" oper="equal" value="CONST('')"/>
                <WTSTARTMENU name="MemberMenu" type="bar"/>
              </WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTDIVIDER col="1" align="left" height="1" color="PARAM(MenuBehindColor)" />
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MenuBackground)" oper="not-equal" value="CONST(0)"/>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(0)"/>
						<WTSTATIC col="1" align="left" valign="middle">
							<WTCODEGROUP><WTSTARTMENU name="MemberMenu" type="bar"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(1)"/>
						<WTSTATIC col="1" align="center" valign="middle">
							<WTCODEGROUP><WTSTARTMENU name="MemberMenu" type="bar"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW height="65">
						<WTCONDITION expr="PARAM(MenuAlign)" oper="equal" value="CONST(2)"/>
						<WTSTATIC col="1" align="right" valign="middle">
							<WTCODEGROUP><WTSTARTMENU name="MemberMenu" type="bar"/></WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(HeaderPosition)" oper="equal" value="CONST(1)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" align="left" valign="top" value="SYS(headerimage)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
							<WTLINK name="ShowTab('TabDashboard',1)" click="true" />
						</WTIMAGE>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(1)"/>
						<WTIMAGE col="1" align="center" valign="top" value="SYS(headerimage)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
							<WTLINK name="ShowTab('TabDashboard',1)" click="true" />
						</WTIMAGE>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(HeaderAlign)" oper="equal" value="CONST(2)"/>
						<WTIMAGE col="1" align="right" valign="top" value="SYS(headerimage)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)">
							<WTLINK name="ShowTab('TabDashboard',1)" click="true" />
						</WTIMAGE>
					</WTROW>
				</WTCODEGROUP>

				<WTROW id="TopMargin" height="6"/>

				<!-- ======================================================================= -->
				<WTROW id="TabDashboard">
					<WTFRAME col="1" src="" name="DashboardFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabDashboard')" frmwidth="1000" frmheight="1000" label="NoFrameSupport" border="0"/>
        </WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabMarketing">
					<WTFRAME col="1" src="" name="MarketingFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabMarketing')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabProductivity">
					<WTFRAME col="1" src="" name="ProductivityFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabProductivity')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabLeadership">
					<WTFRAME col="1" src="" name="LeadershipFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabLeadership')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabTraining">
					<WTFRAME col="1" src="" name="TrainingFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabTraining')" frmwidth="1000" frmheight="2500" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabFinancial">
					<WTFRAME col="1" src="" name="FinancialFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabFinancial')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabResources">
					<WTFRAME col="1" src="" name="ResourcesFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabResources')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" src="" name="HelpFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabHelp')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabAccount">
					<WTFRAME col="1" src="" name="AccountFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabAccount')" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

				<WTROW>
					<WTSTATIC col="1" align="right">
						<WTCODEGROUP><WTTRANSLATE/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
    <WTWEBPAGE name="m_MemberHome" caption="Mobile System" page-left="5" page-top="0" navbar="false" header="false" footer="false"
			page-image="bg7.jpg" page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="m_MemberHome" mobile="m_MemberHome.asp" track="0">
			<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Header" datatype="text"/>
      <WTPARAM name="MenuBehindColor" datatype="text"/>
			<WTPARAM name="MenuBehindImage" datatype="text"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="PageImage" datatype="text"/>
      <WTPARAM name="Wallet" datatype="number"/>
			<WTPARAM name="MenuLogo" datatype="text"/>

      <WTPARAM name="HeaderPosition" datatype="number"/>
			<WTPARAM name="HeaderAlign" datatype="number"/>
			<WTPARAM name="MenuAlign" datatype="number"/>
			<WTPARAM name="MenuBackground" datatype="number"/>

      <WTINCLUDE name="CompanyHeader.asp"/>
      <WTINCLUDE name="Portal.asp"/>
			<WTINCLUDE name="MenuColors.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(CleanXML(reqSysUserName))"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
        <WTGETCACHE name="CONST(GroupID)" value="GROUPID" datatype="number"/>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NotMemberOnly"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="CONST(GroupID)" value="ATTR(GroupID)"/>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
        <WTCUSTOM>
          reqHeader = GetHeader( reqCompanyID, 0, "MobileHeader", "" )
          If reqCompanyID = 21 Then reqHeader = "NexxusRewardsMobile.png"
          reqHeader = "company/" + CStr(reqCompanyID) + "/" + reqHeader
        </WTCUSTOM>

        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTSETATTRIBUTE name="PARAM(MenuLogo)" value="CONST(&quot;MenuLogo.png&quot;)"/>
        </WTCODEGROUP>

        <WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
          <WTMETHOD name="FetchCompany">
            <WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
          </WTMETHOD>
          <WTMETHOD name="Load">
            <WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="CONST(tmpPayoutProcessors)" value="ATTR(PayoutProcessors)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(InStr(tmpPayoutProcessors,&quot;10&quot;))" oper="greater" value="CONST(0)"/>
            <WTSETATTRIBUTE name="PARAM(Wallet)" value="CONST(1)"/>
          </WTCODEGROUP>
        </WTOBJECT>

        <WTCODEGROUP>
					<!-- myTrackerPro -->
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
					<WTSETATTRIBUTE name="PARAM(PageImage)" value="CONST(&quot;bg7.jpg&quot;)"/>
				</WTCODEGROUP>

				<WTCALLSUB name="GetPortal reqCompanyID, GroupID, reqHeaderPosition, reqHeaderAlign, reqMenuAlign, reqMenuBackground"/>
				<WTCALLSUB name="GetMenuColors reqCompanyID, GroupID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left" />

				<WTFUNCTION name="ShowTab(tab, shw)">
          var mid = document.getElementById('MemberID').value;
          var cid = document.getElementById('CompanyID').value;
          var frame, url, frm, src, page, target='', style='', compare=0, load=0;

          switch(tab) {
          case 'TabDashboard':
          frame = 'DashboardFrame';
          switch(shw) {
          case 1: url = 'm_MemberDashboard.asp?memberid=' + mid; load=1; break;
          } break;
          case 'TabProductivity':
          frame = 'ProductivityFrame';
          switch(shw) {
          case 1: url = 'm_11702.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
          case 2: url = 'm_11711.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
          case 3: url = 'm_11710.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
          case 4: url = 'm_11712.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
          case 5: url = 'm_12610.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
          case 6: url = 'm_11721.asp?memberid=' + mid; break;
          case 7: url = '11760.asp?mobile=1&amp;memberid=' + mid; target='ActivityReports'; break;
          } break;
          case 'TabMarketing':
          frame = 'MarketingFrame';
          switch(shw) {
          case 1: url = 'm_8162q.asp?memberid=' + mid; load=1; break;
          case 2: url = 'm_8161.asp?memberid=' + mid; break;
          case 3: url = 'm_1412.asp?pagetype=1'; compare=21; break;
          case 4: url = 'm_1412.asp?pagetype=2'; compare=21; break;
          } break;
          case 'TabTraining':
          frame = 'TrainingFrame';
          switch(shw) {
          case 1: url = 'm_1311.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
          case 2: url = 'm_3411.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
          case 3: url = 'm_1212.asp?mode=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
          case 4: url = 'm_9313.asp?pagetype=7&amp;memberid=' + mid + '&amp;companyid=' + cid; break;
          case 5: url = 'm_0410.asp?memberid=' + mid; break;
          } break;
          case 'TabFinancial':
          frame = 'FinancialFrame';
          switch(shw) {
          case 1: url = 'm_1022.asp?memberid=' + mid; break;
          case 2: url = 'm_0408.asp?referralid=' + mid; break;
          case 3: url = 'm_10400.asp?memberid=' + mid; break;
          } break;

          case 'TabAccount':
          frame = 'AccountFrame';
          switch(shw) {
          case 1: url = 'm_0463.asp?memberid=' + mid; break;
          case 2: url = 'm_0436.asp?memberid=' + mid; break;
          case 3: url = 'm_0103.asp?contentpage=3&amp;popup=-1'; break;
          case 4: url = 'm_0106.asp?contentpage=3&amp;popup=-1'; break;
          case 7: url = '0107.asp'; load=1; break;
          } break;
          case 'TabHelp':
          frame = 'HelpFrame';
          switch(shw) {
          case 1: url = 'm_1713.asp?companyid=' + cid; break;
          case 2: url = 'm_8013.asp?companyid=' + cid; break;
          case 3: url = 'm_9506.asp?companyid=' + cid; break;
          case 4: url = 'MemberHome.asp?memberid=' + mid; target='MemberHome'; break;
          } break;
          }
          if( target.length &gt; 0 ) {
          win = window.open(url,target,style);
          win.focus();
          }
          else {
          if( tab == 'Home' ) { ShowFrame(tab) }

          frm = document.getElementById(frame);
          src = frm.src;
          if( compare == 0 ) { compare = url.indexOf('.') }
          page = url.substring(0,compare);
          if (load == 1 || src.indexOf(page) &lt; 0 ) {frm.src = url} else {ShowFrame(tab)}
          }
        </WTFUNCTION>

				<WTFUNCTION name="ShowFrame(tab)">
          document.getElementById('TabDashboard').style.display = 'none';
          document.getElementById('TabProductivity').style.display = 'none';
          document.getElementById('TabMarketing').style.display = 'none';
          document.getElementById('TabTraining').style.display = 'none';
          document.getElementById('TabFinancial').style.display = 'none';
          document.getElementById('TabHelp').style.display = 'none';
          document.getElementById('TabAccount').style.display = 'none';
          document.getElementById(tab).style.display = '';
        </WTFUNCTION>

				<WTLOAD>
					ShowTab('TabDashboard',1);
				</WTLOAD>

        <WTMENU name="MemberMenu" type="bar" menuwidth="125" top-color="CONST(MenuTopColor)" top-bgcolor="CONST(MenuTopBGColor)"
						color="CONST(MenuColor)" bgcolor="CONST(MenuBGColor)" shadow-color="CONST(MenuShadowColor)" bdcolor="CONST(MenuBDColor)"
						over-color="CONST(MenuOverColor)" over-bgcolor="CONST(MenuOverBGColor)" divider-color="CONST(MenuDividerColor)" top-bgimg="CONST(MenuTopImage)" bgimg="CONST(MenuImage)">
          <WTITEM width="40" menuwidth="150">
            <WTIMAGE name="Menu2.png" width="29" height="30"/>
            <WTITEM label="mDashboard" width="125" height="40" menuwidth="100" menuheight="40">
              <WTIMAGE name="Home.gif" width="18" height="18"/>
              <WTLINK name="JAVA(ShowTab('TabDashboard',1))"/>
            </WTITEM>
            <WTITEM label="mProductivity" width="125" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsPersonal"/>
              <WTIMAGE name="Activity.gif" width="18" height="18"/>
              <WTITEM label="mLogActivity">
                <WTCONDITION expr="IsActivityTracker"/>
                <WTIMAGE name="Activity.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabProductivity',1))"/>
              </WTITEM>
              <WTITEM label="mActivities">
                <WTCONDITION expr="IsActivityTracker"/>
                <WTIMAGE name="Activity.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabProductivity',2))"/>
              </WTITEM>
              <WTITEM label="mLeaderBoard">
                <WTCONDITION expr="IsActivityTracker"/>
                <WTIMAGE name="leaderboard.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabProductivity',3))"/>
              </WTITEM>
              <WTITEM label="mActivityStatistics">
                <WTCONDITION expr="IsActivityTracker"/>
                <WTIMAGE name="Goal.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabProductivity',4))"/>
              </WTITEM>
              <WTITEM label="mContests">
                <WTCONDITION expr="IsActivityContest"/>
                <WTIMAGE name="Contest.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabProductivity',5))"/>
              </WTITEM>
              <WTITEM label="mActivityGoals">
                <WTCONDITION expr="IsActivityTracker"/>
                <WTIMAGE name="Goal.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabProductivity',6))"/>
              </WTITEM>
              <WTITEM label="mActivityReports">
                <WTCONDITION expr="IsActivityReports"/>
                <WTIMAGE name="Chart.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabProductivity',7))"/>
              </WTITEM>
            </WTITEM>
            <WTITEM label="mMarketing" width="125" height="40" menuwidth="125" menuheight="40">
              <WTCONDITION expr="IsMarketing"/>
              <WTIMAGE name="Prospect.gif" width="18" height="18"/>
              <WTITEM label="mLeadAdd">
                <WTCONDITION expr="IsSuspect"/>
                <WTIMAGE name="Suspect.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabMarketing',1))"/>
              </WTITEM>
              <WTITEM label="mLeads">
                <WTCONDITION expr="IsSuspect"/>
                <WTIMAGE name="Suspect.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabMarketing',2))"/>
              </WTITEM>
              <WTITEM label="mLeadPages">
                <WTCONDITION expr="IsLeadPrograms"/>
                <WTIMAGE name="LeadPage.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabMarketing',3))"/>
              </WTITEM>
              <WTITEM label="mPresentations">
                <WTCONDITION expr="IsPresentations"/>
                <WTIMAGE name="Presentation.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabMarketing',4))"/>
              </WTITEM>
            </WTITEM>
            <WTITEM label="mTraining" width="125" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsTraining"/>
              <WTIMAGE name="Class.gif" width="18" height="18"/>
              <WTITEM label="mGroupTraining">
                <WTCONDITION expr="IsGrpTraining"/>
                <WTIMAGE name="TeamTraining.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabTraining',4))"/>
              </WTITEM>
              <WTITEM label="mClasses">
                <WTCONDITION expr="IsClasses"/>
                <WTIMAGE name="Class.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabTraining',1))"/>
              </WTITEM>
              <WTITEM label="mAssessments">
                <WTCONDITION expr="IsAssessments"/>
                <WTIMAGE name="Assessment.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabTraining',2))"/>
              </WTITEM>
              <WTITEM label="mCourses">
                <WTCONDITION expr="IsCatalog"/>
                <WTIMAGE name="Catalog.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabTraining',3))"/>
              </WTITEM>
              <WTITEM label="mMentoring">
                <WTCONDITION expr="IsMentoring"/>
                <WTIMAGE name="Mentor.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabTraining',5))"/>
              </WTITEM>
            </WTITEM>
            <WTITEM label="mFinancial" width="125" height="40" menuwidth="150" menuheight="40">
              <WTCONDITION expr="IsFinances"/>
              <WTCONDITION expr="IsExpenseManager" connector="or"/>
              <WTIMAGE name="Finance.gif" width="18" height="18"/>
              <WTITEM label="mPayments">
                <WTCONDITION expr="IsPayments"/>
                <WTIMAGE name="Finance.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabFinancial',1))"/>
              </WTITEM>
              <WTITEM label="mReferrals">
                <WTCONDITION expr="IsReferralProgram"/>
                <WTIMAGE name="Genealogy.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabFinancial',2))"/>
              </WTITEM>
              <WTDIVIDER>
                <WTCONDITION expr="IsExpenseManager"/>
              </WTDIVIDER>
              <WTITEM label="mExpenses">
                <WTCONDITION expr="IsExpenseManager"/>
                <WTIMAGE name="Calculator.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabFinancial',3))"/>
              </WTITEM>
            </WTITEM>
            <WTITEM label="mAccount" width="125" height="40" menuwidth="150" menuheight="40">
              <WTIMAGE name="MyInfo.gif" width="18" height="18"/>
              <WTITEM label="mProfile">
                <WTCONDITION expr="IsInfo"/>
                <WTIMAGE name="MyInfo.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabAccount',1))"/>
              </WTITEM>
              <WTITEM label="mBillingMethod">
                <WTCONDITION expr="IsPayments"/>
                <WTIMAGE name="Finance.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabAccount',2))"/>
              </WTITEM>
              <WTDIVIDER/>
              <WTITEM label="mChangeLogon">
                <WTCONDITION expr="CanChangeLogon"/>
                <WTCONDITION expr="IsChangeLogon" connector="and"/>
                <WTIMAGE name="logon.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabAccount',3))"/>
              </WTITEM>
              <WTITEM label="mChangePassword">
                <WTIMAGE name="logon.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabAccount',4))"/>
              </WTITEM>
            </WTITEM>
            <WTITEM label="mHelp" width="125" height="40" menuwidth="175" menuheight="40">
              <WTIMAGE name="Help.gif" width="18" height="18"/>
              <WTITEM label="mFAQ">
                <WTCONDITION expr="IsSupportFAQ"/>
                <WTIMAGE name="Question.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabHelp',1))"/>
              </WTITEM>
              <WTITEM label="mDocs">
                <WTCONDITION expr="IsSupportDocs"/>
                <WTIMAGE name="Help.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabHelp',2))"/>
              </WTITEM>
              <WTITEM label="mTickets">
                <WTCONDITION expr="IsSupportTicket"/>
                <WTIMAGE name="SupportTicket.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabHelp',3))"/>
              </WTITEM>
              <WTDIVIDER/>
              <WTITEM label="mWebsite">
                <WTIMAGE name="Home.gif" width="18" height="18"/>
                <WTLINK name="JAVA(ShowTab('TabHelp',4))"/>
              </WTITEM>
              <WTITEM label="mSignout">
                <WTIMAGE name="close.gif" width="18" height="18"/>
                <WTLINK name="0101" nodata="true">
                  <WTPARAM name="ActionCode" value="CONST(9)"/>
                </WTLINK>
              </WTITEM>
            </WTITEM>
          </WTITEM>
          <WTITEM value="PARAM(Title)" width="300" align="center"/>
          <WTITEM width="40">
            <WTIMAGE name="Refresh2.png" width="29" height="30"/>
            <WTLINK name="JAVA(doSubmit(0,''))"/>
          </WTITEM>
        </WTMENU>
        
				<WTROW>
          <WTHIDDEN value="PARAM(MemberID)"/>
          <WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

        <WTROW margin-bottom="6">
          <WTIMAGE col="1" align="center" value="PARAM(Header)"/>
        </WTROW>
        <WTROW height="36">
          <WTSTATIC col="1" align="left" valign="top" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
            <WTCODEGROUP>
              <WTSTARTMENU name="MemberMenu" type="bar"/>
            </WTCODEGROUP>
          </WTSTATIC>
        </WTROW>

        <!-- ======================================================================= -->
				<WTROW id="TabDashboard">
					<WTFRAME col="1" src="" name="DashboardFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabDashboard')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->
        <WTROW id="TabProductivity">
          <WTFRAME col="1" src="" name="ProductivityFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabProductivity')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
        </WTROW>
        <!-- ======================================================================= -->
				<WTROW id="TabMarketing">
					<WTFRAME col="1" src="" name="MarketingFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabMarketing')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabTraining">
					<WTFRAME col="1" src="" name="TrainingFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabTraining')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabFinancial">
					<WTFRAME col="1" src="" name="FinancialFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabFinancial')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" src="" name="HelpFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabHelp')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabAccount">
					<WTFRAME col="1" src="" name="AccountFrame" frmclass="FrameNoScroll" onload="ShowFrame('TabAccount')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

        <WTROW>
          <WTSTATIC col="1" align="right">
            <WTCODEGROUP><WTTRANSLATE/></WTCODEGROUP>
          </WTSTATIC>
        </WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="MobileHome" caption="Mobile Home" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="wrapperMobile"
			page-image="bg.jpg" page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="MobileHome" mobile="MobileHome.asp" secured="98" track="0">
			<!--==================================================================-->
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="G" datatype="number"/>
			<WTPARAM name="Header" datatype="text"/>

			<WTPARAM name="MenuTopColor" datatype="text"/>
			<WTPARAM name="MenuTopBGColor" datatype="text"/>
			<WTPARAM name="MenuColor" datatype="text"/>
			<WTPARAM name="MenuBGColor" datatype="text"/>

			<WTINCLUDE name="MenuColors.asp"/>
			<WTDATATXN name="Icons1"/>
			<WTDATATXN name="Icons2"/>
			<WTDATATXN name="Icons3"/>
			<WTDATATXN name="Icons4"/>
			<WTDATATXN name="Icons5"/>
			<WTDATATXN name="Icons6"/>
			<WTDATATXN name="Icons7"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(M)" value="SYS(MemberID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
				<WTSETATTRIBUTE name="PARAM(C)" value="SYS(CompanyID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(G)" value="GROUPID" datatype="number"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCUSTOM>
					reqHeader = GetHeader( reqC, reqG, "MobileHeader", "" )
					If reqG &gt; 0 And reqHeader = "" Then reqHeader = GetHeader( reqC, 0, "MobileHeader", "" )
					reqHeader = "company/" + CStr(reqC) + "/" + reqHeader
				</WTCUSTOM>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(M)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(C)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="GetMenuColors reqC, reqG, MenuBehindColor, reqMenuTopColor, reqMenuTopBGColor, reqMenuColor, reqMenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, MenuBehindImage, MenuTopImage, MenuImage"/>

				<WTCODEGROUP>
					<WTCONDITION expr="IsActivityTracker"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(&quot;&lt;ICONS1&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;LogActivity&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 1)&quot;&quot; image=&quot;&quot;m_ActivitiesAdd.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;Statistics&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 2)&quot;&quot; image=&quot;&quot;m_Activities.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;ViewContests&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 4)&quot;&quot; image=&quot;&quot;m_Contest.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsActivityContest"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;ViewContests&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 7)&quot;&quot; image=&quot;&quot;m_Contest.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(7)"/>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)" connector="and"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;LeaderBoard&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 3)&quot;&quot; image=&quot;&quot;m_LeaderBoard.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;ActivityGoals&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 6)&quot;&quot; image=&quot;&quot;m_Goal.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;ActivityReports&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 5)&quot;&quot; image=&quot;&quot;m_Chart.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsActivityReports"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;ICON name=&quot;&quot;ActivityReports&quot;&quot; action=&quot;&quot;ShowTab('TabProductivity', 7)&quot;&quot; image=&quot;&quot;m_Chart.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(7)"/>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)" connector="and"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons1)" value="CONST(xmlIcons1 + &quot;&lt;/ICONS1&gt;&quot;)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsSuspect"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons2)" value="CONST(&quot;&lt;ICONS2&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons2)" value="CONST(xmlIcons2 + &quot;&lt;ICON name=&quot;&quot;AddContact&quot;&quot; action=&quot;&quot;ShowTab('TabMarketing', 1)&quot;&quot; image=&quot;&quot;m_ContactAdd.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons2)" value="CONST(xmlIcons2 + &quot;&lt;ICON name=&quot;&quot;Contacts&quot;&quot; action=&quot;&quot;ShowTab('TabMarketing', 2)&quot;&quot; image=&quot;&quot;m_Contact.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons2)" value="CONST(xmlIcons2 + &quot;&lt;ICON name=&quot;&quot;LeadPages&quot;&quot; action=&quot;&quot;ShowTab('TabMarketing', 3)&quot;&quot; image=&quot;&quot;m_LeadPage.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsLeadPrograms"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons2)" value="CONST(xmlIcons2 + &quot;&lt;ICON name=&quot;&quot;Presentations&quot;&quot; action=&quot;&quot;ShowTab('TabMarketing', 4)&quot;&quot; image=&quot;&quot;m_Presentation.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsPresentations"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons2)" value="CONST(xmlIcons2 + &quot;&lt;/ICONS2&gt;&quot;)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(xmlIcons3)" value="CONST(&quot;&lt;ICONS3&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons3)" value="CONST(xmlIcons3 + &quot;&lt;ICON name=&quot;&quot;Upgrade&quot;&quot; action=&quot;&quot;ShowTab('TabFinancial', 3)&quot;&quot; image=&quot;&quot;m_Member.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
						<WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(3)" connector="or"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons3)" value="CONST(xmlIcons3 + &quot;&lt;ICON name=&quot;&quot;Payments&quot;&quot; action=&quot;&quot;ShowTab('TabFinancial', 1)&quot;&quot; image=&quot;&quot;m_CreditCard.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsPayments"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons3)" value="CONST(xmlIcons3 + &quot;&lt;ICON name=&quot;&quot;Credits&quot;&quot; action=&quot;&quot;ShowTab('TabFinancial', 4)&quot;&quot; image=&quot;&quot;m_Credit.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsCredit"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons3)" value="CONST(xmlIcons3 + &quot;&lt;ICON name=&quot;&quot;Referrals&quot;&quot; action=&quot;&quot;ShowTab('TabFinancial', 2)&quot;&quot; image=&quot;&quot;m_Referral.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsReferralProgram"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons3)" value="CONST(xmlIcons3 + &quot;&lt;/ICONS3&gt;&quot;)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsFinances"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons4)" value="CONST(&quot;&lt;ICONS4&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons4)" value="CONST(xmlIcons4 + &quot;&lt;ICON name=&quot;&quot;Profile&quot;&quot; action=&quot;&quot;ShowTab('TabAccount', 1)&quot;&quot; image=&quot;&quot;m_Member.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons4)" value="CONST(xmlIcons4 + &quot;&lt;ICON name=&quot;&quot;BillingMethod&quot;&quot; action=&quot;&quot;ShowTab('TabAccount', 2)&quot;&quot; image=&quot;&quot;m_CreditCard.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsPayments"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons4)" value="CONST(xmlIcons4 + &quot;&lt;ICON name=&quot;&quot;ChangePassword&quot;&quot; action=&quot;&quot;ShowTab('TabAccount', 4)&quot;&quot; image=&quot;&quot;m_Logon.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons4)" value="CONST(xmlIcons4 + &quot;&lt;ICON name=&quot;&quot;ChangeLogon&quot;&quot; action=&quot;&quot;ShowTab('TabAccount', 3)&quot;&quot; image=&quot;&quot;m_Logon.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="CanChangeLogon"/>
						<WTCONDITION expr="IsChangeLogon" connector="and"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons4)" value="CONST(xmlIcons4 + &quot;&lt;ICON name=&quot;&quot;Signout&quot;&quot; action=&quot;&quot;ShowTab('TabAccount', 6)&quot;&quot; image=&quot;&quot;m_Close.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons4)" value="CONST(xmlIcons4 + &quot;&lt;/ICONS4&gt;&quot;)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsSupportFAQ"/>
					<WTCONDITION expr="IsSupportDocs" connector="or"/>
					<WTCONDITION expr="IsSupportTicket" connector="or"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons5)" value="CONST(&quot;&lt;ICONS5&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons5)" value="CONST(xmlIcons5 + &quot;&lt;ICON name=&quot;&quot;FAQ&quot;&quot; action=&quot;&quot;ShowTab('TabHelp', 1)&quot;&quot; image=&quot;&quot;m_Question.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsSupportFAQ"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons5)" value="CONST(xmlIcons5 + &quot;&lt;ICON name=&quot;&quot;Docs&quot;&quot; action=&quot;&quot;ShowTab('TabHelp', 2)&quot;&quot; image=&quot;&quot;m_Docs.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsSupportDocs"/>
					</WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(xmlIcons5)" value="CONST(xmlIcons5 + &quot;&lt;ICON name=&quot;&quot;Tickets&quot;&quot; action=&quot;&quot;ShowTab('TabHelp', 3)&quot;&quot; image=&quot;&quot;m_SupportTicket.gif&quot;&quot;/&gt;&quot;)">
            <WTCONDITION expr="IsSupportTicket"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(xmlIcons5)" value="CONST(xmlIcons5 + &quot;&lt;ICON name=&quot;&quot;Website&quot;&quot; action=&quot;&quot;ShowTab('TabHelp', 4)&quot;&quot; image=&quot;&quot;m_Website.gif&quot;&quot;/&gt;&quot;)"/>
          <WTSETATTRIBUTE name="CONST(xmlIcons5)" value="CONST(xmlIcons5 + &quot;&lt;/ICONS5&gt;&quot;)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsTraining"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons6)" value="CONST(&quot;&lt;ICONS6&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons6)" value="CONST(xmlIcons6 + &quot;&lt;ICON name=&quot;&quot;TeamTraining&quot;&quot; action=&quot;&quot;ShowTab('TabTraining', 4)&quot;&quot; image=&quot;&quot;m_TeamTraining.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsGrpTraining"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons6)" value="CONST(xmlIcons6 + &quot;&lt;ICON name=&quot;&quot;Mentoring&quot;&quot; action=&quot;&quot;ShowTab('TabTraining', 5)&quot;&quot; image=&quot;&quot;m_Mentor.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsMentoring"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons6)" value="CONST(xmlIcons6 + &quot;&lt;ICON name=&quot;&quot;Classes&quot;&quot; action=&quot;&quot;ShowTab('TabTraining', 1)&quot;&quot; image=&quot;&quot;m_Class.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsClasses"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(xmlIcons6)" value="CONST(xmlIcons6 + &quot;&lt;ICON name=&quot;&quot;Assessments&quot;&quot; action=&quot;&quot;ShowTab('TabTraining', 2)&quot;&quot; image=&quot;&quot;m_Assessment.gif&quot;&quot;/&gt;&quot;)">
						<WTCONDITION expr="IsAssessments"/>
					</WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(xmlIcons6)" value="CONST(xmlIcons6 + &quot;&lt;ICON name=&quot;&quot;Catalog&quot;&quot; action=&quot;&quot;ShowTab('TabTraining', 3)&quot;&quot; image=&quot;&quot;m_Catalog.gif&quot;&quot;/&gt;&quot;)">
            <WTCONDITION expr="IsCatalog"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="CONST(xmlIcons6)" value="CONST(xmlIcons6 + &quot;&lt;/ICONS6&gt;&quot;)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsExpenseManager"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons7)" value="CONST(&quot;&lt;ICONS7&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons7)" value="CONST(xmlIcons7 + &quot;&lt;ICON name=&quot;&quot;TaxEstimator&quot;&quot; action=&quot;&quot;ShowTab('TabMoney', 1)&quot;&quot; image=&quot;&quot;m_Money.gif&quot;&quot;/&gt;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(xmlIcons7)" value="CONST(xmlIcons7 + &quot;&lt;/ICONS7&gt;&quot;)"/>
				</WTCODEGROUP>

			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<!-- Icon Labels -->
				<WTSTATIC label="LogActivity"/>
				<WTSTATIC label="Statistics"/>
				<WTSTATIC label="ViewContests"/>
				<WTSTATIC label="LeaderBoard"/>
				<WTSTATIC label="ActivityGoals"/>
				<WTSTATIC label="ActivityReports"/>
				<WTSTATIC label="AddContact"/>
				<WTSTATIC label="Contacts"/>
				<WTSTATIC label="LeadPages"/>
				<WTSTATIC label="Presentations"/>
				<WTSTATIC label="Upgrade"/>
				<WTSTATIC label="Payments"/>
				<WTSTATIC label="Referrals"/>
				<WTSTATIC label="Profile"/>
				<WTSTATIC label="Mentoring"/>
				<WTSTATIC label="BillingMethod"/>
				<WTSTATIC label="ChangeLogon"/>
				<WTSTATIC label="ChangePassword"/>
				<WTSTATIC label="Signout"/>
				<WTSTATIC label="FAQ"/>
				<WTSTATIC label="Docs"/>
				<WTSTATIC label="Tickets"/>
				<WTSTATIC label="Classes"/>
				<WTSTATIC label="Assessments"/>
				<WTSTATIC label="Catalog"/>
				<WTSTATIC label="TeamTraining"/>
				<WTSTATIC label="TaxEstimator"/>

				<WTROW>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(C)"/>
				</WTROW>

				<WTFUNCTION name="ShowTab(tab, shw)">
					var mid = document.getElementById('M').value;
					var cid = document.getElementById('C').value;
					var frame, url, frm, src, page, target='', style='', compare=0, load=0;

					switch(tab) {
					case 'TabMarketing':
						frame = 'MarketingFrame';
						switch(shw) {
						case 1: url = 'm_8162q.asp?memberid=' + mid; load=1; break;
						case 2: url = 'm_8161.asp?memberid=' + mid; break;
						case 3: url = 'm_1412.asp?pagetype=1'; compare=21; break;
						case 4: url = 'm_1412.asp?pagetype=2'; compare=21; break;
					} break;
					case 'TabProductivity':
						frame = 'ProductivityFrame';
						switch(shw) {
						case 1: url = 'm_11702.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
						case 2: url = 'm_11712.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
						case 3: url = 'm_11710.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
						case 4: url = 'm_12610.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
						case 5: url = '11760.asp?mobile=1&amp;memberid=' + mid; target='ActivityReports'; break;
						case 6: url = 'm_11721.asp?memberid=' + mid; break;
						case 7: url = 'm_Page.asp?page=m_upgrade0&amp;company=' + cid + '&amp;memberid=' + mid; break;
					} break;
					case 'TabTraining':
						frame = 'TrainingFrame';
						switch(shw) {
						case 1: url = 'm_1311.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 2: url = 'm_3411.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 3: url = 'm_1212.asp?mode=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
						case 4: url = 'm_9313.asp?pagetype=7&amp;memberid=' + mid + '&amp;companyid=' + cid; break;
						case 5: url = 'm_0410.asp?memberid=' + mid; break;
					} break;
					case 'TabMoney':
						frame = 'MoneyFrame';
						switch(shw) {
						case 1: url = 'm_10400.asp?memberid=' + mid; break;
						} break;
					case 'TabFinancial':
						frame = 'FinancialFrame';
						switch(shw) {
						case 1: url = 'm_1022.asp?memberid=' + mid; break;
						case 2: url = 'm_0408.asp?referralid=' + mid; break;
						case 3: url = 'm_12201.asp?memberid=' + mid; break;
						case 4: url = 'MemberHome.asp?memberid=' + mid; target='MemberHome'; break;
						} break;
					case 'TabAccount':
						frame = 'AccountFrame';
						switch(shw) {
						case 1: url = 'm_0463.asp?memberid=' + mid; break;
						case 2: url = 'm_0436.asp?memberid=' + mid; break;
						case 3: url = 'm_0103.asp?contentpage=3&amp;popup=-1'; break;
						case 4: url = 'm_0106.asp?contentpage=3&amp;popup=-1'; break;
						case 6: window.location = 'm_0101.asp?actioncode=9&amp;page=MobileHome.asp'; break;
          } break;
          case 'TabHelp':
            frame = 'HelpFrame';
            switch(shw) {
            case 1: url = 'm_1713.asp?companyid=' + cid; break;
            case 2: url = 'm_8013.asp?companyid=' + cid; break;
            case 3: url = 'm_9506.asp?companyid=' + cid; break;
            case 4: url = 'MemberHome.asp?memberid=' + mid; target='MemberHome'; break;
          } break;
          }
          if( target.length &gt; 0 ) {
						win = window.open(url,target,style);
						win.focus();
					}
					else {
						if( tab == 'Home' ) { ShowFrame(tab) }

						frm = document.getElementById(frame);
						src = frm.src;
						if( compare == 0 ) { compare = url.indexOf('.') }
						page = url.substring(0,compare);
						if (load == 1 || src.indexOf(page) &lt; 0 ) {frm.src = url} else {ShowFrame(tab)}
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowFrame(tab)">
					document.getElementById('Home').style.display = 'none';
					document.getElementById('TabMarketing').style.display = 'none';
					document.getElementById('TabProductivity').style.display = 'none';
					document.getElementById('TabTraining').style.display = 'none';
					document.getElementById('TabMoney').style.display = 'none';
					document.getElementById('TabFinancial').style.display = 'none';
					document.getElementById('TabHelp').style.display = 'none';
					document.getElementById('TabAccount').style.display = 'none';
					document.getElementById(tab).style.display = '';
					var footer;
					if( tab == 'Home' ) {footer='none'} else {footer=''}
					document.getElementById('Footer').style.display = footer;
				</WTFUNCTION>

				<WTFUNCTION name="ShowRow(row)">
					if( document.getElementById(row).style.display == 'none' )
					document.getElementById(row).style.display = '';
					else
					document.getElementById(row).style.display = 'none';
				</WTFUNCTION>

				<WTLOAD>
					ShowTab('Home',1);
				</WTLOAD>

				<WTROW>
					<WTIMAGE col="1" align="center" value="PARAM(Header)"/>
				</WTROW>

				<WTROW id="Home" style="background:#eaeaea; height:440px;">
					<WTTABLE col="1" height="440" valign="top" firstrow="false">
						<WTCOLUMN width="50" align="center"/>
						<WTCOLUMN width="250" align="left"/>

						<WTROW height="6"/>
						<WTCODEGROUP>
							<WTCONDITION expr="_IsActivityTracker"/>
							<WTROW height="30">
								<WTCLICK escape="false">ShowRow('ActivityRow');</WTCLICK>
								<WTSTATIC col="1" backcolor="PARAM(MenuTopBGColor)">
									<WTCODEGROUP><WTIMAGE value="CONST(Activitysm.gif)" imgalign="absmiddle" imgwidth="18" imgheight="18"/></WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" label="Activities" fontsize="3" backcolor="PARAM(MenuTopBGColor)" fontcolor="PARAM(MenuTopColor)"/>
							</WTROW>
							<WTROW height="100" id="ActivityRow">
								<WTTABLE col="1" merge="2" align="left" backcolor="PARAM(MenuBGColor)" firstrow="false">
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="34" align="center"/>
									<WTREPEAT xpath="/DATA/TXN/ICONS1/ICON[position() mod 3 = 1]">
										<WTROW margin-top="3">
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTIMAGE col="1" value="DATA(Image)"><WTLINK name="DATA(Action)" click="true"/></WTIMAGE>
											</WTREPEAT>
										</WTROW>
										<WTROW>
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTSTATIC col="1" valign="top" label="DATA(Name)" fontcolor="PARAM(MenuColor)"><WTLINK name="DATA(Action)" click="true"/></WTSTATIC>
											</WTREPEAT>
										</WTROW>
									</WTREPEAT>
								</WTTABLE>
							</WTROW>
							<WTROW height="6"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="_IsSuspect"/>
							<WTROW height="30">
								<WTCLICK escape="false">ShowRow('ContactRow');</WTCLICK>
								<WTSTATIC col="1" backcolor="PARAM(MenuTopBGColor)">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Contactsm.gif)" imgalign="absmiddle" imgwidth="18" imgheight="18"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" label="Marketing" align="left" fontsize="3" backcolor="PARAM(MenuTopBGColor)" fontcolor="PARAM(MenuTopColor)"/>
							</WTROW>
							<WTROW height="100" id="ContactRow">
								<WTTABLE col="1" merge="2" align="left" backcolor="PARAM(MenuBGColor)" firstrow="false">
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="34" align="center"/>
									<WTREPEAT xpath="/DATA/TXN/ICONS2/ICON[position() mod 3 = 1]">
										<WTROW margin-top="3">
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTIMAGE col="1" value="DATA(Image)"><WTLINK name="DATA(Action)" click="true"/></WTIMAGE>
											</WTREPEAT>
										</WTROW>
										<WTROW>
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTSTATIC col="1" valign="top" label="DATA(Name)" fontcolor="PARAM(MenuColor)"><WTLINK name="DATA(Action)" click="true"/></WTSTATIC>
											</WTREPEAT>
										</WTROW>
									</WTREPEAT>
								</WTTABLE>
							</WTROW>
							<WTROW height="6"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="_IsTraining"/>
							<WTROW height="30">
								<WTCLICK escape="false">ShowRow('TrainingRow');</WTCLICK>
								<WTSTATIC col="1" backcolor="PARAM(MenuTopBGColor)">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Classsm.gif)" imgalign="absmiddle" imgwidth="18" imgheight="18"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" label="Training" align="left" fontsize="3" backcolor="PARAM(MenuTopBGColor)" fontcolor="PARAM(MenuTopColor)"/>
							</WTROW>
							<WTROW height="100" id="TrainingRow">
								<WTTABLE col="1" merge="2" align="left" backcolor="PARAM(MenuBGColor)" firstrow="false">
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="34" align="center"/>
									<WTREPEAT xpath="/DATA/TXN/ICONS6/ICON[position() mod 3 = 1]">
										<WTROW margin-top="3">
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTIMAGE col="1" value="DATA(Image)">
													<WTLINK name="DATA(Action)" click="true"/>
												</WTIMAGE>
											</WTREPEAT>
										</WTROW>
										<WTROW>
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTSTATIC col="1" valign="top" label="DATA(Name)" fontcolor="PARAM(MenuColor)">
													<WTLINK name="DATA(Action)" click="true"/>
												</WTSTATIC>
											</WTREPEAT>
										</WTROW>
									</WTREPEAT>
									<WTROW margin-top="12" margin-bottom="12">
										<WTCONDITION expr="CONST(count(/DATA/TXN/ICONS6/ICON))" oper="equal" value="CONST(0)"/>
										<WTSTATIC col="1" merge="3" label="ComingSoon" class="PageHeading" align="center"/>
									</WTROW>
								</WTTABLE>
							</WTROW>
							<WTROW height="6"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="_IsExpenseManager"/>
							<WTROW height="30">
								<WTCLICK escape="false">ShowRow('MoneyRow');</WTCLICK>
								<WTSTATIC col="1" backcolor="PARAM(MenuTopBGColor)">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Financesm.gif)" imgalign="absmiddle" imgwidth="18" imgheight="18"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" label="WealthBuilder" align="left" fontsize="3" backcolor="PARAM(MenuTopBGColor)" fontcolor="PARAM(MenuTopColor)"/>
							</WTROW>
							<WTROW height="100" id="MoneyRow">
								<WTTABLE col="1" merge="2" align="left" backcolor="PARAM(MenuBGColor)" firstrow="false">
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="34" align="center"/>
									<WTREPEAT xpath="/DATA/TXN/ICONS7/ICON[position() mod 3 = 1]">
										<WTROW margin-top="3">
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTIMAGE col="1" value="DATA(Image)">
													<WTLINK name="DATA(Action)" click="true"/>
												</WTIMAGE>
											</WTREPEAT>
										</WTROW>
										<WTROW>
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTSTATIC col="1" valign="top" label="DATA(Name)" fontcolor="PARAM(MenuColor)">
													<WTLINK name="DATA(Action)" click="true"/>
												</WTSTATIC>
											</WTREPEAT>
										</WTROW>
									</WTREPEAT>
									<WTROW margin-top="12" margin-bottom="12">
										<WTCONDITION expr="CONST(count(/DATA/TXN/ICONS7/ICON))" oper="equal" value="CONST(0)"/>
										<WTSTATIC col="1" merge="3" label="ComingSoon" class="PageHeading" align="center"/>
									</WTROW>
								</WTTABLE>
							</WTROW>
							<WTROW height="6"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="IsMember"/>
							<WTROW height="30">
								<WTCLICK escape="false">ShowRow('AccountRow');</WTCLICK>
								<WTSTATIC col="1" backcolor="PARAM(MenuTopBGColor)">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Membersm.gif)" imgalign="absmiddle" imgwidth="18" imgheight="18"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" label="Account" align="left" fontsize="3" backcolor="PARAM(MenuTopBGColor)" fontcolor="PARAM(MenuTopColor)"/>
							</WTROW>
							<WTROW height="100" id="AccountRow" style="display:none">
								<WTTABLE col="1" merge="2" align="left" backcolor="PARAM(MenuBGColor)" firstrow="false">
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="34" align="center"/>
									<WTREPEAT xpath="/DATA/TXN/ICONS4/ICON[position() mod 3 = 1]">
										<WTROW margin-top="3">
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTIMAGE col="1" value="DATA(Image)"><WTLINK name="DATA(Action)" click="true"/></WTIMAGE>
											</WTREPEAT>
										</WTROW>
										<WTROW>
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTSTATIC col="1" valign="top" label="DATA(Name)" fontcolor="PARAM(MenuColor)"><WTLINK name="DATA(Action)" click="true"/></WTSTATIC>
											</WTREPEAT>
										</WTROW>
									</WTREPEAT>
								</WTTABLE>
							</WTROW>
							<WTROW height="6"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="_IsFinances"/>
							<WTROW height="30">
								<WTCLICK escape="false">ShowRow('FinanceRow');</WTCLICK>
								<WTSTATIC col="1" backcolor="PARAM(MenuTopBGColor)">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Financesm.gif)" imgalign="absmiddle" imgwidth="18" imgheight="18"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" label="Finances" align="left" fontsize="3" backcolor="PARAM(MenuTopBGColor)" fontcolor="PARAM(MenuTopColor)"/>
							</WTROW>
							<WTROW height="100" id="FinanceRow" style="display:none">
								<WTTABLE col="1" merge="2" align="left" backcolor="PARAM(MenuBGColor)" firstrow="false">
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="3" align="center"/>
									<WTCOLUMN width="34" align="center"/>
									<WTREPEAT xpath="/DATA/TXN/ICONS3/ICON[position() mod 3 = 1]">
										<WTROW margin-top="3">
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTIMAGE col="1" value="DATA(Image)">
													<WTLINK name="DATA(Action)" click="true"/>
												</WTIMAGE>
											</WTREPEAT>
										</WTROW>
										<WTROW>
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTSTATIC col="1" valign="top" label="DATA(Name)" fontcolor="PARAM(MenuColor)">
													<WTLINK name="DATA(Action)" click="true"/>
												</WTSTATIC>
											</WTREPEAT>
										</WTROW>
									</WTREPEAT>
								</WTTABLE>
							</WTROW>
							<WTROW height="6"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="_IsSupportFAQ"/>
							<WTCONDITION expr="_IsSupportDocs" connector="or"/>
							<WTCONDITION expr="_IsSupportTicket" connector="or"/>
							<WTROW height="30">
								<WTCLICK escape="false">ShowRow('HelpRow');</WTCLICK>
								<WTSTATIC col="1" backcolor="PARAM(MenuTopBGColor)">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Helpsm.gif)" imgalign="absmiddle" imgwidth="18" imgheight="18"/>
									</WTCODEGROUP>
								</WTSTATIC>
								<WTSTATIC col="2" label="Help" align="left" fontsize="3" backcolor="PARAM(MenuTopBGColor)" fontcolor="PARAM(MenuTopColor)"/>
							</WTROW>
							<WTROW height="100" id="HelpRow" style="display:none">
								<WTTABLE col="1" merge="2" align="left" backcolor="PARAM(MenuBGColor)" firstrow="false">
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="33" align="center"/>
									<WTCOLUMN width="34" align="center"/>
									<WTREPEAT xpath="/DATA/TXN/ICONS5/ICON[position() mod 3 = 1]">
										<WTROW margin-top="3">
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTIMAGE col="1" value="DATA(Image)"><WTLINK name="DATA(Action)" click="true"/></WTIMAGE>
											</WTREPEAT>
										</WTROW>
										<WTROW>
											<WTREPEAT xpath=".|following-sibling::ICON[position() &amp;lt; 3]">
												<WTSTATIC col="1" valign="top" label="DATA(Name)" fontcolor="PARAM(MenuColor)"><WTLINK name="DATA(Action)" click="true"/></WTSTATIC>
											</WTREPEAT>
										</WTROW>
									</WTREPEAT>
								</WTTABLE>
							</WTROW>
							<WTROW height="6"/>
						</WTCODEGROUP>
						
					</WTTABLE>
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW id="TabMarketing">
					<WTFRAME col="1" merge="2" src="" name="MarketingFrame" onload="ShowFrame('TabMarketing')" frmwidth="100" frmheight="700" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabProductivity">
					<WTFRAME col="1" merge="2" src="" name="ProductivityFrame" onload="ShowFrame('TabProductivity')" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabTraining">
					<WTFRAME col="1" merge="2" src="" name="TrainingFrame" onload="ShowFrame('TabTraining')" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<WTROW id="TabMoney">
					<WTFRAME col="1" merge="2" src="" name="MoneyFrame" onload="ShowFrame('TabMoney')" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabFinancial">
					<WTFRAME col="1" merge="2" src="" name="FinancialFrame" onload="ShowFrame('TabFinancial')" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" merge="2" src="" name="HelpFrame" onload="ShowFrame('TabHelp')" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabAccount">
					<WTFRAME col="1" merge="2" src="" name="AccountFrame" onload="ShowFrame('TabAccount')" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

				<WTROW id="Footer" height="42" style="background:#666;">
					<WTBUTTON col="1" value="CONST(Home)" btnclass="bigbutton" align="center" valign="middle">
						<WTCLICK>ShowTab('Home',false);</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" align="center">
						<WTCODEGROUP><WTTRANSLATE/></WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

    <!--============================================================================================-->
    <WTWEBPAGE name="MemberDashboard" caption="Member Dashboard" navbar="false" header="false" footer="false" wrapper="false"
			page-left="0" margin-width="0" navbar-width="0"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="MemberDashboard">
      <!--============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Member2FA" datatype="number"/>

      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(Is2FA(reqSysUserID))"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="NotMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(1)"/>
      </WTCODEGROUP>

      <WTINCLUDE name="MemberOptions.asp"/>

      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(3)" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
          <WTSETATTRIBUTE name="CONST(tmpLogon)" value="ATTR(Logon)"/>
          <WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
          <WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
          </WTMETHOD>
          <!-- Custom Nexxus -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSETATTRIBUTE name="CONST(tmpShopperID)" value="ATTR(SponsorID)"/>
            <WTSETATTRIBUTE name="CONST(tmpRole)" value="ATTR(Role)"/>
            <!-- Get fast start points -->
            <WTSETATTRIBUTE name="CONST(tmpPersonalPoints)" value="CONST(INT(.MasterPrice))"/>
            <WTSETATTRIBUTE name="CONST(tmpTeamPoints)" value="CONST(.MasterMembers)"/>
            <!-- Get Customer's referring affiliate signature -->
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
              <WTMETHOD name="Load">
                <WTPARAM name="MemberID" direction="input" value="CONST(tmpReferralID)"/>
                <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="CONST(tmpSignature)" value="ATTR(Signature)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTOBJECT>

        <WTCALLSUB name="tmpMemberPage = GetMemberOptions(&quot;MP&quot;)"/>

        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpMemberPage)"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;member.htm&quot;)">
            <WTCONDITION expr="ATTR(Filename)" oper="equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqMemberID )
            xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
            xmlHTMLFile = Replace( xmlHTMLFile, "{name}", tmpName )
          </WTCUSTOM>
        </WTOBJECT>

        <!-- Company Customizations -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
            <WTCUSTOM>
              xmlHTMLFile = Replace( xmlHTMLFile, "{signature}", tmpSignature )
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <!-- Get Member Payment Status -->
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(500)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTCUSTOM>
                a = Split(Result, "|")
                tmpStatus = a(0)
                tmpPaymentID = a(1)
                tmpAmount = a(2)
              </WTCUSTOM>
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(8)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text"/>
              </WTMETHOD>
            </WTOBJECT>
            <WTCUSTOM>
              If tmpStatus = 0 Then strDisplay = "none" Else strDisplay = "block"
              If tmpStatus = 1 Then strPayment = "First"
              If tmpStatus = 2 Then strPayment = "Next"
              strAmount = FormatCurrency(tmpAmount)
              xmlHTMLFile = Replace( xmlHTMLFile, "{display}", strDisplay )
              xmlHTMLFile = Replace( xmlHTMLFile, "{amount}", strAmount )
              xmlHTMLFile = Replace( xmlHTMLFile, "{payment}", strPayment )

              If reqMember2FA = 0 Then strDisplay = "block" Else strDisplay = "none"
              xmlHTMLFile = Replace( xmlHTMLFile, "{display2FA}", strDisplay )

              If CLng(tmpShopperID) = 0 Then
                strDisplay = "none"
              Else
                strDisplay = "block"
                xmlHTMLFile = Replace( xmlHTMLFile, "{ShopperID}", tmpShopperID )
              End If
              xmlHTMLFile = Replace( xmlHTMLFile, "{displayShopper}", strDisplay )

              tmpToday = FormatDateTime(reqSysDate,1)
              aSection = Split( Result, "|")
              a1 = Split( aSection(0), ";")
              a2 = Split( aSection(1), ";")
              a3 = Split( aSection(2), ";")
              a4 = Split( aSection(3), ";")
              a5 = Split( aSection(4), ";")
              a6 = Split( aSection(5), ";")
              a7 = Split( aSection(6), ";")
              a8 = Split( aSection(7), ";")
              a9 = Split( aSection(8), ";")
              a10 = Split( aSection(9), ";")
              a11 = Split( aSection(10), ";")
              tmpTeam3 = FormatCurrency(a3(2))
              tmpTeam4 = FormatCurrency(a3(3))
              tmpFinance1 = FormatCurrency(a4(0))
              tmpFinance2 = FormatCurrency(a4(1))
              tmpFinance3 = FormatCurrency(a4(2))
              tmpFinance4 = FormatCurrency(a4(3))
              tmpQualify5 = FormatCurrency(a5(4))
              tmpAdvance2 = a6(1)
              If tmpAdvance2 = "1" Then tmpAdvance2 = "1 Referral" Else tmpAdvance2 = FormatCurrency(tmpAdvance2) + " GV"
              tmpCert1 = FormatCurrency(a10(4))
              tmpCert2 = FormatCurrency(a10(5))
              tmpCert3 = FormatCurrency(a10(6))
              tmpCert4 = FormatCurrency(a10(7))
              tmpCert5 = a10(8)
              tmpMember3 =  a1(2)
              If tmpMember3 &lt;&gt; "" Then tmpMember3 = "Founding Affiliate (" + tmpMember3 + ")&lt;BR&gt;"
              tmpMember4 =  a1(3)
              If tmpMember4 &lt;&gt; "" Then tmpMember4 = "Fast Start Days: &lt;B&gt;" + tmpMember4 + " (pts:" + CSTR(tmpPersonalPoints) + "/" + CSTR(tmpTeamPoints) + ")" + "&lt;/B&gt;&lt;BR&gt;"
              tmpProduct1 =  a2(0)
              If tmpProduct1 = "" Then tmpProduct1 = "Complimentary Course"
              tmpProduct4 =  a2(3)
              If tmpProduct4 &lt;&gt; "" Then tmpProduct4 = "Certified Cryptocurrency&lt;BR&gt;Specialist - CCS (" + tmpProduct4 + ")&lt;BR&gt;"
              Select Case tmpRole
              Case "1": NexxusRewardsRole = "Sales Affiliate"
              Case "2": NexxusRewardsRole = "Supervisor"
              Case "3": NexxusRewardsRole = "Manager"
              Case "4": NexxusRewardsRole = "Director"
              Case "5": NexxusRewardsRole = "Vice President"
              Case else: NexxusRewardsRole = "Not Qualified"
              End Select
              tmpMerchantBonus = FormatCurrency(a11(5))

              xmlHTMLFile = Replace( xmlHTMLFile, "{today}", tmpToday )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member1}", a1(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member2}", a1(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member3}", tmpMember3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member4}", tmpMember4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member5}", NexxusRewardsRole )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product1}", tmpProduct1 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product2}", a2(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product3}", a2(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product4}", tmpProduct4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team1}", a3(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team2}", a3(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team3}", tmpTeam3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team4}", tmpTeam4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance1}", tmpFinance1 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance2}", tmpFinance2 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance3}", tmpFinance3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance4}", tmpFinance4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify1}", a5(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify2}", a5(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify3}", a5(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify4}", a5(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify5}", tmpQualify5 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify6}", a5(5) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance1}", a6(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance2}", tmpAdvance2 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance3}", a6(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance4}", a6(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader1a}", a7(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader1b}", a7(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader2a}", a7(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader2b}", a7(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader3a}", a7(4) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader3b}", a7(5) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader4a}", a7(6) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader4b}", a7(7) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{ticket1}", a8(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{ticket2}", a8(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market1}", a9(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market2}", a9(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market3}", a9(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market4}", a9(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert1}", a10(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert2}", a10(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert3}", a10(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert4}", a10(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert1m}", tmpCert1 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert2m}", tmpCert2 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert3m}", tmpCert3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert4m}", tmpCert4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert5}", tmpCert5 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward1}", a11(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward2}", a11(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward3}", a11(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward4}", a11(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward5}", a11(4) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward6}", tmpMerchantBonus )

              If NexxusRewardsRole &lt;&gt; "Not Qualified" Then strDisplay = "show" Else strDisplay = "none"
              xmlHTMLFile = Replace( xmlHTMLFile, "{DisplayShoppers}", strDisplay )
              xmlHTMLFile = Replace( xmlHTMLFile, "{DisplayMerchants}", strDisplay )

            </WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>

      </WTACTION>

      <!--**********************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="1000" align="center"/>

        <WTROW>
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--=============================================================================================-->
    <WTWEBPAGE name="m_MemberDashboard" caption="Mobile Dashboard" page-left="3" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0%" navbar-width="0%" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
      <!--=============================================================================================-->
      <WTPARAM name="MemberID" datatype="number"/>
      <WTPARAM name="CompanyID" datatype="number"/>
      <WTPARAM name="Member2FA" datatype="number"/>

      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(Is2FA(reqSysUserID))"/>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <WTCONDITION expr="NotMemberOnly"/>
        <WTSETATTRIBUTE name="PARAM(Member2FA)" value="CONST(1)"/>
      </WTCODEGROUP>

      <WTINCLUDE name="MemberOptions.asp"/>

      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
          <WTCUSTOM>AbortUser()</WTCUSTOM>
        </WTCODEGROUP>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="IsMemberOnly"/>
            <WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(3)" connector="and"/>
            <WTCUSTOM>AbortUser()</WTCUSTOM>
          </WTCODEGROUP>
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
          <WTSETATTRIBUTE name="CONST(tmpLevel)" value="ATTR(Level)"/>
          <WTSETATTRIBUTE name="CONST(tmpLogon)" value="ATTR(Logon)"/>
          <WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
          <WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlMember" direction="return" datatype="text"/>
          </WTMETHOD>
          <!-- Custom Nexxus -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <!-- Get fast start points -->
            <WTSETATTRIBUTE name="CONST(tmpPersonalPoints)" value="CONST(INT(.MasterPrice))"/>
            <WTSETATTRIBUTE name="CONST(tmpTeamPoints)" value="CONST(.MasterMembers)"/>
            <!-- Get Customer's referring affiliate signature -->
            <WTCODEGROUP>
              <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
              <WTMETHOD name="Load">
                <WTPARAM name="MemberID" direction="input" value="CONST(tmpReferralID)"/>
                <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
              </WTMETHOD>
              <WTSETATTRIBUTE name="CONST(tmpSignature)" value="ATTR(Signature)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
        </WTOBJECT>

        <WTCALLSUB name="tmpMemberPage = GetMemberOptions(&quot;MP&quot;)"/>

        <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
          <WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
          <WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
          <WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(tmpMemberPage)"/>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;member.htm&quot;)">
            <WTCONDITION expr="ATTR(Filename)" oper="equal" value="CONST(&quot;&quot;)"/>
          </WTSETATTRIBUTE>
          <WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_&quot; + .Filename)"/>
            <WTMETHOD name="Load"/>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
          </WTMETHOD>
          <WTCUSTOM>
            xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqMemberID )
            xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
            xmlHTMLFile = Replace( xmlHTMLFile, "{name}", tmpName )
          </WTCUSTOM>
        </WTOBJECT>

        <!-- Company Customizations -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(0)"/>
            <WTCUSTOM>
              xmlHTMLFile = Replace( xmlHTMLFile, "{signature}", tmpSignature )
            </WTCUSTOM>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(tmpLevel)" oper="equal" value="CONST(1)"/>
            <WTOBJECT name="Nexxus" project="ptsNexxusUser" class="CNexxus">
              <!-- Get Member Payment Status -->
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(500)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text"/>
              </WTMETHOD>
              <WTCUSTOM>
                a = Split(Result, "|")
                tmpStatus = a(0)
                tmpPaymentID = a(1)
                tmpAmount = a(2)
              </WTCUSTOM>
              <WTMETHOD name="Custom">
                <WTPARAM name="Status" direction="input" value="CONST(8)"/>
                <WTPARAM name="czDate" direction="input" value="CONST(0)"/>
                <WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
                <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
                <WTPARAM name="Result" direction="return" datatype="text"/>
              </WTMETHOD>
            </WTOBJECT>
            <WTCUSTOM>
              If tmpStatus = 0 Then strDisplay = "none" Else strDisplay = "block"
              If tmpStatus = 1 Then strPayment = "First"
              If tmpStatus = 2 Then strPayment = "Next"
              strAmount = FormatCurrency(tmpAmount)
              xmlHTMLFile = Replace( xmlHTMLFile, "{display}", strDisplay )
              xmlHTMLFile = Replace( xmlHTMLFile, "{amount}", strAmount )
              xmlHTMLFile = Replace( xmlHTMLFile, "{payment}", strPayment )

              If reqMember2FA = 0 Then strDisplay = "block" Else strDisplay = "none"
              xmlHTMLFile = Replace( xmlHTMLFile, "{display2FA}", strDisplay )

              tmpToday = FormatDateTime(reqSysDate,1)
              aSection = Split( Result, "|")
              a1 = Split( aSection(0), ";")
              a2 = Split( aSection(1), ";")
              a3 = Split( aSection(2), ";")
              a4 = Split( aSection(3), ";")
              a5 = Split( aSection(4), ";")
              a6 = Split( aSection(5), ";")
              a7 = Split( aSection(6), ";")
              a8 = Split( aSection(7), ";")
              a9 = Split( aSection(8), ";")
              a10 = Split( aSection(9), ";")
              a11 = Split( aSection(10), ";")
              tmpTeam3 = FormatCurrency(a3(2))
              tmpTeam4 = FormatCurrency(a3(3))
              tmpFinance1 = FormatCurrency(a4(0))
              tmpFinance2 = FormatCurrency(a4(1))
              tmpFinance3 = FormatCurrency(a4(2))
              tmpFinance4 = FormatCurrency(a4(3))
              tmpQualify5 = FormatCurrency(a5(4))
              tmpAdvance2 = a6(1)
              If tmpAdvance2 = "1" Then tmpAdvance2 = "1 Referral" Else tmpAdvance2 = FormatCurrency(tmpAdvance2) + " GV"
              tmpCert1 = FormatCurrency(a10(4))
              tmpCert2 = FormatCurrency(a10(5))
              tmpCert3 = FormatCurrency(a10(6))
              tmpCert4 = FormatCurrency(a10(7))
              tmpCert5 = a10(8)
              tmpMember3 =  a1(2)
              If tmpMember3 &lt;&gt; "" Then tmpMember3 = "Founding Affiliate (" + tmpMember3 + ")&lt;BR&gt;"
              tmpMember4 =  a1(3)
              If tmpMember4 &lt;&gt; "" Then tmpMember4 = "Fast Start Days: &lt;B&gt;" + tmpMember4 + " (pts:" + CSTR(tmpPersonalPoints) + "/" + CSTR(tmpTeamPoints) + ")" + "&lt;/B&gt;&lt;BR&gt;"
              tmpProduct4 =  a2(3)
              If tmpProduct4 &lt;&gt; "" Then tmpProduct4 = "Certified Cryptocurrency&lt;BR&gt;Specialist - CCS (" + tmpProduct4 + ")&lt;BR&gt;"

              xmlHTMLFile = Replace( xmlHTMLFile, "{today}", tmpToday )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member1}", a1(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member2}", a1(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member3}", tmpMember3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{member4}", tmpMember4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product1}", a2(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product2}", a2(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product3}", a2(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{product4}", tmpProduct4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team1}", a3(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team2}", a3(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team3}", tmpTeam3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{team4}", tmpTeam4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance1}", tmpFinance1 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance2}", tmpFinance2 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance3}", tmpFinance3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{finance4}", tmpFinance4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify1}", a5(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify2}", a5(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify3}", a5(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify4}", a5(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify5}", tmpQualify5 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{qualify6}", a5(5) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance1}", a6(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance2}", tmpAdvance2 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance3}", a6(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{advance4}", a6(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader1a}", a7(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader1b}", a7(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader2a}", a7(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader2b}", a7(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader3a}", a7(4) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader3b}", a7(5) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader4a}", a7(6) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{leader4b}", a7(7) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{ticket1}", a8(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{ticket2}", a8(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market1}", a9(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market2}", a9(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market3}", a9(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{market4}", a9(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert1}", a10(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert2}", a10(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert3}", a10(2) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert4}", a10(3) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert1m}", tmpCert1 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert2m}", tmpCert2 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert3m}", tmpCert3 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert4m}", tmpCert4 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{cert5}", tmpCert5 )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward1}", a11(0) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward2}", a11(1) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reward3}", a11(2) )

              If a11(3) = 1 Then strDisplay = "show" Else strDisplay = "none"
              xmlHTMLFile = Replace( xmlHTMLFile, "{DisplayShoppers}", strDisplay )
              If a11(4) = 1 Then strDisplay = "show" Else strDisplay = "none"
              xmlHTMLFile = Replace( xmlHTMLFile, "{DisplayMerchants}", strDisplay )

            </WTCUSTOM>
          </WTCODEGROUP>
        </WTCODEGROUP>

      </WTACTION>

      <!--*******************************************************************************************-->
      <WTCONTENT>
        <WTCOLUMN width="100" align="center"/>

        <WTROW>
          <WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
        </WTROW>

      </WTCONTENT>
    </WTWEBPAGE>

    <!--==================================================================-->
		<WTWEBPAGE name="Mobile" page-left="0" page-top="0" form="false" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false" langfile="mobile" secured="98">
			<!--==================================================================-->
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="L" datatype="text"/>

			<WTCODEGROUP>
				<!-- Set this page to not timeout -->
<!--				<WTCUSTOM>Session.Timeout = -1</WTCUSTOM>-->

				<WTSETATTRIBUTE name="PARAM(M)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(L)" value="SYS(language)">
					<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(L)" value="CONST(&quot;en&quot;)">
					<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(M)" />
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(C)" value="ATTR(CompanyID)">
						<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpGroupID)" value="ATTR(GroupID)"/>
					<WTSETATTRIBUTE name="CONST(tmpHeader)" value="CONST(&quot;Images/Company/&quot; + CStr(reqC) + &quot;/MobileHeader.png&quot;)">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpHeader)" value="CONST(&quot;Images/Company/&quot; + CStr(reqC) + &quot;/MobileHeader&quot; + CStr(tmpGroupID) + &quot;.png&quot;)">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;MobileTracker.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(L)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
<WTCUSTOM>
				xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqM )
				xmlHTMLFile = Replace( xmlHTMLFile, "{cid}", reqC )
				xmlHTMLFile = Replace( xmlHTMLFile, "{name}", CleanXMLComment(tmpName) )
				xmlHTMLFile = Replace( xmlHTMLFile, "{header}", tmpHeader )
</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
					<WTBUTTON col="1" value="CONST(Reports)"  align="center">
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(6591)"/>
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(6528)" connector="or"/>
						<WTCLICK>var win = window.open('Reports.asp?c=7');win.focus();</WTCLICK>
					</WTBUTTON>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="Mobile1" page-left="0" page-top="0" form="false" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false" langfile="mobile">
			<!--==================================================================-->
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="L" datatype="text"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(M)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(L)" value="SYS(language)">
					<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(L)" value="CONST(&quot;en&quot;)">
					<WTCONDITION expr="PARAM(L)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(M)" />
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(C)" value="ATTR(CompanyID)">
						<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpGroupID)" value="ATTR(GroupID)"/>
					<WTSETATTRIBUTE name="CONST(tmpHeader)" value="CONST(&quot;Images/Company/&quot; + CStr(reqC) + &quot;/MobileHeader.png&quot;)">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpHeader)" value="CONST(&quot;Images/Company/&quot; + CStr(reqC) + &quot;/MobileHeader&quot; + CStr(tmpGroupID) + &quot;.png&quot;)">
						<WTCONDITION expr="CONST(tmpGroupID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Mobile1.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="PARAM(L)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTCUSTOM>
						xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqM )
						xmlHTMLFile = Replace( xmlHTMLFile, "{cid}", reqC )
						xmlHTMLFile = Replace( xmlHTMLFile, "{name}", CleanXMLComment(tmpName) )
						xmlHTMLFile = Replace( xmlHTMLFile, "{header}", tmpHeader )
					</WTCUSTOM>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true"/>
					<WTBUTTON col="1" value="CONST(Reports)"  align="center">
						<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(6591)"/>
						<WTCLICK>var win = window.open('Reports.asp?c=7');win.focus();</WTCLICK>
					</WTBUTTON>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_MemberHome2" page-left="0" page-top="0" page-width="320" page-image="bg_tile.jpg" wrapper="wrapperMobile"
			form="false" navbar="false" header="false" footer="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="m_MemberHome2" mobile="MobileHome.asp" secured="98">
			<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="Header" datatype="text"/>
			<WTPARAM name="MenuBehindColor" datatype="text"/>
			<WTPARAM name="MenuBehindImage" datatype="text"/>

			<WTINCLUDE name="MenuColors.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
					<WTSETATTRIBUTE name="PARAM(Header)" value="CONST(&quot;Images/Company/&quot; + CStr(reqC) + &quot;/MobileHeader.png&quot;)">
						<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Header)" value="CONST(&quot;Images/Company/&quot; + CStr(reqC) + &quot;/MobileHeader&quot; + CStr(reqGroupID) + &quot;.png&quot;)">
						<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTCALLSUB name="GetMenuColors reqCompanyID, reqMemberID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="left" />

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(GroupID)"/>
				</WTROW>
				<WTLOAD>ShowMenu();</WTLOAD>

				<WTFUNCTION name="ShowMenu()">
					var mid = document.getElementById('MemberID').value;
					var cid = document.getElementById('CompanyID').value;
					var gid = document.getElementById('GroupID').value;
					var url = 'm_MemberMenu.asp?m=' + mid + '&amp;c=' + cid + '&amp;g=' + gid;
					document.getElementById('MenuFrame').src = url;

					document.getElementById('TabMenu').style.display = '';
					document.getElementById('TabMarketing').style.display = 'none';
					document.getElementById('TabAccount').style.display = 'none';
					parent.document.getElementById('TabHelp').style.display = 'none';
				</WTFUNCTION>

				<!-- ======================================================================= -->
				<WTROW id="TabMenu">
					<WTFRAME col="1" merge="2" src="" name="MenuFrame" frmwidth="100" frmheight="406" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabMarketing">
					<WTFRAME col="1" merge="2" src="" name="MarketingFrame" frmwidth="100" frmheight="406" label="NoFrameSupport" border="0" backcolor="white"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabAccount">
					<WTFRAME col="1" merge="2" src="" name="AccountFrame" frmwidth="100" frmheight="406" label="NoFrameSupport" border="0" backcolor="white"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" merge="2" src="" name="HelpFrame" frmwidth="100" frmheight="406" label="NoFrameSupport" border="0" backcolor="white"/>
				</WTROW>
				<!-- ======================================================================= -->

				<WTROW margin-top="6" margin-bottom="6">
					<WTBUTTON col="1" value="CONST(Home)"  align="center">
						<WTCLICK>ShowMenu();</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--============================================================================================-->
		<WTWEBPAGE name="m_MemberMenu" navbar="false" header="false" footer="false" wrapper="wrapperMobile"  page-color="&lt;xsl:value-of select=&quot;/DATA/PARAM/@menutopbgcolor&quot;/&gt;"
			page-left="0" page-width="100%" margin-width="0" navbar-width="0" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="m_MemberMenu" mobile="MobileHome.asp" secured="98">
			<!--============================================================================================-->
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="G" datatype="number"/>
			<WTPARAM name="MenuBehindColor" datatype="text"/>
			<WTPARAM name="MenuBehindImage" datatype="text"/>
			<WTPARAM name="MenuTopBGColor" datatype="text"/>

			<WTINCLUDE name="MenuColors.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(M)" value="SYS(memberid)">
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(C)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTCALLSUB name="GetMenuColors reqC, reqM, reqMenuBehindColor, MenuTopColor, reqMenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, reqMenuBehindImage, MenuTopImage, MenuImage"/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="center"/>

				<WTFUNCTION name="ShowTab(tab, shw)">
					var mid = document.getElementById('M').value;
					var cid = document.getElementById('C').value;
					var frame, url, frm, src, page, target='', style='', compare=0, load=0;

					switch(tab) {
					case 'TabMarketing':
					frame = 'MarketingFrame';
					switch(shw) {
					case 1: url = '2201.asp?memberid=' + mid; break;
					case 2: url = '8101.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
					case 3: url = '8151.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
					case 4: url = '1412.asp?pagetype=1&amp;contentpage=3&amp;popup=-1'; compare=19; break;
					case 5: url = '1412.asp?pagetype=2&amp;contentpage=3&amp;popup=-1'; compare=19; break;
					} break;
					case 'TabAccount':
					frame = 'AccountFrame';
					switch(shw) {
					case 1: url = '0463.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
					case 2: url = '0436.asp?memberid=' + mid; break;
					case 3: url = '0441.asp?memberid=' + mid; break;
					case 4: url = '9211.asp'; break;
					case 5: url = '0103.asp?contentpage=3&amp;popup=-1'; break;
					case 6: url = '0106.asp?contentpage=3&amp;popup=-1'; break;
					} break;
					case 'TabHelp':
					frame = 'HelpFrame';
					switch(shw) {
					case 1: url = 'Tutorial.asp?contentpage=3';	target='Tutorial'; break;
					case 2: url = '1713.asp?contentpage=3' + '&amp;companyid=' + cid; break;
					case 3: url = '8013.asp?contentpage=3' + '&amp;companyid=' + cid; break;
					case 4: url = '9506.asp?contentpage=3' + '&amp;companyid=' + cid; break;
					} break;
					}
					if( target.length &gt; 0 ) {
					win = window.open(url,target,style);
					win.focus();
					}
					else {
					parent.document.getElementById('TabMenu').style.display = 'none';
					parent.document.getElementById('TabMarketing').style.display = 'none';
					parent.document.getElementById('TabAccount').style.display = 'none';
					parent.document.getElementById('TabHelp').style.display = 'none';
					parent.document.getElementById(tab).style.display = '';

					frm = parent.document.getElementById(frame);
					src = frm.src;
					if( compare == 0 ) { compare = url.indexOf('.') }
					page = url.substring(0,compare);
					if (load == 1 || src.indexOf(page) &lt; 0 ) {
					frm.src = url
					}
					}
				</WTFUNCTION>

				<WTMENU name="MemberMenu" type="tree" width="200" height="20" css="MenuTree" color="CONST(MenuTopColor)" bgcolor="CONST(reqMenuTopBGColor)" over_color="CONST(MenuOverColor)" over_bgcolor="CONST(MenuOverBGColor)">
					<WTITEM label="mMarketing">
						<WTCONDITION expr="IsMarketing"/>
						<WTIMAGE name="m_Prospect.gif"/>
						<WTITEM label="mLeads">
							<WTCONDITION expr="IsSuspect"/>
							<WTIMAGE name="m_Contact.gif"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',1))"/>
						</WTITEM>
						<WTITEM label="mProspects">
							<WTCONDITION expr="IsSales"/>
							<WTIMAGE name="m_Prospect.gif"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',2))"/>
						</WTITEM>
						<WTITEM label="mCustomers">
							<WTCONDITION expr="IsService"/>
							<WTIMAGE name="m_Customer.gif"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',3))"/>
						</WTITEM>
						<WTDIVIDER/>
						<WTITEM label="mLeadPages">
							<WTCONDITION expr="IsLeadPrograms"/>
							<WTIMAGE name="m_LeadPage.gif"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',4))"/>
						</WTITEM>
						<WTITEM label="mPresentations">
							<WTCONDITION expr="IsPresentations"/>
							<WTIMAGE name="m_Presentation.gif"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',5))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mAccount" menuwidth="150">
						<WTIMAGE name="m_Member.gif"/>
						<WTITEM label="mProfile">
							<WTCONDITION expr="IsInfo"/>
							<WTIMAGE name="m_Member.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',1))"/>
						</WTITEM>
						<WTITEM label="mBillingMethod">
							<WTCONDITION expr="IsPayments"/>
							<WTIMAGE name="m_Finance.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',2))"/>
						</WTITEM>
						<WTDIVIDER/>
						<WTITEM label="mChangeLogon">
							<WTCONDITION expr="CanChangeLogon"/>
							<WTCONDITION expr="IsChangeLogon" connector="and"/>
							<WTIMAGE name="m_Logon.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',5))"/>
						</WTITEM>
						<WTITEM label="mChangePassword">
							<WTIMAGE name="m_Logon.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',6))"/>
						</WTITEM>
						<WTITEM label="mSignout">
							<WTIMAGE name="m_Close.gif"/>
							<WTLINK name="0101" nodata="true">
								<WTPARAM name="ActionCode" value="CONST(9)"/>
							</WTLINK>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mHelp" menuwidth="150">
						<WTIMAGE name="m_Help2.gif"/>
						<WTITEM label="mTutorial">
							<WTCONDITION expr="IsPinnacleTutorial"/>
							<WTIMAGE name="m_Help.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',1))"/>
						</WTITEM>
						<WTITEM label="mFAQ">
							<WTCONDITION expr="IsSupportFAQ"/>
							<WTIMAGE name="m_Help.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',2))"/>
						</WTITEM>
						<WTITEM label="mDocs">
							<WTCONDITION expr="IsSupportDocs"/>
							<WTIMAGE name="m_Help.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',3))"/>
						</WTITEM>
						<WTITEM label="mTickets">
							<WTCONDITION expr="IsSupportTicket"/>
							<WTIMAGE name="m_SupportTicket.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',4))"/>
						</WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(C)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader&lt;xsl:value-of select=&quot;/DATA/PARAM/@g&quot;/&gt;.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW>
					<WTSTATIC col="1" align="left" valign="top" backcolor="PARAM(MenuTopBGColor)" bgimg="PARAM(MenuBehindImage)">
						<WTCODEGROUP>
							<WTSTARTMENU name="MemberMenu" type="tree"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_Login" caption="Marketing System" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="m_Login">
			<!--============================================================================================-->
			<WTPARAM name="C" datatype="number"/>  <!-- CompanyID -->
			<WTPARAM name="G" datatype="number"/>  <!-- GroupID -->
			<WTPARAM name="Lgn" datatype="text"/>
			<WTPARAM name="Pwd" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="Warn" datatype="number"/>

			<WTDATATXN name="HTMLWarn"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					tmpUserAgent = Request.ServerVariables("HTTP_USER_AGENT")
					If InStr(tmpUserAgent, "MSIE 8.0" ) &gt; 0 OR InStr(tmpUserAgent, "MSIE 9.0" ) &gt; 0 Then reqWarn = 1
				</WTCUSTOM>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;BrowserWarning.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLWarn" direction="return" datatype="text"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;HTMLWarn&quot;)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTGETCOOKIE name="PARAM(Lgn)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Pwd)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Lgn)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(C)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_WelcomeVideo.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqC))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="SignIn" type="SignIn">
				<WTSETATTRIBUTE name="CONST(tmpLgn)" value="FORM(Lgn)"/>
				<WTSETATTRIBUTE name="CONST(tmpPwd)" value="FORM(Pwd)"/>
				<WTSETATTRIBUTE name="CONST(tmpRemember)" value="FORM(Remember)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(tmpLgn)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(tmpPwd)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="Lgn" value="CONST(tmpLgn)"/>
						<WTPARAM name="Pwd" value="CONST(tmpPwd)"/>
						<WTPARAM name="Page" value="CONST(&quot;mobile.asp?m={id}&quot;)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader&lt;xsl:value-of select=&quot;/DATA/PARAM/@g&quot;/&gt;.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" class="prompt" bold="true" align="center">
						<WTSTATIC label="JoinNowText" newline="1"/>
						<WTSTATIC label="JoinNowText2"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" tag="Logon" align="center" fontsize="4"/>
				</WTROW>
				<WTROW>
					<WTTEXT col="2" merge="2"  value="PARAM(Lgn)" size="15" align="center" textclass="bigtext"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" tag="Password" align="center" fontsize="4"/>
				</WTROW>
				<WTROW>
					<WTTEXT col="2" merge="2"  value="PARAM(Pwd)" size="15" align="center" textclass="bigtext"/>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" align="center" fontsize="4">
						<WTCODEGROUP>
							<WTCHECK value="PARAM(Remember)" label="Remember"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="18" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(SignIn)" default="true" btnclass="bigbutton" align="center"/>
					<WTBUTTON col="1" merge="2" value="CONST(JoinNow)" btnclass="bigbutton" align="center">
						<WTCLICK>window.open('m_Enroll.asp?companyid=7')</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" align="center" embedhtml="true" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" value="ATTR(HTMLWarn.Data)" embedhtml="true" />
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_Login1" caption="Marketing System" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="m_Login">
			<!--============================================================================================-->
			<WTPARAM name="C" datatype="number"/>
			<!-- CompanyID -->
			<WTPARAM name="G" datatype="number"/>
			<!-- GroupID -->
			<WTPARAM name="Lgn" datatype="text"/>
			<WTPARAM name="Pwd" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="Warn" datatype="number"/>

			<WTDATATXN name="HTMLWarn"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					tmpUserAgent = Request.ServerVariables("HTTP_USER_AGENT")
					If InStr(tmpUserAgent, "MSIE 8.0" ) &gt; 0 OR InStr(tmpUserAgent, "MSIE 9.0" ) &gt; 0 Then reqWarn = 1
				</WTCUSTOM>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;BrowserWarning.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLWarn" direction="return" datatype="text"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;HTMLWarn&quot;)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTGETCOOKIE name="PARAM(Lgn)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Pwd)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Lgn)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(C)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_WelcomeVideo.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqC))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="SignIn" type="SignIn">
				<WTSETATTRIBUTE name="CONST(tmpLgn)" value="FORM(Lgn)"/>
				<WTSETATTRIBUTE name="CONST(tmpPwd)" value="FORM(Pwd)"/>
				<WTSETATTRIBUTE name="CONST(tmpRemember)" value="FORM(Remember)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(tmpLgn)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(tmpPwd)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="Lgn" value="CONST(tmpLgn)"/>
						<WTPARAM name="Pwd" value="CONST(tmpPwd)"/>
						<WTPARAM name="Page" value="CONST(&quot;mobile1.asp?m={id}&quot;)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="80" align="right"/>
				<WTCOLUMN width="220" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader&lt;xsl:value-of select=&quot;/DATA/PARAM/@g&quot;/&gt;.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" class="prompt" bold="true" align="center">
						<WTSTATIC label="JoinNowText" newline="1"/>
						<WTSTATIC label="JoinNowText2"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" tag="Logon"/>
					<WTTEXT col="2"  value="PARAM(Lgn)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Password"/>
					<WTTEXT col="2" value="PARAM(Pwd)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(Remember)" label="Remember"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(SignIn)" default="true" btnclass="lgbutton" align="center"/>
					<WTBUTTON col="1" merge="2" value="CONST(JoinNow)" btnclass="lgbutton" align="center">
						<WTCLICK>window.open('m_Enroll.asp?companyid=7')</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" align="center" embedhtml="true" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" value="ATTR(HTMLWarn.Data)" embedhtml="true" />
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="m_Welcome" caption="Marketing System" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="wrapperMobile"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="m_Welcome">
			<!--============================================================================================-->
			<WTPARAM name="C" datatype="number"/>
			<!-- CompanyID -->
			<WTPARAM name="G" datatype="number"/>
			<!-- GroupID -->
			<WTPARAM name="Lgn" datatype="text"/>
			<WTPARAM name="Pwd" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="V" datatype="text"/>
			<WTPARAM name="Warn" datatype="number"/>

			<WTDATATXN name="HTMLWarn"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					tmpUserAgent = Request.ServerVariables("HTTP_USER_AGENT")
					If InStr(tmpUserAgent, "MSIE 8.0" ) &gt; 0 OR InStr(tmpUserAgent, "MSIE 9.0" ) &gt; 0 Then reqWarn = 1
				</WTCUSTOM>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;BrowserWarning.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLWarn" direction="return" datatype="text"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;HTMLWarn&quot;)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTGETCOOKIE name="PARAM(Lgn)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Pwd)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Lgn)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(C)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_WelcomeVideo.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqC))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="SignIn" type="SignIn">
				<WTSETATTRIBUTE name="CONST(tmpLgn)" value="FORM(Lgn)"/>
				<WTSETATTRIBUTE name="CONST(tmpPwd)" value="FORM(Pwd)"/>
				<WTSETATTRIBUTE name="CONST(tmpRemember)" value="FORM(Remember)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(tmpLgn)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(tmpPwd)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="Lgn" value="CONST(tmpLgn)"/>
						<WTPARAM name="Pwd" value="CONST(tmpPwd)"/>
						<WTPARAM name="Page" value="CONST(&quot;mobile.asp?m={id}&quot;)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" align="center" valign="top" value="CONST(MobileHeader&lt;xsl:value-of select=&quot;/DATA/PARAM/@g&quot;/&gt;.png)" path="CONST(Company\&lt;xsl:value-of select=&quot;/DATA/PARAM/@c&quot;/&gt;)"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="6">
					<WTCONDITION expr="PARAM(V)" oper="not-equal" value="CONST('')"/>
					<WTSTATIC col="1" merge="2" tag="Invalid" value="PARAM(V)" class="PageHeading" align="center" fontcolor="red"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" align="center" embedhtml="true" />
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" class="prompt" bold="true" align="center">
						<WTSTATIC label="JoinNowText" newline="1"/>
						<WTSTATIC label="JoinNowText2" newline="2"/>
						<WTSTATIC label="JoinNowText3"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="12">
					<WTSTATIC col="1" tag="Logon"/>
					<WTTEXT col="2"  value="PARAM(Lgn)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Password"/>
					<WTTEXT col="2" value="PARAM(Pwd)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="PARAM(Remember)" label="Remember"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(SignIn)" default="true" btnclass="lgbutton" align="center"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Warn)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" value="ATTR(HTMLWarn.Data)" embedhtml="true" />
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="Opportunity" worker="true"	aspstyle="GenerateWebASP.xsl">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
		'Check for member logon as subnet
		pos = InStr(reqSysServerName, "." )
		If pos &gt; 0 Then
			tmpMember = left(reqSysServerName, pos-1)
		End If
</WTCUSTOM>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="FetchLogon">
						<WTPARAM name="Logon" direction="input" value="CONST(tmpMember)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="not-equal" value="CONST(0)" />
						<WTCUSTOM>Response.Redirect "pp.asp?p=55&amp;m=" + .MemberID</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
		</WTWEBPAGE>
		
		<!--=============================================================================================-->
		<WTWEBPAGE name="Tutorial" worker="true" aspstyle="GenerateWebASP.xsl">
			<!--=============================================================================================-->
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="Lessons" datatype="text" />
			<WTPARAM name="Lesson" datatype="number"/>

			<WTACTION id="0" name="New" type="New">

				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;,&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;1,&quot;)">
					<WTCONDITION expr="IsSuspect"/>
				</WTSETATTRIBUTE>
<!--
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;2,&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;3,&quot;)">
					<WTCONDITION expr="IsIconBar"/>
				</WTSETATTRIBUTE>
-->				
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;4,&quot;)">
					<WTCONDITION expr="IsShortcuts"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;5,&quot;)">
					<WTCONDITION expr="IsInfo"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;6,&quot;)">
					<WTCONDITION expr="IsSuspect"/>
					<WTCONDITION expr="IsSales" connector="or"/>
					<WTCONDITION expr="IsService" connector="or"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;7,&quot;)">
					<WTCONDITION expr="IsMentoring"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;8,&quot;)">
					<WTCONDITION expr="IsMentor"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;9,&quot;)">
					<WTCONDITION expr="IsGoals"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;10,&quot;)">
					<WTCONDITION expr="IsGoals"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;11,&quot;)">
					<WTCONDITION expr="IsCalendar"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;12,&quot;)">
					<WTCONDITION expr="IsPartyPlan"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;13,&quot;)">
					<WTCONDITION expr="IsClasses"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;14,&quot;)">
					<WTCONDITION expr="IsCatalog"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;15,&quot;)">
					<WTCONDITION expr="IsAssessments"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;16,&quot;)">
					<WTCONDITION expr="IsSuspect"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;17,&quot;)">
					<WTCONDITION expr="IsLeadPrograms"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;18,&quot;)">
					<WTCONDITION expr="IsPresentations"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;19,&quot;)">
					<WTCONDITION expr="IsSales"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;20,&quot;)">
					<WTCONDITION expr="IsSalesReports"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;21,&quot;)">
					<WTCONDITION expr="IsService"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;22,&quot;)">
					<WTCONDITION expr="IsReports"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;23,&quot;)">
					<WTCONDITION expr="IsExpenseManager"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;24,&quot;)">
					<WTCONDITION expr="IsAffiliates"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;25,&quot;)">
					<WTCONDITION expr="IsNewsLetter"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;26,&quot;)">
					<WTCONDITION expr="IsSupportFAQ"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;27,&quot;)">
					<WTCONDITION expr="IsSupportDocs"/>
				</WTSETATTRIBUTE>
<!--				
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;28,&quot;)">
					<WTCONDITION expr="IsConference"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;29,&quot;)">
					<WTCONDITION expr="IsDiscussion"/>
				</WTSETATTRIBUTE>
-->				
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;30,&quot;)">
					<WTCONDITION expr="IsSuggestion"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;31,&quot;)">
					<WTCONDITION expr="IsSurvey"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;32,&quot;)">
					<WTCONDITION expr="IsSupportTicket"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="IsResources"/>
					<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;33,&quot;)">
						<WTCONDITION expr="IsSuccessTracks"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;34,&quot;)">
						<WTCONDITION expr="IsEmailTemplates"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;35,&quot;)">
						<WTCONDITION expr="IsInfoPages"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;36,&quot;)">
						<WTCONDITION expr="IsDocuments"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;37,&quot;)">
					<WTCONDITION expr="IsProjects"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;38,&quot;)">
					<WTCONDITION expr="IsGrpMembers"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;39,&quot;)">
					<WTCONDITION expr="IsGrpOptions"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;40,&quot;)">
					<WTCONDITION expr="IsGrpLeadPage"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;41,&quot;)">
					<WTCONDITION expr="IsGrpPresentation"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;42,&quot;)">
					<WTCONDITION expr="IsGrpSalesCampaign"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Lessons)" value="CONST(reqLessons + &quot;43,&quot;)">
					<WTCONDITION expr="IsPublishNewsletter"/>
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="PARAM(Lesson)" value="CONST(0)">
						<WTCONDITION expr="PARAM(Lesson)" oper="not-equal" value="CONST(0)" />
						<WTCONDITION expr="CONST(InStr(reqLessons,CSTR(reqLesson)))" oper="equal" value="CONST(0)" connector="and"/>
				</WTSETATTRIBUTE>
			
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCourse)" value="ATTR(Tutorial)"/>
				</WTOBJECT>

				<WTRETURN>
					<WTLINK name="1330" return="false">
						<WTPARAM name="CourseID" value="CONST(tmpCourse)" />
						<WTPARAM name="Register" value="CONST(1)" />
						<WTPARAM name="contentpage" value="PARAM(contentpage)" />
						<WTPARAM name="popup" value="PARAM(Popup)" />
						<WTPARAM name="Lessons" value="PARAM(Lessons)" />
						<WTPARAM name="Lesson" value="PARAM(Lesson)" />
					</WTLINK>
				</WTRETURN>

			</WTACTION>
			<!--*******************************************************************************************-->
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="Intro" caption="Pinnacle Performance Institute" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="Intro">
			<!--=============================================================================================-->
			<WTPARAM name="Company" datatype="text" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTINCLUDE name="Company.asp" />
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)" />
					<WTGETCACHE name="CONST(tmpPage)" value="COMPANYHOMEPAGE" />
					<WTRETURN>
						<WTCONDITION expr="CONST(tmpPage)" oper="equal" value="CONST(&quot;HOME&quot;)" />
						<WTLINK name="Home" return="false">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						</WTLINK>
					</WTRETURN>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPage)" oper="not-equal" value="CONST(&quot;&quot;)" />
						<WTCUSTOM>Response.Redirect "Sections/Company/" &amp; reqCompanyID &amp; "/" &amp; tmpPage</WTCUSTOM>
					</WTCODEGROUP>
					<WTRETURN>
						<WTLINK name="Ascend" return="false">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				<WTCUSTOM>
		'Check for ORG logon as subnet
		If reqCompany = "" Then
			pos = InStr(reqSysServerName, "." )
			If pos &gt; 0 Then
				str = left(reqSysServerName, pos-1)
				if str &lt;&gt; "www" and str &lt;&gt; "pinnaclep" and  str &lt;&gt; "com" Then reqCompany = str
			End If
		End If
</WTCUSTOM>
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="&quot;&quot;" />
					<WTMETHOD name="LoadLogon">
						<WTPARAM name="Logon" direction="input" value="PARAM(Company)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
						<WTCALLSUB name="GetCompany(reqCompanyID)" />
						<WTGETCACHE name="CONST(tmpPage)" value="COMPANYHOMEPAGE" />
						<WTRETURN>
							<WTCONDITION expr="CONST(tmpPage)" oper="equal" value="CONST(&quot;HOME&quot;)" />
							<WTLINK name="Home" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
							</WTLINK>
						</WTRETURN>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPage)" oper="not-equal" value="CONST(&quot;&quot;)" />
							<WTCUSTOM>Response.Redirect "Sections/Company/" &amp; reqCompanyID &amp; "/" &amp; tmpPage</WTCUSTOM>
						</WTCODEGROUP>
						<WTRETURN>
							<WTLINK name="Ascend" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="center" />
				<WTROW margin-top="24">
					<WTVIDEO col="1" type="flash" src="CONST(http://www.pinnaclep.com/Sections/company/1/Intoduction 1.swf)" imgwidth="CONST(759)" imgheight="CONST(485)" />
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" label="Enter" class="prompt">
						<WTLINK name="0000" />
					</WTSTATIC>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--=============================================================================================-->
		<WTWEBPAGE name="0000" caption="Pinnacle Performance Institute" navbar="false" 
		header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0000">
			<!--=============================================================================================-->
			<WTPARAM name="Company" datatype="text" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="A" datatype="number" />
			<WTPARAM name="G" datatype="number" />
			<WTPARAM name="C" datatype="number" />
			<WTPARAM name="Lgn" datatype="text"/>
			<WTPARAM name="Pwd" datatype="text"/>
			<WTPARAM name="Remember" datatype="number" />
			<WTINCLUDE name="Company.asp" />
			<WTINCLUDE name="CompanyHeader.asp" />
			<WTINCLUDE name="Redirect.asp" />

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(A)" oper="greater" value="CONST(0)" />
				<WTSETCACHE name="A" value="PARAM(A)" />
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(C)" oper="greater" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="PARAM(CompanyID)"/>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(G)" value="GROUPID" />
			</WTCODEGROUP>

			<WTSUB function="RedirectHomePage(tmpPage)">
<WTCUSTOM>
	'get the language version of the custom home page
	tmpPath =  "Sections/Company/" &amp; reqCompanyID &amp; "/"
	pos = InStr(tmpPage, ".")
	If pos &gt; 0 Then
		t_file = Left(tmpPage, pos - 1)
		t_ext = Mid(tmpPage, pos + 1)
		tmpPage = t_file + "[" + reqSysLanguage + "]." + t_ext
		If reqSysLanguage &lt;&gt; "en" Then
			If Not FileExists(reqSysWebDirectory + tmpPath + tmpPage) Then tmpPage = t_file + "[en]." + t_ext
		End If
	End If
	Response.Redirect tmpPath + tmpPage
</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
		'Check for Custom Domain names
		Redirect()
</WTCUSTOM>
				<WTGETCOOKIE name="PARAM(Lgn)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Pwd)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Lgn)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)" />
					<WTGETCACHE name="CONST(tmpPage)" value="COMPANYHOMEPAGE" />
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPage)" oper="equal" value="CONST(&quot;HOME&quot;)" />
						<WTRETURN>
							<WTLINK name="Home" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
								<WTPARAM name="G" value="PARAM(G)" />
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPage)" oper="not-equal" value="CONST(&quot;&quot;)" />
						<WTCALLSUB name="RedirectHomePage(tmpPage)"/>
					</WTCODEGROUP>
					<WTRETURN>
						<WTLINK name="Ascend" return="false">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
<WTCUSTOM>
		'Check for subnet
		If reqCompany = "" Then
			pos = InStr(reqSysServerName, "." )
			If pos &gt; 0 Then
				str = left(reqSysServerName, pos-1)
				if str &lt;&gt; "www" and str &lt;&gt; "pinnaclep" and  str &lt;&gt; "com" Then reqCompany = str
			End If
		End If
</WTCUSTOM>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(Company)" oper="not-equal" value="&quot;&quot;" />
					<WTMETHOD name="GetSubnet">
						<WTPARAM name="Subnet" direction="input" value="PARAM(Company)" />
						<WTPARAM name="reqCompanyID" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
						<WTCALLSUB name="GetCompany(reqCompanyID)" />
						<WTCALLSUB name="SetCompanyGrpHeader reqCompanyID, reqG, reqSysLanguage">
							<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
						<WTGETCACHE name="CONST(tmpPage)" value="COMPANYHOMEPAGE" />
						<WTRETURN>
							<WTCONDITION expr="CONST(tmpPage)" oper="equal" value="CONST(&quot;HOME&quot;)" />
							<WTLINK name="Home" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
								<WTPARAM name="G" value="PARAM(G)" />
							</WTLINK>
						</WTRETURN>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPage)" oper="not-equal" value="CONST(&quot;&quot;)" />
							<WTCALLSUB name="RedirectHomePage(tmpPage)"/>
						</WTCODEGROUP>
						<WTRETURN>
							<WTLINK name="Ascend" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTOBJECT>

<!-- Company Page is always redirected to Pinnacle home page -->
<WTCUSTOM>
	Response.Redirect "p-home[en].htm"
</WTCUSTOM>

				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0000.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="SignIn" type="SignIn">
				<WTSETATTRIBUTE name="CONST(tmpLgn)" value="FORM(Lgn)"/>
				<WTSETATTRIBUTE name="CONST(tmpPwd)" value="FORM(Pwd)"/>
				<WTSETATTRIBUTE name="CONST(tmpRemember)" value="FORM(Remember)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(tmpLgn)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(tmpPwd)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="Lgn" value="CONST(tmpLgn)"/>
						<WTPARAM name="Pwd" value="CONST(tmpPwd)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="170" />
				<WTCOLUMN width="580" />

				<!--
				<WTDIVISION  style="z-index: 2; background: transparent; position: absolute; left: 15px; top: 5px; width: 150px; height: 150px;">
					<WTIMAGE value="CONST(@Men.gif)"/>
				</WTDIVISION>
-->
				<WTDIVISION style="z-index: 2; position: absolute; left: 14px; top: 460px;">
					<WTIMAGE value="CONST(@Bar1.gif)">
						<WTLINK name="1212" target="catalog" nodata="true" />
					</WTIMAGE>
				</WTDIVISION>
				<WTDIVISION style="z-index: 2; position: absolute; left: 14px; top: 505px;">
					<WTIMAGE value="CONST(@Bar2.gif)">
						<WTLINK name="CONST(mms://media1.pinnaclep.com/Video/Pinnacle/buffet.wmv)" type="anchor" target="video" nodata="true" />
					</WTIMAGE>
				</WTDIVISION>
				<WTDIVISION style="z-index: 2; position: absolute; left: 14px; top: 550px;">
					<WTIMAGE value="CONST(@Bar3.gif)">
						<WTLINK name="0025" target="catalog" nodata="true" />
					</WTIMAGE>
				</WTDIVISION>
				<!--
				<WTROW>
					<WTSTATIC col="1"/>
					<WTIMAGE col="2" align="center" valign="top" value="CONST(@Logo.gif)"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTDIVIDER col="1" merge="2" height="4" color="#001470"/>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="2">
					<WTSTATIC col="1"/>
					<WTLINKGROUP col="2" align="center" valign="middle">
						<WTLINK name="0000" label="Home"/>
						<WTLINK name="0011" label="Training"/>
						<WTLINK name="1212" label="Courses" target="courses"/>
						<WTLINK name="0012" label="About"/>
						<WTLINK name="0013" label="Management"/>
						<WTLINK name="0101" label="MemberSignIn"/>
					</WTLINKGROUP>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" merge="2" height="1" color="#001470"/>
				</WTROW>
-->
<!--
				<WTROW>
					<WTSTATIC col="1" merge="2" class="BodyMedium" tag="PreferredLanguage" align="right" valign="center"/>
					<WTCOMBO col="3" name="PreferredLanguage" value="SYS(language)" valuetype="text" align="right" valign="center">
						<WTCHANGE>window.navigate("0000.asp?SysLanguage=" + document.getElementById('PreferredLanguage').value)</WTCHANGE> 
						<WTOPTION id="en" label="English"/>
						<WTOPTION id="es" label="Spanish"/>
						<WTOPTION id="zh" label="Chinese"/>
						<WTOPTION id="ja" label="Japanese"/>
						<WTOPTION id="fr" label="French"/>
						<WTOPTION id="de" label="German"/>
						<WTOPTION id="it" label="Italian"/>
						<WTOPTION id="pt" label="Portuguese"/>
						<WTOPTION id="ko" label="Korean"/>
						<WTOPTION id="ru" label="Russian"/>
					</WTCOMBO>	
				</WTROW>
-->
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Logon" align="right"/>
					<WTTEXT col="1"  value="PARAM(Lgn)" size="5" prespace="false" focus="true"/>
					<WTSTATIC col="1" tag="Password"/>
					<WTTEXT col="1" value="PARAM(Pwd)" size="5" prespace="false" secure="true"/>
					<WTBUTTON col="1" action="1" value="CONST(SignIn)" btnclass="smbutton" default="true"/>
					<WTCHECK col="1" value="PARAM(Remember)" label="Remember"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="@Test" header="false" footer="false" navbar="false" stylesheet="StyleSheet12.css"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" wrapper="false">
			<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Test" datatype="number"/>

			<WTDATATXN name="Breaking"/>
			<WTDATATXN name="Topic"/>
			<WTDATATXN name="Disqus"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(12)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;disqus.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlDisqus" direction="return" datatype="text"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;Disqus&quot;)"/>
					</WTMETHOD>
					<WTCUSTOM>
						if reqTest = 0 Then reqTest = 1
						reqNewsID = reqTest
						tmpID = CStr(reqNewsID)
						tmpTitle = "BobWood" + tmpID
						tmpURL = Request.ServerVariables("SERVER_NAME") + "/#!/" + tmpID
						tmpURL = reqPageURL
						
						response.write "&lt;BR&gt;Identifier: " + tmpID
						response.write "&lt;BR&gt;Title: " + tmpTitle
						response.write "&lt;BR&gt;URL: " + tmpURL

						xmlDisqus = Replace( xmlDisqus, "{threadid}", tmpID )
						xmlDisqus = Replace( xmlDisqus, "{threadtitle}", tmpTitle )
						xmlDisqus = Replace( xmlDisqus, "{threadurl}", tmpURL )
					</WTCUSTOM>
				</WTOBJECT>

				<WTOBJECT name="NewsTopics" project="ptsNewsTopicUser" class="CNewsTopics">
					<WTMETHOD name="ListMajor">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNewsTopics" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- Get Main News Stories -->
				<WTOBJECT name="Newss" project="ptsNewsUser" class="CNewss">
					<WTMETHOD name="ListNews">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(2)"/>
						<WTPARAM name="NewsTopicID" direction="input" value="CONST(0)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNewss" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
					<WTMETHOD name="ListNews">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(3)"/>
						<WTPARAM name="NewsTopicID" direction="input" value="CONST(0)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBreaking" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;Breaking&quot;)"/>
					</WTMETHOD>
					<WTMETHOD name="ListNews">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(6)"/>
						<WTPARAM name="NewsTopicID" direction="input" value="CONST(0)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlTopic" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
						<WTPARAM name="ElementName" direction="input" value="CONST(&quot;Topic&quot;)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1200" align="left"/>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(Disqus.Data)" embedhtml="true" />
				</WTROW>
				
				<!--
				<WTROW>
					<WTTABLE col="1" height="40" padding="0" style="border: 1px #cccccc solid; background-color: #FFFFFF" firstrow="false">
						<WTCOLUMN width="700" align="left"/>
						<WTCOLUMN width="250" align="left"/>
						<WTCOLUMN width="250" align="left"/>
						<WTROW>
							<WTTABLE col="1" valign="top" firstrow="false" style="border: 1px #cccccc solid; background-color: #f8f8f8">
								<WTCOLUMN width="20"/>
								<WTCOLUMN width="680" align="left"/>
								<WTROW margin-top="12" margin-bottom="12">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2">
										<WTSTATIC label="TopNews" fontsize="4" align="left"/>
										<WTSTATIC value="CONST(Top News)" fontsize="4" align="left"/>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTABLE col="2" valign="top" firstrow="false">
										<WTCOLUMN width="680" align="left"/>
										<WTROW>
											<WTSTATIC col="1">
												<WTCODEGROUP>
													<WTDIVISION style="margin-bottom:40px;">
														<WTSLIDE2 name="Main" datapath="/DATA/TXN/PTSNEWSS/PTSNEWS[@leadmain=1]" width="680" height="350" animspeed="5000" animduration="1000" showmarkers="true" showcontrols="true" nexttext="&gt;" prevtext="&lt;">
															<WTCODEGROUP division="title" style="width:380; padding:10; background-color:#1c1c1c; float:left">
																<WTSTATIC value="DATA(Title)" fontsize="5" fontcolor="white">
																	<WTLINK name="window.parent.ShowTab('TabStory', &lt;xsl:value-of select=&quot;@newsid&quot;/&gt;)" click="true" />
																</WTSTATIC>
															</WTCODEGROUP>
															<WTIMAGE value="DATA(Image)" path="CONST(News\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;)" imgwidth="400">
																<WTLINK name="window.parent.ShowTab('TabStory', &lt;xsl:value-of select=&quot;@newsid&quot;/&gt;)" click="true" />
															</WTIMAGE>
															<WTCODEGROUP division="title" style="width:260; padding:10; float:right; position:absolute; top:0px; right:0px">
																<WTSTATIC value="DATA(Description)" embedhtml="true"/>
															</WTCODEGROUP>
														</WTSLIDE2>
													</WTDIVISION>
												</WTCODEGROUP>
											</WTSTATIC>
										</WTROW>
									</WTTABLE>
								</WTROW>

								<WTROW margin-top="12" margin-bottom="12">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2">
										<WTSTATIC label="OtherTopNews" fontsize="4" align="left"/>
										<WTSTATIC value="CONST(Other Top News)" fontsize="4" align="left"/>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="12">
									<WTSTATIC col="1"/>
									<WTTABLE col="2" valign="top" firstrow="false">
										<WTCOLUMN width="20" align="left"/>
										<WTCOLUMN width="640" align="left"/>
										<WTROW>
											<WTSTATIC col="1"/>
											<WTSTATIC col="2">
													<WTCODEGROUP>
													<WTDIVISION>
														<WTSCROLL2 name="Topic2" datapath="/DATA/TXN/PTSNEWSS/PTSNEWS[@leadmain=2]" skin="r180c" vertical="true" wrap="circular" scroll="1">
															<WTSTATIC fontcolor="1c1c1c" bold="true">
																<WTCODEGROUP>
																	<WTIMAGE value="CONST(reddot.gif)" imgalign="absmiddle"/>
																</WTCODEGROUP>
																<WTSTATIC value="DATA(Title)">
																	<WTLINK name="window.parent.ShowTab('TabStory', &lt;xsl:value-of select=&quot;@newsid&quot;/&gt;)" click="true" />
																</WTSTATIC>
															</WTSTATIC>
														</WTSCROLL2>
													</WTDIVISION>
												</WTCODEGROUP>
											</WTSTATIC>
										</WTROW>
									</WTTABLE>
								</WTROW>

								<WTROW>
									<WTSTATIC col="1"/>
									<WTTABLE col="2" merge="4">
										<WTCOLUMN width="225" align="center"/>
										<WTCOLUMN width="225" align="center"/>
										<WTCOLUMN width="225" align="center"/>

										<WTREPEAT xpath="/DATA/TXN/PTSNEWSTOPICS/PTSNEWSTOPIC[position() mod 3 = 1]">
											<WTCODEGROUP>
												<WTVARIABLE name="tmpRow" value="CONST(&lt;xsl:value-of select=&quot;position()-1&quot;/&gt;)"/>
											</WTCODEGROUP>
											<WTROW>
												<WTREPEAT xpath=".|following-sibling::PTSNEWSTOPIC[position() &amp;lt; 3]">
													<WTCODEGROUP>
														<WTVARIABLE name="tmpNewsTopicID" value="CONST(&lt;xsl:value-of select=&quot;@newstopicid&quot;/&gt;)"/>
													</WTCODEGROUP>
													<WTSTATIC col="1" valign="top">
														<WTCODEGROUP>
															<WTDIVISION class="NewsTopicContainer">
																<WTDIVISION class="NewsTopicInnerContainer">
																	<WTDIVISION class="NewsTopicHeader NewsTopicHeader&lt;xsl:value-of select=&quot;( ($tmpRow * 3) + position() ) mod 5&quot;/&gt;">
																		<WTSTATIC value="DATA(NewsTopicName)" space="1"/>
																		<WTIMAGE valign="center" value="CONST(preview2.gif)" imgalign="absmiddle">
																			<WTLINK name="window.parent.ShowTab('TabTopic', &lt;xsl:value-of select=&quot;@newstopicid&quot;/&gt;)" click="true" />
																		</WTIMAGE>
																	</WTDIVISION>
																	<WTDIVISION class="NewsTopicNews">
																		<WTREPEAT xpath="/DATA/TXN/PTSTOPICS/PTSTOPIC[@status = $tmpNewsTopicID]">
																			<WTDIVISION class="NewsTopicStory">
																				<WTCODEGROUP>
																					<WTCONDITION expr="CONST(position())" oper="equal" value="CONST(1)"/>
																					<WTIMAGE value="DATA(Image)" path="CONST(News\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;\topic)" imgwidth="220" imgheight="80">
																						<WTLINK name="window.parent.ShowTab('TabStory', &lt;xsl:value-of select=&quot;@newsid&quot;/&gt;)" click="true" />
																					</WTIMAGE>
																				</WTCODEGROUP>
																				<WTSTATIC>
																					<WTCODEGROUP>
																						<WTIMAGE value="CONST(reddot.gif)" imgalign="absmiddle"/>
																					</WTCODEGROUP>
																					<WTSTATIC value="DATA(Title)">
																						<WTLINK name="window.parent.ShowTab('TabStory', &lt;xsl:value-of select=&quot;@newsid&quot;/&gt;)" click="true" />
																					</WTSTATIC>
																				</WTSTATIC>
																			</WTDIVISION>
																		</WTREPEAT>
																	</WTDIVISION>
																</WTDIVISION>
															</WTDIVISION>
														</WTCODEGROUP>
													</WTSTATIC>
												</WTREPEAT>
											</WTROW>
										</WTREPEAT>
									</WTTABLE>
								</WTROW>
							</WTTABLE>

							<WTTABLE col="2" valign="top" firstrow="false" style="border: 1px #cccccc solid;">
								<WTCOLUMN width="10"/>
								<WTCOLUMN width="230" align="left"/>
								<WTCOLUMN width="10"/>
								<WTROW margin-top="12" margin-bottom="12">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" align="center">
										<WTSTATIC label="BreakingNews" fontsize="4"/>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTABLE col="2" valign="top" firstrow="false">
										<WTCOLUMN width="230" align="left"/>
										<WTREPEAT entity="Breaking">
											<WTROW>
												<WTCONDITION expr="DATA(Image)" oper="not-equal" value="CONST('')"/>
												<WTIMAGE col="1" value="DATA(Image)" path="CONST(News\&lt;xsl:value-of select=&quot;/DATA/PARAM/@companyid&quot;/&gt;\break)" imgwidth="200" align="center">
													<WTLINK name="window.parent.ShowTab('TabStory', &lt;xsl:value-of select=&quot;@newsid&quot;/&gt;)" click="true" />
												</WTIMAGE>
											</WTROW>
											<WTROW>
												<WTSTATIC col="1" value="DATA(Title)" fontcolor="1c1c1c" bold="true">
													<WTLINK name="window.parent.ShowTab('TabStory', &lt;xsl:value-of select=&quot;@newsid&quot;/&gt;)" click="true" />
												</WTSTATIC>
											</WTROW>
											<WTROW margin-top="6" margin-bottom="6">
												<WTDIVIDER col="1" height="1" color="cccccc"/>
											</WTROW>
										</WTREPEAT>
									</WTTABLE>
								</WTROW>
							</WTTABLE>

							<WTSTATIC col="3" valign="top" height="400" style="border: 1px #cccccc solid;">
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
-->				

			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--=============================================================================================-->
		<WTWEBPAGE name="0001" caption="Welcome to the Pinnacle Performance Institute" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTPARAM name="Affiliate" datatype="text" />
			<WTPARAM name="CompanyID" datatype="number" />
			<WTINCLUDE name="Company.asp" />

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="greater" value="CONST(0)" />
					<WTGETCACHE name="CONST(tmpPage)" value="COMPANYHOMEPAGE" />
					<WTRETURN>
						<WTCONDITION expr="CONST(tmpPage)" oper="equal" value="CONST(&quot;HOME&quot;)" />
						<WTLINK name="Home" return="false">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						</WTLINK>
					</WTRETURN>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPage)" oper="not-equal" value="CONST(&quot;&quot;)" />
						<WTCUSTOM>Response.Redirect "Sections/Company/" &amp; reqCompanyID &amp; "/" &amp; tmpPage</WTCUSTOM>
					</WTCODEGROUP>
					<WTRETURN>
						<WTLINK name="Ascend" return="false">
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
<WTCUSTOM>
		'Check for ORG logon as subnet
		If reqSysAffiliateID = 0 and reqAffiliate = "" Then
			pos = InStr(reqSysServerName, "." )
			If pos &gt; 0 Then
				str = left(reqSysServerName, pos-1)
				if str &lt;&gt; "www" and str &lt;&gt; "pinnaclep" and  str &lt;&gt; "com" Then reqAffiliate = str
			End If
		End If
</WTCUSTOM>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(Affiliate)" oper="not-equal" value="&quot;&quot;" />
					<WTMETHOD name="LoadSubnet">
						<WTPARAM name="Subnet" direction="input" value="PARAM(Affiliate)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
						<WTCALLSUB name="GetCompany(reqCompanyID)" />
						<WTGETCACHE name="CONST(tmpPage)" value="COMPANYHOMEPAGE" />
						<WTRETURN>
							<WTCONDITION expr="CONST(tmpPage)" oper="equal" value="CONST(&quot;HOME&quot;)" />
							<WTLINK name="Home" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
							</WTLINK>
						</WTRETURN>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPage)" oper="not-equal" value="CONST(&quot;&quot;)" />
							<WTCUSTOM>Response.Redirect "Sections/Company/" &amp; reqCompanyID &amp; "/" &amp; tmpPage</WTCUSTOM>
						</WTCODEGROUP>
						<WTRETURN>
							<WTLINK name="Ascend" return="false">
								<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Affiliate" project="ptsAffiliateUser" class="CAffiliate">
					<WTCONDITION expr="PARAM(Affiliate)" oper="not-equal" value="&quot;&quot;" />
					<WTCONDITION expr="SYS(affiliateid)" oper="greater" value="CONST(0)" connector="or" />
					<WTMETHOD name="LoadLogon">
						<WTCONDITION expr="PARAM(Affiliate)" oper="not-equal" value="&quot;&quot;" />
						<WTPARAM name="Logon" direction="input" value="PARAM(Affiliate)" />
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTCONDITION expr="PARAM(Affiliate)" oper="equal" value="&quot;&quot;" />
						<WTPARAM name="AffiliateID" direction="input" value="SYS(affiliateid)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCUSTOM>
					If .AffiliateID > 0 Then
						If .Image &lt;&gt; &quot;&quot; Then
							.Image = .AffiliateID &amp; Right(.Image, 4)
						End If
						If .IsCompany &lt;&gt; &quot;1&quot; Then
							.CompanyName = .NameFirst + &quot; &quot; + .NameLast
						End If
					End If
</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Affiliate.AffiliateID)" oper="greater" value="CONST(0)" />
						<WTSETATTRIBUTE name="SYS(affiliateid)" value="ATTR(AffiliateID)" />
						<WTSETCACHE name="AffiliateID" value="SYS(affiliateid)" />
						<WTSETATTRIBUTE name="SYS(affiliatetype)" value="ATTR(Rank)" />
						<WTSETCACHE name="affiliatetype" value="SYS(affiliatetype)" />
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAffiliate" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(3)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0000.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="40" align="left" />
				<WTCOLUMN width="120" align="left" />
				<WTCOLUMN width="540" align="center" />
				<WTCOLUMN width="50" align="center" />
<!--
				<WTROW>
					<WTCONDITION expr="SYS(affiliateid)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" align="left" valign="center" class="PageHeading" tag="Welcome"/>
					<WTSTATIC col="3" class="BodyMedium" tag="PreferredLanguage" align="right" valign="center"/>
					<WTCOMBO col="3" name="PreferredLanguage" value="SYS(language)" valuetype="text" align="right" valign="center">
						<WTCHANGE>window.navigate("0000.asp?SysLanguage=" + document.getElementById('PreferredLanguage').value)</WTCHANGE> 
						<WTOPTION id="en" label="English"/>
						<WTOPTION id="es" label="Spanish"/>
					</WTCOMBO>	
				</WTROW>
-->
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(affiliateid)" oper="greater" value="CONST(0)" />
					<!--
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2"/>
						<WTSTATIC col="3" class="BodyMedium" tag="PreferredLanguage" align="right" valign="center"/>
						<WTCOMBO col="3" name="PreferredLanguage" value="SYS(language)" valuetype="text" align="right" valign="top">
							<WTCHANGE>window.navigate("0000.asp?SysLanguage=" + document.getElementById('PreferredLanguage').value)</WTCHANGE> 
							<WTOPTION id="en" label="English"/>
							<WTOPTION id="es" label="Spanish"/>
						</WTCOMBO>
					</WTROW>
-->
					<WTROW>
						<WTCONDITION expr="ATTR(Affiliate.Image)" oper="not-equal" value="''" />
						<WTSTATIC col="1" />
						<WTIMAGE col="2" value="ATTR(Affiliate.Image)" align="left" valign="top" imgwidth="100" path="Affiliate" />
						<WTSTATIC col="3" align="left" valign="top" class="BodyMedium">
							<WTSTATIC value="ATTR(Affiliate.CompanyName)" bold="true" space="2" />
							<WTSTATIC value="ATTR(Affiliate.Phone1)" space="2" />
						</WTSTATIC>
						<WTSTATIC col="3" align="left" value="ATTR(Affiliate.Email)" valign="top" class="PageLink" prespace="false" newline="1">
							<WTLINK name="ATTR(Affiliate.Email)" type="mail" />
						</WTSTATIC>
						<WTSTATIC col="3" align="left" valign="top" class="BodyMedium" value="ATTR(Affiliate.Description)" prespace="false" embedhtml="true" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="ATTR(Affiliate.Image)" oper="equal" value="''" />
						<WTSTATIC col="1" />
						<WTSTATIC col="2" merge="2" align="left" valign="top" class="BodyMedium">
							<WTSTATIC value="ATTR(Affiliate.CompanyName)" bold="true" space="2" />
							<WTSTATIC value="ATTR(Affiliate.Phone1)" space="2" />
						</WTSTATIC>
						<WTSTATIC col="2" merge="2" align="left" value="ATTR(Affiliate.Email)" valign="top" class="PageLink" prespace="false" newline="1">
							<WTLINK name="ATTR(Affiliate.Email)" type="mail" />
						</WTSTATIC>
						<WTSTATIC col="2" merge="2" align="left" valign="top" class="BodyMedium" value="ATTR(Affiliate.Description)" prespace="false" embedhtml="true" />
					</WTROW>
					<!--
					<WTROW margin-top="12">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" valign="top" align="center" class="PageLinkLarge" fontcolor="chocolate">
							<WTLINK name="Opportunity" label="LearnOpportunity" class="PageLinkLarge"/>
						</WTSTATIC>
					</WTROW>
-->
					<WTROW margin-bottom="12" margin-top="12">
						<WTDIVIDER col="1" merge="4" align="left" height="1" color="SYS(divider)" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="4" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0050" caption="Home Page" navbar="false" header="false" footer="false" 
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false">
		<!--=============================================================================================-->
			<WTPARAM name="M" datatype="text" />
			<WTPARAM name="MemberID" datatype="number" />
			<WTPARAM name="CompanyID" datatype="number" />

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
		'Check for Member logon as subnet
		If reqSysMemberID = 0 and reqM = "" Then
			pos = InStr(reqSysServerName, "." )
			If pos &gt; 0 Then
				str = left(reqSysServerName, pos-1)
				if str &lt;&gt; "www" Then reqM = str
			End If
		End If
</WTCUSTOM>
				<WTSETATTRIBUTE name="CONST(tmpSignature)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="CONST(tmpPhone)" value="CONST(&quot;&quot;)" />
				<WTSETATTRIBUTE name="CONST(tmpImage)" value="CONST(&quot;&quot;)" />
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="&quot;&quot;"/>
					<WTCONDITION expr="SYS(MemberID)" oper="greater" value="CONST(0)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(M)" oper="not-equal" value="&quot;&quot;"/>
						<WTMETHOD name="FetchLogon">
							<WTPARAM name="Logon" direction="input" value="PARAM(M)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="SYS(Memberid)" value="ATTR(MemberID)">
							<WTCONDITION expr="ATTR(MemberID)" oper="greater" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTMETHOD name="Load">
						<WTCONDITION expr="SYS(MemberID)" oper="greater" value="CONST(0)"/>
						<WTPARAM name="MemberID" direction="input" value="SYS(Memberid)"/>
						<WTPARAM name="SecurityToken" direction="input" value="CONST(1)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(MemberID)" oper="greater" value="CONST(0)"/>
						<WTSETATTRIBUTE name="SYS(Memberid)" value="ATTR(MemberID)"/>
						<WTSETCACHE name="MemberID" value="SYS(Memberid)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpSignature)" value="ATTR(Signature)" />
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="ATTR(CompanyName)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)" />
					<WTSETATTRIBUTE name="CONST(tmpPhone)" value="ATTR(Phone1)" />
					<WTSETATTRIBUTE name="CONST(tmpImage)" value="ATTR(Image)" />
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;member-home.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
<WTCUSTOM>
		xmlHTMLFile = Replace( xmlHTMLFile, "{signature}", CleanXMLComment(tmpSignature) )
		xmlHTMLFile = Replace( xmlHTMLFile, "{name}", CleanXMLComment(tmpName) )
		xmlHTMLFile = Replace( xmlHTMLFile, "{email}", CleanXMLComment(tmpEmail) )
		xmlHTMLFile = Replace( xmlHTMLFile, "{phone}", CleanXMLComment(tmpPhone) )
</WTCUSTOM>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="Ascend" caption="Home Page" navbar="false" header="PageHeader" footer="false" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="SignIn" datatype="number" />
			<WTPARAM name="JoinNow" datatype="number" />
			<WTPARAM name="Lgn" datatype="text"/>
			<WTPARAM name="Pwd" datatype="text"/>
			<WTPARAM name="Remember" datatype="number" />
			<WTINCLUDE name="Company.asp" />

			<WTACTION id="0" name="New" type="New">
				<WTGETCOOKIE name="PARAM(Lgn)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Pwd)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Lgn)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCALLSUB name="GetCompany(reqCompanyID)" />

				<WTGETCACHE name="CONST(tmpPage)" value="COMPANYHOMEPAGE" />
				<WTRETURN>
					<WTCONDITION expr="CONST(tmpPage)" oper="equal" value="CONST(&quot;HOME&quot;)" />
					<WTLINK name="Home" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)" />
					</WTLINK>
				</WTRETURN>

				<WTGETCACHE name="PARAM(SignIn)" value="CompanySignIn" />
				<WTGETCACHE name="PARAM(JoinNow)" value="CompanyJoinNow" />
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;home.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqSysCompanyID))" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="1" name="SignIn" type="SignIn">
				<WTSETATTRIBUTE name="CONST(tmpLgn)" value="FORM(Lgn)"/>
				<WTSETATTRIBUTE name="CONST(tmpPwd)" value="FORM(Pwd)"/>
				<WTSETATTRIBUTE name="CONST(tmpRemember)" value="FORM(Remember)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(tmpLgn)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(tmpPwd)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="Lgn" value="CONST(tmpLgn)"/>
						<WTPARAM name="Pwd" value="CONST(tmpPwd)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="right"/>
				<WTCOLUMN width="100" align="right"/>
				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Logon" align="right"/>
					<WTTEXT col="1"  value="PARAM(Lgn)" size="5" prespace="false" focus="true"/>
					<WTSTATIC col="1" tag="Password"/>
					<WTTEXT col="1" value="PARAM(Pwd)" size="5" prespace="false" secure="true"/>
					<WTBUTTON col="1" action="1" value="CONST(SignIn)" btnclass="smbutton" default="true"/>
					<WTCHECK col="1" value="PARAM(Remember)" label="Remember"/>

					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC label="JoinNow" bold="true">
							<WTCONDITION expr="PARAM(JoinNow)" oper="greater" value="CONST(0)" />
							<WTLINK name="0402" nodata="true">
								<WTPARAM name="CompanyID" value="SYS(CompanyID)" />
							</WTLINK>
						</WTSTATIC>
					</WTSTATIC>

				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="Home" caption="Home Page" navbar="false" header="false" footer="false" wrapper="wrapper1000"
			page-image="bg.jpg" page-width="1000" margin-width="0" navbar-width="0" content-width="1000"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Lgn" datatype="text"/>
			<WTPARAM name="Pwd" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="A" datatype="number"/>  <!-- Referring Member -->
			<WTPARAM name="G" datatype="number"/>  <!-- GroupID -->
			<WTPARAM name="C" datatype="number"/>  <!-- CompanyID -->
			<WTPARAM name="PageImage" datatype="text"/>

			<WTINCLUDE name="Company.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(16)"/>
				<WTSETATTRIBUTE name="PARAM(PageImage)" value="CONST(&quot;blank.gif&quot;)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="CONST(reqSysGA_ACCTID)" oper="equal" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- SETUP GOOGLE ANALYTICS FOR THE COMPANY-->
					<WTCODEGROUP>
						<WTCUSTOM>
							aGA = Split(.GAAcct, ",")
							If UBOUND(aGA) = 1 Then
							tmpID = aGA(0)
							tmpDomain = aGA(1)
							If tmpID &lt;&gt; "" And tmpDomain &lt;&gt; "" Then
							reqSysGA_ACCTID = tmpID
							reqSysGA_DOMAIN = tmpDomain
							SetCache "GA_ACCTID", tmpID
							SetCache "GA_DOMAIN", tmpDomain
							End If
							End If
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)"/>
					<WTSETCACHE name="A" value="PARAM(A)" />
					<WTSETATTRIBUTE name="SYS(AffiliateID)" value="PARAM(A)"/>
					<WTSETCACHE name="SYS(AffiliateID)" value="SYS(AffiliateID)"/>
				</WTCODEGROUP>
				<WTGETCOOKIE name="PARAM(Lgn)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Pwd)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Lgn)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCALLSUB name="GetCompany(reqCompanyID)" />
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;home.htm&quot;)">
						<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;home&quot; + CSTR(reqG) + &quot;.htm&quot;)">
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Len(.Data))" oper="less" value="CONST(10)"/>
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;home.htm&quot;)"/>
						<WTMETHOD name="Load" />
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
<WTCUSTOM>
	tmpHeader = GetHeader( reqCompanyID, reqG, "Header", reqSysLanguage )
	If tmpHeader = "" Then tmpHeader = GetHeader( reqCompanyID, 0, "Header", reqSysLanguage )
	If tmpHeader &lt;&gt; "" Then SetCache "HEADERIMAGE", tmpHeader

	xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqA )
	xmlHTMLFile = Replace( xmlHTMLFile, "{cid}", reqCompanyID )
	xmlHTMLFile = Replace( xmlHTMLFile, "{header}", tmpHeader )
	xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", CleanXMLComment(reqLgn) )
	xmlHTMLFile = Replace( xmlHTMLFile, "{pwd}", CleanXMLComment(reqPwd) )
	If reqRemember = 1 Then
	xmlHTMLFile = Replace( xmlHTMLFile, "{remember}", "checked" )
	Else
	xmlHTMLFile = Replace( xmlHTMLFile, "{remember}", "" )
	End If
</WTCUSTOM>
			</WTACTION>

			<WTACTION id="1" name="SignIn" type="SignIn">
				<WTSETATTRIBUTE name="CONST(tmpLgn)" value="FORM(Lgn)"/>
				<WTSETATTRIBUTE name="CONST(tmpPwd)" value="FORM(Pwd)"/>
				<WTSETATTRIBUTE name="CONST(tmpRemember)" value="FORM(Remember)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(tmpLgn)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(tmpPwd)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="Lgn" value="CONST(tmpLgn)"/>
						<WTPARAM name="Pwd" value="CONST(tmpPwd)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_Home" caption="Home Page" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="wrapperMobile"
			page-image="bg.jpg" page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Lgn" datatype="text"/>
			<WTPARAM name="Pwd" datatype="text"/>
			<WTPARAM name="Remember" datatype="number"/>
			<WTPARAM name="A" datatype="number"/>  <!-- Referring Member -->-->
			<WTPARAM name="G" datatype="number"/>  <!-- GroupID -->-->
			<WTPARAM name="C" datatype="number"/>  <!-- CompanyID -->-->

			<WTINCLUDE name="Company.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="CONST(reqSysGA_ACCTID)" oper="equal" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- SETUP GOOGLE ANALYTICS FOR THE COMPANY-->
					<WTCODEGROUP>
						<WTCUSTOM>
							aGA = Split(.GAAcct, ",")
							If UBOUND(aGA) = 1 Then
							tmpID = aGA(0)
							tmpDomain = aGA(1)
							If tmpID &lt;&gt; "" And tmpDomain &lt;&gt; "" Then
							reqSysGA_ACCTID = tmpID
							reqSysGA_DOMAIN = tmpDomain
							SetCache "GA_ACCTID", tmpID
							SetCache "GA_DOMAIN", tmpDomain
							End If
							End If
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(A)" oper="not-equal" value="CONST(0)"/>
					<WTSETCACHE name="A" value="PARAM(A)" />
					<WTSETATTRIBUTE name="SYS(AffiliateID)" value="PARAM(A)"/>
					<WTSETCACHE name="SYS(AffiliateID)" value="SYS(AffiliateID)"/>
				</WTCODEGROUP>
				<WTGETCOOKIE name="PARAM(Lgn)" value="CONST(LGN)"/>
				<WTGETCOOKIE name="PARAM(Pwd)" value="CONST(PWD)"/>
				<WTSETATTRIBUTE name="PARAM(Remember)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Lgn)" oper="not-equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCALLSUB name="GetCompany(reqCompanyID)" />
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_home.htm&quot;)">
						<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_home&quot; + CSTR(reqG) + &quot;.htm&quot;)">
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)" />
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(Len(.Data))" oper="less" value="CONST(10)"/>
						<WTCONDITION expr="PARAM(G)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_home.htm&quot;)"/>
						<WTMETHOD name="Load" />
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCUSTOM>
					tmpHeader = GetHeader( reqCompanyID, reqG, "MobileHeader", "" )
					If reqG &gt; 0 And tmpHeader = "" Then tmpHeader = GetHeader( reqCompanyID, 0, "MobileHeader", "" )

					xmlHTMLFile = Replace( xmlHTMLFile, "{id}", reqA )
					xmlHTMLFile = Replace( xmlHTMLFile, "{cid}", reqCompanyID )
					xmlHTMLFile = Replace( xmlHTMLFile, "{header}", tmpHeader )
					xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", CleanXMLComment(reqLgn) )
					xmlHTMLFile = Replace( xmlHTMLFile, "{pwd}", CleanXMLComment(reqPwd) )
					If reqRemember = 1 Then
					xmlHTMLFile = Replace( xmlHTMLFile, "{remember}", "checked" )
					Else
					xmlHTMLFile = Replace( xmlHTMLFile, "{remember}", "" )
					End If
				</WTCUSTOM>
			</WTACTION>

			<WTACTION id="1" name="SignIn" type="SignIn">
				<WTSETATTRIBUTE name="CONST(tmpLgn)" value="FORM(Lgn)"/>
				<WTSETATTRIBUTE name="CONST(tmpPwd)" value="FORM(Pwd)"/>
				<WTSETATTRIBUTE name="CONST(tmpRemember)" value="FORM(Remember)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(tmpLgn)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(tmpPwd)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpRemember)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(LGN)" value="CONST(&quot;&quot;)"/>
					<WTSETCOOKIE name="CONST(PWD)" value="CONST(&quot;&quot;)"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTLINK name="m_0101" return="false">
						<WTPARAM name="Lgn" value="CONST(tmpLgn)"/>
						<WTPARAM name="Pwd" value="CONST(tmpPwd)"/>
						<WTPARAM name="Page" value="CONST(&quot;MobileHome.asp&quot;)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="Pinnacle" caption="Pinnacle Home Page" navbar="false" footer="false" 
		aspstyle="GenerateWebASPOpen.xsl" xslstyle="GenerateWebXSLOpen.xsl" focus="false">
		<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;p-home.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCODEGROUP>
					<WTSTATIC value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0003" header="false" footer="false" navbar="false"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="21">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTES />
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right" />
				<WTCOLUMN width="440" align="left" />
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" tag="Business" value="ATTR(Business.BusinessName)" class="PageHeading" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Install" />
					<WTTEXT col="2" value="ATTR(Business.Install)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="BusinessName" />
					<WTTEXT col="2" value="ATTR(Business.BusinessName)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address" />
					<WTTEXT col="2" value="ATTR(Business.Street)" width="294" label="Street" size="40" />
					<WTTEXT col="2" value="ATTR(Business.Unit)" width="146" label="Unit" size="10" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTTEXT col="2" value="ATTR(Business.City)" width="200" label="City" size="25" />
					<WTTEXT col="2" value="ATTR(Business.State)" width="240" label="State" size="25" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTTEXT col="2" value="ATTR(Business.Zip)" width="200" label="Zip" size="25" />
					<WTTEXT col="2" value="ATTR(Business.Country)" width="240" label="Country" size="25" />
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" />
					<WTDIVIDER col="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Phone" />
					<WTTEXT col="2" value="ATTR(Business.Phone)" size="30" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Fax" />
					<WTTEXT col="2" value="ATTR(Business.Fax)" size="30" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CustomerEmail" />
					<WTTEXT col="2" value="ATTR(Business.CustomerEmail)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="TrainerEmail" />
					<WTTEXT col="2" value="ATTR(Business.TrainerEmail)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="FinanceEmail" />
					<WTTEXT col="2" value="ATTR(Business.FinanceEmail)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="SystemEmail" />
					<WTTEXT col="2" value="ATTR(Business.SystemEmail)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="WebSite" />
					<WTTEXT col="2" value="ATTR(Business.WebSite)" />
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" />
					<WTDIVIDER col="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Timezone" />
					<WTCOMBO col="2" value="ATTR(Business.Timezone)">
						<WTOPTION id="-4" label="GMTm4"/>
						<WTOPTION id="-5" label="GMTm5"/>
						<WTOPTION id="-6" label="GMTm6"/>
						<WTOPTION id="-7" label="GMTm7"/>
						<WTOPTION id="-8" label="GMTm8"/>
						<WTOPTION id="-9" label="GMTm9"/>
						<WTOPTION id="-10" label="GMTm10"/>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Tutorial" />
					<WTTEXT col="2" value="ATTR(Business.Tutorial)" />
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" />
					<WTDIVIDER col="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="TaxRate" />
					<WTTEXT col="2" value="ATTR(Business.TaxRate)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" />
					<WTCHECK col="2" value="ATTR(Business.IsNotifyUser)" />
				</WTROW>
				<WTROW margin-top="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="PaymentText" align="left" class="prompt" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="PaymentOptions"/>
					<WTTEXT col="2" value="ATTR(Business.PaymentOptions)"/>
					<WTSTATIC col="2" align="left" class="prompt">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle">
								<WTLINK name="Page" target="Help">
									<WTPARAM name="Page" value="CONST(PaymentOptions)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="MiscPay1" />
					<WTTEXT col="2" value="ATTR(Business.MiscPay1)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="MiscPay2" />
					<WTTEXT col="2" value="ATTR(Business.MiscPay2)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="MiscPay3" />
					<WTTEXT col="2" value="ATTR(Business.MiscPay3)" />
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsSysAdmin" />
					<WTROW margin-top="12">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="CardAcctText" align="left" class="prompt" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardProcessor"/>
						<WTCOMBO col="2" value="ATTR(Business.CardProcessor)">
							<WTOPTION id="1" label="Verisign"/>
							<WTOPTION id="2" label="PaymentTech"/>
							<WTOPTION id="6" label="MerchantPartners"/>
							<WTOPTION id="8" label="AuthorizeNet"/>
							<WTOPTION id="10" label="PayJunction"/>
							<WTOPTION id="12" label="FirstData"/>
						</WTCOMBO>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardAcct" />
						<WTMEMO col="2" value="ATTR(Business.CardAcct)" rows="2" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckProcessor" />
						<WTCOMBO col="2" value="ATTR(Business.CheckProcessor)">
							<WTOPTION id="99" label="VersaCheck"/>
							<WTOPTION id="100" label="LegacyTexas"/>
							<WTOPTION id="3" label="ACHCommerce"/>
							<WTOPTION id="4" label="PaymentTech"/>
							<WTOPTION id="7" label="MerchantPartners"/>
							<WTOPTION id="9" label="AuthorizeNet"/>
							<WTOPTION id="11" label="PayJunction"/>
							<WTOPTION id="13" label="FirstData"/>
						</WTCOMBO>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckAcct" />
						<WTMEMO col="2" value="ATTR(Business.CheckAcct)" rows="2" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="PayPalAcct" />
						<WTMEMO col="2" value="ATTR(Business.PayPalAcct)" rows="2" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Languages" />
						<WTMEMO col="2" value="ATTR(Business.Languages)" rows="4" />
					</WTROW>

					<WTROW margin-top="6" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" class="prompt">
							<WTSTATIC label="OptionsText" space="1"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(LearnMore.gif)" imgalign="absmiddle">
									<WTLINK name="Page" target="Help">
										<WTPARAM name="Page" value="CONST(BusinessOptions)"/>
									</WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Options1"/>
						<WTTEXT col="2" value="ATTR(Business.Options1)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Options2"/>
						<WTTEXT col="2" value="ATTR(Business.Options2)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Options3"/>
						<WTTEXT col="2" value="ATTR(Business.Options3)" size="60"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Options4"/>
						<WTTEXT col="2" value="ATTR(Business.Options4)" size="60"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NotSysAdmin" />
					<WTROW>
						<WTHIDDEN value="ATTR(Business.CardProcessor)" />
						<WTHIDDEN value="ATTR(Business.CardAcct)" />
						<WTHIDDEN value="ATTR(Business.CheckProcessor)" />
						<WTHIDDEN value="ATTR(Business.CheckAcct)" />
						<WTHIDDEN value="ATTR(Business.PayPalAcct)" />
						<WTHIDDEN value="ATTR(Business.Languages)" />
						<WTHIDDEN value="ATTR(Business.Options1)" />
						<WTHIDDEN value="ATTR(Business.Options2)" />
						<WTHIDDEN value="ATTR(Business.Options3)" />
						<WTHIDDEN value="ATTR(Business.Options4)" />
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" />
					<WTBUTTON col="2" action="1" value="CONST(Update)">
						<WTCONDITION expr="IsActive" />
					</WTBUTTON>
<!--					<WTBUTTON col="2" action="3" value="CONST(Cancel)" />-->
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0011" caption="Training" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0011.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0012" caption="About Pinnacle" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0012.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0013" caption="Management Team" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0013.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0014" caption="Contact Pinnacle" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0014.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0020" caption="Pinnacle Sales" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0020.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0021" caption="Compensation Plan" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0021.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0022" caption="Affiliate Agreement" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0022.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0023" caption="Policies and Procedures" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0023.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--=============================================================================================-->
		<WTWEBPAGE name="0024" caption="Formula for Success" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0024.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--=============================================================================================-->
		<WTWEBPAGE name="0025" caption="Capitalize On Your Knowledge" navbar="false" header="PageHeaderPublic" footer="PageFooterPublic" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
			<!--=============================================================================================-->
			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;0025.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left" />
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="0060" caption="Management Reports" form="Report" header="false" footer="false" navbar="false"
	   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="0060" language="false" secured="125">
			<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="EnrollDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="All" datatype="number" />

      <WTCODEGROUP>
        <WTCONDITION expr="NotEmployee"/>
        <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="and"/>
        <WTCUSTOM>AbortUser()</WTCUSTOM>
      </WTCODEGROUP>

      <WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(All)" value="CONST(1)" />
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="ATTR(EnrollDate)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(2)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="CONST(Month(Date())&amp;&quot;/1/&quot;&amp;Year(Date()))" />
					<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(7)" />
				</WTCODEGROUP>
			</WTACTION>
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="right" />
				<WTFUNCTION name="CreateReport( page, target, options )">
					var url;
					var win;
					url = page + ".asp?CompanyID=" + Report.CompanyID.value + "&amp;FromDate=" + Report.FromDate.value + "&amp;ToDate=" + Report.ToDate.value;
					if ( options ) url += "&amp;" + options;
					win = window.open(url,target);
					win.focus();
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)" />
					<WTHIDDEN value="PARAM(EnrollDate)" />
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" align="left" tag="ManagementReports" value="ATTR(Company.CompanyName)" class="PageHeading" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" label="ReportText" align="left" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="0" label="Membership">
							<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(0)" />
						</WTOPTION>
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="PrevWeek" />
						<WTOPTION id="4" label="PrevMonth" />
						<WTOPTION id="5" label="PrevYear" />
						<WTOPTION id="6" label="WeekToDate" />
						<WTOPTION id="7" label="MonthToDate" />
						<WTOPTION id="8" label="YearToDate" />
						<!--
						<WTOPTION id="9" label="Next7Days"/>
						<WTOPTION id="10" label="Next14Days"/>
						<WTOPTION id="11" label="Next30Days"/>
-->
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "4":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "5":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "7":
							fromdate.setDate(1);
							break;
							case "8":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "9":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "10":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "11":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-top="6" margin-bottom="12">
					<WTSTATIC col="1" label="MemberReportsText" align="center" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" align="center" value="MembershipReport">
						<WTCLICK>CreateReport("0460","CompanyReport", "report=1");</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" align="center" value="NewEnrollmentReport">
						<WTCLICK>CreateReport("0460","CompanyReport", "report=2");</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" align="center" value="TotalEnrollmentReport">
						<WTCLICK>CreateReport("0460","CompanyReport", "report=3");</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" align="center" value="BillingReport">
						<WTCLICK>CreateReport("0460","CompanyReport", "report=4");</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTBUTTON col="1" align="center" value="VisitReport">
						<WTCLICK>CreateReport("0460","CompanyReport", "report=5&amp;option=" + Report.Status.value);</WTCLICK>
					</WTBUTTON>
					<WTCOMBO col="1" name="Status" align="center" select="false">
						<WTOPTION id="0" label="AllMemberships"/>
						<WTOPTION id="1" label="Perform"/>
						<WTOPTION id="2" label="Trial"/>
						<WTOPTION id="3" label="Certify"/>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="IsEmployee" />
					<WTBUTTON col="1" align="center" value="AuthLogReport">
						<WTCLICK>CreateReport("0460","CompanyReport", "report=6");</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee" />
					<WTROW margin-top="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTSTATIC col="1" label="CompanyReportsText" align="center" class="prompt" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="CompanyStatusReport">
							<WTCLICK>CreateReport("3860","CompanyReport", "report=1");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="CompanyTypeReport">
							<WTCLICK>CreateReport("3860","CompanyReport", "report=2");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="CompanyTypeMemberReport">
							<WTCLICK>CreateReport("3860","CompanyReport", "report=3");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="CompanyStatsReport">
							<WTCLICK>CreateReport("3860","CompanyReport", "report=4");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-top="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTSTATIC col="1" label="PaymentReportsText" align="center" class="prompt" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="PaymentStatusAmountReport">
							<WTCLICK>CreateReport("1060","CompanyReport", "report=1&amp;option=1");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="PaymentStatusCommissionReport">
							<WTCLICK>CreateReport("1060","CompanyReport", "report=1&amp;option=2");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="PaymentStatusRetailReport">
							<WTCLICK>CreateReport("1060","CompanyReport", "report=1&amp;option=3");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="PaymentStatusCountReport">
							<WTCLICK>CreateReport("1060","CompanyReport", "report=2");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="PaymentPayTypeAmountReport">
							<WTCLICK>CreateReport("1060","CompanyReport", "report=3");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="PaymentPayTypeCountReport">
							<WTCLICK>CreateReport("1060","CompanyReport", "report=4");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-top="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTSTATIC col="1" label="CourseReportsText" align="center" class="prompt" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="CourseStatusReport">
							<WTCLICK>CreateReport("1160","CompanyReport", "report=1");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTBUTTON col="1" align="center" value="CourseReviewReport">
							<WTCLICK>CreateReport("1160","CompanyReport", "report=2");</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-top="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTSTATIC col="1" label="IssueReportsText" align="center" class="prompt" />
					</WTROW>
					<WTROW>
						<WTBUTTON col="1" align="center" value="IssueStatusReport">
							<WTCLICK>CreateReport("9560","CompanyReport", "report=1&amp;assigned="+Report.Assigned.value+"&amp;all="+Report.All.checked);</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="AssignedTo" align="center" />
						<WTTEXT col="1" name="Assigned" size="6" align="center" prespace="false" />
						<WTCHECK col="1" value="PARAM(All)" align="center" />
					</WTROW>
				</WTCODEGROUP>
<!--				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)"  align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
-->				
			</WTCONTENT>
		</WTWEBPAGE>
		<!--==================================================================-->
		<WTWEBPAGE name="0061" caption="Report" form="Report" navbar="false" action="5" 
      aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0061" secured="125">
			<!--==================================================================-->
			<WTPARAM name="Report" datatype="number" />
			<WTPARAM name="OwnerType" datatype="number" />
			<WTPARAM name="AuthUserID" datatype="number" />
			<WTPARAM name="Owner" datatype="text" />
			<WTPARAM name="User" datatype="text" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Count" datatype="number" />
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(date)" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2000&quot;" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)" />
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
			</WTACTION>
			<WTACTION id="5" name="Report" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="FORM(FromDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="FORM(ToDate)" />
				<!-- Add a day to account for the minutes of the day -->
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DATEADD(&quot;d&quot;,1,CDate(reqToDate)))" />
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListActivityOwner">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
						<WTPARAM name="" direction="input" value="PARAM(OwnerType)" />
						<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
						<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
					</WTMETHOD>
					<WTMETHOD name="ListReminderOwner">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
						<WTPARAM name="" direction="input" value="PARAM(OwnerType)" />
						<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
						<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />
				<WTSTATIC label="edit" />
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
					<WTSTATIC col="1" label="ActivityReport" class="PageHeading" align="center" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
					<WTSTATIC col="1" label="ReminderReport" class="PageHeading" align="center" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="PARAM(User)" class="PageHeading" align="center" />
					<WTSTATIC col="1" value="PARAM(Owner)" class="PageHeading" align="center" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="UptoToday" />
						<WTOPTION id="4" label="PrevWeek" />
						<WTOPTION id="5" label="PrevMonth" />
						<WTOPTION id="6" label="PrevYear" />
						<WTOPTION id="7" label="WeekToDate" />
						<WTOPTION id="8" label="MonthToDate" />
						<WTOPTION id="9" label="YearToDate" />
						<WTOPTION id="10" label="Tomorrow" />
						<WTOPTION id="11" label="Next7Days" />
						<WTOPTION id="12" label="Next14Days" />
						<WTOPTION id="13" label="Next30Days" />
						<WTCHANGE>
						var ONE_DAY = 1000 * 60 * 60 * 24;
						var fromdate = new Date();
						var todate = new Date();
						switch(Report.Term.value) {
						case "0":
							Report.FromDate.value = Report.EnrollDate.value
							break;
						case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY ); 
							todate = fromdate; 
							break;
						case "2": 
							break;
						case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
						case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
						case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
						case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
						case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
						case "8":
							fromdate.setDate(1);
							break;
						case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
						case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY ); 
							todate = fromdate; 
							break;
						case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
						case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
						case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
						}
						if(Report.Term.value!="0"){Report.FromDate.value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
						Report.ToDate.value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
					<WTBUTTON col="1" action="5" value="CONST(Report)" default="true" />
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(ActionCode)" oper="not-equal" value="CONST(0)" />
					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTRECORDSET col="1" graybar="true" entity="Note">
							<WTCOLUMN width="100" align="left" valign="top" />
							<WTROW>
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsReminder.gif)">
											<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsFrozen.gif)">
											<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsLocked.gif)">
											<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple" />
									<WTSTATIC value="DATA(Note.Owner)" space="1">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(38)" />
										<WTLINK name="3803" class="NavBar" target="Owner">
											<WTPARAM name="CompanyID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Note.Owner)" space="1">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(4)" />
										<WTLINK name="0403" class="NavBar" target="Owner">
											<WTPARAM name="MemberID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Note.Owner)" space="1">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(6)" />
										<WTLINK name="0603" class="NavBar" target="Owner">
											<WTPARAM name="AffiliateID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Note.Owner)" space="1">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(3)" />
										<WTLINK name="0303" class="NavBar" target="Owner">
											<WTPARAM name="TrainerID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Note.Owner)" space="1">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(81)" />
										<WTLINK name="8103" class="NavBar" target="Owner">
											<WTPARAM name="ProspectID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue" />
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='edit']&quot;/&gt;))">
										<WTCONDITION expr="IsManager" />
										<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start" />
										<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end" />
										<WTLINK name="9003" class="NavBar" target="EditNote">
											<WTPARAM name="NoteID" value="DATA(NoteID)" />
											<WTPARAM name="Popup" value="CONST(1)" />
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" value="DATA(Note.Notes)" />
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true" />
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>
		<!--==================================================================-->
		<WTWEBPAGE name="0062" caption="Report" form="Report" navbar="false" action="5" 
      aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="0062" secured="125">
			<!--==================================================================-->
			<WTPARAM name="Report" datatype="number" />
			<WTPARAM name="OwnerType" datatype="number" />
			<WTPARAM name="AuthUserID" datatype="number" />
			<WTPARAM name="Owner" datatype="text" />
			<WTPARAM name="User" datatype="text" />
			<WTPARAM name="FromDate" datatype="date" />
			<WTPARAM name="ToDate" datatype="date" />
			<WTPARAM name="Term" datatype="number" />
			<WTPARAM name="Count" datatype="number" />
			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="SYS(date)" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(2)" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
					<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2000&quot;" />
					<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)" />
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)" />
			</WTACTION>
			<WTACTION id="5" name="Report" type="Report">
				<WTSETATTRIBUTE name="PARAM(Report)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="FORM(FromDate)" />
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="FORM(ToDate)" />
				<!-- Add a day to account for the minutes of the day -->
				<WTSETATTRIBUTE name="CONST(tmpToDate)" value="CONST(DATEADD(&quot;d&quot;,1,CDate(reqToDate)))" />
				<WTOBJECT name="Notes" project="ptsNoteUser" class="CNotes">
					<WTMETHOD name="ListActivity">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
						<WTPARAM name="" direction="input" value="PARAM(OwnerType)" />
						<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
						<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
					</WTMETHOD>
					<WTMETHOD name="ListReminder">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
						<WTPARAM name="" direction="input" value="PARAM(OwnerType)" />
						<WTPARAM name="" direction="input" value="PARAM(AuthUserID)" />
						<WTPARAM name="" direction="input" value="PARAM(FromDate)" />
						<WTPARAM name="" direction="input" value="CONST(tmpToDate)" />
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlNotes" direction="return" datatype="text" />
						<WTPARAM name="Option" direction="input" value="CONST(13)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="650" align="left" />
				<WTSTATIC label="edit" />
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)" />
					<WTSTATIC col="1" label="ActivityReport" class="PageHeading" align="center" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)" />
					<WTSTATIC col="1" label="ReminderReport" class="PageHeading" align="center" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="PARAM(User)" class="PageHeading" align="center" />
					<WTSTATIC col="1" value="PARAM(Owner)" class="PageHeading" align="center" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center" tag="ReportOn" />
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="1" label="Yesterday" />
						<WTOPTION id="2" label="Today" />
						<WTOPTION id="3" label="UptoToday" />
						<WTOPTION id="4" label="PrevWeek" />
						<WTOPTION id="5" label="PrevMonth" />
						<WTOPTION id="6" label="PrevYear" />
						<WTOPTION id="7" label="WeekToDate" />
						<WTOPTION id="8" label="MonthToDate" />
						<WTOPTION id="9" label="YearToDate" />
						<WTOPTION id="10" label="Tomorrow" />
						<WTOPTION id="11" label="Next7Days" />
						<WTOPTION id="12" label="Next14Days" />
						<WTOPTION id="13" label="Next30Days" />
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" />
					<WTSTATIC col="1" tag="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
					<WTBUTTON col="1" action="5" value="CONST(Report)" default="true" />
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="SYS(ActionCode)" oper="not-equal" value="CONST(0)" />
					<WTROW margin-bottom="3">
						<WTDIVIDER col="1" height="1" color="SYS(divider)" />
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true" />
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTRECORDSET col="1" graybar="true" entity="Note">
							<WTCOLUMN width="100" align="left" valign="top" />
							<WTROW>
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsReminder.gif)">
											<WTCONDITION expr="DATA(Note.IsReminder)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsFrozen.gif)">
											<WTCONDITION expr="DATA(Note.IsFrozen)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(IsLocked.gif)">
											<WTCONDITION expr="DATA(Note.IsLocked)" oper="not-equal" value="CONST(0)" />
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(Note.NoteDate)" space="1" fontcolor="purple" />
									<WTSTATIC label="Company">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(38)" />
										<WTLINK name="3803" class="NavBar" target="Owner">
											<WTPARAM name="CompanyID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC label="Member">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(4)" />
										<WTLINK name="0403" class="NavBar" target="Owner">
											<WTPARAM name="MemberID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC label="Affiliate">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(6)" />
										<WTLINK name="0603" class="NavBar" target="Owner">
											<WTPARAM name="AffiliateID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC label="Trainer">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(3)" />
										<WTLINK name="0303" class="NavBar" target="Owner">
											<WTPARAM name="TrainerID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC label="Prospect">
										<WTCONDITION expr="DATA(OwnerType)" oper="equal" value="CONST(81)" />
										<WTLINK name="8103" class="NavBar" target="Owner">
											<WTPARAM name="ProspectID" value="DATA(OwnerID)" />
										</WTLINK>
									</WTSTATIC>
									<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@ownerid&quot;/&gt;))" space="1" />
									<WTSTATIC value="DATA(Note.UserName)" space="1" fontcolor="blue" />
									<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='edit']&quot;/&gt;))">
										<WTCONDITION expr="IsManager" />
										<WTCONDITION expr="DATA(IsLocked)" oper="equal" value="CONST(0)" connector="or" paren="start" />
										<WTCONDITION expr="DATA(AuthUserID)" oper="equal" value="SYS(UserID)" connector="and" paren="end" />
										<WTLINK name="9003" class="NavBar" target="EditNote">
											<WTPARAM name="NoteID" value="DATA(NoteID)" />
											<WTPARAM name="Popup" value="CONST(1)" />
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTSTATIC col="1" value="DATA(Note.Notes)" />
							</WTROW>
						</WTRECORDSET>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(Count)" oper="not-equal" value="CONST(0)" />
						<WTSTATIC col="1" tag="Total" value="PARAM(Count)" bold="true" />
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0098" caption="Language Labels" navbar="false" langfile="0098" language="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="24">
			<!--=============================================================================================-->
			<WTPARAM name="File" datatype="text" />
			<WTPARAM name="Language" datatype="text" />
			<WTPARAM name="Changes" datatype="number" />
			<WTDATATXN name="Label" />
			<WTDATATXN name="EN" />
			<WTINCLUDE name="XML.asp" />

<!-- ********************************************************************************* -->
			<WTSUB name="LoadLabels">
<WTCUSTOM>
	'-----Load the english version of the specified language file
	filename = "Language\" + reqFile + "[en].xml"
	Set oMaster = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oMaster.load server.MapPath(filename)
	If oMaster.parseError &lt;&gt; 0 Then
		Response.Write "Translate Load file failed with error code " + CStr(oMaster.parseError)
		Response.End
	End If

	'-----remove the first node in the XML file
	oMaster.removeChild oMaster.firstChild

	'-----Load the specified language file
	If reqLanguage &lt;&gt; "en" Then
	
		'-----save the english version of the labels
		xmlEN = "&lt;EN&gt;" + oMaster.XML + "&lt;/EN&gt;"
	
		filename = "Language\" + reqFile + "[" + reqLanguage + "].xml"
		Set oLang = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
		oLang.load server.MapPath(filename)

		'-----If the file exists then process it, otherwise mark all labels updated
		If oLang.parseError &lt;&gt; 0 Then
			'-----mark all labels updated
			Set oLabels = oMaster.selectNodes("LANGUAGE/LABEL")
			For Each oLabel In oLabels
				oLabel.setAttribute "update", "true"
			Next
			Set oLabels = Nothing
		Else
			'-----LOAD THE LABEL CONTROL FILES TO CHECK FOR LAST TRANSLARED DATES
			'-----Load the english label control file
			filename = "Language\Translate\" + reqFile + "[en].xml"
			Set oCtrlEn = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
			oCtrlEn.load server.MapPath(filename)
			If oCtrlEn.parseError &lt;&gt; 0 Then
				Response.Write "English Label Control File failed with error code " + CStr(oCtrlEn.parseError)
				Response.End
			End If
			'-----Load the language label control file
			filename = "Language\Translate\" + reqFile + "[" + reqLanguage + "].xml"
			Set oCtrlLang = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
			oCtrlLang.load server.MapPath(filename)
		
			'-----LOOKUP EACH MASTER LABEL IN THE LANGUAGE FILE 
			'-----AND CHECK IF THE LABEL EXISTS AND IF IT NEEDS TO BE UPDATED
			Set oLabels = oMaster.selectNodes("LANGUAGE/LABEL")
			For Each oLabel In oLabels

				'---get the name of the label
				sLabel = oLabel.getAttribute("name")
				'---search for the label in the language file
				Set oItem = oLang.selectSingleNode("LANGUAGE/LABEL[@name='" + sLabel + "']")
				'-----if not found it needs to be updated, otherwise look up the translated text and control dates
				If (oItem Is Nothing) Then
					oLabel.setAttribute "update", "true"
				Else

					'---get the translated text from the language file and insert it into the master file
	            oLabel.Text = oItem.Text

					'---check the dates in the control files, to see if it has been updated
					'---if the language control file doesn't exist, mark the label updated
					If (oCtrlLang Is Nothing) Then
						oLabel.setAttribute "update", "true"
					Else
						'---search for the label in the language label control file
						Set oCtrlItem = oCtrlLang.selectSingleNode("LANGUAGE/LABEL[@name='" + sLabel + "']")
						'---if the label is not in the language control file, mark the label updated
						If (oCtrlItem Is Nothing) Then
							oLabel.setAttribute "update", "true"
						Else
							'---get the date for the label in the languale label control file 							
							sCtrlLangDate = oCtrlItem.getAttribute("date")

							'---search for the label in the english label control file
							Set oEnItem = oCtrlEn.selectSingleNode("LANGUAGE/LABEL[@name='" + sLabel + "']")
							'---if the label is not in the english control file, mark the label updated
							If (oEnItem Is Nothing) Then
								oLabel.setAttribute "update", "true"
							Else
								'---get the date for the label in the english label control file 							
								sCtrlEnDate = oEnItem.getAttribute("date")

								If IsDate(sCtrlEnDate) AND IsDate(sCtrlLangDate) Then
									'-----if language label is older than English label, it needs to be updated
									If CDate(sCtrlEnDate) &gt; CDate(sCtrlLangDate) Then
										oLabel.setAttribute "update", "true"
									End If                  
                           '---get the date the label was last updated
									oLabel.setAttribute "date", sCtrlLangDate
								Else
									oLabel.setAttribute "update", "true"
								End If
							End If
							Set oEnItem = Nothing
						End If
						Set oCtrlItem = Nothing
					End If
				End If
				Set oItem = Nothing
			Next
			Set oCtrlEn = Nothing
			Set oCtrlLang = Nothing
			Set oLabels = Nothing
		End If
		Set oLang = Nothing
	End If
	xmlLabel = oMaster.XML
	Set oMaster = Nothing
</WTCUSTOM>
			</WTSUB>
			
<!-- ********************************************************************************* -->
			<WTSUB name="SaveLabels">
<WTCUSTOM>
	'---control file name
	filename = "Language\Translate\" + reqFile + "[" + reqLanguage + "].xml"

	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	If oFileSys Is Nothing Then
		Response.Write "Scripting.FileSystemObject failed to load"
		Response.End
	End If

	'---check if control file exists, if not, create it
   If Not oFileSys.FileExists(reqSysWebDirectory + filename) Then
		SaveXMLFile reqSysWebDirectory + filename, "&lt;LANGUAGE/&gt;"
   End If

	'-----Load the language label control file
	Set oCtrl = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oCtrl.load server.MapPath(filename)

	'-----Load the current master file created by LoadLabels()
	Set oMaster = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oMaster.LoadXML xmlLabel
	If oMaster.parseError &lt;&gt; 0 Then
		Response.Write "Master Load file failed with error code " + CStr(oMaster.parseError)
		Response.End
	End If

	'-----Initialize beginning of language file, this is required for unicode
   data = "&lt;?xml version='1.0' encoding='windows-1252'?&gt;" + vbCrLf + "&lt;LANGUAGE&gt;"

	'-----Check if everything that needs to be updated is, if so update the control files
   tmpFileUpdated = True
   tmpLabelsUpdated = False

	'-----LOOKUP EACH MASTER LABEL IN THE FORM
	'-----AND CHECK IF THE LABEL WAS UPDATED (CHECKBOX)
	Set oLabels = oMaster.selectNodes("LANGUAGE/LABEL")
	Set oParent = oCtrl.selectSingleNode("LANGUAGE")
	sDate = Now
	For Each oLabel In oLabels
		sLabel = oLabel.getAttribute("name")
		tmpUpdate = oLabel.getAttribute("update")
		tmpCheck = Request.Form.Item("_" + sLabel)

      If tmpCheck = "on" Then
		   tmpLabelsUpdated = True
			oLabel.Text = Request.Form.Item(sLabel)

			'---search for the label in the control file
			Set oCtrlItem = oCtrl.selectSingleNode("LANGUAGE/LABEL[@name='" + sLabel + "']")

			'---if we found the label in the language control file, mark the label updated
			If Not (oCtrlItem Is Nothing) Then
				oCtrlItem.setAttribute "date", Now
			Else   
				'---if label not found, create it with name and date
				Set oNode = oCtrl.createElement("LABEL")
				oParent.appendChild oNode
				oNode.setAttribute "name", sLabel
				oNode.setAttribute "date", sDate
				Set oNode = Nothing
			End If
			Set oCtrlItem = Nothing
		Else
			'--- if the label needed to be updated but wasn't, then the file translation is not complete
			If tmpUpdate = "true" Then tmpFileUpdated = False
		End If	
	   data = data + vbCrLf + vbTab + "&lt;LABEL name=""" + sLabel + """&gt;" + oLabel.Text + "&lt;/LABEL&gt;"
	Next
   data = data + vbCrLf + "&lt;/LANGUAGE&gt;"

	'-----SAVE THE LANGUAGE FILE
	filename = reqSysWebDirectory + "Language\" + reqFile + "[" + reqLanguage + "].xml"
	SaveXMLFile filename, data
	
	Set oParent = Nothing
	Set oLabels = Nothing
	Set oMaster = Nothing

	'-----UPDATE THE LABEL AND LANGUAGE CONTROL FILES
	'--- if the labels were updated, then save the label control file
   If tmpLabelsUpdated = True Then
		'--- save the label control file
		filename = reqSysWebDirectory + "Language\Translate\" + reqFile + "[" + reqLanguage + "].xml"
		SaveXMLFile filename, oCtrl.XML
	End If
	Set oCtrl = Nothing
	
	'---if all labels in need of translation have been updated
	'---then update the control file with the updated date and save it
   If tmpFileUpdated = True Then
		'-----Load the language file control file
		filename = "Language\Translate\Translate[" + reqLanguage + "].xml"
		Set oCtrl = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
		oCtrl.load server.MapPath(filename)

		'---search for the filename in the control file
		Set oCtrlItem = oCtrl.selectSingleNode("PTSFILES/PTSFILE[@name='" + reqFile + "']")
		'---if the file is in the language control file, mark the file updated
		If Not (oCtrlItem Is Nothing) Then
			oCtrlItem.setAttribute "date", Now
		Else			
			'--- otherwise add the file to the language control file
			Set oItem = oCtrl.selectSingleNode("PTSFILES")
			Set oNode = oCtrl.createElement("PTSFILE")
			oItem.appendChild oNode
			oNode.setAttribute "name", reqFile
			oNode.setAttribute "date", Now
			Set oNode = Nothing
			Set oItem = Nothing
		End If
	   '--- save the language control file
		SaveXMLFile reqSysWebDirectory + filename, oCtrl.XML
		Set oCtrlItem = Nothing
		Set oCtrl = Nothing
	End If
</WTCUSTOM>
			</WTSUB>

<!-- ********************************************************************************* -->
			<WTSUB name="UpdateCtrlFile">
<WTCUSTOM>
	'-----update Language Label Control File
	mastername = "Language\" + reqFile + "[en].xml"
	ctrlname = "Language\Translate\" + reqFile + "[en].xml"

	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	If oFileSys Is Nothing Then
		Response.Write "Scripting.FileSystemObject failed to load"
		Response.End
	End If

	'---check if control file exists, if not, create it
   If Not oFileSys.FileExists(reqSysWebDirectory + ctrlname) Then
		SaveXMLFile reqSysWebDirectory + ctrlname, "&lt;LANGUAGE/&gt;"
   End If

	'---load the english label file
	Set oMaster = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oMaster.load server.MapPath(mastername)
	If oMaster.parseError &lt;&gt; 0 Then
		Response.Write "Load Master file failed with error code " + CStr(oMaster.parseError)
		Response.End
	End If

	'---load the english control file to be updated
	Set oCtrl = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oCtrl.load server.MapPath(ctrlname)
	If oCtrl.parseError &lt;&gt; 0 Then
		Response.Write "Load Control file failed with error code " + CStr(oCtrl.parseError)
		Response.End
	End If

	tmpFileUpdated = False
   Set oLabels = oMaster.selectNodes("LANGUAGE/LABEL")
	Set oParent = oCtrl.selectSingleNode("LANGUAGE")
	sDate = Now
   For Each oLabel In oLabels
      With oLabel
         sName = .getAttribute("name")
			'---check if the filename exists in the control file
			Set oItem = oCtrl.selectSingleNode("LANGUAGE/LABEL[@name='" + sName + "']")
			'---if the label doesn't exists, add it
			If (oItem Is Nothing) Then
				tmpFileUpdated = True
				Set oNode = oCtrl.createElement("LABEL")
				oParent.appendChild oNode
				oNode.setAttribute "name", sName
				oNode.setAttribute "date", sDate
				Set oNode = Nothing
			End If
	      Set oItem = Nothing
      End With
   Next
	Set oParent = Nothing
   Set oLabels = Nothing

	'---If changes were made to the control file, save it
	If tmpFileUpdated = True Then SaveXMLFile reqSysWebDirectory + ctrlname, oCtrl.XML

	Set oCtrl = Nothing
	Set oMaster = Nothing
   Set oFileSys = Nothing
</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<!-- Update the English Language Control File with the actual labels -->
				<WTCALLSUB name="UpdateCtrlFile"/>
				<WTCALLSUB name="LoadLabels"/>
			</WTACTION>
			
			<WTACTION id="3" name="Update" type="Update">
				<WTCALLSUB name="LoadLabels"/>
				<WTCALLSUB name="SaveLabels"/>
				<!-- Reload Labels with updated data and dates -->
				<WTCALLSUB name="LoadLabels"/>
			</WTACTION>
			
			<WTACTION id="4" name="ShowChanges" type="Update">
				<WTSETATTRIBUTE name="PARAM(Changes)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLabels"/>
				<WTCALLSUB name="SaveLabels"/>
				<!-- Reload Labels with updated data and dates -->
				<WTCALLSUB name="LoadLabels"/>
			</WTACTION>
			
			<WTACTION id="5" name="ShowAll" type="Update">
				<WTSETATTRIBUTE name="PARAM(Changes)" value="CONST(0)"/>
				<WTCALLSUB name="LoadLabels"/>
				<WTCALLSUB name="SaveLabels"/>
				<!-- Reload Labels with updated data and dates -->
				<WTCALLSUB name="LoadLabels"/>
			</WTACTION>
			
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTSTATIC label="Changes" />
				<WTROW margin-top="3">
					<WTSTATIC col="1" align="left" tag="LanguageLabels" class="PageHeading" space="3">
						<WTSTATIC value="PARAM(File)" />
						<WTSTATIC value="CONST( - )" />
						<WTSTATIC value="PARAM(Language)" />
					</WTSTATIC>
					<WTBUTTON col="1" action="3" value="CONST(Update)"/>
					<WTBUTTON col="1" action="4" value="CONST(ShowChanges)">
						<WTCONDITION expr="PARAM(Changes)" oper="equal" value="CONST(0)" />
						<WTCONDITION expr="PARAM(Language)" oper="not-equal" value="CONST('en')" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="5" value="CONST(ShowAll)">
						<WTCONDITION expr="PARAM(Changes)" oper="not-equal" value="CONST(0)" />
						<WTCONDITION expr="PARAM(Language)" oper="not-equal" value="CONST('en')" connector="and"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
					<WTSTATIC col="1" class="PageHeading">
						<WTCONDITION expr="PARAM(Language)" oper="not-equal" value="CONST('en')" />
						<WTSTATIC space="3"/>
						<WTSTATIC label="GoogleTranslate"/>
	 					<WTLINK name="CONST(http://translate.google.com)" return="false" type="Anchor" target="GoogleTranslate"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="3" margin-bottom="6">
					<WTDIVIDER col="1" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				
				<WTREPEAT xpath="DATA/TXN/LANGUAGE/LABEL">
				
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Changes)" oper="equal" value="CONST(0)" />
						<WTCONDITION expr="CONST(@up)" value="CONST(date)" connector="or"/>
						<WTROW>
							<WTCHECK col="1" name="&lt;xsl:value-of select=&quot;concat('_',@name)&quot;/&gt;" check="false"/>
							<WTSTATIC col="1" value="DATA(Name)" space="1" fontcolor="blue" bold="true" prespace="false"/>
							<WTSTATIC col="1" value="DATA(Date)" fontcolor="purple" bold="true">
								<WTCONDITION expr="CONST(@up)" value="CONST(date)"/>
							</WTSTATIC>
							<WTSTATIC col="1" value="DATA(Date)" fontcolor="purple">
								<WTCONDITION expr="CONST(not(@up)" value="CONST(date))"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="PARAM(Language)" oper="not-equal" value="CONST('en')"/>
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/EN/LANGUAGE/LABEL[@name=current()/@name]/.&quot;/&gt;)" fontcolor="gray"/>
						</WTROW>
						<WTVARIABLE name="data" value="CONST(&lt;xsl:value-of select=&quot;string-length(.)&quot;/&gt;)"/>
						<WTROW>
							<WTCONDITION expr="CONST($data)" oper="less" value="CONST(80)" />
							<WTMEMO col="1" name="&lt;xsl:value-of select=&quot;@name&quot;/&gt;" value="CONST(.)" cols="90" rows="1">
								<WTKEY>document.getElementById('_' + this.name).checked = 'on';</WTKEY>
							</WTMEMO>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST($data)" oper="greater-equal" value="CONST(80)" />
							<WTCONDITION expr="CONST($data)" oper="less-equal" value="CONST(160)" connector="and"/>
							<WTMEMO col="1" name="&lt;xsl:value-of select=&quot;@name&quot;/&gt;" value="CONST(.)" cols="90" rows="2">
								<WTKEY>document.getElementById('_' + this.name).checked = 'on';</WTKEY>
							</WTMEMO>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="CONST($data)" oper="greater" value="CONST(160)" />
							<WTMEMO col="1" name="&lt;xsl:value-of select=&quot;@name&quot;/&gt;" value="CONST(.)" cols="90" rows="4">
								<WTKEY>document.getElementById('_' + this.name).checked = 'on';</WTKEY>
							</WTMEMO>
						</WTROW>
					</WTCODEGROUP>

				</WTREPEAT>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="0099" caption="Language Manager" navbar="false" langfile="0099" language="false"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" secured="24">
			<!--=============================================================================================-->
			<WTPARAM name="Language" datatype="text" />
			<WTPARAM name="Changes" datatype="number" />
			<WTDATATXN name="Lang" />
			<WTDATATXN name="File" />
			<WTINCLUDE name="XML.asp" />
			
<!-- ********************************************************************************* -->
			<WTSUB name="LoadLanguages">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpLanguages)" value="ATTR(Languages)" />
<WTCUSTOM>
	xmlLang = "&lt;PTSLANG&gt;"
	aLanguages = Split( tmpLanguages, ";" )
	total = UBOUND(aLanguages)
	For x = 0 to total
		aLanguage = split(aLanguages(x), ",")
		id = aLanguage(0)
		name = aLanguage(1)
		'Only the system administrator can edit the English (Master) Language Labels
		If (id &lt;&gt; "en") or (reqSysUserGroup=1) Then
			xmlLang = xmlLang + "&lt;ENUM id=""" + id + """ name=""" + name + """"
			If id = reqLanguage Then xmlLang = xmlLang + " selected=""true"""
			xmlLang = xmlLang + "/&gt;"
		End If
	Next
	xmlLang = xmlLang + "&lt;/PTSLANG&gt;"
</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>
			
<!-- ********************************************************************************* -->
			<WTSUB name="LoadFiles">
<WTCUSTOM>
	filename = "Language\Translate\Translate[en].xml"
	Set oMaster = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oMaster.load server.MapPath(filename)
	If oMaster.parseError &lt;&gt; 0 Then
		Response.Write "Translate Load file failed with error code " + CStr(oMaster.parseError)
		Response.End
	End If

	If reqLanguage &lt;&gt; "en" Then
		filename = "Language\Translate\Translate[" + reqLanguage + "].xml"
		Set oLang = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
		oLang.load server.MapPath(filename)
		If oLang.parseError &lt;&gt; 0 Then
			Response.Write "Translate Load file failed with error code " + CStr(oLang.parseError)
			Response.End
		End If
		' LOOKUP EACH FILE IN THE LANGUAGE FILE AND CHECK IF THE FILE EXISTS AND IF IT NEEDS TO BE UPDATED
      Set oLabels = oMaster.selectNodes("PTSFILES/PTSFILE")
      For Each oLabel In oLabels
         With oLabel
            sName = .getAttribute("name")
            sDate = .getAttribute("date")
            Set oItem = oLang.selectSingleNode("PTSFILES/PTSFILE[@name='" + sName + "']")
            '-----if found, look up date, otherwise it needs to be updated
            If (oItem Is Nothing) Then
               .setAttribute "update", "true"
            Else
	            sLangDate = oItem.getAttribute("date")
               If IsDate(sDate) AND IsDate(sLangDate) Then
	               .setAttribute "langdate", sLangDate
		            '-----if language file is older than English File, it needs to be updated
						If CDate(sDate) &gt; CDate(sLangDate) Then
		               .setAttribute "update", "true"
						End If                  
               Else
	               .setAttribute "update", "true"
               End If
            End If
            Set oItem = Nothing
         End With
      Next
      Set oLabels = Nothing
		Set oLang = Nothing
	End If
	xmlFile = oMaster.XML
	Set oMaster = Nothing
</WTCUSTOM>
			</WTSUB>

<!-- ********************************************************************************* -->
			<WTSUB name="UpdateCtrlFile">
<WTCUSTOM>
	'-----update English Language Control File
	filename = "Language\Translate\Translate[en].xml"

	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	If oFileSys Is Nothing Then
		Response.Write "Scripting.FileSystemObject failed to load"
		Response.End
	End If

	'---check if file exists, if not, create it
   If Not oFileSys.FileExists(reqSysWebDirectory + filename) Then
		SaveXMLFile reqSysWebDirectory + filename, "&lt;PTSFILES/&gt;"
   End If

	'---load list of english control files
	Set oMaster = server.CreateObject("MSXML2.FreeThreadedDOMDocument")
	oMaster.load server.MapPath(filename)
	If oMaster.parseError &lt;&gt; 0 Then
		Response.Write "Translate Load file failed with error code " + CStr(oMaster.parseError)
		Response.End
	End If

	'---get list of english files [en] from the directory
   Set Folder = oFileSys.GetFolder(reqSysWebDirectory + "Language")
   Set Files = Folder.Files
	Set oParent = oMaster.selectSingleNode("PTSFILES")

	'---walk through list of english files to update the control file list
   For Each File In Files
      sName = File.Name
		pos = InStr( sName, "[en]" )
		If pos &gt; 0 Then
			sName = Left( sName, pos-1 )
			sDate = File.DateLastModified
			'---check if the filename exists in the control file
			Set oItem = oMaster.selectSingleNode("PTSFILES/PTSFILE[@name='" + sName + "']")
			'---if the filename exists, update the file date
			If Not (oItem Is Nothing) Then
				oItem.setAttribute "date", sDate
			Else	
				'---if the filename doesn't exist, add it with the file date
				Set oNode = oMaster.createElement("PTSFILE")
				oParent.appendChild oNode
				oNode.setAttribute "name", sName
				oNode.setAttribute "date", sDate
				Set oNode = Nothing
			End If
	      Set oItem = Nothing
		End If
   Next
   Set oParent = Nothing
   Set Files = Nothing
   Set Folder = Nothing

	'---walk through list of files in the control file to remove unused files
   Set oParent = oMaster.selectSingleNode("PTSFILES")
   Set oLabels = oMaster.selectNodes("PTSFILES/PTSFILE")
   For Each oLabel In oLabels
      With oLabel
         sName = .getAttribute("name")
			sFile = "Language\" + sName + "[en].xml"
			'---check if the filename exists in the directory
			If Not oFileSys.FileExists(reqSysWebDirectory + sFile) Then
				'---if the filename doesn't exist, remove it from the control file
            oParent.removeChild oLabel
			End If
      End With
   Next
   Set oLabels = Nothing
   Set oParent = Nothing

	'---save the control file
	SaveXMLFile reqSysWebDirectory + filename, oMaster.XML

	Set oMaster = Nothing
   Set oFileSys = Nothing
</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Changes)" value="CONST(0)"/>
				<WTCALLSUB name="LoadLanguages"/>
				<WTCALLSUB name="UpdateCtrlFile"/>
			</WTACTION>

			<WTACTION id="5" name="Go" type="Update">
				<WTCALLSUB name="LoadLanguages"/>
				<WTCALLSUB name="LoadFiles"/>
			</WTACTION>
			
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left" />
				<WTCOLUMN width="450" align="left" />
				<WTCOLUMN width="150" align="left" />
				<WTSTATIC label="Changes" />

				<WTROW margin-top="3" margin-bottom="3">
					<WTTABLE col="1" merge="3">
						<WTCOLUMN width="375" align="left"/>
						<WTCOLUMN width="375" align="right"/>
						<WTROW>
							<WTSTATIC col="1" label="LanguageManager" class="PageHeading"/>
							<WTSTATIC col="2" label="CustomPages" class="PageHeading">
								<WTLINK name="9199" return="false" target="LanguageManagerPages"/>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" label="LanguageManagerText" align="left" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" tag="Language" class="ColumnHeader" align="center" />
					<WTCOMBO col="1" merge="3" name="Language" datapath="DATA/TXN/PTSLANG/ENUM" />
					<WTBUTTON col="1" merge="3" action="5" value="CONST(Go)" default="true" />
					<WTCHECK col="1" merge="3" value="PARAM(Changes)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="3" height="1" color="SYS(divider)" />
				</WTROW>
				<WTROW>
					<WTCONDITION expr="CONST(count(DATA/TXN/PTSFILES/PTSFILE))" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" />
					<WTRECORDSET col="2" graybar="true" entity="File">
						<WTCOLUMN width="30" align="left" valign="top" label="File" />
						<WTCOLUMN width="35" align="center" valign="top" label="English" />
						<WTCOLUMN width="35" align="center" valign="top" label="Language" />
						<WTROW>
							<WTCONDITION expr="CONST(@)" value="CONST(update)" />
							<WTSTATIC col="1" value="DATA(Name)" bold="true">
								<WTLINK name="0098" target="blank">
									<WTPARAM name="File" value="DATA(Name)" />
									<WTPARAM name="Language" value="PARAM(Language)" />
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Date)" bold="true" />
							<WTSTATIC col="3" value="DATA(Langdate)" bold="true" />
						</WTROW>
						<WTROW>
							<WTCONDITION expr="PARAM(Language)" oper="equal" value="CONST('en')" />
							<WTCONDITION expr="CONST(not(@)" value="CONST(update))" connector="or" paren="start" />
							<WTCONDITION expr="PARAM(Changes)" oper="equal" value="CONST(0)" connector="and" paren="end" />
							<WTSTATIC col="1" value="DATA(Name)">
								<WTLINK name="0098" target="blank">
									<WTPARAM name="File" value="DATA(Name)" />
									<WTPARAM name="Language" value="PARAM(Language)" />
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Date)" />
							<WTSTATIC col="3" value="DATA(Langdate)" />
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				<WTROW margin-bottom="12"/>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================================================-->
		<WTWEBPAGE name="0037" type="mail" aspstyle="GenerateWebASPMail.xsl" xslstyle="GenerateWebXSLMail.xsl" langfile="0037">
		<!--==================================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="Billing" datatype="number"/>
			<WTPARAM name="MailReturnURL" datatype="text" url="true"/>		<!--Required Parameter for Mail-->

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Business" project="ptsBusinessUser" class="CBusiness">
					<WTMETHOD name="Load">
						<WTPARAM name="BusinessID" direction="input" value="CONST(1)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBusiness" direction="return" datatype="text"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Business.SystemEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Business.SystemEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.FinanceEmail)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Member Billing Updated: &quot; + .NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot; )">
						<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="CONST(tmpSubject)" value="CONST(&quot;Member Payout Updated: &quot; + .NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot; )">
						<WTCONDITION expr="PARAM(Billing)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>

				<WTMAIL from="tmpFrom" to="tmpTo" subject="tmpSubject" sender="tmpSender" msgto="tmpMsgTo"/>
			   
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT/>
		</WTWEBPAGE>

		<!-- Custom New Member Enrollment Form -->
		<!--============================================================================================-->
		<WTWEBPAGE name="Enroll" caption="New Member" navbar="false" header="false" footer="false" stylesheet="StyleSheetJoin.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="Enroll">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="NewMemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="OrderOption" datatype="number"/>
			<WTPARAM name="Retail" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Billing" datatype="number"/>
			<WTPARAM name="BillDay" datatype="number"/>
      <WTPARAM name="Reference" datatype="text" />

      <WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="NoBanner" datatype="number"/>
			<WTPARAM name="NoPayment" datatype="number"/>
			<WTPARAM name="NoRefer" datatype="number"/>
			<WTPARAM name="NoValidate" datatype="number"/>
			<WTPARAM name="TextEmail" datatype="number"/>
			<WTPARAM name="NoPayout" datatype="number"/>
			<WTPARAM name="GetMemberID" datatype="number"/>
			<WTPARAM name="BillOneTime" datatype="number"/>
			<WTPARAM name="AutoShipMonths" datatype="number"/>
			<WTPARAM name="RegisterWallet" datatype="number"/>

			<!-- Referring Member -->
			<WTPARAM name="M" datatype="number"/>
			<!-- Sponsor -->
			<WTPARAM name="S" datatype="number"/>
			<!-- CompanyID -->
			<WTPARAM name="C" datatype="number"/>
			<!-- Sponsor3ID (Binary) -->
			<WTPARAM name="S3" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="Placement" datatype="text"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>
			<WTPARAM name="CountryID" datatype="text"/>
			<WTPARAM name="CountryName" datatype="text"/>
			<WTPARAM name="CountryNameb" datatype="text"/>

			<WTPARAM name="TokenType" datatype="number"/>
			<WTPARAM name="TokenOwner" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="BadPayment" datatype="number"/>
			<WTPARAM name="CashPayment" datatype="number"/>
			<WTPARAM name="Wallet" datatype="text"/>
			<WTPARAM name="NotifyCompany" datatype="text"/>
			<WTPARAM name="IsCaptcha" datatype="number"/>
      <WTPARAM name="Captcha" datatype="text"/>

      <!--2Konnect Paramaters-->
      <WTPARAM name="xSponsorID" datatype="text"/>
      <WTPARAM name="FirstName" datatype="text"/>
      <WTPARAM name="LastName" datatype="text"/>
      <WTPARAM name="UserName" datatype="text"/>
      <WTPARAM name="EmailAddress" datatype="text"/>
      
<!--      <WTPARAM name="xID" datatype="text"/>-->

      <!-- Mode 0 ... Agreement -->
			<!-- Mode 1 ... Contact Info -->
			<!-- Mode 2 ... Membership Selection -->
			<!-- Mode 3 ... Payment -->
			<!-- Mode 4 ... Confirmation -->
			<!-- Mode 5 ... Process/Welcome -->

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="iPayout.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
<!--			<WTINCLUDE name="btc.asp"/>-->

      <WTCODEGROUP>
        <!-- SilverHeart 2Konnect Referral -->
<!--
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(20)"/>
          <WTSETATTRIBUTE name="PARAM(MemberID)" value="CONST(24573)"/>
        </WTCODEGROUP>
-->
        <!-- Nexxus Binary Add -->        
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(C)" oper="equal" value="SYSCON(NEXXUS)" />
          <WTRETURN>
            <WTLINK name="Register" return="false">
              <WTPARAM name="C" value="PARAM(C)"/>
              <WTPARAM name="M" value="PARAM(M)"/>
              <WTPARAM name="S3" value="PARAM(S3)"/>
              <WTPARAM name="Pos" value="PARAM(Pos)"/>
            </WTLINK>
          </WTRETURN>
        </WTCODEGROUP>
        
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
          <WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" datatype="number"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MemberID)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
<!--
				<WTSETATTRIBUTE name="PARAM(S)" value="PARAM(M)">
					<WTCONDITION expr="PARAM(S)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
-->
				<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)">
					<WTCONDITION expr="PARAM(CountryIDb)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(&quot;No Referrer&quot;)">
					<WTCONDITION expr="PARAM(NoRefer)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="CONST(ValidMemberStatus)" value="CONST(&quot;1234&quot;)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<!-- Validate that Sponsor3ID is under ReferralID -->
				<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)" />
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(206)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(S3)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(M)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(Result)" oper="not-equal" value="PARAM(M)" />
					<WTCUSTOM>
						Response.write "Invalid Enroller for this Binary Placement."
						Response.end
					</WTCUSTOM>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="SYS(ActionCode)" oper="greater-equal" value="CONST(1)"/>
				<WTCONDITION expr="SYS(ActionCode)" oper="less-equal" value="CONST(4)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree)" value="FORM(IsAgree)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree2)" value="FORM(IsAgree2)"/>
				<WTCALLSUB name="LoadMember"/>
			</WTCODEGROUP>

			<!-- Custom Company Setup -->
			<WTCODEGROUP>
				<!-- myTrackerPro -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
        <!-- SET NO BILLING FOR ALL TRACKER MEMBERS -->
        <WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(TextEmail)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(NoPayout)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
						<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(3)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>

				<!-- set the nobill option for WV people -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
					<WTCODEGROUP>
						<!-- 6528 Jefferson Santos -->
						<!-- 9096 David & Yvette Ulloa -->
						<!-- 9399 Jeff Johnston -->
						<!-- 9401 Scott Ross -->
						<!-- 9887 The Twins -->
						<!-- 11555 Byron Schrug -->
						<WTCONDITION expr="CONST(InStr( &quot;6528,9096,9399,9401,9887,11555&quot;, CStr(reqGroupID) ))" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<!-- Life Time -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(8)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
<!--
				<WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(NoBanner)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(NoPayment)" value="CONST(1)"/>
-->
				<WTSETATTRIBUTE name="PARAM(GetMemberID)" value="CONST(1)"/>
<!--				<WTSETATTRIBUTE name="PARAM(BillOneTime)" value="CONST(1)"/>-->
				<WTSETATTRIBUTE name="PARAM(NotifyCompany)" value="CONST(&quot;1&quot;)"/>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<!-- PB -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Retail)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(BillDay)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCUSTOM>
						day = DATEPART( "d", DATE())
						If day &gt;= 15 Then reqBillDay = 1 Else reqBillDay = 15
					</WTCUSTOM>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Retail)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Retail)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(NoPayout)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(0)">
						<WTCONDITION expr="IsMemberOnly"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(5)">
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<!-- Legacy Max -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(14)"/>
				<WTSETATTRIBUTE name="PARAM(BillOneTime)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(TextEmail)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(RegisterWallet)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(3)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(OrderOption)" value="CONST(1)">
					<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<!-- CIS -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
				<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(AutoShipMonths)" value="CONST(12)"/>
				<WTSETATTRIBUTE name="PARAM(BillOneTime)" value="CONST(2)"/>
				<WTSETATTRIBUTE name="PARAM(RegisterWallet)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(7)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<!-- PeopleEdge -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(16)"/>
				<WTSETATTRIBUTE name="PARAM(NoPayout)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(NoRefer)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(0)"/>
        <WTSETATTRIBUTE name="PARAM(BillOneTime)" value="CONST(1)"/>
        <WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)">
          <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
        </WTSETATTRIBUTE>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
        </WTOBJECT>
      </WTCODEGROUP>
			<WTCODEGROUP>
				<!-- GCR -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
        <WTCUSTOM>response.end</WTCUSTOM>
<!--        <WTSETATTRIBUTE name="PARAM(IsCaptcha)" value="CONST(1)"/>-->
<!--        <WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)"/>-->
        <WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(14)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(5)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<!-- Free Loyalty -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>
      <WTCODEGROUP>
        <!-- TellAllMobile -->
        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(19)"/>
        <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
          <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <!-- Silver Heart -->
        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
        <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
          <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>
      <WTCODEGROUP>
        <!-- Nexxus -->
        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
        <WTCUSTOM>response.end</WTCUSTOM>
        <WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
          <WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
          <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
      </WTCODEGROUP>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadPaymentOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadAgree">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Enroll.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
          <!-- SilverHeart 2Konnect Referral -->
<!--
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
            <WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
            <WTMETHOD name="RefRef">
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="Reference" direction="input" value="PARAM(xSponsorID)"/>
              <WTPARAM name="ReferID" direction="return" datatype="number"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="PARAM(ReferID)" value="CONST(ReferID)">
              <WTCONDITION expr="CONST(ReferID)" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>
-->          
          <WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="ATTR(CompanyName)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCUSTOM>
						If InStr( ValidMemberStatus, .Status ) = 0 Then
						Response.Write "The Member that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
						Response.End
						End If
					</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(S3)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(TRIM(.NameFirst + &quot; &quot; + .NameLast))"/>
						<WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(reqPlacement + &quot; (Left Side)&quot;)">
							<WTCONDITION expr="PARAM(Pos)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(reqPlacement + &quot; (Right Side)&quot;)">
							<WTCONDITION expr="PARAM(Pos)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon/Website Name is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10006" message="Oops, Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

        <WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(14)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
				</WTSETATTRIBUTE>

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<WTSETATTRIBUTE name="CONST(reqPayType)" value="CONST(CLng(result))" />
						<!-- <WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
<!--					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>-->
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="greater-equal" value="SYSCON(PAYTYPE-WALLET)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Wallet)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="AddMember">
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPrice1)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice2)" value="ATTR(Price2)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice3)" value="ATTR(Price3)"/>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
					<WTCUSTOM>EmailBonuses = InStr(.Shopping, "N")</WTCUSTOM>
				</WTOBJECT>
				<!-- Create Payout Record -->
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(NoPayout)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Set Paper Check -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LIFETIME)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-CHECK)"/>
					</WTCODEGROUP>
-->
					<!-- Set eWallet -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-SOLIDTRUST)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="CONST(&quot;&quot;)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LIFETIME)" connector="or"/>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(FREELOYALTY)" connector="or"/>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)" connector="or"/>
            <WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-PAYQUICKER)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Email)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(TELLALLMOBILE)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
<!--						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-VERDEMOBILE)"/>-->
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Email)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(COOPINCOME)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-CHECK)"/>
<!--						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/> -->
<!--						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-IPAYOUT)"/> -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(RegisterWallet)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(tmpUserName)" value="FORM(NewLogon)" />
							<WTSETATTRIBUTE name="CONST(tmpFirstName)" value="FORM(NameFirst)" />
							<WTSETATTRIBUTE name="CONST(tmpLastName)" value="FORM(NameLast)" />
							<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(tmpWalletType)" oper="equal" value="CONST(11)"/>
								<WTCUSTOM>
									result = iPayout_RegisterUser( tmpWalletAcct, tmpUserName, tmpFirstName, tmpLastName, tmpEmail )
									If result = "" Then .CardName = tmpUserName
								</WTCUSTOM>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(LEGACYMAX)"/>
						<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="CONST(tmpPayQuicker)" value="CONST(PayQuickerCountry( tmpCountryID ))"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayQuicker)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-PAYQUICKER)"/>
							<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Email)" />
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayQuicker)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-IPAYOUT)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(RegisterWallet)" oper="not-equal" value="CONST(0)"/>
								<WTSETATTRIBUTE name="CONST(tmpUserName)" value="FORM(NewLogon)" />
								<WTSETATTRIBUTE name="CONST(tmpFirstName)" value="FORM(NameFirst)" />
								<WTSETATTRIBUTE name="CONST(tmpLastName)" value="FORM(NameLast)" />
								<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(InStr(tmpWalletType,&quot;11&quot;))" oper="not-equal" value="CONST(0)"/>
									<WTCONDITION expr="CONST(tmpWalletAcct)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
									<WTCUSTOM>
										result = iPayout_RegisterUser( tmpWalletAcct, tmpUserName, tmpFirstName, tmpLastName, tmpEmail )
										If result = "" Then .CardName = tmpUserName
									</WTCUSTOM>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					<WTMETHOD name="Save">
						<WTCONDITION expr="PARAM(PayID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Add">
						<WTCONDITION expr="PARAM(PayID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqPayID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- get referrer's group # -->
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
<!--
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
            <WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
            <WTMETHOD name="RefRef">
              <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
              <WTPARAM name="Reference" direction="input" value="PARAM(xSponsorID)"/>
              <WTPARAM name="ReferID" direction="return" datatype="number"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="PARAM(ReferID)" value="CONST(ReferID)">
              <WTCONDITION expr="CONST(ReferID)" oper="not-equal" value="CONST(0)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>
-->          
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
					<WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email2)"/>
					<WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email)">
						<WTCONDITION expr="CONST(InStr(ReferEmail, &quot;@&quot;))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(CompanyEmail)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="PARAM(NotifyCompany)" value="ATTR(Email)">
						<WTCONDITION expr="PARAM(NotifyCompany)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>

					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)">
						<WTCONDITION expr="PARAM(BillDay)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
						<WTCUSTOM>
							mo = DATEPART( "m", DATE())
							yr = DATEPART( "yyyy", DATE())
							If reqBillDay = 1 Then
								tmpDate = CSTR(mo) + "/1/" + CSTR(yr)
								.PaidDate = DateAdd( "m", 1, tmpDate )
							Else
								.PaidDate = CSTR(mo) + "/" + CSTR(reqBillDay) + "/" + CSTR(yr)
							End If
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;Enrollment&quot;)"/>

					<!-- Custom Company Setup -->
					<WTCODEGROUP>
						<!-- myTrackerPro -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(30)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
						<WTCODEGROUP>
							<!-- myTrackerPro Basic Membership -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(4.95)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- myTrackerPro Leader Membership -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(9.95)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- WV Free Memberships -->
							<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Life Time -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(8)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(307)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(455)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(175)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;162&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(256)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;244&quot;)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(25)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(0)"/>
<!--						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DateAdd(&quot;m&quot;,1,reqSysDate))"/>-->
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<!-- Legacy Max -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(14)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
<!--
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(3)"/>
						</WTCODEGROUP>
-->
						<!-- Set Autoship options -->
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Membership)" oper="greater-equal" value="CONST(4)"/>
							<WTCODEGROUP>
								<!-- Monthly Autoship -->
								<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(1)"/>
								<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;113&quot;)"/>
								<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(25.95)"/>
								<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(30.95)">
									<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
								</WTSETATTRIBUTE>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<!-- Quarterly Autoship -->
								<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(2)"/>
								<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;114&quot;)"/>
								<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(66.85)"/>
								<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(71.85)">
									<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
								</WTSETATTRIBUTE>
							</WTCODEGROUP>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<!-- Preferred Customer -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;111&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(29.95)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(36.95)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(Price)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;111&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Test Drive Affiliate -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Affiliate -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(39.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Silver Pack -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,104,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(65.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(70.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103,104&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Gold Pack -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,105,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(136.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(143.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103,105&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Diamond Pack #1 -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,106,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(268.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(279.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103,106&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Diamond Pack #2 -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(7)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,107,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(266.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(273.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103,107&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Diamond Pack #3 -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(8)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,108,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(266.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(273.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103,108&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Truck Diamond Pack -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(9)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,109,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(339.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(345.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103,109&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Auto Diamond Pack -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(10)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,110,&quot; + tmpCode)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(339.90)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(345.90)">
								<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
							</WTSETATTRIBUTE>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103,110&quot;)"/>
						</WTCODEGROUP>
						<!-- Temporarily turn off payment processing-->
						<!-- <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>-->
						<!-- <WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(0)"/>-->
					</WTCODEGROUP>
					
					<WTCODEGROUP>
						<!-- CIS -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTCODEGROUP>
							<!-- Affiliate -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;101&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(44.00)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(44.00)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="ATTR(Options2)"/>
						<!-- Cash Payment -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="CONST(7)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- PeopleEdge -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(16)"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;100&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(24.95)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;Profile&quot;)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
              <WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
					<WTCODEGROUP>
					<!-- GCR -->
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(17)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
<!--						<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;IPL:3&quot;)"/>-->
						<WTCODEGROUP>
							<!-- Member -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Bronze -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,203&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(69.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(69.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Silver -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;104,204&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;104&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(149.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(149.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Gold -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;105,205&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;105&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(299.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(299.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Prospector -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(7)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;107,207&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;107&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(999.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(999.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Claim Staker -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(8)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;108,208&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;108&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(2999.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(2999.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Free Loyalty -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTCODEGROUP>
							<!-- Marketing System -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102,201&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(19.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(199.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Account Manager -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(199.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Free Affiliate -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- TellAllMobile -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(19)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTCODEGROUP>
							<!-- Affiliate -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;201,211&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;201&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(14.99)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(24.99)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>

         	<!-- SILVER HEART -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>

            <WTCODEGROUP>
              <!-- Member 101 -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;101&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;101&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(41)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Member 102 -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(49)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(54)">
                <WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Member 103 -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(45)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(50)">
                <WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Member 104 -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;104&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;104&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(46)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(51)">
                <WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(224)"/>
              </WTSETATTRIBUTE>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <!-- NEXXUS-->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
            <WTCODEGROUP>
              <!-- Bronze -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(3)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;101&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;101&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(9.95)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(9.95)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(10.95)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Silver -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(4)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(24.95)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(24.95)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(25.95)"/>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Gold -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
              <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(5)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(49.95)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(49.95)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(51.95)"/>
            </WTCODEGROUP>
          </WTCODEGROUP>

          <WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
						<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
						<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="PARAM(Billing)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(1)">
								<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
						<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
							<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
						<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;BCDEFI&quot;)"/>

						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(S)"/>

            <WTCODEGROUP>
              <!-- Silver Heart - 2Konnect Initialization -->
<!--              
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
              <WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
              <WTSETATTRIBUTE name="ATTR(Referral)" value="PARAM(xSponsorID)"/>
              <WTSETATTRIBUTE name="ATTR(Reference)" value="PARAM(xID)"/>
-->              
            </WTCODEGROUP>

            <WTCODEGROUP>
							<WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(S)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Sponsor3ID)" value="PARAM(S3)"/>
							<WTSETATTRIBUTE name="ATTR(Pos)" value="PARAM(Pos)"/>
						</WTCODEGROUP>

						<WTMETHOD name="Add">
							<WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>

					<!-- Get Payment -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
						<!-- Payment Post Processing is done after the new member is activated below -->
						<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
						<WTCUSTOM>
							tmpProcessor = 0
							tmpAcct = ""
							Select Case reqPayType
							Case 1, 2, 3, 4	'Process Credit Cards
								tmpProcessor = tmpCardProcessor
								tmpAcct = tmpCardAcct
							Case 5 'Process Electronic Checks
								tmpProcessor = tmpCheckProcessor
								tmpAcct = tmpCheckAcct
							Case 11, 12, 13 'Process Wallets
								tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
							End Select
						</WTCUSTOM>
						<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqNewMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
							<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(BillOneTime)" oper="not-equal" value="CONST(1)"/>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))">
									<WTCONDITION expr="PARAM(AutoShipMonths)" oper="equal" value="CONST(0)"/>
								</WTSETATTRIBUTE>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, reqAutoShipMonths, .PaidDate))">
									<WTCONDITION expr="PARAM(AutoShipMonths)" oper="not-equal" value="CONST(0)"/>
								</WTSETATTRIBUTE>
								<WTMETHOD name="Save">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
							oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Send BitCoin Payment Request -->
<!--          
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)" connector="and"/>
						<WTCONDITION expr="CONST(PaymentID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>
							result = SendBitCoinRequest( reqCompanyID, .Email, Purpose, BillingPrice, PaymentID )
						</WTCUSTOM>
					</WTCODEGROUP>
-->
					<!-- Create GCR Coin Wallet -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)" connector="and"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
								Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
              Else
              tmpURL = "GCRWalletCreate.asp?M=" + CStr(reqNewMemberID)
								oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + tmpURL
								oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>

					  <!-- Send notice to Referrer -->
            <WTCODEGROUP>
						  <WTCONDITION expr="CONST(ReferEmail)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						  <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						  <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						  <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
						  <WTCUSTOM>
							  tmpSubject = "NEW REFERRED MEMBER: " + tmpNameFirst + " " + tmpNameLast + " - " + tmpEmail
							  tmpBody = ""
							  SendEmail reqCompanyID, CompanyEmail, CompanyEmail, ReferEmail, "", "", tmpSubject, tmpBody
						  </WTCUSTOM>
					  </WTCODEGROUP>

            <!-- Send confirmation to 2Konnect -->
<!--
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)" connector="and"/>
              <WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
						  <WTCUSTOM>
							  Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							  If oHTTP Is Nothing Then
								  Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							  Else
                  tmpPartnerID = "1234567890"
								  oHTTP.open "GET", "http://www.skonnect.net:8080/service/[SVC-NAME].aspx?PartnerID" + tmpPartnerID + "&amp;xID=" + reqxID + "&amp;PXUserID=" + CSTR(reqNewMemberID)
								  oHTTP.send
							  End If
							  Set oHTTP = Nothing
						  </WTCUSTOM>
            </WTCODEGROUP>
-->
          <!-- Send notice to Company -->
					  <WTCODEGROUP>
						  <WTCONDITION expr="PARAM(NotifyCompany)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						  <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						  <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						  <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
						  <WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)" />
						  <WTSETATTRIBUTE name="CONST(tmpStreet1)" value="FORM(Street1)" />
						  <WTSETATTRIBUTE name="CONST(tmpStreet2)" value="FORM(Street2)" />
						  <WTSETATTRIBUTE name="CONST(tmpCity)" value="FORM(City)" />
						  <WTSETATTRIBUTE name="CONST(tmpState)" value="FORM(State)" />
						  <WTSETATTRIBUTE name="CONST(tmpZip)" value="FORM(Zip)" />
						  <WTCUSTOM>
							  tmpSubject = "NEW MEMBER: " + tmpNameFirst + " " + tmpNameLast
							  tmpBody = tmpNameFirst + " " + tmpNameLast + "&lt;BR&gt;"
							  tmpBody = tmpBody + "Email: " + tmpEmail + "&lt;BR&gt;"
							  tmpBody = tmpBody + "Phone: " + tmpPhone1 + "&lt;BR&gt;"
							  tmpBody = tmpBody + tmpStreet1 + " " + tmpStreet2 + "&lt;BR&gt;"
							  tmpBody = tmpBody + tmpCity + ", " + tmpState + " " + tmpZip + "&lt;BR&gt;"
							  SendEmail reqCompanyID, reqNotifyCompany, reqNotifyCompany, reqNotifyCompany, "", "", tmpSubject, tmpBody
						  </WTCUSTOM>
					  </WTCODEGROUP>
				</WTCODEGROUP>

				</WTOBJECT>
        
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
				  <WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					  <WTMETHOD name="Load">
						  <WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
					  <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					  <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(NewMemberID)"/>
					  <WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					  <WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					  <WTSETATTRIBUTES/>
					  <WTMETHOD name="Add">
						  <WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						  <WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
				  </WTOBJECT>

				  <!-- Custom Company Activation Processing -->
				  <WTCODEGROUP>
					  <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						  <WTMETHOD name="Custom">
							  <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							  <WTPARAM name="Status" direction="input" value="CONST(100)"/>
							  <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
							  <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Count" direction="return" datatype="number"/>
						  </WTMETHOD>
					  </WTOBJECT>
				  </WTCODEGROUP>

				  <!-- Custom Company Payment Post Processing -->
				  <WTCODEGROUP>
					  <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					  <WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
					  <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
					  <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						  <WTMETHOD name="Custom">
							  <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							  <WTPARAM name="Status" direction="input" value="CONST(99)"/>
							  <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
							  <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Count" direction="return" datatype="number"/>
						  </WTMETHOD>
					  </WTOBJECT>
					  <WTCALLSUB name="CommissionEmail reqCompanyID, PaymentID, 0, 0, tmpTotal">
						  <WTCONDITION expr="CONST(EmailBonuses)" oper="not-equal" value="CONST(0)"/>
					  </WTCALLSUB>
				  </WTCODEGROUP>
  		  </WTCODEGROUP>
        
				<WTCALLSUB name="LogMemberNote reqNewMemberID, &quot;ENROLL ERROR: &quot; + err.description + xmlError">
					<WTCONDITION expr="IsErrors"/>
					<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(Reference)" value="ATTR(Reference)"/>
           <WTSETATTRIBUTES/>
          <WTCODEGROUP>
            <!-- Silver Heart - 2Konnect Initialization -->
<!--            
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
            <WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
            <WTSETATTRIBUTE name="ATTR(NameFirst)" value="PARAM(FirstName)"/>
            <WTSETATTRIBUTE name="ATTR(NameLast)" value="PARAM(LastName)"/>
            <WTSETATTRIBUTE name="ATTR(Email)" value="PARAM(EmailAddress)"/>
            <WTSETATTRIBUTE name="ATTR(NewLogon)" value="PARAM(UserName)"/>
-->
          </WTCODEGROUP>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="CONST(Len(.CountryID))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="PARAM(PayType)">
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

      <WTSUB name="DuplicateEmail">
        <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="ExistEmail">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
            <WTPARAM name="MemberID" direction="return" datatype="number"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(MemberID)" oper="not-equal" value="CONST(0)"/>
            <WTERROR number="10123" message="Oops, This email address is already assigned to someone else."/>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="ValidateContact">
				<!-- Validate Contact Mode -->
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
        <WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10125" message="Oops, Please enter a First Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10126" message="Oops, Please enter a Last Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
					<WTCUSTOM>
						If ValidEmail( tmpEmail ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
					</WTCUSTOM>
				</WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="NotDuplicateEmail" connector="and"/>
          <WTCALLSUB name="DuplicateEmail"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(LEN(tmpPassword))" oper="less" value="CONST(6)"/>
						<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTSUB>

			<WTSUB name="ValidateMembership">
				<!-- Validate Membership Mode -->
			</WTSUB>

			<WTSUB name="ValidatePayment">
				<!-- Validate Payment Mode -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)" connector="and"/>
          <WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="CONST(lcase(tmpCardNumber))" />
					<WTCODEGROUP>
            <WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)"/>
            <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(GCR)" connector="and"/>
            <WTERROR number="10128" message="Oops, You must agree to the payment terms."/>
					</WTCODEGROUP>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidateConfirm">
				<!-- Validate Confirm Mode -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsCaptcha)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(TestCaptcha)" value="FORM(Captcha)" />
					<WTCUSTOM>
						If IsEmpty(Session("ASPCAPTCHA")) or Trim(Session("ASPCAPTCHA")) = "" Then
							DoError 0, "", "Oops, Your time has expired! Please reenter."
						else
							' Uppercase fix for turkish charset
							TestCaptcha = Replace(TestCaptcha, "i", "I", 1, -1, 1)
							TestCaptcha = Replace(TestCaptcha, "", "I", 1, -1, 1)
							TestCaptcha = Replace(TestCaptcha, "", "I", 1, -1, 1)
							TestCaptcha = UCase(TestCaptcha)

							If StrComp(TestCaptcha, Trim(Session("ASPCAPTCHA")), 1) &lt;&gt; 0 Then
								DoError 0, "", "Oops, You entered the wrong security answer! Please reenter."
								reqCaptcha = ""
							End If
							' IMPORTANT: Must remove session value for security after the CAPTCHA test
							Session("ASPCAPTCHA") = vbNullString
							Session.Contents.Remove("ASPCAPTCHA")
						End If
					</WTCUSTOM>
				</WTCODEGROUP>
			</WTSUB>

			<!-- Validate the Previous Mode -->
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(NoValidate)" oper="equal" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
						<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
					<WTCALLSUB name="ValidateContact"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-MEMBERSHIP)"/>
					<WTCALLSUB name="ValidateMembership"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
					<WTCALLSUB name="ValidatePayment"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
					<WTCALLSUB name="ValidateConfirm"/>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTACTION id="0" name="Agree" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-AGREE)">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(NoRefer)" oper="not-equal" value="CONST(0)" connector="or"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="1" name="Contact" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONTACT)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="2" name="Membership" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-MEMBERSHIP)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="3" name="Payment" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PAYMENT)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="4" name="Confirm" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONFIRM)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="5" name="Process" type="Add">
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PROCESS)"/>
					<WTSETATTRIBUTE name="CONST(tmpLogon)" value="FORM(NewLogon)"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
          <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
          <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Welcome.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
						<WTMETHOD name="Load" />
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
						</WTMETHOD>
						<WTCUSTOM>
              xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqNewMemberID) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
              xmlHTMLFile = Replace( xmlHTMLFile, "{pwd}", tmpPassword )
              xmlHTMLFile = Replace( xmlHTMLFile, "{email}", tmpEmail )
              xmlHTMLFile = Replace( xmlHTMLFile, "{reference}", reqReference )
            </WTCUSTOM>
					</WTOBJECT>
				</WTCODEGROUP>
			</WTACTION>

			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
				<WTCALLSUB name="LoadAgree"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
				<WTCALLSUB name="LoadCountrys"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
				<WTCALLSUB name="LoadCountrys"/>
				<WTCALLSUB name="LoadPaymentOptions"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="PARAM(CountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryName)" value="ATTR(CountryName)" />
					<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="PARAM(CountryIDb)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CountryID" direction="input" value="PARAM(CountryIDb)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="540" align="left"/>

				<WTFUNCTION name="ToggleType()">
					var payobj = Business.elements['PayType'];
					if( payobj != null ) {
						var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleCash = 'none'; var VisibleWallet = 'none'; var VisibleBitCoin = 'none'; var VisibleAddress = 'none';
						var paytype=1;
						var l = payobj.length;
						if( l == null ) {
							if( payobj.checked ) {
								paytype = payobj.value
							}
						}
						else {
							for( i = 0; i &lt; l; i++ ) {
								if (payobj[i].checked) {
									paytype = payobj[i].value;
									i = l;
								}
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						if (paytype == 7) VisibleCash = '';
						if (paytype &lt;= 5) VisibleAddress = '';
						if (paytype &gt;= 11 &amp;&amp; paytype &lt;= 13) VisibleWallet = '';
          if (paytype == 14) VisibleBitCoin = '';
          if (paytype == 16) VisibleBitCoin = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          document.getElementById('BitCoinRows').style.display = VisibleBitCoin;
          document.getElementById('CashRows').style.display = VisibleCash;
          document.getElementById('BillingAddress').style.display = VisibleAddress;
          }
        </WTFUNCTION>
				
				<WTFUNCTION name="CheckType(val)">
					var payobj = Business.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>
				
				<!--				
				<WTFUNCTION name="ShowTaxIDType()">
					var countryid = document.getElementById('CountryID').value;
					if( countryid == 224 ) {
						document.getElementById('TaxIDType1').style.display = '';
						document.getElementById('TaxIDType2').style.display = 'none';
					}	
					else {
						document.getElementById('TaxIDType1').style.display = 'none';
						document.getElementById('TaxIDType2').style.display = '';
					}	
				</WTFUNCTION>
-->
<!--
				<WTFUNCTION name="CheckType(val)">
					ToggleType();
				</WTFUNCTION>
-->
				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatPhone(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					if( newval.length == 10 ) {
					obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
					}
					if( newval.length == 11 ) {
					obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
					}
					if( newval.length == 12 ) {
					obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
					}
				</WTFUNCTION>
				<!--				
				<WTFUNCTION name="FormatTaxID(obj)">
					var countryid = document.getElementById('CountryID').value;
					var taxidtype = document.getElementById('TaxIDType1').value;
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					if( countryid == 224 ) {
						if( taxidtype == 1 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Social Security Number'); }
							else {
								obj.value = newval.substring(0,3) + '-' + newval.substring(3,5) + '-' + newval.substring(5,9);
							}
						}
						if( taxidtype == 2 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Employer Identification Number'); }
							else {
								obj.value = newval.substring(0,2) + '-' + newval.substring(2,9);
							}
						}
					}
				</WTFUNCTION>
-->
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					//if( newval.length &lt; 3 ) {
					//alert('Oops, Invalid Security Code');
					//}
				</WTFUNCTION>
				<WTFUNCTION name="FormatLogon(obj)">
					var val = obj.value;
					var newval = val.replace(/[^0-9a-zA-Z]/g, '');
					obj.value = newval;
					if( newval.length &lt; 6 ) {
					alert('Oops, Logon must be at least 6 characters or numbers.');
					}
				</WTFUNCTION>
				<WTFUNCTION name="ShowCC()">
					var disp, membership = document.getElementById('Membership').value;
					if( membership == 5 ) { disp = '' } else { disp = 'none' }
					document.getElementById('CCRequired').style.display = disp;
					if( membership == 5 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					//document.getElementById('Payment').style.display = disp;
					//document.getElementById('CardRows').style.display = disp;
					//document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="Init()">
					var mode = document.getElementById('Mode').value;
					if( mode == 1 ) {
					//ShowTaxIDType();
					}
					if( mode == 2 ) {
					// do nothing
					}
					if( mode == 3 ) {
					// do nothing
					}
					if( mode == 4 ) {
					ToggleType();
					//ShowCC();
					}
				</WTFUNCTION>

				<WTFUNCTION name="MsgBox(msg)">
					alert(msg);
				</WTFUNCTION>

				<WTLOAD>Init();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(Mode)"/>
					<WTHIDDEN value="PARAM(NewMemberID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(PayID)"/>
					<WTHIDDEN value="PARAM(TokenOwner)"/>
					<WTHIDDEN value="PARAM(TokenType)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(NoValidate)"/>
					<WTHIDDEN value="PARAM(ReferredBy)"/>
					<WTHIDDEN value="PARAM(Placement)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(BadPayment)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="3" label="BadPaymentText" class="PageHeading" fontcolor="red" align="left"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-REFER)"/>
					<WTCONDITION expr="PARAM(ReferredBy)" oper="equal" value="CONST('')" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(GetMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
								<WTSTATIC label="GetMemberID">
									<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(8)"/>
								</WTSTATIC>
								<WTSTATIC label="GetMemberID8">
									<!-- Life Time -->
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(8)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="MemberID" />
							<WTTEXT col="3" value="PARAM(MemberID)" size="6">
								<WTENTER>if(this.value==0){this.value=''}</WTENTER>
							</WTTEXT>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTBUTTON col="1" merge="3" action="0" value="CONST(Continue)" align="center"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(GetMemberID)" oper="equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="3" align="center" class="PageHeading" fontcolor="red">
								<WTSTATIC label="NoReferral1" newline="2"/>
								<WTSTATIC label="NoReferral2"/>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<!-- === Agreement ====================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(BillDay)"/>
					<WTHIDDEN value="PARAM(PayType)"/>

					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="3" align="center" bold="true">
							<WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Placement)" oper="not-equal" value="CONST('')"/>
								<WTSTATIC newline="1"/>
								<WTSTATIC tag="Placement" value="PARAM(Placement)"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
							<WTCODEGROUP>
								<WTCHECK value="PARAM(IsAgree)"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="1" value="CONST(Continue)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Contact Information ============================================ -->
				<WTSTATIC label="CompanyNameTip"/>
				<WTSTATIC label="Email2Tip"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(BillDay)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollContact.png)" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, First Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="340" label="NameLast" size="25" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Last Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2">
							<WTSTATIC label="CompanyName"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(TipQuestion.gif)" alt="CompanyNameTip">
									<WTLINK name="CONST(alert('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='CompanyNameTip']&quot;/&gt;');)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
						</WTSTATIC>
						<WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Email"/>
						<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Email Required!')};</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTCONDITION expr="PARAM(TextEmail)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2">
							<WTSTATIC label="Email2"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(TipQuestion.gif)" alt="Email2Tip">
									<WTLINK name="CONST(MsgBox('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='Email2Tip']&quot;/&gt;');)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
						</WTSTATIC>
						<WTTEXT col="3" value="ATTR(Member.Email2)" size="60" required="false"/>
						<WTSTATIC col="3">
							<WTCODEGROUP>
								<WTIMAGE value="CONST(LearnMore.gif)">
									<WTLINK name="Page" target="Help"><WTPARAM name="Page" value="CONST(Email2)"/></WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
<!--					
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="WV"/>
						<WTTEXT col="3" value="ATTR(Member.Reference)" size="15"/>
					</WTROW>
-->
					<WTROW margin-top="6">
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60">
							<WTEXIT>if(this.value==''){alert('Oops, Mailing Address Required!')}; document.getElementById('Street1b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60">
							<WTEXIT>document.getElementById('Street2b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.City)" width="200" label="City" size="27" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, City Required!');}else{TitleCase(this);}; document.getElementById('Cityb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" width="340" label="State" size="27" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, State Required!');}else{TitleCase(this);}; document.getElementById('Stateb').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" width="100" label="Zip" size="8" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')}; document.getElementById('Zipb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" width="440" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
							<WTEXIT>document.getElementById('CountryIDb').value = this.value;</WTEXIT>
						</WTCOMBO>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="20">
							<WTEXIT>FormatPhone(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewLogon"/>
						<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20" class="prompt">
							<WTEXIT>FormatLogon(this);</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="3" label="LogonTip"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewPassword"/>
						<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20" secure="false" class="prompt">
							<WTEXIT>if(this.value==''){alert('Oops, Password Required!');}</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="3" label="PasswordText"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="2" value="CONST(Continue)" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(2,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Membership ===================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-MEMBERSHIP)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollMembership.png)" align="center"/>
					</WTROW>

					<!-- Custom Company Membership Info -->
					<WTCODEGROUP>
						<!-- myTrackerPro -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTROW margin-top="12" margin-bottom="12">
							<WTSTATIC col="1" merge="3" label="Membership7_Try" align="center" fontsize="5" fontcolor="#cc003a" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
									<WTSTATIC col="3">
										<WTSTATIC label="Membership7_3">
											<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC label="Membership7_3a">
											<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3">
										<WTSTATIC label="Membership7_1">
											<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC label="Membership7_1a">
											<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Lifetime -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(8)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership8_1"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
									<WTSTATIC col="3" label="Membership8_2"/>
								</WTROW>
								<WTROW margin-top="48">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
									<WTSTATIC col="3" label="Membership8_3"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
									<WTSTATIC col="3" label="Membership8_4"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>

          <WTCODEGROUP>
						<!-- Legacy Max -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(14)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>

                <WTROW margin-top="6">
                  <WTIMAGE col="1" merge="3" value="CONST(Enroll-HDR.gif)" path="Company/14" align="center"/>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
                  <WTIMAGE col="3" value="CONST(Enroll2.gif)" path="Company/14" align="center"/>
                </WTROW>
                <WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
                  <WTIMAGE col="3" value="CONST(Enroll3.gif)" path="Company/14" align="center"/>
                </WTROW>
                <WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
                  <WTIMAGE col="3" value="CONST(Enroll1.gif)" path="Company/14" align="center"/>
                </WTROW>
                <WTROW margin-top="12" margin-bottom="6">
                  <WTIMAGE col="1" merge="3" value="CONST(Enroll-FTR.gif)" path="Company/14" align="center"/>
                </WTROW>
              </WTTABLE>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- CIS -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership15_1"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- PeopleEdge -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(16)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
                  <WTSTATIC col="3" label="Membership16_1"/>
                </WTROW>
                <WTROW margin-top="12">
                  <WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
                  <WTSTATIC col="3" label="Membership16_2"/>
                </WTROW>
              </WTTABLE>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- GCR -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(17)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>

                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" merge="2" label="Membership17_Text" class="PageHeading" fontcolor="blue" align="left"/>
                </WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="7" align="left" valign="top" datapathx="/DATA/PARAM/@membership=7"/>
									<WTSTATIC col="3" label="Membership17_7" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="5" align="left" valign="top" datapathx="/DATA/PARAM/@membership=5"/>
									<WTSTATIC col="3" label="Membership17_5" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
									<WTSTATIC col="3" label="Membership17_4" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
									<WTSTATIC col="3" label="Membership17_3" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership17_1" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Free Loyalty -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>

								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" merge="2" label="Membership18_Text" class="PageHeading" fontcolor="red" align="center"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership18_1" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
									<WTSTATIC col="3" label="Membership18_2" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
									<WTSTATIC col="3" label="Membership18_3" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- TellAllMobile -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(19)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>

								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership19_1" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <!-- SilverHeart -->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
            <WTROW margin-bottom="12">
              <WTTABLE col="1" merge="3">
                <WTCOLUMN width="30" align="left"/>
                <WTCOLUMN width="30" align="left"/>
                <WTCOLUMN width="690" align="left"/>

                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
                  <WTSTATIC col="3" label="Membership20_1" bold="true"/>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership20_2" bold="true"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
                    <WTSTATIC label="Membership20_2i" bold="true"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership20_3" bold="true"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
                    <WTSTATIC label="Membership20_3i" bold="true"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership20_4" bold="true"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
                    <WTSTATIC label="Membership20_4i" bold="true"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
                  </WTSTATIC>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTCODEGROUP>

          <WTCODEGROUP>
            <!-- NEXXUS-->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTROW margin-bottom="12">
              <WTTABLE col="1" merge="3">
                <WTCOLUMN width="30" align="left"/>
                <WTCOLUMN width="30" align="left"/>
                <WTCOLUMN width="690" align="left"/>

                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" merge="2" label="Membership21_Text" class="PageHeading" fontcolor="blue" align="left"/>
                </WTROW>
                <WTROW margin-top="18">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
                  <WTSTATIC col="3" label="Membership21_1" bold="true"/>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
                  <WTSTATIC col="3" label="Membership21_2" bold="true"/>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
                  <WTSTATIC col="3" label="Membership21_3" bold="true"/>
                </WTROW>
                <WTROW margin-top="18">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" merge="2" label="Membership21_Text2" class="prompt" fontcolor="blue" align="left"/>
                </WTROW>
              </WTTABLE>
            </WTROW>
          </WTCODEGROUP>
          
            <WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="1" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(1,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" action="3" value="CONST(Continue)" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(3,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Payment ========================================================= -->
				<WTSTATIC label="Checking"/>
				<WTSTATIC label="Savings"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollPayment.png)" align="center"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)" connector="and"/>
						<WTROW margin-bottom="12">
							<WTSTATIC col="1" merge="3" label="NoPaymentText" align="center" bold="true" fontcolor="red"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTROW margin-bottom="12">
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
							<WTSTATIC col="1" merge="3" label="NoPaymentText" align="center" bold="true" fontcolor="red"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1" merge="3" label="NoPaymentText2" align="center" bold="true" fontcolor="red"/>
						</WTROW>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
            <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(8)" connector="and"/>
            <WTROW margin-bottom="12">
              <WTSTATIC col="1" merge="3" label="NoPaymentText" align="center" bold="true" fontcolor="red"/>
            </WTROW>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(16)"/>
            <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)" connector="and"/>
            <WTROW margin-bottom="12">
              <WTSTATIC col="1" merge="3" label="NoPaymentText3" align="center" bold="true" fontcolor="red"/>
            </WTROW>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText10" align="left" class="PageHeading" fontcolor="blue"/>
              </WTROW>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText11" align="left" bold="true" fontcolor="blue"/>
              </WTROW>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText12" align="left" bold="true" fontcolor="blue"/>
              </WTROW>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText13" align="left" bold="true" fontcolor="blue"/>
              </WTROW>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText14" align="left" bold="true" fontcolor="blue"/>
              </WTROW>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(1)"/>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText20" align="left" class="PageHeading" fontcolor="blue"/>
              </WTROW>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText21" align="left" bold="true" fontcolor="blue"/>
              </WTROW>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="GCRPaymentText22" align="left" bold="true" fontcolor="blue"/>
              </WTROW>
            </WTCODEGROUP>
          </WTCODEGROUP>
          <WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(14)"/>
						<WTROW margin-bottom="12">
							<WTSTATIC col="1" merge="3" label="CashPaymentText" align="center" bold="true" fontcolor="red" class="PageHeading"/>
						</WTROW>
					</WTCODEGROUP>
<!--					
					<WTROW id="CCRequired" style="display:none" margin-bottom="6">
						<WTSTATIC col="1" merge="3" bold="true" align="center" fontcolor="red">
							<WTSTATIC label="CCRequired"/>
						</WTSTATIC>
					</WTROW>
-->
					<WTCODEGROUP>
            <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
            <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(GCR)" connector="and"/>

            <WTROW id="Payment">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="750" align="center"/>

								<WTROW id="Pay2" margin-bottom="12">
									<WTSTATIC col="1" align="center" class="prompt">
										<WTSTATIC label="PaymentText">
											<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(17)"/>
										</WTSTATIC>
										<WTSTATIC label="BitCoinPayments">
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(17)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="6">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentVisa"/>
											<WTRADIO group="PayType" name="1" check="/DATA/TXN/PTSBILLING/@paytype=1">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentMC"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="2" check="/DATA/TXN/PTSBILLING/@paytype=2">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentDiscover"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="3" check="/DATA/TXN/PTSBILLING/@paytype=3">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentAmex"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="4" check="/DATA/TXN/PTSBILLING/@paytype=4">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentCheck"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(5);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymenteWallet"/>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentiPayout"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="11" check="/DATA/TXN/PTSBILLING/@paytype=11">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType11.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(11);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentPayQuicker"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="12" check="/DATA/TXN/PTSBILLING/@paytype=12">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType12.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(12);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentSolidTrust"/>
													<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="13" check="/DATA/TXN/PTSBILLING/@paytype=13">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType13.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(13);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentBitCoin"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="14" check="/DATA/TXN/PTSBILLING/@paytype=14">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType14.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(14);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentNeteller"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="15" check="/DATA/TXN/PTSBILLING/@paytype=15">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType15.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(15);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
                    </WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(CashPayment)" oper="not-equal" value="CONST(0)"/>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentCash"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="7" check="/DATA/TXN/PTSBILLING/@paytype=7">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType7.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(7);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentPO"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="8" check="/DATA/TXN/PTSBILLING/@paytype=8">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType8.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(8);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CashRows" style="display:none">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
									<WTROW margin-top="6" margin-bottom="6">
										<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
									</WTROW>
									<WTROW margin-bottom="6">
										<WTSTATIC col="1" merge="3" label="CashPayment15" align="center" bold="true" fontcolor="blue"/>
									</WTROW>
								</WTCODEGROUP>
							</WTTABLE>
						</WTROW>

						<WTROW id="WalletRows" style="display:none">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="WalletName"/>
									<WTTEXT col="2" value="PARAM(Wallet)" required="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="BitCoinRows" style="display:none">
              <WTTABLE col="1" merge="3">
								<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(17)"/>
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
                <WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" merge="2" label="BitCoinPayments" class="PageHeading" fontcolor="red" align="center"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CardRows" style="display:none">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
										<WTEXIT>var x = this.value; if(x.tolowercase() != 'paypal'){this.value = x.replace(/[^\d]/g, '')};</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CheckRows" style="display:none">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CheckBank"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckRoute"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckRoute)"/>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(checkref.gif)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAccount"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25"/>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(checkref.gif)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAcctType"/>
									<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckName"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="BillingAddress" style="display:none">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="BillingAddress" />
									<WTTEXT col="2" value="PARAM(Street1b)" size="60">
										<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="12">
							<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
						</WTROW>
						<WTROW id="Agree2">
							<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
                  <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(15)"/>
                  <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(GCR)" connector="and"/>
                  <WTCODEGROUP>
										<WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(0)"/>
										<WTSTATIC label="IsAgree2Billed">
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
										</WTSTATIC>
										<WTSTATIC label="IsAgree2Monthly">
                      <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(GCR)"/>
                    </WTSTATIC>
									</WTCODEGROUP>
									<WTSTATIC label="IsAgree2Annually">
										<WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
									<WTSTATIC label="IsAgree2OneTime">
										<WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
								</WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
                  <WTSTATIC label="IsAgree2_15"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
                  <WTSTATIC label="IsAgree2_17"/>
                </WTCODEGROUP>

                
              </WTSTATIC>
						</WTROW>
						<WTROW margin-top="12">
							<WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1" merge="3" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
									<WTCOMBO value="PARAM(BillDay)">
										<WTOPTION id="1" label="BillDay1"/>
										<WTOPTION id="15" label="BillDay15"/>
									</WTCOMBO>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="2" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(2,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" action="4" value="CONST(Continue)" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(4,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Confirm ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(BillDay)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollConfirm.png)" align="center"/>
					</WTROW>

					<WTROW>
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="100" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.NameLast)" newline="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.CompanyName)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Email)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Reference)" newline="1">
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
									</WTSTATIC>
									<WTSTATIC value="ATTR(Member.Phone1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.Street1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.City)" space="1"/>
									<WTSTATIC value="ATTR(Address.State)" space="1"/>
									<WTSTATIC value="ATTR(Address.Zip)" newline="1"/>
									<WTSTATIC value="PARAM(CountryName)" newline="1"/>
									<WTSTATIC tag="Logon" value="ATTR(Member.NewLogon)" space="2"/>
									<WTSTATIC value="ATTR(Member.NewPassword)"/>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)"/>
									<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
									<WTSTATIC label="BillingInfo" newline="1" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="greater-equal" value="CONST(1)"/>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="less-equal" value="CONST(4)" connector="and"/>
										<WTSTATIC value="ATTR(Billing.CardNumber)" newline="1"/>
										<WTSTATIC tag="Expires" value="ATTR(Billing.CardMo)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CardYr)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CardName)" newline="1"/>
										<WTSTATIC tag="Code" value="ATTR(Billing.CardCode)" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(5)"/>
										<WTSTATIC value="ATTR(Billing.CheckBank)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckRoute)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CheckAccount)" newline="1"/>
										<WTSTATIC label="Checking">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
										<WTSTATIC label="Savings">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(2)"/>
										</WTSTATIC>
										<WTSTATIC newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckName)" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(7)"/>
										<WTSTATIC label="CashPayment" newline="1"/>
										<WTSTATIC label="CashPayment15"> <!-- CIS -->
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(11)"/>
										<WTSTATIC tag="iPayout" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(12)"/>
										<WTSTATIC tag="PayQuicker" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(13)"/>
										<WTSTATIC tag="SolidTrust" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(14)"/>
										<WTSTATIC label="BitCoinPayments"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="less" value="CONST(7)"/>
										<WTSTATIC value="PARAM(Street1b)" newline="1"/>
										<WTSTATIC value="PARAM(Cityb)" space="1"/>
										<WTSTATIC value="PARAM(Stateb)" space="1"/>
										<WTSTATIC value="PARAM(Zipb)" newline="1"/>
										<WTSTATIC value="PARAM(CountryNameb)" newline="2"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTSTATIC col="1" merge="3" align="center" bold="true">
							<WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Placement)" oper="not-equal" value="CONST('')"/>
								<WTSTATIC newline="1"/>
								<WTSTATIC tag="Placement" value="PARAM(Placement)"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<!-- Custom Company Membership Info -->
					<WTCODEGROUP>
						<!-- myTrackerPro -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
									<WTSTATIC label="Membership7_1">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC label="Membership7_2">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
									<WTSTATIC label="Membership7_3">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC label="Membership7_1a">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC label="Membership7_3a">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Lifetime -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(8)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTSTATIC label="Membership8_1">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership8_2">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership8_3">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership8_4">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- PB -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									<WTSTATIC label="Membership11_1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
									<WTSTATIC label="Membership11_2"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
									<WTSTATIC label="Membership11_3"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)" connector="or"/>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(OrderOption)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC newline="1"/>
										<WTSTATIC label="Membership11_2a" fontcolor="blue"/>
									</WTCODEGROUP>
								</WTCODEGROUP>

								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
									<WTSTATIC label="Membership11_4"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
									<WTSTATIC label="Membership11_5"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
									<WTSTATIC label="Membership11_6"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(7)"/>
									<WTSTATIC label="Membership11_7"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)" connector="or"/>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(7)" connector="or"/>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(OrderOption)" oper="not-equal" value="CONST(0)"/>
										<WTSTATIC newline="1"/>
										<WTSTATIC label="Membership11_5a" fontcolor="blue"/>
									</WTCODEGROUP>
								</WTCODEGROUP>

								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(8)"/>
									<WTSTATIC label="Membership11_8"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(9)"/>
									<WTSTATIC label="Membership11_9"/>
								</WTCODEGROUP>

								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC fontcolor="purple">
										<WTSTATIC newline="2"/>
										<WTSTATIC label="BillDay1">
											<WTCONDITION expr="PARAM(BillDay)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
										<WTSTATIC label="BillDay15">
											<WTCONDITION expr="PARAM(BillDay)" oper="equal" value="CONST(15)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTCODEGROUP>

							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12">
							<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(7)"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="Membership11_Cash" class="PageHeading" align="center" fontcolor="red"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Legacy Max -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(14)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									<WTSTATIC label="Membership14_1"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_1i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
									<WTSTATIC label="Membership14_2"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_2i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
									<WTSTATIC label="Membership14_3"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_3i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
									<WTSTATIC label="Membership14_4"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_4i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
									<WTSTATIC label="Membership14_5"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_5i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
									<WTSTATIC label="Membership14_6"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_6i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(7)"/>
									<WTSTATIC label="Membership14_7"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_7i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(8)"/>
									<WTSTATIC label="Membership14_8"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_8i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(9)"/>
									<WTSTATIC label="Membership14_9"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_9i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(10)"/>
									<WTSTATIC label="Membership14_10"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="Membership14_10i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12">
							<WTCONDITION expr="PARAM(Membership)" oper="greater-equal" value="CONST(4)"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center" fontcolor="red">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(1)"/>
									<WTSTATIC label="OrderOption14_1"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption14_1i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(OrderOption)" oper="equal" value="CONST(2)"/>
									<WTSTATIC label="OrderOption14_2"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
									<WTSTATIC label="OrderOption14_2i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- CIS -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
<!--
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									<WTSTATIC label="Membership15_1"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
-->						
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- CIS -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(16)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
                <WTSTATIC label="Membership16_1">
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
                </WTSTATIC>
                <WTSTATIC label="Membership16_2">
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
                </WTSTATIC>
              </WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- GCR -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(17)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTSTATIC label="Membership17_1">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership17_2">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership17_3">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership17_4">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership17_5">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership17_6">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership17_7">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(7)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership17_8">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(8)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Free Loyalty -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTSTATIC label="Membership18_1">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership18_2">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership18_3">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- TellAllMobile -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(19)"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
								<WTSTATIC label="Membership19_1">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

          <WTCODEGROUP>
            <!-- SilverHeart Max -->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(SILVERHEART)"/>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" merge="2" class="PageHeading" align="center">
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
                  <WTSTATIC label="Membership20_1"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
                  <WTSTATIC label="Membership20_2"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
                  <WTSTATIC label="Membership20_2i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
                  <WTSTATIC label="Membership20_3"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
                  <WTSTATIC label="Membership20_3i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
                  <WTSTATIC label="Membership20_4"><WTCONDITION expr="ATTR(Address.CountryID)" oper="equal" value="CONST(224)"/></WTSTATIC>
                  <WTSTATIC label="Membership20_4i"><WTCONDITION expr="ATTR(Address.CountryID)" oper="not-equal" value="CONST(224)"/></WTSTATIC>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>
          </WTCODEGROUP>
          <WTCODEGROUP>
            <!-- NEXXUS-->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" merge="2" class="PageHeading" align="center">
                <WTSTATIC label="Membership17_1">
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
                </WTSTATIC>
                <WTSTATIC label="Membership17_2">
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
                </WTSTATIC>
                <WTSTATIC label="Membership17_3">
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
                </WTSTATIC>
              </WTSTATIC>
            </WTROW>
          </WTCODEGROUP>

          <WTFUNCTION name="RefreshCaptchaImage(valImageId)">
						var objImage = document.getElementById(valImageId)
						if (objImage != undefined) {
							var now = new Date();
							objImage.src = objImage.src.split('?')[0] + '?x=' + now.toUTCString();
						}
					</WTFUNCTION>
					
					<WTCODEGROUP>
						<!-- Required Captcha -->
						<WTCONDITION expr="PARAM(IsCaptcha)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="18">
							<WTIMAGE col="1" merge="3" value="CONST(captcha.asp)" imgpath="include/" id="imgCaptcha" align="center" imgalign="absmiddle" />
							<WTBUTTON col="1" merge="3" value="CONST(NewCaptcha)" align="center" btnclass="smbutton">
								<WTCLICK>RefreshCaptchaImage('imgCaptcha');</WTCLICK>
							</WTBUTTON>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="3" tag="WriteCaptcha" align="center"/>
							<WTTEXT col="1" merge="3" value="PARAM(Captcha)" size="10"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="3" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(3,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" value="CONST(Confirm)" align="center">
							<WTCLICK> this.disabled = true; doSubmit(5,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Welcome ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PROCESS)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Custom New Member Enrollment Form -->
		<!--============================================================================================-->
		<WTWEBPAGE name="Register" caption="New Member" navbar="false" header="false" footer="false"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="Register">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="NewMemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="Mship" datatype="number"/>
			<WTPARAM name="OrderOption" datatype="number"/>
			<WTPARAM name="Retail" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Billing" datatype="number"/>
			<WTPARAM name="BillDay" datatype="number"/>
      <WTPARAM name="Reference" datatype="text" />
      <WTPARAM name="OptFld1" datatype="text" />

      <WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="NoBanner" datatype="number"/>
			<WTPARAM name="NoPayment" datatype="number"/>
			<WTPARAM name="NoRefer" datatype="number"/>
			<WTPARAM name="NoValidate" datatype="number"/>
			<WTPARAM name="TextEmail" datatype="number"/>
			<WTPARAM name="NoPayout" datatype="number"/>
			<WTPARAM name="GetMemberID" datatype="number"/>
			<WTPARAM name="BillOneTime" datatype="number"/>
			<WTPARAM name="AutoShipMonths" datatype="number"/>
			<WTPARAM name="RegisterWallet" datatype="number"/>

			<!-- Referring Member -->
			<WTPARAM name="M" datatype="number"/>
			<!-- Sponsor -->
			<WTPARAM name="S" datatype="number"/>
			<!-- CompanyID -->
			<WTPARAM name="C" datatype="number"/>
			<!-- Sponsor3ID (Binary) -->
			<WTPARAM name="S3" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="Placement" datatype="text"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>
			<WTPARAM name="CountryID" datatype="text"/>
			<WTPARAM name="CountryName" datatype="text"/>
			<WTPARAM name="CountryNameb" datatype="text"/>

			<WTPARAM name="TokenType" datatype="number"/>
			<WTPARAM name="TokenOwner" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="BadPayment" datatype="number"/>
			<WTPARAM name="CashPayment" datatype="number"/>
			<WTPARAM name="Wallet" datatype="text"/>
			<WTPARAM name="NotifyCompany" datatype="text"/>
			<WTPARAM name="IsCaptcha" datatype="number"/>
      <WTPARAM name="Captcha" datatype="text"/>

      <!--2Konnect Custom Paramaters -->
      <WTPARAM name="2KUserID" datatype="text" private="true"/>
      <WTPARAM name="PXSponsorID" datatype="text"/>
      
      <!--Custom Paramaters -->
      <WTPARAM name="xID" datatype="text"/>
      <WTPARAM name="xSponsorID" datatype="text"/>
      <WTPARAM name="FirstName" datatype="text"/>
      <WTPARAM name="LastName" datatype="text"/>
      <WTPARAM name="UserName" datatype="text"/>
      <WTPARAM name="EmailAddress" datatype="text"/>

      <!-- Mode 0 ... Agreement -->
			<!-- Mode 1 ... Contact Info -->
			<!-- Mode 2 ... Membership Selection -->
			<!-- Mode 3 ... Payment -->
			<!-- Mode 4 ... Confirmation -->
			<!-- Mode 5 ... Process/Welcome -->

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="iPayout.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

      <WTCODEGROUP>

        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(C)" value="SYSCON(NEXXUS)"/>
				</WTCODEGROUP>
        <WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(PXSponsorID)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTGETCACHE name="PARAM(M)" value="A" datatype="number"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MemberID)"/>
				</WTCODEGROUP>
        <!-- 2Konnect custom parameters -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(2KUserID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
          <WTSETATTRIBUTE name="PARAM(xID)" value="PARAM(2KUserID)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(PXSponsorID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
<!--          <WTSETATTRIBUTE name="PARAM(xSponsorID)" value="PARAM(PXSponsorID)"/>-->
          <WTSETATTRIBUTE name="PARAM(M)" value="PARAM(PXSponsorID)"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mship)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)" connector="and"/>
          <WTSETATTRIBUTE name="PARAM(Membership)" value="PARAM(Mship)"/>
        </WTCODEGROUP>
<!--        
        <WTCODEGROUP>
          <WTCONDITION expr="SYS(CompanyID)" oper="equal" value="SYSCON(NEXXUS)" />
          <WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" connector="and"/>
          <WTCONDITION expr="PARAM(xSponsorID)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTSETATTRIBUTE name="PARAM(M)" value="CONST(37702)"/>
        </WTCODEGROUP>
-->
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)">
					<WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="PARAM(S)" value="PARAM(M)">
					<WTCONDITION expr="PARAM(S)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)">
					<WTCONDITION expr="PARAM(CountryIDb)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(&quot;No Referrer&quot;)">
					<WTCONDITION expr="PARAM(NoRefer)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="CONST(ValidMemberStatus)" value="CONST(&quot;1234&quot;)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<!-- Validate that Sponsor3ID is under ReferralID -->
				<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)" />
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Custom">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="Status" direction="input" value="CONST(206)"/>
						<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(S3)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(M)"/>
						<WTPARAM name="Result" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(Result)" oper="not-equal" value="PARAM(M)" />
					<WTCUSTOM>
						Response.write "Invalid Enroller for this Binary Placement."
						Response.end
					</WTCUSTOM>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<!-- Custom Company Setup -->
      <WTCODEGROUP>
        <!-- Nexxus -->
        <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
      </WTCODEGROUP>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadPaymentOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadAgree">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Enroll.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTCONDITION expr="PARAM(ReferID)" oper="equal" value="CONST(0)"/>
          <WTCONDITION expr="PARAM(xSponsorID)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
          <WTMETHOD name="FetchRef">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="Reference" direction="input" value="PARAM(xSponsorID)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(ReferID)" value="ATTR(MemberID)"/>
        </WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
          <WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="ATTR(CompanyName)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCUSTOM>
						If InStr( ValidMemberStatus, .Status ) = 0 Then
						Response.Write "The Member that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
						Response.End
						End If
					</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(S3)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(TRIM(.NameFirst + &quot; &quot; + .NameLast))"/>
						<WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(reqPlacement + &quot; (Left Side)&quot;)">
							<WTCONDITION expr="PARAM(Pos)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(Placement)" value="CONST(reqPlacement + &quot; (Right Side)&quot;)">
							<WTCONDITION expr="PARAM(Pos)" oper="not-equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon/Website Name is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10006" message="Oops, Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<WTSETATTRIBUTE name="CONST(reqPayType)" value="CONST(CLng(result))" />
						<!-- <WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
<!--					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>-->
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="greater-equal" value="SYSCON(PAYTYPE-WALLET)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Wallet)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
            <WTCODEGROUP>
              <WTCONDITION expr="NoErrors"/>
              <WTCALLSUB name=".Token = SetVault( reqCompanyID, reqBillingID )">
                <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
              </WTCALLSUB>
              <WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )"/>
            </WTCODEGROUP>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="AddMember">
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPrice1)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice2)" value="ATTR(Price2)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice3)" value="ATTR(Price3)"/>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
					<WTCUSTOM>EmailBonuses = InStr(.Shopping, "N")</WTCUSTOM>
				</WTOBJECT>
				<!-- Create Payout Record -->
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(NoPayout)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Set eWallet -->
					<WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-BITCOIN)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="CONST(&quot;Not Used&quot;)" />
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					<WTMETHOD name="Save">
						<WTCONDITION expr="PARAM(PayID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Add">
						<WTCONDITION expr="PARAM(PayID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqPayID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- get referrer's group # -->
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="Load">
            <WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
					<WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email2)"/>
					<WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email)">
						<WTCONDITION expr="CONST(InStr(ReferEmail, &quot;@&quot;))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(CompanyEmail)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="PARAM(NotifyCompany)" value="ATTR(Email)">
						<WTCONDITION expr="PARAM(NotifyCompany)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>

					<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)">
						<WTCONDITION expr="PARAM(BillDay)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
						<WTCUSTOM>
							mo = DATEPART( "m", DATE())
							yr = DATEPART( "yyyy", DATE())
							If reqBillDay = 1 Then
								tmpDate = CSTR(mo) + "/1/" + CSTR(yr)
								.PaidDate = DateAdd( "m", 1, tmpDate )
							Else
								.PaidDate = CSTR(mo) + "/" + CSTR(reqBillDay) + "/" + CSTR(yr)
							End If
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;Enrollment&quot;)"/>

					<!-- Custom Company Setup -->
          <WTCODEGROUP>
            <!-- NEXXUS -->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
            <WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
            <WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
            <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
            <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
            <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
            <!--<WTSETATTRIBUTE name="ATTR(Reference)" value="FORM(OptFld1)"/>-->
            <WTCODEGROUP>
              <!-- Beginner -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;101&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;101&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(10)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(10)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(11)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(10)">
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)"/>
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-NEXXUS)" connector="or"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Basic -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(25)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(25)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(27)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(25)">
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)"/>
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-NEXXUS)" connector="or"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Pro -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(50)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(50)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(53)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(50)">
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)"/>
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-NEXXUS)" connector="or"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Beginner Ad Pack -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;106&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;106&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(10)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(10)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(11)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(10)">
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)"/>
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-NEXXUS)" connector="or"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Basic Ad Pack -->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;107&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;107&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(25)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(25)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(27)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(25)">
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)"/>
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-NEXXUS)" connector="or"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
            <WTCODEGROUP>
              <!-- Pro Ad Pack-->
              <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
              <WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;108&quot;)"/>
              <WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;108&quot;)"/>
              <WTSETATTRIBUTE name="ATTR(Price)" value="CONST(50)"/>
              <WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(50)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(53)"/>
              <WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(50)">
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)"/>
                <WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-NEXXUS)" connector="or"/>
              </WTSETATTRIBUTE>
            </WTCODEGROUP>
          </WTCODEGROUP>
          
          <WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
						<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
						<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="PARAM(Billing)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(1)">
								<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
						<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
							<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
						<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFGHI&quot;)"/>

            <WTCODEGROUP>
							<WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Reference)" value="PARAM(xID)"/>
<!--							<WTSETATTRIBUTE name="ATTR(Referral)" value="PARAM(xSponsorID)"/>-->
						</WTCODEGROUP>

            <WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
<!--
            <WTCODEGROUP>
							<WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(S)"/>
						</WTCODEGROUP>
-->            
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Sponsor3ID)" value="PARAM(S3)"/>
							<WTSETATTRIBUTE name="ATTR(Pos)" value="PARAM(Pos)"/>
						</WTCODEGROUP>

						<WTMETHOD name="Add">
							<WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>

					<!-- Get Payment -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
						<!-- Payment Post Processing is done after the new member is activated below -->
						<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
						<WTCUSTOM>
              tmpProcessor = 0
              tmpAcct = ""
              Select Case reqPayType
                Case 1, 2, 3, 4	'Process Credit Cards
                  tmpProcessor = tmpCardProcessor
                  tmpAcct = tmpCardAcct
                Case 5 'Process Electronic Checks
                  tmpProcessor = tmpCheckProcessor
                  tmpAcct = tmpCheckAcct
                Case 11, 12, 13 'Process Wallets
                  tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
              End Select
              tmpPayType = reqPayType
              'Billing Nexxus Coin (16) = Payment Nexxus Coin (21)
              If tmpPayType = 16 Then tmpPayType = 21
            </WTCUSTOM>
            <WTCALLSUB name="Result = GetPayment( reqCompanyID, reqNewMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
							<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(BillOneTime)" oper="not-equal" value="CONST(1)"/>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))">
									<WTCONDITION expr="PARAM(AutoShipMonths)" oper="equal" value="CONST(0)"/>
								</WTSETATTRIBUTE>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, reqAutoShipMonths, .PaidDate))">
									<WTCONDITION expr="PARAM(AutoShipMonths)" oper="not-equal" value="CONST(0)"/>
								</WTSETATTRIBUTE>
								<WTMETHOD name="Save">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
							oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>

					  <!-- Send notice to Referrer -->
            <WTCODEGROUP>
						  <WTCONDITION expr="CONST(ReferEmail)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						  <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						  <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						  <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
						  <WTCUSTOM>
							  tmpSubject = "NEW REFERRED MEMBER: " + tmpNameFirst + " " + tmpNameLast + " - " + tmpEmail
							  tmpBody = ""
							  SendEmail reqCompanyID, CompanyEmail, CompanyEmail, ReferEmail, "", "", tmpSubject, tmpBody
						  </WTCUSTOM>
					  </WTCODEGROUP>

            <!-- Send confirmation to 2Konnect -->
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
              <WTCONDITION expr="PARAM(xID)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
						  <WTCUSTOM>
							  Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							  If oHTTP Is Nothing Then
								  Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							  Else
								  oHTTP.open "GET", "HTTPS://www.2konnect.net/service/nexxus.aspx?PartnerID=N37934SX87L7TSC7&amp;KUserID=" + reqxID + "&amp;PXUserID=" + CSTR(reqNewMemberID)
                  oHTTP.send
							  End If
							  Set oHTTP = Nothing
						  </WTCUSTOM>
            </WTCODEGROUP>
              
            <!-- Send notice to Company -->
					  <WTCODEGROUP>
						  <WTCONDITION expr="PARAM(NotifyCompany)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						  <WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						  <WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						  <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
						  <WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)" />
						  <WTSETATTRIBUTE name="CONST(tmpStreet1)" value="FORM(Street1)" />
						  <WTSETATTRIBUTE name="CONST(tmpStreet2)" value="FORM(Street2)" />
						  <WTSETATTRIBUTE name="CONST(tmpCity)" value="FORM(City)" />
						  <WTSETATTRIBUTE name="CONST(tmpState)" value="FORM(State)" />
						  <WTSETATTRIBUTE name="CONST(tmpZip)" value="FORM(Zip)" />
						  <WTCUSTOM>
							  tmpSubject = "NEW MEMBER: " + tmpNameFirst + " " + tmpNameLast
							  tmpBody = tmpNameFirst + " " + tmpNameLast + "&lt;BR&gt;"
							  tmpBody = tmpBody + "Email: " + tmpEmail + "&lt;BR&gt;"
							  tmpBody = tmpBody + "Phone: " + tmpPhone1 + "&lt;BR&gt;"
							  tmpBody = tmpBody + tmpStreet1 + " " + tmpStreet2 + "&lt;BR&gt;"
							  tmpBody = tmpBody + tmpCity + ", " + tmpState + " " + tmpZip + "&lt;BR&gt;"
							  SendEmail reqCompanyID, reqNotifyCompany, reqNotifyCompany, reqNotifyCompany, "", "", tmpSubject, tmpBody
						  </WTCUSTOM>
					  </WTCODEGROUP>
				</WTCODEGROUP>

				</WTOBJECT>
        
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
				  <WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					  <WTMETHOD name="Load">
						  <WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
					  <WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					  <WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(NewMemberID)"/>
					  <WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					  <WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					  <WTSETATTRIBUTES/>
					  <WTMETHOD name="Add">
						  <WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						  <WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						  <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					  </WTMETHOD>
				  </WTOBJECT>

				  <!-- Custom Company Activation Processing -->
				  <WTCODEGROUP>
					  <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						  <WTMETHOD name="Custom">
							  <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							  <WTPARAM name="Status" direction="input" value="CONST(100)"/>
							  <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
							  <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Count" direction="return" datatype="number"/>
						  </WTMETHOD>
					  </WTOBJECT>
				  </WTCODEGROUP>

				  <!-- Custom Company Payment Post Processing -->
				  <WTCODEGROUP>
					  <WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					  <WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
					  <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
					  <WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						  <WTMETHOD name="Custom">
							  <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							  <WTPARAM name="Status" direction="input" value="CONST(99)"/>
							  <WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
							  <WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							  <WTPARAM name="Count" direction="return" datatype="number"/>
						  </WTMETHOD>
					  </WTOBJECT>
					  <WTCALLSUB name="CommissionEmail reqCompanyID, PaymentID, 0, 0, tmpTotal">
						  <WTCONDITION expr="CONST(EmailBonuses)" oper="not-equal" value="CONST(0)"/>
					  </WTCALLSUB>
				  </WTCODEGROUP>
  		  </WTCODEGROUP>
        
				<WTCALLSUB name="LogMemberNote reqNewMemberID, &quot;ENROLL ERROR: &quot; + err.description + xmlError">
					<WTCONDITION expr="IsErrors"/>
					<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
           <WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="PARAM(FirstName)">
						<WTCONDITION expr="ATTR(NameFirst)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="PARAM(LastName)">
						<WTCONDITION expr="ATTR(NameLast)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(Email)" value="PARAM(EmailAddress)">
						<WTCONDITION expr="ATTR(Email)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(NewLogon)" value="PARAM(UserName)">
						<WTCONDITION expr="ATTR(NewLogon)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="CONST(Len(.CountryID))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="PARAM(PayType)">
            <WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(&quot;&quot;)"/>
            <WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(&quot;0&quot;)" connector="or"/>
          </WTSETATTRIBUTE>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
      </WTSUB>

      <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
      <WTSUB name="LoadLists">
        <WTCALLSUB name="LoadAgree"/>
        <WTCALLSUB name="LoadCountrys"/>
        <WTCALLSUB name="LoadPaymentOptions"/>
        <WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
          <WTCONDITION expr="NoErrors"/>
          <WTMETHOD name="Load">
            <WTPARAM name="CountryID" direction="input" value="PARAM(CountryID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTSETATTRIBUTE name="PARAM(CountryName)" value="ATTR(CountryName)" />
          <WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="PARAM(CountryIDb)"/>
            <WTMETHOD name="Load">
              <WTPARAM name="CountryID" direction="input" value="PARAM(CountryIDb)"/>
              <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
            </WTMETHOD>
            <WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="DuplicateEmail">
        <WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
        <WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
          <WTMETHOD name="ExistEmail">
            <WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
            <WTPARAM name="Email" direction="input" value="CONST(tmpEmail)"/>
            <WTPARAM name="MemberID" direction="return" datatype="number"/>
          </WTMETHOD>
          <WTCODEGROUP>
            <WTCONDITION expr="CONST(MemberID)" oper="not-equal" value="CONST(0)"/>
            <WTERROR number="10123" message="Oops, This email address is already assigned to someone else."/>
          </WTCODEGROUP>
        </WTOBJECT>
      </WTSUB>

      <WTSUB name="ValidateContact">
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
        <WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10125" message="Oops, Please enter a First Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10126" message="Oops, Please enter a Last Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
					<WTCUSTOM>
						If ValidEmail( tmpEmail ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
					</WTCUSTOM>
				</WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="NoErrors"/>
          <WTCONDITION expr="NotDuplicateEmail" connector="and"/>
          <WTCALLSUB name="DuplicateEmail"/>
        </WTCODEGROUP>
        <WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(LEN(tmpPassword))" oper="less" value="CONST(6)"/>
						<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTSUB>

			<WTSUB name="ValidateMembership">
			</WTSUB>

			<WTSUB name="ValidatePayment">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)" connector="and"/>
          <WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="CONST(lcase(tmpCardNumber))" />
					<WTCODEGROUP>
            <WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)"/>
            <WTERROR number="10128" message="Oops, You must agree to the payment terms."/>
					</WTCODEGROUP>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidateConfirm">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(IsCaptcha)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(TestCaptcha)" value="FORM(Captcha)" />
					<WTCUSTOM>
						If IsEmpty(Session("ASPCAPTCHA")) or Trim(Session("ASPCAPTCHA")) = "" Then
							DoError 0, "", "Oops, Your time has expired! Please reenter."
						else
							' Uppercase fix for turkish charset
							TestCaptcha = Replace(TestCaptcha, "i", "I", 1, -1, 1)
							TestCaptcha = Replace(TestCaptcha, "", "I", 1, -1, 1)
							TestCaptcha = Replace(TestCaptcha, "", "I", 1, -1, 1)
							TestCaptcha = UCase(TestCaptcha)

							If StrComp(TestCaptcha, Trim(Session("ASPCAPTCHA")), 1) &lt;&gt; 0 Then
								DoError 0, "", "Oops, You entered the wrong security answer! Please reenter."
								reqCaptcha = ""
							End If
							' IMPORTANT: Must remove session value for security after the CAPTCHA test
							Session("ASPCAPTCHA") = vbNullString
							Session.Contents.Remove("ASPCAPTCHA")
						End If
					</WTCUSTOM>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTACTION id="0" name="New" type="New">
        <WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
          <WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
        </WTSETATTRIBUTE>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
          <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(3)">
            <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
            <WTCONDITION expr="PARAM(PXSponsorID)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          </WTSETATTRIBUTE>
        </WTCODEGROUP>
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(NEXXUS)"/>
          <WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
            <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
            <WTCONDITION expr="PARAM(PXSponsorID)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
          </WTSETATTRIBUTE>
        </WTCODEGROUP>
        <WTCALLSUB name="LoadMember"/>
        <WTCALLSUB name="LoadLists"/>
        <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-AGREE)">
          <WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST(&quot;&quot;)"/>
        </WTSETATTRIBUTE>
      </WTACTION>

			<WTACTION id="1" name="Submit" type="New">
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
          <WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
        </WTCODEGROUP>
        <WTCALLSUB name="ValidateContact">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidateMembership">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidatePayment">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTCALLSUB name="ValidateConfirm">
          <WTCONDITION expr="NoErrors"/>
        </WTCALLSUB>
        <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONFIRM)">
          <WTCONDITION expr="NoErrors"/>
        </WTSETATTRIBUTE>
        <WTCALLSUB name="LoadMember"/>
				<WTCALLSUB name="LoadLists">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
      </WTACTION>

			<WTACTION id="2" name="Process" type="Add">
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
        <WTCODEGROUP>
          <WTCONDITION expr="IsErrors"/>
          <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-AGREE)"/>
          <WTCALLSUB name="LoadMember"/>
          <WTCALLSUB name="LoadLists"/>
        </WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
          <WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PROCESS)"/>
          <WTSETATTRIBUTE name="CONST(tmpLogon)" value="FORM(NewLogon)"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
          <WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Welcome.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
						<WTMETHOD name="Load" />
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
						</WTMETHOD>
						<WTCUSTOM>
              xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqNewMemberID) )
              xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
              xmlHTMLFile = Replace( xmlHTMLFile, "{pwd}", tmpPassword )
            </WTCUSTOM>
					</WTOBJECT>
				</WTCODEGROUP>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="540" align="left"/>

				<WTFUNCTION name="ToggleType()">
					var payobj = Business.elements['PayType'];
					if( payobj != null ) {
						var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleCash = 'none'; var VisibleWallet = 'none'; var VisibleBitCoin = 'none'; var VisibleAddress = 'none';
						var paytype=1;
						var l = payobj.length;
						if( l == null ) {
							if( payobj.checked ) {
								paytype = payobj.value
							}
						}
						else {
							for( i = 0; i &lt; l; i++ ) {
								if (payobj[i].checked) {
									paytype = payobj[i].value;
									i = l;
								}
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						if (paytype == 7) VisibleCash = '';
						if (paytype &lt;= 5) VisibleAddress = '';
						if (paytype &gt;= 11 &amp;&amp; paytype &lt;= 13) VisibleWallet = '';
            if (paytype == 14) VisibleBitCoin = '';
            if (paytype == 16) VisibleBitCoin = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          document.getElementById('BitCoinRows').style.display = VisibleBitCoin;
          document.getElementById('CashRows').style.display = VisibleCash;
          document.getElementById('BillingAddress').style.display = VisibleAddress;
          }
        </WTFUNCTION>
				
				<WTFUNCTION name="CheckType(val)">
					var payobj = Business.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>
				
<!--				
				<WTFUNCTION name="ShowTaxIDType()">
					var countryid = document.getElementById('CountryID').value;
					if( countryid == 224 ) {
						document.getElementById('TaxIDType1').style.display = '';
						document.getElementById('TaxIDType2').style.display = 'none';
					}	
					else {
						document.getElementById('TaxIDType1').style.display = 'none';
						document.getElementById('TaxIDType2').style.display = '';
					}	
				</WTFUNCTION>
-->
<!--
				<WTFUNCTION name="CheckType(val)">
					ToggleType();
				</WTFUNCTION>
-->
				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatPhone(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					if( newval.length == 10 ) {
					obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
					}
					if( newval.length == 11 ) {
					obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
					}
					if( newval.length == 12 ) {
					obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
					}
				</WTFUNCTION>
<!--				
				<WTFUNCTION name="FormatTaxID(obj)">
					var countryid = document.getElementById('CountryID').value;
					var taxidtype = document.getElementById('TaxIDType1').value;
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					if( countryid == 224 ) {
						if( taxidtype == 1 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Social Security Number'); }
							else {
								obj.value = newval.substring(0,3) + '-' + newval.substring(3,5) + '-' + newval.substring(5,9);
							}
						}
						if( taxidtype == 2 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Employer Identification Number'); }
							else {
								obj.value = newval.substring(0,2) + '-' + newval.substring(2,9);
							}
						}
					}
				</WTFUNCTION>
-->
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					//if( newval.length &lt; 3 ) {
					//alert('Oops, Invalid Security Code');
					//}
				</WTFUNCTION>
				<WTFUNCTION name="FormatLogon(obj)">
					var val = obj.value;
					var newval = val.replace(/[^0-9a-zA-Z]/g, '');
					obj.value = newval;
					if( newval.length &lt; 6 ) {
					alert('Oops, Logon must be at least 6 characters or numbers.');
					}
				</WTFUNCTION>
				<WTFUNCTION name="ShowCC()">
					var disp, membership = document.getElementById('Membership').value;
					if( membership == 5 ) { disp = '' } else { disp = 'none' }
					document.getElementById('CCRequired').style.display = disp;
					if( membership == 5 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					//document.getElementById('Payment').style.display = disp;
					//document.getElementById('CardRows').style.display = disp;
					//document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="Init()">
          var mode = document.getElementById('Mode').value;
          if( mode == 1 ) {
            //ShowTaxIDType();
            ToggleType();
          }
        </WTFUNCTION>

				<WTFUNCTION name="MsgBox(msg)">
					alert(msg);
				</WTFUNCTION>

				<WTLOAD>Init();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(Mode)"/>
					<WTHIDDEN value="PARAM(NewMemberID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(PayID)"/>
					<WTHIDDEN value="PARAM(TokenOwner)"/>
					<WTHIDDEN value="PARAM(TokenType)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(NoValidate)"/>
					<WTHIDDEN value="PARAM(ReferID)"/>
					<WTHIDDEN value="PARAM(ReferredBy)"/>
					<WTHIDDEN value="PARAM(Placement)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>
        <WTSTATIC label="CompanyNameTip"/>
        <WTSTATIC label="Email2Tip"/>
        <WTSTATIC label="Checking"/>
        <WTSTATIC label="Savings"/>

        <WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(BadPayment)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="3" label="BadPaymentText" class="PageHeading" fontcolor="red" align="left"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(ReferredBy)" oper="equal" value="CONST('')"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(GetMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
								<WTSTATIC label="GetMemberID"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="MemberID" />
							<WTTEXT col="3" value="PARAM(MemberID)" size="6">
								<WTENTER>if(this.value==0){this.value=''}</WTENTER>
							</WTTEXT>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(GetMemberID)" oper="equal" value="CONST(0)"/>
            <WTROW margin-top="24" margin-bottom="12">
							<WTSTATIC col="1" merge="3" align="center" class="PageHeading" fontcolor="red">
								<WTSTATIC label="NoReferral1" newline="2"/>
								<WTSTATIC label="NoReferral2"/>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<!-- === Agreement ====================================================== -->
        <WTCODEGROUP>
          <WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>

          <WTROW margin-top="6">
					  <WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
				  </WTROW>
				  <WTROW margin-top="6" margin-bottom="12">
					  <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
				  </WTROW>
				  <WTROW margin-bottom="12">
					  <WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
					  <WTSTATIC col="1" merge="3" align="center" bold="true">
						  <WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
						  <WTCODEGROUP>
							  <WTCONDITION expr="PARAM(Placement)" oper="not-equal" value="CONST('')"/>
							  <WTSTATIC newline="1"/>
							  <WTSTATIC tag="Placement" value="PARAM(Placement)"/>
						  </WTCODEGROUP>
					  </WTSTATIC>
				  </WTROW>
          <WTROW margin-bottom="12">
            <WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(divider)" />
          </WTROW>
        
				  <!-- === Contact Information ============================================ -->
				  <WTROW margin-bottom="6">
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2" tag="MemberName"/>
					  <WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true" required="false">
						  <WTEXIT>TitleCase(this);</WTEXIT>
					  </WTTEXT>
					  <WTTEXT col="3" value="ATTR(Member.NameLast)" width="340" label="NameLast" size="25" required="false">
						  <WTEXIT>TitleCase(this);</WTEXIT>
					  </WTTEXT>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2">
						  <WTSTATIC label="CompanyName"/>
						  <WTCODEGROUP>
							  <WTIMAGE value="CONST(TipQuestion.gif)" alt="CompanyNameTip">
								  <WTLINK name="CONST(alert('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='CompanyNameTip']&quot;/&gt;');)" click="true" />
							  </WTIMAGE>
						  </WTCODEGROUP>
						  <WTSTATIC space="1"/>
					  </WTSTATIC>
					  <WTTEXT col="3" value="ATTR(Member.CompanyName)" size="60"/>
				  </WTROW>
				  <WTROW margin-top="6">
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2" tag="Email"/>
					  <WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="false"/>
				  </WTROW>
				  <WTROW>
					  <WTCONDITION expr="PARAM(TextEmail)" oper="not-equal" value="CONST(0)"/>
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2">
						  <WTSTATIC label="Email2"/>
						  <WTCODEGROUP>
							  <WTIMAGE value="CONST(TipQuestion.gif)" alt="Email2Tip">
								  <WTLINK name="CONST(MsgBox('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='Email2Tip']&quot;/&gt;');)" click="true" />
							  </WTIMAGE>
						  </WTCODEGROUP>
						  <WTSTATIC space="1"/>
					  </WTSTATIC>
					  <WTTEXT col="3" value="ATTR(Member.Email2)" size="60" required="false"/>
					  <WTSTATIC col="3">
						  <WTCODEGROUP>
							  <WTIMAGE value="CONST(LearnMore.gif)">
								  <WTLINK name="Page" target="Help"><WTPARAM name="Page" value="CONST(Email2)"/></WTLINK>
							  </WTIMAGE>
						  </WTCODEGROUP>
					  </WTSTATIC>
				  </WTROW>
				  <WTROW margin-top="6">
					  <WTSTATIC col="1" />
					  <WTSTATIC col="2" tag="Address" />
					  <WTTEXT col="3" value="ATTR(Address.Street1)" size="60">
						  <WTEXIT>document.getElementById('Street1b').value = this.value;</WTEXIT>
					  </WTTEXT>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1" />
					  <WTSTATIC col="2"/>
					  <WTTEXT col="3" value="ATTR(Address.Street2)" size="60">
						  <WTEXIT>document.getElementById('Street2b').value = this.value;</WTEXIT>
					  </WTTEXT>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1" />
					  <WTSTATIC col="2"/>
					  <WTTEXT col="3" value="ATTR(Address.City)" width="200" label="City" size="27" required="false">
						  <WTEXIT>TitleCase(this); document.getElementById('Cityb').value = this.value;</WTEXIT>
					  </WTTEXT>
					  <WTTEXT col="3" value="ATTR(Address.State)" width="340" label="State" size="27" required="false">
						  <WTEXIT>TitleCase(this); document.getElementById('Stateb').value = this.value;</WTEXIT>
					  </WTTEXT>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1" />
					  <WTSTATIC col="2" />
					  <WTTEXT col="3" value="ATTR(Address.Zip)" width="100" label="Zip" size="8" required="false">
						  <WTEXIT>document.getElementById('Zipb').value = this.value;</WTEXIT>
					  </WTTEXT>
					  <WTCOMBO col="3" value="ATTR(Address.CountryID)" width="440" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
						  <WTEXIT>document.getElementById('CountryIDb').value = this.value;</WTEXIT>
					  </WTCOMBO>
				  </WTROW>
          <WTROW margin-top="6">
            <WTSTATIC col="1"/>
            <WTSTATIC col="2" tag="Phone"/>
            <WTTEXT col="3" value="ATTR(Member.Phone1)" size="20">
              <WTEXIT>FormatPhone(this);</WTEXIT>
            </WTTEXT>
          </WTROW>
<!--
          <WTROW margin-top="6">
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTSTATIC col="1"/>
            <WTSTATIC col="2" tag="OptFld1"/>
            <WTTEXT col="3" value="PARAM(OptFld1)" size="5" class="prompt"/>
            <WTSTATIC col="3" label="OptFld1Text"/>
          </WTROW>
-->          
          <WTROW margin-top="12" margin-bottom="6">
					  <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
				  </WTROW>
				  <WTROW margin-bottom="6">
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2" tag="NewLogon"/>
					  <WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20" class="prompt">
						  <WTEXIT>FormatLogon(this);</WTEXIT>
					  </WTTEXT>
					  <WTSTATIC col="3" label="LogonTip"/>
				  </WTROW>
				  <WTROW>
					  <WTSTATIC col="1"/>
					  <WTSTATIC col="2" tag="NewPassword"/>
					  <WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20" secure="false" class="prompt">
						  <WTEXIT>if(this.value==''){alert('Oops, Password Required!');}</WTEXIT>
					  </WTTEXT>
					  <WTSTATIC col="3" label="PasswordText"/>
				  </WTROW>
          <WTROW margin-top="24" margin-bottom="12">
            <WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(divider)" />
          </WTROW>

          <!-- === Membership ===================================================== -->
          <!-- NEXXUS -->
          <WTCODEGROUP>
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTROW margin-bottom="12">
              <WTTABLE col="1" merge="3">
                <WTCOLUMN width="60" align="left"/>
                <WTCOLUMN width="30" align="left"/>
                <WTCOLUMN width="660" align="left"/>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" merge="2" label="Membership21_Text" class="PageHeading" fontcolor="blue" align="left"/>
                </WTROW>
                <WTROW margin-top="18" margin-bottom="18">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="0" align="left" valign="top" datapathx="/DATA/PARAM/@membership=0"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership21_0" bold="true" newline="1"/>
                    <WTSTATIC label="Membership21_0a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership21_3" bold="true" newline="1"/>
                    <WTSTATIC label="Membership21_3a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership21_2" bold="true" newline="1"/>
                    <WTSTATIC label="Membership21_2a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership21_1" bold="true" newline="1"/>
                    <WTSTATIC label="Membership21_1a"/>
                  </WTSTATIC>
                </WTROW>
                <!--
                <WTROW margin-top="24">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="6" align="left" valign="top" datapathx="/DATA/PARAM/@membership=6"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership21_6" bold="true" newline="1"/>
                    <WTSTATIC label="Membership21_6a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="5" align="left" valign="top" datapathx="/DATA/PARAM/@membership=5"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership21_5" bold="true" newline="1"/>
                    <WTSTATIC label="Membership21_5a"/>
                  </WTSTATIC>
                </WTROW>
                <WTROW margin-top="12">
                  <WTSTATIC col="1"/>
                  <WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
                  <WTSTATIC col="3">
                    <WTSTATIC label="Membership21_4" bold="true" newline="1"/>
                    <WTSTATIC label="Membership21_4a"/>
                  </WTSTATIC>
                </WTROW>
-->                
<!--
                <WTROW margin-top="18">
                  <WTSTATIC col="1"/>
                  <WTSTATIC col="2" merge="2" label="Membership21_Text2" class="prompt" fontcolor="blue" align="left"/>
                </WTROW>
-->                
              </WTTABLE>
            </WTROW>
          </WTCODEGROUP>
          <WTROW margin-top="24" margin-bottom="12">
            <WTDIVIDER col="1" merge="3" align="left" height="1" color="SYS(divider)" />
          </WTROW>

          <!-- === Payment ========================================================= -->
				  <WTCODEGROUP>
            <WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
<!--
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
              <WTROW margin-bottom="12">
                <WTSTATIC col="1" merge="3" label="PaymentText_21" align="center" bold="true" fontcolor="red" class="PageHeading"/>
              </WTROW>
            </WTCODEGROUP>
-->
            <WTROW id="Payment">
						  <WTTABLE col="1" merge="3">
							  <WTCOLUMN width="750" align="center"/>

							  <WTROW id="Pay2" margin-bottom="12">
								  <WTSTATIC col="1" align="center" class="prompt">
									  <WTSTATIC label="PaymentText">
										  <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(17)"/>
									  </WTSTATIC>
									  <WTSTATIC label="BitCoinPayments">
										  <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(17)"/>
									  </WTSTATIC>
								  </WTSTATIC>
							  </WTROW>
							  <WTROW id="Pay3" margin-bottom="6">
								  <WTSTATIC col="1" align="center">
									  <WTCODEGROUP>
										  <WTCONDITION expr="_IsPaymentVisa"/>
										  <WTRADIO group="PayType" name="1" check="/DATA/TXN/PTSBILLING/@paytype=1">
											  <WTCLICK>ToggleType();</WTCLICK>
										  </WTRADIO>
										  <WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
											  <WTCLICK>CheckType(1);</WTCLICK>
										  </WTIMAGE>
									  </WTCODEGROUP>
									  <WTCODEGROUP>
										  <WTCONDITION expr="_IsPaymentMC"/>
										  <WTSTATIC space="3"/>
										  <WTRADIO group="PayType" name="2" check="/DATA/TXN/PTSBILLING/@paytype=2">
											  <WTCLICK>ToggleType();</WTCLICK>
										  </WTRADIO>
										  <WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
											  <WTCLICK>CheckType(2);</WTCLICK>
										  </WTIMAGE>
									  </WTCODEGROUP>
									  <WTCODEGROUP>
										  <WTCONDITION expr="_IsPaymentDiscover"/>
										  <WTSTATIC space="3"/>
										  <WTRADIO group="PayType" name="3" check="/DATA/TXN/PTSBILLING/@paytype=3">
											  <WTCLICK>ToggleType();</WTCLICK>
										  </WTRADIO>
										  <WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
											  <WTCLICK>CheckType(3);</WTCLICK>
										  </WTIMAGE>
									  </WTCODEGROUP>
									  <WTCODEGROUP>
										  <WTCONDITION expr="_IsPaymentAmex"/>
										  <WTSTATIC space="3"/>
										  <WTRADIO group="PayType" name="4" check="/DATA/TXN/PTSBILLING/@paytype=4">
											  <WTCLICK>ToggleType();</WTCLICK>
										  </WTRADIO>
										  <WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
											  <WTCLICK>CheckType(4);</WTCLICK>
										  </WTIMAGE>
									  </WTCODEGROUP>
									  <WTCODEGROUP>
										  <WTCONDITION expr="_IsPaymentCheck"/>
										  <WTSTATIC space="3"/>
										  <WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
											  <WTCLICK>ToggleType();</WTCLICK>
										  </WTRADIO>
										  <WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
											  <WTCLICK>CheckType(5);</WTCLICK>
										  </WTIMAGE>
									  </WTCODEGROUP>
									  <WTCODEGROUP>
										  <WTCONDITION expr="_IsPaymenteWallet"/>
										  <WTCODEGROUP>
											  <WTCONDITION expr="_IsPaymentiPayout"/>
											  <WTSTATIC space="3"/>
											  <WTRADIO group="PayType" name="11" check="/DATA/TXN/PTSBILLING/@paytype=11">
												  <WTCLICK>ToggleType();</WTCLICK>
											  </WTRADIO>
											  <WTIMAGE value="CONST(PayType11.gif)" imgalign="absmiddle">
												  <WTCLICK>CheckType(11);</WTCLICK>
											  </WTIMAGE>
										  </WTCODEGROUP>
										  <WTCODEGROUP>
											  <WTCONDITION expr="_IsPaymentPayQuicker"/>
											  <WTSTATIC space="3"/>
											  <WTRADIO group="PayType" name="12" check="/DATA/TXN/PTSBILLING/@paytype=12">
												  <WTCLICK>ToggleType();</WTCLICK>
											  </WTRADIO>
											  <WTIMAGE value="CONST(PayType12.gif)" imgalign="absmiddle">
												  <WTCLICK>CheckType(12);</WTCLICK>
											  </WTIMAGE>
										  </WTCODEGROUP>
										  <WTCODEGROUP>
											  <WTCONDITION expr="_IsPaymentSolidTrust"/>
												  <WTSTATIC space="3"/>
											  <WTRADIO group="PayType" name="13" check="/DATA/TXN/PTSBILLING/@paytype=13">
												  <WTCLICK>ToggleType();</WTCLICK>
											  </WTRADIO>
											  <WTIMAGE value="CONST(PayType13.gif)" imgalign="absmiddle">
												  <WTCLICK>CheckType(13);</WTCLICK>
											  </WTIMAGE>
										  </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentBitCoin"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="14" check="/DATA/TXN/PTSBILLING/@paytype=14">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType14.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(14);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentBitCoinCash"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="15" check="/DATA/TXN/PTSBILLING/@paytype=15">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType15.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(15);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
                      <WTCODEGROUP>
                        <WTCONDITION expr="_IsPaymentNexxus"/>
                        <WTSTATIC space="3"/>
                        <WTRADIO group="PayType" name="16" check="/DATA/TXN/PTSBILLING/@paytype=16">
                          <WTCLICK>ToggleType();</WTCLICK>
                        </WTRADIO>
                        <WTIMAGE value="CONST(PayType16.gif)" imgalign="absmiddle">
                          <WTCLICK>CheckType(16);</WTCLICK>
                        </WTIMAGE>
                      </WTCODEGROUP>
                    </WTCODEGROUP>
									  <WTCODEGROUP>
										  <WTCONDITION expr="PARAM(CashPayment)" oper="not-equal" value="CONST(0)"/>
										  <WTCODEGROUP>
											  <WTCONDITION expr="_IsPaymentCash"/>
											  <WTSTATIC space="3"/>
											  <WTRADIO group="PayType" name="7" check="/DATA/TXN/PTSBILLING/@paytype=7">
												  <WTCLICK>ToggleType();</WTCLICK>
											  </WTRADIO>
											  <WTIMAGE value="CONST(PayType7.gif)" imgalign="absmiddle">
												  <WTCLICK>CheckType(7);</WTCLICK>
											  </WTIMAGE>
										  </WTCODEGROUP>
										  <WTCODEGROUP>
											  <WTCONDITION expr="_IsPaymentPO"/>
											  <WTSTATIC space="3"/>
											  <WTRADIO group="PayType" name="8" check="/DATA/TXN/PTSBILLING/@paytype=8">
												  <WTCLICK>ToggleType();</WTCLICK>
											  </WTRADIO>
											  <WTIMAGE value="CONST(PayType8.gif)" imgalign="absmiddle">
												  <WTCLICK>CheckType(8);</WTCLICK>
											  </WTIMAGE>
										  </WTCODEGROUP>
									  </WTCODEGROUP>
								  </WTSTATIC>
							  </WTROW>
						  </WTTABLE>
					  </WTROW>

					  <WTROW id="CashRows" style="display:none">
						  <WTTABLE col="1" merge="2">
							  <WTCOLUMN width="100" align="right"/>
							  <WTCOLUMN width="500" align="left"/>
							  <WTCODEGROUP>
								  <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
								  <WTROW margin-top="6" margin-bottom="6">
									  <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
								  </WTROW>
								  <WTROW margin-bottom="6">
									  <WTSTATIC col="1" merge="3" label="CashPayment15" align="center" bold="true" fontcolor="blue"/>
								  </WTROW>
							  </WTCODEGROUP>
						  </WTTABLE>
					  </WTROW>

					  <WTROW id="WalletRows" style="display:none">
						  <WTTABLE col="1" merge="3">
							  <WTCOLUMN width="100" align="right"/>
							  <WTCOLUMN width="500" align="left"/>
							  <WTROW margin-top="6" margin-bottom="6">
								  <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="WalletName"/>
								  <WTTEXT col="2" value="PARAM(Wallet)" required="true"/>
							  </WTROW>
						  </WTTABLE>
					  </WTROW>

					  <WTROW id="BitCoinRows" style="display:none">
              <WTTABLE col="1" merge="3">
							  <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(17)"/>
							  <WTCOLUMN width="100" align="right"/>
							  <WTCOLUMN width="500" align="left"/>
                <WTROW margin-top="6" margin-bottom="6">
								  <WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" merge="2" label="BitCoinPayments" class="PageHeading" fontcolor="red" align="center"/>
							  </WTROW>
						  </WTTABLE>
					  </WTROW>

					  <WTROW id="CardRows" style="display:none">
						  <WTSTATIC col="1"/>
						  <WTTABLE col="2" merge="2">
							  <WTCOLUMN width="100" align="right"/>
							  <WTCOLUMN width="500" align="left"/>
							  <WTROW>
								  <WTSTATIC col="1" tag="CardNumber"/>
								  <WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
									  <WTEXIT>var x = this.value; if(x.tolowercase() != 'paypal'){this.value = x.replace(/[^\d]/g, '')};</WTEXIT>
								  </WTTEXT>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="CardDate"/>
								  <WTCOMBO col="2" value="ATTR(Billing.CardMo)">
									  <WTOPTION id="" label="Select"/>
									  <WTOPTION id="1" label="January"/>
									  <WTOPTION id="2" label="February"/>
									  <WTOPTION id="3" label="March"/>
									  <WTOPTION id="4" label="April"/>
									  <WTOPTION id="5" label="May"/>
									  <WTOPTION id="6" label="June"/>
									  <WTOPTION id="7" label="July"/>
									  <WTOPTION id="8" label="August"/>
									  <WTOPTION id="9" label="September"/>
									  <WTOPTION id="10" label="October"/>
									  <WTOPTION id="11" label="November"/>
									  <WTOPTION id="12" label="December"/>
								  </WTCOMBO>
								  <WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
									  <WTOPTION id="" label="Select"/>
									  <WTOPTION id="13" label="2013"/>
									  <WTOPTION id="14" label="2014"/>
									  <WTOPTION id="15" label="2015"/>
									  <WTOPTION id="16" label="2016"/>
									  <WTOPTION id="17" label="2017"/>
									  <WTOPTION id="18" label="2018"/>
									  <WTOPTION id="19" label="2019"/>
									  <WTOPTION id="20" label="2020"/>
									  <WTOPTION id="21" label="2021"/>
									  <WTOPTION id="22" label="2022"/>
									  <WTOPTION id="23" label="2023"/>
									  <WTOPTION id="24" label="2024"/>
									  <WTOPTION id="25" label="2025"/>
									  <WTOPTION id="26" label="2026"/>
									  <WTOPTION id="27" label="2027"/>
									  <WTOPTION id="28" label="2028"/>
									  <WTOPTION id="29" label="2029"/>
									  <WTOPTION id="30" label="2030"/>
									  <WTOPTION id="31" label="2031"/>
									  <WTOPTION id="32" label="2032"/>
									  <WTOPTION id="33" label="2033"/>
									  <WTOPTION id="34" label="2034"/>
									  <WTOPTION id="35" label="2035"/>
								  </WTCOMBO>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="CardName"/>
								  <WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="CardCode"/>
								  <WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
									  <WTEXIT>FormatCardCode(this);</WTEXIT>
								  </WTTEXT>
								  <WTSTATIC col="2">
									  <WTCODEGROUP>
										  <WTTOOLTIP>
											  <WTIMAGE value="CONST(SymbolHelp.gif)"/>
											  <WTTIP>
												  <WTIMAGE value="CONST(SecurityCode.png)"/>
											  </WTTIP>
										  </WTTOOLTIP>
									  </WTCODEGROUP>
								  </WTSTATIC>
							  </WTROW>
						  </WTTABLE>
					  </WTROW>

					  <WTROW id="CheckRows" style="display:none">
						  <WTSTATIC col="1"/>
						  <WTTABLE col="2" merge="2">
							  <WTCOLUMN width="100" align="right"/>
							  <WTCOLUMN width="500" align="left"/>
							  <WTROW>
								  <WTSTATIC col="1" tag="CheckBank"/>
								  <WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25"/>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="CheckRoute"/>
								  <WTTEXT col="2" value="ATTR(Billing.CheckRoute)"/>
								  <WTSTATIC col="2">
									  <WTCODEGROUP>
										  <WTTOOLTIP>
											  <WTIMAGE value="CONST(SymbolHelp.gif)"/>
											  <WTTIP>
												  <WTIMAGE value="CONST(checkref.gif)"/>
											  </WTTIP>
										  </WTTOOLTIP>
									  </WTCODEGROUP>
								  </WTSTATIC>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="CheckAccount"/>
								  <WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25"/>
								  <WTSTATIC col="2">
									  <WTCODEGROUP>
										  <WTTOOLTIP>
											  <WTIMAGE value="CONST(SymbolHelp.gif)"/>
											  <WTTIP>
												  <WTIMAGE value="CONST(checkref.gif)"/>
											  </WTTIP>
										  </WTTOOLTIP>
									  </WTCODEGROUP>
								  </WTSTATIC>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="CheckAcctType"/>
								  <WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)"/>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1" tag="CheckName"/>
								  <WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25"/>
							  </WTROW>
						  </WTTABLE>
					  </WTROW>

					  <WTROW id="BillingAddress" style="display:none">
						  <WTSTATIC col="1"/>
						  <WTTABLE col="2" merge="2">
							  <WTCOLUMN width="100" align="right"/>
							  <WTCOLUMN width="500" align="left"/>
							  <WTROW>
								  <WTSTATIC col="1" tag="BillingAddress" />
								  <WTTEXT col="2" value="PARAM(Street1b)" size="60">
									  <WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
								  </WTTEXT>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1"/>
								  <WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1"/>
								  <WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
									  <WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
								  </WTTEXT>
								  <WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
									  <WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
								  </WTTEXT>
							  </WTROW>
							  <WTROW>
								  <WTSTATIC col="1"/>
								  <WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left">
									  <WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
								  </WTTEXT>
								  <WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
							  </WTROW>
						  </WTTABLE>
					  </WTROW>

					  <WTROW id="Secure" margin-top="12">
						  <WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
						  <WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
					  </WTROW>

					  <WTROW margin-top="6" margin-bottom="12">
						  <WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					  </WTROW>
					  <WTROW id="Agree2">
						  <WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
							  <WTCODEGROUP>
								  <WTCHECK value="PARAM(IsAgree2)"/>
							  </WTCODEGROUP>
                <WTCODEGROUP>
								  <WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(0)"/>
								  <WTSTATIC label="IsAgree2Billed">
									  <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(GCR)"/>
								  </WTSTATIC>
								  <WTSTATIC label="IsAgree2Monthly">
                    <WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYSCON(GCR)"/>
                  </WTSTATIC>
							  </WTCODEGROUP>
							  <WTSTATIC label="IsAgree2Annually">
								  <WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(2)"/>
							  </WTSTATIC>
							  <WTSTATIC label="IsAgree2OneTime">
								  <WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(1)"/>
							  </WTSTATIC>
              </WTSTATIC>
					  </WTROW>
					  <WTROW margin-top="12">
						  <WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
						  <WTSTATIC col="1" merge="3" align="center">
							  <WTCODEGROUP>
								  <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
								  <WTCOMBO value="PARAM(BillDay)">
									  <WTOPTION id="1" label="BillDay1"/>
									  <WTOPTION id="15" label="BillDay15"/>
								  </WTCOMBO>
							  </WTCODEGROUP>
						  </WTSTATIC>
					  </WTROW>
            <WTROW>
              <WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
                <WTCODEGROUP>
                  <WTCHECK value="PARAM(IsAgree)"/>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>

            <WTROW margin-top="24" margin-bottom="12">
						  <WTBUTTON col="1" merge="3" action="1" value="CONST(Continue)" align="center"/>
					  </WTROW>
				  </WTCODEGROUP>
        </WTCODEGROUP>

        <!-- === Confirm ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(BillDay)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
          <WTHIDDEN value="PARAM(CountryIDb)"/>
          <WTHIDDEN value="PARAM(OptFld1)"/>

          <WTROW>
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="100" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.NameLast)" newline="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.CompanyName)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Email)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Reference)" newline="1">
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
									</WTSTATIC>
									<WTSTATIC value="ATTR(Member.Phone1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.Street1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.City)" space="1"/>
									<WTSTATIC value="ATTR(Address.State)" space="1"/>
									<WTSTATIC value="ATTR(Address.Zip)" newline="1"/>
									<WTSTATIC value="PARAM(CountryName)" newline="1"/>
									<WTSTATIC tag="Logon" value="ATTR(Member.NewLogon)" space="2"/>
									<WTSTATIC value="ATTR(Member.NewPassword)"/>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)"/>
									<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
									<WTSTATIC label="BillingInfo" newline="1" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="greater-equal" value="CONST(1)"/>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="less-equal" value="CONST(4)" connector="and"/>
										<WTSTATIC value="ATTR(Billing.CardNumber)" newline="1"/>
										<WTSTATIC tag="Expires" value="ATTR(Billing.CardMo)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CardYr)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CardName)" newline="1"/>
										<WTSTATIC tag="Code" value="ATTR(Billing.CardCode)" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(5)"/>
										<WTSTATIC value="ATTR(Billing.CheckBank)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckRoute)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CheckAccount)" newline="1"/>
										<WTSTATIC label="Checking">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
										<WTSTATIC label="Savings">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(2)"/>
										</WTSTATIC>
										<WTSTATIC newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckName)" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(7)"/>**
										<WTSTATIC label="CashPayment" newline="1"/>
										<WTSTATIC label="CashPayment15"> <!-- CIS -->
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(11)"/>
										<WTSTATIC tag="iPayout" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(12)"/>
										<WTSTATIC tag="PayQuicker" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(13)"/>
										<WTSTATIC tag="SolidTrust" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(14)"/>
                    <WTSTATIC label="BitCoinPayments"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
                    <WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(16)"/>
                    <WTSTATIC label="NexxusPayments"/>
                  </WTCODEGROUP>
                  <WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="less" value="CONST(7)"/>
										<WTSTATIC value="PARAM(Street1b)" newline="1"/>
										<WTSTATIC value="PARAM(Cityb)" space="1"/>
										<WTSTATIC value="PARAM(Stateb)" space="1"/>
										<WTSTATIC value="PARAM(Zipb)" newline="1"/>
										<WTSTATIC value="PARAM(CountryNameb)" newline="2"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTSTATIC col="1" merge="3" align="center" bold="true">
							<WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Placement)" oper="not-equal" value="CONST('')"/>
								<WTSTATIC newline="1"/>
								<WTSTATIC tag="Placement" value="PARAM(Placement)"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<!-- Custom Company Membership Info -->
          <WTCODEGROUP>
            <!-- NEXXUS-->
            <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
            <WTROW>
              <WTSTATIC col="1"/>
              <WTSTATIC col="2" merge="2" class="PageHeading" align="center">
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
                  <WTSTATIC label="Membership21_0" newline="1"/>
                  <WTSTATIC label="Membership21_0a"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
                  <WTSTATIC label="Membership21_1" newline="1"/>
                  <WTSTATIC label="Membership21_1a"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
                  <WTSTATIC label="Membership21_2" newline="1"/>
                  <WTSTATIC label="Membership21_2a"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
                  <WTSTATIC label="Membership21_3" newline="1"/>
                  <WTSTATIC label="Membership21_3a"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
                  <WTSTATIC label="Membership21_4" newline="1"/>
                  <WTSTATIC label="Membership21_4a"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(5)"/>
                  <WTSTATIC label="Membership21_5" newline="1"/>
                  <WTSTATIC label="Membership21_5a"/>
                </WTCODEGROUP>
                <WTCODEGROUP>
                  <WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(6)"/>
                  <WTSTATIC label="Membership21_6" newline="1"/>
                  <WTSTATIC label="Membership21_6a"/>
                </WTCODEGROUP>
              </WTSTATIC>
            </WTROW>
          </WTCODEGROUP>

          <WTFUNCTION name="RefreshCaptchaImage(valImageId)">
						var objImage = document.getElementById(valImageId)
						if (objImage != undefined) {
							var now = new Date();
							objImage.src = objImage.src.split('?')[0] + '?x=' + now.toUTCString();
						}
					</WTFUNCTION>
					
					<WTCODEGROUP>
						<!-- Required Captcha -->
						<WTCONDITION expr="PARAM(IsCaptcha)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="18">
							<WTIMAGE col="1" merge="3" value="CONST(captcha.asp)" imgpath="include/" id="imgCaptcha" align="center" imgalign="absmiddle" />
							<WTBUTTON col="1" merge="3" value="CONST(NewCaptcha)" align="center" btnclass="smbutton">
								<WTCLICK>RefreshCaptchaImage('imgCaptcha');</WTCLICK>
							</WTBUTTON>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="3" tag="WriteCaptcha" align="center"/>
							<WTTEXT col="1" merge="3" value="PARAM(Captcha)" size="10"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="0" align="center"/>
						<WTBUTTON col="1" merge="3" value="CONST(Confirm)" align="center">
							<WTCLICK> this.disabled = true; doSubmit(2,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Welcome ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PROCESS)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>


    <!-- Custom New Member Enrollment Form -->
		<!--============================================================================================-->
		<WTWEBPAGE name="m_Enroll" caption="New Member" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="m_Enroll">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="NewMemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="Price" datatype="currency"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Billing" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="NoBanner" datatype="number"/>
			<WTPARAM name="NoPayment" datatype="number"/>
			<WTPARAM name="NoRefer" datatype="number"/>
			<WTPARAM name="NoValidate" datatype="number"/>
			<WTPARAM name="TextEmail" datatype="number"/>

			<WTPARAM name="M" datatype="number"/>
			<!-- Referring Member -->
			<WTPARAM name="S" datatype="number"/>
			<!-- Sponsor -->
			<WTPARAM name="C" datatype="number"/>
			<!-- CompanyID -->

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>
			<WTPARAM name="CountryID" datatype="text"/>
			<WTPARAM name="CountryName" datatype="text"/>
			<WTPARAM name="CountryNameb" datatype="text"/>

			<WTPARAM name="TokenType" datatype="number"/>
			<WTPARAM name="TokenOwner" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="BadPayment" datatype="number"/>

			<!-- Mode 0 ... Agreement -->
			<!-- Mode 1 ... Contact Info -->
			<!-- Mode 2 ... Membership Selection -->
			<!-- Mode 3 ... Payment -->
			<!-- Mode 4 ... Confirmation -->
			<!-- Mode 5 ... Process/Welcome -->

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Title)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(1)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" />
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(&quot;&quot;)" />
					<WTSETATTRIBUTE name="PARAM(M)" value="CONST(0)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(S)" value="PARAM(M)">
					<WTCONDITION expr="PARAM(S)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)">
					<WTCONDITION expr="PARAM(CountryIDb)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(&quot;No Referrer&quot;)">
					<WTCONDITION expr="PARAM(NoRefer)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="CONST(ValidMemberStatus)" value="CONST(&quot;1234&quot;)"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="SYS(ActionCode)" oper="greater-equal" value="CONST(1)"/>
				<WTCONDITION expr="SYS(ActionCode)" oper="less-equal" value="CONST(4)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree)" value="FORM(IsAgree)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree2)" value="FORM(IsAgree2)"/>
				<WTCALLSUB name="LoadMember"/>
			</WTCODEGROUP>

			<!-- Custom Company Setup -->
			<WTCODEGROUP> <!-- myTrackerPro -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
				<WTSETATTRIBUTE name="PARAM(TextEmail)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(3)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				
				<!-- set the nobill option for WV people -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(GroupID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(GroupID)" oper="not-equal" value="CONST(0)"/>
					<WTCODEGROUP>
						<!-- 6528 Jefferson Santos -->
						<!-- 9096 David & Yvette Ulloa -->
						<!-- 9399 Jeff Johnston -->
						<!-- 9401 Scott Ross -->
						<!-- 9887 The Twins -->
						<!-- 11555 Byron Schrug -->
						<WTCONDITION expr="CONST(InStr( &quot;6528,9096,9399,9401,9887,11555&quot;, CStr(reqGroupID) ))" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(NoBill)" value="CONST(1)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<!-- Free Loyalty -->
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadPaymentOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadAgree">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_Enroll.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(TRIM(.NameFirst + &quot; &quot; + .NameLast))"/>
					<WTCUSTOM>
						If .Status &lt;&gt; "1" Then
						Response.Write "The Member that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
						Response.End
						End If
					</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon/Website Name is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidPhone">
				<WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10006" message="Oops, Phone Number is Required."/>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<WTSETATTRIBUTE name="CONST(reqPayType)" value="CONST(CLng(result))" />
						<!-- <WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="AddMember">
				<!-- Create Payout Record -->
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(8)"/>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)" connector="or"/>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)" connector="or"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(PayID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Set Paper Check -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(8)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-CHECK)"/>
					</WTCODEGROUP>
					<!-- Set eWallet -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(9)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Email)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
						<WTSETATTRIBUTE name="ATTR(CommType)" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="SYSCON(BILL-COMMTYPE-WALLET-PAYQUICKER)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Email)" />
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
					<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
					<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1)" />
					<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2)" />
					<WTSETATTRIBUTE name="ATTR(City)" value="FORM(City)" />
					<WTSETATTRIBUTE name="ATTR(State)" value="FORM(State)" />
					<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zip)" />
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryID)" />
					<WTMETHOD name="Save">
						<WTCONDITION expr="PARAM(PayID)" oper="not-equal" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Add">
						<WTCONDITION expr="PARAM(PayID)" oper="equal" value="CONST(0)"/>
						<WTPARAM name="reqPayID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
				</WTOBJECT>

				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPrice1)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice2)" value="ATTR(Price2)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice3)" value="ATTR(Price3)"/>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTCUSTOM>EmailBonuses = InStr(.Shopping, "N")</WTCUSTOM>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>

					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;Enrollment&quot;)"/>

					<!-- Custom Company Setup -->
					<WTCODEGROUP>
						<!-- myTrackerPro -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(30)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
						<WTCODEGROUP>
							<!-- myTrackerPro Membership -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(4.95)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- myTrackerPro Membership Plus -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(6.95)"/>
							<WTSETATTRIBUTE name="ATTR(Options)" value="CONST(&quot;AZhz&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- myTrackerPro Leader Membership -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(9.95)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- WV Free Memberships -->
							<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Free Loyalty -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTCODEGROUP>
							<!-- Marketing System -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102,201&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(19.95)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(199.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Account Manager -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(199.95)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Free Affiliate -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
						<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
						<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="PARAM(Billing)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(1)">
								<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
						<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
						<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
							<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
						<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;ABCDEFI&quot;)"/>

						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
<!--						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(S)"/>-->

						<WTMETHOD name="Add">
							<WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>

					<!-- Get Payment -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
						<!-- Payment Post Processing is done after the new member is activated below -->
						<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
						<WTCUSTOM>
							tmpProcessor = ""
							tmpAcct = ""
							Select Case reqPayType
							Case 1, 2, 3, 4	'Process Credit Cards
							tmpProcessor = tmpCardProcessor
							tmpAcct = tmpCardAcct
							Case 5 'Process Electronic Checks
							tmpProcessor = tmpCheckProcessor
							tmpAcct = tmpCheckAcct
							End Select
						</WTCUSTOM>
						<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqNewMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
							<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
							<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
							<WTMETHOD name="Save">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID
							oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Send notice to Referrer -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0437.asp?MemberID=" &amp; reqNewMemberID
							oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(NewMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- Custom Company Activation Processing -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(100)"/>
							<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>

				<!-- Custom Company Payment Post Processing -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(99)"/>
							<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCALLSUB name="CommissionEmail reqCompanyID, PaymentID, 0, 0, tmpTotal">
						<WTCONDITION expr="CONST(EmailBonuses)" oper="not-equal" value="CONST(0)"/>
					</WTCALLSUB>
				</WTCODEGROUP>

				<WTCALLSUB name="LogMemberNote reqNewMemberID, &quot;ENROLL ERROR: &quot; + err.description + xmlError">
					<WTCONDITION expr="IsErrors"/>
					<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="CONST(Len(.CountryID))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="PARAM(PayType)">
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidateContact">
				<!-- Validate Contact Mode -->
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
				<WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10125" message="Oops, Please enter a First Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10126" message="Oops, Please enter a Last Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
					<WTCUSTOM>
						If ValidEmail( tmpEmail ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
					</WTCUSTOM>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(LEN(tmpPassword))" oper="less" value="CONST(6)"/>
						<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTSUB>

			<WTSUB name="ValidateMembership">
				<!-- Validate Membership Mode -->
			</WTSUB>

			<WTSUB name="ValidatePayment">
				<!-- Validate Payment Mode -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="CONST(lcase(tmpCardNumber))" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)"/>
						<WTERROR number="10128" message="Oops, You must agree to be billed monthly."/>
					</WTCODEGROUP>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
				</WTCODEGROUP>
			</WTSUB>

			<!-- Validate the Previous Mode -->
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(NoValidate)" oper="equal" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
						<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
					<WTCALLSUB name="ValidateContact"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-MEMBERSHIP)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
					<WTCALLSUB name="ValidatePayment"/>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTACTION id="0" name="Agree" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-AGREE)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="1" name="Contact" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONTACT)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="2" name="Membership" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-MEMBERSHIP)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="3" name="Payment" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PAYMENT)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="4" name="Confirm" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONFIRM)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="5" name="Process" type="Add">
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PROCESS)"/>
					<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_Welcome.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
						<WTMETHOD name="Load" />
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>
			</WTACTION>

			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
				<WTCALLSUB name="LoadAgree"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
				<WTCALLSUB name="LoadCountrys"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
				<WTCALLSUB name="LoadCountrys"/>
				<WTCALLSUB name="LoadPaymentOptions"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="PARAM(CountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryName)" value="ATTR(CountryName)" />
					<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="PARAM(CountryIDb)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CountryID" direction="input" value="PARAM(CountryIDb)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="right"/>
				<WTCOLUMN width="75" align="left"/>

				<WTFUNCTION name="ToggleType()">
					var payobj = Business.elements['PayType'];
					if( payobj != null ) {
						var VisibleCard = 'none'; var VisibleCheck = 'none';
						var paytype=1;
						var l = payobj.length;
						if( l == null ) {
							if( payobj.checked ) {
								paytype = payobj.value
							}
						}
						else
						{
							for( i = 0; i &lt; l; i++ ) {
								if (payobj[i].checked) {
									paytype = payobj[i].value;
									i = l;
								}
							}
						}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					var payobj = Business.elements['PayType'];
					if( payobj != null ) {
						var l = payobj.length;
						for( i = 0; i &lt; l; i++ ) {
							if (payobj[i].value == val) {
								payobj[i].checked=true;
								i = l;
							}
						}
						ToggleType();
					}
				</WTFUNCTION>
				<!--				
				<WTFUNCTION name="ShowTaxIDType()">
					var countryid = document.getElementById('CountryID').value;
					if( countryid == 224 ) {
						document.getElementById('TaxIDType1').style.display = '';
						document.getElementById('TaxIDType2').style.display = 'none';
					}	
					else {
						document.getElementById('TaxIDType1').style.display = 'none';
						document.getElementById('TaxIDType2').style.display = '';
					}	
				</WTFUNCTION>
-->
<!--
				<WTFUNCTION name="CheckType(val)">
					ToggleType();
				</WTFUNCTION>
-->
				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatPhone(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					if( newval.length == 10 ) {
					obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
					}
					if( newval.length == 11 ) {
					obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
					}
					if( newval.length == 12 ) {
					obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
					}
				</WTFUNCTION>
				<!--				
				<WTFUNCTION name="FormatTaxID(obj)">
					var countryid = document.getElementById('CountryID').value;
					var taxidtype = document.getElementById('TaxIDType1').value;
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, ''); 
					if( countryid == 224 ) {
						if( taxidtype == 1 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Social Security Number'); }
							else {
								obj.value = newval.substring(0,3) + '-' + newval.substring(3,5) + '-' + newval.substring(5,9);
							}
						}
						if( taxidtype == 2 ) {
							if( newval.length &lt; 9 ) {
								alert('Oops, Invalid Employer Identification Number'); }
							else {
								obj.value = newval.substring(0,2) + '-' + newval.substring(2,9);
							}
						}
					}
				</WTFUNCTION>
-->
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					//if( newval.length &lt; 3 ) {
					//alert('Oops, Invalid Security Code');
					//}
				</WTFUNCTION>
				<WTFUNCTION name="FormatLogon(obj)">
					var val = obj.value;
					var newval = val.replace(/[^0-9a-zA-Z]/g, '');
					obj.value = newval;
					if( newval.length &lt; 6 ) {
					alert('Oops, Logon must be at least 6 characters or numbers.');
					}
				</WTFUNCTION>
				<WTFUNCTION name="ShowCC()">
					var disp, membership = document.getElementById('Membership').value;
					if( membership &lt; 5 ) { disp = 'none' } else { disp = '' }
					document.getElementById('CCRequired').style.display = disp;
					if( membership &lt; 5 ) { disp = '' } else { disp = 'none' }
					document.getElementById('Agree2').style.display = disp;
					//document.getElementById('Payment').style.display = disp;
					//document.getElementById('CardRows').style.display = disp;
					//document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="Init()">
					var mode = document.getElementById('Mode').value;
					if( mode == 1 ) {
					//ShowTaxIDType();
					}
					if( mode == 2 ) {
					// do nothing
					}
					if( mode == 4 ) {
					ToggleType();
					ShowCC();
					}
				</WTFUNCTION>

				<WTFUNCTION name="MsgBox(msg)">
					alert(msg);
				</WTFUNCTION>

				<WTLOAD>Init();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(Mode)"/>
					<WTHIDDEN value="PARAM(NewMemberID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(PayID)"/>
					<WTHIDDEN value="PARAM(TokenOwner)"/>
					<WTHIDDEN value="PARAM(TokenType)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(NoValidate)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(BadPayment)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="2" label="BadPaymentText" class="PageHeading" fontcolor="red" align="left"/>
				</WTROW>

				<!-- === Agreement ====================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(PayType)"/>

					<WTROW margin-top="24" margin-bottom="24">
						<WTCONDITION expr="PARAM(ReferredBy)" oper="equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="2" align="center" class="PageHeading" fontcolor="red">
							<WTSTATIC label="NoReferral1" newline="2"/>
							<WTSTATIC label="NoReferral2"/>
						</WTSTATIC>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true" />
						</WTROW>
						<WTROW margin-top="6" margin-bottom="12">
							<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTSTATIC col="1" merge="2" align="center" bold="true">
								<WTSTATIC tag="ReferredBy"/>
								<WTSTATIC value="PARAM(ReferredBy)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue" fontsize="4">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTBUTTON col="1" merge="3" action="1" value="CONST(Continue)" align="center"/>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<!-- === Contact Information ============================================ -->
				<WTSTATIC label="CompanyNameTip"/>
				<WTSTATIC label="Email2Tip"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" value="CONST(m_EnrollContact.png)" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="NameFirst"/>
						<WTTEXT col="2" value="ATTR(Member.NameFirst)" size="20" focus="true" required="false" textclass="bigtext">
							<WTEXIT>TitleCase(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="NameLast"/>
						<WTTEXT col="2" value="ATTR(Member.NameLast)" size="20" required="false" textclass="bigtext">
							<WTEXIT>TitleCase(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<!--					
					<WTROW>
						<WTSTATIC col="1" tag="MemberName"/>
						<WTTEXT col="2" value="ATTR(Member.NameFirst)" width="120" label="NameFirst" size="15" focus="true" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, First Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
						<WTTEXT col="2" value="ATTR(Member.NameLast)" width="120" label="NameLast" size="15" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Last Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
-->					
					<WTROW margin-bottom="6">
						<WTSTATIC col="1">
							<WTSTATIC label="CompanyName"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(TipQuestion.gif)" alt="CompanyNameTip">
									<WTLINK name="CONST(MsgBox('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='CompanyNameTip']&quot;/&gt;');)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
						</WTSTATIC>
						<WTTEXT col="2" value="ATTR(Member.CompanyName)" size="20" textclass="bigtext"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="Email"/>
						<WTTEXT col="2" value="ATTR(Member.Email)" size="20" required="false" textclass="bigtext"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTCONDITION expr="PARAM(TextEmail)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1">
							<WTSTATIC label="Email2"/>
							<WTCODEGROUP>
								<WTIMAGE value="CONST(TipQuestion.gif)" alt="Email2Tip">
									<WTLINK name="CONST(MsgBox('&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='Email2Tip']&quot;/&gt;');)" click="true" />
								</WTIMAGE>
							</WTCODEGROUP>
							<WTSTATIC space="1"/>
						</WTSTATIC>
						<WTTEXT col="2" value="ATTR(Member.Email2)" size="20" required="false" textclass="bigtext"/>
						<WTSTATIC col="2">
							<WTCODEGROUP>
								<WTIMAGE value="CONST(LearnMore.gif)">
									<WTLINK name="Page" target="Help"><WTPARAM name="Page" value="CONST(Email2)"/></WTLINK>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
<!--					
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTSTATIC col="1" tag="WV"/>
						<WTTEXT col="2" value="ATTR(Member.Reference)" size="15"/>
					</WTROW>
-->
					<WTROW margin-bottom="12">
						<WTSTATIC col="1" tag="Phone"/>
						<WTTEXT col="2" value="ATTR(Member.Phone1)" size="20" textclass="bigtext">
							<WTEXIT>FormatPhone(this);</WTEXIT>
						</WTTEXT>
					</WTROW>

					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="MailingAddress"/>
						<WTTEXT col="2" value="ATTR(Address.Street1)" size="20" textclass="bigtext">
							<WTEXIT>document.getElementById('Street1b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="Street2"/>
						<WTTEXT col="2" value="ATTR(Address.Street2)" size="20" textclass="bigtext">
							<WTEXIT>document.getElementById('Street2b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="City"/>
						<WTTEXT col="2" value="ATTR(Address.City)" size="20" required="false" textclass="bigtext">
							<WTEXIT>TitleCase(this); document.getElementById('Cityb').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="State"/>
						<WTTEXT col="2" value="ATTR(Address.State)" size="20" required="false" textclass="bigtext">
							<WTEXIT>TitleCase(this); document.getElementById('Stateb').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="Zip"/>
						<WTTEXT col="2" value="ATTR(Address.Zip)" size="20" required="false" textclass="bigtext">
							<WTEXIT>document.getElementById('Zipb').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="2" tag="CountryID" align="left"/>
					</WTROW>
					<WTROW>
						<WTCOMBO col="1" merge="2" value="ATTR(Address.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left">
							<WTEXIT>document.getElementById('CountryIDb').value = this.value;</WTEXIT>
						</WTCOMBO>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="NewLogon"/>
						<WTTEXT col="2" value="ATTR(Member.NewLogon)" size="15" class="prompt" textclass="bigtext">
							<WTEXIT>FormatLogon(this);</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="2" label="LogonTip"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" tag="NewPassword"/>
						<WTTEXT col="2" value="ATTR(Member.NewPassword)" size="15" secure="false" class="prompt" textclass="bigtext">
							<WTEXIT>if(this.value==''){alert('Oops, Password Required!');}</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="2" label="PasswordText"/>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Continue)" align="center" btnclass="bigbutton">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(2,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Membership ===================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-MEMBERSHIP)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" value="CONST(m_EnrollMembership.png)" align="center"/>
					</WTROW>

					<!-- Custom Company Membership Info -->
					<WTCODEGROUP>
						<!-- myTrackerPro -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTROW margin-top="12" margin-bottom="12">
							<WTIMAGE col="1" merge="3" value="CONST(FreeTrial.png)" path="company/7/" align="center"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="270" align="left"/>
								<WTROW margin-top="12">
									<WTRADIO col="1" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
									<WTSTATIC col="2" fontsize="4">
										<WTSTATIC label="Membership7_3">
											<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC label="Membership7_3a">
											<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-top="12">
									<WTRADIO col="1" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="2" fontsize="4">
										<WTSTATIC label="Membership7_1">
											<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC label="Membership7_1a">
											<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Free Loyalty -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="10" align="left"/>
								<WTCOLUMN width="90" align="left"/>
								<WTROW margin-top="12">
									<WTRADIO col="1" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="2" label="Membership18_1" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTRADIO col="1" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
									<WTSTATIC col="2" label="Membership18_2" bold="true"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTRADIO col="1" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
									<WTSTATIC col="2" label="Membership18_3" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" align="center" btnclass="bigbutton">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(1,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Continue)" align="center" btnclass="bigbutton">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(3,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Payment ========================================================= -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" value="CONST(m_EnrollPayment.png)" align="center"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTROW margin-bottom="12">
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
							<WTSTATIC col="1" merge="3" label="NoPaymentText" align="center" bold="true" fontcolor="red"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1" merge="3" label="NoPaymentText2" align="center" bold="true" fontcolor="red"/>
						</WTROW>
					</WTCODEGROUP>
<!--					
					<WTROW id="CCRequired" style="display:none" margin-bottom="6">
						<WTSTATIC col="1" merge="2" bold="true" align="center" fontcolor="red">
							<WTSTATIC label="CCRequired"/>
						</WTSTATIC>
					</WTROW>
-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>

						<WTROW id="Payment">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="320" align="center"/>

								<WTROW id="Pay2" margin-bottom="12">
									<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="12">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentVisa"/>
											<WTRADIO group="PayType" name="1" check="/DATA/TXN/PTSBILLING/@paytype=1">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentMC"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="2" check="/DATA/TXN/PTSBILLING/@paytype=2">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentDiscover"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="3" check="/DATA/TXN/PTSBILLING/@paytype=3">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentAmex"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="4" check="/DATA/TXN/PTSBILLING/@paytype=4">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentCheck"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(5);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CardRows">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="33" align="right"/>
								<WTCOLUMN width="67" align="left"/>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="20" textclass="bigtext">
										<WTEXIT>var x = this.value; if(x.tolowercase() != 'paypal'){this.value = x.replace(/[^\d]/g, '')};</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CardMo"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)" comboclass="bigtext">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CardYr"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" comboclass="bigtext">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="20" textclass="bigtext"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4" textclass="bigtext">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CheckRows">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="33" align="right"/>
								<WTCOLUMN width="67" align="left"/>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CheckBank"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="20" textclass="bigtext"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CheckRoute"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" size="20" textclass="bigtext"/>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(checkref.gif)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CheckAccount"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="20" textclass="bigtext"/>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(checkref.gif)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CheckAcctType"/>
									<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" comboclass="bigtext"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="CheckName"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="20" textclass="bigtext"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="BillingAddress">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="33" align="right"/>
								<WTCOLUMN width="67" align="left"/>

								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="BillingAddress"/>
									<WTTEXT col="2" value="PARAM(Street1b)" size="20" textclass="bigtext"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Street2"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="20" textclass="bigtext"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="City"/>
									<WTTEXT col="2" value="PARAM(Cityb)" size="20" required="false" textclass="bigtext">
										<WTEXIT>TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="State"/>
									<WTTEXT col="2" value="PARAM(Stateb)" size="20" required="false" textclass="bigtext">
										<WTEXIT>TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTSTATIC col="1" tag="Zip"/>
									<WTTEXT col="2" value="PARAM(Zipb)" size="20" required="false" textclass="bigtext"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" merge="2" tag="CountryID" align="left"/>
								</WTROW>
								<WTROW margin-bottom="6">
									<WTCOMBO col="1" merge="2" value="PARAM(CountryIDb)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="12">
							<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
						</WTROW>
						<WTROW id="Agree2">
							<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue" fontsize="4">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Back)" align="center" btnclass="bigbutton">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(2,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Continue)" align="center" btnclass="bigbutton">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(4,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Confirm ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="2" value="CONST(m_EnrollConfirm.png)" align="center"/>
					</WTROW>
					<WTROW>
						<WTTABLE col="1" merge="2">
							<WTCOLUMN width="50" align="left"/>
							<WTCOLUMN width="50" align="left"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.NameLast)" newline="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.CompanyName)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Email)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Reference)" newline="1">
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
									</WTSTATIC>
									<WTSTATIC value="ATTR(Member.Phone1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.Street1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.City)" space="1"/>
									<WTSTATIC value="ATTR(Address.State)" space="1"/>
									<WTSTATIC value="ATTR(Address.Zip)" newline="1"/>
									<WTSTATIC value="PARAM(CountryName)" newline="1"/>
									<WTSTATIC tag="Logon" value="ATTR(Member.NewLogon)" space="2"/>
									<WTSTATIC value="ATTR(Member.NewPassword)"/>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)"/>
									<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
									<WTSTATIC label="BillingInfo" newline="1" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="greater-equal" value="CONST(1)"/>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="less-equal" value="CONST(4)" connector="and"/>
										<WTSTATIC value="ATTR(Billing.CardNumber)" newline="1"/>
										<WTSTATIC tag="Expires" value="ATTR(Billing.CardMo)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CardYr)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CardName)" newline="1"/>
										<WTSTATIC tag="Code" value="ATTR(Billing.CardCode)" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(5)"/>
										<WTSTATIC value="ATTR(Billing.CheckBank)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckRoute)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CheckAccount)" newline="1"/>
										<WTSTATIC label="Checking">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
										<WTSTATIC label="Savings">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(2)"/>
										</WTSTATIC>
										<WTSTATIC newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckName)" newline="1"/>
									</WTCODEGROUP>
									<WTSTATIC value="PARAM(Street1b)" newline="1"/>
									<WTSTATIC value="PARAM(Cityb)" space="1"/>
									<WTSTATIC value="PARAM(Stateb)" space="1"/>
									<WTSTATIC value="PARAM(Zipb)" newline="1"/>
									<WTSTATIC value="PARAM(CountryNameb)" newline="2"/>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
					</WTROW>

					<!-- Custom Company Membership Info -->
					<WTCODEGROUP>
						<!-- myTrackerPro -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTROW>
							<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
									<WTSTATIC label="Membership7_1">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC label="Membership7_3">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC label="Membership7_1a">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC label="Membership7_3a">
										<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Free Loyalty -->
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(18)"/>
						<WTROW>
							<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
								<WTSTATIC label="Membership18_1">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership18_2">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Membership18_3">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Back)" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(3,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" value="CONST(Confirm)" align="center">
							<WTCLICK>this.disabled = true; doSubmit(5,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Welcome ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PROCESS)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>