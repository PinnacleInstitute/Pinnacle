<WTROOT prefix="pts" system="Pinnacle">

	<WTENTITY id="122" name="Sims" alias="sim">
		<!--Identity-->
		<WTATTRIBUTE id="12201" name="SimsID" type="number" identity="true" title="true" min="1" required="true" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="12295" name="Result" type="text" length="1000" source="entity" persist="false"/>
		<WTATTRIBUTE id="12296" name="Status" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="12297" name="czDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="12298" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="12299" name="Amount" type="number" source="entity" persist="false"/>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Sims" entity="Sims" alias="sim"/>
		</WTRELATIONSHIPS>
	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="CustomList" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Sims.SimsID)"/>
					<WTATTRIBUTE value="ATTR(Sims.Result)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
<!-- Processing - Admin Page -->
		<!--==================================================================-->
		<WTWEBPAGE name="12200" caption="Sims Processing" header="false" footer="false" navbar="false" wrapper="wrapper800" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="12200" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Process" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Result" datatype="text"/>

			<WTDATATXN name="Members"/>
			<WTDATATXN name="Simss"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="Payout.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Orders.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
			<WTINCLUDE name="DeclineEmail.asp"/>

			<WTCODEGROUP>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(7)"/>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<!-- Set this page to not timeout for 4 hours -->
				<WTCUSTOM>Server.ScriptTimeout = 14400</WTCUSTOM>				
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
			<!-- Disable Certain Features based on User Type -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsManagerOnly"/>
				<WTCUSTOM>If InStr( ",2,3,5,6,11,12,13,21,23,24,25,26,27,29,33,34,35,36,37,38,39,40,47,48,49,50,", CSTR(reqProcess)+"," ) = 0 Then reqProcess = 0</WTCUSTOM>
			</WTCODEGROUP>
<WTCUSTOM>
	'Set date range to previous month
	If reqOption = 0 Then
	reqFromDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqToDate = DateAdd( "d", -1, reqFromDate )
	reqFromDate = DateAdd( "m", -1, reqFromDate )
	End If
	'Set date range to current date
	If reqOption = 1 Then
	reqToDate = reqSysDate
	reqFromDate = reqSysDate
	End If
	'Set date range to previous month
	If reqOption = 2 Then
	reqToDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqFromDate = DateAdd( "m", -1, reqToDate )
	reqToDate = DateAdd( "d", -1, reqToDate )
	End If
	'Set date range to one month back from last Sunday
	If reqOption = 3 Then
	reqToDate = DateAdd( "d", -5, reqSysDate )
	reqFromDate = DateAdd( "m", -1, reqToDate )
	End If
	'Set date range to one week back
	If reqOption = 4 Then
	reqToDate = DateAdd( "d", -1, reqSysDate )
	reqFromDate = DateAdd( "d", -7, reqToDate )
	End If
	'Set date range to yesterday
	If reqOption = 5 Then
	reqFromDate = DateAdd( "d", -1, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set todate to 1 week back
	If reqOption = 11 Then
	reqToDate = DateAdd( "d", -7, reqSysDate )
	End If
	'Set todate to 2 weeks back
	If reqOption = 12 Then
	reqToDate = DateAdd( "d", -14, reqSysDate )
	End If
	'Set todate to 3 weeks back
	If reqOption = 13 Then
	reqToDate = DateAdd( "d", -21, reqSysDate )
	End If
	'Set todate to 4 weeks back
	If reqOption = 14 Then
	reqToDate = DateAdd( "d", -28, reqSysDate )
	End If
</WTCUSTOM>
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>

					<!-- Create Billing Tokens -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						<WTCUSTOM>
							Result = BillingTokens()
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " New Billing Tokens Successfully Created! (" + aResult(1) + " bad)"
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Create Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(200)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payments Successfully Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Process Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						<WTCUSTOM>
							PaymentOwnerType = 4
							PostProcess = 0
							Result = ProcessPayments( reqCompanyID, PaymentOwnerType, "1/1/2099", PostProcess )
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " Payments Successfully Processed! (" + aResult(1) + " bad)"
						</WTCUSTOM>
						<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult">
							<WTCONDITION expr="CONST(aResult(0))" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- List Declined Token -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Tokens!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Declined Paments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(100)"/>
								<WTPARAM name="Level" direction="input" value="CONST(4)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Declined Payments Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Verify Bonus Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Earn Bonuses!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Calculate Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						<WTOBJECT name="Commission" project="ptsCommissionUser" class="CCommission">
							<WTMETHOD name="CustomCommissions">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="CommType" direction="input" value="CONST(1)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTMETHOD name="TotalCommissions">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Bonuses Created! (&quot; &amp; FormatCurrency(Amount,2) &amp; &quot;)&quot;)"/>
						</WTOBJECT>
						<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult">
							<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
					
					<!-- Display Hidden Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(202)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Bonuses Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Create Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyPayouts">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payouts Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Payout Credits -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(4)"/>
								<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payment Credits Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Verify Payout Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(6)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Receive a Payout!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Create Payout Files -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS MARK PAYOUTS PAID AMOUNT -->
						<WTCALLSUB name="ExportWallet reqCompanyID, 12, reqToDate, -1, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.mytrackerpro.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; PayQuicker eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;No Payouts to Export!&quot;)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- Mark Payouts Paid -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS EXPORT PAYOUTS AMOUNT -->
						<!-- REFERENCE MUST BE SAME AS EXPORT PAYOUTS TYPES -->
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyStatus2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="PaidDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(-1)"/>
								<WTPARAM name="Reference" direction="input" value="CONST(&quot;3&quot;)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Pending Payouts Marked Paid!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Display Hidden Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(203)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Payouts Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Recalculate Group Sales Volume and Promotions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(1)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Group Sales Totals Recalculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Post sales summary -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(2)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Sales Summary Postings!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- List Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All New eWallets to be Created -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTOBJECT name="Simss" project="ptsSimsUser" class="CSimss">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlSimss" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;New eWallets to be imported to iPayout in a .CSV file!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Assign New eWallets to Payout Method -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New eWallets Assigned!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Mark GCC Payment Orders Pending (in process)-->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All New Global Cash Card orders marked pending!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Set All Member Alerts-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Member Alerts Set!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Clean up Data -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Data Cleaned Up!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Export Submitted Orders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Export Green Fuel Tab Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.mytrackerpro.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Submitted Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export SIMS Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.mytrackerpro.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; SIMS Submitted Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- Export Inprocess Orders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Export Green Fuel Tab Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.mytrackerpro.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export SIMS Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.mytrackerpro.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; SIMS Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- Update Submitted Orders to Inprocess -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Inprocess Orders to Complete -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Email Commissions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						<WTCALLSUB name="CommissionEmail reqCompanyID, 0, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Commission Emails Sent&quot;)"/>
					</WTCODEGROUP>

					<!-- Recalculate All Title Advancements -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						<WTOBJECT name="Sims" project="ptsSimsUser" class="CSims">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(15)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Title Advancements Calculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Email Members with Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="DeclineEmail reqCompanyID, 0, 0, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Declined Payments Emailed!&quot;)"/>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<!-- Suspend Payments -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(207)"/>
							<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Suspended with Declined Payments!&quot;)"/>
					</WTOBJECT>
				</WTCODEGROUP>

				<!-- Cancel Suspended Payments -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(208)"/>
							<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Suspended Members Cancelled with Declined Payments!&quot;)"/>
					</WTOBJECT>
				</WTCODEGROUP>

				<!-- Resubmit Declined Payments -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(209)"/>
							<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Declined Payments Resubmitted!&quot;)"/>
					</WTOBJECT>
				</WTCODEGROUP>

			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="center"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(Result)" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="24">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC label="NotAvailable">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="BillingTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateDeclined">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						</WTSTATIC>
						<WTSTATIC label="BonusQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						</WTSTATIC>
						<WTSTATIC label="CalcBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentCredits">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutPaid">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayPayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSummary">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						</WTSTATIC>
						<WTSTATIC label="ListOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						</WTSTATIC>
						<WTSTATIC label="CreateWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						</WTSTATIC>
						<WTSTATIC label="AssignWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						</WTSTATIC>
						<!--
						<WTSTATIC label="MarkGCC">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="SetAlerts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						</WTSTATIC>
						<WTSTATIC label="CleanupData">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						</WTSTATIC>
						<WTSTATIC label="EmailCommissions">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						</WTSTATIC>
						<WTSTATIC label="TitleAdvancements">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineEmail">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineSuspend">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineCancel">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineSubmit">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTSTATIC col="1" label="From" align="center" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)" connector="or"/>
					<WTTEXT col="1" align="center" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(cashregister.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0436d" return="false" target="Declines">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" label="eWalletHdr" align="left"/>
						</WTROW>
						<WTROW>
							<WTREPEAT entity="Sims">
								<WTROW>
									<WTSTATIC col="1" value="DATA(Result)" align="left"/>
								</WTROW>
							</WTREPEAT>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" action="1" value="CONST(Process)" align="center">
						<WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Member Change Membership Options Page -->
		<!--============================================================================================-->
		<WTWEBPAGE name="12201" caption="Change Membership" navbar="false" header="false" footer="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="12201" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="Amount" datatype="number"/>
			<WTPARAM name="BillingPrice" datatype="number"/>
			<WTPARAM name="CountryID" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="Result" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>

			<WTPARAM name="Binary" datatype="number"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(7)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="NewBilling">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<!-- Free -> Member -->
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<!-- Member -> Team -->
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(2)">
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(3)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(PayType)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
				</WTOBJECT>
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Upgrade.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="FetchOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryID)" value="ATTR(CountryID)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewBilling"/>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to recurring billing."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(0)"/>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(1)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					<WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdateBilling)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="CONST(oldPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(oldLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>

					<!-- **************************************************************** -->
					<WTSETATTRIBUTE name="CONST(tmpOptions2)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpInitPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(30)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
					</WTCODEGROUP>

					<!-- If upgrading to regular membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(4.95)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>
					<!-- If upgrading to team membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(9.95)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpInitPrice)"/>

					<!-- If there is a change to the membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdate)" oper="not-equal" value="CONST(0)"/>
						<!-- Get Payment -->
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(EmailBonuses)" value="CONST(0)"/>
							<WTCUSTOM>
								tmpProcessor = ""
								tmpAcct = ""
								Select Case reqPayType
								Case 1, 2, 3, 4	'Process Credit Cards
								tmpProcessor = tmpCardProcessor
								tmpAcct = tmpCardAcct
								Case 5 'Process Electronic Checks
								tmpProcessor = tmpCheckProcessor
								tmpAcct = tmpCheckAcct
								End Select
							</WTCUSTOM>
							<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, reqBillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
								<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(tmpUpdatePaidDate)" oper="not-equal" value="CONST(0)"/>
									<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
									<WTMETHOD name="Save">
										<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
									</WTMETHOD>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<!-- log the membership change -->
						<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE: (&quot; + oldLevel + &quot;) to (&quot; + .Level + &quot;)&quot;">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
						<WTCALLSUB name="reqBillingPrice = FormatCurrency( reqBillingPrice, 2 )">
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCALLSUB name="LoadBilling"/>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="175" align="center"/>
				<WTCOLUMN width="575" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="PARAM(CountryID)"/>
					<WTHIDDEN value="PARAM(Binary)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
					//var countryid = document.getElementById('CountryID').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none';
					var paytype = payobj.value;
					//var l = payobj.length;
					//for( i = 0; i &lt; l; i++ ) {
					//	if (payobj[i].checked) {
					//		paytype = payobj[i].value;
					//		i = l;
					//	}
					//}
					//if (paytype == 5) {
					//	if ( countryid != 224 ) {
					//		paytype = 1;
					//		document.getElementById('PayType').value = paytype;
					//		alert("Electronic Checks not available outside the United States");
					//	}
					//}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
					ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowCC()">
					var disp, computers = document.getElementById('Computers').value;
					if( computers == 0 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					document.getElementById('Payment').style.display = disp;
					document.getElementById('CardRows').style.display = disp;
					document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="formatCurrency(num)">
					num = num.toString().replace(/\$|\,/g,'');
					if(isNaN(num))
					num = "0";
					sign = (num == (num = Math.abs(num)));
					num = Math.floor(num*100+0.50000000001);
					cents = num%100;
					num = Math.floor(num/100).toString();
					if(cents&lt;10)
					cents = "0" + cents;
					for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
					num = num.substring(0,num.length-(4*i+3))+','+
					num.substring(num.length-(4*i+3));
					return (((sign)?'':'-') + '$' + num + '.' + cents);
					//return (((sign)?'':'-') + '$' + num);
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="2"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="SuccessfulChange" value="ATTR(Member.Price)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" merge="2" label="SuccessfulPayment" value="PARAM(BillingPrice)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Continue)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="2" align="center" label="NoUpgrades" class="PageHeading" fontcolor="red"/>
						</WTROW>
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12" margin-bottom="12">
							<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)"/>
							<WTIMAGE col="1" merge="2" value="CONST(FreeTrial.png)" path="company/7/" align="center"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="30" align="left"/>
								<WTCOLUMN width="690" align="left"/>
								<WTROW margin-top="12">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership1"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
									<WTSTATIC col="3" label="Membership2"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr = "ATTR(Member.BillingID)" oper="equal" value="CONST(0)" />
							<WTROW margin-top="12" id="Agree2">
								<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue">
									<WTCODEGROUP>
										<WTCHECK value="PARAM(IsAgree2)"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<WTROW id="Payment">
								<WTTABLE col="1" merge="2">
									<WTCOLUMN width="750" align="center"/>

									<WTROW margin-top="12" margin-bottom="12">
										<WTDIVIDER col="1" height="1" color="#584b42"/>
									</WTROW>
									<WTROW id="Pay2" margin-bottom="6">
										<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
									</WTROW>
									<WTROW id="Pay3" margin-bottom="6">
										<WTSTATIC col="1" align="center">
											<WTCODEGROUP>
												<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(1);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTSTATIC space="3"/>
												<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(2);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
<!--											
											<WTCODEGROUP>
												<WTSTATIC space="3"/>
												<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(3);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTSTATIC space="3"/>
												<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(4);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
-->											
										</WTSTATIC>
									</WTROW>
								</WTTABLE>
							</WTROW>
							<WTROW id="CardRows">
								<WTTABLE col="1" merge="2">
									<WTCOLUMN width="160" align="right"/>
									<WTCOLUMN width="440" align="left"/>
									<WTROW>
										<WTSTATIC col="1" tag="CardNumber"/>
										<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
											<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
										</WTTEXT>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardDate"/>
										<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
											<WTOPTION id="" label="Select"/>
											<WTOPTION id="1" label="January"/>
											<WTOPTION id="2" label="February"/>
											<WTOPTION id="3" label="March"/>
											<WTOPTION id="4" label="April"/>
											<WTOPTION id="5" label="May"/>
											<WTOPTION id="6" label="June"/>
											<WTOPTION id="7" label="July"/>
											<WTOPTION id="8" label="August"/>
											<WTOPTION id="9" label="September"/>
											<WTOPTION id="10" label="October"/>
											<WTOPTION id="11" label="November"/>
											<WTOPTION id="12" label="December"/>
										</WTCOMBO>
										<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
											<WTOPTION id="" label="Select"/>
											<WTOPTION id="13" label="2013"/>
											<WTOPTION id="14" label="2014"/>
											<WTOPTION id="15" label="2015"/>
											<WTOPTION id="16" label="2016"/>
											<WTOPTION id="17" label="2017"/>
											<WTOPTION id="18" label="2018"/>
											<WTOPTION id="19" label="2019"/>
											<WTOPTION id="20" label="2020"/>
											<WTOPTION id="21" label="2021"/>
											<WTOPTION id="22" label="2022"/>
											<WTOPTION id="23" label="2023"/>
											<WTOPTION id="24" label="2024"/>
											<WTOPTION id="25" label="2025"/>
										</WTCOMBO>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardName"/>
										<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardCode"/>
										<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
											<WTEXIT>FormatCardCode(this);</WTEXIT>
										</WTTEXT>
										<WTSTATIC col="2">
											<WTCODEGROUP>
												<WTTOOLTIP>
													<WTIMAGE value="CONST(SymbolHelp.gif)"/>
													<WTTIP>
														<WTIMAGE value="CONST(SecurityCode.png)"/>
													</WTTIP>
												</WTTOOLTIP>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="BillingAddress" />
										<WTTEXT col="2" value="PARAM(Street1b)" size="60">
											<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
										</WTTEXT>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
											<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
										</WTTEXT>
										<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
											<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
										</WTTEXT>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left" required="true">
											<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
										</WTTEXT>
										<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
									</WTROW>
								</WTTABLE>
							</WTROW>
							<WTROW id="Secure" margin-top="12">
								<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
								<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
							</WTROW>
						</WTCODEGROUP>
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="2" action="2" value="CONST(Change)" align="center"/>
							<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>


		<!--============================================================================================-->
		<WTWEBPAGE name="m_12201" caption="Upgrade Membership" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		    aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="m_12201" mobile="MobileHome.asp" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="Amount" datatype="number"/>
			<WTPARAM name="BillingPrice" datatype="number"/>
			<WTPARAM name="CountryID" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="Result" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>

			<WTPARAM name="Binary" datatype="number"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(7)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="NewBilling">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<!-- Free -> Member -->
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<!-- Member -> Team -->
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(2)">
						<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(3)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(PayType)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
				</WTOBJECT>
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;m_Upgrade.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="FetchOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryID)" value="ATTR(CountryID)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewBilling"/>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to recurring billing."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(0)"/>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(1)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					<WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdateBilling)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="CONST(oldPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Title)"/>
					<WTSETATTRIBUTE name="CONST(oldLevel)" value="ATTR(Level)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>

					<!-- **************************************************************** -->
					<WTSETATTRIBUTE name="CONST(tmpOptions2)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpInitPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(0)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(oldLevel)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(TrialDays)" value="CONST(30)"/>
						<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, reqSysDate))"/>
					</WTCODEGROUP>

					<!-- If upgrading to regular membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(4.95)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>
					<!-- If upgrading to team membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpPrice)" value="CONST(9.95)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(tmpInitPrice)"/>

					<!-- If there is a change to the membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdate)" oper="not-equal" value="CONST(0)"/>
						<!-- Get Payment -->
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(EmailBonuses)" value="CONST(0)"/>
							<WTCUSTOM>
								tmpProcessor = ""
								tmpAcct = ""
								Select Case reqPayType
								Case 1, 2, 3, 4	'Process Credit Cards
								tmpProcessor = tmpCardProcessor
								tmpAcct = tmpCardAcct
								Case 5 'Process Electronic Checks
								tmpProcessor = tmpCheckProcessor
								tmpAcct = tmpCheckAcct
								End Select
							</WTCUSTOM>
							<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, reqBillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
								<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(tmpUpdatePaidDate)" oper="not-equal" value="CONST(0)"/>
									<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
									<WTMETHOD name="Save">
										<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
									</WTMETHOD>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<!-- log the membership change -->
						<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE: (&quot; + oldLevel + &quot;) to (&quot; + .Level + &quot;)&quot;">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
						<WTCALLSUB name="reqBillingPrice = FormatCurrency( reqBillingPrice, 2 )">
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCALLSUB name="LoadBilling"/>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="center"/>
				<WTCOLUMN width="75" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="PARAM(CountryID)"/>
					<WTHIDDEN value="PARAM(Binary)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
					//var countryid = document.getElementById('CountryID').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none';
					var paytype = payobj.value;
					//var l = payobj.length;
					//for( i = 0; i &lt; l; i++ ) {
					//	if (payobj[i].checked) {
					//		paytype = payobj[i].value;
					//		i = l;
					//	}
					//}
					//if (paytype == 5) {
					//	if ( countryid != 224 ) {
					//		paytype = 1;
					//		document.getElementById('PayType').value = paytype;
					//		alert("Electronic Checks not available outside the United States");
					//	}
					//}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
					ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowCC()">
					var disp, computers = document.getElementById('Computers').value;
					if( computers == 0 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					document.getElementById('Payment').style.display = disp;
					document.getElementById('CardRows').style.display = disp;
					document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="formatCurrency(num)">
					num = num.toString().replace(/\$|\,/g,'');
					if(isNaN(num))
					num = "0";
					sign = (num == (num = Math.abs(num)));
					num = Math.floor(num*100+0.50000000001);
					cents = num%100;
					num = Math.floor(num/100).toString();
					if(cents&lt;10)
					cents = "0" + cents;
					for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
					num = num.substring(0,num.length-(4*i+3))+','+
					num.substring(num.length-(4*i+3));
					return (((sign)?'':'-') + '$' + num + '.' + cents);
					//return (((sign)?'':'-') + '$' + num);
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="2"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="SuccessfulChange" value="ATTR(Member.Price)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" merge="2" label="SuccessfulPayment" value="PARAM(BillingPrice)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
<!--
					<WTROW margin-top="12" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Continue)" align="center"/>
					</WTROW>
-->					
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="2" align="center" label="NoUpgrades" class="PageHeading" fontcolor="red"/>
						</WTROW>
<!--						
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>
						</WTROW>
-->						
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="12" margin-bottom="12">
							<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(0)"/>
							<WTIMAGE col="1" merge="2" value="CONST(FreeTrial.png)" path="company/7/" align="center"/>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="3" align="left"/>
								<WTCOLUMN width="3" align="left"/>
								<WTCOLUMN width="94" align="left"/>
								<WTROW margin-top="12">
									<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership1"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
									<WTSTATIC col="3" label="Membership2"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr = "ATTR(Member.BillingID)" oper="equal" value="CONST(0)" />
							<WTROW margin-top="12" id="Agree2">
								<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue">
									<WTCODEGROUP>
										<WTCHECK value="PARAM(IsAgree2)"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>

							<WTROW id="Payment">
								<WTTABLE col="1" merge="2">
									<WTCOLUMN width="320" align="center"/>

									<WTROW margin-top="12" margin-bottom="12">
										<WTDIVIDER col="1" height="1" color="#584b42"/>
									</WTROW>
									<WTROW id="Pay2" margin-bottom="6">
										<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
									</WTROW>
									<WTROW id="Pay3" margin-bottom="6">
										<WTSTATIC col="1" align="center">
											<WTCODEGROUP>
												<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(1);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTSTATIC space="3"/>
												<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(2);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<!--											
											<WTCODEGROUP>
												<WTSTATIC space="3"/>
												<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(3);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTSTATIC space="3"/>
												<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(4);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(5);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
-->
										</WTSTATIC>
									</WTROW>
								</WTTABLE>
							</WTROW>
							<WTROW id="CardRows">
								<WTTABLE col="1" merge="2">
									<WTCOLUMN width="33" align="right"/>
									<WTCOLUMN width="67" align="left"/>
									<WTROW>
										<WTSTATIC col="1" tag="CardNumber"/>
										<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
											<WTEXIT>var x = this.value; if(x.tolowercase() != 'paypal'){this.value = x.replace(/[^\d]/g, '')};</WTEXIT>
										</WTTEXT>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardDate"/>
										<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
											<WTOPTION id="" label="Select"/>
											<WTOPTION id="1" label="January"/>
											<WTOPTION id="2" label="February"/>
											<WTOPTION id="3" label="March"/>
											<WTOPTION id="4" label="April"/>
											<WTOPTION id="5" label="May"/>
											<WTOPTION id="6" label="June"/>
											<WTOPTION id="7" label="July"/>
											<WTOPTION id="8" label="August"/>
											<WTOPTION id="9" label="September"/>
											<WTOPTION id="10" label="October"/>
											<WTOPTION id="11" label="November"/>
											<WTOPTION id="12" label="December"/>
										</WTCOMBO>
										<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
											<WTOPTION id="" label="Select"/>
											<WTOPTION id="13" label="2013"/>
											<WTOPTION id="14" label="2014"/>
											<WTOPTION id="15" label="2015"/>
											<WTOPTION id="16" label="2016"/>
											<WTOPTION id="17" label="2017"/>
											<WTOPTION id="18" label="2018"/>
											<WTOPTION id="19" label="2019"/>
											<WTOPTION id="20" label="2020"/>
											<WTOPTION id="21" label="2021"/>
											<WTOPTION id="22" label="2022"/>
											<WTOPTION id="23" label="2023"/>
											<WTOPTION id="24" label="2024"/>
											<WTOPTION id="25" label="2025"/>
										</WTCOMBO>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardName"/>
										<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CardCode"/>
										<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
											<WTEXIT>FormatCardCode(this);</WTEXIT>
										</WTTEXT>
										<WTSTATIC col="2">
											<WTCODEGROUP>
												<WTTOOLTIP>
													<WTIMAGE value="CONST(SymbolHelp.gif)"/>
													<WTTIP>
														<WTIMAGE value="CONST(SecurityCode.png)"/>
													</WTTIP>
												</WTTOOLTIP>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTROW>
								</WTTABLE>
							</WTROW>
<!--
							<WTROW id="CheckRows">
								<WTSTATIC col="1"/>
								<WTTABLE col="2" merge="2">
									<WTCOLUMN width="33" align="right"/>
									<WTCOLUMN width="67" align="left"/>
									<WTROW>
										<WTSTATIC col="1" tag="CheckBank"/>
										<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckRoute"/>
										<WTTEXT col="2" value="ATTR(Billing.CheckRoute)"/>
										<WTSTATIC col="2">
											<WTCODEGROUP>
												<WTTOOLTIP>
													<WTIMAGE value="CONST(SymbolHelp.gif)"/>
													<WTTIP>
														<WTIMAGE value="CONST(checkref.gif)"/>
													</WTTIP>
												</WTTOOLTIP>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckAccount"/>
										<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25"/>
										<WTSTATIC col="2">
											<WTCODEGROUP>
												<WTTOOLTIP>
													<WTIMAGE value="CONST(SymbolHelp.gif)"/>
													<WTTIP>
														<WTIMAGE value="CONST(checkref.gif)"/>
													</WTTIP>
												</WTTOOLTIP>
											</WTCODEGROUP>
										</WTSTATIC>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckAcctType"/>
										<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1" tag="CheckName"/>
										<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25"/>
									</WTROW>
								</WTTABLE>
							</WTROW>
-->
							<WTROW id="BillingAddress">
								<WTTABLE col="1" merge="2">
									<WTCOLUMN width="33" align="right"/>
									<WTCOLUMN width="67" align="left"/>
									<WTROW>
										<WTSTATIC col="1" tag="BillingAddress" />
										<WTTEXT col="2" value="PARAM(Street1b)" size="25">
											<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
										</WTTEXT>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTTEXT col="2" value="PARAM(Street2b)" size="25"/>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTTEXT col="2" value="PARAM(Cityb)" width="110" label="City" size="13" align="left">
											<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
										</WTTEXT>
										<WTTEXT col="2" value="PARAM(Stateb)" width="110" label="State" size="13" align="left">
											<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
										</WTTEXT>
									</WTROW>
									<WTROW>
										<WTSTATIC col="1"/>
										<WTTEXT col="2" value="PARAM(Zipb)" width="220" label="Zip" size="15" align="left">
											<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
										</WTTEXT>
									</WTROW>
									<WTROW>
										<WTCOMBO col="1" merge="2" value="PARAM(CountryIDb)" width="320" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
									</WTROW>
								</WTTABLE>
							</WTROW>

							<WTROW id="Secure" margin-top="12">
								<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
								<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
							</WTROW>
						</WTCODEGROUP>
						<WTROW margin-top="24" margin-bottom="24">
							<WTBUTTON col="1" merge="2" action="2" value="CONST(Change)" align="center"/>
<!--							<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center"/>-->
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="12202" caption="myTrackerPro Stats" header="false" footer="false" navbar="false" action="0" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="12202">
			<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					If reqDay &gt; 0 Then reqToday = DateAdd("d", reqDay * -1, reqSysDate) Else reqToday = reqSysDate
					Select Case DATEPART("w", reqToday )
					Case 1 reqToday = reqToday &amp; " Sunday"
					Case 2 reqToday = reqToday &amp; " Monday"
					Case 3 reqToday = reqToday &amp; " Tuesday"
					Case 4 reqToday = reqToday &amp; " Wednesday"
					Case 5 reqToday = reqToday &amp; " Thursday"
					Case 6 reqToday = reqToday &amp; " Friday"
					Case 7 reqToday = reqToday &amp; " Saturday"
					End Select
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SIMS" project="ptsSIMSUser" class="CSIMS">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(7)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="center"/>
				<WTCOLUMN width="6" align="center"/>
				<WTCOLUMN width="300" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="SIMSStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid"  backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Enrollments"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Systems" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.M1_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.M1_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.M1_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Free" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.M0_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.M0_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.M0_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Members" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.M3_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.M3_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.M3_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Teams" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.M2_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.M2_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.M2_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.M4_1)" bold="true"/>
									<WTSTATIC col="3" value="ATTR(Stats.M4_7)" bold="true"/>
									<WTSTATIC col="4" value="ATTR(Stats.M4_99)" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="FreeMemberships"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Members" bold="true" align="center"/>
									<WTSTATIC col="3" label="Teams" bold="true"/>
									<WTSTATIC col="4"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" value="ATTR(Stats.F3)" align="center"/>
									<WTSTATIC col="3" value="ATTR(Stats.F2)"/>
									<WTSTATIC col="4"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
					<WTSTATIC col="2"/>
					<WTTABLE col="3" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="150" align="right"/>
								<WTCOLUMN width="150" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="MembershipStatus"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Active" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.T1)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Suspended" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.T4)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="InActive" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.T5)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Cancelled" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.T6)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Terminated" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.T7)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.T99)" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Sales"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Today" bold="true" align="center"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.S1)" align="center"/>
									<WTSTATIC col="2" value="ATTR(Stats.S7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.S30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.S99)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="12">
					<WTTABLE col="1" merge="3">
						<WTCOLUMN width="606" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>
								<WTCOLUMN width="59" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="10" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="SupportTickets"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="1hr" bold="true"/>
									<WTSTATIC col="3" label="4hr" bold="true"/>
									<WTSTATIC col="4" label="12hr" bold="true"/>
									<WTSTATIC col="5" label="1day" bold="true"/>
									<WTSTATIC col="6" label="2day" bold="true"/>
									<WTSTATIC col="7" label="3day" bold="true"/>
									<WTSTATIC col="8" label="7day" bold="true"/>
									<WTSTATIC col="9" label="14day" bold="true"/>
									<WTSTATIC col="10" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Submitted" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z1a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z1b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z1c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z1d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z1e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z1f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z1g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z1h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z1t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Assigned" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z2a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z2b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z2c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z2d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z2e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z2f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z2g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z2h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z2t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Resolved" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z3a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z3b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z3c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z3d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z3e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z3f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z3g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z3h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z3t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Postponed" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z4a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z4b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z4c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z4d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z4e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z4f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z4g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z4h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z4t)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.Z5a)"/>
									<WTSTATIC col="3" value="ATTR(Stats.Z5b)"/>
									<WTSTATIC col="4" value="ATTR(Stats.Z5c)"/>
									<WTSTATIC col="5" value="ATTR(Stats.Z5d)"/>
									<WTSTATIC col="6" value="ATTR(Stats.Z5e)"/>
									<WTSTATIC col="7" value="ATTR(Stats.Z5f)"/>
									<WTSTATIC col="8" value="ATTR(Stats.Z5g)"/>
									<WTSTATIC col="9" value="ATTR(Stats.Z5h)"/>
									<WTSTATIC col="10" value="ATTR(Stats.Z5t)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="12203" caption="Team Stats" header="false" footer="false" navbar="false" action="0" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="12203">
			<!--============================================================================================-->
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					If reqDay &gt; 0 Then reqToday = DateAdd("d", reqDay * -1, reqSysDate) Else reqToday = reqSysDate
					Select Case DATEPART("w", reqToday )
					Case 1 reqToday = reqToday &amp; " Sunday"
					Case 2 reqToday = reqToday &amp; " Monday"
					Case 3 reqToday = reqToday &amp; " Tuesday"
					Case 4 reqToday = reqToday &amp; " Wednesday"
					Case 5 reqToday = reqToday &amp; " Thursday"
					Case 6 reqToday = reqToday &amp; " Friday"
					Case 7 reqToday = reqToday &amp; " Saturday"
					End Select
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="SIMS" project="ptsSIMSUser" class="CSIMS">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(8)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="PARAM(GroupID)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="center"/>
				<WTCOLUMN width="6" align="center"/>
				<WTCOLUMN width="300" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="SIMSGroupStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid"  backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="ActiveMemberships"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTCONDITION expr="ATTR(Stats.L0_99)" oper="not-equal" value="CONST(0)"/>
									<WTSTATIC col="1" tag="Free" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.L0_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.L0_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.L0_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Basic" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.L3_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.L3_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.L3_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Leader" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.L2_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.L2_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.L2_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Admin" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.L1_1)"/>
									<WTSTATIC col="3" value="ATTR(Stats.L1_7)"/>
									<WTSTATIC col="4" value="ATTR(Stats.L1_99)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.L4_1)" bold="true"/>
									<WTSTATIC col="3" value="ATTR(Stats.L4_7)" bold="true"/>
									<WTSTATIC col="4" value="ATTR(Stats.L4_99)" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
					<WTSTATIC col="2"/>
					<WTTABLE col="3" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="150" align="right"/>
								<WTCOLUMN width="150" align="center"/>

								<WTROW margin-bottom="3">
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="MembershipStatus"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Active" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S1)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Suspended" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S4)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="InActive" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S5)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Cancelled" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S6)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Terminated" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.S7)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.S99)" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="BusinessTracker" caption="Business Tracker" navbar="false" footer="false" wrapper="wrapper1000" header="PageHeader1000"
			page-image="bg.jpg" margin-width="0" navbar-width="0" content-width="1000"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="BusinessTracker" secured="52">
			<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MenuBehindColor" datatype="text"/>
			<WTPARAM name="MenuBehindImage" datatype="text"/>

			<WTINCLUDE name="MenuColors.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NotMemberOnly"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="GetMenuColors reqCompanyID, reqMemberID, reqMenuBehindColor, MenuTopColor, MenuTopBGColor, MenuColor, MenuBGColor, MenuShadowColor, MenuBDColor, MenuOverColor, MenuOverBGColor, MenuDividerColor, MenuBehindImage, MenuTopImage, MenuImage"/>
			</WTACTION>
			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="1000" align="left" />

				<WTFUNCTION name="ShowTab(tab, shw)">
					var mid = document.getElementById('MemberID').value;
					var cid = document.getElementById('CompanyID').value;
					var frame, url, frm, src, page, target='', style='', compare=0, load=0;

					switch(tab) {
					case 'TabDashboard':
					frame = 'DashboardFrame';
					switch(shw) {
					case 1: url = 'MemberDashboard.asp?memberid=' + mid; load=1; break;
					case 2: url = 'Mobile.asp?m=' + mid; target='Mobile'; style='top=100,left=100,height=492,width=322,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no'; break;
					} break;
					case 'TabMarketing':
					frame = 'MarketingFrame';
					switch(shw) {
					case 1: url = '8161.asp?memberid=' + mid; break;
					case 2: url = '8101.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
					case 3: url = '8151.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
					case 4: url = '1412.asp?pagetype=1&amp;contentpage=3&amp;popup=-1&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
					case 5: url = '1412.asp?pagetype=2&amp;contentpage=3&amp;popup=-1&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
					case 6: url = '12410.asp?entity=22&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
					case 7: url = '12410.asp?entity=81&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
					case 8: url = '12410.asp?entity=-81&amp;companyid=' + cid + '&amp;memberid=' + mid; compare=19; break;
					} break;
					case 'TabProductivity':
					frame = 'ProductivityFrame';
					switch(shw) {
					case 1: url = '11711.asp?memberid=' + mid; break;
					case 2: url = '12610.asp?memberid=' + mid; break;
					case 3: url = '0445.asp?memberid=' + mid; target='performance'; style='top=100,left=100,height=350,width=400,resizable=yes,status=no,toolbar=no,menubar=no,location=no,titlebar=no'; break;
					case 4: url = '7001.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
					case 5: url = 'Calendar.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
					case 6: url = '2511.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
					case 7: url = '7501.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3&amp;popup=-1'; break;
					} break;
					case 'TabLeadership':
					frame = 'LeadershipFrame';
					switch(shw) {
					case 1: url = '0410.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
					case 2: url = '1813.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3&amp;popup=-1'; break;
					case 3: url = '0470.asp?memberid=' + mid; target='genealogy'; break;
					case 4: url = '11710.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
					} break;
					case 'TabTraining':
					frame = 'TrainingFrame';
					switch(shw) {
					case 1: url = '1311.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
					case 2: url = '3411.asp?memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
					case 3: url = '1212.asp?mode=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; break;
					} break;
					case 'TabFinancial':
					frame = 'FinancialFrame';
					switch(shw) {
					case 1: url = '0475.asp?code=2&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
					case 2: url = '0475.asp?code=1&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
					case 3: url = '0475.asp?code=3&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
					case 4: url = '0475.asp?code=4&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
					case 5: url = '0475.asp?code=5&amp;memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; compare=15; break;
					case 6: url = 'money.asp?memberid=' + mid;	target='Money'; break;
					} break;
					case 'TabResources':
					frame = 'ResourcesFrame';
					switch(shw) {
					case 1: url = '7014.asp?template=1&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 2: url = '7014.asp?template=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 3: url = '11411.asp?companyid=' + cid + '&amp;groupid=' + mid; break;
					case 4: url = '9301.asp?pagetype=4&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 5: url = '9301.asp?pagetype=3&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 6: url = '9301.asp?pagetype=5&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 7: url = '9301.asp?pagetype=1&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 8: url = '9301.asp?pagetype=2&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 9: url = '9301.asp?pagetype=6&amp;memberid=' + mid + '&amp;companyid=' + cid + '&amp;contentpage=3'; compare=19; break;
					case 10: url = '8017.asp?parenttype=4&amp;parentid=' + mid; break;
					case 11: url = '1811.asp?memberid=' + mid + '&amp;companyid=' + cid; break;
					case 12: url = '0451.asp?groupid=' + mid; break;
					case 13: url = '3854.asp?groupid=' + mid + '&amp;companyid=' + cid + '&amp;popup=-1'; break;
					case 14: url = '1411.asp?pagetype=1&amp;groupid=' + mid + '&amp;companyid=' + cid; compare=19; break;
					case 15: url = '1411.asp?pagetype=2&amp;groupid=' + mid + '&amp;companyid=' + cid; compare=19; break;
					case 16: url = '7711.asp?groupid=' + mid + '&amp;companyid=' + cid; break;
					case 17: url = '11811.asp?companyid=' + cid + '&amp;groupid=' + mid; break;
					case 18: url = '12303.asp?memberid=' + mid; break;
					case 19: url = '11910.asp?memberid=' + mid + '&amp;companyid=' + cid; break;
					case 20: url = 'MenuColors.asp?groupid=' + mid; break;
					case 21: url = '12601.asp?companyid=' + cid + '&amp;groupid=' + mid; break;
					} break;
					case 'TabHelp':
					frame = 'HelpFrame';
					switch(shw) {
					case 1: url = 'Tutorial.asp?contentpage=3';	target='Tutorial'; break;
					case 2: url = '1713.asp?contentpage=3' + '&amp;companyid=' + cid; break;
					case 3: url = '8013.asp?contentpage=3' + '&amp;companyid=' + cid; break;
					case 4: url = '9506.asp?contentpage=3' + '&amp;companyid=' + cid; break;
					case 5: url = '4511.asp?contentpage=3'; break;
					case 6: url = '4011.asp?contentpage=3'; break;
					} break;
					case 'TabAccount':
					frame = 'AccountFrame';
					switch(shw) {
					case 1: url = '0463.asp?memberid=' + mid + '&amp;contentpage=3&amp;popup=-1'; break;
					case 2: url = '0436.asp?memberid=' + mid + '&amp;noclose=1'; break;
					case 3: url = '0441.asp?memberid=' + mid + '&amp;noclose=1'; break;
					case 4: url = '9211.asp'; break;
					case 5: url = '0103.asp?contentpage=3&amp;popup=-1'; break;
					case 6: url = '0106.asp?contentpage=3&amp;popup=-1'; break;
					} break;
					}
					if( target.length &gt; 0 ) {
					win = window.open(url,target,style);
					win.focus();
					}
					else {
					document.getElementById('TabDashboard').style.display = 'none';
					document.getElementById('TabMarketing').style.display = 'none';
					document.getElementById('TabProductivity').style.display = 'none';
					document.getElementById('TabLeadership').style.display = 'none';
					document.getElementById('TabTraining').style.display = 'none';
					document.getElementById('TabFinancial').style.display = 'none';
					document.getElementById('TabResources').style.display = 'none';
					document.getElementById('TabHelp').style.display = 'none';
					document.getElementById('TabAccount').style.display = 'none';
					document.getElementById(tab).style.display = '';

					frm = document.getElementById(frame);
					src = frm.src;
					if( compare == 0 ) { compare = url.indexOf('.') }
					page = url.substring(0,compare);
					if (load == 1 || src.indexOf(page) &lt; 0 ) {
					frm.src = url
					//window.setTimeout( function(){ SizeFrame(frm);}, 1000 );
					}
					}
				</WTFUNCTION>

				<WTFUNCTION name="SizeFrame(F)">
					//if(F.contentDocument) {
					//	F.height = F.contentDocument.documentElement.scrollHeight+30; //FF 3.0.11, Opera 9.63, and Chrome
					//} else {
					//	F.height = F.contentWindow.document.body.scrollHeight+30; //IE6, IE7 and Chrome
					//}
				</WTFUNCTION>

				<WTLOAD>
					ShowTab('TabDashboard',1);
				</WTLOAD>

				<WTMENU name="MemberMenu" type="bar" menuwidth="125" height="30" top-color="CONST(MenuTopColor)" top-bgcolor="CONST(MenuTopBGColor)"
						color="CONST(MenuColor)" bgcolor="CONST(MenuBGColor)" shadow-color="CONST(MenuShadowColor)" bdcolor="CONST(MenuBDColor)"
						over-color="CONST(MenuOverColor)" over-bgcolor="CONST(MenuOverBGColor)" divider-color="CONST(MenuDividerColor)" top-bgimg="CONST(MenuTopImage)" bgimg="CONST(MenuImage)">
					<WTITEM label="mHome">
						<WTCONDITION expr="SYS(CompanyID)" oper="equal" value="CONST(7)"/>
						<WTIMAGE name="Home.gif"/>
						<WTITEM label="mHome">
							<WTIMAGE name="Home.gif"/>
							<WTLINK name="JAVA(ShowTab('TabDashboard',1))"/>
						</WTITEM>
						<WTITEM label="mMobile">
							<WTIMAGE name="Mobile.gif"/>
							<WTLINK name="JAVA(ShowTab('TabDashboard',2))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mHome">
						<WTCONDITION expr="SYS(CompanyID)" oper="greater" value="CONST(7)"/>
						<WTIMAGE name="Home.gif"/>
						<WTLINK name="JAVA(ShowTab('TabDashboard',1))"/>
					</WTITEM>
					<WTITEM label="mContacts">
						<WTCONDITION expr="IsSuspect"/>
						<WTIMAGE name="Suspect.gif"/>
						<WTITEM label="mViewLeads">
							<WTIMAGE name="Suspect.gif"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',1))"/>
						</WTITEM>
						<WTITEM label="mAddLeads">
							<WTIMAGE name="Suspect.gif"/>
							<WTLINK name="JAVA(ShowTab('TabMarketing',2))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mActivities">
						<WTCONDITION expr="IsActivityTracker"/>
						<WTIMAGE name="Activity.gif"/>
						<WTITEM label="mLogActivity">
							<WTIMAGE name="Activity.gif"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',1))"/>
						</WTITEM>
						<WTITEM label="mViewActivities">
							<WTIMAGE name="Activity.gif"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',2))"/>
						</WTITEM>
						<WTITEM label="mContests">
							<WTCONDITION expr="IsActivityContest"/>
							<WTIMAGE name="Contest.gif"/>
							<WTLINK name="JAVA(ShowTab('TabProductivity',3))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mLeadership">
						<WTCONDITION expr="IsMentoring"/>
						<WTIMAGE name="Mentor.gif"/>
						<WTITEM label="mMentoring">
							<WTIMAGE name="Mentor.gif"/>
							<WTLINK name="JAVA(ShowTab('TabLeadership',1))"/>
						</WTITEM>
						<WTITEM label="mLeaderBoard">
							<WTCONDITION expr="IsActivityTracker"/>
							<WTIMAGE name="leaderboard.gif"/>
							<WTLINK name="JAVA(ShowTab('TabLeadership',2))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mFinancial" menuwidth="150">
						<WTCONDITION expr="IsFinances"/>
						<WTIMAGE name="Finance.gif"/>
						<WTITEM label="mPayments">
							<WTCONDITION expr="IsPayments"/>
							<WTIMAGE name="Finance.gif"/>
							<WTLINK name="JAVA(ShowTab('TabFinancial',1))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mResources" menuwidth="210">
						<WTCONDITION expr="IsResources"/>
						<WTIMAGE name="Resource.gif"/>
						<WTITEM label="mGroupOptions">
							<WTCONDITION expr="IsGrpOptions"/>
							<WTIMAGE name="GrpOptions.gif"/>
							<WTLINK name="JAVA(ShowTab('TabResources',13))"/>
						</WTITEM>
						<WTITEM label="mMenuColors">
							<WTIMAGE name="Colors.gif"/>
							<WTLINK name="JAVA(ShowTab('TabResources',20))"/>
						</WTITEM>
						<WTITEM label="mGroupActivities">
							<WTIMAGE name="SalesSummary.gif"/>
							<WTLINK name="JAVA(ShowTab('TabResources',17))"/>
						</WTITEM>
						<WTITEM label="mGroupContests">
							<WTCONDITION expr="IsContestCreater"/>
							<WTIMAGE name="Contest.gif"/>
							<WTLINK name="JAVA(ShowTab('TabResources',21))"/>
						</WTITEM>
						<WTITEM label="mSharedResources">
							<WTIMAGE name="Resource.gif"/>
							<WTLINK name="JAVA(ShowTab('TabResources',19))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mHelp" menuwidth="150">
						<WTIMAGE name="Help.gif"/>
						<WTITEM label="mTutorial">
							<WTCONDITION expr="IsPinnacleTutorial"/>
							<WTIMAGE name="Help.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',1))"/>
						</WTITEM>
						<WTITEM label="mFAQ">
							<WTCONDITION expr="IsSupportFAQ"/>
							<WTIMAGE name="Help.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',2))"/>
						</WTITEM>
						<WTITEM label="mDocs">
							<WTCONDITION expr="IsSupportDocs"/>
							<WTIMAGE name="Help.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',3))"/>
						</WTITEM>
						<WTITEM label="mTickets">
							<WTCONDITION expr="IsSupportTicket"/>
							<WTIMAGE name="SupportTicket.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',4))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsSuggestion"/>
							<WTCONDITION expr="IsSurvey" connector="or"/>
						</WTDIVIDER>
						<WTITEM label="mSuggestions">
							<WTCONDITION expr="IsSuggestion"/>
							<WTIMAGE name="suggestion.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',5))"/>
						</WTITEM>
						<WTITEM label="mSurveys">
							<WTCONDITION expr="IsSurvey"/>
							<WTIMAGE name="suggestion.gif"/>
							<WTLINK name="JAVA(ShowTab('TabHelp',6))"/>
						</WTITEM>
					</WTITEM>
					<WTITEM label="mAccount" menuwidth="150">
						<WTIMAGE name="MyInfo.gif"/>
						<WTITEM label="mProfile">
							<WTCONDITION expr="IsInfo"/>
							<WTIMAGE name="MyInfo.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',1))"/>
						</WTITEM>
						<WTITEM label="mBillingMethod">
							<WTCONDITION expr="IsPayments"/>
							<WTIMAGE name="Finance.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',2))"/>
						</WTITEM>
						<WTITEM label="mPayoutMethod">
							<WTCONDITION expr="IsPayouts"/>
							<WTIMAGE name="Payout.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',3))"/>
						</WTITEM>
						<WTDIVIDER>
							<WTCONDITION expr="IsShortcuts"/>
						</WTDIVIDER>
						<WTITEM label="mShortcuts">
							<WTCONDITION expr="IsShortcuts"/>
							<WTIMAGE name="Shortcut.gif" width="11" height="11"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',4))"/>
						</WTITEM>
						<WTDIVIDER/>
						<WTITEM label="mChangeLogon">
							<WTCONDITION expr="CanChangeLogon"/>
							<WTCONDITION expr="IsChangeLogon" connector="and"/>
							<WTIMAGE name="logon.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',5))"/>
						</WTITEM>
						<WTITEM label="mChangePassword">
							<WTIMAGE name="logon.gif"/>
							<WTLINK name="JAVA(ShowTab('TabAccount',6))"/>
						</WTITEM>
						<WTITEM label="mSignout">
							<WTIMAGE name="close.gif"/>
							<WTLINK name="0101" nodata="true">
								<WTPARAM name="ActionCode" value="CONST(9)"/>
							</WTLINK>
						</WTITEM>
					</WTITEM>
				</WTMENU>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>
				<!--
				<WTROW>
					<WTCONDITION expr="NotMemberOnly"/>
					<WTSTATIC col="1" align="left" value="ATTR(Member.MemberName)"/>
				</WTROW>
-->
				<WTROW>
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="PARAM(MenuBehindColor)" />
				</WTROW>
				<WTROW height="36">
					<WTSTATIC col="1" align="left" valign="top" backcolor="PARAM(MenuBehindColor)" bgimg="PARAM(MenuBehindImage)">
						<WTCODEGROUP>
							<WTSTARTMENU name="MemberMenu" type="bar"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="PARAM(MenuBehindColor)" />
				</WTROW>

				<!-- ======================================================================= -->
				<WTROW id="TabDashboard">
					<WTFRAME col="1" merge="2" src="" name="DashboardFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0" backcolor="white"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabMarketing">
					<WTFRAME col="1" merge="2" src="" name="MarketingFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabProductivity">
					<WTFRAME col="1" merge="2" src="" name="ProductivityFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabLeadership">
					<WTFRAME col="1" merge="2" src="" name="LeadershipFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabTraining">
					<WTFRAME col="1" merge="2" src="" name="TrainingFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabFinancial">
					<WTFRAME col="1" merge="2" src="" name="FinancialFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabResources">
					<WTFRAME col="1" merge="2" src="" name="ResourcesFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" merge="2" src="" name="HelpFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabAccount">
					<WTFRAME col="1" merge="2" src="" name="AccountFrame" frmwidth="1000" frmheight="2000" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="m_BusinessTracker" caption="Business Tracker" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="wrapperMobile"
			page-image="bg.jpg" page-width="100%" margin-width="0" navbar-width="0" content-width="100%" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="m_BusinessTracker" mobile="MobileHome.asp" secured="98">
			<!--==================================================================-->
			<WTPARAM name="M" datatype="number"/>
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="G" datatype="number"/>
			<WTPARAM name="Header" datatype="text"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(G)" oper="equal" value="CONST(0)" />
				<WTGETCACHE name="PARAM(G)" value="GROUPID" datatype="number"/>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(M)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTCUSTOM>
					reqHeader = GetHeader( reqC, reqG, "MobileHeader", "" )
					If reqG &gt; 0 And reqHeader = "" Then reqHeader = GetHeader( reqCompanyID, 0, "MobileHeader", "" )
					reqHeader = "company/" + CStr(reqC) + "/" + reqHeader
				</WTCUSTOM>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NotMemberOnly"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(M)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(C)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(C)"/>
				</WTROW>

				<WTFUNCTION name="ShowTab(tab, shw)">
					var mid = document.getElementById('M').value;
					var cid = document.getElementById('C').value;
					var frame, url, frm, src, page, target='', style='', compare=0, load=0;

					switch(tab) {
					case 'TabMarketing':
					frame = 'MarketingFrame';
					switch(shw) {
					case 1: url = 'm_8162.asp?memberid=' + mid; break;
					case 2: url = 'm_8161.asp?memberid=' + mid; break;
					} break;
					case 'TabProductivity':
					frame = 'ProductivityFrame';
					switch(shw) {
					case 1: url = 'm_11702.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
					case 2: url = 'm_11712.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
					case 3: url = 'm_11710.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
					case 4: url = 'm_12610.asp?companyid=' + cid + '&amp;memberid=' + mid; break;
					} break;
					case 'TabFinancial':
					frame = 'FinancialFrame';
					switch(shw) {
					case 1: url = 'm_1022.asp?memberid=' + mid; break;
					case 2: url = 'm_0408.asp?referralid=' + mid; break;
					} break;
					case 'TabAccount':
					frame = 'AccountFrame';
					switch(shw) {
					case 1: url = 'm_0463.asp?memberid=' + mid; break;
					case 2: url = 'm_0436.asp?memberid=' + mid; break;
					case 3: url = 'm_0103.asp?contentpage=3&amp;popup=-1'; break;
					case 4: url = 'm_0106.asp?contentpage=3&amp;popup=-1'; break;
					} break;
					case 'TabHelp':
					frame = 'HelpFrame';
					switch(shw) {
					case 1: url = 'm_1713.asp?companyid=' + cid; break;
					case 2: url = 'm_8013.asp?companyid=' + cid; break;
					case 3: url = 'm_9506.asp?companyid=' + cid; break;
					} break;
					}
					if( target.length &gt; 0 ) {
					win = window.open(url,target,style);
					win.focus();
					}
					else {
					document.getElementById('Home').style.display = 'none';
					document.getElementById('Footer').style.display = '';
					document.getElementById('TabMarketing').style.display = 'none';
					document.getElementById('TabProductivity').style.display = 'none';
					document.getElementById('TabFinancial').style.display = 'none';
					document.getElementById('TabHelp').style.display = 'none';
					document.getElementById('TabAccount').style.display = 'none';
					document.getElementById(tab).style.display = '';
					if( tab == 'Home' ) { document.getElementById('Footer').style.display = 'none'; }

					frm = document.getElementById(frame);
					src = frm.src;
					if( compare == 0 ) { compare = url.indexOf('.') }
					page = url.substring(0,compare);
					if (load == 1 || src.indexOf(page) &lt; 0 ) {
					frm.src = url
					}
					}
				</WTFUNCTION>

				<WTLOAD>
					ShowTab('Home',1);
				</WTLOAD>

				<WTROW>
					<WTIMAGE col="1" align="center" value="PARAM(Header)"/>
				</WTROW>

				<WTROW id="Home" style="background:#eaeaea; height:440px;">
					<WTTABLE col="1" height="440">
						<WTCOLUMN width="20" align="center"/>
						<WTCOLUMN width="20" align="center"/>
						<WTCOLUMN width="60" align="left"/>
							
						<WTCODEGROUP>
							<WTCONDITION expr="IsSuspect"/>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="62">
								<WTIMAGE col="1" value="CONST(m_Contact.gif)" imgalign="absmiddle"/>
								<WTSTATIC col="2" merge="2" label="Contacts" class="BigHeading" align="left"/>
							</WTROW>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_ContactAdd.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="AddContact" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabMarketing', 1)" click="true" />
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_Contact.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="ViewContacts" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabMarketing', 2)" click="true" />
								</WTSTATIC>
							</WTROW>
						</WTCODEGROUP>
						<!-- ************************************************* -->
						<WTCODEGROUP>
							<WTCONDITION expr="IsActivityTracker"/>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="62">
								<WTIMAGE col="1" value="CONST(m_Activities.gif)" imgalign="absmiddle"/>
								<WTSTATIC col="2" merge="2" label="Activities" class="BigHeading" align="left"/>
							</WTROW>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_ActivitiesAdd.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="LogActivity" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabProductivity', 1)" click="true" />
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_Activities.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="Statistics" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabProductivity', 2)" click="true" />
								</WTSTATIC>
							</WTROW>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_LeaderBoard.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="LeaderBoard" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabProductivity', 3)" click="true" />
								</WTSTATIC>
							</WTROW>
							<WTCODEGROUP>
								<WTCONDITION expr="IsActivityContest"/>
								<WTROW>
									<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
								</WTROW>
								<WTROW height="50">
									<WTSTATIC col="1"/>
									<WTIMAGE col="2" value="CONST(m_Contest.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
									<WTSTATIC col="3" label="ViewContests" class="MenuHeading" align="left">
										<WTLINK name="ShowTab('TabProductivity', 4)" click="true" />
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<!-- ************************************************* -->
						<WTCODEGROUP>
							<WTCONDITION expr="IsFinances"/>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="62">
								<WTIMAGE col="1" value="CONST(m_Finance.gif)" imgalign="absmiddle"/>
								<WTSTATIC col="2" merge="2" label="Finances" class="BigHeading" align="left"/>
							</WTROW>
							<WTCODEGROUP>
								<WTCONDITION expr="IsPayments"/>
								<WTROW>
									<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
								</WTROW>
								<WTROW height="50">
									<WTSTATIC col="1"/>
									<WTIMAGE col="2" value="CONST(m_CreditCard.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
									<WTSTATIC col="3" label="Payments" class="MenuHeading" align="left">
										<WTLINK name="ShowTab('TabFinancial', 1)" click="true" />
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTROW>
									<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
								</WTROW>
								<WTROW height="50">
									<WTSTATIC col="1"/>
									<WTIMAGE col="2" value="CONST(m_Genealogy.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
									<WTSTATIC col="3" label="Referrals" class="MenuHeading" align="left">
										<WTLINK name="ShowTab('TabFinancial', 2)" click="true" />
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<!-- ************************************************* -->
						<WTROW>
							<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
						</WTROW>
						<WTROW height="62">
							<WTIMAGE col="1" value="CONST(m_Member.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" merge="2" label="Account" class="BigHeading" align="left"/>
						</WTROW>
						<WTCODEGROUP>
							<WTCONDITION expr="IsInfo"/>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_Member.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="Profile" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabAccount', 1)" click="true" />
								</WTSTATIC>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="IsPayments"/>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_CreditCard.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="BillingMethod" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabAccount', 2)" click="true" />
								</WTSTATIC>
							</WTROW>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CanChangeLogon"/>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="50">
								<WTSTATIC col="1"/>
								<WTIMAGE col="2" value="CONST(m_Logon.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
								<WTSTATIC col="3" label="ChangeLogon" class="MenuHeading" align="left">
									<WTLINK name="ShowTab('TabAccount', 3)" click="true" />
								</WTSTATIC>
							</WTROW>
						</WTCODEGROUP>
						<WTROW>
							<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
						</WTROW>
						<WTROW height="50">
							<WTSTATIC col="1"/>
							<WTIMAGE col="2" value="CONST(m_Logon.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
							<WTSTATIC col="3" label="ChangePassword" class="MenuHeading" align="left">
								<WTLINK name="ShowTab('TabAccount', 4)" click="true" />
							</WTSTATIC>
						</WTROW>
						<!-- ************************************************* -->
						<WTCODEGROUP>
							<WTCONDITION expr="IsSupportFAQ"/>
							<WTCONDITION expr="IsSupportDocs" connector="or"/>
							<WTCONDITION expr="IsSupportTicket" connector="or"/>
							<WTROW>
								<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
							</WTROW>
							<WTROW height="62">
								<WTIMAGE col="1" value="CONST(m_Help.gif)" imgalign="absmiddle"/>
								<WTSTATIC col="2" merge="2" label="Help" class="BigHeading" align="left"/>
							</WTROW>
							<WTCODEGROUP>
								<WTCONDITION expr="IsSupportFAQ"/>
								<WTROW>
									<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
								</WTROW>
								<WTROW height="50">
									<WTSTATIC col="1"/>
									<WTIMAGE col="2" value="CONST(m_Help2.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
									<WTSTATIC col="3" label="FAQ" class="MenuHeading" align="left">
										<WTLINK name="ShowTab('TabHelp', 1)" click="true" />
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="IsSupportDocs"/>
								<WTROW>
									<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
								</WTROW>
								<WTROW height="50">
									<WTSTATIC col="1"/>
									<WTIMAGE col="2" value="CONST(m_Docs.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
									<WTSTATIC col="3" label="Docs" class="MenuHeading" align="left">
										<WTLINK name="ShowTab('TabHelp', 2)" click="true" />
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="IsSupportTicket"/>
								<WTROW>
									<WTDIVIDER col="1" merge="3" height="1" color="#ddd"/>
								</WTROW>
								<WTROW height="50">
									<WTSTATIC col="1"/>
									<WTIMAGE col="2" value="CONST(m_SupportTicket.gif)" imgalign="absmiddle" imgwidth="48" imgheight="48"/>
									<WTSTATIC col="3" label="Tickets" class="MenuHeading" align="left">
										<WTLINK name="ShowTab('TabHelp', 3)" click="true" />
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
						</WTCODEGROUP>
						
					</WTTABLE>
				</WTROW>


				<!-- ======================================================================= -->
				<WTROW id="TabMarketing">
					<WTFRAME col="1" merge="2" src="" name="MarketingFrame" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabProductivity">
					<WTFRAME col="1" merge="2" src="" name="ProductivityFrame" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabFinancial">
					<WTFRAME col="1" merge="2" src="" name="FinancialFrame" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabHelp">
					<WTFRAME col="1" merge="2" src="" name="HelpFrame" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->
				<WTROW id="TabAccount">
					<WTFRAME col="1" merge="2" src="" name="AccountFrame" frmwidth="100" frmheight="440" label="NoFrameSupport" border="0"/>
				</WTROW>
				<!-- ======================================================================= -->

				<WTROW id="Footer" height="42" style="background:#666;">
					<WTBUTTON col="1" value="CONST(Home)" btnclass="bigbutton" align="center" valign="middle">
						<WTCLICK>ShowTab('Home',false);</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>