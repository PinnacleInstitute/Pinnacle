<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="13" name="Session" alias="se" language="false" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="1301" name="SessionID" type="number" identity="true" min="1" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="1302" name="MemberID" type="number" source="entity"/>
		<WTATTRIBUTE id="1303" name="CourseID" type="number" source="entity"/>
		<WTATTRIBUTE id="1304" name="OrgCourseID" type="number" source="entity"/>

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="1305" name="CourseName" type="text" length="60" min="1" max="60" source="join">
			<WTJOIN entity="Course" name="CourseName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1306" name="CourseLength" type="number" source="join">
			<WTJOIN entity="Course" name="CourseLength"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1307" name="PassingGrade" type="number" source="join">
			<WTJOIN entity="Course" name="PassingGrade"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1308" name="Video" type="number" source="join">
			<WTJOIN entity="Course" name="Video"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1309" name="Audio" type="number" source="join">
			<WTJOIN entity="Course" name="Audio"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1310" name="Quiz" type="number" source="join">
			<WTJOIN entity="Course" name="Quiz"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1311" name="MemberName" type="text" length="60" min="1" max="60" source="join">
			<WTJOIN entity="Member" name="CompanyName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1312" name="QuizLimit" type="number" source="join">
			<WTJOIN entity="Member" name="QuizLimit"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="1315" name="NameLast" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="1316" name="NameFirst" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="1317" name="StudentName" type="text" length="62" min="1" max="62" source="entity" title="true" >
			<WTCOMPUTE name="NameFirst"/>
			<WTCOMPUTE text=" "/>
			<WTCOMPUTE name="NameLast"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1318" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Registered"/>
			<WTENUM id="2" name="Started"/>
			<WTENUM id="3" name="Dropped"/>
			<WTENUM id="5" name="Completed"/>
			<WTENUM id="6" name="Quized"/>
			<WTENUM id="7" name="Certified"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1319" name="RegisterDate" type="date" source="entity"/>
		<WTATTRIBUTE id="1320" name="StartDate" type="date" source="entity"/>
		<WTATTRIBUTE id="1321" name="CompleteDate" type="date" source="entity"/>
		<WTATTRIBUTE id="1322" name="Grade" type="number" source="entity"/>

		<WTATTRIBUTE id="1323" name="Feedback" type="text" length="2000" min="1" max="2000" source="entity"/>
		<WTATTRIBUTE id="1324" name="Rating1" type="number" source="entity"/>
		<WTATTRIBUTE id="1325" name="Rating2" type="number" source="entity"/>
		<WTATTRIBUTE id="1326" name="Rating3" type="number" source="entity"/>
		<WTATTRIBUTE id="1327" name="Rating4" type="number" source="entity"/>
			<!-- Total Rating is the average of all ratings.  Integer between 0 and 10
				because ratings are between 0 and 5 with 0.5 precision. -->
		<WTATTRIBUTE id="1330" name="TotalRating" type="number" source="entity"/>
		<WTATTRIBUTE id="1331" name="URLOption" type="number" source="entity"/>
		<WTATTRIBUTE id="1332" name="Time" type="number" source="entity"/>
		<WTATTRIBUTE id="1333" name="Times" type="decimal" precision="8" length="10" source="entity"/>
		<WTATTRIBUTE id="1334" name="IsInactive" type="yesno" source="entity"/>
		<WTATTRIBUTE id="1335" name="TrainerScore" type="number" source="entity"/>
		<WTATTRIBUTE id="1336" name="CommStatus" type="number" source="entity">
			<WTENUM id="1" name="No"/>
			<WTENUM id="2" name="Yes"/>
			<WTENUM id="3" name="None"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1337" name="Apply" type="number" source="entity">
			<WTENUM id="1" name="Apply1"/>
			<WTENUM id="2" name="Apply2"/>
			<WTENUM id="3" name="Apply3"/>
			<WTENUM id="4" name="Apply4"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="1338" name="Recommend1" type="number" source="entity"/>
		<WTATTRIBUTE id="1339" name="Recommend2" type="number" source="entity"/>
		<WTATTRIBUTE id="1340" name="Recommend3" type="number" source="entity"/>

		<!-- Non-Persist Attributes -->
		<WTATTRIBUTE id="1390" name="Num1" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1391" name="Num2" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1392" name="Num3" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1393" name="Num4" type="number" source="entity" persist="false"/>

		<WTATTRIBUTE id="1394" name="OCStatus" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1395" name="OrgID" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1396" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="1397" name="ReportFromDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="1398" name="ReportToDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="1399" name="Credit" type="currency" source="entity" persist="false">
			<WTFORMAT value="#0.00"/>
		</WTATTRIBUTE>

		<!--Indexes-->
		<WTINDEX name="MemberID">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="CourseID"/>
		</WTINDEX>
		<WTINDEX name="CourseID">
			<WTATTRIBUTE name="CourseID"/>
		</WTINDEX>
		<WTINDEX name="TrainerScore">
			<WTATTRIBUTE name="TrainerScore"/>
			<WTATTRIBUTE name="CompleteDate"/>
		</WTINDEX>
		<WTINDEX name="MemberOrgCourse">
			<WTATTRIBUTE name="MemberID"/>
			<WTATTRIBUTE name="OrgCourseID"/>
			<WTATTRIBUTE name="IsInactive"/>
		</WTINDEX>

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Session" entity="Session" alias="se"/>
			<WTRELATIONSHIP name="Common" entity="Session" alias="se">
				<WTENTITY name="Course" entity="Course" alias="cs">
					<WTATTRIBUTE alias="se" name="CourseID" relalias="cs" relname="CourseID"/>
				</WTENTITY>
				<WTENTITY name="Member" entity="Member" alias="me">
					<WTATTRIBUTE alias="se" name="MemberID" relalias="me" relname="MemberID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Course" entity="Session" alias="se">
				<WTENTITY name="Course" entity="Course" alias="cs">
					<WTATTRIBUTE alias="se" name="CourseID" relalias="cs" relname="CourseID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
			<WTRELATIONSHIP name="Class" entity="Session" alias="se">
				<WTENTITY name="Course" entity="Course" alias="cs">
					<WTATTRIBUTE alias="se" name="CourseID" relalias="cs" relname="CourseID"/>
				</WTENTITY>
				<WTENTITY name="OrgCourse" entity="OrgCourse" alias="oc">
					<WTATTRIBUTE alias="se" name="CourseID" relalias="oc" relname="CourseID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<!--Parent-->

		<!--List-->

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="SESSION-REGISTERED" value="1"/>
			<WTSYSCON name="SESSION-STARTED" value="2"/>
			<WTSYSCON name="SESSION-DROPPED" value="3"/>
			<WTSYSCON name="SESSION-COMPLETED" value="5"/>
			<WTSYSCON name="SESSION-QUIZED" value="6"/>
			<WTSYSCON name="SESSION-CERTIFIED" value="7"/>
		</WTSYSCONS>

	</WTENTITY>

	<WTPROCEDURES>
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--==================================================================-->
		<WTPROCEDURE type="Count" name="Count" style="GenerateDataProc.xsl"/>
		<!--================================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl" template="new">
			<WTCODEGROUP>
				<WTPROCEDURE name="Shortcut_DeleteItem">
					<WTPARAM name="EntityID" direction="input" value="ENTITY(Session)"/>
					<WTPARAM name="ItemID" direction="input" value="PARAM(SessionID)"/>
				</WTPROCEDURE>
				<WTDELETE>
					<WTJOIN name="Session" lock="true"/>
					<WTCONDITION expr="ATTR(SessionID)" oper="equal" value="PARAM(SessionID)"/>
				</WTDELETE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="EnumXML" name="EnumProgram" enumname="EnumUserProgram" style="GenerateDataProc.xsl" nodata="true">
			<WTPARAM name="ATTR(Session.SessionID)" direction="input"/> <!-- CompanyID -->
			<WTPARAM name="ATTR(Session.MemberID)" direction="input"/>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Enum" name="EnumUserProgram" style="GenerateDataProc.xsl" column="CourseName" template="new" passthru="true" nodata="true">
			<WTPARAM name="ATTR(Session.SessionID)" direction="input"/> <!-- CompanyID -->
			<WTPARAM name="ATTR(Session.MemberID)" direction="input"/>
			<WTPARAM name="SYS(security)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE alias="ID" value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE alias="Name" value="ATTR(Session.CourseName)"/>
					<WTJOIN name="Class"/>
					<WTCONDITION expr="ATTR(Session.MemberID)" oper="equal" value="PARAM(MemberID)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="CheckCourse" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTPARAM name="SessionID" direction="output" datatype="number"/>
			
			<WTDECLARE name="SessionID" datatype="number"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE name="SessionID" value="ATTR(Session.SessionID)"/>
					<WTJOIN name="Session"/>
					<WTCONDITION expr="ATTR(Session.CourseID)" oper="equal" value="PARAM(CourseID)"/>
					<WTCONDITION expr="ATTR(Session.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
					<WTCONDITION expr="ATTR(Session.IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
				</WTSELECT>
				<WTSETVALUE name="PARAM(SessionID)" value="SessionID" null="0"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListMember" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Course"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Course.CourseCategoryID)" oper="greater-equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListMemberStatus" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Course"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="PARAM(Status)" connector="and"/>
					<WTCONDITION expr="ATTR(IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Course.CourseCategoryID)" oper="greater-equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListMemberComplete" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Course"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(4)" connector="and"/>
					<WTCONDITION expr="ATTR(IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Course.CourseCategoryID)" oper="greater-equal" value="CONST(0)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListMemberAll" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Course"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListMemberAllStatus" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Course"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="PARAM(Status)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListMemberAllComplete" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Course"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(4)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrgMember" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Class"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Course.CourseCategoryID)" oper="greater-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(OrgCourse.OrgID)" oper="equal" value="PARAM(OrgID)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrgMemberStatus" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Class"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="PARAM(Status)" connector="and"/>
					<WTCONDITION expr="ATTR(IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Course.CourseCategoryID)" oper="greater-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(OrgCourse.OrgID)" oper="equal" value="PARAM(OrgID)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrgMemberComplete" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Class"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(4)" connector="and"/>
					<WTCONDITION expr="ATTR(IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(Course.CourseCategoryID)" oper="greater-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="ATTR(OrgCourse.OrgID)" oper="equal" value="PARAM(OrgID)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrgMemberAll" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Class"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(OrgCourse.OrgID)" oper="equal" value="PARAM(OrgID)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrgMemberAllStatus" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(Status)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Class"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="PARAM(Status)" connector="and"/>
					<WTCONDITION expr="ATTR(OrgCourse.OrgID)" oper="equal" value="PARAM(OrgID)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListOrgMemberAllComplete" style="GenerateDataProc.xsl" template="new" passthru="true">
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="ATTR(OrgID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Course.CourseLength)"/>
					<WTATTRIBUTE value="ATTR(Course.PassingGrade)"/>
					<WTATTRIBUTE value="ATTR(Course.Video)"/>
					<WTATTRIBUTE value="ATTR(Course.Audio)"/>
					<WTATTRIBUTE value="ATTR(Course.Quiz)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.RegisterDate)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.IsInactive)"/>
					<WTJOIN name="Class"/>
					<WTCONDITION expr="ATTR(MemberID)" oper="equal" value="PARAM(MemberID)"/>
					<WTCONDITION expr="ATTR(Status)" oper="greater" value="CONST(4)" connector="and"/>
					<WTCONDITION expr="ATTR(OrgCourse.OrgID)" oper="equal" value="PARAM(OrgID)" connector="and"/>
					<WTORDER name="ATTR(Session.RegisterDate)" descend="true"/>
					<WTORDER name="ATTR(Course.CourseName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ProgramSummary" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/> <!-- CourseID -->
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>  <!-- SessionID -->
					<WTATTRIBUTE value="ATTR(Course.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.Credit)"/>
					<WTATTRIBUTE value="ATTR(Session.OCStatus)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListCourse" style="GenerateDataProc.xsl" template="new" passthru="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(CourseID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.MemberID)"/>
					<WTATTRIBUTE value="ATTR(Member.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTJOIN name="Common"/>
					<WTCONDITION expr="ATTR(CourseID)" oper="equal" value="PARAM(CourseID)"/>
					<WTORDER name="ATTR(Session.StudentName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="List" name="ListRatings" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
		<!--==================================================================-->
			<WTPARAM name="ATTR(CourseID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)" alias="StudentName"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Rating1)"/>
					<WTATTRIBUTE value="ATTR(Session.Rating2)"/>
					<WTATTRIBUTE value="ATTR(Session.Rating3)"/>
					<WTATTRIBUTE value="ATTR(Session.Rating4)"/>
					<WTATTRIBUTE value="ATTR(Session.TotalRating)"/>
					<WTATTRIBUTE value="ATTR(Session.Feedback)"/>
					<WTATTRIBUTE value="ATTR(Session.Apply)"/>
					<WTATTRIBUTE value="ATTR(Session.Recommend1)"/>
					<WTATTRIBUTE value="ATTR(Session.Recommend2)"/>
					<WTATTRIBUTE value="ATTR(Session.Recommend3)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="SetStatus" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(SessionID)" direction="input"/>
			<WTPARAM name="ATTR(Feedback)" direction="input"/>  <!-- Lessons -->
			<WTPARAM name="MemberID" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Remove" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(SessionID)" direction="input"/>
			<WTPARAM name="MemberID" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE name="MemberAccess" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTPARAM name="Quantity" direction="output" datatype="number"/>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportOrg" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Session.OCStatus)"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.Quantity)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportOrgCourse" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(OrgID)" direction="input"/>
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.StudentName)"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="ReportMember" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(ReportFromDate)" direction="input"/>
			<WTPARAM name="ATTR(ReportToDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Session.Feedback)"/>
					<WTATTRIBUTE value="ATTR(Session.MemberName)"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
					<WTATTRIBUTE value="ATTR(Session.StartDate)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.Time)"/>
					<WTATTRIBUTE value="ATTR(Session.Times)"/>
					<WTATTRIBUTE value="ATTR(Session.OrgCourseID)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="CoursesMember" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(MemberID)" direction="input"/>
			<WTPARAM name="ATTR(StartDate)" direction="input"/>
			<WTPARAM name="ATTR(CompleteDate)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseName)"/>
					<WTATTRIBUTE value="ATTR(Session.CompleteDate)"/>
					<WTATTRIBUTE value="ATTR(Session.Grade)"/>
					<WTATTRIBUTE value="ATTR(Session.Num1)"/>
					<WTATTRIBUTE value="ATTR(Session.Status)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>

		<!--==================================================================================================-->
		<WTPROCEDURE type="List" name="CoursesBusiness" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
		<!--==================================================================================================-->
			<WTPARAM name="ATTR(MemberID)" direction="input"/>  <!-- MasterID -->
			<WTPARAM name="ATTR(StartDate)" direction="input"/>
			<WTPARAM name="ATTR(CompleteDate)" direction="input"/>
			<WTPARAM name="ATTR(CourseID)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Session.SessionID)"/>
					<WTATTRIBUTE value="ATTR(Session.CourseName)"/>  <!-- Group -->
					<WTATTRIBUTE value="ATTR(Session.MemberName)"/>  <!-- Role -->
					<WTATTRIBUTE value="ATTR(Session.Num1)"/>
					<WTATTRIBUTE value="ATTR(Session.Num2)"/>
					<WTATTRIBUTE value="ATTR(Session.Num3)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
    <!--==================================================================================================-->
    <WTPROCEDURE name="Reset" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
      <!--==================================================================================================-->
      <WTPARAM name="ATTR(SessionID)" direction="input"/>
      <WTPARAM name="Status" direction="output" datatype="number"/>
    </WTPROCEDURE>

  </WTPROCEDURES>

	<WTWEBPAGES>
		<!--===============================================================================-->
		<WTWEBPAGE name="1303" caption="Session" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52">
		<!--===============================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>

      <WTSUB name="LoadSession">
        <WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
          <WTMETHOD name="Load">
            <WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
            <WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
          </WTMETHOD>
          <WTMETHOD name="XML">
            <WTPARAM name="xmlSession" direction="return" datatype="text"/>
            <WTPARAM name="Option" direction="input" value="CONST(2)"/>
          </WTMETHOD>
        </WTOBJECT>
      </WTSUB>

      <WTACTION name="New" type="New" id="0">
        <WTCALLSUB name="LoadSession"/>
      </WTACTION>

      <WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Delete">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

      <WTACTION id="5" name="Reset" type="Update">
        <WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
          <WTMETHOD name="Reset">
            <WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
            <WTPARAM name="Result" direction="return" datatype="number"/>
          </WTMETHOD>
        </WTOBJECT>
        <WTCALLSUB name="LoadSession"/>
      </WTACTION>

      <!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" tag="Session" value="ATTR(Session.CourseName)" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="StudentName"/>
					<WTTEXT col="2" value="ATTR(Session.NameFirst)" width="200" label="NameFirst" size="25"/>
					<WTTEXT col="2" value="ATTR(Session.NameLast)" width="240" label="NameLast" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Status"/>
					<WTCOMBO col="2" value="ATTR(Session.Status)"/>
					<WTCHECK col="2" value="ATTR(Session.IsInactive)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Time"/>
					<WTSTATIC col="2" value="ATTR(Session.Time)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Times"/>
					<WTSTATIC col="2" value="ATTR(Session.Times)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="RegisterDate"/>
					<WTTEXT col="2" value="ATTR(Session.RegisterDate)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="StartDate"/>
					<WTTEXT col="2" value="ATTR(Session.StartDate)" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CompleteDate"/>
					<WTTEXT col="2" value="ATTR(Session.CompleteDate)" prespace="false"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Grade"/>
					<WTTEXT col="2" value="ATTR(Session.Grade)" size="2"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="TotalRating"/>
					<WTTEXT col="2" value="ATTR(Session.TotalRating)" size="2"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Rating1Caption"/>
					<WTTEXT col="2" value="ATTR(Session.Rating1)" size="2"/>
					<WTSTATIC col="2" tag="Rating2Caption"/>
					<WTTEXT col="2" value="ATTR(Session.Rating2)" size="2" prespace="false"/>
					<WTSTATIC col="2" tag="Rating3Caption"/>
					<WTTEXT col="2" value="ATTR(Session.Rating3)" size="2" prespace="false"/>
					<WTSTATIC col="2" tag="Rating4Caption"/>
					<WTTEXT col="2" value="ATTR(Session.Rating4)" size="2" prespace="false"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1"/>
					<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Apply"/>
					<WTCOMBO col="2" value="ATTR(Session.Apply)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="RecommendTo"/>
					<WTCHECK col="2" value="ATTR(Session.Recommend1)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Session.Recommend2)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTCHECK col="2" value="ATTR(Session.Recommend3)"/>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="6" label="MemberComments" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTMEMO col="1" merge="6" value="ATTR(Session.Feedback)" rows="6" cols="72"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="TrainerScore"/>
					<WTTEXT col="2" value="ATTR(Session.TrainerScore)" size="6"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="CommStatus"/>
					<WTCOMBO col="2" value="ATTR(Session.CommStatus)"/>
				</WTROW>
			
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
          <WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
          <WTBUTTON col="1" merge="2" action="4" value="CONST(Delete)" msg="ConfirmDelete" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
          <WTBUTTON col="1" merge="2" action="5" value="CONST(Reset)" msg="ConfirmReset" align="center"/>
        </WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>
		
		<!--===============================================================================-->
		<WTWEBPAGE name="1304" caption="Ratings" navbar="false" focus="false" header="false" footer="false" wrapper="wrapper600"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52">
		<!--===============================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<!--					<WTSETATTRIBUTE name="ATTR(TotalRating)" value="CONST(0)"/>-->
<!--
<WTCUSTOM>
					If .Rating1 = 0 Then .Rating1 = 3
					If .Rating2 = 0 Then .Rating2 = 3
					If .Rating3 = 0 Then .Rating3 = 3
					If .Rating4 = 0 Then .Rating4 = 3
</WTCUSTOM>
-->
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Rating1)" value="FORM(Rating1)"/>
					<WTSETATTRIBUTE name="ATTR(Rating2)" value="FORM(Rating2)"/>
					<WTSETATTRIBUTE name="ATTR(Rating3)" value="FORM(Rating3)"/>
					<WTSETATTRIBUTE name="ATTR(Rating4)" value="FORM(Rating4)"/>
					<WTSETATTRIBUTE name="ATTR(TotalRating)" value="FORM(TotalRating)"/>
					<WTSETATTRIBUTE name="ATTR(Apply)" value="FORM(Apply)"/>
					<WTSETATTRIBUTE name="ATTR(Recommend1)" value="FORM(Recommend1)"/>
					<WTSETATTRIBUTE name="ATTR(Recommend2)" value="FORM(Recommend2)"/>
					<WTSETATTRIBUTE name="ATTR(Recommend3)" value="FORM(Recommend3)"/>
					<WTSETATTRIBUTE name="ATTR(Feedback)" value="FORM(Feedback)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="1330" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
						<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
						<WTPARAM name="Popup" value="PARAM(Popup)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>

				<WTFUNCTION name="SelectRating(group, rating)">
					document.getElementById('Rating' + String(group)).value = rating;
					for(i = 1; i &lt;= 5; i++){
						if( i &gt; rating){
							document.getElementById( "Rating" + String(group) + String(i) ).src = "Images/star_empty.gif";
						}else{
							document.getElementById( "Rating" + String(group) + String(i) ).src = "Images/star_full.gif";
						}
					}
					ComputeTotalRating();
				</WTFUNCTION>
				<WTFUNCTION name="ComputeTotalRating()">
					var total = 0;
					var str;
					for(i = 1; i &lt;= 4; i++){
						total += parseInt(document.getElementById( 'Rating' + String(i) ).value);
					}
					total = Math.round( total / 2.0 );
					document.getElementById('TotalRating').value = total;
					//total /= 2.0;
					//str = total.toString();
					//if( str.indexOf(".") == -1 ){
					//	str += ".0"
					//}
					// document.getElementById('TotalRatingImage').src = "Images/Star" + str + ".gif"
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="ATTR(Session.Rating1)"/>
					<WTHIDDEN value="ATTR(Session.Rating2)"/>
					<WTHIDDEN value="ATTR(Session.Rating3)"/>
					<WTHIDDEN value="ATTR(Session.Rating4)"/>
					<WTHIDDEN value="ATTR(Session.TotalRating)"/>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="6">
					<WTSTATIC col="1" label="Congradulations" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="ATTR(Session.CourseName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="RatingInstructions" class="Prompt" align="left"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW>
					<WTTABLE col="1" >
						<WTCOLUMN width="360" align="left"/>
						<WTCOLUMN width="48" align="center"/>
						<WTCOLUMN width="48" align="center"/>
						<WTCOLUMN width="48" align="center"/>
						<WTCOLUMN width="48" align="center"/>
						<WTCOLUMN width="48" align="center"/>
						
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="EvalLegend" align="right" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" label="ClickStar" bold="true"/>
							<WTSTATIC col="2" value="CONST(P)" class="PageHeading"/>
							<WTSTATIC col="3" value="CONST(F)" class="PageHeading"/>
							<WTSTATIC col="4" value="CONST(G)" class="PageHeading"/>
							<WTSTATIC col="5" value="CONST(GR)" class="PageHeading"/>
							<WTSTATIC col="6" value="CONST(E)" class="PageHeading"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="Rating1" class="PageHeading"/>
							<WTIMAGE col="2" value="CONST(star_empty.gif)" id="Rating11" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(1)"/><WTCLICK>SelectRating(1, 1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(star_full.gif)" id="Rating11" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(1)"/><WTCLICK>SelectRating(1, 1);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="3" value="CONST(star_empty.gif)" id="Rating12" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(2)"/><WTCLICK>SelectRating(1, 2);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(star_full.gif)" id="Rating12" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(2)"/><WTCLICK>SelectRating(1, 2);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="4" value="CONST(star_empty.gif)" id="Rating13" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(3)"/><WTCLICK>SelectRating(1, 3);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="4" value="CONST(star_full.gif)" id="Rating13" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(3)"/><WTCLICK>SelectRating(1, 3);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="5" value="CONST(star_empty.gif)" id="Rating14" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(4)"/><WTCLICK>SelectRating(1, 4);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="5" value="CONST(star_full.gif)" id="Rating14" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(4)"/><WTCLICK>SelectRating(1, 4);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="6" value="CONST(star_empty.gif)" id="Rating15" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(5)"/><WTCLICK>SelectRating(1, 5);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="6" value="CONST(star_full.gif)" id="Rating15" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(5)"/><WTCLICK>SelectRating(1, 5);</WTCLICK>
							</WTIMAGE>								
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="Rating2" class="PageHeading"/>
							<WTIMAGE col="2" value="CONST(star_empty.gif)" id="Rating21" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="less" value="CONST(1)"/><WTCLICK>SelectRating(2, 1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(star_full.gif)" id="Rating21" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="greater-equal" value="CONST(1)"/><WTCLICK>SelectRating(2, 1);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="3" value="CONST(star_empty.gif)" id="Rating22" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="less" value="CONST(2)"/><WTCLICK>SelectRating(2, 2);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(star_full.gif)" id="Rating22" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="greater-equal" value="CONST(2)"/><WTCLICK>SelectRating(2, 2);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="4" value="CONST(star_empty.gif)" id="Rating23" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="less" value="CONST(3)"/><WTCLICK>SelectRating(2, 3);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="4" value="CONST(star_full.gif)" id="Rating23" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="greater-equal" value="CONST(3)"/><WTCLICK>SelectRating(2, 3);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="5" value="CONST(star_empty.gif)" id="Rating24" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="less" value="CONST(4)"/><WTCLICK>SelectRating(2, 4);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="5" value="CONST(star_full.gif)" id="Rating24" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="greater-equal" value="CONST(4)"/><WTCLICK>SelectRating(2, 4);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="6" value="CONST(star_empty.gif)" id="Rating25" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="less" value="CONST(5)"/><WTCLICK>SelectRating(2, 5);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="6" value="CONST(star_full.gif)" id="Rating25" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating2)" oper="greater-equal" value="CONST(5)"/><WTCLICK>SelectRating(2, 5);</WTCLICK>
							</WTIMAGE>								
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="Rating3" class="PageHeading"/>
							<WTIMAGE col="2" value="CONST(star_empty.gif)" id="Rating31" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="less" value="CONST(1)"/><WTCLICK>SelectRating(3, 1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(star_full.gif)" id="Rating31" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="greater-equal" value="CONST(1)"/><WTCLICK>SelectRating(3, 1);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="3" value="CONST(star_empty.gif)" id="Rating32" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="less" value="CONST(2)"/><WTCLICK>SelectRating(3, 2);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(star_full.gif)" id="Rating32" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="greater-equal" value="CONST(2)"/><WTCLICK>SelectRating(3, 2);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="4" value="CONST(star_empty.gif)" id="Rating33" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="less" value="CONST(3)"/><WTCLICK>SelectRating(3, 3);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="4" value="CONST(star_full.gif)" id="Rating33" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="greater-equal" value="CONST(3)"/><WTCLICK>SelectRating(3, 3);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="5" value="CONST(star_empty.gif)" id="Rating34" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="less" value="CONST(4)"/><WTCLICK>SelectRating(3, 4);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="5" value="CONST(star_full.gif)" id="Rating34" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="greater-equal" value="CONST(4)"/><WTCLICK>SelectRating(3, 4);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="6" value="CONST(star_empty.gif)" id="Rating35" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="less" value="CONST(5)"/><WTCLICK>SelectRating(3, 5);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="6" value="CONST(star_full.gif)" id="Rating35" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating3)" oper="greater-equal" value="CONST(5)"/><WTCLICK>SelectRating(3, 5);</WTCLICK>
							</WTIMAGE>								
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="Rating4" class="PageHeading"/>
							<WTIMAGE col="2" value="CONST(star_empty.gif)" id="Rating41" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="less" value="CONST(1)"/><WTCLICK>SelectRating(4, 1);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="2" value="CONST(star_full.gif)" id="Rating41" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="greater-equal" value="CONST(1)"/><WTCLICK>SelectRating(4, 1);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="3" value="CONST(star_empty.gif)" id="Rating42" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="less" value="CONST(2)"/><WTCLICK>SelectRating(4, 2);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="3" value="CONST(star_full.gif)" id="Rating42" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="greater-equal" value="CONST(2)"/><WTCLICK>SelectRating(4, 2);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="4" value="CONST(star_empty.gif)" id="Rating43" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="less" value="CONST(3)"/><WTCLICK>SelectRating(4, 3);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="4" value="CONST(star_full.gif)" id="Rating43" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="greater-equal" value="CONST(3)"/><WTCLICK>SelectRating(4, 3);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="5" value="CONST(star_empty.gif)" id="Rating44" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="less" value="CONST(4)"/><WTCLICK>SelectRating(4, 4);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="5" value="CONST(star_full.gif)" id="Rating44" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="greater-equal" value="CONST(4)"/><WTCLICK>SelectRating(4, 4);</WTCLICK>
							</WTIMAGE>
							
							<WTIMAGE col="6" value="CONST(star_empty.gif)" id="Rating45" imgalign="bottom" imgwidth="20">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="less" value="CONST(5)"/><WTCLICK>SelectRating(4, 5);</WTCLICK>
							</WTIMAGE>
							<WTIMAGE col="6" value="CONST(star_full.gif)" id="Rating45" imgalign="bottom" imgwidth="20" prespace="false">
								<WTCONDITION expr="ATTR(Session.Rating4)" oper="greater-equal" value="CONST(5)"/><WTCLICK>SelectRating(4, 5);</WTCLICK>
							</WTIMAGE>								
						</WTROW>

						<WTROW margin-bottom="6" margin-top="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="ApplyText" align="left" bold="true"/>
							<WTCOMBO col="1" merge="6" value="ATTR(Session.Apply)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="6" label="Recommend" align="left" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTCHECK col="1" merge="6" value="ATTR(Session.Recommend1)"/>
							<WTCHECK col="1" merge="6" value="ATTR(Session.Recommend2)"/>
							<WTCHECK col="1" merge="6" value="ATTR(Session.Recommend3)"/>
						</WTROW>
						<WTROW margin-bottom="12" margin-top="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
<!--						
						<WTROW>
							<WTSTATIC col="1" tag="TotalRating"  class="PageHeading" align="right"/>
							<WTIMAGE col="2" merge="5" value="CONST(star0.0.gif)" id="TotalRatingImage" imgalign="bottom" imgwidth="100"/>							
						</WTROW>
-->
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="Feedback" align="left" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTMEMO col="1" merge="6" value="ATTR(Session.Feedback)" rows="6" cols="72"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="1" value="CONST(Continue)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1304" caption="Course Ratings" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!--					<WTSETATTRIBUTE name="ATTR(TotalRating)" value="CONST(0)"/>-->
					<!--
<WTCUSTOM>
					If .Rating1 = 0 Then .Rating1 = 3
					If .Rating2 = 0 Then .Rating2 = 3
					If .Rating3 = 0 Then .Rating3 = 3
					If .Rating4 = 0 Then .Rating4 = 3
</WTCUSTOM>
-->
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Rating1)" value="FORM(Rating1)"/>
					<WTSETATTRIBUTE name="ATTR(Rating2)" value="FORM(Rating2)"/>
					<WTSETATTRIBUTE name="ATTR(Rating3)" value="FORM(Rating3)"/>
					<WTSETATTRIBUTE name="ATTR(Rating4)" value="FORM(Rating4)"/>
					<WTSETATTRIBUTE name="ATTR(TotalRating)" value="FORM(TotalRating)"/>
					<WTSETATTRIBUTE name="ATTR(Apply)" value="FORM(Apply)"/>
					<WTSETATTRIBUTE name="ATTR(Recommend1)" value="FORM(Recommend1)"/>
					<WTSETATTRIBUTE name="ATTR(Recommend2)" value="FORM(Recommend2)"/>
					<WTSETATTRIBUTE name="ATTR(Recommend3)" value="FORM(Recommend3)"/>
					<WTSETATTRIBUTE name="ATTR(Feedback)" value="FORM(Feedback)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="m_1330" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
						<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
						<WTPARAM name="Popup" value="PARAM(Popup)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTFUNCTION name="SelectRating(group, rating)">
					document.getElementById('Rating' + String(group)).value = rating;
					for(i = 1; i &lt;= 5; i++){
					if( i &gt; rating){
					document.getElementById( "Rating" + String(group) + String(i) ).src = "Images/star_empty.gif";
					}else{
					document.getElementById( "Rating" + String(group) + String(i) ).src = "Images/star_full.gif";
					}
					}
					ComputeTotalRating();
				</WTFUNCTION>
				<WTFUNCTION name="ComputeTotalRating()">
					var total = 0;
					var str;
					for(i = 1; i &lt;= 4; i++){
					total += parseInt(document.getElementById( 'Rating' + String(i) ).value);
					}
					total = Math.round( total / 2.0 );
					document.getElementById('TotalRating').value = total;
					//total /= 2.0;
					//str = total.toString();
					//if( str.indexOf(".") == -1 ){
					//	str += ".0"
					//}
					// document.getElementById('TotalRatingImage').src = "Images/Star" + str + ".gif"
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="ATTR(Session.Rating1)"/>
					<WTHIDDEN value="ATTR(Session.Rating2)"/>
					<WTHIDDEN value="ATTR(Session.Rating3)"/>
					<WTHIDDEN value="ATTR(Session.Rating4)"/>
					<WTHIDDEN value="ATTR(Session.TotalRating)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="6">
					<WTSTATIC col="1" tag="m_Congradulations" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="ATTR(Session.CourseName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="RatingInstructions" class="Prompt" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" >
						<WTCOLUMN width="17" align="left"/>
						<WTCOLUMN width="17" align="center"/>
						<WTCOLUMN width="16" align="center"/>
						<WTCOLUMN width="17" align="center"/>
						<WTCOLUMN width="17" align="center"/>
						<WTCOLUMN width="16" align="center"/>

						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="ClickStar" bold="true" class="Prompt" align="left"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="EvalLegend" align="right" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" value="CONST(P)" class="PageHeading"/>
							<WTSTATIC col="3" value="CONST(F)" class="PageHeading"/>
							<WTSTATIC col="4" value="CONST(G)" class="PageHeading"/>
							<WTSTATIC col="5" value="CONST(GR)" class="PageHeading"/>
							<WTSTATIC col="6" value="CONST(E)" class="PageHeading"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="6" label="Rating1" bold="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating11" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(1)"/>
										<WTCLICK>SelectRating(1, 1);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating11" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(1)"/>
										<WTCLICK>SelectRating(1, 1);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating12" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(2)"/>
										<WTCLICK>SelectRating(1, 2);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating12" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(2)"/>
										<WTCLICK>SelectRating(1, 2);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating13" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(3)"/>
										<WTCLICK>SelectRating(1, 3);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating13" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(3)"/>
										<WTCLICK>SelectRating(1, 3);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating14" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(4)"/>
										<WTCLICK>SelectRating(1, 4);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating14" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(4)"/>
										<WTCLICK>SelectRating(1, 4);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="6">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating15" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(5)"/>
										<WTCLICK>SelectRating(1, 5);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating15" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(5)"/>
										<WTCLICK>SelectRating(1, 5);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="6" label="Rating2" bold="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating21" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(1)"/>
										<WTCLICK>SelectRating(2, 1);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating21" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(1)"/>
										<WTCLICK>SelectRating(2, 1);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating22" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(2)"/>
										<WTCLICK>SelectRating(2, 2);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating22" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(2)"/>
										<WTCLICK>SelectRating(2, 2);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating23" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(3)"/>
										<WTCLICK>SelectRating(2, 3);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating23" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(3)"/>
										<WTCLICK>SelectRating(2, 3);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating24" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(4)"/>
										<WTCLICK>SelectRating(2, 4);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating24" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(4)"/>
										<WTCLICK>SelectRating(2, 4);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="6">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating25" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(5)"/>
										<WTCLICK>SelectRating(2, 5);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating25" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(5)"/>
										<WTCLICK>SelectRating(2, 5);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="6" label="Rating3" bold="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating31" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(1)"/>
										<WTCLICK>SelectRating(3, 1);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating31" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(1)"/>
										<WTCLICK>SelectRating(3, 1);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating32" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(2)"/>
										<WTCLICK>SelectRating(3, 2);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating32" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(2)"/>
										<WTCLICK>SelectRating(3, 2);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating33" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(3)"/>
										<WTCLICK>SelectRating(3, 3);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating33" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(3)"/>
										<WTCLICK>SelectRating(3, 3);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating34" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(4)"/>
										<WTCLICK>SelectRating(3, 4);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating34" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(4)"/>
										<WTCLICK>SelectRating(3, 4);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="6">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating35" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(5)"/>
										<WTCLICK>SelectRating(3, 5);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating35" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(5)"/>
										<WTCLICK>SelectRating(3, 5);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" merge="6" label="Rating4" bold="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating41" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(1)"/>
										<WTCLICK>SelectRating(4, 1);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating41" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(1)"/>
										<WTCLICK>SelectRating(4, 1);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating42" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(2)"/>
										<WTCLICK>SelectRating(4, 2);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating42" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(2)"/>
										<WTCLICK>SelectRating(4, 2);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating43" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(3)"/>
										<WTCLICK>SelectRating(4, 3);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating43" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(3)"/>
										<WTCLICK>SelectRating(4, 3);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating44" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(4)"/>
										<WTCLICK>SelectRating(4, 4);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating44" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(4)"/>
										<WTCLICK>SelectRating(4, 4);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="6">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(star_empty.gif)" id="Rating45" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="less" value="CONST(5)"/>
										<WTCLICK>SelectRating(4, 5);</WTCLICK>
									</WTIMAGE>
									<WTIMAGE value="CONST(star_full.gif)" id="Rating45" imgalign="bottom" imgwidth="20">
										<WTCONDITION expr="ATTR(Session.Rating1)" oper="greater-equal" value="CONST(5)"/>
										<WTCLICK>SelectRating(4, 5);</WTCLICK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-bottom="6" margin-top="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="ApplyText" align="left" bold="true"/>
							<WTCOMBO col="1" merge="6" value="ATTR(Session.Apply)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="6" label="Recommend" align="left" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1"/>
							<WTCHECK col="2" merge="5" value="ATTR(Session.Recommend1)" align="left"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1"/>
							<WTCHECK col="2" merge="5" value="ATTR(Session.Recommend2)" align="left"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTCHECK col="2" merge="5" value="ATTR(Session.Recommend3)" align="left"/>
						</WTROW>
						<WTROW margin-bottom="12" margin-top="6">
							<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="6" label="Feedback" align="left" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTMEMO col="1" merge="6" value="ATTR(Session.Feedback)" rows="6" cols="35"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="3" action="1" value="CONST(Continue)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1305" caption="Session" header="false" footer="false" wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" secured="52">
		<!--===============================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" tag="Session" value="ATTR(Session.CourseName)" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="StudentNameText" class="prompt" align="left"/>
				</WTROW>
<!--				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
-->				
				<WTROW>
					<WTSTATIC col="1" tag="StudentName"/>
					<WTTEXT col="2" value="ATTR(Session.NameFirst)" width="200" label="NameFirst" size="25"/>
					<WTTEXT col="2" value="ATTR(Session.NameLast)" width="240" label="NameLast" size="25"/>
				</WTROW>
			
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1305" caption="Class Student" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION name="Update" type="Update" id="1">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="33" align="right"/>
				<WTCOLUMN width="67" align="left"/>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" tag="Session" value="ATTR(Session.CourseName)" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="StudentNameText" class="prompt" align="left"/>
				</WTROW>
<!--				
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
-->				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="NameFirst"/>
					<WTTEXT col="2" value="ATTR(Session.NameFirst)" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="NameLast"/>
					<WTTEXT col="2" value="ATTR(Session.NameLast)" size="20"/>
				</WTROW>
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1311" caption="My Classes" focus="false" contentpage="true" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="52" track="0">
		<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>  
			<WTPARAM name="CompanyID" datatype="number"/>  
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Program" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTDATATXN name="Programs"/>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotClasses" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTSUB name="LoadClasses">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(affiliateid)"/>
				</WTCODEGROUP>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="EnumProgram">
						<WTPARAM name="xmlPrograms" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(Program)"/>
						<WTPARAM name="Element" direction="input" value="CONST(&quot;PROGRAM&quot;)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Program)" oper="equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
							<WTMETHOD name="ListMemberAll">
								<WTCONDITION expr="IsEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="ListMember">
								<WTCONDITION expr="NotEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(5)"/>
								<WTMETHOD name="ListMemberAllStatus">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListMemberStatus">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(5)"/>
								<WTMETHOD name="ListMemberAllComplete">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListMemberComplete">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Program)" oper="not-equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
							<WTMETHOD name="ListOrgMemberAll">
								<WTCONDITION expr="IsEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="ListOrgMember">
								<WTCONDITION expr="NotEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(5)"/>
								<WTMETHOD name="ListOrgMemberAllStatus">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListOrgMemberStatus">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(5)"/>
								<WTMETHOD name="ListOrgMemberAllComplete">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListOrgMemberComplete">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
<WTCUSTOM>
				For Each oSession in oSessions
				   With oSession
						secs = .Time
						seconds = secs Mod 60 
						minutes = Int(secs / 60 ) Mod 60
						hours = Int(secs / 3600 )
						fmt = ""
						If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
						If minutes &lt; 10 Then fmt = fmt + "0"
						fmt = fmt &amp; minutes &amp; ":"
						If seconds &lt; 10 Then fmt = fmt + "0"
						.Time = fmt &amp; seconds &amp; "(" &amp; FormatNumber(.Times, 1 ) &amp; ")"
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/> 
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="or"/>
						<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadClasses"/>
			</WTACTION>

			<WTACTION name="Status" type="New" id="1">
				<WTSETATTRIBUTE name="PARAM(Status)" value="FORM(Status)"/>
				<WTCALLSUB name="LoadClasses"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="175" align="left"/>
				<WTCOLUMN width="425" align="right"/>

				<WTFUNCTION name="catalog()">
					var company = document.getElementById('CompanyID').value;
					var member = document.getElementById('MemberID').value;  
					var URL="1212.asp?Mode=2&amp;CompanyID=" + company + "&amp;MemberID=" + member + "&amp;contentpage=3";  
					window.open( URL);
				</WTFUNCTION>
				<WTFUNCTION name="ViewProgram()">
					var program = document.getElementById('Program').value;
					var member = document.getElementById('MemberID').value;  
					var URL="1316.asp?ProgramID=" + program + "&amp;MemberID=" + member
					window.open( URL, "Program");
				</WTFUNCTION>

				<WTLOAD>parent.scrollTo(0,0);</WTLOAD>

				<WTSTATIC label="ViewCatalog"/>
				<WTSTATIC label="ViewGradeBook"/>

				<WTROW>
					<WTHIDDEN name="MemberID" value="PARAM(MemberID)"/>
					<WTHIDDEN name="CompanyID" value="PARAM(CompanyID)"/>
					<WTHIDDEN name="contentpage" value="PARAM(ContentPage)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="IsEmployee"/>
					 <WTLINKGROUP col="1" merge="2" align="right">
						<WTLINK name="0404" label="Home" class="PageHeadingLink" nodata="true">
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						</WTLINK>
					 </WTLINKGROUP>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="75" align="center"/>
						<WTCOLUMN width="425" align="left"/>
						<WTCOLUMN width="100" align="center"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(IconK.gif)" align="center"/>
							<WTSTATIC col="2" align="left" class="prompt">
								<WTSTATIC label="NoSessionsText">
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONS/PTSSESSION))" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="SessionsText">
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONS/PTSSESSION))" oper="greater" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="3" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="_IsCatalog"/>
									<WTCONDITION expr="IsEmployee" connector="or"/>
									<WTIMAGE value="CONST(Book.gif)" alt="ViewCatalog" imgalign="absmiddle">
										<WTLINK name="1212" nodata="true">
											<WTPARAM name="Mode" value="CONST(2)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
										</WTLINK>
<!--										<WTLINK name="catalog()" click="true" />-->
									</WTIMAGE>
									<WTSTATIC newline="1"/>
									<WTSTATIC label="CourseCatalog" bold="true"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" merge="2" label="View" bold="true" align="right"/>
					<WTCOMBO col="1" value="PARAM(Program)" datapath="/DATA/TXN/PTSPROGRAMS/ENUM" setselected="true">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROGRAMS/ENUM))" oper="greater" value="CONST(1)"/>
						<WTCHANGE>doSubmit(1,"")</WTCHANGE>
					</WTCOMBO>
					<WTCOMBO col="1" value="PARAM(Status)">
						<WTCHANGE>doSubmit(1,"")</WTCHANGE>
						<WTOPTION id="0" label="ViewAll"/>
						<WTOPTION id="1" label="ViewRegistered"/>
						<WTOPTION id="2" label="ViewStarted"/>
						<WTOPTION id="5" label="ViewCompleted"/>
						<WTOPTION id="6" label="ViewFailed"/>
						<WTOPTION id="7" label="ViewPassed"/>
					</WTCOMBO>
					<WTBUTTON col="1" align="center" value="CONST(Close)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" label="RegisteredClasses" class="PageHeading" align="left">
						<WTCODEGROUP>
							<WTCONDITION expr="_IsPinnacleTutorial"/>
							<WTSTATIC space="1"/>
							<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
								<WTLINK name="Tutorial" target="Tutorial">
									<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-TRAINING)"/>
									<WTPARAM name="contentpage" value="CONST(3)"/>
									<WTPARAM name="popup" value="CONST(1)"/>
								</WTLINK>
							</WTIMAGE>
						</WTCODEGROUP>
					</WTSTATIC>
          <WTSTATIC col="2" class="PageHeader" align="right">
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(Program)" oper="not-equal" value="CONST(0)"/>
              <WTBUTTON value="CONST(ProgramSummary)" btnclass="smbutton">
                <WTCLICK>ViewProgram()</WTCLICK>
              </WTBUTTON>
            </WTCODEGROUP>
          </WTSTATIC>
				</WTROW>
				
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
						<WTCOLUMN width="4" align="center" valign="top"/>
						<WTCOLUMN width="4" align="left" valign="top"/>
						<WTCOLUMN width="60" align="left" valign="top" label="CourseName"/>
						<WTCOLUMN width="10" align="left" valign="top"/>
						<WTCOLUMN width="13" align="center" valign="top" label="Grade"/>
						<WTCOLUMN width="9" align="right" valign="top"/>

						<WTROW>
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.IsInactive)" oper="equal" value="CONST(0)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(1)"/>
										<WTIMAGE value="CONST(lesson_status0.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(2)"/>
										<WTIMAGE value="CONST(lesson_status1.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
										<WTIMAGE value="CONST(lesson_status2.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(6)"/>
										<WTIMAGE value="CONST(lesson_status3.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(7)"/>
										<WTIMAGE value="CONST(lesson_status4.gif)" imgalign="middle"/>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.IsInactive)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(lesson_Inactive.gif)" imgalign="middle"/>
								</WTCODEGROUP>
							</WTSTATIC>

							<WTSTATIC col="3">
								<WTSTATIC value="DATA(Session.CourseName)" bold="true" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview24.gif)" alt="ViewSales" imgalign="absmiddle">
										<WTLINK name="1330">
											<WTPARAM name="SessionID" value="DATA(Session.SessionID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
											<WTPARAM name="Popup" value="PARAM(Popup)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTSTATIC space="2">
									<WTCODEGROUP>
										<WTCONDITION expr="IsEmployee"/>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="1303">
												<WTPARAM name="SessionID" value="DATA(SessionID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTSTATIC>

							<WTSTATIC col="4">
								<WTSTATIC label="Private" fontcolor="blue">
									<WTCONDITION expr="DATA(Session.OrgCourseID)" oper="greater" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>

							<WTSTATIC col="5">
								<!-- Check if we have a score -->
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.PassingGrade)" oper="greater" value="CONST(0)"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@grade&quot;/&gt;% (&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%))">
										<WTCONDITION expr="DATA(Session.Status)" oper="greater" value="CONST(5)"/>
									</WTSTATIC>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(homework.gif)" alt="ViewGradeBook">
											<WTLINK name="1321" target="blank">
												<WTPARAM name="SessionID" value="DATA(Session.SessionID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
							</WTSTATIC>

							<WTSTATIC col="6">
								<WTSTATIC value="DATA(Session.CourseLength)"/>
								<WTSTATIC value="CONST( min.)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" align="left">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" merge="4">
								<WTCODEGROUP>
									<WTSTATIC value="DATA(Session.StudentName)"/>
									<WTSTATIC value="CONST( - )"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC tag="Registered"/>
									<WTSTATIC value="DATA(Session.RegisterDate)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="greater" value="CONST(1)"/>
									<WTSTATIC tag="CONST(,)" space="2"/>
									<WTSTATIC tag="Started"/>
									<WTSTATIC value="DATA(Session.StartDate)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
									<WTSTATIC tag="CONST(,)" space="2"/>
									<WTSTATIC tag="Completed"/>
									<WTSTATIC value="DATA(Session.CompleteDate)"/>
								</WTCODEGROUP>
								<WTSTATIC fontcolor="purple">
									<WTCONDITION expr="CONST(not(contains)" value="CONST((@coursename, ':-')))"/>
									<WTSTATIC label="CONST(,)" space="2"/>
									<WTSTATIC tag="Time"/>
									<WTSTATIC value="DATA(Session.Time)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" value="CONST(LEGEND)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="400" align="left"/>
						<WTCOLUMN width="200" align="right"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(lesson_status0.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(not started)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(started)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(completed)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(failed)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(passed)" prespace="false"/>

							<WTIMAGE col="2" value="CONST(video.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(video)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(audio.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(audio)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(quiz.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(quiz)" prespace="false"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="24" margin-bottom="12">
					<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
					<WTBUTTON col="1" merge="2" align="center" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
<!--
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
-->
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1311" caption="My Classes" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98" track="0">
		<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Program" datatype="number"/>
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTDATATXN name="Programs"/>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotClasses" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTSUB name="LoadClasses">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(affiliateid)"/>
				</WTCODEGROUP>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="EnumProgram">
						<WTPARAM name="xmlPrograms" direction="return" datatype="text"/>
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ItemID" direction="input" value="PARAM(Program)"/>
						<WTPARAM name="Element" direction="input" value="CONST(&quot;PROGRAM&quot;)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Program)" oper="equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
							<WTMETHOD name="ListMemberAll">
								<WTCONDITION expr="IsEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="ListMember">
								<WTCONDITION expr="NotEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(5)"/>
								<WTMETHOD name="ListMemberAllStatus">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListMemberStatus">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(5)"/>
								<WTMETHOD name="ListMemberAllComplete">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListMemberComplete">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Program)" oper="not-equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
							<WTMETHOD name="ListOrgMemberAll">
								<WTCONDITION expr="IsEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTMETHOD name="ListOrgMember">
								<WTCONDITION expr="NotEmployee"/>
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(5)"/>
								<WTMETHOD name="ListOrgMemberAllStatus">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListOrgMemberStatus">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(5)"/>
								<WTMETHOD name="ListOrgMemberAllComplete">
									<WTCONDITION expr="IsEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
								<WTMETHOD name="ListOrgMemberComplete">
									<WTCONDITION expr="NotEmployee"/>
									<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
									<WTPARAM name="OrgID" direction="input" value="PARAM(Program)"/>
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCUSTOM>
						For Each oSession in oSessions
						With oSession
						secs = .Time
						seconds = secs Mod 60
						minutes = Int(secs / 60 ) Mod 60
						hours = Int(secs / 3600 )
						fmt = ""
						If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
						If minutes &lt; 10 Then fmt = fmt + "0"
						fmt = fmt &amp; minutes &amp; ":"
						If seconds &lt; 10 Then fmt = fmt + "0"
						.Time = fmt &amp; seconds &amp; "(" &amp; FormatNumber(.Times, 1 ) &amp; ")"
						End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="SYS(CompanyID)" connector="or"/>
						<WTRETURN>
							<WTLINK name="m_0101" return="false">
								<WTPARAM name="ActionCode" value="CONST(9)"/>
							</WTLINK>
						</WTRETURN>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadClasses"/>
			</WTACTION>

			<WTACTION name="Status" type="New" id="1">
				<WTSETATTRIBUTE name="PARAM(Status)" value="FORM(Status)"/>
				<WTCALLSUB name="LoadClasses"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="left"/>
				<WTCOLUMN width="75" align="right"/>

				<WTFUNCTION name="catalog()">
					var company = document.getElementById('CompanyID').value;
					var member = document.getElementById('MemberID').value;
					var URL="m_1212.asp?Mode=2&amp;CompanyID=" + company + "&amp;MemberID=" + member + "&amp;contentpage=3";
					window.open( URL);
				</WTFUNCTION>
				<WTFUNCTION name="ViewProgram()">
					var program = document.getElementById('Program').value;
					var member = document.getElementById('MemberID').value;
					var URL="m_1316.asp?ProgramID=" + program + "&amp;MemberID=" + member
					window.open( URL, "Program");
				</WTFUNCTION>

				<WTSTATIC label="ViewCatalog"/>
				<WTSTATIC label="ViewGradeBook"/>

				<WTROW>
					<WTHIDDEN name="MemberID" value="PARAM(MemberID)"/>
					<WTHIDDEN name="CompanyID" value="PARAM(CompanyID)"/>
					<WTHIDDEN name="contentpage" value="PARAM(ContentPage)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="83" align="left"/>
						<WTCOLUMN width="17" align="center"/>
						<WTROW>
							<WTSTATIC col="1" align="left" class="prompt">
								<WTSTATIC label="NoSessionsText">
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONS/PTSSESSION))" oper="equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="SessionsText">
									<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONS/PTSSESSION))" oper="greater" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="2" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="_IsCatalog"/>
									<WTIMAGE value="CONST(Book.gif)" alt="ViewCatalog" imgalign="absmiddle">
										<WTLINK name="m_1212" nodata="true">
											<WTPARAM name="Mode" value="CONST(2)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
										</WTLINK>
									</WTIMAGE>
									<WTSTATIC newline="1"/>
									<WTSTATIC label="CourseCatalog" bold="true"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" merge="2" label="View" bold="true" align="right"/>
					<WTCOMBO col="1" value="PARAM(Program)" datapath="/DATA/TXN/PTSPROGRAMS/ENUM" setselected="true">
						<WTCONDITION expr="CONST(count(/DATA/TXN/PTSPROGRAMS/ENUM))" oper="greater" value="CONST(1)"/>
						<WTCHANGE>doSubmit(1,"")</WTCHANGE>
					</WTCOMBO>
					<WTCOMBO col="1" value="PARAM(Status)">
						<WTCHANGE>doSubmit(1,"")</WTCHANGE>
						<WTOPTION id="0" label="ViewAll"/>
						<WTOPTION id="1" label="ViewRegistered"/>
						<WTOPTION id="2" label="ViewStarted"/>
						<WTOPTION id="5" label="ViewCompleted"/>
						<WTOPTION id="6" label="ViewFailed"/>
						<WTOPTION id="7" label="ViewPassed"/>
					</WTCOMBO>
					<WTBUTTON col="1" align="center" value="CONST(Close)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" label="RegisteredClasses" class="PageHeading" align="left" space="3"/>
					<WTBUTTON col="1" value="CONST(ProgramSummary)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Program)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>ViewProgram()</WTCLICK>
					</WTBUTTON>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
						<WTCOLUMN width="8" align="center" valign="top"/>
						<WTCOLUMN width="8" align="left" valign="top"/>
						<WTCOLUMN width="84" align="left" valign="top" label="CourseName"/>

						<WTROW>
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.IsInactive)" oper="equal" value="CONST(0)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(1)"/>
										<WTIMAGE value="CONST(lesson_status0.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(2)"/>
										<WTIMAGE value="CONST(lesson_status1.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
										<WTIMAGE value="CONST(lesson_status2.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(6)"/>
										<WTIMAGE value="CONST(lesson_status3.gif)" imgalign="middle"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(7)"/>
										<WTIMAGE value="CONST(lesson_status4.gif)" imgalign="middle"/>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.IsInactive)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(lesson_Inactive.gif)" imgalign="middle"/>
								</WTCODEGROUP>
							</WTSTATIC>

							<WTSTATIC col="3">
								<WTSTATIC value="DATA(Session.CourseName)" bold="true" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(preview24.gif)" alt="ViewSales" imgalign="absmiddle">
										<WTLINK name="m_1330">
											<WTPARAM name="SessionID" value="DATA(Session.SessionID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC value="CONST((#&lt;xsl:value-of select=&quot;@courseid&quot;/&gt;))"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.OrgCourseID)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="Private" fontcolor="blue"/>
								</WTCODEGROUP>
								<!-- Check if we have a score -->
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.PassingGrade)" oper="greater" value="CONST(0)"/>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@grade&quot;/&gt;% (&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%))">
										<WTCONDITION expr="DATA(Session.Status)" oper="greater" value="CONST(5)"/>
									</WTSTATIC>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(homework.gif)" alt="ViewGradeBook">
											<WTLINK name="m_1321" target="blank">
												<WTPARAM name="SessionID" value="DATA(Session.SessionID)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTCODEGROUP>
								<WTSTATIC space="1"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC value="DATA(Session.CourseLength)"/>
									<WTSTATIC value="CONST( min.)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" align="left">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTSTATIC value="DATA(Session.StudentName)" space="1"/>
									<WTSTATIC value="CONST(-)" space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC tag="Registered"/>
									<WTSTATIC value="DATA(Session.RegisterDate)" space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="greater" value="CONST(1)"/>
									<WTSTATIC value="CONST(-)" space="1"/>
									<WTSTATIC tag="Started"/>
									<WTSTATIC value="DATA(Session.StartDate)" space="1"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
									<WTSTATIC value="CONST(-)" space="1"/>
									<WTSTATIC tag="Completed"/>
									<WTSTATIC value="DATA(Session.CompleteDate)" space="1"/>
								</WTCODEGROUP>
								<WTSTATIC fontcolor="purple">
									<WTCONDITION expr="CONST(not(contains)" value="CONST((@coursename, ':-')))"/>
									<WTSTATIC value="CONST(-)" space="1"/>
									<WTSTATIC tag="Time"/>
									<WTSTATIC value="DATA(Session.Time)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" value="CONST(LEGEND)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTSTATIC col="1" merge="2" align="center">
						<WTCODEGROUP>
<!--							<WTIMAGE value="CONST(lesson_status0.gif)" imgalign="absmiddle"/>-->
<!--							<WTSTATIC value="CONST(not started)" space="1"/>-->
							<WTIMAGE value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(started)" space="1"/>
							<WTIMAGE value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(completed)" space="1"/>
							<WTIMAGE value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(failed)" space="1"/>
							<WTIMAGE value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(passed)" space="1"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTSTATIC col="1" merge="2" align="center">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(video.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(video)" space="1"/>
							<WTIMAGE value="CONST(audio.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(audio)" space="1"/>
							<WTIMAGE value="CONST(quiz.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(quiz)" space="1"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="24" margin-bottom="12">
					<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
					<WTBUTTON col="1" merge="2" align="center" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1312" caption="Students" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" secured="21">
		<!--===============================================================================-->
			<WTPARAM name="CourseID" datatype="text"/>  
			
			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ListCourse">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW>
					<WTSTATIC col="1" label="Courses" class="PageHeading"/>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Session">
						<WTCOLUMN width="35" align="left" valign="top" label="MemberName"/>
						<WTCOLUMN width="35" align="left" valign="top" label="StudentName"/>
						<WTCOLUMN width="30" align="left" valign="top" label="Status"/>

						<WTROW>
							<WTSTATIC col="1" value="DATA(Session.MemberName)">
								<WTLINK name="0403"><WTPARAM name="MemberID" value="DATA(Session.MemberID)"/></WTLINK>
							</WTSTATIC>

							<WTSTATIC col="1" value="DATA(Session.StudentName)">
								<WTLINK name="1305"><WTPARAM name="SessionID" value="DATA(Session.SessionID)"/></WTLINK>
							</WTSTATIC>

							<WTSTATIC col="1" value="DATA(Session.Status)">
								<WTLINK name="1305"><WTPARAM name="SessionID" value="DATA(Session.SessionID)"/></WTLINK>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				
				
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(Return)" align="center"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1313" caption="Course Ratings" navbar="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="CourseID" datatype="text"/>  
			<WTPARAM name="Option" datatype="number"/>  
			<WTPARAM name="Count" datatype="number"/>  
			
			<WTSUB name="LoadRatings">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ListRatings">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="Options" direction="input" value="PARAM(Option)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(1)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewAll" type="New" id="1">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(1)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewRatings" type="New" id="2">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(2)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewComments" type="New" id="3">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(3)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewLowRatings" type="New" id="4">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(4)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC value="ATTR(Course.CourseName)" space="1"/>
						<WTSTATIC value="CONST(-)" space="1"/>
						<WTSTATIC value="ATTR(Course.TrainerName)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6" margin-top="6">
					<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@rating&quot;/&gt;.gif)" align="center"/>
					<WTSTATIC col="1" space="2">
						<WTSTATIC value="ATTR(Course.RatingCnt)" space="1" bold="true"/>
						<WTSTATIC label="RatingCntText" space="2"/>
						<WTSTATIC value="CONST(-)" space="2"/>
						<WTSTATIC value="ATTR(Course.Classes)" space="1" bold="true"/>
						<WTSTATIC label="ClassesText"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Session">
						<WTCOLUMN width="11" align="left" valign="top" label="TotalRatingCaption"/>
						<WTCOLUMN width="11" align="center" valign="top" label="Rating1Caption"/>
						<WTCOLUMN width="11" align="center" valign="top" label="Rating2Caption"/>
						<WTCOLUMN width="11" align="center" valign="top" label="Rating3Caption"/>
						<WTCOLUMN width="11" align="center" valign="top" label="Rating4Caption"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Completed"/>
						<WTCOLUMN width="12" align="center" valign="top" label="Apply"/>
						<WTCOLUMN width="7" align="center" valign="top" label="Rcommend1Caption"/>
						<WTCOLUMN width="14" align="center" valign="top" label="Rcommend2Caption"/>
						<WTCOLUMN width="11" align="center" valign="top" label="Rcommend3Caption"/>

						<WTROW>
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@totalrating&quot;/&gt;.gif)"/>
							<WTIMAGE col="2" value="CONST(star&lt;xsl:value-of select=&quot;@rating1 * 2&quot;/&gt;.gif)"/>
							<WTIMAGE col="3" value="CONST(star&lt;xsl:value-of select=&quot;@rating2 * 2&quot;/&gt;.gif)"/>
							<WTIMAGE col="4" value="CONST(star&lt;xsl:value-of select=&quot;@rating3 * 2&quot;/&gt;.gif)"/>
							<WTIMAGE col="5" value="CONST(star&lt;xsl:value-of select=&quot;@rating4 * 2&quot;/&gt;.gif)"/>
							<WTSTATIC col="6" value="DATA(Session.CompleteDate)"/>
							<WTSTATIC col="7">
								<WTSTATIC label="Apply1Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="Apply2Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Apply3Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Apply4Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="8">
								<WTSTATIC label="Yes">
									<WTCONDITION expr="DATA(Session.Recommend1)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="9">
								<WTSTATIC label="Yes">
									<WTCONDITION expr="DATA(Session.Recommend2)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="10">
								<WTSTATIC label="Yes">
									<WTCONDITION expr="DATA(Session.Recommend3)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="10" align="left" fontcolor="gray">
								<WTSTATIC value="DATA(Session.Feedback)"/>
								<WTSTATIC>
									<WTCONDITION expr="IsEmployee"/>
									<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
									<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
									<WTSTATIC value="CONST(()"/>
									<WTSTATIC value="DATA(Session.StudentName)"/>
									<WTSTATIC value="CONST())"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Count)" oper="greater" value="CONST(0)"/>
					<WTSTATIC col="1" align="left">
						<WTSTATIC value="PARAM(Count)" space="1"/>
						<WTSTATIC label="Classes"/>
					</WTSTATIC>
				</WTROW>
				
				<WTROW margin-top="6">
					<WTBUTTON col="1" action="1" value="CONST(ViewAllEvals)" align="center"/>
					<WTBUTTON col="1" action="2" value="CONST(ViewRatings)" align="center"/>
					<WTBUTTON col="1" action="3" value="CONST(ViewComments)" align="center"/>
					<WTBUTTON col="1" action="4" value="CONST(ViewLowRatings)" align="center">
						<WTCONDITION expr="IsEmployee"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_1313" caption="Course Ratings" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
		<!--===============================================================================-->
			<WTPARAM name="CourseID" datatype="text"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTSUB name="LoadRatings">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ListRatings">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="Options" direction="input" value="PARAM(Option)"/>
					</WTMETHOD>
					<WTMETHOD name="Count">
						<WTPARAM name="reqCount" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(1)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewAll" type="New" id="1">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(1)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewRatings" type="New" id="2">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(2)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewComments" type="New" id="3">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(3)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<WTACTION name="ViewLowRatings" type="New" id="4">
				<WTSETATTRIBUTE name="PARAM(Option)" value="CONST(4)"/>
				<WTCALLSUB name="LoadRatings"/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW>
					<WTSTATIC col="1" value="ATTR(Course.CourseName)" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6" margin-top="2">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@rating&quot;/&gt;.gif)" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center">
						<WTSTATIC value="ATTR(Course.RatingCnt)" space="1" bold="true"/>
						<WTSTATIC label="RatingCntText"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" align="center">
						<WTSTATIC value="ATTR(Course.Classes)" space="1" bold="true"/>
						<WTSTATIC label="ClassesText"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" graybar="true" entity="Session">
						<WTCOLUMN width="25" align="center" valign="top" label="Rating1Caption"/>
						<WTCOLUMN width="25" align="center" valign="top" label="Rating2Caption"/>
						<WTCOLUMN width="25" align="center" valign="top" label="Rating3Caption"/>
						<WTCOLUMN width="25" align="center" valign="top" label="Rating4Caption"/>

						<WTROW>
							<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;@rating1 * 2&quot;/&gt;.gif)"/>
							<WTIMAGE col="2" value="CONST(star&lt;xsl:value-of select=&quot;@rating2 * 2&quot;/&gt;.gif)"/>
							<WTIMAGE col="3" value="CONST(star&lt;xsl:value-of select=&quot;@rating3 * 2&quot;/&gt;.gif)"/>
							<WTIMAGE col="4" value="CONST(star&lt;xsl:value-of select=&quot;@rating4 * 2&quot;/&gt;.gif)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="4" align="left">
								<WTSTATIC space="2"/>
								<WTCODEGROUP><WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;@totalrating&quot;/&gt;.gif)"/></WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTSTATIC tag="Completed"/>
								<WTSTATIC value="DATA(Session.CompleteDate)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Apply"/>
								<WTSTATIC label="Apply1Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(1)"/>
								</WTSTATIC>
								<WTSTATIC label="Apply2Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(2)"/>
								</WTSTATIC>
								<WTSTATIC label="Apply3Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(3)"/>
								</WTSTATIC>
								<WTSTATIC label="Apply4Text">
									<WTCONDITION expr="DATA(Session.Apply)" oper="equal" value="CONST(4)"/>
								</WTSTATIC>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="RecommendTo"/>
								<WTSTATIC label="Rcommend1Caption" space="1">
									<WTCONDITION expr="DATA(Session.Recommend1)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="Rcommend2Caption" space="1">
									<WTCONDITION expr="DATA(Session.Recommend2)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
								<WTSTATIC label="Rcommend3Caption" space="1">
									<WTCONDITION expr="DATA(Session.Recommend3)" oper="not-equal" value="CONST(0)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTCONDITION expr="DATA(Feedback)" oper="not-equal" value="CONST('')"/>
							<WTSTATIC col="1" merge="10" align="left" fontcolor="gray">
								<WTSTATIC value="DATA(Feedback)"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(Count)" oper="greater" value="CONST(0)"/>
					<WTSTATIC col="1" align="left">
						<WTSTATIC value="PARAM(Count)" space="1"/>
						<WTSTATIC label="Classes"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="6">
					<WTBUTTON col="1" action="1" value="CONST(ViewAllEvals)" align="center"/>
					<WTBUTTON col="1" action="2" value="CONST(ViewRatings)" align="center"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="12">
					<WTBUTTON col="1" action="3" value="CONST(ViewComments)" align="center"/>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="1314" caption="Classes" focus="false" navbar="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>  
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="M" datatype="number"/>

			<WTSUB name="LoadClasses">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(0)"/>
						<WTMETHOD name="ListMember">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(0)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="not-equal" value="CONST(5)"/>
							<WTMETHOD name="ListMemberStatus">
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="Status" direction="input" value="PARAM(Status)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(5)"/>
							<WTMETHOD name="ListMemberComplete">
								<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTCODEGROUP>
					</WTCODEGROUP>
<WTCUSTOM>
				For Each oSession in oSessions
				   With oSession
						secs = .Time
						seconds = secs Mod 60 
						minutes = Int(secs / 60 ) Mod 60
						hours = Int(secs / 3600 )
						fmt = ""
						If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
						If minutes &lt; 10 Then fmt = fmt + "0"
						fmt = fmt &amp; minutes &amp; ":"
						If seconds &lt; 10 Then fmt = fmt + "0"
						.Time = fmt &amp; seconds &amp; "(" &amp; FormatNumber(.Times, 1 ) &amp; ")"
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/> 
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<!-- SAVE MEMBERID BEING MENTORED -->
				<WTSETCACHE name="MentoringID" value="PARAM(MemberID)">
					<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
				</WTSETCACHE>
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTGETCACHE name="CONST(tmpMentoringID)" value="MentoringID"/>
				<WTSETATTRIBUTE name="CONST(tmpMentoringID)" value="CONST(-1)">
					<WTCONDITION expr="CONST(tmpMentoringID)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(CLng(tmpMentoringID))" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadClasses"/>
			</WTACTION>

			<WTACTION name="Status" type="New" id="1">
				<WTSETATTRIBUTE name="PARAM(Status)" value="FORM(Status)"/>
				<WTCALLSUB name="LoadClasses"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="600" align="right"/>

				<WTROW>
					<WTHIDDEN name="MemberID" value="PARAM(MemberID)"/>
					<WTHIDDEN name="CompanyID" value="ATTR(Member.CompanyID)"/>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTIMAGE col="1" value="CONST(class.gif)" align="center"/>
					<WTSTATIC col="2" align="center" valign="center" class="PageHeading">
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(M)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC tag="Mentoring" fontcolor="red"/>
						</WTCODEGROUP>
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="1"/>
						<WTSTATIC label="Classes" newline="1"/>
					</WTSTATIC>
					<WTBUTTON col="2" value="CONST(ViewCourseCatalog)" align="center">
						<WTCONDITION expr="_IsCatalog"/>
						<WTCONDITION expr="IsEmployee" connector="or"/>
						<WTCLICK>
							var URL="1212.asp?Popup=1&amp;contentpage=3&amp;Mode=2&amp;CompanyID=" + document.getElementById('CompanyID').value +  "&amp;MemberID=" + document.getElementById('MemberID').value;  
							window.open( URL);
						</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" label="RegisteredClasses" class="PageHeading" align="left"/>
					<WTSTATIC col="2" label="ViewStatus" class="PageHeading" align="right"/>
					<WTCOMBO col="2" value="PARAM(Status)">
						<WTCHANGE>doSubmit(1,"")</WTCHANGE>
						<WTOPTION id="0" label="ViewAll"/>
						<WTOPTION id="1" label="ViewRegistered"/>
						<WTOPTION id="2" label="ViewStarted"/>
						<WTOPTION id="5" label="ViewCompleted"/>
						<WTOPTION id="6" label="ViewFailed"/>
						<WTOPTION id="7" label="ViewPassed"/>
					</WTCOMBO>
				</WTROW>
				
				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
						<WTCOLUMN width="4" align="center" valign="top"/>
						<WTCOLUMN width="4" align="left" valign="top"/>
						<WTCOLUMN width="60" align="left" valign="top" label="RegisteredClassesCaption"/>
						<WTCOLUMN width="10" align="left" valign="top"/>
						<WTCOLUMN width="13" align="center" valign="top" label="Grade"/>
						<WTCOLUMN width="9" align="right" valign="top"/>

						<WTROW>
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.IsInactive)" oper="equal" value="CONST(0)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(1)"/>
									<WTIMAGE col="2" value="CONST(lesson_status0.gif)" imgalign="middle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(2)"/>
									<WTIMAGE col="2" value="CONST(lesson_status1.gif)" imgalign="middle"/>
								</WTCODEGROUP>
								<WTCODEGROUP> <!-- Dropped -->
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(3)"/>
									<WTSTATIC col="2"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
									<WTIMAGE col="2" value="CONST(lesson_status2.gif)" imgalign="middle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(6)"/>
									<WTIMAGE col="2" value="CONST(lesson_status3.gif)" imgalign="middle"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(7)"/>
									<WTIMAGE col="2" value="CONST(lesson_status4.gif)" imgalign="middle"/>
								</WTCODEGROUP>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.IsInactive)" oper="not-equal" value="CONST(0)"/>
								<WTIMAGE col="2" value="CONST(lesson_Inactive.gif)" imgalign="middle"/>
							</WTCODEGROUP>

							<WTSTATIC col="3" bold="true">
								<WTSTATIC value="DATA(Session.CourseName)">
									<WTLINK name="1315" target="Lessons">
										<WTPARAM name="SessionID" value="DATA(Session.SessionID)"/>
										<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
									</WTLINK>
								</WTSTATIC>
							</WTSTATIC>

							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.OrgCourseID)" oper="greater" value="CONST(0)"/>
								<WTSTATIC col="4" label="Private" fontcolor="blue"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.OrgCourseID)" oper="equal" value="CONST(0)"/>
								<WTSTATIC col="4"/>
							</WTCODEGROUP>

							 <!-- Check if we have a score -->
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.PassingGrade)" oper="equal" value="CONST(0)"/>
								<WTSTATIC col="5" label="NA"/>
							</WTCODEGROUP>

							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.PassingGrade)" oper="greater" value="CONST(0)"/>
								<WTSTATIC col="5">
									<WTSTATIC>
										<WTCONDITION expr="DATA(Session.Status)" oper="less" value="CONST(6)"/>
									</WTSTATIC>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@grade&quot;/&gt;% (&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%))">
										<WTCONDITION expr="DATA(Session.Status)" oper="greater" value="CONST(5)"/>
									</WTSTATIC>
								</WTSTATIC>
							</WTCODEGROUP>

							<WTSTATIC col="6">
								<WTSTATIC value="DATA(Session.CourseLength)"/>
								<WTSTATIC value="CONST( min.)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2" align="left">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Video)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Audio)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Quiz)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3" merge="4">
								<WTCODEGROUP>
									<WTSTATIC value="DATA(Session.StudentName)"/>
									<WTSTATIC value="CONST( - )"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTSTATIC tag="Registered"/>
									<WTSTATIC value="DATA(Session.RegisterDate)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="greater" value="CONST(1)"/>
									<WTSTATIC tag="CONST(,)" space="2"/>
									<WTSTATIC tag="Started"/>
									<WTSTATIC value="DATA(Session.StartDate)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
									<WTSTATIC tag="CONST(,)" space="2"/>
									<WTSTATIC tag="Completed"/>
									<WTSTATIC value="DATA(Session.CompleteDate)"/>
								</WTCODEGROUP>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC label="CONST(,)" space="2"/>
									<WTSTATIC tag="Time"/>
									<WTSTATIC value="DATA(Session.Time)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12">
					<WTSTATIC col="1" merge="2" value="CONST(LEGEND)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="400" align="left"/>
						<WTCOLUMN width="200" align="right"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(lesson_status0.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(not started)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(started)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(completed)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(failed)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(passed)" prespace="false"/>

							<WTIMAGE col="2" value="CONST(video.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(video)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(audio.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(audio)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(quiz.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(quiz)" prespace="false"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="1315" caption="Lessons" navbar="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/> <!--internal-->

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CourseID)" value="ATTR(CourseID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SessionLessons" project="ptsSessionLessonUser" class="CSessionLessons">
					<WTMETHOD name="ListSession">
						<WTPARAM name="LessonID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="Lessons" direction="input" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
				For Each oSessionLesson in oSessionLessons
				   With oSessionLesson
						secs = .Time
						seconds = secs Mod 60 
						minutes = Int((secs / 60) Mod 60)
						hours = Int(secs / 3600 )
						fmt = ""
						If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
						If minutes &lt; 10 Then fmt = fmt + "0"
						fmt = fmt &amp; minutes &amp; ":"
						If seconds &lt; 10 Then fmt = fmt + "0"
						.Time = fmt &amp; seconds &amp; "(" &amp; .Times &amp; ")"
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessionLessons" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(Course.CourseName)" class="PageHeading" align="left"/>
					<WTIMAGE col="1" merge="2" value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@totalrating&quot;/&gt;.gif)">
						<WTCONDITION expr="ATTR(Session.TotalRating)" oper="not-equal" value="CONST(0)"/>
					</WTIMAGE>
					<WTSTATIC col="1" merge="2" prespace="false">
						<WTSTATIC>
							<WTCONDITION expr="IsEmployee"/>
							<WTSTATIC value="CONST(()"/>
							<WTSTATIC  label="Ratings">
								<WTLINK name="1313" target="Ratings">
									<WTPARAM name="CourseID" value="ATTR(Course.CourseID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC value="CONST())"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" value="ATTR(Course.TrainerName)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(Session.StudentName)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTRECORDSET col="1" merge="2" graybar="true" entity="SessionLesson">
						<WTCOLUMN width="4" align="center"/>
						<WTCOLUMN width="4" align="left"/>
						<WTCOLUMN width="57" align="left" label="ClassLessons"/>
						<WTCOLUMN width="13" align="center" label="Grade"/>
						<WTCOLUMN width="6" align="center" label="Final"/>
						<WTCOLUMN width="9" align="right"/>
						<WTCOLUMN width="7" align="right"/>
						<WTROW>
							<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)"/>
							<WTIMAGE col="2" value="CONST(lesson_status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" valign="top"/>
							<WTSTATIC col="3">
								<WTSTATIC value="DATA(SessionLesson.LessonName)" bold="true"/>
								<WTSTATIC fontcolor="purple">
									<WTSTATIC label="CONST(,)" space="2"/>
									<WTSTATIC tag="Time"/>
									<WTSTATIC value="DATA(SessionLesson.Time)"/>
								</WTSTATIC>
							</WTSTATIC>
							<WTSTATIC col="4">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
									<WTCONDITION expr="DATA(SessionLesson.Status)" oper="greater" value="CONST(2)" connector="and"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizscore&quot;/&gt;% (&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%))"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="5">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizweight&quot;/&gt;%)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="6">
								<WTSTATIC value="DATA(SessionLesson.LessonLength)"/>
								<WTSTATIC value="CONST( min.)"/>
							</WTSTATIC>
							<WTSTATIC col="7">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(SessionLesson.MediaType)" oper="equal" value="CONST(1)"/>
									<WTIMAGE value="CONST(video.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(SessionLesson.MediaType)" oper="equal" value="CONST(2)"/>
									<WTIMAGE value="CONST(audio.gif)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
									<WTIMAGE value="CONST(quiz.gif)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" merge="2"/>
							<WTSTATIC col="3" merge="5" value="DATA(SessionLesson.Description)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" value="CONST(LEGEND)" bold="true"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="400" align="left"/>
						<WTCOLUMN width="200" align="right"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(lesson_status0.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(not started)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(started)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(completed)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(failed)" prespace="false"/>
							<WTIMAGE col="1" value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="1" value="CONST(passed)" prespace="false"/>

							<WTIMAGE col="2" value="CONST(video.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(video)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(audio.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(audio)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(quiz.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(quiz)" prespace="false"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="1316" caption="Program Summary" navbar="false" footer="false" header="false"
			   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--=============================================================================================-->
			<WTPARAM name="ProgramID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ProgramCredits" datatype="currency"/>
			<WTPARAM name="ProgramReqCredits" datatype="currency"/>
			<WTPARAM name="TotalCredits" datatype="currency"/>
			<WTPARAM name="TotalReqCredits" datatype="currency"/>
			<WTPARAM name="MissingCredits" datatype="currency"/>
			<WTPARAM name="MissingReqCredits" datatype="currency"/>
			<WTPARAM name="Certificate" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(ProgramID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ProgramCredits)" value="ATTR(Credits)"/>
					<WTSETATTRIBUTE name="CONST(tmpNoCertificate)" value="ATTR(NoCertificate)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ProgramSummary">
						<WTPARAM name="OrgID" direction="input" value="PARAM(ProgramID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
<WTCUSTOM>
				For Each oItem in oSessions
					With oItem
						credits = CLng(.Credit)
						'accumulate the program required credits
						If .OCStatus = 2 Then reqProgramReqCredits = reqProgramReqCredits + credits
						'if the member has passed the course
						If .Status = 7 Then
							'accumulate the member's total credits
							reqTotalCredits = reqTotalCredits + credits
							'if this is a required course, accumulate the members completed required credits 
							If .OCStatus = 2 Then reqTotalReqCredits = reqTotalReqCredits + credits
						End If
				    End With
				Next
				reqMissingReqCredits = reqProgramReqCredits - reqTotalReqCredits
				If reqMissingReqCredits &lt; 0 Then reqMissingReqCredits = 0
				reqMissingCredits = reqProgramCredits - reqTotalCredits
				If reqMissingCredits &lt; 0 Then reqMissingCredits = 0
				If reqMissingReqCredits &gt; 0 And reqMissingCredits &lt; reqMissingReqCredits Then reqMissingCredits = reqMissingReqCredits
				
				reqProgramCredits = FormatNumber( reqProgramCredits, 2 )
				reqProgramReqCredits = FormatNumber( reqProgramReqCredits, 2 )
				reqTotalCredits = FormatNumber( reqTotalCredits, 2 )
				reqTotalReqCredits = FormatNumber( reqTotalReqCredits, 2 )
				reqMissingCredits = FormatNumber( reqMissingCredits, 2 )
				reqMissingReqCredits = FormatNumber( reqMissingReqCredits, 2 )
</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MissingCredits)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Certificate)" value="CONST(1)">
								<WTCONDITION expr="CONST(tmpNoCertificate)" oper="equal" value="CONST(0)"/>
								<WTCONDITION expr="IsEmployee" connector="or"/>
								<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
								<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
							</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="center"/>
				<WTCOLUMN width="420" align="left"/>
				<WTCOLUMN width="90" align="center"/>
				<WTCOLUMN width="90" align="center"/>
				<WTCOLUMN width="50" align="center"/>
				<WTCOLUMN width="50" align="center"/>

				<WTFUNCTION name="PrintCertificate()">
					var url, win, custom;
					custom = document.getElementById('IsCustomCertificate').value;
					if( custom == 0 ) { url = '2839' } else  { url = '2838' }
					url = url + ".asp?orgid=" + document.getElementById('ProgramID').value + "&amp;memberid=" + document.getElementById('MemberID').value;
		            win = window.open(url,"Certificate");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(ProgramID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="ATTR(Org.IsCustomCertificate)"/>
				</WTROW>

				<WTSTATIC label="Required"/>
				<WTSTATIC label="LessonStatus0"/>
				<WTSTATIC label="LessonStatus1"/>
				<WTSTATIC label="LessonStatus2"/>
				<WTSTATIC label="LessonStatus3"/>
				<WTSTATIC label="LessonStatus4"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="6" value="ATTR(Org.OrgName)" align="center" class="PageHeading"/>
					<WTBUTTON col="1" merge="6" value="CONST(PrintCertificate)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Certificate)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>PrintCertificate()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="6" value="ATTR(Org.Description)" align="left" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="6">
						<WTCOLUMN width="200" align="left"/>
						<WTCOLUMN width="300" align="left"/>
						<WTCOLUMN width="50" align="center"/>
						<WTCOLUMN width="200" align="left"/>

						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="ProgramCredits"/>
							<WTSTATIC col="3" value="PARAM(ProgramCredits)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="ProgramReqCredits"/>
							<WTSTATIC col="3" value="PARAM(ProgramReqCredits)"/>
						</WTROW>
						<WTROW margin-top="2" margin-bottom="2">
							<WTSTATIC col="1"/>
							<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="TotalCredits"/>
							<WTSTATIC col="3" value="PARAM(TotalCredits)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="TotalReqCredits"/>
							<WTSTATIC col="3" value="PARAM(TotalReqCredits)"/>
						</WTROW>
						<WTROW margin-top="2" margin-bottom="2">
							<WTSTATIC col="1"/>
							<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="MissingCredits"/>
							<WTSTATIC col="3" value="PARAM(MissingCredits)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="MissingReqCredits"/>
							<WTSTATIC col="3" value="PARAM(MissingReqCredits)"/>
						</WTROW>
						<WTROW margin-top="2" margin-bottom="12">
							<WTSTATIC col="1"/>
							<WTDIVIDER col="2" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="6" label="RegisteredCourses" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="CourseName" bold="true"/>
					<WTSTATIC col="3" label="StartDate" bold="true"/>
					<WTSTATIC col="4" label="CompleteDate" bold="true"/>
					<WTSTATIC col="5" label="Grade" bold="true"/>
					<WTSTATIC col="6" label="Credits" bold="true"/>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTREPEAT entity="Session">
					<WTFILTER name="DATA(CourseID)" oper="not-equal" value="CONST(0)"/>	<!-- SessionID -->
					<WTROW graybar="true">
						<WTSTATIC col="1">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(1)"/>
								<WTIMAGE value="CONST(lesson_status0.gif)" alt="LessonStatus0" imgalign="middle"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(2)"/>
								<WTIMAGE value="CONST(lesson_status1.gif)" alt="LessonStatus1" imgalign="middle"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
								<WTIMAGE value="CONST(lesson_status2.gif)" alt="LessonStatus2" imgalign="middle"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(6)"/>
								<WTIMAGE value="CONST(lesson_status3.gif)" alt="LessonStatus3" imgalign="middle"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(7)"/>
								<WTIMAGE value="CONST(lesson_status4.gif)" alt="LessonStatus4" imgalign="middle"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="2">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(OCStatus)" oper="equal" value="CONST(2)"/>
								<WTIMAGE value="CONST(CheckGreen.gif)" alt="Required" align="left" valign="center" imgalign="absmiddle"/>
								<WTSTATIC space="1"/>
							</WTCODEGROUP>
							<WTSTATIC value="DATA(CourseName)"/>
							<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@sessionid&quot;/&gt;))" fontcolor="purple"/>
						</WTSTATIC>
						<WTSTATIC col="3" value="DATA(StartDate)"/>
						<WTSTATIC col="4" value="DATA(CompleteDate)"/>
						<WTSTATIC col="5">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(6)"/>
								<WTSTATIC value="DATA(Grade)" fontcolor="red"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(7)"/>
								<WTSTATIC value="DATA(Grade)"/>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="6">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(7)"/>
								<WTSTATIC value="DATA(Credit)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(7)"/>
								<WTSTATIC value="DATA(Credit)" fontcolor="gray"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
				</WTREPEAT>
				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="6">
					<WTSTATIC col="1" merge="6" label="UnregisteredCourses" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" label="CourseName" bold="true"/>
					<WTSTATIC col="3"/>
					<WTSTATIC col="4"/>
					<WTSTATIC col="5"/>
					<WTSTATIC col="6" label="Credits" bold="true"/>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTREPEAT entity="Session">
					<WTFILTER name="DATA(CourseID)" oper="equal" value="CONST(0)"/>	<!-- SessionID -->
					<WTROW graybar="true">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(OCStatus)" oper="equal" value="CONST(2)"/>
								<WTIMAGE value="CONST(CheckGreen.gif)" alt="Required" align="left" valign="center" imgalign="absmiddle"/>
								<WTSTATIC space="1"/>
							</WTCODEGROUP>
							<WTSTATIC value="DATA(CourseName)"/>
							<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@sessionid&quot;/&gt;))" fontcolor="purple"/>
						</WTSTATIC>
						<WTSTATIC col="3"/>
						<WTSTATIC col="4"/>
						<WTSTATIC col="5"/>
						<WTSTATIC col="6" value="DATA(Credit)"/>
					</WTROW>
				</WTREPEAT>

				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" merge="6" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="6" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_1316" caption="Program Summary" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--=============================================================================================-->
			<WTPARAM name="ProgramID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="ProgramCredits" datatype="currency"/>
			<WTPARAM name="ProgramReqCredits" datatype="currency"/>
			<WTPARAM name="TotalCredits" datatype="currency"/>
			<WTPARAM name="TotalReqCredits" datatype="currency"/>
			<WTPARAM name="MissingCredits" datatype="currency"/>
			<WTPARAM name="MissingReqCredits" datatype="currency"/>
			<WTPARAM name="Certificate" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(ProgramID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ProgramCredits)" value="ATTR(Credits)"/>
					<WTSETATTRIBUTE name="CONST(tmpNoCertificate)" value="ATTR(NoCertificate)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ProgramSummary">
						<WTPARAM name="OrgID" direction="input" value="PARAM(ProgramID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						For Each oItem in oSessions
						With oItem
						credits = CLng(.Credit)
						'accumulate the program required credits
						If .OCStatus = 2 Then reqProgramReqCredits = reqProgramReqCredits + credits
						'if the member has passed the course
						If .Status = 7 Then
						'accumulate the member's total credits
						reqTotalCredits = reqTotalCredits + credits
						'if this is a required course, accumulate the members completed required credits
						If .OCStatus = 2 Then reqTotalReqCredits = reqTotalReqCredits + credits
						End If
						End With
						Next
						reqMissingReqCredits = reqProgramReqCredits - reqTotalReqCredits
						If reqMissingReqCredits &lt; 0 Then reqMissingReqCredits = 0
						reqMissingCredits = reqProgramCredits - reqTotalCredits
						If reqMissingCredits &lt; 0 Then reqMissingCredits = 0
						If reqMissingReqCredits &gt; 0 And reqMissingCredits &lt; reqMissingReqCredits Then reqMissingCredits = reqMissingReqCredits

						reqProgramCredits = FormatNumber( reqProgramCredits, 2 )
						reqProgramReqCredits = FormatNumber( reqProgramReqCredits, 2 )
						reqTotalCredits = FormatNumber( reqTotalCredits, 2 )
						reqTotalReqCredits = FormatNumber( reqTotalReqCredits, 2 )
						reqMissingCredits = FormatNumber( reqMissingCredits, 2 )
						reqMissingReqCredits = FormatNumber( reqMissingReqCredits, 2 )
					</WTCUSTOM>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MissingCredits)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="PARAM(Certificate)" value="CONST(1)">
							<WTCONDITION expr="CONST(tmpNoCertificate)" oper="equal" value="CONST(0)"/>
							<WTCONDITION expr="IsEmployee" connector="or"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="8" align="center"/>
				<WTCOLUMN width="92" align="left"/>

				<WTFUNCTION name="PrintCertificate()">
					var url, win, custom;
					custom = document.getElementById('IsCustomCertificate').value;
					if( custom == 0 ) { url = '2839' } else  { url = '2838' }
					url = url + ".asp?orgid=" + document.getElementById('ProgramID').value + "&amp;memberid=" + document.getElementById('MemberID').value;
					win = window.open(url,"Certificate");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(ProgramID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
					<WTHIDDEN value="ATTR(Org.IsCustomCertificate)"/>
				</WTROW>

				<WTSTATIC label="Required"/>
				<WTSTATIC label="LessonStatus0"/>
				<WTSTATIC label="LessonStatus1"/>
				<WTSTATIC label="LessonStatus2"/>
				<WTSTATIC label="LessonStatus3"/>
				<WTSTATIC label="LessonStatus4"/>

				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" value="ATTR(Org.OrgName)" align="center" class="PageHeading"/>
<!--
					<WTBUTTON col="1" merge="2" value="CONST(PrintCertificate)" btnclass="smbutton">
						<WTCONDITION expr="PARAM(Certificate)" oper="not-equal" value="CONST(0)"/>
						<WTCLICK>PrintCertificate()</WTCLICK>
					</WTBUTTON>
-->					
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" merge="2" value="ATTR(Org.Description)" align="left" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="83" align="left"/>
						<WTCOLUMN width="17" align="center"/>

						<WTROW>
							<WTSTATIC col="1" label="ProgramCredits"/>
							<WTSTATIC col="2" value="PARAM(ProgramCredits)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="ProgramReqCredits"/>
							<WTSTATIC col="2" value="PARAM(ProgramReqCredits)"/>
						</WTROW>
						<WTROW margin-top="2" margin-bottom="2">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="TotalCredits"/>
							<WTSTATIC col="2" value="PARAM(TotalCredits)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="TotalReqCredits"/>
							<WTSTATIC col="2" value="PARAM(TotalReqCredits)"/>
						</WTROW>
						<WTROW margin-top="2" margin-bottom="2">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="MissingCredits"/>
							<WTSTATIC col="2" value="PARAM(MissingCredits)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" label="MissingReqCredits"/>
							<WTSTATIC col="2" value="PARAM(MissingReqCredits)"/>
						</WTROW>
						<WTROW margin-top="2" margin-bottom="12">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="RegisteredCourses" class="PageHeading" align="left"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="CourseName" bold="true" align="left"/>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTREPEAT entity="Session">
					<WTFILTER name="DATA(CourseID)" oper="not-equal" value="CONST(0)"/>
					<!-- SessionID -->
					<WTROW graybar="true">
						<WTSTATIC col="1">
							<WTCODEGROUP>
								<WTIMAGE value="CONST(lesson_status0.gif)" alt="LessonStatus0" imgalign="middle">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(1)"/>
								</WTIMAGE>
								<WTIMAGE value="CONST(lesson_status1.gif)" alt="LessonStatus1" imgalign="middle">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(2)"/>
								</WTIMAGE>
								<WTIMAGE value="CONST(lesson_status2.gif)" alt="LessonStatus2" imgalign="middle">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
								</WTIMAGE>
								<WTIMAGE value="CONST(lesson_status3.gif)" alt="LessonStatus3" imgalign="middle">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(6)"/>
								</WTIMAGE>
								<WTIMAGE value="CONST(lesson_status4.gif)" alt="LessonStatus4" imgalign="middle">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(7)"/>
								</WTIMAGE>
							</WTCODEGROUP>
						</WTSTATIC>
						<WTSTATIC col="2">
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(OCStatus)" oper="equal" value="CONST(2)"/>
								<WTIMAGE value="CONST(CheckGreen.gif)" alt="Required" align="left" valign="center" imgalign="absmiddle"/>
								<WTSTATIC space="1"/>
							</WTCODEGROUP>
							<WTSTATIC value="DATA(CourseName)"/>
							<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@sessionid&quot;/&gt;))" fontcolor="purple" space="1"/>
							<WTSTATIC value="DATA(StartDate)"/>
							<WTSTATIC value="CONST(-)"/>
							<WTSTATIC value="DATA(CompleteDate)" space="1"/>
							<WTSTATIC fontcolor="blue">
								<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(6)"/>
								<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(7)" connector="or"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Grade"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(6)"/>
									<WTSTATIC value="CONST(-)"/>
									<WTSTATIC value="DATA(Grade)" fontcolor="red"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(7)"/>
									<WTSTATIC value="CONST(-)"/>
									<WTSTATIC value="DATA(Grade)"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC value="CONST(-)"/>
							<WTSTATIC fontcolor="purple">
								<WTSTATIC tag="Credits"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(7)"/>
									<WTSTATIC value="CONST(-)"/>
									<WTSTATIC value="DATA(Credit)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(7)"/>
									<WTSTATIC value="CONST(-)"/>
									<WTSTATIC value="DATA(Credit)" fontcolor="gray"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTSTATIC>
					</WTROW>
				</WTREPEAT>
				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="6">
					<WTSTATIC col="1" merge="2" label="UnregisteredCourses" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW>
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="83" align="left"/>
						<WTCOLUMN width="17" align="center"/>

						<WTROW>
							<WTSTATIC col="1" label="CourseName" bold="true"/>
							<WTSTATIC col="2" label="Credits" bold="true"/>
						</WTROW>
						<WTROW margin-top="2" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTREPEAT entity="Session">
							<WTFILTER name="DATA(CourseID)" oper="equal" value="CONST(0)"/>
							<!-- SessionID -->
							<WTROW graybar="true">
								<WTSTATIC col="1">
									<WTCODEGROUP>
										<WTCONDITION expr="DATA(OCStatus)" oper="equal" value="CONST(2)"/>
										<WTIMAGE value="CONST(CheckGreen.gif)" alt="Required" align="left" valign="center" imgalign="absmiddle"/>
										<WTSTATIC space="1"/>
									</WTCODEGROUP>
									<WTSTATIC value="DATA(CourseName)"/>
									<WTSTATIC value="CONST( (#&lt;xsl:value-of select=&quot;@sessionid&quot;/&gt;))" fontcolor="purple"/>
								</WTSTATIC>
								<WTSTATIC col="2" value="DATA(Credit)"/>
							</WTROW>
						</WTREPEAT>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="1321" caption="Grade Book" navbar="false" footer="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false">
		<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/>       <!--internal-->
			<WTPARAM name="MemberID" datatype="number"/>       <!--internal-->
			<WTPARAM name="AssessmentID" datatype="number"/>   <!--internal-->
			<WTPARAM name="MemberAssessID" datatype="number"/> <!--internal-->

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CourseID)" value="ATTR(CourseID)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(AssessmentID)" value="ATTR(ExamID)"/>
					<WTSETATTRIBUTE name="CONST(tmpExamWeight)" value="ATTR(ExamWeight)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SessionLessons" project="ptsSessionLessonUser" class="CSessionLessons">
					<WTMETHOD name="ListQuiz">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
					</WTMETHOD>
<WTCUSTOM>
				For Each oItem in oSessionLessons
				   With oItem
						qs = CDBL(.QuizScore)
						qw = CDBL(.QuizWeight)
						.Time = qs * ( qw / 100 )
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessionLessons" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Homeworks" project="ptsHomeworkUser" class="CHomeworks">
					<WTMETHOD name="ListSession">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
					</WTMETHOD>
<WTCUSTOM>
				For Each oItem in oHomeworks
				   With oItem
						qs = CDBL(.Score)
						qw = CDBL(.Weight)
						.Seq = qs * ( qw / 100 )
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHomeworks" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Assessment" project="ptsAssessmentUser" class="CAssessment">
					<WTCONDITION expr="PARAM(AssessmentID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AssessmentID" direction="input" value="PARAM(AssessmentID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAssessment" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="MemberAssess" project="ptsMemberAssessUser" class="CMemberAssess">
					<WTCONDITION expr="PARAM(AssessmentID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="CheckAssessment">
						<WTPARAM name="reqMemberAssessID" direction="return" datatype="number"/>
						<WTPARAM name="AssessmentID" direction="input" value="PARAM(AssessmentID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberAssessID" direction="input" value="PARAM(MemberAssessID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
				qs = CDBL(.Score)
				qw = CDBL(tmpExamWeight)
				.Num1 = qs * ( qw / 100 )
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMemberAssess" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" label="GradeBook" class="PageHeading" align="center"/>
					<WTBUTTON col="1" action="0" value="CONST(Refresh)" align="center" btnclass="smbutton"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="ATTR(Course.CourseName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" bold="true" align="center">
						<WTSTATIC value="ATTR(Session.StudentName)" newline="1"/>
						<WTSTATIC tag="Grade" space="1"/>
						<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@grade&quot;/&gt;%)" space="1"/>
						<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@passinggrade&quot;/&gt;%))"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Course.Credit)" oper="greater" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC tag="Credits" space="1"/>
							<WTSTATIC value="ATTR(Course.Credit)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTSTATIC label="ViewQuiz"/>
				<WTSTATIC label="ViewHomework"/>
				<WTSTATIC label="ViewExam"/>

				<WTROW margin-bottom="18">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONLESSONS/PTSSESSIONLESSON))" oper="greater" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" entity="SessionLesson">
						<WTCOLUMN width="5" align="center"/>
						<WTCOLUMN width="55" align="left" label="LessonQuizzes"/>
						<WTCOLUMN width="10" align="center" label="Passing"/>
						<WTCOLUMN width="10" align="center" label="Grade"/>
						<WTCOLUMN width="10" align="center" label="Weight"/>
						<WTCOLUMN width="10" align="center" label="Points"/>
						<WTROW>
							<WTIMAGE  col="1" value="CONST(lesson_status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" valign="top"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(SessionLesson.LessonName)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(edit.gif)" alt="ViewQuiz" valign="top" imgalign="absmiddle">
										<WTLINK name="2112" target="Quiz" return="false">
											<WTPARAM name="LessonID" value="DATA(SessionLessonID)"/>
											<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
											<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
											<WTPARAM name="Popup" value="CONST(2)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
<!--
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(edit.gif)" alt="ViewLesson" valign="top" imgalign="absmiddle">
										<WTLINK name="2430" target="Lesson" return="false">
											<WTPARAM name="LessonID" value="DATA(SessionLessonID)"/>
											<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
											<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(2)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
-->								
							</WTSTATIC>
							<WTSTATIC col="3" value="CONST(&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%)"/>
							<WTSTATIC col="4" value="CONST(&lt;xsl:value-of select=&quot;@quizscore&quot;/&gt;)"/>
							<WTSTATIC col="5" value="CONST(&lt;xsl:value-of select=&quot;@quizweight&quot;/&gt;%)"/>
							<WTSTATIC col="6" value="DATA(SessionLesson.Time)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-bottom="18">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSHOMEWORKS/PTSHOMEWORK))" oper="greater" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" entity="Homework">
						<WTCOLUMN width="5" align="center"/>
						<WTCOLUMN width="55" align="left" label="Homework"/>
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="10" align="center" label="Grade"/>
						<WTCOLUMN width="10" align="center" label="Weight"/>
						<WTCOLUMN width="10" align="center" label="Points"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(AttachmentID)" oper="equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status0.gif)" valign="top"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(AttachmentID)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status2.gif)" valign="top"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" merge="2">
								<WTSTATIC value="DATA(Name)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(AttachmentID)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(edit.gif)" alt="ViewHomework" valign="top" imgalign="absmiddle">
										<WTLINK name="8003" target="Homework" return="false">
											<WTPARAM name="AttachmentID" value="DATA(AttachmentID)"/>
											<WTPARAM name="Mini" value="CONST(2)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="PopUp" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="4" value="CONST(&lt;xsl:value-of select=&quot;@score&quot;/&gt;)"/>
							<WTSTATIC col="5" value="CONST(&lt;xsl:value-of select=&quot;@weight&quot;/&gt;%)"/>
							<WTSTATIC col="6" value="DATA(SessionLesson.Seq)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(AssessmentID)" oper="not-equal" value="CONST(0)"/>
					<WTTABLE col="1">
						<WTCOLUMN width="38" align="center"/>
						<WTCOLUMN width="412" align="left"/>
						<WTCOLUMN width="75" align="center"/>
						<WTCOLUMN width="75" align="center"/>
						<WTCOLUMN width="75" align="center"/>
						<WTCOLUMN width="75" align="center"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="FinalExam" bold="true" class="ColumnHeader"/>
							<WTSTATIC col="3"/>
							<WTSTATIC col="4" label="Grade" class="ColumnHeader"/>
							<WTSTATIC col="5" label="Weight" class="ColumnHeader"/>
							<WTSTATIC col="6" label="Points" class="ColumnHeader"/>
						</WTROW>
						<WTROW>
							<WTDIVIDER col="1" merge="6" height="2" color="SYS(gray)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(MemberAssessID)" oper="equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status0.gif)" valign="top"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(MemberAssessID)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status2.gif)" valign="top"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="ATTR(Assessment.AssessmentName)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="CONST(5)"/>
									<WTIMAGE value="CONST(edit.gif)" alt="ViewExam" valign="top" imgalign="absmiddle">
										<WTLINK name="3105" target="Exam" return="false">
											<WTPARAM name="AssessmentID" value="ATTR(Assessment.AssessmentID)"/>
											<WTPARAM name="Register" value="CONST(1)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="3"/>
							<WTSTATIC col="4" value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBERASSESS/@score&quot;/&gt;)"/>
							<WTSTATIC col="5" value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@examweight&quot;/&gt;%)"/>
							<WTSTATIC col="6" value="ATTR(MemberAssess.Num1)"/>
						</WTROW>
						<WTROW>
							<WTDIVIDER col="1" merge="6" height="2" color="SYS(gray)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="18">
					<WTTABLE col="1">
						<WTCOLUMN width="175" align="left"/>
						<WTCOLUMN width="400" align="center"/>
						<WTCOLUMN width="175" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" value="CONST(LEGEND)" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="2">
							<WTSTATIC col="1"/>
							<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="2">
							<WTSTATIC col="1"/>
							<WTIMAGE col="2" value="CONST(lesson_status0.gif)" imgalign="absmiddle" align="center"/>
							<WTSTATIC col="2" value="CONST(not started)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(started)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(completed)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(failed)" prespace="false"/>
							<WTIMAGE col="2" value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
							<WTSTATIC col="2" value="CONST(passed)" prespace="false"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1"/>
							<WTDIVIDER col="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="GradeBookInfo" class="prompt" align="left"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
						
				<WTROW margin-top="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_1321" caption="Grade Book" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98">
			<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/>
			<!--internal-->
			<WTPARAM name="MemberID" datatype="number"/>
			<!--internal-->
			<WTPARAM name="AssessmentID" datatype="number"/>
			<!--internal-->
			<WTPARAM name="MemberAssessID" datatype="number"/>
			<!--internal-->

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CourseID)" value="ATTR(CourseID)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(AssessmentID)" value="ATTR(ExamID)"/>
					<WTSETATTRIBUTE name="CONST(tmpExamWeight)" value="ATTR(ExamWeight)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="SessionLessons" project="ptsSessionLessonUser" class="CSessionLessons">
					<WTMETHOD name="ListQuiz">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						For Each oItem in oSessionLessons
						With oItem
						qs = CDBL(.QuizScore)
						qw = CDBL(.QuizWeight)
						.Time = qs * ( qw / 100 )
						End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessionLessons" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Homeworks" project="ptsHomeworkUser" class="CHomeworks">
					<WTMETHOD name="ListSession">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
					</WTMETHOD>
					<WTCUSTOM>
						For Each oItem in oHomeworks
						With oItem
						qs = CDBL(.Score)
						qw = CDBL(.Weight)
						.Seq = qs * ( qw / 100 )
						End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHomeworks" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Assessment" project="ptsAssessmentUser" class="CAssessment">
					<WTCONDITION expr="PARAM(AssessmentID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AssessmentID" direction="input" value="PARAM(AssessmentID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAssessment" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="MemberAssess" project="ptsMemberAssessUser" class="CMemberAssess">
					<WTCONDITION expr="PARAM(AssessmentID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="CheckAssessment">
						<WTPARAM name="reqMemberAssessID" direction="return" datatype="number"/>
						<WTPARAM name="AssessmentID" direction="input" value="PARAM(AssessmentID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberAssessID" direction="input" value="PARAM(MemberAssessID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						qs = CDBL(.Score)
						qw = CDBL(tmpExamWeight)
						.Num1 = qs * ( qw / 100 )
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMemberAssess" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="left"/>

				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" label="GradeBook" class="PageHeading" align="center"/>
					<WTBUTTON col="1" action="0" value="CONST(Refresh)" align="center" btnclass="smbutton"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" value="ATTR(Course.CourseName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" bold="true" align="center">
						<WTSTATIC value="ATTR(Session.StudentName)" newline="1"/>
						<WTSTATIC tag="Grade" space="1"/>
						<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@grade&quot;/&gt;%)" space="1"/>
						<WTSTATIC value="CONST((&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@passinggrade&quot;/&gt;%))"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(Course.Credit)" oper="greater" value="CONST(0)"/>
							<WTSTATIC newline="1"/>
							<WTSTATIC tag="Credits" space="1"/>
							<WTSTATIC value="ATTR(Course.Credit)"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>

				<WTSTATIC label="ViewQuiz"/>
				<WTSTATIC label="ViewHomework"/>
				<WTSTATIC label="ViewExam"/>

				<WTROW margin-bottom="18">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONLESSONS/PTSSESSIONLESSON))" oper="greater" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" entity="SessionLesson">
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="90" align="left" label="LessonQuizzes"/>
						<WTROW>
							<WTIMAGE  col="1" value="CONST(lesson_status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" valign="top"/>
							<WTSTATIC col="2">
								<WTSTATIC value="DATA(SessionLesson.LessonName)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(Status)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(edit.gif)" alt="ViewQuiz" valign="top" imgalign="absmiddle">
										<WTLINK name="m_2112" target="Quiz" return="false">
											<WTPARAM name="LessonID" value="DATA(SessionLessonID)"/>
											<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
											<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
											<WTPARAM name="Popup" value="CONST(2)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Passing"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Grade"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizscore&quot;/&gt;)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Weight"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizweight&quot;/&gt;%)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Points"/>
								<WTSTATIC value="DATA(SessionLesson.Time)"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-bottom="18">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSHOMEWORKS/PTSHOMEWORK))" oper="greater" value="CONST(0)"/>
					<WTRECORDSET col="1" graybar="true" entity="Homework">
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="90" align="left" label="Homework"/>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(AttachmentID)" oper="equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status0.gif)" valign="top"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(AttachmentID)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status2.gif)" valign="top"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" merge="2">
								<WTSTATIC value="DATA(Name)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="DATA(AttachmentID)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE value="CONST(edit.gif)" alt="ViewHomework" valign="top" imgalign="absmiddle">
										<WTLINK name="8003" target="Homework" return="false">
											<WTPARAM name="AttachmentID" value="DATA(AttachmentID)"/>
											<WTPARAM name="Mini" value="CONST(2)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="PopUp" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Grade"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@score&quot;/&gt;)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Weight"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@weight&quot;/&gt;%)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Points"/>
								<WTSTATIC value="DATA(SessionLesson.Seq)"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(AssessmentID)" oper="not-equal" value="CONST(0)"/>
					<WTTABLE col="1">
						<WTCOLUMN width="10" align="center"/>
						<WTCOLUMN width="90" align="left"/>
						<WTROW>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" label="FinalExam" bold="true" class="ColumnHeader"/>
						</WTROW>
						<WTROW>
							<WTDIVIDER col="1" merge="2" height="2" color="SYS(gray)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(MemberAssessID)" oper="equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status0.gif)" valign="top"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(MemberAssessID)" oper="not-equal" value="CONST(0)"/>
									<WTIMAGE  value="CONST(lesson_status2.gif)" valign="top"/>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2">
								<WTSTATIC value="ATTR(Assessment.AssessmentName)" space="1"/>
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="CONST(5)"/>
									<WTIMAGE value="CONST(edit.gif)" alt="ViewExam" valign="top" imgalign="absmiddle">
										<WTLINK name="3105" target="Exam" return="false">
											<WTPARAM name="AssessmentID" value="ATTR(Assessment.AssessmentID)"/>
											<WTPARAM name="Register" value="CONST(1)"/>
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="ContentPage" value="CONST(3)"/>
											<WTPARAM name="Popup" value="CONST(1)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Grade"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSMEMBERASSESS/@score&quot;/&gt;)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Weight"/>
								<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@examweight&quot;/&gt;%)"/>
								<WTSTATIC value="CONST(-)"/>
								<WTSTATIC tag="Points"/>
								<WTSTATIC value="ATTR(MemberAssess.Num1)"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTDIVIDER col="1" merge="2" height="2" color="SYS(gray)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="18">
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" value="CONST(LEGEND)" bold="true" align="center"/>
				</WTROW>
				<WTROW margin-bottom="2">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="2">
					<WTSTATIC col="1" align="center">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(started)" space="1"/>
							<WTIMAGE value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(completed)" space="1"/>
							<WTIMAGE value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(failed)" space="1"/>
							<WTIMAGE value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
							<WTSTATIC value="CONST(passed)" space="1"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" label="GradeBookInfo" class="prompt" align="left"/>
				</WTROW>

				<WTROW margin-top="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="1322" caption="Course Reports" form="Report" header="false" footer="false" navbar="false" 
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="1322" language="false">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MasterID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="CourseID" datatype="number"/>
			<WTPARAM name="MemberName" datatype="text"/>
			<WTPARAM name="BusinessName" datatype="text"/>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="&quot;1/1/2010&quot;"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)"/>
				<WTSETATTRIBUTE name="PARAM(Term)" value="CONST(3)"/>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="CONST(0)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(MemberName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
						<WTSETATTRIBUTE name="PARAM(MasterID)" value="ATTR(MasterID)">
							<WTCONDITION expr="PARAM(MasterID)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)">
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MasterID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(BusinessName)" value="ATTR(CompanyName)"/>
						<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)">
							<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="225" align="right"/>
				<WTCOLUMN width="525" align="left"/>
			
				<WTFUNCTION name="CreateReport( page, target, options )">
					var url;
					var win;
					url = page + ".asp?CompanyID=" + Report.CompanyID.value + "&amp;MasterID=" + Report.MasterID.value + "&amp;MemberID=" + Report.MemberID.value + "&amp;FromDate=" + Report.FromDate.value + "&amp;ToDate=" + Report.ToDate.value;
					if ( options ) url += "&amp;" + options;
					win = window.open(url,target);
					win.focus();
				</WTFUNCTION>
				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="PARAM(MasterID)"/>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="left" label="CourseReports" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="ReportText" align="left" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="18">
					<WTSTATIC col="1" tag="ReportOn"/>
					<WTCOMBO col="2" name="Term" value="PARAM(Term)" prespace="false">
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="UptoToday"/>
						<WTOPTION id="4" label="PrevWeek"/>
						<WTOPTION id="5" label="PrevMonth"/>
						<WTOPTION id="6" label="PrevYear"/>
						<WTOPTION id="7" label="WeekToDate"/>
						<WTOPTION id="8" label="MonthToDate"/>
						<WTOPTION id="9" label="YearToDate"/>
<!--						
						<WTOPTION id="10" label="Tomorrow"/>
						<WTOPTION id="11" label="Next7Days"/>
						<WTOPTION id="12" label="Next14Days"/>
						<WTOPTION id="13" label="Next30Days"/>
-->
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							fromdate.setYear(2000);
							break;
							case "4":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "5":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "6":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "7":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "8":
							fromdate.setDate(1);
							break;
							case "9":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "10":
							fromdate.setTime(fromdate.getTime() + ONE_DAY );
							todate = fromdate;
							break;
							case "11":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "12":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "13":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="2" tag="From"/>
					<WTTEXT col="2" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true" prespace="false"/>
					<WTSTATIC col="2" tag="To"/>
					<WTTEXT col="2" value="PARAM(ToDate)" name="ToDate" type="date" size="8" prespace="false"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="IsEmployee" connector="or"/>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
						<WTBUTTON col="1" merge="2" align="center">
							<WTSTATIC value="PARAM(MemberName)" spacex="1"/>
							<WTSTATIC label="DetailReport"/>
							<WTCLICK>CreateReport("1323","Report", "report=1&amp;Courseid="+Report.CourseID.value);</WTCLICK>
						</WTBUTTON>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="IsMemberBusiness"/>
						<WTCONDITION expr="IsEmployee" connector="or"/>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="PARAM(MasterID)" oper="not-equal" value="CONST(0)"/>
							<WTBUTTON col="1" merge="2" align="center">
								<WTSTATIC value="PARAM(BusinessName)" spacex="1"/>
								<WTSTATIC label="SummaryReport"/>
								<WTCLICK>CreateReport("1323","Report", "report=2&amp;Courseid="+Report.CourseID.value);</WTCLICK>
							</WTBUTTON>
						</WTROW>
						<WTROW margin-bottom="12">
							<WTSTATIC col="1" merge="2" label="Course" align="center"/>
							<WTTEXT col="1" value="PARAM(CourseID)" name="CourseID" size="5"/>
						</WTROW>

					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="1323" caption="Course Report" header="false" footer="false" navbar="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" langfile="1323" language="false">
		<!--==================================================================-->
			<WTPARAM name="Report" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="MasterID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="CourseID" datatype="Number"/>
			<WTPARAM name="Title" datatype="text"/>
			<WTPARAM name="Count" datatype="number"/>

			<WTACTION id="0" name="New" type="New">
<WTCUSTOM>
				'validate all parameters
				If reqReport &lt; 1 OR reqReport &gt; 4 Then reqReport = 1
				If NOT IsDate(reqFromDate) OR NOT IsDate(reqToDate) Then
					reqFromDate = CDate( DateAdd("d", -1, Date()) )
					reqToDate = CDate( Date() )
				End If
</WTCUSTOM>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="CoursesMember">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
					<WTMETHOD name="CoursesBusiness">
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTPARAM name="MasterID" direction="input" value="PARAM(MasterID)"/>
						<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="greater" value="CONST(1)"/>
<WTCUSTOM>
				For Each oSession in oSessions
					With oSession
						If .Num3 = 0 Then
							.Num4 = "0%"
						Else
							.Num4 = FormatPercent(CLng(.Num3) / CLng(.Num1),0)
						End If
					End With	
					reqCount = reqCount + 1
				Next
				reqCount = FormatNumber(reqCount,0)
</WTCUSTOM>

					</WTCODEGROUP>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Title)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="MasterID" direction="input" value="PARAM(MasterID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(Title)" value="ATTR(CompanyName)"/>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="600" align="left"/>

				<WTROW margin-top="6"/>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTSTATIC col="1" merge="2" label="MemberCourseReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" label="BusinessCourseReport" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="PARAM(Title)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTSTATIC col="1" merge="2" value="ATTR(Course.CourseName)" class="PageHeading" align="center"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" class="BoldText">
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(1)"/>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
						<WTCOLUMN width="40" align="left" valign="top" label="CourseName"/>
						<WTCOLUMN width="15" align="center" valign="top" label="CompleteDate"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Grade"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Passing"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Status"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Session.CourseName)">
								<WTLINK name="3460" target="Report">
									<WTPARAM name="CourseID" value="DATA(CourseID)"/>
									<WTPARAM name="SessionID" value="DATA(SessionID)"/>
								</WTLINK>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Session.CompleteDate)"/>
							<WTSTATIC col="3" value="DATA(Session.Result)"/>
							<WTSTATIC col="4" value="DATA(Session.Num1)"/>
							<WTSTATIC col="5">
								<WTSTATIC label="Complete">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(5)"/>
								</WTSTATIC>
								<WTSTATIC label="QuizFail">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(6)"/>
								</WTSTATIC>
								<WTSTATIC label="QuizPass">
									<WTCONDITION expr="DATA(Session.Status)" oper="equal" value="CONST(7)"/>
								</WTSTATIC>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW>
					<WTCONDITION expr="PARAM(Report)" oper="equal" value="CONST(2)"/>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
						<WTCOLUMN width="20" align="left" valign="top" label="Role"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Total"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Taken"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Passed"/>
						<WTCOLUMN width="20" align="center" valign="top" label="Percent"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Session.MemberName)"/>
							<WTSTATIC col="2" value="DATA(Session.Num1)"/>
							<WTSTATIC col="3" value="DATA(Session.Num2)"/>
							<WTSTATIC col="4" value="DATA(Session.Num3)"/>
							<WTSTATIC col="5" value="DATA(Session.Num4)"/>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="1330" caption="My Class" contentpage="true" header="false" footer="false" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" track="0">
		<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/> <!--internal-->
			<WTPARAM name="MemberID" datatype="number"/> <!--internal-->
			<WTPARAM name="Register" datatype="number"/> <!--internal-->
			<WTPARAM name="ContentPage" datatype="number"/>
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="Lessons" datatype="text"/>
			<WTPARAM name="Lesson" datatype="number"/>

      <WTCODEGROUP>
        <WTCONDITION expr="IsMemberOnly"/>
        <WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
        <WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
      </WTCODEGROUP>

<!--
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotClasses" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
-->
			<WTSUB name="Register">
				<!-- Get member name and status -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
				</WTOBJECT>
				<!-- Check if this member has already registered this course -->
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="CheckCourse">
						<WTPARAM name="reqSessionID" direction="return" datatype="number"/>
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- Create new session for the member if not already registered -->
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)"/> 
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CourseID)" value="PARAM(CourseID)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(RegisterDate)" value="SYS(date)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpMemberNameLast)"/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpMemberNameFirst)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqSessionID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION name="New" type="New" id="0">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>

				<WTCALLSUB name="Register">
					<WTCONDITION expr="PARAM(Register)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(CourseID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
				
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CourseID)" value="ATTR(CourseID)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpRating1)" value="ATTR(Rating1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpNoEvaluation)" value="ATTR(NoEvaluation)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpNoEvaluation)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="CONST(tmpStatus)" oper="greater" value="CONST(2)" connector="and"/>
					<WTCONDITION expr="CONST(tmpRating1)" oper="equal" value="CONST(0)" connector="and"/>
					<WTRETURN>
						<WTLINK name="1304" return="false" nolocaldata="true">
							<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
							<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
							<WTPARAM name="Popup" value="PARAM(Popup)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				
				<WTOBJECT name="SessionLessons" project="ptsSessionLessonUser" class="CSessionLessons">
					<WTMETHOD name="ListSession">
						<WTPARAM name="LessonID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="Lessons" direction="input" value="PARAM(Lessons)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
				'Display the inital lesson as active
				tmpDisplay = "1"
				prevQuiz = "1"
				prevStatus = "4"
				tmpLessonID = 0
				For Each oSessionLesson in oSessionLessons
				   With oSessionLesson
						If reqLesson &gt; 0 AND .Seq = CSTR(reqLesson) Then tmpLessonID = .LessonID
						secs = .Time
						seconds = secs Mod 60 
						minutes = Int((secs / 60) Mod 60)
						hours = Int(secs / 3600 )
						fmt = ""
						If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
						If minutes &lt; 10 Then fmt = fmt + "0"
						fmt = fmt &amp; minutes &amp; ":"
						If seconds &lt; 10 Then fmt = fmt + "0"
						.Time = fmt &amp; seconds &amp; "(" &amp; .Times &amp; ")"

						'If previous lessons are deactivated, inactivate all following lessons 
						If tmpDisplay = "0" Then
							.IsPassQuiz = "0" 'do not display this lesson as active
						Else
							'If this lesson requires a passed quiz AND there is a quiz AND the quiz was passed  
							If .IsPassQuiz &lt;&gt; "0" AND prevQuiz &gt; "1" AND prevStatus &lt;&gt; "4" Then
								.IsPassQuiz = "0" 'do not display this lesson as active
								tmpDisplay = "0" 'do not display anymore lessons.
							Else
								.IsPassQuiz = "1" 'display this lesson as active 
							End If
						End If
						prevQuiz = .Quiz
						prevStatus = .Status
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessionLessons" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				
				<!-- If we have a specific lesson, go to it directly -->
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpLessonID)" oper="not-equal" value="CONST(0)"/>
					<WTRETURN>
						<WTLINK name="2430" return="false">
							<WTPARAM name="LessonID" value="CONST(tmpLessonID)"/>
							<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
							<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							<WTPARAM name="Lessons" value="PARAM(Lessons)"/>
							<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
							<WTPARAM name="Popup" value="PARAM(Popup)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>
				
			</WTACTION>
			
			<WTACTION id="2" name="ReturnClasses" type="Cancel">
				<WTRETURN>
					<WTLINK name="1311" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION name="Cancel" type="Cancel" id="3">
				<WTRETURN>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTLINK name="0404" return="false"/>
				</WTRETURN>
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Certificate" type="Update">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CourseID)" value="ATTR(CourseID)"/>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpIsCustomCertificate)" value="ATTR(IsCustomCertificate)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="CONST(tmpIsCustomCertificate)" oper="equal" value="CONST(0)"/>
					<WTLINK name="1338" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
					</WTLINK>
				</WTRETURN>
				<WTRETURN>
					<WTCONDITION expr="CONST(tmpIsCustomCertificate)" oper="not-equal" value="CONST(0)"/>
					<WTLINK name="1107" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
						<WTPARAM name="I" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="5" name="Evaluation" type="Update">
				<WTRETURN>
					<WTLINK name="1304" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="6" name="Remove" type="Update">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Remove">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="1311" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="150" align="left"/>
				<WTCOLUMN width="450" align="left"/>

				<WTFUNCTION name="FinalExam()">
					var url, win;
					var exam = document.getElementById('ExamID').value;
					var member = document.getElementById('MemberID').value;
					url = "3105.asp?assessmentid=" + exam + "&amp;memberid=" + member + "&amp;register=1&amp;contentpage=3&amp;popup=1";
		            win = window.open(url,"Exam");
					win.focus();
					doSubmit(2,"");
				</WTFUNCTION>

				<WTLOAD>parent.scrollTo(0,0);</WTLOAD>

				<WTSTATIC label="ClickTrainer"/>
				<WTSTATIC label="ClickStudent"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Session.SessionID)"/>
					<WTHIDDEN value="ATTR(Session.MemberID)"/>
					<WTHIDDEN value="ATTR(Course.ExamID)"/>
				</WTROW>
<!--
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
-->

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="greater-equal" value="CONST(0)" /> 

					<WTROW margin-bottom="12">
						<WTIMAGE col="1" value="CONST(class.gif)" align="center"/>
						<WTSTATIC col="2" label="MyClassText" align="left" valign="center" class="Prompt"/>
					</WTROW>
<!--          
					<WTROW margin-bottom="12">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
-->          
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Course.Status)" oper="equal" value="CONST(3)"/>
						<WTROW margin-bottom="12">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="500" align="left"/>
								<WTCOLUMN width="100" align="right"/>
								<WTROW>
									<WTSTATIC col="1" value="ATTR(Course.CourseName)" class="PageHeading" align="left"/>
<!--
                  <WTIMAGE col="1" value="CONST(Shortcut.gif)">
										<WTCONDITION expr="NotMemberOnly"/>
										<WTCONDITION expr="_IsShortcuts" connector="or"/>
										<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
											<WTPARAM name="EntityID" value="ENTITY(Session)"/>
											<WTPARAM name="ItemID" value="ATTR(Session.SessionID)"/>
											<WTPARAM name="Name" value="ATTR(Course.CourseName)" clean="true"/>
											<WTPARAM name="URL" value="SYS(PageURL)"/>
										</WTLINK>
									</WTIMAGE>
-->                  
									<WTSTATIC col="1">
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(Session.PassingGrade)" oper="greater" value="CONST(0)"/>
											<WTIMAGE value="CONST(homework.gif)" alt="ViewGradeBook">
												<WTLINK name="1321" target="blank">
													<WTPARAM name="SessionID" value="ATTR(Session.SessionID)"/>
												</WTLINK>
											</WTIMAGE>
											<WTSTATIC space="1"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPinnacleTutorial"/>
											<WTIMAGE value="CONST(Tutorial.gif)" alt="PinnacleTutorials" imgalign="absmiddle">
												<WTLINK name="Tutorial" target="Tutorial">
													<WTPARAM name="Lesson" value="SYSCON(TUTORIAL-TRAINING)"/>
													<WTPARAM name="contentpage" value="CONST(3)"/>
													<WTPARAM name="popup" value="CONST(1)"/>
												</WTLINK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
  										<WTSTATIC space="1"/>
    									<WTIMAGE value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@totalrating&quot;/&gt;.gif)">
  											<WTCONDITION expr="ATTR(Session.TotalRating)" oper="greater" value="CONST(0)"/>
    									</WTIMAGE>
    									<WTIMAGE value="CONST(star0.gif)">
  											<WTCONDITION expr="ATTR(Session.TotalRating)" oper="not-exist" value="CONST()"/>
    									</WTIMAGE>
										</WTCODEGROUP>
                    <WTCODEGROUP>
									    <WTCONDITION expr="IsEmployee"/>
                      <WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
                        <WTLINK name="1313">
                          <WTPARAM name="CourseID" value="ATTR(Course.CourseID)"/>
                        </WTLINK>
                      </WTIMAGE>
                    </WTCODEGROUP>
									</WTSTATIC>
									<WTBUTTON col="2" value="CONST(Close)" btnclass="smbutton" class="PageHeader">
										<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
										<WTCLICK>window.close()</WTCLICK>
									</WTBUTTON>
								</WTROW>
							</WTTABLE>
						</WTROW>
<!--						
						<WTROW>
							<WTSTATIC col="1" merge="2" value="CONST(&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='ClickTrainer']&quot;/&gt;:&lt;xsl:text disable-output-escaping=&quot;yes&quot;&gt;&amp;#160;&amp;#160;&lt;/xsl:text&gt;&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@trainername&quot;/&gt;)" bold="true">
								<WTLINK name="0308" target="trainer"><WTPARAM name="TrainerID" value="ATTR(Course.TrainerID)"/></WTLINK>
							</WTSTATIC>
						</WTROW>
-->						
						<WTROW margin-bottom="6">
							<WTCONDITION expr="PARAM(SessionID)" oper="not-equal" value="CONST(0)"/>
<!--              <WTSTATIC col="1" merge="2" value="CONST(&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='ClickStudent']&quot;/&gt;:&lt;xsl:text disable-output-escaping=&quot;yes&quot;&gt;&amp;#160;&amp;#160;&lt;/xsl:text&gt;&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@studentname&quot;/&gt;)" bold="true">-->
              <WTSTATIC col="1" merge="2">
                <WTSTATIC tag="ClickStudent"/>
                <WTSTATIC value="ATTR(Session.StudentName)" bold="true">
                  <WTLINK name="1305">
	  							 <WTPARAM name="SessionID" value="PARAM(SessionID)"/>
  								</WTLINK>
                </WTSTATIC>
              </WTSTATIC>
              <!--					<WTSTATIC col="1" merge="2" label="ClickStudent"/> -->
						</WTROW>
						<WTROW margin-bottom="6">
							<WTRECORDSET col="1" merge="2" graybar="true" entity="SessionLesson">
								<WTCOLUMN width="4" align="center"/>
								<WTCOLUMN width="4" align="left"/>
								<WTCOLUMN width="57" align="left" label="ClassLessons"/>
								<WTCOLUMN width="13" align="center" label="Grade"/>
								<WTCOLUMN width="6" align="center" label="Final"/>
								<WTCOLUMN width="9" align="right"/>
								<WTCOLUMN width="7" align="right"/>
								<WTROW height="36">
									<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)"/>
									<WTIMAGE col="2" value="CONST(lesson_status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)"/>
									<WTSTATIC col="3">
										<WTSTATIC value="DATA(SessionLesson.LessonName)" bold="true" space="1">
											<WTCONDITION expr="DATA(SessionLesson.IsPassQuiz)" oper="equal" value="CONST(1)"/>
											<WTSTATIC space="1"/>
											<WTCODEGROUP>
												<WTIMAGE value="CONST(preview24.gif)" alt="ViewSales" imgalign="absmiddle">
													<WTLINK name="2430" return="false">
														<WTPARAM name="LessonID" value="DATA(SessionLesson.LessonID)"/>
														<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
														<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
														<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
														<WTPARAM name="Lessons" value="PARAM(Lessons)"/>
														<WTPARAM name="ContentPage" value="PARAM(ContentPage)"/>
														<WTPARAM name="Popup" value="PARAM(Popup)"/>
													</WTLINK>
												</WTIMAGE>
											</WTCODEGROUP>
										</WTSTATIC>
										<WTSTATIC value="DATA(SessionLesson.LessonName)" fontcolor="gray">
											<WTCONDITION expr="DATA(SessionLesson.IsPassQuiz)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC fontcolor="purple">
											<WTCONDITION expr="PARAM(SessionID)" oper="not-equal" value="CONST(0)"/>
											<WTCONDITION expr="CONST(not(contains)" value="CONST((/DATA/TXN/PTSCOURSE/@coursename, ':-')))" connector="and"/>
											<WTSTATIC label="CONST(,)" space="2"/>
											<WTSTATIC tag="Time"/>
											<WTSTATIC value="DATA(SessionLesson.Time)"/>
										</WTSTATIC>
									</WTSTATIC>
									<WTSTATIC col="4">
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
											<WTCONDITION expr="DATA(SessionLesson.Status)" oper="greater" value="CONST(2)" connector="and"/>
											<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizscore&quot;/&gt;% (&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%))"/>
										</WTCODEGROUP>
									</WTSTATIC>
									<WTSTATIC col="5">
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
											<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizweight&quot;/&gt;%)"/>
										</WTCODEGROUP>
									</WTSTATIC>
									<WTSTATIC col="6">
										<WTSTATIC value="DATA(SessionLesson.LessonLength)"/>
										<WTSTATIC value="CONST( min.)"/>
									</WTSTATIC>
									<WTSTATIC col="7">
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.MediaType)" oper="equal" value="CONST(1)"/>
											<WTIMAGE value="CONST(video.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.MediaType)" oper="equal" value="CONST(2)"/>
											<WTIMAGE value="CONST(audio.gif)"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
											<WTIMAGE value="CONST(quiz.gif)"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
                <WTROW margin-bottom="6">
                  <WTSTATIC col="1" merge="2"/>
                  <WTSTATIC col="3" merge="5">
                    <WTSTATIC value="DATA(SessionLesson.Description)">
                      <WTCONDITION expr="DATA(SessionLesson.IsPassQuiz)" oper="not-equal" value="CONST(0)"/>
                    </WTSTATIC>
                    <WTSTATIC value="DATA(SessionLesson.Description)" fontcolor="gray">
                      <WTCONDITION expr="DATA(SessionLesson.IsPassQuiz)" oper="equal" value="CONST(0)"/>
                    </WTSTATIC>
                    <WTSTATIC newline="2"/>
                 </WTSTATIC>
              </WTROW>
							</WTRECORDSET>
						</WTROW>

						<WTROW margin-top="12" margin-bottom="12">
							<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)"/>
							<WTBUTTON col="1" merge="2" action="2" value="CONST(ReturnClasses)" align="center">
								<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
							</WTBUTTON>
							<WTBUTTON col="1" merge="2" value="CONST(FinalExam)" align="center">
								<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="SYSCON(SESSION-COMPLETED)"/>
								<WTCONDITION expr="ATTR(Course.ExamID)" oper="not-equal" value="CONST(0)" connector="and"/>
								<WTCLICK>FinalExam()</WTCLICK>
							</WTBUTTON>
							<WTBUTTON col="1" merge="2" action="4" value="CONST(PrintCertificate)" align="center">
								<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="SYSCON(SESSION-COMPLETED)"/>
								<WTCONDITION expr="ATTR(Course.NoCertificate)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
								<WTCONDITION expr="NotMemberOnly" connector="or" paren="end"/>
							</WTBUTTON>
							<WTBUTTON col="1" merge="2" action="5" value="CONST(Evaluation)" align="center">
								<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="SYSCON(SESSION-COMPLETED)"/>
								<WTCONDITION expr="ATTR(Course.NoEvaluation)" oper="equal" value="CONST(0)" connector="and"/>
							</WTBUTTON>
<!--              
							<WTBUTTON col="1" merge="2" action="6" value="CONST(Remove)" align="center" msg="ConfirmRemove">
								<WTCONDITION expr="ATTR(Session.QuizLimit)" oper="equal" value="CONST(0)"/>
								<WTCONDITION expr="ATTR(Session.IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
							</WTBUTTON>
-->
              <WTBUTTON col="1" merge="2" value="CONST(Close)">
								<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTCONDITION expr="IsMemberOnly"/>
							<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1" value="CONST(LEGEND)" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="2">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="2">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="400" align="left"/>
								<WTCOLUMN width="200" align="right"/>
								<WTROW>
									<WTIMAGE col="1" value="CONST(lesson_status0.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="1" value="CONST(not started)" prespace="false"/>
									<WTIMAGE col="1" value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="1" value="CONST(started)" prespace="false"/>
									<WTIMAGE col="1" value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="1" value="CONST(completed)" prespace="false"/>
									<WTIMAGE col="1" value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="1" value="CONST(failed)" prespace="false"/>
									<WTIMAGE col="1" value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="1" value="CONST(passed)" prespace="false"/>

									<WTIMAGE col="2" value="CONST(video.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="2" value="CONST(video)" prespace="false"/>
									<WTIMAGE col="2" value="CONST(audio.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="2" value="CONST(audio)" prespace="false"/>
									<WTIMAGE col="2" value="CONST(quiz.gif)" imgalign="absmiddle"/>
									<WTSTATIC col="2" value="CONST(quiz)" prespace="false"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						
						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
					</WTCODEGROUP>
					
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Course.Status)" oper="not-equal" value="CONST(3)"/>
						<WTROW margin-bottom="12" margin-top="12">
							<WTSTATIC col="1" merge="2" label="Inactive" align="center" class="pageheading"/>
						</WTROW>
						<WTROW>
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTBUTTON col="1" merge="2" action="2" value="CONST(ReturnClasses)" align="center"/>
						</WTROW>
				</WTCODEGROUP>

				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="less" value="CONST(0)" /> 
					<WTROW margin-top="24" margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="NotPrerequisite" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_1330" caption="My Class" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" focus="false" viewport="width=device-width"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl" mobile="MobileHome.asp" secured="98" track="0">
			<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/>
			<!--internal-->
			<WTPARAM name="MemberID" datatype="number"/>
			<!--internal-->
			<WTPARAM name="Register" datatype="number"/>
			<!--internal-->
			<WTPARAM name="Popup" datatype="number"/>
			<WTPARAM name="Lessons" datatype="text"/>
			<WTPARAM name="Lesson" datatype="number"/>
			<!--
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="NotClasses" connector="and"/>
				<WTRETURN>
					<WTLINK name="0419" return="false">
						<WTPARAM name="Error" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
-->
			<WTSUB name="Register">
				<!-- Get member name and status -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberNameLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
				</WTOBJECT>
				<!-- Check if this member has already registered this course -->
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="CheckCourse">
						<WTPARAM name="reqSessionID" direction="return" datatype="number"/>
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<!-- Create new session for the member if not already registered -->
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CourseID)" value="PARAM(CourseID)"/>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CommStatus)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(RegisterDate)" value="SYS(date)"/>
					<WTSETATTRIBUTE name="ATTR(NameLast)" value="CONST(tmpMemberNameLast)"/>
					<WTSETATTRIBUTE name="ATTR(NameFirst)" value="CONST(tmpMemberNameFirst)"/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqSessionID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTACTION name="New" type="New" id="0">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTRETURN>
						<WTLINK name="m_0101" return="false">
							<WTPARAM name="ActionCode" value="CONST(9)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>

				<WTCALLSUB name="Register">
					<WTCONDITION expr="PARAM(Register)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(CourseID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>

				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CourseID)" value="ATTR(CourseID)"/>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="CONST(tmpStatus)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpRating1)" value="ATTR(Rating1)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpNoEvaluation)" value="ATTR(NoEvaluation)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpNoEvaluation)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="CONST(tmpStatus)" oper="greater" value="CONST(2)" connector="and"/>
					<WTCONDITION expr="CONST(tmpRating1)" oper="equal" value="CONST(0)" connector="and"/>
					<WTRETURN>
						<WTLINK name="m_1304" return="false" nolocaldata="true">
							<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
							<WTPARAM name="Popup" value="PARAM(Popup)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>

				<WTOBJECT name="SessionLessons" project="ptsSessionLessonUser" class="CSessionLessons">
					<WTMETHOD name="ListSession">
						<WTPARAM name="LessonID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="Lessons" direction="input" value="PARAM(Lessons)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						'Display the inital lesson as active
						tmpDisplay = "1"
						prevQuiz = "1"
						prevStatus = "4"
						tmpLessonID = 0
						For Each oSessionLesson in oSessionLessons
						With oSessionLesson
						If reqLesson &gt; 0 AND .Seq = CSTR(reqLesson) Then tmpLessonID = .LessonID
						secs = .Time
						seconds = secs Mod 60
						minutes = Int((secs / 60) Mod 60)
						hours = Int(secs / 3600 )
						fmt = ""
						If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
						If minutes &lt; 10 Then fmt = fmt + "0"
						fmt = fmt &amp; minutes &amp; ":"
						If seconds &lt; 10 Then fmt = fmt + "0"
						.Time = fmt &amp; seconds &amp; "(" &amp; .Times &amp; ")"

						'If previous lessons are deactivated, inactivate all following lessons
						If tmpDisplay = "0" Then
						.IsPassQuiz = "0" 'do not display this lesson as active
						Else
						'If this lesson requires a passed quiz AND there is a quiz AND the quiz was passed
						If .IsPassQuiz &lt;&gt; "0" AND prevQuiz &gt; "1" AND prevStatus &lt;&gt; "4" Then
						.IsPassQuiz = "0" 'do not display this lesson as active
						tmpDisplay = "0" 'do not display anymore lessons.
						Else
						.IsPassQuiz = "1" 'display this lesson as active
						End If
						End If
						prevQuiz = .Quiz
						prevStatus = .Status
						End With
						Next
					</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessionLessons" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- If we have a specific lesson, go to it directly -->
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpLessonID)" oper="not-equal" value="CONST(0)"/>
					<WTRETURN>
						<WTLINK name="m_2430" return="false">
							<WTPARAM name="LessonID" value="CONST(tmpLessonID)"/>
							<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
							<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
							<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
							<WTPARAM name="Lessons" value="PARAM(Lessons)"/>
							<WTPARAM name="Popup" value="PARAM(Popup)"/>
						</WTLINK>
					</WTRETURN>
				</WTCODEGROUP>

			</WTACTION>

			<WTACTION id="2" name="ReturnClasses" type="Cancel">
				<WTRETURN>
					<WTLINK name="m_1311" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION name="Cancel" type="Cancel" id="3">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Certificate" type="Update">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CourseID)" value="ATTR(CourseID)"/>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpIsCustomCertificate)" value="ATTR(IsCustomCertificate)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="CONST(tmpIsCustomCertificate)" oper="equal" value="CONST(0)"/>
					<WTLINK name="1338" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
					</WTLINK>
				</WTRETURN>
				<WTRETURN>
					<WTCONDITION expr="CONST(tmpIsCustomCertificate)" oper="not-equal" value="CONST(0)"/>
					<WTLINK name="1107" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
						<WTPARAM name="I" value="CONST(1)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="5" name="Evaluation" type="Update">
				<WTRETURN>
					<WTLINK name="m_1304" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="6" name="Remove" type="Update">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Remove">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTLINK name="m_1311" return="false">
						<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="25" align="left"/>
				<WTCOLUMN width="75" align="left"/>

				<WTFUNCTION name="FinalExam()">
					var url, win;
					var exam = document.getElementById('ExamID').value;
					var member = document.getElementById('MemberID').value;
					url = "m_3105.asp?assessmentid=" + exam + "&amp;memberid=" + member + "&amp;register=1&amp;contentpage=3&amp;popup=1";
					win = window.open(url,"Exam");
					win.focus();
					doSubmit(2,"");
				</WTFUNCTION>

				<WTSTATIC label="ClickTrainer"/>
				<WTSTATIC label="ClickStudent"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Session.SessionID)"/>
					<WTHIDDEN value="ATTR(Session.MemberID)"/>
					<WTHIDDEN value="ATTR(Course.ExamID)"/>
				</WTROW>
				<!--
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
-->

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="greater-equal" value="CONST(0)" />

					<WTROW margin-bottom="6">
						<WTIMAGE col="1" value="CONST(class.gif)" align="center"/>
						<WTSTATIC col="2" label="MyClassText" align="left" valign="center" class="Prompt"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Course.Status)" oper="equal" value="CONST(3)"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="83" align="left"/>
								<WTCOLUMN width="17" align="right"/>
								<WTROW>
									<WTSTATIC col="1" value="ATTR(Course.CourseName)" class="PageHeading" align="left"/>
									<WTIMAGE col="1" value="CONST(Shortcut.gif)">
										<WTCONDITION expr="NotMemberOnly"/>
										<WTCONDITION expr="_IsShortcuts" connector="or"/>
										<WTLINK name="9202" target="shortcut" targetstyle="width=400, height=150">
											<WTPARAM name="EntityID" value="ENTITY(Session)"/>
											<WTPARAM name="ItemID" value="ATTR(Session.SessionID)"/>
											<WTPARAM name="Name" value="ATTR(Course.CourseName)" clean="true"/>
											<WTPARAM name="URL" value="SYS(PageURL)"/>
										</WTLINK>
									</WTIMAGE>
									<WTSTATIC col="1">
										<WTCODEGROUP>
											<WTCONDITION expr="ATTR(Session.PassingGrade)" oper="greater" value="CONST(0)"/>
											<WTIMAGE value="CONST(homework.gif)" alt="ViewGradeBook">
												<WTLINK name="m_1321" target="blank">
													<WTPARAM name="SessionID" value="ATTR(Session.SessionID)"/>
												</WTLINK>
											</WTIMAGE>
											<WTSTATIC space="1"/>
										</WTCODEGROUP>
									</WTSTATIC>
									<WTIMAGE col="1" value="CONST(star&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@totalrating&quot;/&gt;.gif)">
										<WTCONDITION expr="ATTR(Session.TotalRating)" oper="not-equal" value="CONST(0)"/>
									</WTIMAGE>
									<WTBUTTON col="2" value="CONST(Close)" btnclass="smbutton">
										<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
										<WTCLICK>window.close()</WTCLICK>
									</WTBUTTON>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTCONDITION expr="PARAM(SessionID)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1" merge="2" value="CONST(&lt;xsl:value-of select=&quot;/DATA/LANGUAGE/LABEL[@name='ClickStudent']&quot;/&gt;:&lt;xsl:text disable-output-escaping=&quot;yes&quot;&gt;&amp;#160;&amp;#160;&lt;/xsl:text&gt;&lt;xsl:value-of select=&quot;/DATA/TXN/PTSSESSION/@studentname&quot;/&gt;)" bold="true">
								<WTLINK name="m_1305">
									<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
								</WTLINK>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTRECORDSET col="1" merge="2" graybar="true" entity="SessionLesson">
								<WTCOLUMN width="8" align="center"/>
								<WTCOLUMN width="8" align="left"/>
								<WTCOLUMN width="84" align="left" label="ClassLessons"/>
								<WTROW>
									<WTSTATIC col="1" value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)" valign="top"/>
									<WTIMAGE col="2" value="CONST(lesson_status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" valign="top"/>
									<WTSTATIC col="3">
										<WTSTATIC value="DATA(SessionLesson.LessonName)" bold="true">
											<WTCONDITION expr="DATA(SessionLesson.IsPassQuiz)" oper="equal" value="CONST(1)"/>
											<WTSTATIC space="1"/>
											<WTCODEGROUP>
												<WTIMAGE value="CONST(preview24.gif)" alt="ViewSales" imgalign="absmiddle">
													<WTLINK name="m_2430" return="false">
														<WTPARAM name="LessonID" value="DATA(SessionLesson.LessonID)"/>
														<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
														<WTPARAM name="CourseID" value="PARAM(CourseID)"/>
														<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
														<WTPARAM name="Lessons" value="PARAM(Lessons)"/>
														<WTPARAM name="Popup" value="PARAM(Popup)"/>
													</WTLINK>
												</WTIMAGE>
											</WTCODEGROUP>
										</WTSTATIC>
										<WTSTATIC value="DATA(SessionLesson.LessonName)" fontcolor="gray">
											<WTCONDITION expr="DATA(SessionLesson.IsPassQuiz)" oper="equal" value="CONST(0)"/>
										</WTSTATIC>
										<WTSTATIC space="1"/>
										<WTSTATIC fontcolor="purple">
											<WTCONDITION expr="PARAM(SessionID)" oper="not-equal" value="CONST(0)"/>
											<WTCONDITION expr="CONST(not(contains)" value="CONST((/DATA/TXN/PTSCOURSE/@coursename, ':-')))" connector="and"/>
											<WTSTATIC space="1"/>
											<WTSTATIC label="CONST(-)" space="1"/>
											<WTSTATIC tag="Time"/>
											<WTSTATIC value="DATA(SessionLesson.Time)"/>
										</WTSTATIC>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
											<WTCONDITION expr="DATA(SessionLesson.Status)" oper="greater" value="CONST(2)" connector="and"/>
											<WTSTATIC space="1"/>
											<WTSTATIC label="CONST(-)" space="1"/>
											<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizscore&quot;/&gt;% (&lt;xsl:value-of select=&quot;@passinggrade&quot;/&gt;%))"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
											<WTSTATIC space="1"/>
											<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@quizweight&quot;/&gt;%)"/>
										</WTCODEGROUP>
										<WTSTATIC fontcolor="purple">
											<WTSTATIC space="1"/>
											<WTSTATIC value="DATA(SessionLesson.LessonLength)"/>
											<WTSTATIC value="CONST( min.)"/>
										</WTSTATIC>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.MediaType)" oper="equal" value="CONST(1)"/>
											<WTIMAGE value="CONST(video.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.MediaType)" oper="equal" value="CONST(2)"/>
											<WTIMAGE value="CONST(audio.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="DATA(SessionLesson.Quiz)" oper="greater" value="CONST(1)"/>
											<WTIMAGE value="CONST(quiz.gif)" imgalign="absmiddle"/>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" merge="2"/>
									<WTSTATIC col="3" merge="5" value="DATA(SessionLesson.Description)"/>
								</WTROW>
							</WTRECORDSET>
						</WTROW>

						<WTROW margin-top="12" margin-bottom="12">
							<WTCONDITION expr="PARAM(SessionID)" oper="greater" value="CONST(0)"/>
							<WTBUTTON col="1" merge="2" action="2" value="CONST(ReturnClasses)" align="center">
								<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)" />
							</WTBUTTON>
							<WTBUTTON col="1" merge="2" value="CONST(FinalExam)" align="center">
								<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="SYSCON(SESSION-COMPLETED)"/>
								<WTCONDITION expr="ATTR(Course.ExamID)" oper="not-equal" value="CONST(0)" connector="and"/>
								<WTCLICK>FinalExam()</WTCLICK>
							</WTBUTTON>
<!--							
							<WTBUTTON col="1" merge="2" action="4" value="CONST(PrintCertificate)" align="center">
								<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="SYSCON(SESSION-COMPLETED)"/>
								<WTCONDITION expr="ATTR(Course.NoCertificate)" oper="equal" value="CONST(0)" connector="and" paren="start"/>
								<WTCONDITION expr="NotMemberOnly" connector="or" paren="end"/>
							</WTBUTTON>
-->							
							<WTBUTTON col="1" merge="2" action="5" value="CONST(Evaluation)" align="center">
								<WTCONDITION expr="ATTR(Session.Status)" oper="greater-equal" value="SYSCON(SESSION-COMPLETED)"/>
								<WTCONDITION expr="ATTR(Course.NoEvaluation)" oper="equal" value="CONST(0)" connector="and"/>
							</WTBUTTON>
<!--              
							<WTBUTTON col="1" merge="2" action="6" value="CONST(Remove)" align="center" msg="ConfirmRemove">
								<WTCONDITION expr="ATTR(Session.QuizLimit)" oper="equal" value="CONST(0)"/>
								<WTCONDITION expr="ATTR(Session.IsInactive)" oper="equal" value="CONST(0)" connector="and"/>
							</WTBUTTON>
-->
              <WTBUTTON col="1" merge="2" value="CONST(Close)">
								<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)" />
								<WTCLICK>window.close()</WTCLICK>
							</WTBUTTON>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTCONDITION expr="IsMemberOnly"/>
							<WTCONDITION expr="PARAM(SessionID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTBUTTON col="1" merge="2" action="3" value="CONST(Return)" align="center"/>
						</WTROW>

						<WTROW>
							<WTSTATIC col="1" value="CONST(LEGEND)" bold="true"/>
						</WTROW>
						<WTROW margin-bottom="2">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="2">
							<WTSTATIC col="1" merge="2" align="center">
								<WTCODEGROUP>
									<!--							<WTIMAGE value="CONST(lesson_status0.gif)" imgalign="absmiddle"/>-->
									<!--							<WTSTATIC value="CONST(not started)" space="1"/>-->
									<WTIMAGE value="CONST(lesson_status1.gif)" imgalign="absmiddle"/>
									<WTSTATIC value="CONST(started)" space="1"/>
									<WTIMAGE value="CONST(lesson_status2.gif)" imgalign="absmiddle"/>
									<WTSTATIC value="CONST(completed)" space="1"/>
									<WTIMAGE value="CONST(lesson_status3.gif)" imgalign="absmiddle"/>
									<WTSTATIC value="CONST(failed)" space="1"/>
									<WTIMAGE value="CONST(lesson_status4.gif)" imgalign="absmiddle"/>
									<WTSTATIC value="CONST(passed)" space="1"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="2">
							<WTSTATIC col="1" merge="2" align="center">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(video.gif)" imgalign="absmiddle"/>
									<WTSTATIC value="CONST(video)" space="1"/>
									<WTIMAGE value="CONST(audio.gif)" imgalign="absmiddle"/>
									<WTSTATIC value="CONST(audio)" space="1"/>
									<WTIMAGE value="CONST(quiz.gif)" imgalign="absmiddle"/>
									<WTSTATIC value="CONST(quiz)" space="1"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW margin-bottom="6">
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Course.Status)" oper="not-equal" value="CONST(3)"/>
						<WTROW margin-bottom="12" margin-top="12">
							<WTSTATIC col="1" merge="2" label="Inactive" align="center" class="pageheading"/>
						</WTROW>
						<WTROW>
							<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTBUTTON col="1" merge="2" action="2" value="CONST(ReturnClasses)" align="center"/>
						</WTROW>
					</WTCODEGROUP>

				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(SessionID)" oper="less" value="CONST(0)" />
					<WTROW margin-top="24" margin-bottom="12">
						<WTSTATIC col="1" merge="2" label="NotPrerequisite" class="PageHeading" align="center"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="1338" caption="Print Certificate" header="false" footer="false" wrapper="wrapper600"
			   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" >
		<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="StudentName" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(StudentName)" value="ATTR(StudentName)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

      <WTACTION name="Print" type="Print" id="1">
        <WTSETATTRIBUTE name="PARAM(StudentName)" value="FORM(StudentName)"/>
        <WTSETATTRIBUTE name="CONST(tmpStatus)" value="FORM(Status)"/>
        <WTRETURN>
          <WTLINK name="1339" return="false">
            <WTPARAM name="SessionID" value="PARAM(SessionID)"/>
            <WTPARAM name="StudentName" value="PARAM(StudentName)"/>
            <WTPARAM name="Status" value="CONST(tmpStatus)"/>
            <WTPARAM name="SysLanguage" value="CONST(&quot;en&quot;)"/>
          </WTLINK>
        </WTRETURN>
      </WTACTION>

      <WTACTION name="PrintES" type="Print" id="2">
        <WTSETATTRIBUTE name="PARAM(StudentName)" value="FORM(StudentName)"/>
        <WTSETATTRIBUTE name="CONST(tmpStatus)" value="FORM(Status)"/>
        <WTRETURN>
          <WTLINK name="1339" return="false">
            <WTPARAM name="SessionID" value="PARAM(SessionID)"/>
            <WTPARAM name="StudentName" value="PARAM(StudentName)"/>
            <WTPARAM name="Status" value="CONST(tmpStatus)"/>
            <WTPARAM name="SysLanguage" value="CONST(&quot;es&quot;)"/>
          </WTLINK>
        </WTRETURN>
      </WTACTION>

      <!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Session.Status)"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Session.Status)" oper="equal" value="CONST(7)"/>
					<WTSTATIC col="1" merge="2" label="PrintCertification" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="ATTR(Session.Status)" oper="less" value="CONST(7)"/>
					<WTSTATIC col="1" merge="2" label="PrintParticipation" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				
				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="PrintingInstructions" class="Prompt" align="left"/>
				</WTROW>
<!--
				<WTROW margin-bottom="12">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
-->
        <WTROW margin-bottom="6">
          <WTSTATIC col="1" merge="2" tag="CertificateName" align="center"/>
          <WTTEXT col="1" name="StudentName" value="PARAM(StudentName)" size="40"/>
        </WTROW>
        <WTROW margin-bottom="12">
          <WTBUTTON col="1" merge="2" align="center" action="1" value="CONST(PrintCertificate)"/>
          <WTBUTTON col="1" align="center" action="2" value="CONST(PrintCertificateES)"/>
        </WTROW>

        <WTROW margin-bottom="24">
					<WTSTATIC col="1" merge="2" label="PrintingInstructions2" class="Prompt" align="left"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>
					
		<!--=============================================================================================-->
		<WTWEBPAGE name="1339" caption="Print Certificate" header="false" footer="false" wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" print="PARAM(PrintURL)" focus="false" >
		<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="StudentName" datatype="text"/>
			<WTPARAM name="PrintURL" datatype="text"/>
			<WTPARAM name="Status" datatype="number"/>

			<WTACTION name="New" type="New" id="0">
<WTCUSTOM>
			reqPrintURL = "1340.asp?SessionID=" + CStr(reqSessionID) + "&amp;StudentName=" + CStr(reqStudentName)
</WTCUSTOM>				
			</WTACTION>

			<WTACTION name="Continue" type="Continue" id="1">
				<WTRETURN>
					<WTLINK name="1330" return="false">
						<WTPARAM name="SessionID" value="PARAM(SessionID)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>

				<WTLOAD>
						document.factory.printing.header = "";
						document.factory.printing.footer = "";
						document.factory.printing.portrait = false;
						document.factory.printing.leftMargin = 0.5;
						document.factory.printing.topMargin = 0.5;
						document.factory.printing.rightMargin = 0.5;
						document.factory.printing.bottomMargin = 0.5;
						document.factory.printing.Print();
				</WTLOAD>
				<WTFUNCTION name="ViewCertificate(lang)">
					var url = "1340.asp?sessionid=" + document.getElementById('SessionID').value + "&amp;studentname=" + document.getElementById('StudentName').value;
          if( lang != 'en' ) { url = url + "&amp;syslanguage=" + lang; }
		      var win = window.open(url,"Certificate");
					win.focus();
				</WTFUNCTION>

				<WTROW>
					<WTHIDDEN value="PARAM(SessionID)"/>
					<WTHIDDEN value="PARAM(StudentName)"/>
				</WTROW>

				<WTROW margin-top="48" margin-bottom="48">
					<WTCONDITION expr="PARAM(Status)" oper="less" value="CONST(7)"/>
					<WTSTATIC col="1" label="PrintingCert1" class="PageHeading"/>
				</WTROW>
				<WTROW margin-top="48" margin-bottom="48">
					<WTCONDITION expr="PARAM(Status)" oper="equal" value="CONST(7)"/>
					<WTSTATIC col="1" label="PrintingCert2" class="PageHeading"/>
				</WTROW>
				
				<WTROW margin-bottom="48">
					<WTBUTTON col="1" align="center" action="1" value="CONST(ReturnClass)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" merge="2" label="PrintingInstructions3" align="left" fontcolor="red"/>
				</WTROW>
				
				<WTROW margin-bottom="12">
          <WTBUTTON col="1" align="center" action="1" value="CONST(PreviewCertificate)">
            <WTCLICK>ViewCertificate('en')</WTCLICK>
          </WTBUTTON>
          <WTBUTTON col="1" align="center" action="1" value="CONST(PreviewCertificateES)">
            <WTCLICK>ViewCertificate('es')</WTCLICK>
          </WTBUTTON>
        </WTROW>

				<WTROW>
<!--					<WTAPPLET col="1" style="display:none" classid="clsid:1663ed61-23eb-11d2-b92f-008048fdd814" codebase="CONST(http://www.meadroid.com/scriptx/sx6243314.cab#Version=6,2,433,14)" id="factory"/>-->
<!--					<WTAPPLET col="1" style="display:none" classid="clsid:1663ed61-23eb-11d2-b92f-008048fdd814" codebase="CONST(http://www.meadroid.com/scriptx/smsx.cab#Version=6,3,435,20)" id="factory"/>-->
					<WTAPPLET col="1" style="display:none" classid="clsid:1663ed61-23eb-11d2-b92f-008048fdd814" codebase="CONST(smsx.cab#Version=6,3,435,20)" id="factory" viewastext="1"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
					
		<!--=============================================================================================-->
		<WTWEBPAGE name="1340" caption="Certificate" header="false" footer="false" navbar="false" 
		aspstyle="GenerateWebASP.xsl" focus="false" langfile="1340">
		<!--=============================================================================================-->
			<WTPARAM name="SessionID" datatype="number"/>
			<WTPARAM name="StudentName" datatype="text"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Status" datatype="number"/>
			<WTPARAM name="Day" datatype="text"/>
			<WTPARAM name="Month" datatype="number"/>
			<WTPARAM name="Year" datatype="number"/>
			<WTPARAM name="Header" datatype="text"/>
			<WTPARAM name="Signature" datatype="text"/>

			<WTACTION name="New" type="New" id="0">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="Load">
						<WTPARAM name="SessionID" direction="input" value="PARAM(SessionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Status)" value="ATTR(Status)"/>
					<WTSETATTRIBUTE name="CONST(tmpCourseID)" value="ATTR(CourseID)"/>
					<WTSETATTRIBUTE name="CONST(tmpMemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSession" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(tmpMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
				</WTOBJECT>
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="CONST(tmpCourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			<WTCODEGROUP>
<WTCUSTOM>
	today = Date()
	Select Case Day(today)
	Case 1: reqDay = CStr(Day(today)) + "st"
	Case 2: reqDay = CStr(Day(today)) + "nd"
	Case 3: reqDay = CStr(Day(today)) + "rd"
	Case Else: reqDay = CStr(Day(today)) + "th"
	End Select
	reqMonth = CStr(Month(today))
	reqYear = CStr(Year(today))

	reqHeader = ""
	reqSignature = ""
	GroupID = Numeric(GetCache("GROUPID"))

	Set oFileSys = CreateObject("Scripting.FileSystemObject")
	If GroupID &gt; 0 Then
		FileName = "Images\Company\" + CStr(reqCompanyID) + "\CertificateHeader" + CStr(GroupID) + ".gif"
		FilePath = Request.ServerVariables("APPL_PHYSICAL_PATH") + FileName
		Exists = oFileSys.FileExists(FilePath)
		If Exists Then reqHeader = FileName
	End If
	If reqHeader = "" Then
		FileName = "Images\Company\" + CStr(reqCompanyID) + "\CertificateHeader.gif"
		FilePath = Request.ServerVariables("APPL_PHYSICAL_PATH") + FileName
		Exists = oFileSys.FileExists(FilePath)
		If Exists Then reqHeader = FileName
	End If
	If reqHeader = "" Then reqHeader = "Images/CertificateHeader.gif"

	If GroupID &gt; 0 Then
		FileName = "Images\Company\" + CStr(reqCompanyID) + "\Signature" + CStr(GroupID) + ".gif"
		FilePath = Request.ServerVariables("APPL_PHYSICAL_PATH") + FileName
		Exists = oFileSys.FileExists(FilePath)
		If Exists Then reqSignature = FileName
	End If
	If reqSignature = "" Then
		FileName = "Images\Company\" + CStr(reqCompanyID) + "\Signature.gif"
		FilePath = Request.ServerVariables("APPL_PHYSICAL_PATH") + FileName
		Exists = oFileSys.FileExists(FilePath)
		If Exists Then reqSignature = FileName
	End If
	If reqSignature = "" Then reqSignature = "Images/Signature.gif"
	Set oFileSys = Nothing
</WTCUSTOM>
			</WTCODEGROUP>
			
			</WTACTION>

	 		<!--*******************************************************************************************-->
			<WTCONTENT/>
				<WTSTATIC label="Certification"/>
				<WTSTATIC label="Completion"/>
				<WTSTATIC label="Certify"/>
				<WTSTATIC label="Completed"/>
				<WTSTATIC label="Presented"/>
				<WTSTATIC label="DayOf"/>
				<WTSTATIC label="1"/>
				<WTSTATIC label="2"/>
				<WTSTATIC label="3"/>
				<WTSTATIC label="4"/>
				<WTSTATIC label="5"/>
				<WTSTATIC label="6"/>
				<WTSTATIC label="7"/>
				<WTSTATIC label="8"/>
				<WTSTATIC label="9"/>
				<WTSTATIC label="10"/>
				<WTSTATIC label="11"/>
				<WTSTATIC label="12"/>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="1360" caption="Folder Report" form="Report" navbar="false"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="1360" language="false">
		<!--==================================================================-->
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="EnrollDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="Members" datatype="number"/>
			  
			<WTSUB name="LoadOrg">
				<WTOBJECT name="Org" project="ptsOrgUser" class="COrg">
					<WTMETHOD name="Load">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlOrg" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="ATTR(EnrollDate)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCompany" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>
			
			<WTSUB name="LoadReport">
				<WTOBJECT name="Session" project="ptsSessionUser" class="CSession">
					<WTMETHOD name="MemberAccess">
						<WTPARAM name="reqMembers" direction="return" datatype="number"/>
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ReportOrg">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
<WTCUSTOM>
				tmpCourseName = ""
				tmpTotal = 0
				For Each oSession in oSessions
					With oSession
						If reqMembers &gt; 0 Then .Time = FormatPercent(CLng(.Quantity) / CLng(reqMembers))
						If tmpCourseName = .CourseName Then
							tmpCourseName = .CourseName
							.CourseName = ""
							.OCStatus = ""
							tmpTotal = tmpTotal + .Quantity
						Else
							tmpCourseName = .CourseName
							tmpTotal = .Quantity
						End If
					End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/> 
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadOrg"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)"/>
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>
			
			<WTACTION id="1" name="Report" type="Report">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="FORM(FromDate)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="FORM(ToDate)"/>
				<WTCALLSUB name="LoadOrg"/>
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>
			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="right"/>
			
				<WTROW>
					<WTHIDDEN value="PARAM(EnrollDate)"/>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" align="left" tag="FolderReport" value="ATTR(Org.OrgName)" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" label="ReportText" align="left" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" align="center" tag="ReportOn"/>
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="0" label="Membership"/>
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="PrevWeek"/>
						<WTOPTION id="4" label="PrevMonth"/>
						<WTOPTION id="5" label="PrevYear"/>
						<WTOPTION id="6" label="WeekToDate"/>
						<WTOPTION id="7" label="MonthToDate"/>
						<WTOPTION id="8" label="YearToDate"/>
<!--
						<WTOPTION id="9" label="Next7Days"/>
						<WTOPTION id="10" label="Next14Days"/>
						<WTOPTION id="11" label="Next30Days"/>
-->
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "4":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "5":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "7":
							fromdate.setDate(1);
							break;
							case "8":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "9":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "10":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "11":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From"/>
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" tag="To"/>
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8"/>
					<WTBUTTON col="1" action="1" value="CONST(Report)" align="center"/>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONS/PTSSESSION))" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" label="NoCourses" align="center" class="PageHeading"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONS/PTSSESSION))" oper="not-equal" value="CONST(0)"/>
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
							<WTCOLUMN width="50" align="left" valign="top" label="CourseName"/>
							<WTCOLUMN width="15" align="left" valign="top"/>
							<WTCOLUMN width="15" align="left" valign="top" label="Status"/>
							<WTCOLUMN width="10" align="right" valign="top"/>
							<WTCOLUMN width="10" align="right" valign="top"/>
							<WTROW>
								<WTSTATIC col="1">
									<WTSTATIC value="DATA(Session.CourseName)">
										<WTCONDITION expr="DATA(Session.CourseName)" oper="not-equal" value="CONST('')"/>
										<WTLINK name="1362" return="false" target="FolderCourse">
											<WTPARAM name="OrgID" value="PARAM(OrgID)"/>
											<WTPARAM name="CourseID" value="DATA(Session.CourseID)"/>
											<WTPARAM name="FromDate" value="PARAM(FromDate)"/>
											<WTPARAM name="ToDate" value="PARAM(ToDate)"/>
										</WTLINK>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="2">
									<WTSTATIC label="Recommended">
										<WTCONDITION expr="DATA(OCStatus)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
									<WTSTATIC label="Required">
										<WTCONDITION expr="DATA(OCStatus)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
								</WTSTATIC>
								<WTSTATIC col="3" value="DATA(Session.Status)"/>
								<WTSTATIC col="4" value="DATA(Session.Quantity)"/>
								<WTSTATIC col="5" value="DATA(Session.Time)"/>
							</WTROW>
						</WTRECORDSET>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" align="left" tag="TotalMembers" value="PARAM(Members)" class="PageHeading"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="1361" caption="Training Report" form="Report" navbar="false"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="1361" language="false">
		<!--==================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="EnrollDate" datatype="date"/>
			<WTPARAM name="Term" datatype="number"/>
			<WTPARAM name="IsDescription" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			  
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(EnrollDate)" value="ATTR(EnrollDate)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadReport">
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ReportMember">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
<WTCUSTOM>
				For Each oSession in oSessions
				   With oSession
						If Not IsNumeric(.Time) Then .Time = 0
						secs = .Time
						seconds = secs Mod 60 
						minutes = Int(secs / 60 ) Mod 60
						hours = Int(secs / 3600 )
						fmt = ""
						If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
						If minutes &lt; 10 Then fmt = fmt + "0"
						fmt = fmt &amp; minutes &amp; ":"
						If seconds &lt; 10 Then fmt = fmt + "0"
						.Time = fmt &amp; seconds &amp; "(" &amp; FormatNumber(.Times, 1 ) &amp; ")"
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/> 
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadMember"/>
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="PARAM(EnrollDate)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="SYS(date)"/>
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>
			
			<WTACTION id="1" name="Report" type="Report">
				<WTSETATTRIBUTE name="PARAM(FromDate)" value="FORM(FromDate)"/>
				<WTSETATTRIBUTE name="PARAM(ToDate)" value="FORM(ToDate)"/>
				<WTSETATTRIBUTE name="PARAM(IsDescription)" value="FORM(IsDescription)"/>
				<WTCALLSUB name="LoadMember"/>
				<WTCALLSUB name="LoadReport"/>
			</WTACTION>
			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="right"/>
			
				<WTROW>
					<WTHIDDEN value="ATTR(Member.EnrollDate)"/>
				</WTROW>

				<WTROW margin-top="6">
					<WTSTATIC col="1" align="left" tag="MemberReport" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" label="ReportText" align="left" class="prompt"/>
				</WTROW>

				<WTROW margin-bottom="12">
					<WTSTATIC col="1" align="center" tag="ReportOn"/>
					<WTCOMBO col="1" name="Term" align="center" value="PARAM(Term)">
						<WTOPTION id="0" label="Membership"/>
						<WTOPTION id="1" label="Yesterday"/>
						<WTOPTION id="2" label="Today"/>
						<WTOPTION id="3" label="PrevWeek"/>
						<WTOPTION id="4" label="PrevMonth"/>
						<WTOPTION id="5" label="PrevYear"/>
						<WTOPTION id="6" label="WeekToDate"/>
						<WTOPTION id="7" label="MonthToDate"/>
						<WTOPTION id="8" label="YearToDate"/>
<!--
						<WTOPTION id="9" label="Next7Days"/>
						<WTOPTION id="10" label="Next14Days"/>
						<WTOPTION id="11" label="Next30Days"/>
-->
						<WTCHANGE>
							var ONE_DAY = 1000 * 60 * 60 * 24;
							var fromdate = new Date();
							var todate = new Date();
							var term = document.getElementById('Term').value;
							switch(term) {
							case "0":
							document.getElementById('FromDate').value = document.getElementById('EnrollDate').value
							break;
							case "1":
							fromdate.setTime(fromdate.getTime() - ONE_DAY );
							todate = fromdate;
							break;
							case "2":
							break;
							case "3":
							todate.setTime(todate.getTime() - ( todate.getDay() * ONE_DAY ) );
							fromdate.setTime(todate.getTime() - ( 6 * ONE_DAY ) );
							break;
							case "4":
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setDate(1);
							break;
							case "5":
							todate.setMonth(0);
							todate.setDate(1);
							todate.setTime(todate.getTime() - ONE_DAY );
							fromdate.setTime(todate.getTime());
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "6":
							fromdate.setTime(fromdate.getTime() - ( (fromdate.getDay()-1) * ONE_DAY ) );
							break;
							case "7":
							fromdate.setDate(1);
							break;
							case "8":
							fromdate.setMonth(0);
							fromdate.setDate(1);
							break;
							case "9":
							todate.setTime(todate.getTime() + 6 * ONE_DAY );
							break;
							case "10":
							todate.setTime(todate.getTime() + 13 * ONE_DAY );
							break;
							case "11":
							todate.setTime(todate.getTime() + 29 * ONE_DAY );
							break;
							}
							if(term!="0"){document.getElementById('FromDate').value = fromdate.getMonth()+1 + "/" + fromdate.getDate() + "/" + fromdate.getFullYear();}
							document.getElementById('ToDate').value = todate.getMonth()+1 + "/" + todate.getDate() + "/" + todate.getFullYear();
						</WTCHANGE>
					</WTCOMBO>
					<WTSTATIC col="1" align="center" tag="From"/>
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" tag="To"/>
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8"/>
					<WTBUTTON col="1" action="1" value="CONST(Report)" align="center"/>
					<WTCHECK col="1" value="PARAM(IsDescription)" label="IsDescription"/>
				</WTROW>
				<WTROW>
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSSESSIONS/PTSSESSION))" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" label="TakenCompanyCourses" align="left" class="PageHeading"/>
						<WTSTATIC col="1" value="CONST(-)"/>
						<WTLINKGROUP col="1" valign="top">
						   <WTLINK name="1311" label="ViewMyClasses" class="prompt">
						   	<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						   	<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						   </WTLINK>
						</WTLINKGROUP>
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
							<WTCOLUMN width="47" align="left" valign="top" label="CourseName"/>
							<WTCOLUMN width="10" align="left" valign="top" label="Status"/>
							<WTCOLUMN width="10" align="left" valign="top" label="StartDate"/>
							<WTCOLUMN width="10" align="left" valign="top" label="CompleteDate"/>
							<WTCOLUMN width="8" align="center" valign="top" label="Grade"/>
							<WTCOLUMN width="15" align="right" valign="top" label="Time"/>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(OrgCourseID)" oper="greater" value="CONST(0)"/>
								<WTROW>
									<WTSTATIC col="1" value="DATA(Session.CourseName)"/>
									<WTSTATIC col="2" value="DATA(Session.Status)"/>
									<WTSTATIC col="3" value="DATA(Session.StartDate)"/>
									<WTSTATIC col="4" value="DATA(Session.CompleteDate)"/>
									<WTSTATIC col="5" value="DATA(Session.Grade)"/>
									<WTSTATIC col="6" value="DATA(Session.Time)" fontcolor="purple"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" merge="6">
										<WTSTATIC value="DATA(Session.MemberName)" fontcolor="blue" space="2"/>
										<WTSTATIC value="DATA(Session.Feedback)" fontcolor="gray">
											<WTCONDITION expr="PARAM(IsDescription)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
						</WTRECORDSET>
					</WTROW>
					
					<WTROW margin-top="6">
						<WTSTATIC col="1" label="NotTakenCompanyCourses" align="left" class="PageHeading"/>
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
							<WTCOLUMN width="47" align="left" valign="top" label="CourseName"/>
							<WTCOLUMN width="43" align="left" valign="top"/>
							<WTCOLUMN width="10" align="center" valign="top"/>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(OrgCourseID)" oper="equal" value="CONST(-1)"/>
								<WTROW>
									<WTSTATIC col="1" value="DATA(Session.CourseName)"/>
									<WTSTATIC col="2" value="DATA(Session.MemberName)" fontcolor="blue"/>
									<WTSTATIC col="3" label="Register" bold="true">
										<WTLINK name="1120" target="new">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
											<WTPARAM name="CourseID" value="DATA(SessionID)"/>
											<WTPARAM name="OrgCourseID" value="CONST(1)"/>
											<WTPARAM name="Register" value="CONST(1)"/>
										</WTLINK>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTCONDITION expr="PARAM(IsDescription)" oper="equal" value="CONST(1)"/>
									<WTSTATIC  col="1" merge="3" value="DATA(Session.Feedback)" fontcolor="gray"/>
								</WTROW>
							</WTCODEGROUP>
						</WTRECORDSET>
					</WTROW>
					
					<WTROW margin-top="6">
						<WTSTATIC col="1" label="OtherCourses" align="left" class="PageHeading"/>
						<WTSTATIC col="1" value="CONST(-)"/>
						<WTLINKGROUP col="1" valign="top">
						   <WTLINK name="1311" label="ViewMyClasses" class="prompt">
						   	<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
						   	<WTPARAM name="CompanyID" value="PARAM(CompanyID)"/>
						   </WTLINK>
						</WTLINKGROUP>
					</WTROW>
					<WTROW>
						<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
							<WTCOLUMN width="47" align="left" valign="top" label="CourseName"/>
							<WTCOLUMN width="10" align="left" valign="top" label="Status"/>
							<WTCOLUMN width="10" align="left" valign="top" label="StartDate"/>
							<WTCOLUMN width="10" align="left" valign="top" label="CompleteDate"/>
							<WTCOLUMN width="8" align="center" valign="top" label="Grade"/>
							<WTCOLUMN width="15" align="right" valign="top" label="Time"/>
							<WTCODEGROUP>
								<WTCONDITION expr="DATA(OrgCourseID)" oper="equal" value="CONST(0)"/>
								<WTROW>
									<WTSTATIC col="1" value="DATA(Session.CourseName)"/>
									<WTSTATIC col="2" value="DATA(Session.Status)"/>
									<WTSTATIC col="3" value="DATA(Session.StartDate)"/>
									<WTSTATIC col="4" value="DATA(Session.CompleteDate)"/>
									<WTSTATIC col="5" value="DATA(Session.Grade)"/>
									<WTSTATIC col="6" value="DATA(Session.Time)" fontcolor="purple"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" merge="6">
										<WTSTATIC value="DATA(Session.MemberName)" fontcolor="blue" space="2"/>
										<WTSTATIC value="DATA(Session.Feedback)" fontcolor="gray">
											<WTCONDITION expr="PARAM(IsDescription)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
							</WTCODEGROUP>
						</WTRECORDSET>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTSTATIC col="1" merge="2" align="left" tag="TotalCourses" value="CONST(&lt;xsl:value-of select=&quot;count(/DATA/TXN/PTSSESSIONS/PTSSESSION)&quot;/&gt;)" class="PageHeading"/>
					</WTROW>
					
				</WTCODEGROUP>

				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--==================================================================-->
		<WTWEBPAGE name="1362" caption="Folder Course Report" navbar="false"
		 aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="1362" language="false">
		<!--==================================================================-->
			<WTPARAM name="OrgID" datatype="number"/>
			<WTPARAM name="CourseID" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Course" project="ptsCourseUser" class="CCourse">
					<WTMETHOD name="Load">
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlCourse" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Sessions" project="ptsSessionUser" class="CSessions">
					<WTMETHOD name="ReportOrgCourse">
						<WTPARAM name="OrgID" direction="input" value="PARAM(OrgID)"/>
						<WTPARAM name="CourseID" direction="input" value="PARAM(CourseID)"/>
						<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
						<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
					</WTMETHOD>
<WTCUSTOM>
				For Each oSession in oSessions
				   With oSession
						If .Time = 0 Then
							.Time = ""
						Else	
							secs = .Time
							seconds = secs Mod 60 
							minutes = Int(secs / 60 ) Mod 60
							hours = Int(secs / 3600 )
							fmt = ""
							If hours &gt; 0 Then fmt = Int(secs / 3600 ) &amp; ":"
							If minutes &lt; 10 Then fmt = fmt + "0"
							fmt = fmt &amp; minutes &amp; ":"
							If seconds &lt; 10 Then fmt = fmt + "0"
							.Time = fmt &amp; seconds &amp; "(" &amp; FormatNumber(.Times, 1 ) &amp; ")"
						End If
				    End With
				Next
</WTCUSTOM>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlSessions" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(13)"/> 
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="right"/>
			
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(Course.CourseName)" class="PageHeading" align="center"/>
				</WTROW>
				
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" class="BoldText">
						<WTSTATIC value="PARAM(FromDate)"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(ToDate)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTRECORDSET col="1" merge="2" graybar="true" entity="Session">
						<WTCOLUMN width="35" align="left" valign="top" label="StudentName"/>
						<WTCOLUMN width="15" align="center" valign="top" label="Status"/>
						<WTCOLUMN width="12" align="left" valign="top" label="StartDate"/>
						<WTCOLUMN width="12" align="left" valign="top" label="CompleteDate"/>
						<WTCOLUMN width="11" align="left" valign="top" label="Time"/>
						<WTCOLUMN width="15" align="left" valign="top" label="Grade"/>
						<WTROW>
							<WTSTATIC col="1" value="DATA(Session.StudentName)"/>
							<WTSTATIC col="2" value="DATA(Session.Status)"/>
							<WTSTATIC col="3" value="DATA(Session.StartDate)"/>
							<WTSTATIC col="4" value="DATA(Session.CompleteDate)"/>
							<WTSTATIC col="5" value="DATA(Session.Time)"/>
							<WTSTATIC col="6">
								<WTCODEGROUP>
									<WTCONDITION expr="ATTR(Course.PassingGrade)" oper="greater" value="CONST(0)"/>
									<WTCONDITION expr="DATA(Session.Status)" oper="greater" value="CONST(5)" connector="and"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@grade&quot;/&gt;% (&lt;xsl:value-of select=&quot;/DATA/TXN/PTSCOURSE/@passinggrade&quot;/&gt;%))"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>

</WTROOT>