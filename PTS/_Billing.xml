<WTROOT prefix="pts" color="Green" dbo="dbo" >
	<WTENTITY id="29" name="Billing" alias="bil">

		<!--Identity-->
		<WTATTRIBUTE id="2901" name="BillingID" type="number" identity="true" min="1" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="2902" name="CountryID" type="number" source="entity"/>
		
		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="2903" name="CountryName" type="text" length="50" source="join">
			<WTJOIN entity="Country" name="CountryName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2904" name="CountryCode" type="text" length="2" source="join">
			<WTJOIN entity="Country" name="Code"/>
		</WTATTRIBUTE>

		<!--Attributes-->
		<WTATTRIBUTE id="2906" name="TokenType" type="number" source="entity"/>
		<WTATTRIBUTE id="2907" name="TokenOwner" type="number" source="entity"/>
		<WTATTRIBUTE id="2908" name="Token" type="number" source="entity"/>
		<WTATTRIBUTE id="2909" name="Verified" type="number" source="entity"/>
		<WTATTRIBUTE id="2910" name="BillingName" type="text" length="60" min="1" max="60" title="true" source="entity"/>

		<!-- Billing Address-->
		<WTATTRIBUTE id="2911" name="Street1" type="text" length="60" min="1" max="60" source="entity"/>
		<WTATTRIBUTE id="2912" name="Street2" type="text" length="60" min="1" max="60" source="entity"/>
		<WTATTRIBUTE id="2913" name="City" type="text" length="30" min="1" max="30" source="entity"/>
		<WTATTRIBUTE id="2914" name="State" type="text" length="30" min="1"  max="30" source="entity"/>
		<WTATTRIBUTE id="2915" name="Zip" type="text" length="20" min="1"  max="20" source="entity"/>
		
		<!-- Payment Info-->
		<WTATTRIBUTE id="2920" name="PayType" type="number" source="entity">
			<WTENUM id="1" name="CreditCard"/>
			<WTENUM id="2" name="eCheck"/>
			<WTENUM id="3" name="Cash"/>
			<WTENUM id="4" name="eWallet"/>
			<WTENUM id="5" name="NoPay"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2921" name="CommType" type="number" source="entity">
			<WTENUM id="1" name="CreditCard"/>
			<WTENUM id="2" name="eCheck"/>
			<WTENUM id="3" name="Check"/>
			<WTENUM id="4" name="eWallet"/>
			<WTENUM id="5" name="NoComm"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2922" name="CardType" type="number" source="entity">
			<WTENUM id="1" name="Visa"/>
			<WTENUM id="2" name="MasterCard"/>
			<WTENUM id="3" name="Discover"/>
			<WTENUM id="4" name="Amex"/>
      <WTENUM id="10" name="Wallet"/>
      <WTENUM id="11" name="iPayout"/>
      <WTENUM id="12" name="PayQuicker"/>
			<WTENUM id="13" name="SolidTrust"/>
			<WTENUM id="14" name="BitCoin"/>
			<WTENUM id="15" name="CardType15"/>
			<WTENUM id="16" name="CardType16"/>
			<WTENUM id="17" name="CardType17"/>
			<WTENUM id="18" name="CardType18"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2923" name="CardNumber" type="text" length="30" min="1" max="30" source="entity">
			<WTVALIDATE required="true"><WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(1)"/></WTVALIDATE>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2924" name="CardMo" type="number" min="1" max="12" source="entity">
			<WTVALIDATE required="true"><WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(1)"/></WTVALIDATE>
			<WTENUM id="1" name="January"/>
			<WTENUM id="2" name="February"/>
			<WTENUM id="3" name="March"/>
			<WTENUM id="4" name="April"/>
			<WTENUM id="5" name="May"/>
			<WTENUM id="6" name="June"/>
			<WTENUM id="7" name="July"/>
			<WTENUM id="8" name="August"/>
			<WTENUM id="9" name="September"/>
			<WTENUM id="10" name="October"/>
			<WTENUM id="11" name="November"/>
			<WTENUM id="12" name="December"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2925" name="CardYr" type="number" min="2" max="99" source="entity">
			<WTVALIDATE required="true"><WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(1)"/></WTVALIDATE>
			<WTENUM id="13" name="2013"/>
			<WTENUM id="14" name="2014"/>
			<WTENUM id="15" name="2015"/>
			<WTENUM id="16" name="2016"/>
			<WTENUM id="17" name="2017"/>
			<WTENUM id="18" name="2018"/>
			<WTENUM id="19" name="2019"/>
			<WTENUM id="20" name="2020"/>
			<WTENUM id="21" name="2021"/>
			<WTENUM id="22" name="2022"/>
			<WTENUM id="23" name="2023"/>
			<WTENUM id="24" name="2024"/>
      <WTENUM id="25" name="2025"/>
      <WTENUM id="26" name="2026"/>
      <WTENUM id="27" name="2027"/>
      <WTENUM id="28" name="2028"/>
      <WTENUM id="29" name="2029"/>
      <WTENUM id="30" name="2030"/>
      <WTENUM id="31" name="2031"/>
      <WTENUM id="32" name="2032"/>
      <WTENUM id="33" name="2033"/>
      <WTENUM id="34" name="2034"/>
      <WTENUM id="35" name="2035"/>
    </WTATTRIBUTE>
		<WTATTRIBUTE id="2926" name="CardName" type="text" length="50" min="1" max="50" source="entity"/>
		<WTATTRIBUTE id="2927" name="CardCode" type="text" length="10" min="1" max="10" source="entity"/>
		<WTATTRIBUTE id="2928" name="CheckBank" type="text" length="50" min="1" max="50" source="entity">
			<WTVALIDATE required="true"><WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(2)"/><WTCONDITION expr="ATTR(CommType)" oper="equal" value="CONST(1)" connector="or"/></WTVALIDATE>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2929" name="CheckRoute" type="text" length="9" min="9" max="9" source="entity">
			<WTVALIDATE required="true"><WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(2)"/><WTCONDITION expr="ATTR(CommType)" oper="equal" value="CONST(1)" connector="or"/></WTVALIDATE>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2930" name="CheckAccount" type="text" length="20" min="1" max="20" source="entity">
			<WTVALIDATE required="true"><WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(2)"/><WTCONDITION expr="ATTR(CommType)" oper="equal" value="CONST(1)" connector="or"/></WTVALIDATE>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2931" name="CheckAcctType" type="number" source="entity">
			<WTENUM id="1" name="Checking"/>
			<WTENUM id="2" name="Savings"/>
			<WTENUM id="3" name="BusinessChecking"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="2932" name="CheckNumber" type="text" length="6" min="1" max="6" source="entity"/>
		<WTATTRIBUTE id="2933" name="CheckName" type="text" length="50" min="1" max="50" source="entity"/>
		<WTATTRIBUTE id="2934" name="UpdatedDate" type="date" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="2996" name="CompanyID" type="number" source="entity" persist="false"/>	
		<WTATTRIBUTE id="2997" name="CommDate" type="date" source="entity" persist="false"/>	
		<WTATTRIBUTE id="2998" name="Amount" type="currency" source="entity" persist="false"/>
		<WTATTRIBUTE id="2999" name="Memo" type="text" length="100" source="entity" persist="false"/>

		<!--Indexes-->

		<!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Billing" entity="Billing" alias="bil"/>
			<WTRELATIONSHIP name="Common" entity="Billing" alias="bil">
				<WTENTITY name="Country" entity="Country" alias="cou">
					<WTATTRIBUTE alias="bil" name="CountryID" relalias="cou" relname="CountryID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="PAYTYPE-CREDITCARD" value="1"/>
			<WTSYSCON name="PAYTYPE-CHECK" value="2"/>
			<WTSYSCON name="PAYTYPE-WALLET" value="4"/>
      <WTSYSCON name="COMMTYPE-WALLET" value="4"/>
    </WTSYSCONS>
	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl" template="new">
			<WTDECLARE name="NewID" datatype="number"/>
			<WTSETVALUE name="PARAM(UpdatedDate)" value="SYS(timestamp)"/>
			<WTCODEGROUP>
				<WTINSERT/>
				<WTSETVALUE name="NewID" value="SYS(identity)"/>
				<WTSETVALUE name="PARAM(BillingID)" value="NewID"/>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<!--==================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl" template="new">
			<WTSETVALUE name="PARAM(UpdatedDate)" value="SYS(timestamp)"/>
			<WTCODEGROUP>
				<WTUPDATE>
					<WTJOIN name="Billing" lock="true"/>
					<WTCONDITION expr="ATTR(Billing.BillingID)" oper="equal" value="PARAM(BillingID)"/>
				</WTUPDATE>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="CommeCheck" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(CommDate)" direction="input"/>
			<WTPARAM name="ATTR(Amount)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Billing.BillingID)"/>
					<WTATTRIBUTE value="ATTR(Billing.BillingName)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckBank)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckRoute)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckAccount)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckAcctType)"/>
					<WTATTRIBUTE value="ATTR(Billing.CommDate)"/>
					<WTATTRIBUTE value="ATTR(Billing.Amount)"/>
					<WTATTRIBUTE value="ATTR(Billing.Memo)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="CommpCheck" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(CommDate)" direction="input"/>
			<WTPARAM name="ATTR(Amount)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Billing.BillingID)"/>
					<WTATTRIBUTE value="ATTR(Billing.BillingName)"/>
					<WTATTRIBUTE value="ATTR(Billing.Street1)"/>
					<WTATTRIBUTE value="ATTR(Billing.Street2)"/>
					<WTATTRIBUTE value="ATTR(Billing.City)"/>
					<WTATTRIBUTE value="ATTR(Billing.State)"/>
					<WTATTRIBUTE value="ATTR(Billing.Zip)"/>
					<WTATTRIBUTE value="ATTR(Billing.CountryName)"/>
					<WTATTRIBUTE value="ATTR(Billing.CommDate)"/>
					<WTATTRIBUTE value="ATTR(Billing.Amount)"/>
					<WTATTRIBUTE value="ATTR(Billing.Memo)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="CommWallet" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(CommDate)" direction="input"/>
			<WTPARAM name="ATTR(Amount)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Billing.BillingID)"/>
					<WTATTRIBUTE value="ATTR(Billing.BillingName)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardType)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardName)"/>
					<WTATTRIBUTE value="ATTR(Billing.CountryName)"/>
					<WTATTRIBUTE value="ATTR(Billing.Amount)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="CommCC" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(CommDate)" direction="input"/>
			<WTPARAM name="ATTR(Amount)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Billing.BillingID)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardType)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardNumber)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardMo)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardYr)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardName)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardCode)"/>
					<WTATTRIBUTE value="ATTR(Billing.CommDate)"/>
					<WTATTRIBUTE value="ATTR(Billing.Amount)"/>
					<WTATTRIBUTE value="ATTR(Billing.Memo)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
		<!--================================================================================================-->
		<WTPROCEDURE type="List" name="Custom" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(CompanyID)" direction="input"/>
			<WTPARAM name="ATTR(Token)" direction="input"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(Billing.BillingID)"/>
					<WTATTRIBUTE value="ATTR(Billing.CountryID)"/>
					<WTATTRIBUTE value="ATTR(Billing.TokenType)"/>
					<WTATTRIBUTE value="ATTR(Billing.TokenOwner)"/>
					<WTATTRIBUTE value="ATTR(Billing.Token)"/>
					<WTATTRIBUTE value="ATTR(Billing.Verified)"/>
					<WTATTRIBUTE value="ATTR(Billing.BillingName)"/>
					<WTATTRIBUTE value="ATTR(Billing.Street1)"/>
					<WTATTRIBUTE value="ATTR(Billing.Street2)"/>
					<WTATTRIBUTE value="ATTR(Billing.City)"/>
					<WTATTRIBUTE value="ATTR(Billing.State)"/>
					<WTATTRIBUTE value="ATTR(Billing.Zip)"/>
					<WTATTRIBUTE value="ATTR(Billing.PayType)"/>
					<WTATTRIBUTE value="ATTR(Billing.CommType)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardType)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardNumber)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardMo)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardYr)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardName)"/>
					<WTATTRIBUTE value="ATTR(Billing.CardCode)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckBank)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckRoute)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckAccount)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckAcctType)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckNumber)"/>
					<WTATTRIBUTE value="ATTR(Billing.CheckName)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
		<!--===============================================================================-->
		<WTWEBPAGE name="2902" navbar="blank" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" 
		contentpage="true" cache="false" focus="false">
		<!--===============================================================================-->
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="TrialDays" datatype="number"/>
			<WTPARAM name="NextURL" datatype="text" url="true"/>
			<WTPARAM name="AutoShip" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="WalletType" datatype="number" />
			<WTPARAM name="WalletName" datatype="text" />

			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(TrialDays)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;trialbilling.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB function="GoNext(txn)">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NextURL)" oper="not-equal" value="SYSCON(NOSTR)"/>
<WTCUSTOM>
			If InStr(reqNextURL, "?") = 0 Then
				reqNextURL = reqNextURL + "?" 
			Else
				reqNextURL = reqNextURL + "&amp;"
			End If	
			reqNextURL = reqNextURL + "txn=" + CStr(txn)
         Response.Redirect Replace(reqNextURL, "%26", "&amp;")
</WTCUSTOM>
				</WTCODEGROUP>
				<WTRETURN>
					<WTCONDITION expr="PARAM(NextURL)" oper="equal" value="SYSCON(NOSTR)"/>
				</WTRETURN>
			</WTSUB>

			<WTSUB name="LoadBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(TrialDays)" value="ATTR(TrialDays)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="ATTR(CompanyName)"/>
					<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(ConfLine)"/>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpCompanyName)"/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ReloadBilling">
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<!-- Validate Card Number or Check Routing Number -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardType)" value="FORM(CardType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpCardType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
<!-- NEED TO GET COMPANY PAYMENT OPTIONS PARAMETER
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(1)" />
						<WTCONDITION expr="NotPaymentVisa" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(2)" />
						<WTCONDITION expr="NotPaymentMC" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(3)" />
						<WTCONDITION expr="NotPaymentDiscover" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(4)" />
						<WTCONDITION expr="NotPaymentAmex" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
-->					
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
	 				<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CheckAcctType)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="PARAM(WalletType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="PARAM(WalletName)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="tmpBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<!-- Create Token -->
          <WTCODEGROUP>
             <WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)" connector="and"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
             <WTCALLSUB name=".Token = SetVault( reqCompanyID, tmpBillingID )"/>
          </WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
	 				<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(tmpBillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="CONST(tmpBillingID)"/>
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="ReloadBilling"/>
					<WTCALLSUB name="LoadList"/>
				</WTCODEGROUP>

				<WTCALLSUB name="GoNext(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTCALLSUB name="GoNext(0)"/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(TrialDays)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
          var countryid = document.getElementById('CountryID').value;
          var paytype = document.getElementById('PayType').value;
          var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
          if (paytype == 2) {
          if ( countryid != 224 ) {
          paytype = 1;
          document.getElementById('PayType').value = paytype;
          alert("Electronic Checks not available outside the United States");
          }
          }
          if (paytype == 1) VisibleCard = '';
          if (paytype == 2) VisibleCheck = '';
          if (paytype == 4) VisibleWallet = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          ToggleWalletType();
        </WTFUNCTION>
        <WTFUNCTION name="ToggleWalletType()">
          var wallettype = document.getElementById('WalletType').value;
          var VisibleWallet = '';
          if (wallettype == 10) VisibleWallet = 'none';
          document.getElementById('WalletNameRow').style.display = VisibleWallet;
        </WTFUNCTION>
        <WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" label="Billing" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(TrialDays)" oper="greater" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(AutoShip)" oper="equal" value="CONST(0)" connector="and"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTROW>
					<WTSTATIC col="1" tag="BillingName"/>
					<WTTEXT col="2" value="ATTR(Billing.BillingName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="25"/>
					<WTTEXT col="2" value="ATTR(Billing.State)" width="240" label="State" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10"/>
					<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="PayType"/>
					<WTCOMBO col="2" value="ATTR(Billing.PayType)">
						<WTOPTION id="1" label="CreditCard">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentVisa" connector="or"/>
							<WTCONDITION expr="_IsPaymentMC" connector="or"/>
						</WTOPTION>
						<WTOPTION id="2" label="eCheck">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCheck" connector="or"/>
						</WTOPTION>
						<WTOPTION id="3" label="Cash">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCash" connector="or"/>
						</WTOPTION>
						<WTOPTION id="4" label="eWallet">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymenteWallet" connector="or"/>
						</WTOPTION>
						<WTOPTION id="5" label="NoPay">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTOPTION>
							<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW id="WalletRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="WalletText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletType"/>
							<WTCOMBO col="2" value="PARAM(WalletType)" required="true">
								<WTOPTION id="11" label="iPayout">
									<WTCONDITION expr="_IsPaymentiPayout"/>
								</WTOPTION>
								<WTOPTION id="12" label="PayQuicker">
									<WTCONDITION expr="_IsPaymentPayQuicker"/>
								</WTOPTION>
								<WTOPTION id="13" label="SolidTrust">
									<WTCONDITION expr="_IsPaymentSolidTrust"/>
								</WTOPTION>
								<WTOPTION id="14" label="BitCoin">
									<WTCONDITION expr="_IsPaymentBitCoin"/>
								</WTOPTION>
                <WTOPTION id="15" label="BitCoinCash">
                  <WTCONDITION expr="_IsPaymentBitCoinCash"/>
                </WTOPTION>
                <WTOPTION id="16" label="Nexxus">
                  <WTCONDITION expr="_IsPaymentNexxus"/>
                </WTOPTION>
                <WTOPTION id="10" label="Wallet">
                  <WTCONDITION expr="_IsPaymentWallet"/>
                </WTOPTION>
                <WTCHANGE>ToggleWalletType();</WTCHANGE>
              </WTCOMBO>
						</WTROW>
            <WTROW id="WalletNameRow">
              <WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="PARAM(WalletName)" required="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CardRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CardText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardType)" required="true">
								<WTOPTION id="1" label="Visa">
									<WTCONDITION expr="_IsPaymentVisa"/>
								</WTOPTION>
								<WTOPTION id="2" label="MasterCard">
									<WTCONDITION expr="_IsPaymentMC"/>
								</WTOPTION>
								<WTOPTION id="3" label="Discover">
									<WTCONDITION expr="_IsPaymentDiscover"/>
								</WTOPTION>
								<WTOPTION id="4" label="Amex">
									<WTCONDITION expr="_IsPaymentAmex"/>
								</WTOPTION>
							</WTCOMBO>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)" required="true"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)" required="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CheckRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CheckText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckBank)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
						</WTROW>
<!--
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
						</WTROW>
-->						
						<WTROW>
							<WTIMAGE col="1" merge="2" align="center" value="CONST(checkref.gif)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" action="2" value="CONST(Submit)">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="m_2902" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" cache="false" focus="false" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" mobile="MobileHome.asp" secured="98">
			<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="TrialDays" datatype="number"/>
			<WTPARAM name="NextURL" datatype="text" url="true"/>
			<WTPARAM name="AutoShip" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="WalletType" datatype="number" />
			<WTPARAM name="WalletName" datatype="text" />

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
<!--
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTCONDITION expr="PARAM(TrialDays)" oper="not-equal" value="CONST(0)"/>
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;trialbilling.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
-->				
			</WTSUB>

			<WTSUB function="GoNext(txn)">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NextURL)" oper="not-equal" value="SYSCON(NOSTR)"/>
					<WTCUSTOM>
						If InStr(reqNextURL, "?") = 0 Then
						reqNextURL = reqNextURL + "?"
						Else
						reqNextURL = reqNextURL + "&amp;"
						End If
						reqNextURL = reqNextURL + "txn=" + CStr(txn)
						Response.Redirect Replace(reqNextURL, "%26", "&amp;")
					</WTCUSTOM>
				</WTCODEGROUP>
				<WTRETURN>
					<WTCONDITION expr="PARAM(NextURL)" oper="equal" value="SYSCON(NOSTR)"/>
				</WTRETURN>
			</WTSUB>

			<WTSUB name="LoadBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(TrialDays)" value="ATTR(TrialDays)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="ATTR(CompanyName)"/>
					<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(ConfLine)"/>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpCompanyName)"/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ReloadBilling">
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<!-- Validate Card Number or Check Routing Number -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardType)" value="FORM(CardType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpCardType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CheckAcctType)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="PARAM(WalletType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="PARAM(WalletName)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="tmpBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(tmpBillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="CONST(tmpBillingID)"/>
					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="ReloadBilling"/>
					<WTCALLSUB name="LoadList"/>
				</WTCODEGROUP>

				<WTCALLSUB name="GoNext(1)">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTCALLSUB name="GoNext(0)"/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="30" align="right"/>
				<WTCOLUMN width="70" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(TrialDays)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
          var countryid = document.getElementById('CountryID').value;
          var paytype = document.getElementById('PayType').value;
          var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
          if (paytype == 2) {
          if ( countryid != 224 ) {
          paytype = 1;
          document.getElementById('PayType').value = paytype;
          alert("Electronic Checks not available outside the United States");
          }
          }
          if (paytype == 1) VisibleCard = '';
          if (paytype == 2) VisibleCheck = '';
          if (paytype == 4) VisibleWallet = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          ToggleWalletType();
        </WTFUNCTION>
        <WTFUNCTION name="ToggleWalletType()">
          var wallettype = document.getElementById('WalletType').value;
          var VisibleWallet = '';
          if (wallettype == 10) VisibleWallet = 'none';
          document.getElementById('WalletNameRow').style.display = VisibleWallet;
        </WTFUNCTION>
        <WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" label="Billing" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
<!--
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(TrialDays)" oper="greater" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(AutoShip)" oper="equal" value="CONST(0)" connector="and"/>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="left" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
					</WTROW>
				</WTCODEGROUP>
-->
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="BillingName"/>
					<WTTEXT col="2" value="ATTR(Billing.BillingName)" size="30"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Billing.Street1)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Street2)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.City)" width="100" label="City" size="12"/>
					<WTTEXT col="2" value="ATTR(Billing.State)" width="110" label="State" size="14"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Zip)" width="210" label="Zip" size="10"/>
				</WTROW>
				<WTROW>
					<WTCOMBO col="1" merge="2" value="ATTR(Billing.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="PayType"/>
					<WTCOMBO col="2" value="ATTR(Billing.PayType)">
						<WTOPTION id="1" label="CreditCard">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentVisa" connector="or"/>
							<WTCONDITION expr="_IsPaymentMC" connector="or"/>
						</WTOPTION>
						<WTOPTION id="2" label="eCheck">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCheck" connector="or"/>
						</WTOPTION>
						<WTOPTION id="3" label="Cash">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCash" connector="or"/>
						</WTOPTION>
						<WTOPTION id="4" label="eWallet">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymenteWallet" connector="or"/>
						</WTOPTION>
						<WTOPTION id="5" label="NoPay">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTOPTION>
						<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW id="WalletRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="35" align="right"/>
						<WTCOLUMN width="65" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="WalletType"/>
							<WTCOMBO col="2" value="PARAM(WalletType)" required="true">
								<WTOPTION id="11" label="iPayout">
									<WTCONDITION expr="_IsPaymentiPayout"/>
								</WTOPTION>
								<WTOPTION id="12" label="PayQuicker">
									<WTCONDITION expr="_IsPaymentPayQuicker"/>
								</WTOPTION>
								<WTOPTION id="13" label="SolidTrust">
									<WTCONDITION expr="_IsPaymentSolidTrust"/>
								</WTOPTION>
								<WTOPTION id="14" label="BitCoin">
									<WTCONDITION expr="_IsPaymentBitCoin"/>
								</WTOPTION>
                <WTOPTION id="15" label="BitCoinCash">
                  <WTCONDITION expr="_IsPaymentBitCoinCash"/>
                </WTOPTION>
                <WTOPTION id="16" label="Nexxus">
                  <WTCONDITION expr="_IsPaymentNexxus"/>
                </WTOPTION>
                <WTOPTION id="10" label="Wallet">
                  <WTCONDITION expr="_IsPaymentWallet"/>
                </WTOPTION>
                <WTCHANGE>ToggleWalletType();</WTCHANGE>
              </WTCOMBO>
						</WTROW>
            <WTROW id="WalletNameRow" margin-bottom="3">
              <WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="PARAM(WalletName)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CardRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="35" align="right"/>
						<WTCOLUMN width="65" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardType)">
								<WTOPTION id="1" label="Visa">
									<WTCONDITION expr="_IsPaymentVisa"/>
								</WTOPTION>
								<WTOPTION id="2" label="MasterCard">
									<WTCONDITION expr="_IsPaymentMC"/>
								</WTOPTION>
								<WTOPTION id="3" label="Discover">
									<WTCONDITION expr="_IsPaymentDiscover"/>
								</WTOPTION>
								<WTOPTION id="4" label="Amex">
									<WTCONDITION expr="_IsPaymentAmex"/>
								</WTOPTION>
							</WTCOMBO>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CheckRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="35" align="right"/>
						<WTCOLUMN width="65" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckName"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" />
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTTOOLTIP>
										<WTIMAGE value="CONST(SymbolHelp.gif)"/>
										<WTTIP>
											<WTIMAGE value="CONST(checkref.gif)"/>
										</WTTIP>
									</WTTOOLTIP>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTTOOLTIP>
										<WTIMAGE value="CONST(SymbolHelp.gif)"/>
										<WTTIP>
											<WTIMAGE value="CONST(checkref.gif)"/>
										</WTTIP>
									</WTTOOLTIP>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Submit)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="2902a" navbar="false" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" 
		contentpage="true" cache="false" focus="false">
		<!--===============================================================================-->
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="TrialDays" datatype="number"/>
			<WTPARAM name="AutoShip" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="WalletType" datatype="number" />
			<WTPARAM name="WalletName" datatype="text" />
			<!-- CHECK FOR ILLEGAL ACCESS -->

			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)"/>
			</WTCODEGROUP>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Billing.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(TrialDays)" value="ATTR(TrialDays)"/>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="ATTR(CompanyName)"/>
					<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(ConfLine)"/>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpCompanyName)"/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ReloadBilling">
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<!-- Validate Card Number or Check Routing Number -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardType)" value="FORM(CardType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpCardType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
<!-- NEED TO GET COMPANY PAYMENT OPTIONS PARAMETER
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(1)" />
						<WTCONDITION expr="NotPaymentVisa" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(2)" />
						<WTCONDITION expr="NotPaymentMC" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(3)" />
						<WTCONDITION expr="NotPaymentDiscover" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(4)" />
						<WTCONDITION expr="NotPaymentAmex" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
-->					
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
	 				<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CheckAcctType)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="PARAM(WalletType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="PARAM(WalletName)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="tmpBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
	 				<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(tmpBillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(BillingID)" value="CONST(tmpBillingID)"/>
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="ReloadBilling"/>
					<WTCALLSUB name="LoadList"/>
				</WTCODEGROUP>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="0404" return="false"/>
				</WTRETURN>

			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
<!--
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
-->				
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="590" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(TrialDays)"/>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
          var countryid = document.getElementById('CountryID').value;
          var paytype = document.getElementById('PayType').value;
          var commtype = document.getElementById('CommType').value;
          var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
          if (paytype == 2) {
          if ( countryid != 224 ) {
          paytype = 1;
          document.getElementById('PayType').value = paytype;
          alert("Bank Accounts are not available outside the United States");
          }
          }
          if (commtype == 1) {
          if ( countryid != 224 ) {
          commtype = 2;
          document.getElementById('CommType').value = commtype;
          alert("Bank Accounts are not available outside the United States");
          }
          }
          if (paytype == 1)	VisibleCard = '';
          if (paytype == 2) VisibleCheck = '';
          if (paytype == 4) VisibleWallet = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          ToggleWalletType();
        </WTFUNCTION>
        <WTFUNCTION name="ToggleWalletType()">
          var wallettype = document.getElementById('WalletType').value;
          var VisibleWallet = '';
          if (wallettype == 10) VisibleWallet = 'none';
          document.getElementById('WalletNameRow').style.display = VisibleWallet;
        </WTFUNCTION>
        <WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" align="left" embedhtml="true"/>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="BillingName"/>
					<WTTEXT col="2" value="ATTR(Billing.BillingName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Country"/>
					<WTCOMBO col="2" value="ATTR(Billing.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>
<!--				
				<WTROW>
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="25"/>
					<WTTEXT col="2" value="ATTR(Billing.State)" width="240" label="State" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10"/>
					<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>
-->
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="PayType"/>
					<WTCOMBO col="2" value="ATTR(Billing.PayType)">
						<WTOPTION id="1" label="CreditCard">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentVisa" connector="or"/>
							<WTCONDITION expr="_IsPaymentMC" connector="or"/>
						</WTOPTION>
						<WTOPTION id="2" label="eCheck">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCheck" connector="or"/>
						</WTOPTION>
						<WTOPTION id="3" label="Cash">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCash" connector="or"/>
						</WTOPTION>
						<WTOPTION id="4" label="eWallet">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymenteWallet" connector="or"/>
						</WTOPTION>
						<WTOPTION id="5" label="NoPay">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTOPTION>
						<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
					<WTSTATIC col="1" tag="CommType"/>
					<WTCOMBO col="2" value="ATTR(Billing.CommType)">
							<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTHIDDEN value="ATTR(Billing.CommType)"/>
				</WTROW>

				<WTROW id="WalletRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="WalletText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletType"/>
							<WTCOMBO col="2" value="PARAM(WalletType)" required="true">
								<WTOPTION id="11" label="iPayout">
									<WTCONDITION expr="_IsPaymentiPayout"/>
								</WTOPTION>
								<WTOPTION id="12" label="PayQuicker">
									<WTCONDITION expr="_IsPaymentPayQuicker"/>
								</WTOPTION>
								<WTOPTION id="13" label="SolidTrust">
									<WTCONDITION expr="_IsPaymentSolidTrust"/>
								</WTOPTION>
								<WTOPTION id="14" label="BitCoin">
									<WTCONDITION expr="_IsPaymentBitCoin"/>
								</WTOPTION>
                <WTOPTION id="15" label="BitCoinCash">
                  <WTCONDITION expr="_IsPaymentBitCoinCash"/>
                </WTOPTION>
                <WTOPTION id="16" label="Nexxus">
                  <WTCONDITION expr="_IsPaymentNexxus"/>
                </WTOPTION>
                <WTOPTION id="10" label="Wallet">
                  <WTCONDITION expr="_IsPaymentWallet"/>
                </WTOPTION>
                <WTCHANGE>ToggleWalletType();</WTCHANGE>
              </WTCOMBO>
						</WTROW>
            <WTROW id="WalletNameRow">
              <WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="PARAM(WalletName)" required="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CardRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CardText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardType)" required="true">
								<WTOPTION id="1" label="Visa">
									<WTCONDITION expr="_IsPaymentVisa"/>
								</WTOPTION>
								<WTOPTION id="2" label="MasterCard">
									<WTCONDITION expr="_IsPaymentMC"/>
								</WTOPTION>
								<WTOPTION id="3" label="Discover">
									<WTCONDITION expr="_IsPaymentDiscover"/>
								</WTOPTION>
								<WTOPTION id="4" label="Amex">
									<WTCONDITION expr="_IsPaymentAmex"/>
								</WTOPTION>
							</WTCOMBO>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)" required="true"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)" required="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CheckRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CheckText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckBank)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
						</WTROW>
<!--
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckName)" required="true"/>
						</WTROW>
-->						
						<WTROW>
							<WTIMAGE col="1" merge="2" align="center" value="CONST(checkref.gif)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Continue)" align="center"/>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="2903" audit="?/2,21/0,22/0,23/0" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" 
				   contentpage="true" wrapper="wrapper600">
		<!--=============================================================================================-->
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="CardNum" datatype="text"/>
			<WTPARAM name="CardCode" datatype="text"/>
			<WTPARAM name="CheckAcct" datatype="text"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="WalletType" datatype="number" />
			<WTPARAM name="WalletName" datatype="text" />
			<WTPARAM name="V" datatype="number" />
      <WTPARAM name="IsUpdate" datatype="number" />

      <WTINCLUDE name="Payment.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTCUSTOM>LogFile "2903", "ILLEGAL ACCESS by Member #" + CStr(reqSysMemberID) + " of #" + CStr(reqMemberID)</WTCUSTOM>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="NotOrgManager"/>
				<WTCONDITION expr="PARAM(V)" oper="equal" value="CONST(0)" connector="and"/>
				<WTCUSTOM>LogFile "2903", "ILLEGAL ACCESS by Anonymous of " + CStr(reqMemberID)</WTCUSTOM>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

			<WTSUB name="LoadWallet">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(ConfLine)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>			
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadList"/>
				<WTCALLSUB name="LoadWallet"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="PARAM(WalletType)" value="ATTR(CardType)"/>
						<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(CardName)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(CardNum)" value="ATTR(CardNumber)"/>
					<WTSETATTRIBUTE name="PARAM(CardCode)" value="ATTR(CardCode)"/>
					<WTSETATTRIBUTE name="PARAM(CheckAcct)" value="ATTR(CheckAccount)"/>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="ATTR(Verified)" oper="not-equal" value="SYSCON(BILLING-VERIFIED-LOCKED)" connector="or"/>
            <WTSETATTRIBUTE name="PARAM(IsUpdate)" value="CONST(1)"/>
          </WTCODEGROUP>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
			
			<WTACTION id="2" name="Update" type="Update">
				<!-- Validate Card Number or Check Routing Number -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardType)" value="FORM(CardType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />
				<WTSETATTRIBUTE name="CONST(tmpToken)" value="FORM(Token)" />
<!--
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(tmpToken)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
<WTCUSTOM>
	If InStr(.Reference, "-" ) &gt; 0 Then
		aReference = Split(.Reference, "-")
		tmpMemberToken = aReference(1)
	Else
		tmpMemberToken = ""
	End If	
</WTCUSTOM>
				</WTOBJECT>
-->
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTCONDITION expr="CONST(LEFT(tmpCardNumber,12))" oper="not-equal" value="CONST(&quot;xxxxxxxxxxxx&quot;)" connector="and"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpCardType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
<!-- NEED TO GET COMPANY PAYMENT OPTIONS PARAMETER
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(1)" />
						<WTCONDITION expr="NotPaymentVisa" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(2)" />
						<WTCONDITION expr="NotPaymentMC" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(3)" />
						<WTCONDITION expr="NotPaymentDiscover" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(4)" />
						<WTCONDITION expr="NotPaymentAmex" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
-->					
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="ATTR(CardNumber)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardCode)" value="ATTR(CardCode)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAccount)" value="ATTR(CheckAccount)"/>

					<WTSETATTRIBUTES/>

					<WTSETATTRIBUTE name="CONST(tmpProcessor)" value="ATTR(TokenType)"/>
					<WTSETATTRIBUTE name="CONST(tmpToken)" value="ATTR(Token)"/>

					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CheckAcctType)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(tmpCardNumber)">
								<WTCONDITION expr="ATTR(CardNumber)" oper="equal" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(tmpCardCode)">
								<WTCONDITION expr="ATTR(CardCode)" oper="equal" value="CONST(&quot;xxx&quot;)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))"/>
								<WTSETATTRIBUTE name="ATTR(Verified)" value="CONST(0)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(CheckAccount)" oper="equal" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))"/>
								<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(tmpCheckAccount)"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
            <WTSETATTRIBUTE name="ATTR(CardType)" value="PARAM(WalletType)"/>
            <WTSETATTRIBUTE name="ATTR(CardName)" value="PARAM(WalletName)">
              <WTCONDITION expr="ATTR(CardType)" oper="not-equal" value="SYSCON(BILL-PAYTYPE-WALLET-WALLET)"/>
            </WTSETATTRIBUTE>
          </WTCODEGROUP>

					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>		

					<!-- Update Token if it exists -->
          <WTCODEGROUP>
             <WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
            <WTCODEGROUP>
              <WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="SYSCON(NEXXUS)"/>
              <WTCONDITION expr="CONST(tmpToken)" oper="not-equal" value="CONST(0)" connector="or"/>
              <WTCALLSUB name=".Token = SetVault( reqCompanyID, reqBillingID )"/>
            </WTCODEGROUP>
          </WTCODEGROUP>
<!--
					<WTCODEGROUP>
	 					<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
						<WTCONDITION expr="CONST(tmpMemberToken)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTCONDITION expr="CONST(tmpToken)" oper="not-equal" value="CONST(0)" connector="and"/>
<WTCUSTOM>
		Result = UpdatePaymentInfo( tmpProcessor, tmpMemberToken, tmpToken, oBilling )
		If Result &lt;&gt; "OK" Then DoError 1, "", "Payment Update Error: " + Result
</WTCUSTOM>
					</WTCODEGROUP>
-->          
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
<WTCUSTOM>
				Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
				If oHTTP Is Nothing Then
					Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
				Else
					oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0037.asp?Billing=1&amp;MemberID=" &amp; reqMemberID
					oHTTP.send
				End If
				Set oHTTP = Nothing
</WTCUSTOM>
					</WTCODEGROUP>
-->					
					<WTCODEGROUP>
	 					<WTCONDITION expr="IsErrors"/>
						<WTSETATTRIBUTE name="PARAM(CardNum)" value="ATTR(CardNumber)"/>
						<WTSETATTRIBUTE name="PARAM(CardCode)" value="ATTR(CardCode)"/>
						<WTSETATTRIBUTE name="PARAM(CheckAcct)" value="ATTR(CheckAccount)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
							<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
							<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
							<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCALLSUB name="LoadList">
 					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ToggleType()">
					var countryid = document.getElementById('CountryID').value;
					var paytype = document.getElementById('PayType').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
					if (paytype == 2) {
					if ( countryid != 224 ) {
					paytype = 1;
					document.getElementById('PayType').value = paytype;
					alert("Bank Accounts are not available outside the United States");
					}
					}
					if (paytype == 1) VisibleCard = '';
					if (paytype == 2) VisibleCheck = '';
					if (paytype == 4) VisibleWallet = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					document.getElementById('CheckRows').style.display = VisibleCheck;
					document.getElementById('WalletRows').style.display = VisibleWallet;
          ToggleWalletType();
				</WTFUNCTION>
        <WTFUNCTION name="ToggleWalletType()">
          var wallettype = document.getElementById('WalletType').value;
          var VisibleWallet = '';
          if (wallettype == 10) VisibleWallet = 'none';
          document.getElementById('WalletNameRow').style.display = VisibleWallet;
        </WTFUNCTION>
        <WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="ATTR(Billing.Token)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" label="Billing" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				
				<WTROW>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSTATIC col="1"/>
					<WTSTATIC col="2" fontcolor="purple">
						<WTSTATIC value="ATTR(Billing.TokenType)" space="1"/>
						<WTSTATIC value="ATTR(Billing.TokenOwner)" space="1"/>
						<WTSTATIC value="ATTR(Billing.Token)"/>
					</WTSTATIC>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSTATIC col="1" tag="Verified"/>
					<WTCOMBO col="2" value="ATTR(Billing.Verified)">
						<WTOPTION id="0" label="VerifiedNot"/>
						<WTOPTION id="1" label="VerifiedNo"/>
						<WTOPTION id="2" label="VerifiedYes"/>
            <WTOPTION id="3" label="VerifiedLocked"/>
          </WTCOMBO>
					<WTSTATIC col="2" tag="UpdatedDate" value="ATTR(Billing.UpdatedDate)" fontcolor="purple"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Billing.Verified)"/>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" tag="BillingName"/>
					<WTTEXT col="2" value="ATTR(Billing.BillingName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="25"/>
					<WTTEXT col="2" value="ATTR(Billing.State)" width="240" label="State" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10"/>
					<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="PayType"/>
					<WTCOMBO col="2" value="ATTR(Billing.PayType)">
						<WTOPTION id="1" label="CreditCard">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentVisa" connector="or"/>
							<WTCONDITION expr="_IsPaymentMC" connector="or"/>
						</WTOPTION>
						<WTOPTION id="2" label="eCheck">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCheck" connector="or"/>
						</WTOPTION>
						<WTOPTION id="4" label="eWallet">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymenteWallet" connector="or"/>
						</WTOPTION>
						<WTOPTION id="3" label="Cash">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTOPTION>
						<WTOPTION id="5" label="NoPay">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTOPTION>
						<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW id="WalletRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="WalletText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletType"/>
							<WTCOMBO col="2" value="PARAM(WalletType)" required="true">
								<WTOPTION id="11" label="iPayout">
									<WTCONDITION expr="_IsPaymentiPayout"/>
								</WTOPTION>
								<WTOPTION id="12" label="PayQuicker">
									<WTCONDITION expr="_IsPaymentPayQuicker"/>
								</WTOPTION>
								<WTOPTION id="13" label="SolidTrust">
									<WTCONDITION expr="_IsPaymentSolidTrust"/>
								</WTOPTION>
								<WTOPTION id="14" label="BitCoin">
									<WTCONDITION expr="_IsPaymentBitCoin"/>
								</WTOPTION>
                <WTOPTION id="15" label="BitCoinCash">
                  <WTCONDITION expr="_IsPaymentBitCoinCash"/>
                </WTOPTION>
                <WTOPTION id="16" label="Nexxus">
                  <WTCONDITION expr="_IsPaymentNexxus"/>
                </WTOPTION>
                <WTOPTION id="10" label="Wallet">
                  <WTCONDITION expr="_IsPaymentWallet"/>
                </WTOPTION>
                <WTCHANGE>ToggleWalletType();</WTCHANGE>
              </WTCOMBO>
						</WTROW>
						<WTROW id="WalletNameRow">
              <WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="PARAM(WalletName)" required="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CardRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CardText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardType)" required="true">
								<WTOPTION id="1" label="Visa">
									<WTCONDITION expr="_IsPaymentVisa"/>
								</WTOPTION>
								<WTOPTION id="2" label="MasterCard">
									<WTCONDITION expr="_IsPaymentMC"/>
								</WTOPTION>
								<WTOPTION id="3" label="Discover">
									<WTCONDITION expr="_IsPaymentDiscover"/>
								</WTOPTION>
								<WTOPTION id="4" label="Amex">
									<WTCONDITION expr="_IsPaymentAmex"/>
								</WTOPTION>
							</WTCOMBO>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" required="true"/>
							<WTSTATIC col="2" value="PARAM(CardNum)">
								<WTCONDITION expr="IsManager"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)" required="true" />
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)"/>
							<WTSTATIC col="2" value="PARAM(CardCode)">
								<WTCONDITION expr="IsManager"/>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CheckRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CheckText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckBank)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" required="true"/>
							<WTSTATIC col="2" value="PARAM(CheckAcct)">
								<WTCONDITION expr="IsManager"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
						</WTROW>
						<WTROW>
							<WTIMAGE col="1" merge="2" align="center" value="CONST(checkref.gif)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" action="2" value="CONST(Update)">
            <WTCONDITION expr="PARAM(IsUpdate)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="m_2903" page-left="0" page-top="0" navbar="false" header="false" footer="false" wrapper="false"
			page-width="100%" margin-width="0" navbar-width="0" content-width="100%" cache="false" focus="false" viewport="width=device-width"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" mobile="MobileHome.asp" secured="98">
			<!--=============================================================================================-->
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="CardNum" datatype="text"/>
			<WTPARAM name="CardCode" datatype="text"/>
			<WTPARAM name="CheckAcct" datatype="text"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="WalletType" datatype="number" />
			<WTPARAM name="WalletName" datatype="text" />
      <WTPARAM name="IsUpdate" datatype="number" />

      <WTINCLUDE name="AuthorizeNet.asp"/>

			<WTSUB name="LoadWallet">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(ConfLine)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadList"/>
				<WTCALLSUB name="LoadWallet"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="PARAM(WalletType)" value="ATTR(CardType)"/>
						<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(CardName)"/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="PARAM(CardNum)" value="ATTR(CardNumber)"/>
					<WTSETATTRIBUTE name="PARAM(CardCode)" value="ATTR(CardCode)"/>
					<WTSETATTRIBUTE name="PARAM(CheckAcct)" value="ATTR(CheckAccount)"/>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
          <WTCODEGROUP>
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="ATTR(Verified)" oper="not-equal" value="SYSCON(BILLING-VERIFIED-LOCKED)" connector="or"/>
            <WTSETATTRIBUTE name="PARAM(IsUpdate)" value="CONST(1)"/>
          </WTCODEGROUP>
          <WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
				<!-- Validate Card Number or Check Routing Number -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardType)" value="FORM(CardType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />
				<WTSETATTRIBUTE name="CONST(tmpToken)" value="FORM(Token)" />

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="CONST(tmpToken)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCUSTOM>
						If InStr(.Reference, "-" ) &gt; 0 Then
						aReference = Split(.Reference, "-")
						tmpMemberToken = aReference(1)
						Else
						tmpMemberToken = ""
						End If
					</WTCUSTOM>
				</WTOBJECT>

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTCONDITION expr="CONST(LEFT(tmpCardNumber,12))" oper="not-equal" value="CONST(&quot;xxxxxxxxxxxx&quot;)" connector="and"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpCardType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="ATTR(CardNumber)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardCode)" value="ATTR(CardCode)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAccount)" value="ATTR(CheckAccount)"/>

					<WTSETATTRIBUTES/>

					<WTSETATTRIBUTE name="CONST(tmpProcessor)" value="ATTR(TokenType)"/>
					<WTSETATTRIBUTE name="CONST(tmpToken)" value="ATTR(Token)"/>

					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CheckAcctType)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(tmpCardNumber)">
								<WTCONDITION expr="ATTR(CardNumber)" oper="equal" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(tmpCardCode)">
								<WTCONDITION expr="ATTR(CardCode)" oper="equal" value="CONST(&quot;xxx&quot;)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))"/>
								<WTSETATTRIBUTE name="ATTR(Verified)" value="CONST(0)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(CheckAccount)" oper="equal" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))"/>
								<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(tmpCheckAccount)"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="SYSCON(PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="PARAM(WalletType)"/>
            <WTSETATTRIBUTE name="ATTR(CardName)" value="PARAM(WalletName)">
              <WTCONDITION expr="ATTR(CardType)" oper="not-equal" value="SYSCON(BILL-PAYTYPE-WALLET-WALLET)"/>
            </WTSETATTRIBUTE>
					</WTCODEGROUP>

					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>

					<!-- Update Token if it exists -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
						<WTCONDITION expr="CONST(tmpMemberToken)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTCONDITION expr="CONST(tmpToken)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>
							Result = UpdatePaymentInfo( tmpProcessor, tmpMemberToken, tmpToken, oBilling )
							If Result &lt;&gt; "OK" Then DoError 1, "", "Payment Update Error: " + Result
						</WTCUSTOM>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
						<WTSETATTRIBUTE name="PARAM(CardNum)" value="ATTR(CardNumber)"/>
						<WTSETATTRIBUTE name="PARAM(CardCode)" value="ATTR(CardCode)"/>
						<WTSETATTRIBUTE name="PARAM(CheckAcct)" value="ATTR(CheckAccount)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
							<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
							<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
							<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="30" align="right"/>
				<WTCOLUMN width="70" align="left"/>

				<WTFUNCTION name="ToggleType()">
          var countryid = document.getElementById('CountryID').value;
          var paytype = document.getElementById('PayType').value;
          var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
          if (paytype == 2) {
          if ( countryid != 224 ) {
          paytype = 1;
          document.getElementById('PayType').value = paytype;
          alert("Bank Accounts are not available outside the United States");
          }
          }
          if (paytype == 1) VisibleCard = '';
          if (paytype == 2) VisibleCheck = '';
          if (paytype == 4) VisibleWallet = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          ToggleWalletType();
        </WTFUNCTION>
        <WTFUNCTION name="ToggleWalletType()">
          var wallettype = document.getElementById('WalletType').value;
          var VisibleWallet = '';
          if (wallettype == 10) VisibleWallet = 'none';
          document.getElementById('WalletNameRow').style.display = VisibleWallet;
        </WTFUNCTION>
        <WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
					<WTHIDDEN value="ATTR(Billing.Token)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" label="Billing" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>

				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="BillingName"/>
					<WTTEXT col="2" value="ATTR(Billing.BillingName)" size="30"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Billing.Street1)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Street2)" size="30"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.City)" width="100" label="City" size="12"/>
					<WTTEXT col="2" value="ATTR(Billing.State)" width="110" label="State" size="14"/>
				</WTROW>
				<WTROW margin-bottom="3">
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Zip)" width="210" label="Zip" size="10"/>
				</WTROW>
				<WTROW>
					<WTCOMBO col="1" merge="2" value="ATTR(Billing.CountryID)" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="PayType"/>
					<WTCOMBO col="2" value="ATTR(Billing.PayType)">
						<WTOPTION id="1" label="CreditCard">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentVisa" connector="or"/>
							<WTCONDITION expr="_IsPaymentMC" connector="or"/>
						</WTOPTION>
						<WTOPTION id="2" label="eCheck">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCheck" connector="or"/>
						</WTOPTION>
						<WTOPTION id="3" label="Cash">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymentCash" connector="or"/>
						</WTOPTION>
						<WTOPTION id="4" label="eWallet">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
							<WTCONDITION expr="_IsPaymenteWallet" connector="or"/>
						</WTOPTION>
						<WTOPTION id="5" label="NoPay">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTOPTION>
						<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW id="WalletRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="35" align="right"/>
						<WTCOLUMN width="65" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="WalletType"/>
							<WTCOMBO col="2" value="PARAM(WalletType)" required="true">
								<WTOPTION id="11" label="iPayout">
									<WTCONDITION expr="_IsPaymentiPayout"/>
								</WTOPTION>
								<WTOPTION id="12" label="PayQuicker">
									<WTCONDITION expr="_IsPaymentPayQuicker"/>
								</WTOPTION>
								<WTOPTION id="13" label="SolidTrust">
									<WTCONDITION expr="_IsPaymentSolidTrust"/>
								</WTOPTION>
                <WTOPTION id="14" label="BitCoin">
                  <WTCONDITION expr="_IsPaymentBitCoin"/>
                </WTOPTION>
                <WTOPTION id="15" label="BitCoinCash">
                  <WTCONDITION expr="_IsPaymentBitCoinCash"/>
                </WTOPTION>
                <WTOPTION id="16" label="Nexxus">
                  <WTCONDITION expr="_IsPaymentNexxus"/>
                </WTOPTION>
                <WTOPTION id="10" label="Wallet">
                  <WTCONDITION expr="_IsPaymentWallet"/>
                </WTOPTION>
                <WTCHANGE>ToggleWalletType();</WTCHANGE>
              </WTCOMBO>
						</WTROW>
            <WTROW id="WalletNameRow" margin-bottom="3">
              <WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="PARAM(WalletName)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CardRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="35" align="right"/>
						<WTCOLUMN width="65" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardType)">
								<WTOPTION id="1" label="Visa">
									<WTCONDITION expr="_IsPaymentVisa"/>
								</WTOPTION>
								<WTOPTION id="2" label="MasterCard">
									<WTCONDITION expr="_IsPaymentMC"/>
								</WTOPTION>
								<WTOPTION id="3" label="Discover">
									<WTCONDITION expr="_IsPaymentDiscover"/>
								</WTOPTION>
								<WTOPTION id="4" label="Amex">
									<WTCONDITION expr="_IsPaymentAmex"/>
								</WTOPTION>
							</WTCOMBO>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CheckRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="35" align="right"/>
						<WTCOLUMN width="65" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckName"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25"/>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckRoute)"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTTOOLTIP>
										<WTIMAGE value="CONST(SymbolHelp.gif)"/>
										<WTTIP>
											<WTIMAGE value="CONST(checkref.gif)"/>
										</WTTIP>
									</WTTOOLTIP>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckAccount)"/>
							<WTSTATIC col="2">
								<WTCODEGROUP>
									<WTTOOLTIP>
										<WTIMAGE value="CONST(SymbolHelp.gif)"/>
										<WTTIP>
											<WTIMAGE value="CONST(checkref.gif)"/>
										</WTTIP>
									</WTTOOLTIP>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-bottom="3">
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Update)" align="center">
            <WTCONDITION expr="PARAM(IsUpdate)" oper="not-equal" value="CONST(0)"/>
           </WTBUTTON>
           <WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)"/>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="2904" header="false" footer="false" navbar="false"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
		<!--===============================================================================-->
			<WTPARAM name="Payment" datatype="text"/>
			<WTPARAM name="Cart" datatype="number"/>
			<WTINCLUDE name="Billing.asp"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Cart)" oper="not-equal" value="CONST(0)"/>
				<WTCONDITION expr="CONST(Left(reqPayment,9))" oper="not-equal" value="CONST(&quot;Charged:[&quot;)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(Payment)" value="CONST(&quot;Charged:[1 ]&quot;)"/>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCALLSUB name="PaymentBilling reqPayment, oBilling"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>
*			
	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="120" align="right"/>
				<WTCOLUMN width="200" align="left"/>

				<WTROW>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="PARAM(Cart)"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" tag="CardType"/>
						<WTCOMBO col="2" value="ATTR(Billing.CardType)" required="true">
							<WTOPTION id="1" label="Visa"/>
							<WTOPTION id="2" label="MasterCard"/>
							<WTOPTION id="3" label="Discover"/>
							<WTOPTION id="4" label="Amex"/>
						</WTCOMBO>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardNumber"/>
						<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25" required="true">
							<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Please enter digits only for your Credit Card Number')</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardDate"/>
						<WTCOMBO col="2" value="ATTR(Billing.CardMo)"/>
						<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" prespace="false"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardName"/>
						<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CardCode"/>
						<WTTEXT col="2" value="ATTR(Billing.CardCode)"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="BillingAddress"/>
						<WTTEXT col="2" value="ATTR(Billing.Street1)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTTEXT col="2" value="ATTR(Billing.Street2)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="City"/>
						<WTTEXT col="2" value="ATTR(Billing.City)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="State"/>
						<WTTEXT col="2" value="ATTR(Billing.State)" size="25"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="Zip"/>
						<WTTEXT col="2" value="ATTR(Billing.Zip)" size="10"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CountryCode"/>
						<WTTEXT col="2" value="ATTR(Billing.CountryCode)" size="10"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" tag="CheckBank"/>
						<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckRoute"/>
						<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckAccount"/>
						<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckNumber"/>
						<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckName"/>
						<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25" required="true"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" tag="CheckAcctType"/>
						<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
					</WTROW>
				</WTCODEGROUP>
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW>
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Save)" align="center">
						<WTCLICK>
							var ptype = document.getElementById('PayType').value;
							var cart = document.getElementById('Cart').value;
							var desc = "";
							if( ptype == 1 ) {
							var cardtype = document.getElementById('CardType').value;
							var cardnumber = document.getElementById('CardNumber').value;
							var cardmo = document.getElementById('CardMo').value;
							var cardyr = document.getElementById('CardYr').value;
							var cardcode = document.getElementById('CardCode').value;
							var cardname = document.getElementById('CardName').value;
							var street1 = document.getElementById('Street1').value;
							var street2 = document.getElementById('Street2').value;
							var city = document.getElementById('City').value;
							var state = document.getElementById('State').value;
							var zip = document.getElementById('Zip').value;
							var countrycode = document.getElementById('CountryCode').value;
							desc = "Charged:[" + cardtype + "; " + cardnumber + "; " + cardmo + "/" + cardyr + "; " + cardcode + "; " + cardname + "; " + street1 + "; " + street2 + "; " + city + "; " + state + "; " + zip + "; " + countrycode + "]";
							}
							if( ptype == 2 ) {
							var checkbank = document.getElementById('CheckBank').value;
							var checkroute = document.getElementById('CheckRoute').value;
							var checkaccount = document.getElementById('CheckAccount').value;
							var checkaccttype = document.getElementById('CheckAcctType').value;
							var checknumber = document.getElementById('CheckNumber').value;
							var checkname = document.getElementById('CheckName').value;
							desc = "Charged:[" + checkbank + "; " + checkroute + "; " + checkaccount + "; " + checknumber + "; " + checkname + "; " + checkaccttype + "]";
							}
							if( cart == 0 ) {
							window.opener.document.getElementById('Description').value = desc;
							}
							else {
							window.opener.document.getElementById('Dirty').value = 1;
							window.opener.document.getElementById('Notes').value = desc;
							}
							window.close();
						</WTCLICK>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="3" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="2912" navbar="blank" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" 
		contentpage="true" cache="false" focus="false" secured="52">
		<!--===============================================================================-->
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="WalletType" datatype="number"/>
			<WTPARAM name="WalletName" datatype="text"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>
			
			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadBilling">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(ConfLine)"/>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="ATTR(CommType)" value="CONST(2)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ReloadBilling">
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadBilling"/>
				<WTCALLSUB name="LoadList"/>
			</WTACTION>
			
			<WTACTION id="2" name="Add" type="Add">
				<!-- Validate Card Number or Check Routing Number -->
				<WTSETATTRIBUTE name="CONST(tmpCommType)" value="FORM(CommType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardType)" value="FORM(CardType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpCommType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpCommType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP> <!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpCardType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
<!-- NEED TO GET COMPANY PAYMENT OPTIONS PARAMETER
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(1)" />
						<WTCONDITION expr="NotPaymentVisa" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(2)" />
						<WTCONDITION expr="NotPaymentMC" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(3)" />
						<WTCONDITION expr="NotPaymentDiscover" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(4)" />
						<WTCONDITION expr="NotPaymentAmex" connector="and"/>
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
-->					
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
	 				<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CheckAcctType)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CommType)" oper="equal" value="SYSCON(COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="PARAM(WalletType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="PARAM(WalletName)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Add">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="tmpBillingID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
	 				<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(tmpBillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(PayID)" value="CONST(tmpBillingID)"/>
					<WTMETHOD name="Save">
		 				<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="MemberID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="ReloadBilling"/>
					<WTCALLSUB name="LoadList"/>
				</WTCODEGROUP>

				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
          var countryid = document.getElementById('CountryID').value;
          var commtype = document.getElementById('CommType').value;
          var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
          if (commtype == 2) {
          if ( countryid != 224 ) {
          commtype = 3;
          document.getElementById('CommType').value = commtype;
          alert("Direct Deposit is not available outside the United States");
          }
          }
          if (commtype == 1) VisibleCard = '';
          if (commtype == 2) VisibleCheck = '';
          if (commtype == 4) VisibleWallet = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          ToggleWalletType();
        </WTFUNCTION>
        <WTFUNCTION name="ToggleWalletType()">
          var wallettype = document.getElementById('WalletType').value;
          var VisibleWallet = '';
          if (wallettype == 10) VisibleWallet = 'none';
          document.getElementById('WalletNameRow').style.display = VisibleWallet;
        </WTFUNCTION>
        <WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" label="Pay" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="AddressText" class="prompt"/>
				</WTROW>
				
				<WTROW>
					<WTSTATIC col="1" tag="BillingName"/>
					<WTTEXT col="2" value="ATTR(Billing.BillingName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="25"/>
					<WTTEXT col="2" value="ATTR(Billing.State)" width="240" label="State" size="25"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10"/>
					<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
						<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="CommType"/>
					<WTCOMBO col="2" value="ATTR(Billing.CommType)">
						<WTCHANGE>ToggleType();</WTCHANGE>
<!--
						<WTOPTION id="1" label="CreditCard">
							<WTCONDITION expr="IsEmployee"/>
						</WTOPTION>
-->						
						<WTOPTION id="2" label="DirectDeposit">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="_IsPayoutDeposit" connector="or"/>
						</WTOPTION>
						<WTOPTION id="3" label="Check">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="_IsPayoutCheck" connector="or"/>
						</WTOPTION>
						<WTOPTION id="4" label="eWallet">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="_IsPayoutWallet" connector="or"/>
						</WTOPTION>
						<WTOPTION id="5" label="NoComm">
							<WTCONDITION expr="IsEmployee"/>
						</WTOPTION>
					</WTCOMBO>
				</WTROW>

				<WTROW id="WalletRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletType"/>
							<WTCOMBO col="2" value="PARAM(WalletType)" required="true">
								<WTOPTION id="11" label="iPayout">
									<WTCONDITION expr="_IsPayoutiPayout"/>
								</WTOPTION>
								<WTOPTION id="12" label="PayQuicker">
									<WTCONDITION expr="_IsPayoutPayQuicker"/>
								</WTOPTION>
								<WTOPTION id="13" label="SolidTrust">
									<WTCONDITION expr="_IsPayoutSolidTrust"/>
								</WTOPTION>
								<WTOPTION id="14" label="BitCoin">
									<WTCONDITION expr="_IsPayoutBitCoin"/>
								</WTOPTION>
                <WTOPTION id="15" label="BitCoinCash">
                  <WTCONDITION expr="_IsPayoutBitCoinCash"/>
                </WTOPTION>
                <WTOPTION id="16" label="Nexxus">
                  <WTCONDITION expr="_IsPayoutNexxus"/>
                </WTOPTION>
                <WTOPTION id="17" label="Ether">
                  <WTCONDITION expr="_IsPayoutEther"/>
                </WTOPTION>
                <WTOPTION id="10" label="Wallet">
                  <WTCONDITION expr="_IsPaymentWallet"/>
                </WTOPTION>
                <WTCHANGE>ToggleWalletType();</WTCHANGE>
              </WTCOMBO>
						</WTROW>
            <WTROW id="WalletNameRow">
              <WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="PARAM(WalletName)" required="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CardRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardType)" required="true">
								<WTOPTION id="1" label="Visa">
									<WTCONDITION expr="_IsPaymentVisa"/>
								</WTOPTION>
								<WTOPTION id="2" label="MasterCard">
									<WTCONDITION expr="_IsPaymentMC"/>
								</WTOPTION>
								<WTOPTION id="3" label="Discover">
									<WTCONDITION expr="_IsPaymentDiscover"/>
								</WTOPTION>
								<WTOPTION id="4" label="Amex">
									<WTCONDITION expr="_IsPaymentAmex"/>
								</WTOPTION>
							</WTCOMBO>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)" required="true"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CheckRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CheckText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckBank)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
						</WTROW>
<!--						
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
						</WTROW>
-->						
						<WTROW>
							<WTIMAGE col="1" merge="2" align="center" value="CONST(checkref.gif)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>
				
				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" action="2" value="CONST(Submit)">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)"/>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="2913" audit="?/2,21/0,22/0,23/0"  wrapper="wrapper600"
               aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" contentpage="true" secured="52">
		<!--=============================================================================================-->
			<WTPARAM name="contentpage" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="CardNum" datatype="text"/>
			<WTPARAM name="CardCode" datatype="text"/>
			<WTPARAM name="CheckAcct" datatype="text"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="WalletType" datatype="number" />
			<WTPARAM name="WalletName" datatype="text"/>
      <WTPARAM name="IsUpdate" datatype="number" />

      <WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="Comm.asp"/>

			<!-- CHECK FOR ILLEGAL ACCESS -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsMemberOnly"/>
				<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
				<WTCUSTOM>LogFile "2913", "ILLEGAL ACCESS by Member #" + CStr(reqSysMemberID) + " of #" + CStr(reqMemberID)</WTCUSTOM>
				<WTRETURN>
					<WTLINK name="0101" return="false">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTCODEGROUP>

      <WTSUB name="NotifyChange">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="CONST(.Email + &quot;,&quot; + .Email2)"/>
				</WTOBJECT>
				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="CONST(tmpCompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="ATTR(Company.Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="ATTR(Company.Email)"/>
				</WTOBJECT>
				<WTCUSTOM>
					tmpSubject = "Payout Method Change Notification"
					tmpBody = tmpName + "; This is a security notice that your Payout Method for acct #" + CStr(reqMemberID) + " has been changed by " + reqSysUserName + ".  If you are aware of this change no further action is required, otherwise contact customer support immediately."
					SendEmail tmpCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
				</WTCUSTOM>
			</WTSUB>

			<WTSUB name="CreateWallet">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpUserName)" value="ATTR(Logon)" />
					<WTSETATTRIBUTE name="CONST(tmpFirstName)" value="ATTR(NameFirst)" />
					<WTSETATTRIBUTE name="CONST(tmpLastName)" value="ATTR(NameLast)" />
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)" />
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpWalletType)" oper="equal" value="CONST(11)"/>
						<WTCUSTOM>
							result = iPayout_RegisterUser( tmpWalletAcct, tmpUserName, tmpFirstName, tmpLastName, tmpEmail )
							If result = "" Then reqWalletName = tmpUserName Else DoError 0, "iPayout_RegisterUser", result
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" concat="true" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadList"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CardNum)" value="ATTR(CardName)"/>
					<WTSETATTRIBUTE name="PARAM(CardCode)" value="ATTR(CardCode)"/>
					<WTSETATTRIBUTE name="PARAM(CheckAcct)" value="ATTR(CheckAccount)"/>
					<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
						<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
						<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
						<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CommType)" oper="equal" value="SYSCON(COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="PARAM(WalletType)" value="ATTR(CardType)"/>
						<WTSETATTRIBUTE name="PARAM(WalletName)" value="ATTR(CardName)"/>
					</WTCODEGROUP>
          <WTCODEGROUP>
            <WTCONDITION expr="IsEmployee"/>
            <WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
            <WTCONDITION expr="ATTR(Verified)" oper="not-equal" value="SYSCON(BILLING-VERIFIED-LOCKED)" connector="or"/>
            <WTSETATTRIBUTE name="PARAM(IsUpdate)" value="CONST(1)"/>
          </WTCODEGROUP>

          <WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="UpdateBilling">
				<!-- Validate Card Number or Check Routing Number -->
				<WTSETATTRIBUTE name="CONST(tmpCommType)" value="FORM(CommType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardType)" value="FORM(CardType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpCommType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpCommType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTCONDITION expr="CONST(LEFT(tmpCardNumber,12))" oper="not-equal" value="CONST(&quot;xxxxxxxxxxxx&quot;)" connector="and"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- card matches selected type -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpCardType))" connector="and"/>
						<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="ATTR(CardNumber)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardCode)" value="ATTR(CardCode)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAccount)" value="ATTR(CheckAccount)"/>

					<WTSETATTRIBUTES/>

					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)">
						<WTCONDITION expr="ATTR(CheckAcctType)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CommType)" oper="equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(tmpCardNumber)">
								<WTCONDITION expr="ATTR(CardNumber)" oper="equal" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(tmpCardCode)">
								<WTCONDITION expr="ATTR(CardCode)" oper="equal" value="CONST(&quot;xxx&quot;)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CommType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))"/>
								<WTSETATTRIBUTE name="ATTR(Verified)" value="CONST(0)"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(CheckAccount)" oper="equal" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))"/>
								<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(tmpCheckAccount)"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(CommType)" oper="equal" value="SYSCON(BILL-COMMTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="PARAM(WalletType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="PARAM(WalletName)"/>
					</WTCODEGROUP>

					<WTMETHOD name="Save">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					
					<WTCALLSUB name="NotifyChange">
						<WTCONDITION expr="NoErrors"/>
            <WTCONDITION expr="NotSysAdmin" connector="and"/>
          </WTCALLSUB>

					<WTCODEGROUP>
						<WTCONDITION expr="IsErrors"/>
						<WTSETATTRIBUTE name="PARAM(CardNum)" value="ATTR(CardName)"/>
						<WTSETATTRIBUTE name="PARAM(CardCode)" value="ATTR(CardCode)"/>
						<WTSETATTRIBUTE name="PARAM(CheckAcct)" value="ATTR(CheckAccount)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="CONST(&quot;xxxxxxxxxxxx&quot; + Right(.CardNumber,4))">
							<WTCONDITION expr="ATTR(CardNumber)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="CONST(&quot;xxx&quot;)">
							<WTCONDITION expr="ATTR(CardCode)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="CONST(&quot;xxxx&quot; + Right(.CheckAccount,4))">
							<WTCONDITION expr="ATTR(CheckAccount)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<!-- CHECK FOR ILLEGAL ACCESS -->
				<WTCODEGROUP>
					<WTCONDITION expr="IsMemberOnly"/>
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="SYS(MemberID)" connector="and"/>
					<WTRETURN><WTLINK name="0101" return="false"><WTPARAM name="ActionCode" value="CONST(9)"/></WTLINK></WTRETURN>
				</WTCODEGROUP>

				<WTCALLSUB name="LoadBilling"/>
			</WTACTION>
			
			<WTACTION id="2" name="Update" type="Update">
				<WTCALLSUB name="UpdateBilling"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>
			
			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="5" name="iPayoutWallet" type="Update">
				<WTCALLSUB name="CreateWallet"/>
				<WTCALLSUB name="UpdateBilling"/>
				<WTCALLSUB name="LoadBilling"/>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="440" align="left"/>

				<WTFUNCTION name="ToggleType()">
          var countryid = document.getElementById('CountryID').value;
          var commtype = document.getElementById('CommType').value;
          var cardtype = document.getElementById('CardType').value;
          var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleWallet = 'none';
          if (commtype == 2) {
          if ( countryid != 224 ) {
          commtype = 3;
          document.getElementById('CommType').value = commtype;
          alert("Direct Deposit is not available outside the United States");
          }
          }
          if (commtype == 4 &amp;&amp; cardtype == 13 &amp;&amp; countryid == 224) {
          alert("STP is not available outside the United States");
          }
          if (commtype == 1) VisibleCard = '';
          if (commtype == 2) VisibleCheck = '';
          if (commtype == 4) VisibleWallet = '';
          document.getElementById('CardRows').style.display = VisibleCard;
          document.getElementById('CheckRows').style.display = VisibleCheck;
          document.getElementById('WalletRows').style.display = VisibleWallet;
          ToggleWalletType();
        </WTFUNCTION>
        <WTFUNCTION name="ToggleWalletType()">
          var wallettype = document.getElementById('WalletType').value;
          var VisibleWallet = '';
          if (wallettype == 10) VisibleWallet = 'none';
          document.getElementById('WalletNameRow').style.display = VisibleWallet;
        </WTFUNCTION>
        <WTLOAD>ToggleType();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(CompanyID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" label="Pay" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="AddressText" class="prompt"/>
				</WTROW>
				
				<WTROW>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSTATIC col="1" tag="Verified"/>
					<WTCOMBO col="2" value="ATTR(Billing.Verified)">
						<WTOPTION id="0" label="VerifiedNot"/>
						<WTOPTION id="1" label="VerifiedNo"/>
            <WTOPTION id="2" label="VerifiedYes"/>
            <WTOPTION id="3" label="VerifiedLocked"/>
          </WTCOMBO>
					<WTSTATIC col="2" tag="UpdatedDate" value="ATTR(Billing.UpdatedDate)" fontcolor="purple"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTHIDDEN value="ATTR(Billing.Verified)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="BillingName"/>
					<WTTEXT col="2" value="ATTR(Billing.BillingName)"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" tag="Address"/>
					<WTTEXT col="2" value="ATTR(Billing.Street1)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Street2)" size="60"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.City)" width="200" label="City" size="20"/>
					<WTTEXT col="2" value="ATTR(Billing.State)" width="240" label="State" size="20"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1"/>
					<WTTEXT col="2" value="ATTR(Billing.Zip)" width="100" label="Zip" size="10"/>
					<WTCOMBO col="2" value="ATTR(Billing.CountryID)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
						<WTCHANGE>ToggleType();</WTCHANGE>
					</WTCOMBO>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="CommType"/>
					<WTCOMBO col="2" value="ATTR(Billing.CommType)">
						<WTCHANGE>ToggleType();</WTCHANGE>
<!--
						<WTOPTION id="1" label="CreditCard">
							<WTCONDITION expr="IsEmployee"/>
						</WTOPTION>
-->						
						<WTOPTION id="2" label="DirectDeposit">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="_IsPayoutDeposit" connector="or"/>
						</WTOPTION>
						<WTOPTION id="3" label="Check">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="_IsPayoutCheck" connector="or"/>
						</WTOPTION>
						<WTOPTION id="4" label="eWallet">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="_IsPayoutWallet" connector="or"/>
						</WTOPTION>
						<WTOPTION id="5" label="NoComm">
							<WTCONDITION expr="IsEmployee"/>
							<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						</WTOPTION>
					</WTCOMBO>
				</WTROW>

				<WTROW id="WalletRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="WalletType"/>
							<WTCOMBO col="2" value="PARAM(WalletType)" required="true">
                <WTOPTION id="10" label="Wallet">
                  <WTCONDITION expr="_IsPaymentWallet"/>
                </WTOPTION>
                <WTOPTION id="11" label="iPayout">
									<WTCONDITION expr="_IsPayoutiPayout"/>
								</WTOPTION>
								<WTOPTION id="12" label="PayQuicker">
									<WTCONDITION expr="_IsPayoutPayQuicker"/>
								</WTOPTION>
								<WTOPTION id="13" label="SolidTrust">
									<WTCONDITION expr="_IsPayoutSolidTrust"/>
								</WTOPTION>
								<WTOPTION id="14" label="BitCoin">
									<WTCONDITION expr="_IsPayoutBitCoin"/>
								</WTOPTION>
                <WTOPTION id="15" label="BitCoinCash">
                  <WTCONDITION expr="_IsPayoutBitCoinCash"/>
                </WTOPTION>
                <WTOPTION id="16" label="Nexxus">
                  <WTCONDITION expr="_IsPayoutNexxus"/>
                </WTOPTION>
                <WTOPTION id="17" label="Ether">
                  <WTCONDITION expr="_IsPayoutEther"/>
                </WTOPTION>
                <WTCHANGE>ToggleWalletType();</WTCHANGE>
              </WTCOMBO>
            </WTROW>
            <WTROW id="WalletNameRow">
              <WTSTATIC col="1" tag="WalletName"/>
							<WTTEXT col="2" value="PARAM(WalletName)" size="40" required="true"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CardRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardType)" required="true">
								<WTOPTION id="1" label="Visa">
									<WTCONDITION expr="_IsPaymentVisa"/>
								</WTOPTION>
								<WTOPTION id="2" label="MasterCard">
									<WTCONDITION expr="_IsPaymentMC"/>
								</WTOPTION>
								<WTOPTION id="3" label="Discover">
									<WTCONDITION expr="_IsPaymentDiscover"/>
								</WTOPTION>
								<WTOPTION id="4" label="Amex">
									<WTCONDITION expr="_IsPaymentAmex"/>
								</WTOPTION>
							</WTCOMBO>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CardNumber)" required="true"/>
							<WTSTATIC col="2" value="PARAM(CardNum)">
								<WTCONDITION expr="IsManager"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardDate"/>
							<WTCOMBO col="2" value="ATTR(Billing.CardMo)" required="true" />
							<WTCOMBO col="2" value="ATTR(Billing.CardYr)" required="true" />
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardName"/>
							<WTTEXT col="2" value="ATTR(Billing.CardName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CardCode"/>
							<WTTEXT col="2" value="ATTR(Billing.CardCode)"/>
							<WTSTATIC col="2" value="PARAM(CardCode)">
								<WTCONDITION expr="IsManager"/>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW id="CheckRows">
					<WTTABLE col="1" merge="2">
						<WTCOLUMN width="160" align="right"/>
						<WTCOLUMN width="440" align="left"/>
						<WTROW margin-top="6" margin-bottom="6">
							<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTSTATIC col="1" merge="2" align="left" label="CheckText" class="prompt"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckBank"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckBank)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckName"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckName)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckRoute"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckRoute)" required="true"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAccount"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" required="true"/>
							<WTSTATIC col="2" value="PARAM(CheckAcct)">
								<WTCONDITION expr="IsManager"/>
							</WTSTATIC>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" tag="CheckAcctType"/>
							<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)" required="true"/>
						</WTROW>
<!--						
						<WTROW>
							<WTSTATIC col="1" tag="CheckNumber"/>
							<WTTEXT col="2" value="ATTR(Billing.CheckNumber)" required="true"/>
						</WTROW>
-->						
						<WTROW>
							<WTIMAGE col="1" merge="2" align="center" value="CONST(checkref.gif)"/>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="6" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTSTATIC col="1"/>
					<WTBUTTON col="2" action="2" value="CONST(Update)">
            <WTCONDITION expr="PARAM(IsUpdate)" oper="not-equal" value="CONST(0)"/>
          </WTBUTTON>
					<WTBUTTON col="2" action="3" value="CONST(Cancel)"/>
					<WTBUTTON col="2" action="5" value="CONST(CreateWallet)">
						<WTCONDITION expr="IsEmployee" paren="start"/>
						<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
						<WTCONDITION expr="IsOrgManagerOnly" connector="or" paren="end"/>
						<WTCONDITION expr="PARAM(WalletType)" oper="equal" value="CONST(11)" connector="and"/>
						<WTCONDITION expr="PARAM(WalletName)" oper="equal" value="CONST('')" connector="and"/>
					</WTBUTTON>
				</WTROW>
			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>