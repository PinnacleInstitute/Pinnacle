<WTROOT prefix="pts" system="Pinnacle">

	<WTENTITY id="149" name="TellAll" alias="tam">
		<!--Identity-->
		<WTATTRIBUTE id="14901" name="TellAllID" type="number" identity="true" title="true" min="1" required="true" source="entity"/>

		<!-- Non Persist Fields -->
		<WTATTRIBUTE id="14995" name="Result" type="text" length="1000" source="entity" persist="false"/>
		<WTATTRIBUTE id="14996" name="Status" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="14997" name="czDate" type="date" source="entity" persist="false"/>
		<WTATTRIBUTE id="14998" name="Quantity" type="number" source="entity" persist="false"/>
		<WTATTRIBUTE id="14999" name="Amount" type="number" source="entity" persist="false"/>

		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="TellAll" entity="TellAll" alias="tam"/>
		</WTRELATIONSHIPS>

		<!-- System Constants -->
		<WTSYSCONS>
			<WTSYSCON name="MEMBER-BILL-MEMBER" value="3"/>
			<WTSYSCON name="ENROLL-REFER" value="0" />
			<WTSYSCON name="ENROLL-AGREE" value="1" />
			<WTSYSCON name="ENROLL-CONTACT" value="2" />
			<WTSYSCON name="ENROLL-MEMBERSHIP" value="3" />
			<WTSYSCON name="ENROLL-PAYMENT" value="4" />
			<WTSYSCON name="ENROLL-CONFIRM" value="5" />
			<WTSYSCON name="ENROLL-PROCESS" value="6" />
		</WTSYSCONS>
	</WTENTITY>

	<WTPROCEDURES>
		<!--==================================================================================================-->
		<WTPROCEDURE name="Custom" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="Result" direction="output" datatype="text" length="1000"/>
		</WTPROCEDURE>
		<!--==================================================================-->
		<WTPROCEDURE name="CustomList" type="List" style="GenerateDataProc.xsl" template="new" passthru="true" noedit="true" nodata="true">
			<WTPARAM name="ATTR(Status)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(czDate)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Quantity)" direction="input" required="false" passthru="true"/>
			<WTPARAM name="ATTR(Amount)" direction="input" required="false" passthru="true"/>
			<WTCODEGROUP>
				<WTSELECT>
					<WTATTRIBUTE value="ATTR(TellAll.TellAllID)"/>
					<WTATTRIBUTE value="ATTR(TellAll.Result)"/>
				</WTSELECT>
			</WTCODEGROUP>
		</WTPROCEDURE>
	</WTPROCEDURES>

	<WTWEBPAGES>
<!-- Processing - Admin Page -->
		<!--==================================================================-->
		<WTWEBPAGE name="14900" caption="TellAll Processing" header="false" footer="false" navbar="false" wrapper="wrapper800" 
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" focus="false" langfile="14900" secured="125">
		<!--==================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="Process" datatype="number"/>
			<WTPARAM name="FromDate" datatype="date"/>
			<WTPARAM name="ToDate" datatype="date"/>
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Result" datatype="text"/>
			<WTPARAM name="MemberID" datatype="number"/>

			<WTDATATXN name="Members"/>
			<WTDATATXN name="TellAlls"/>
			<WTDATATXN name="SalesOrders"/>

			<WTINCLUDE name="Note.asp"/>
			<WTINCLUDE name="Payout.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="PaymentFile.asp"/>
			<WTINCLUDE name="Orders.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>
			<WTINCLUDE name="DeclineEmail.asp"/>

			<WTCODEGROUP>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(19)"/>
<!-- ************************************************************************** -->
<!-- ************************************************************************** -->
				<!-- Set this page to not timeout for 4 hours -->
				<WTCUSTOM>Server.ScriptTimeout = 14400</WTCUSTOM>				
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
			<!-- Disable Certain Features based on User Type -->
			<WTCODEGROUP>
				<WTCONDITION expr="IsManagerOnly"/>
				<WTCUSTOM>If InStr( ",2,3,5,6,11,12,13,21,22,23,24,25,26,27,29,30,31,33,34,35,37,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,", CSTR(reqProcess)+"," ) = 0 Then reqProcess = 0</WTCUSTOM>
			</WTCODEGROUP>
<WTCUSTOM>
	'Set date range to previous month
	If reqOption = 0 Then
	reqFromDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqToDate = DateAdd( "d", -1, reqFromDate )
	reqFromDate = DateAdd( "m", -1, reqFromDate )
	End If
	'Set date range to current date
	If reqOption = 1 Then
	reqToDate = reqSysDate
	reqFromDate = reqSysDate
	End If
	'Set date range to previous month
	If reqOption = 2 Then
	reqToDate = CSTR(Month(reqSysDate)) + "/1/" + CSTR(Year(reqSysDate))
	reqFromDate = DateAdd( "m", -1, reqToDate )
	reqToDate = DateAdd( "d", -1, reqToDate )
	End If
	'Set date range to one month back from last Sunday
	If reqOption = 3 Then
	reqToDate = DateAdd( "d", -5, reqSysDate )
	reqFromDate = DateAdd( "m", -1, reqToDate )
	End If
	'Set date range to 1 week back
	If reqOption = 4 Then
	reqToDate = DateAdd( "d", -1, reqSysDate )
	reqFromDate = DateAdd( "d", -7, reqToDate )
	End If
	'Set date range to yesterday
	If reqOption = 5 Then
	reqFromDate = DateAdd( "d", -1, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 2 days ago
	If reqOption = 6 Then
	reqFromDate = DateAdd( "d", -2, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 3 days ago
	If reqOption = 7 Then
	reqFromDate = DateAdd( "d", -3, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 4 days ago
	If reqOption = 8 Then
	reqFromDate = DateAdd( "d", -4, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set date range to 5 days ago
	If reqOption = 9 Then
	reqFromDate = DateAdd( "d", -5, reqSysDate )
	reqToDate = reqFromDate
	End If
	'Set todate to 1 week back
	If reqOption = 11 Then
	reqToDate = DateAdd( "d", -7, reqSysDate )
	End If
	'Set todate to 2 weeks back
	If reqOption = 12 Then
	reqToDate = DateAdd( "d", -14, reqSysDate )
	End If
	'Set todate to 3 weeks back
	If reqOption = 13 Then
	reqToDate = DateAdd( "d", -21, reqSysDate )
	End If
	'Set todate to 4 weeks back
	If reqOption = 14 Then
	reqToDate = DateAdd( "d", -28, reqSysDate )
	End If
</WTCUSTOM>
			</WTACTION>
			
			<WTACTION id="1" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(FromDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)" connector="or"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(ToDate)" oper="equal" value="CONST(&quot;&quot;)"/>
						<WTERROR number="10115" message="Oops, Specify the date range to process." />
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
						<WTERROR number="10133" message="Oops, Please enter the required information." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>

					<!-- Create Billing Tokens -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						<WTCUSTOM>
							Result = BillingTokens()
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " New Billing Tokens Successfully Created! (" + aResult(1) + " bad)"
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Create Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(200)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payments Successfully Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Process Order Payments for Sales Orders and email bonus recipients -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						<WTCUSTOM>
							PaymentOwnerType = 52
							PostProcess = 1
							Result = ProcessPayments( reqCompanyID, PaymentOwnerType, "1/1/2099", PostProcess )
							aResult = Split(Result, "|")
							reqResult = aResult(0) + " Payments Successfully Processed! (" + aResult(1) + " bad)"
						</WTCUSTOM>
						<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult">
							<WTCONDITION expr="CONST(aResult(0))" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>

					<!-- List Declined Token -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Tokens!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="Level" direction="input" value="CONST(4)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Declined Payments Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Verify Bonus Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Earn Bonuses!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Calculate Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						<WTOBJECT name="Commission" project="ptsCommissionUser" class="CCommission">
							<WTMETHOD name="CustomCommissions">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="CommType" direction="input" value="CONST(1)"/>
								<WTPARAM name="FromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="CONST(Amount)" value="CONST(0)"/>
							<WTMETHOD name="TotalCommissions">
								<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="FromDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Bonuses Created! (&quot; &amp; FormatCurrency(Amount,2) &amp; &quot;) &quot;)"/>
						</WTOBJECT>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Count)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + &quot; from &quot; + CStr(reqFromDate) + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, reqResult"/>
						</WTCODEGROUP>
					</WTCODEGROUP>
					
					<!-- Display Hidden Bonuses -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(202)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Bonuses Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Create Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyPayouts">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New Payouts Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Payout Credits -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(4)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(30)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payment Credits Created!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Verify Payout Qualified -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(6)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Qualified to Receive a Payout!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Create Payout Files -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS MARK PAYOUTS PAID AMOUNT -->
						<WTCALLSUB name="ExportWallet reqCompanyID, 12, reqToDate, -1, tmpTotal, tmpFile, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/payout/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; PayQuicker eWallets (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;No Payouts to Export!&quot;)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>

							<!-- Mark Payouts Paid -->
							<!-- Pass Amount = -1 for NO Holdback for autoship -->
							<!-- MUST BE SAME AS EXPORT PAYOUTS AMOUNT -->
							<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
								<WTMETHOD name="CompanyStatus2">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="PaidDate" direction="input" value="SYS(Date)"/>
									<WTPARAM name="Amount" direction="input" value="CONST(-1)"/>
									<WTPARAM name="Reference" direction="input" value="CONST(&quot;3&quot;)"/>
									<WTPARAM name="Count" direction="return" datatype="number"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>

					</WTCODEGROUP>

					<!-- Mark Payouts Paid -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						<!-- Pass Amount = -1 for NO Holdback for autoship -->
						<!-- MUST BE SAME AS EXPORT PAYOUTS AMOUNT -->
<!--
						<WTOBJECT name="Payout" project="ptsPayoutUser" class="CPayout">
							<WTMETHOD name="CompanyStatus2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="PayDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="PaidDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(-1)"/>
								<WTPARAM name="Reference" direction="input" value="CONST(&quot;3&quot;)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Pending Payouts Marked Paid!&quot;)"/>
						</WTOBJECT>
-->						
					</WTCODEGROUP>
					
					<!-- Display Hidden Payouts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(203)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Hidden Payouts Displayed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Recalculate Group Sales Volume and Promotions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(1)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Group Sales Totals Recalculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- Post sales summary -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(2)"/>
								<WTPARAM name="czDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Sales Summary Postings!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
					
					<!-- List Enroller Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(90)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Enroller Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All New eWallets to be Created -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTOBJECT name="TellAlls" project="ptsTellAllUser" class="CTellAlls">
							<WTMETHOD name="CustomList">
								<WTPARAM name="Status" direction="input" value="CONST(3)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlTellAlls" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;New eWallets to be imported to iPayout in a .CSV file!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Assign New eWallets to Payout Method -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; New eWallets Assigned!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Mark GCC Payment Orders Pending (in process)-->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All New Global Cash Card orders marked pending!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Set All Member Alerts-->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(11)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Member Alerts Set!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Clean up Data -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(12)"/>
								<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Data Cleaned Up!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Export Submitted Orders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<!-- Export Green Fuel Tab Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export TellAll Max Inhouse Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; LM Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Export TellAll Max OIL Orders -->
						<WTCALLSUB name="ExportOrder reqCompanyID, 101, reqToDate, 3, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; LM-OIL Exported Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + &quot; to &quot; + CStr(reqToDate))"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>

							<!-- Update These Submitted Orders to InProcess -->
							<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
								<WTMETHOD name="Custom2">
									<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
									<WTPARAM name="Status" direction="input" value="CONST(101)"/>
									<WTPARAM name="OrderDate" direction="input" value="PARAM(ToDate)"/>
									<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
									<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								</WTMETHOD>
							</WTOBJECT>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Export Inprocess Orders -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 1, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; GFT Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="ExportOrder reqCompanyID, 102, 2, tmpFile, tmpTotal, tmpAmount"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(Total + tmpTotal)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(tmpTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/orders/&quot; + CStr(reqCompanyID) + &quot;/&quot; + tmpFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(tmpTotal) + &quot; TellAll Inprocess Orders (&quot; &amp; FormatCurrency(tmpAmount,2) &amp; &quot;)  &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE">
							<WTCONDITION expr="CONST(Total)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
-->
					
					<!-- Update Inprocess Orders to Complete -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="OrderDate" direction="input" value="SYS(Date)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Update Inprocess Orders to Complete -->
<!--
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						<WTOBJECT name="SalesOrder" project="ptsSalesOrderUser" class="CSalesOrder">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(102)"/>
								<WTPARAM name="SalesOrderID" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Order Status Updated to Complete!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Email Commissions -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						<WTCALLSUB name="CommissionEmail reqCompanyID, 0, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Commission Emails Sent&quot;)"/>
					</WTCODEGROUP>

					<!-- Recalculate All Title Advancements -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(15)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Title Advancements Calculated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>


					<!-- Export Payment to process -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						<WTSETATTRIBUTE name="CONST(PaymentOwnerType)" value="CONST(52)"/>
						<WTCALLSUB name="ExportPayments reqCompanyID, PaymentOwnerType, &quot;1/1/2099&quot;,  CCTotal, CKTotal, CCFile, CKFile, ErrorMsg"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(ErrorMsg)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTCUSTOM>
								response.write ErrorMsg
								response.end
							</WTCUSTOM>
						</WTCODEGROUP>
						<!-- Exported CC Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/Billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CCFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CCTotal) + &quot; CC Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>
						<!-- Exported ACH Payments -->
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CKTotal)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(URL)" value="CONST(&quot;http://www.pinnaclep.com/billing/&quot; + CStr(reqCompanyID) + &quot;/&quot; + CKFile)"/>
							<WTSETATTRIBUTE name="CONST(LINK)" value="CONST(&quot;&lt;a href=&quot;&quot;&quot; + URL + &quot;&quot;&quot; target=&quot;&quot;_blank&quot;&quot;&gt;&quot; + URL + &quot;&lt;/a&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(MSG)" value="CONST(CSTR(CKTotal) + &quot; ACH Payments &quot;)"/>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(reqResult + MSG + LINK + &quot;&lt;br&gt;&quot;)"/>
							<WTSETATTRIBUTE name="CONST(NOTE)" value="CONST(NOTE + MSG + URL + &quot;  &quot; + VBLF)"/>
						</WTCODEGROUP>

						<WTCODEGROUP>
							<WTCONDITION expr="CONST(CCTotal + CKTotal)" oper="not-equal" value="CONST(0)"/>
							<WTCALLSUB name="LogNote 38, reqCompanyID, NOTE"/>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Update Binary Sales -->
<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(201)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Payments Updated in the Binary Sales Volume!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>
-->
					<!-- Update Binary Counts -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
							<WTMETHOD name="Custom">
								<WTPARAM name="Status" direction="input" value="CONST(301)"/>
								<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Binary Downline member counts Updated!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Recruiters -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(99)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Recruiters!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Earners -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(98)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Earners!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Top Countries -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(97)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Top Countries!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Email Members with Declined Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						<WTSETATTRIBUTE name="CONST(Total)" value="CONST(0)"/>
						<WTCALLSUB name="DeclineEmail reqCompanyID, 0, 1, reqFromDate, reqToDate, tmpTotal"/>
						<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(tmpTotal &amp; &quot; Declined Payments Emailed!&quot;)"/>
					</WTCODEGROUP>

					<!-- Suspend Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(207)"/>
								<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Members Suspended with Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Cancel Suspended Payments -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
							<WTMETHOD name="Custom">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(208)"/>
								<WTPARAM name="EnrollDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(0)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
								<WTPARAM name="Count" direction="return" datatype="number"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(Count &amp; &quot; Suspended Members Cancelled with Declined Payments!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List All Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(105)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;All Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Enrolled Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(106)"/>
								<WTPARAM name="Level" direction="input" value="PARAM(MemberID)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Member #&quot; + CStr(reqMemberID) + &quot; Downline Enrolled Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Binary Member List -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(107)"/>
								<WTPARAM name="Level" direction="input" value="PARAM(MemberID)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Member #&quot; + CStr(reqMemberID) + &quot; Downline Binary Member List!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Salesorder Cash Payments to be processed -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(104)"/>  <!-- Cash Payments -->
								<WTPARAM name="Level" direction="input" value="CONST(1)"/> <!-- Salesorders -->-->
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Cash Payments to be Processed!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Salesorders -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						<WTOBJECT name="SalesOrders" project="ptsSalesOrderUser" class="CSalesOrders">
							<WTMETHOD name="CustomList2">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(101)"/>
								<WTPARAM name="ReportFromDate" direction="input" value="PARAM(FromDate)"/>
								<WTPARAM name="ReportToDate" direction="input" value="PARAM(ToDate)"/>
								<WTPARAM name="Quantity" direction="input" value="CONST(1)"/>
								<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTCUSTOM>
								For Each oItem in oSalesOrders
								With oItem
								.Result = CHR(34) + Replace(.Result, "|", CHR(34) + "," + CHR(34)) + CHR(34)
								End With
								Next
							</WTCUSTOM>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlSalesOrders" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Sales Orders!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- List Binary Orphan Affiliates -->
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)"/>
						<WTOBJECT name="Members" project="ptsMemberUser" class="CMembers">
							<WTMETHOD name="CustomList">
								<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
								<WTPARAM name="Status" direction="input" value="CONST(91)"/>
								<WTPARAM name="Level" direction="input" value="CONST(0)"/>
							</WTMETHOD>
							<WTMETHOD name="XML">
								<WTPARAM name="xmlMembers" direction="return" datatype="text"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(&quot;Binary Orphaned Affiliates!&quot;)"/>
						</WTOBJECT>
					</WTCODEGROUP>

				</WTCODEGROUP>
			</WTACTION>
			
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="800" align="center"/>
				
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTROW margin-top="12" margin-bottom="6">
						<WTSTATIC col="1" value="PARAM(Result)" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
					</WTROW>
				</WTCODEGROUP>

				<WTROW margin-top="24">
					<WTSTATIC col="1" class="PageHeading">
						<WTSTATIC label="NotAvailable">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTSTATIC label="BillingTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(1)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(3)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedTokens">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclinedPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateDeclined">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(6)"/>
						</WTSTATIC>
						<WTSTATIC label="BonusQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)"/>
						</WTSTATIC>
						<WTSTATIC label="CalcBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayBonuses">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(13)"/>
						</WTSTATIC>
						<WTSTATIC label="CreatePayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)"/>
						</WTSTATIC>
						<WTSTATIC label="PaymentCredits">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(22)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutQualified">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(23)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutFile">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)"/>
						</WTSTATIC>
						<WTSTATIC label="PayoutPaid">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)"/>
						</WTSTATIC>
						<WTSTATIC label="DisplayPayouts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(26)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(27)"/>
						</WTSTATIC>
						<WTSTATIC label="MaintainSummary">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)"/>
						</WTSTATIC>
						<WTSTATIC label="ListReferralOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						</WTSTATIC>
						<WTSTATIC label="CreateWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						</WTSTATIC>
						<WTSTATIC label="AssignWallets">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(31)"/>
						</WTSTATIC>
						<!--
						<WTSTATIC label="MarkGCC">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(32)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="SetAlerts">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(33)"/>
						</WTSTATIC>
						<WTSTATIC label="CleanupData">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(34)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(36)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersSubmitted">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(37)"/>
						</WTSTATIC>
						<WTSTATIC label="UpdateOrdersInprocess">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(38)"/>
						</WTSTATIC>
						<WTSTATIC label="EmailCommissions">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)"/>
						</WTSTATIC>
						<WTSTATIC label="TitleAdvancements">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(40)"/>
						</WTSTATIC>
						<WTSTATIC label="ExportPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(41)"/>
						</WTSTATIC>
<!--						
						<WTSTATIC label="UpdateBinarySales">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(42)"/>
						</WTSTATIC>
-->						
						<WTSTATIC label="UpdateBinaryCount">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(43)"/>
						</WTSTATIC>
						<WTSTATIC label="TopRecruiters">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						</WTSTATIC>
						<WTSTATIC label="TopEarners">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)"/>
						</WTSTATIC>
						<WTSTATIC label="TopCountries">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineEmail">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineSuspend">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)"/>
						</WTSTATIC>
						<WTSTATIC label="DeclineCancel">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)"/>
						</WTSTATIC>
						<WTSTATIC label="AllMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						</WTSTATIC>
						<WTSTATIC label="EnrollMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
						</WTSTATIC>
						<WTSTATIC label="BinaryMemberList">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)"/>
						</WTSTATIC>
						<WTSTATIC label="CashPayments">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)"/>
						</WTSTATIC>
						<WTSTATIC label="ListSalesOrders">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						</WTSTATIC>
						<WTSTATIC label="ListBinaryOrphans">
							<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(12)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(39)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(47)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)" connector="or"/>
					<WTSTATIC col="1" label="From" align="center" />
					<WTTEXT col="1" value="PARAM(FromDate)" name="FromDate" type="date" size="8" focus="true"/>
					<WTSTATIC col="1" label="To" />
					<WTTEXT col="1" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(2)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(11)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(21)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(24)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(25)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(35)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(28)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(48)" connector="or"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(49)" connector="or"/>
					<WTTEXT col="1" align="center" value="PARAM(ToDate)" name="ToDate" type="date" size="8" />
				</WTROW>
				<WTROW margin-top="12">
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)"/>
					<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
					<WTSTATIC col="1" tag="MemberID" align="center" />
					<WTTEXT col="1" align="center" value="PARAM(MemberID)" name="MemberID" size="8" />
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST('')"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(4)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(53)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTCODEGROUP><WTIMAGE value="CONST(Status&lt;xsl:value-of select=&quot;@status&quot;/&gt;.gif)" imgalign="absmiddle"/></WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(5)"/>
										<WTSTATIC space="1"/>
										<WTIMAGE value="CONST(cashregister.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0436d" return="false" target="Declines">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(financesm.gif)" alt="finances" imgalign="absmiddle">
											<WTLINK name="0475" return="false" target="Finances">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="Code" value="CONST(2)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(Level)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
									<WTSTATIC space="1"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(29)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(55)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(44)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(45)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(46)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;position()&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)" space="3"/>
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;@status&quot;/&gt;)" space="3"/>
<!--
									<WTCODEGROUP>
										<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
											<WTLINK name="0403" target="Member">
												<WTPARAM name="MemberID" value="DATA(MemberID)"/>
												<WTPARAM name="ContentPage" value="CONST(3)"/>
												<WTPARAM name="Popup" value="CONST(1)"/>
											</WTLINK>
										</WTIMAGE>
									</WTCODEGROUP>
-->									
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(50)"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(51)" connector="or"/>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(52)" connector="or"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="Member">
							<WTROW>
								<WTSTATIC col="1" align="left">
									<WTSTATIC value="CONST(&lt;xsl:value-of select=&quot;SIGNATURE/comment()&quot; disable-output-escaping=&quot;yes&quot;/&gt;)"/>
								</WTSTATIC>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(54)"/>
						<WTROW margin-top="12"/>
						<WTREPEAT entity="SalesOrder">
							<WTROW>
								<WTSTATIC col="1" value="DATA(Result)" align="left"/>
							</WTROW>
						</WTREPEAT>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Process)" oper="equal" value="CONST(30)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" label="eWalletHdr" align="left"/>
						</WTROW>
						<WTROW>
							<WTREPEAT entity="TellAll">
								<WTROW>
									<WTSTATIC col="1" value="DATA(Result)" align="left"/>
								</WTROW>
							</WTREPEAT>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTROW margin-bottom="12" margin-top="12">
					<WTBUTTON col="1" action="1" value="CONST(Process)" align="center">
						<WTCONDITION expr="PARAM(Process)" oper="not-equal" value="CONST(0)"/>
					</WTBUTTON>
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Member Change Membership Options Page -->
		<!--============================================================================================-->
		<WTWEBPAGE name="14901" caption="Change Membership" navbar="false" header="false" footer="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="14901" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="OrderOption" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="Amount" datatype="number"/>
			<WTPARAM name="BillingPrice" datatype="number"/>
			<WTPARAM name="CountryID" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="Result" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(19)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="NewBilling">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(1)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(2)">
						<WTCONDITION expr="ATTR(Title)" oper="equal" value="CONST(2)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
				</WTOBJECT>
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Upgrade.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="FetchOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryID)" value="ATTR(CountryID)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewBilling"/>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to recurring billing."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(0)"/>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(1)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					<WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdateBilling)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					
					<WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="CONST(oldTitle)" value="ATTR(Member.Title)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>

					<!-- **************************************************************** -->
					<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(0)"/>

					<WTCODEGROUP>
						<!-- Acct Mgr and Marketing System -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102,201&quot;)"/>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(19.95)"/>
						<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(199.95)"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Account Manager -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(1)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102&quot;)"/>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(199.95)"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Marketing System Only -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(.Options2 + &quot;,201&quot;)"/>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(19.95)"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Remove Marketing System Only -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(.Options2 + Replace(&quot;,201&quot;,&quot;&quot;))"/>
						<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="CONST(newTitle)" value="ATTR(Title)"/>

					<!-- Temporarily turn off payment processing-->
<!--					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="CONST(0)"/>-->

					<WTCODEGROUP>
						<WTCONDITION expr="ATTR(Qualify)" oper="not-equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(2)"/>
						<WTSETATTRIBUTE name="ATTR(Qualify)" value="CONST(1)">
							<WTCONDITION expr="ATTR(Level)" oper="equal" value="CONST(0)"/>
						</WTSETATTRIBUTE>
					</WTCODEGROUP>

					<!-- If there is a change to the membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdate)" oper="not-equal" value="CONST(0)"/>
						<!-- Get Payment -->
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
							<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(1)"/>

							<WTCUSTOM>
								tmpProcessor = ""
								tmpAcct = ""
								Select Case reqPayType
								Case 1, 2, 3, 4	'Process Credit Cards
								tmpProcessor = tmpCardProcessor
								tmpAcct = tmpCardAcct
								Case 5 'Process Electronic Checks
								tmpProcessor = tmpCheckProcessor
								tmpAcct = tmpCheckAcct
								End Select
							</WTCUSTOM>
							<WTCALLSUB name="Result = SubmitPayment( reqCompanyID, reqMemberID, reqPayType, reqPayDesc, reqBillingPrice, Purpose, PostProcess )"/>
<!--						<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqMemberID, 0, reqPayType, reqPayDesc, reqBillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>-->
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
								<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
								<WTCODEGROUP>
									<WTCONDITION expr="CONST(tmpUpdatePaidDate)" oper="not-equal" value="CONST(0)"/>
									<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))"/>
									<WTMETHOD name="Save">
										<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
									</WTMETHOD>
								</WTCODEGROUP>
							</WTCODEGROUP>
						</WTCODEGROUP>
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMember" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
						<!-- log the membership change -->
						<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE: (&quot; + oldOptions2 + &quot;) to (&quot; + .Options2 + &quot;)&quot;">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
						<WTCALLSUB name="reqBillingPrice = FormatCurrency( reqBillingPrice, 2 )">
							<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>

				<!-- If there is a change to the member's title (or they activated) -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(newTitle)" oper="not-equal" value="CONST(oldTitle)"/>
						<!-- log the title change -->
						<WTOBJECT name="MemberTitle" project="ptsMemberTitleUser" class="CMemberTitle">
							<WTSETATTRIBUTE name="ATTR(MemberTitle.MemberID)" value="PARAM(MemberID)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.TitleDate)" value="SYS(Now)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.Title)" value="CONST(newTitle)"/>
							<WTSETATTRIBUTE name="ATTR(MemberTitle.IsEarned)" value="CONST(1)"/>
							<WTMETHOD name="Add">
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
						</WTOBJECT>
						<!-- notify the referrer -->
						<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
							<WTCONDITION expr="CONST(tmpReferralID)" oper="not-equal" value="CONST(0)"/>
							<WTMETHOD name="Load">
								<WTPARAM name="MemberID" direction="input" value="CONST(tmpReferralID)"/>
								<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
							</WTMETHOD>
							<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Member.Email)"/>
							<WTCUSTOM>
								tmpSender = "support@freeloyaty.net"
								tmpFrom = "support@freeloyaty.net"
								Select Case newTitle
								Case 2
								tmpSubject = tmpName + " has upgraded to an Account Manager"
								End Select
								tmpBody = tmpSubject
								SendEmail reqCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
							</WTCUSTOM>
						</WTOBJECT>
					</WTCODEGROUP>

					<!-- Custom Upgrade Processing -->
					<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
						<WTMETHOD name="Custom">
							<WTPARAM name="Status" direction="input" value="CONST(102)"/>
							<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="PARAM(MemberID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Result" direction="return" datatype="text"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE ERROR: &quot; + xmlError"/>
				</WTCODEGROUP>

			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>
			
			<WTACTION id="4" name="logout" type="Cancel">
				<WTRETURN>
					<WTLINK name="0101" nodata="true">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="175" align="center"/>
				<WTCOLUMN width="575" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="PARAM(CountryID)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
					//var payobj = Member.elements['PayType'];
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
					//var countryid = document.getElementById('CountryID').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none';
					var paytype = payobj.value;
					//var l = payobj.length;
					//for( i = 0; i &lt; l; i++ ) {
					//	if (payobj[i].checked) {
					//		paytype = payobj[i].value;
					//		i = l;
					//	}
					//}
					//if (paytype == 5) {
					//	if ( countryid != 224 ) {
					//		paytype = 1;
					//		document.getElementById('PayType').value = paytype;
					//		alert("Electronic Checks not available outside the United States");
					//	}
					//}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
					ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowCC()">
					var disp, computers = document.getElementById('Computers').value;
					if( computers == 0 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					document.getElementById('Payment').style.display = disp;
					document.getElementById('CardRows').style.display = disp;
					document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="formatCurrency(num)">
					num = num.toString().replace(/\$|\,/g,'');
					if(isNaN(num))
					num = "0";
					sign = (num == (num = Math.abs(num)));
					num = Math.floor(num*100+0.50000000001);
					cents = num%100;
					num = Math.floor(num/100).toString();
					if(cents&lt;10)
					cents = "0" + cents;
					for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
					num = num.substring(0,num.length-(4*i+3))+','+
					num.substring(num.length-(4*i+3));
					return (((sign)?'':'-') + '$' + num + '.' + cents);
					//return (((sign)?'':'-') + '$' + num);
				</WTFUNCTION>
				
				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="2"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="SuccessfulChange" value="ATTR(Member.Price)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(BillingPrice)" oper="not-equal" value="CONST(0)"/>
						<WTSTATIC col="1" merge="2" label="SuccessfulPayment" value="PARAM(BillingPrice)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="2" label="Relogin" align="center" class="PageHeading" fontcolor="Red"/>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="24">
							<WTBUTTON col="1" merge="2" action="4" value="CONST(Logout)" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="24">
						<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(1)"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Continue)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>

					<WTROW margin-bottom="12">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="690" align="left"/>
							
							<!-- Upgrade to Account Manager -->
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Member.Title)" oper="less-equal" value="CONST(1)"/>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
									<WTSTATIC col="3" label="Membership18_1"/>
								</WTROW>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
									<WTSTATIC col="3" label="Membership18_2"/>
								</WTROW>
							</WTCODEGROUP>
							<!-- Upgrade to Marketing System -->
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Member.Title)" oper="greater-equal" value="CONST(2)"/>
								<WTCONDITION expr="ATTR(Member.Level)" oper="equal" value="CONST(1)" connector="and"/>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
									<WTSTATIC col="3" label="Membership18_3"/>
								</WTROW>
							</WTCODEGROUP>
							<!-- Remove Marketing System -->
							<WTCODEGROUP>
								<WTCONDITION expr="ATTR(Member.Title)" oper="greater-equal" value="CONST(2)"/>
								<WTCONDITION expr="ATTR(Member.Level)" oper="greater-equal" value="CONST(2)" connector="and"/>
								<WTROW margin-top="12">
									<WTSTATIC col="1"/>
									<WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
									<WTSTATIC col="3" label="Membership18_4"/>
								</WTROW>
							</WTCODEGROUP>
						</WTTABLE>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr = "ATTR(Member.BillingID)" oper="equal" value="CONST(0)" />
						<WTROW margin-top="12" id="Agree2">
							<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW id="Payment">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="750" align="center"/>

								<WTROW margin-top="12" margin-bottom="12">
									<WTDIVIDER col="1" height="1" color="#584b42"/>
								</WTROW>
								<WTROW id="Pay2" margin-bottom="6">
									<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="6">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="CardRows">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="BillingAddress" />
									<WTTEXT col="2" value="PARAM(Street1b)" size="60">
										<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left" required="true">
										<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
						</WTROW>
					</WTCODEGROUP>
					
					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Change)" align="center">
							<WTCONDITION expr="ATTR(Member.Title)" oper="less-equal" value="CONST(4)"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="14902" caption="TellAll Stats" header="false" footer="false" navbar="false" action="0" wrapper="wrapper600"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl" langfile="14902" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="Day" datatype="number"/>
			<WTPARAM name="Today" datatype="text"/>

			<WTDATATXN name="Stats"/>

			<WTCODEGROUP>
				<WTCUSTOM>
					If reqDay &gt; 0 Then reqToday = DateAdd("d", reqDay * -1, reqSysDate) Else reqToday = reqSysDate
					Select Case DATEPART("w", reqToday )
					Case 1 reqToday = reqToday &amp; " Sunday"
					Case 2 reqToday = reqToday &amp; " Monday"
					Case 3 reqToday = reqToday &amp; " Tuesday"
					Case 4 reqToday = reqToday &amp; " Wednesday"
					Case 5 reqToday = reqToday &amp; " Thursday"
					Case 6 reqToday = reqToday &amp; " Friday"
					Case 7 reqToday = reqToday &amp; " Saturday"
					End Select
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="TellAll" project="ptsTellAllUser" class="CTellAll">
					<WTMETHOD name="Custom">
						<WTPARAM name="Status" direction="input" value="CONST(7)"/>
						<WTPARAM name="czDate" direction="input" value="CONST(0)"/>
						<WTPARAM name="Quantity" direction="input" value="PARAM(Day)"/>
						<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
						<WTPARAM name="xmlStats" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="300" align="center"/>
				<WTCOLUMN width="6" align="center"/>
				<WTCOLUMN width="300" align="center"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
						<WTCODEGROUP>
							<WTIMAGE value="CONST(Performance32.gif)" imgalign="absmiddle"/>
						</WTCODEGROUP>
						<WTSTATIC space="1"/>
						<WTSTATIC label="TellAllStatistics"/>
						<WTSTATIC value="CONST( - )"/>
						<WTSTATIC value="PARAM(Today)"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTTABLE col="1" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="105" align="right"/>
								<WTCOLUMN width="65" align="center"/>
								<WTCOLUMN width="65" align="center"/>
								<WTCOLUMN width="65" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Affiliates"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1"/>
									<WTSTATIC col="2" label="Today" bold="true"/>
									<WTSTATIC col="3" label="Week" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>

								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="5" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="M1" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m11)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m17)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m199)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="M2" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m21)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m27)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m299)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="M3" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m31)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m37)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m399)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="M4" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m41)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m47)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m499)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="M5" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m51)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m57)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m599)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="M6" align="right"/>
									<WTSTATIC col="2" value="ATTR(Stats.m61)"/>
									<WTSTATIC col="3" value="ATTR(Stats.m67)"/>
									<WTSTATIC col="4" value="ATTR(Stats.m699)"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" tag="Total" align="right" bold="true"/>
									<WTSTATIC col="2" value="ATTR(Stats.t1)" bold="true"/>
									<WTSTATIC col="3" value="ATTR(Stats.t7)" bold="true"/>
									<WTSTATIC col="4" value="ATTR(Stats.t99)" bold="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
					<WTSTATIC col="2"/>
					<WTTABLE col="3" valign="top">
						<WTCOLUMN width="300" align="center"/>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Sales"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Today" bold="true" align="center"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.S1)" align="center"/>
									<WTSTATIC col="2" value="ATTR(Stats.S7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.S30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.S99)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW margin-bottom="6">
							<WTTABLE col="1" valign="top" padding="0" style="border: 1px #5084A2 solid" backcolor="White">
								<WTCOLUMN width="75" align="right"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>
								<WTCOLUMN width="75" align="center"/>

								<WTROW>
									<WTSTATIC col="1" merge="4" height="18" align="center" valign="middle" backcolor="#D8EEFB" background="bg_table_head.gif">
										<WTSTATIC fontcolor="darkblue" bold="true">
											<WTSTATIC label="Bonuses"/>
										</WTSTATIC>
									</WTSTATIC>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTDIVIDER col="1" merge="4" height="1" color="#5084A2"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" label="Today" bold="true" align="center"/>
									<WTSTATIC col="2" label="Days7" bold="true"/>
									<WTSTATIC col="3" label="Days30" bold="true"/>
									<WTSTATIC col="4" label="Total" bold="true"/>
								</WTROW>
								<WTROW margin-bottom="3">
									<WTSTATIC col="1" value="ATTR(Stats.B1)" align="center"/>
									<WTSTATIC col="2" value="ATTR(Stats.B7)"/>
									<WTSTATIC col="3" value="ATTR(Stats.B30)"/>
									<WTSTATIC col="4" value="ATTR(Stats.B99)"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="12" margin-bottom="12">
					<WTSTATIC col="1" merge="3" tag="DaysBack" align="center"/>
					<WTTEXT col="1" value="PARAM(Day)" size="1" prespace="false" focus="true"/>
					<WTBUTTON col="1" action="0" value="Refresh" btnclass="smbutton"/>
					<WTBUTTON col="1" value="Close" btnclass="smbutton">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Custom New Member Enrollment Form -->
		<!--============================================================================================-->
		<WTWEBPAGE name="14903" caption="New Customer" navbar="false" header="false" footer="false" stylesheet="StyleSheetJoin.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="14903" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="NewMemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="PayID" datatype="number"/>
			<WTPARAM name="GroupID" datatype="number"/>
			<WTPARAM name="ReferID" datatype="number"/>
			<WTPARAM name="IsAgree" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="ReferredBy" datatype="text"/>
			<WTPARAM name="Title" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="OrderOption" datatype="number"/>
			<WTPARAM name="Retail" datatype="number"/>
			<WTPARAM name="PaymentOptions" datatype="text" />
			<WTPARAM name="Option" datatype="number"/>
			<WTPARAM name="Billing" datatype="number"/>
			<WTPARAM name="BillDay" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="NoBanner" datatype="number"/>
			<WTPARAM name="NoPayment" datatype="number"/>
			<WTPARAM name="NoRefer" datatype="number"/>
			<WTPARAM name="NoValidate" datatype="number"/>
			<WTPARAM name="TextEmail" datatype="number"/>
			<WTPARAM name="NoPayout" datatype="number"/>
			<WTPARAM name="GetMemberID" datatype="number"/>
			<WTPARAM name="BillOneTime" datatype="number"/>
			<WTPARAM name="AutoShipMonths" datatype="number"/>
			<WTPARAM name="RegisterWallet" datatype="number"/>

			<!-- Referring Member -->
			<WTPARAM name="M" datatype="number"/>
			<!-- Sponsor -->
			<WTPARAM name="S" datatype="number"/>
			<!-- CompanyID -->
			<WTPARAM name="C" datatype="number"/>
			<!-- Sponsor3ID (Binary) -->
			<WTPARAM name="S3" datatype="number"/>
			<WTPARAM name="Pos" datatype="number"/>
			<WTPARAM name="Placement" datatype="text"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>
			<WTPARAM name="CountryID" datatype="text"/>
			<WTPARAM name="CountryName" datatype="text"/>
			<WTPARAM name="CountryNameb" datatype="text"/>

			<WTPARAM name="TokenType" datatype="number"/>
			<WTPARAM name="TokenOwner" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Mode" datatype="number"/>
			<WTPARAM name="BadPayment" datatype="number"/>
			<WTPARAM name="CashPayment" datatype="number"/>
			<WTPARAM name="Wallet" datatype="text"/>
			<WTPARAM name="NotifyCompany" datatype="text"/>

			<WTPARAM name="Data1" datatype="text"/>
			<WTPARAM name="Data2" datatype="text"/>
			<WTPARAM name="Data3" datatype="text"/>
			<WTPARAM name="Data4" datatype="text"/>
			<WTPARAM name="Data5" datatype="text"/>
			<WTPARAM name="Data6" datatype="text"/>
			<WTPARAM name="Data7" datatype="text"/>
			<WTPARAM name="Data8" datatype="text"/>
			<WTPARAM name="Data9" datatype="text"/>
			<WTPARAM name="Data10" datatype="text"/>
			<WTPARAM name="Data11" datatype="text"/>
			<WTPARAM name="Data12" datatype="text"/>
			<WTPARAM name="Data13" datatype="text"/>
			<WTPARAM name="Shipping" datatype="text"/>

			<!-- Mode 0 ... Agreement -->
			<!-- Mode 1 ... Contact Info -->
			<!-- Mode 2 ... Membership Selection -->
			<!-- Mode 3 ... Payment -->
			<!-- Mode 4 ... Confirmation -->
			<!-- Mode 5 ... Process/Welcome -->

			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Wallet.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(Shipping)" value="CONST(&quot;$10.00&quot;)">
					<WTCONDITION expr="PARAM(Data1)" oper="equal" value="CONST(&quot;1&quot;)"/>
					<WTCONDITION expr="PARAM(Data2)" oper="not-equal" value="CONST(&quot;My-Own&quot;)" connector="and"/>
				</WTSETATTRIBUTE>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(TELLALLMOBILE)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(C)" oper="not-equal" value="CONST(0)" />
					<WTSETATTRIBUTE name="PARAM(CompanyID)" value="PARAM(C)"/>
				</WTCODEGROUP>
				<WTSETATTRIBUTE name="SYS(CompanyID)" value="PARAM(CompanyID)"/>
				<WTSETCACHE name="SYS(CompanyID)" value="SYS(CompanyID)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTGETCACHE name="PARAM(M)" value="A" datatype="number"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(M)" oper="equal" value="CONST(0)" />
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="PARAM(M)" value="PARAM(MemberID)"/>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="PARAM(MemberID)" value="PARAM(M)"/>
				<WTSETATTRIBUTE name="PARAM(ReferID)" value="PARAM(M)"/>
				<!--
				<WTSETATTRIBUTE name="PARAM(S)" value="PARAM(M)">
					<WTCONDITION expr="PARAM(S)" oper="equal" value="CONST(0)" />
				</WTSETATTRIBUTE>
-->
				<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)">
					<WTCONDITION expr="PARAM(CountryIDb)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(&quot;No Referrer&quot;)">
					<WTCONDITION expr="PARAM(NoRefer)" oper="not-equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>

				<WTSETATTRIBUTE name="CONST(ValidMemberStatus)" value="CONST(&quot;1234&quot;)"/>

				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTSETATTRIBUTE name="PARAM(CashPayment)" value="CONST(1)"/>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<WTCODEGROUP>
				<WTCONDITION expr="SYS(ActionCode)" oper="greater-equal" value="CONST(1)"/>
				<WTCONDITION expr="SYS(ActionCode)" oper="less-equal" value="CONST(4)" connector="and"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree)" value="FORM(IsAgree)"/>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>
				<WTSETATTRIBUTE name="PARAM(IsAgree2)" value="FORM(IsAgree2)"/>
				<WTCALLSUB name="LoadMember"/>
			</WTCODEGROUP>

			<!-- Custom Company Setup -->
			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(TextEmail)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(NoPayout)" value="CONST(1)"/>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
					<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Data1)" value="CONST(&quot;1&quot;)">
					<WTCONDITION expr="PARAM(Data1)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(Data8)" value="CONST(&quot;1&quot;)">
					<WTCONDITION expr="PARAM(Data8)" oper="equal" value="CONST(&quot;&quot;)"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCompanyOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadCountrys">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadPaymentOptions">
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PaymentOptions)" value="ATTR(PaymentOptions)" />
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadAgree">
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Enroll2.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(ReferID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(ReferredBy)" value="ATTR(CompanyName)">
						<WTCONDITION expr="ATTR(IsCompany)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCUSTOM>
						If InStr( ValidMemberStatus, .Status ) = 0 Then
						Response.Write "The Member that referred you here is Inactive! (" + reqReferredBy + " #" + CStr(reqM) + ")"
						Response.End
						End If
					</WTCUSTOM>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidLogon">
				<WTSETATTRIBUTE name="CONST(tmpNewLogon)" value="FORM(NewLogon)"/>
				<WTSETATTRIBUTE name="CONST(tmpNewPassword)" value="FORM(NewPassword)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10101" message="Oops, Your Logon Name must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewPassword))" oper="less" value="CONST(6)" connector="and"/>
					<WTERROR number="10102" message="Oops, Your Password must be at least six characters/numbers long."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(Len(tmpNewLogon))" oper="greater" value="CONST(0)" connector="and"/>
					<WTOBJECT name="AuthUser" project="ptsAuthUser" class="CAuthUser">
						<WTMETHOD name="IsLogon">
							<WTPARAM name="IsAvailable" direction="return" datatype="number"/>
							<WTPARAM name="Logon" direction="input" value="CONST(tmpNewLogon)"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(IsAvailable)" oper="equal" value="CONST(0)"/>
						<WTERROR number="-2147220513" message="Oops, The Logon Name is not available.  Please select another or contact Member Support for assistance."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidAddress">
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors" />
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="CONST(-1)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)" />
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Validate">
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidPhone">
<!--
				<WTSETATTRIBUTE name="CONST(tmpPhone)" value="FORM(Phone1)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="CONST(tmpPhone)" oper="equal" value="CONST(&quot;&quot;)"/>
					<WTERROR number="10006" message="Oops, Phone Number is Required."/>
				</WTCODEGROUP>
-->				
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTSETATTRIBUTE name="CONST(tmpCheckRoute)" value="FORM(CheckRoute)" />

				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)"/>
					<WTMETHOD name="ValidCheckRoute">
						<WTPARAM name="CheckRoute" direction="input" value="CONST(tmpCheckRoute)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10007" message="Oops, Invalid Check Routing Number." />
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<WTSETATTRIBUTE name="CONST(reqPayType)" value="CONST(CLng(result))" />
						<!-- <WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<!--					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>-->
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="greater-equal" value="SYSCON(PAYTYPE-WALLET)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-WALLET)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(Wallet)" />
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="AddMember">
				<!-- get company options -->
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpPrice1)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice2)" value="ATTR(Price2)"/>
					<WTSETATTRIBUTE name="CONST(tmpPrice3)" value="ATTR(Price3)"/>
					<WTSETATTRIBUTE name="SYS(UserOptions)" value="ATTR(Options)"/>
					<WTSETATTRIBUTE name="CONST(tmpSendEmail)" value="ATTR(IsNewEmail)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletType)" value="ATTR(WalletType)"/>
					<WTSETATTRIBUTE name="CONST(tmpWalletAcct)" value="ATTR(WalletAcct)"/>
					<WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					<WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				</WTOBJECT>

				<!-- get referrer's group # -->
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(ReferID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(GroupID)" value="ATTR(GroupID)"/>
					<WTSETATTRIBUTE name="CONST(ReferEmail)" value="ATTR(Email2)"/>
				</WTOBJECT>

				<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
					<WTMETHOD name="Load">
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(CompanyEmail)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="PARAM(NotifyCompany)" value="ATTR(Email)">
						<WTCONDITION expr="PARAM(NotifyCompany)" oper="not-equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
				</WTOBJECT>

				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(NewMemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>

					<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(tmpPrice)"/>
					<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(Price)"/>
					<WTSETATTRIBUTE name="ATTR(PaidDate)" value="SYS(Date)">
						<WTCONDITION expr="PARAM(BillDay)" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
						<WTCUSTOM>
							mo = DATEPART( "m", DATE())
							yr = DATEPART( "yyyy", DATE())
							If reqBillDay = 1 Then
							tmpDate = CSTR(mo) + "/1/" + CSTR(yr)
							.PaidDate = DateAdd( "m", 1, tmpDate )
							Else
							.PaidDate = CSTR(mo) + "/" + CSTR(reqBillDay) + "/" + CSTR(yr)
							End If
						</WTCUSTOM>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="ATTR(Status)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;Enrollment&quot;)"/>

					<!-- Custom Company Setup -->
					<WTCODEGROUP>
						<WTSETATTRIBUTE name="ATTR(Level)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Title)" value="CONST(0)"/>
						<WTCODEGROUP>
							<!-- 1GB -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;101,111&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;101&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(34.88)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(46.51)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- 3GB -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;102,112&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;102&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(46.51)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(58.14)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- 5GB -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;103,113&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;103&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(58.14)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(69.77)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Unlimited -->
							<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;104,114&quot;)"/>
							<WTSETATTRIBUTE name="CONST(Purpose)" value="CONST(&quot;104&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(69.77)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(81.40)"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<!-- Shipping Charges -->
							<WTCONDITION expr="PARAM(Shipping)" oper="not-equal" value="CONST(&quot;&quot;)"/>
							<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(&quot;100,&quot; + .Options2)"/>
							<WTSETATTRIBUTE name="ATTR(InitPrice)" value="CONST(CCUR(.InitPrice) + CCUR(reqShipping))"/>
							<WTSETATTRIBUTE name="CONST(BillingPrice)" value="ATTR(InitPrice)"/>
						</WTCODEGROUP>
						<!-- SAVE ORDER OPTIONS -->
						<WTCUSTOM>
							If reqData1 = "2" Then
								reqData2 = ""
								reqData3 = ""
								reqData4 = ""
								reqData5 = ""
								reqData6 = ""
								reqData7 = ""
							End If
							If reqData8 = "1" Then
								reqData9 = ""
							End If
							If reqData8 = "2" Then
								reqData10 = ""
								reqData11 = ""
								reqData12 = ""
								reqData13 = ""
							End If
							.Identification = reqData1 + "|" + reqData2 + "|" + reqData3 + "|" + reqData4 + "|" + reqData5 + "|" + reqData6 + _
							"|" + reqData7 + "|" + reqData8 + "|" + reqData9 + "|" + reqData10 + "|" + reqData11 + "|" + reqData12 + "|" + reqData13
						</WTCUSTOM>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NewMemberID)" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyID)" value="PARAM(CompanyID)"/>
						<WTSETATTRIBUTE name="ATTR(EnrollDate)" value="SYS(now)"/>
						<WTSETATTRIBUTE name="ATTR(UserStatus)" value="SYSCON(USER-ACTIVE)"/>
						<WTSETATTRIBUTE name="ATTR(UserGroup)" value="SYSCON(USER-MEMBER)"/>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="PARAM(Billing)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(Billing)" oper="equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(3)"/>
							<WTSETATTRIBUTE name="ATTR(Billing)" value="CONST(1)">
								<WTCONDITION expr="PARAM(NoBill)" oper="not-equal" value="CONST(0)"/>
							</WTSETATTRIBUTE>
						</WTCODEGROUP>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTSETATTRIBUTE name="ATTR(PayID)" value="PARAM(PayID)"/>
						<WTSETATTRIBUTE name="ATTR(GroupID)" value="PARAM(GroupID)"/>
						<WTSETATTRIBUTE name="ATTR(AccessLimit)" value="CONST(&quot;NONE&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(.NameLast + &quot;, &quot; + .NameFirst)">
							<WTCONDITION expr="ATTR(CompanyName)" oper="equal" value="CONST(&quot;&quot;)"/>
						</WTSETATTRIBUTE>
						<WTSETATTRIBUTE name="ATTR(Member.Signature)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot;&lt;BR&gt;&quot; + .Email + &quot;&lt;BR&gt;&quot; + .Phone1)"/>
						<WTSETATTRIBUTE name="ATTR(NotifyMentor)" value="CONST(&quot;A&quot;)"/>

						<WTSETATTRIBUTE name="ATTR(ReferralID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(MentorID)" value="PARAM(ReferID)"/>
						<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(S)"/>

						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(S)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(SponsorID)" value="PARAM(S)"/>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(S3)" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="ATTR(Sponsor3ID)" value="PARAM(S3)"/>
							<WTSETATTRIBUTE name="ATTR(Pos)" value="PARAM(Pos)"/>
						</WTCODEGROUP>

						<WTMETHOD name="Add">
							<WTPARAM name="reqNewMemberID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>

					<!-- Get Payment -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
						<!-- Payment Post Processing is done after the new member is activated below -->
						<WTSETATTRIBUTE name="CONST(PostProcess)" value="CONST(0)"/>
						<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(0)"/>
						<WTCUSTOM>
							tmpProcessor = 0
							tmpAcct = ""
							Select Case reqPayType
							Case 1, 2, 3, 4	'Process Credit Cards
							tmpProcessor = tmpCardProcessor
							tmpAcct = tmpCardAcct
							Case 5 'Process Electronic Checks
							tmpProcessor = tmpCheckProcessor
							tmpAcct = tmpCheckAcct
							Case 11, 12, 13 'Process Wallets
							tmpProcessor = GetWalletProcessor( tmpWalletType, tmpWalletAcct, reqPayType, tmpAcct )
							End Select
						</WTCUSTOM>
						<WTCALLSUB name="Result = GetPayment( reqCompanyID, reqNewMemberID, 0, reqPayType, reqPayDesc, BillingPrice, Purpose, tmpProcessor, tmpAcct, PostProcess, EmailBonuses )"/>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="equal" value="CONST(0)"/>
							<WTCUSTOM>DoError 0, "", Result</WTCUSTOM>
						</WTCODEGROUP>
						<WTCODEGROUP>
							<WTCONDITION expr="CONST(IsNumeric(Result))" oper="not-equal" value="CONST(0)"/>
							<WTSETATTRIBUTE name="CONST(PaymentID)" value="CONST(CLng(Result))"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(BillOneTime)" oper="not-equal" value="CONST(1)"/>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, 1, .PaidDate))">
									<WTCONDITION expr="PARAM(AutoShipMonths)" oper="equal" value="CONST(0)"/>
								</WTSETATTRIBUTE>
								<WTSETATTRIBUTE name="ATTR(PaidDate)" value="CONST(DATEADD(&quot;m&quot;, reqAutoShipMonths, .PaidDate))">
									<WTCONDITION expr="PARAM(AutoShipMonths)" oper="not-equal" value="CONST(0)"/>
								</WTSETATTRIBUTE>
								<WTMETHOD name="Save">
									<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
								</WTMETHOD>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>

					<!-- Send Welcome Email w/ Logon and Password -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(tmpSendEmail)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>
							Set oHTTP = server.CreateObject("MSXML2.ServerXMLHTTP")
							If oHTTP Is Nothing Then
							Response.Write "Error #" &amp; Err.number &amp; " - " + Err.description
							Else
							oHTTP.open "GET", "http://" + reqSysServerName + reqSysServerPath + "0105.asp?AuthUserID=" &amp; .AuthUserID + "&amp;v=2"
							oHTTP.send
							End If
							Set oHTTP = Nothing
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Send BitCoin Payment Request -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(PayType)" oper="equal" value="SYSCON(BILL-PAYTYPE-WALLET-BITCOIN)" connector="and"/>
						<WTCONDITION expr="CONST(PaymentID)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTCUSTOM>
							result = SendBitCoinRequest( reqCompanyID, .Email, Purpose, BillingPrice, PaymentID )
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Send notice to Referrer -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="CONST(ReferEmail)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
						<WTCUSTOM>
							tmpSubject = "NEW REFERRED CUSTOMER: " + tmpNameFirst + " " + tmpNameLast + " - " + tmpEmail
							tmpBody = ""
							SendEmail reqCompanyID, CompanyEmail, CompanyEmail, ReferEmail, "", "", tmpSubject, tmpBody
						</WTCUSTOM>
					</WTCODEGROUP>

					<!-- Send notice to Company -->
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(NotifyCompany)" oper="not-equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)" />
						<WTSETATTRIBUTE name="CONST(tmpPhone1)" value="FORM(Phone1)" />
						<WTSETATTRIBUTE name="CONST(tmpStreet1)" value="FORM(Street1)" />
						<WTSETATTRIBUTE name="CONST(tmpStreet2)" value="FORM(Street2)" />
						<WTSETATTRIBUTE name="CONST(tmpCity)" value="FORM(City)" />
						<WTSETATTRIBUTE name="CONST(tmpState)" value="FORM(State)" />
						<WTSETATTRIBUTE name="CONST(tmpZip)" value="FORM(Zip)" />
						<WTCUSTOM>
							tmpSubject = "NEW MEMBER: " + tmpNameFirst + " " + tmpNameLast
							tmpBody = tmpNameFirst + " " + tmpNameLast + "&lt;BR&gt;"
							tmpBody = tmpBody + "Email: " + tmpEmail + "&lt;BR&gt;"
							tmpBody = tmpBody + "Phone: " + tmpPhone1 + "&lt;BR&gt;"
							tmpBody = tmpBody + tmpStreet1 + " " + tmpStreet2 + "&lt;BR&gt;"
							tmpBody = tmpBody + tmpCity + ", " + tmpState + " " + tmpZip + "&lt;BR&gt;"
							SendEmail reqCompanyID, reqNotifyCompany, reqNotifyCompany, reqNotifyCompany, "", "", tmpSubject, tmpBody
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(OwnerType)" value="ENTITY(Member)"/>
					<WTSETATTRIBUTE name="ATTR(OwnerID)" value="PARAM(NewMemberID)"/>
					<WTSETATTRIBUTE name="ATTR(AddressType)" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					<WTSETATTRIBUTE name="ATTR(IsActive)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTCONDITION expr="ATTR(Street1)" oper="not-equal" value="CONST(&quot;&quot;)"/>
						<WTPARAM name="tmpAddressID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>

				<!-- Custom Company Activation Processing -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(100)"/>
							<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="PARAM(NewMemberID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
				</WTCODEGROUP>

				<!-- Custom Company Payment Post Processing -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="CONST(BillingPrice)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
					<WTOBJECT name="Company" project="ptsCompanyUser" class="CCompany">
						<WTMETHOD name="Custom">
							<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)"/>
							<WTPARAM name="Status" direction="input" value="CONST(99)"/>
							<WTPARAM name="EnrollDate" direction="input" value="CONST(0)"/>
							<WTPARAM name="Quantity" direction="input" value="CONST(PaymentID)"/>
							<WTPARAM name="Amount" direction="input" value="CONST(0)"/>
							<WTPARAM name="Count" direction="return" datatype="number"/>
						</WTMETHOD>
					</WTOBJECT>
					<WTCALLSUB name="CommissionEmail reqCompanyID, PaymentID, 0, 0, tmpTotal">
						<WTCONDITION expr="CONST(EmailBonuses)" oper="not-equal" value="CONST(0)"/>
					</WTCALLSUB>
				</WTCODEGROUP>

				<WTCALLSUB name="LogMemberNote reqNewMemberID, &quot;ENROLL ERROR: &quot; + err.description + xmlError">
					<WTCONDITION expr="IsErrors"/>
					<WTCONDITION expr="PARAM(NewMemberID)" oper="not-equal" value="CONST(0)" connector="and"/>
				</WTCALLSUB>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadMember">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="Load">
						<WTPARAM name="AddressID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)">
						<WTCONDITION expr="CONST(Len(.CountryID))" oper="equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlAddress" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="FORM(PayType)"/>
					<WTSETATTRIBUTE name="ATTR(PayType)" value="PARAM(PayType)">
						<WTCONDITION expr="ATTR(PayType)" oper="equal" value="CONST(&quot;&quot;)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidateContact">
				<!-- Validate Contact Mode -->
				<WTCALLSUB name="LoadCompanyOptions">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
				<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryID)" />
				<WTSETATTRIBUTE name="CONST(tmpCompanyName)" value="FORM(CompanyName)" />
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameFirst)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10125" message="Oops, Please enter a First Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="CONST(tmpNameLast)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
					<WTERROR number="10126" message="Oops, Please enter a Last Name."/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="FORM(Email)"/>
					<WTCUSTOM>
						If ValidEmail( tmpEmail ) = 0 Then DoError 10122, "", "Oops, Invalid Email Address."
					</WTCUSTOM>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(LEN(tmpPassword))" oper="less" value="CONST(6)"/>
						<WTERROR number="10124" message="Oops, Please enter at least 6 characters for the Password."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCALLSUB name="ValidAddress">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidPhone">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="ValidLogon">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTSUB>

			<WTSUB name="ValidateMembership">
				<!-- Validate Membership Mode -->
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Data1)" oper="equal" value="CONST(&quot;1&quot;)" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data2)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, SIM Type is required."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data2)" oper="equal" value="CONST(&quot;My-Own&quot;)" connector="and"/>
						<!-- Validate their own SIM #-->
						<WTCODEGROUP>
							<WTCONDITION expr="NoErrors"/>
							<WTCODEGROUP>
								<WTCONDITION expr="CONST(Len(reqData3))" oper="not-equal" value="CONST(19)"/>
								<WTCONDITION expr="CONST(IsNumeric(reqData3))" oper="equal" value="CONST(0)" connector="or"/>
								<WTCONDITION expr="CONST(Left(reqData3,4))" oper="not-equal" value="CONST(&quot;8901&quot;)" connector="or"/>
								<WTERROR number="0" message="Oops, Your Own SIM # must be 19 digits only, starting with 8901"/>
							</WTCODEGROUP>
						</WTCODEGROUP>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data4)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Unlocked Phone is required."/>
					</WTCODEGROUP>
					<!--					
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data5)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Phone Brand is required."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data6)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Phone Model is required."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data7)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Phone IMIE # is required."/>
					</WTCODEGROUP>
-->					
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Data8)" oper="equal" value="CONST(&quot;2&quot;)" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data9)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Preferred Area Code is required."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTCONDITION expr="PARAM(Data8)" oper="equal" value="CONST(&quot;1&quot;)" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data10)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Current Phone Number is required."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data11)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Current Phone Provider is required."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data12)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Provider Account # is required."/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(Data13)" oper="equal" value="CONST(&quot;&quot;)" connector="and"/>
						<WTERROR number="0" message="Oops, Provider Pswd/Pin is required."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
			</WTSUB>

			<WTSUB name="ValidatePayment">
				<!-- Validate Payment Mode -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
					<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="CONST(lcase(tmpCardNumber))" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)"/>
						<WTERROR number="10128" message="Oops, You must agree to the payment terms."/>
					</WTCODEGROUP>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
				</WTCODEGROUP>
			</WTSUB>

			<!-- Validate the Previous Mode -->
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(NoValidate)" oper="equal" value="CONST(0)"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(IsAgree)" oper="equal" value="SYSCON(NO)"/>
						<WTERROR number="10103" message="Oops, You must agree to the terms and conditions."/>
					</WTCODEGROUP>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
					<WTCALLSUB name="ValidateContact"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-MEMBERSHIP)"/>
					<WTCALLSUB name="ValidateMembership"/>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
					<WTCALLSUB name="ValidatePayment"/>
				</WTCODEGROUP>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTACTION id="0" name="Agree" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-AGREE)">
					<WTCONDITION expr="PARAM(MemberID)" oper="not-equal" value="CONST(0)"/>
					<WTCONDITION expr="PARAM(NoRefer)" oper="not-equal" value="CONST(0)" connector="or"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)">
					<WTCONDITION expr="PARAM(PayType)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="1" name="Contact" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONTACT)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="2" name="Membership" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-MEMBERSHIP)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="3" name="Payment" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PAYMENT)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="4" name="Confirm" type="New">
				<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-CONFIRM)">
					<WTCONDITION expr="NoErrors"/>
				</WTSETATTRIBUTE>
			</WTACTION>

			<WTACTION id="5" name="Process" type="Add">
				<WTCALLSUB name="Addmember">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
				<WTCALLSUB name="LoadMember">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="SYSCON(ENROLL-PROCESS)"/>
					<WTSETATTRIBUTE name="CONST(tmpLogon)" value="FORM(NewLogon)"/>
					<WTSETATTRIBUTE name="CONST(tmpPassword)" value="FORM(NewPassword)"/>
					<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
						<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Welcome2.htm&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
						<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
						<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
						<WTMETHOD name="Load" />
						<WTMETHOD name="XML">
							<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
						</WTMETHOD>
						<WTCUSTOM>
							xmlHTMLFile = Replace( xmlHTMLFile, "{id}", CStr(reqNewMemberID) )
							xmlHTMLFile = Replace( xmlHTMLFile, "{lgn}", tmpLogon )
							xmlHTMLFile = Replace( xmlHTMLFile, "{pwd}", tmpPassword )
						</WTCUSTOM>
					</WTOBJECT>
				</WTCODEGROUP>
			</WTACTION>

			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
				<WTCALLSUB name="LoadAgree"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
				<WTCALLSUB name="LoadCountrys"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
				<WTCALLSUB name="LoadCountrys"/>
				<WTCALLSUB name="LoadPaymentOptions"/>
			</WTCODEGROUP>
			<WTCODEGROUP post="true">
				<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="PARAM(CountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryName)" value="ATTR(CountryName)" />
					<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(CountryID)" oper="not-equal" value="PARAM(CountryIDb)"/>
						<WTMETHOD name="Load">
							<WTPARAM name="CountryID" direction="input" value="PARAM(CountryIDb)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(CountryNameb)" value="ATTR(CountryName)" />
					</WTCODEGROUP>
				</WTOBJECT>
			</WTCODEGROUP>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="50" align="right"/>
				<WTCOLUMN width="160" align="right"/>
				<WTCOLUMN width="540" align="left"/>

				<WTFUNCTION name="ToggleType()">
					var payobj = TellAll.elements['PayType'];
					if( payobj != null ) {
						var VisibleCard = 'none'; var VisibleCheck = 'none'; var VisibleCash = 'none'; var VisibleWallet = 'none'; var VisibleBitCoin = 'none'; var VisibleAddress = 'none';
						var paytype=1;
						var l = payobj.length;
						if( l == null ) {
							if( payobj.checked ) {
								paytype = payobj.value
							}
						}
						else {
						for( i = 0; i &lt; l; i++ ) {
								if (payobj[i].checked) {
									paytype = payobj[i].value;
									i = l;
								}
							}
						}
						if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
						if (paytype == 5) VisibleCheck = '';
						if (paytype == 7) VisibleCash = '';
						if (paytype &lt;= 5) VisibleAddress = '';
						if (paytype &gt;= 11 &amp;&amp; paytype &lt;= 13) VisibleWallet = '';
						if (paytype == 14) VisibleBitCoin = '';
						document.getElementById('CardRows').style.display = VisibleCard;
						document.getElementById('CheckRows').style.display = VisibleCheck;
						document.getElementById('WalletRows').style.display = VisibleWallet;
						document.getElementById('BitCoinRows').style.display = VisibleBitCoin;
						document.getElementById('CashRows').style.display = VisibleCash;
						document.getElementById('BillingAddress').style.display = VisibleAddress;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					var payobj = TellAll.elements['PayType'];
					if( payobj != null ) {
					var l = payobj.length;
					for( i = 0; i &lt; l; i++ ) {
					if (payobj[i].value == val) {
					payobj[i].checked=true;
					i = l;
					}
					}
					ToggleType();
					}
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTFUNCTION name="FormatPhone(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					if( newval.length == 10 ) {
					obj.value = newval.substring(0,3) + '-' + newval.substring(3,6) + '-' + newval.substring(6,10);
					}
					if( newval.length == 11 ) {
					obj.value = newval.substring(0,1) + '-' + newval.substring(1,4) + '-' + newval.substring(4,7) + '-' + newval.substring(7,11);
					}
					if( newval.length == 12 ) {
					obj.value = newval.substring(0,2) + '-' + newval.substring(2,5) + '-' + newval.substring(5,8) + '-' + newval.substring(8,12);
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					//if( newval.length &lt; 3 ) {
					//alert('Oops, Invalid Security Code');
					//}
				</WTFUNCTION>
				<WTFUNCTION name="FormatLogon(obj)">
					var val = obj.value;
					var newval = val.replace(/[^0-9a-zA-Z]/g, '');
					obj.value = newval;
					if( newval.length &lt; 6 ) {
					alert('Oops, Logon must be at least 6 characters or numbers.');
					}
				</WTFUNCTION>
				<WTFUNCTION name="ShowCC()">
					var disp, membership = document.getElementById('Membership').value;
					if( membership == 5 ) { disp = '' } else { disp = 'none' }
					document.getElementById('CCRequired').style.display = disp;
					if( membership == 5 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					//document.getElementById('Payment').style.display = disp;
					//document.getElementById('CardRows').style.display = disp;
					//document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="ShowSIMNumber()">
					var list = document.getElementById('Data2');
					var simtype = list[list.selectedIndex].value;
					var disabled = true;
					if( simtype == 'My-Own' ) {disabled = false;}
					document.getElementById('Data3').disabled = disabled;
				</WTFUNCTION>

				<WTFUNCTION name="ShowPhoneOptions()">
					var RadioButtons = TellAll.elements['Data1'];
					var length = RadioButtons.length
					var val = 1
					var disabled = true;
					for(var i = 0; i &lt; length; i++) {
						if(RadioButtons[i].checked) {val = RadioButtons[i].value;}
					}
					if( val == 1 ) disabled = false;
					document.getElementById('Data2').disabled = disabled;
					document.getElementById('Data3').disabled = disabled;
					document.getElementById('Data4').disabled = disabled;
					document.getElementById('Data5').disabled = disabled;
					document.getElementById('Data6').disabled = disabled;
					document.getElementById('Data7').disabled = disabled;
				</WTFUNCTION>

				<WTFUNCTION name="ShowPhoneNumberOptions()">
					var RadioButtons = TellAll.elements['Data8'];
					var length = RadioButtons.length
					var val = 1
					var disabled = true;
					for(var i = 0; i &lt; length; i++) {
						if(RadioButtons[i].checked) {val = RadioButtons[i].value;}
					}
					var disabled = true;
					var disabled2 = false;
					if( val == 1 ) { disabled = false; disabled2 = true;}
					document.getElementById('Data9').disabled = disabled2;
					document.getElementById('Data10').disabled = disabled;
					document.getElementById('Data11').disabled = disabled;
					document.getElementById('Data12').disabled = disabled;
					document.getElementById('Data13').disabled = disabled;
				</WTFUNCTION>

				<WTFUNCTION name="Init()">
					var mode = document.getElementById('Mode').value;
					if( mode == 1 ) {
					//ShowTaxIDType();
					}
					if( mode == 2 ) {
					// do nothing
					}
					if( mode == 3 ) {
					ShowPhoneOptions();
					ShowSIMNumber();
					ShowPhoneNumberOptions();
					}
					if( mode == 4 ) {
					ToggleType();
					//ShowCC();
					}
				</WTFUNCTION>

				<WTFUNCTION name="MsgBox(msg)">
					alert(msg);
				</WTFUNCTION>

				<WTLOAD>Init();</WTLOAD>

				<WTROW>
					<WTHIDDEN value="PARAM(Mode)"/>
					<WTHIDDEN value="PARAM(NewMemberID)"/>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="PARAM(PayID)"/>
					<WTHIDDEN value="PARAM(TokenOwner)"/>
					<WTHIDDEN value="PARAM(TokenType)"/>
					<WTHIDDEN value="PARAM(Token)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(NoValidate)"/>
					<WTHIDDEN value="PARAM(ReferredBy)"/>
					<WTHIDDEN value="PARAM(Placement)"/>
				</WTROW>

				<WTSTATIC label="IsAgree"/>
				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-top="12" margin-bottom="12">
					<WTCONDITION expr="PARAM(BadPayment)" oper="not-equal" value="CONST(0)"/>
					<WTSTATIC col="1" merge="3" label="BadPaymentText" class="PageHeading" fontcolor="red" align="left"/>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-REFER)"/>
					<WTCONDITION expr="PARAM(ReferredBy)" oper="equal" value="CONST('')" connector="and"/>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(GetMemberID)" oper="not-equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="3" align="center" class="PageHeading">
								<WTSTATIC label="GetMemberID"/>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1" />
							<WTSTATIC col="2" tag="MemberID" />
							<WTTEXT col="3" value="PARAM(MemberID)" size="6">
								<WTENTER>if(this.value==0){this.value=''}</WTENTER>
							</WTTEXT>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="12">
							<WTBUTTON col="1" merge="3" action="0" value="CONST(Continue)" align="center"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(GetMemberID)" oper="equal" value="CONST(0)"/>
						<WTROW margin-top="24">
							<WTSTATIC col="1" merge="3" align="center" class="PageHeading" fontcolor="red">
								<WTSTATIC label="NoReferral1" newline="2"/>
								<WTSTATIC label="NoReferral2"/>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>
				</WTCODEGROUP>

				<!-- === Agreement ====================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-AGREE)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(BillDay)"/>
					<WTHIDDEN value="PARAM(PayType)"/>

					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="6" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="12">
						<WTCONDITION expr="PARAM(ReferredBy)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1" merge="3" align="center" bold="true">
							<WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Placement)" oper="not-equal" value="CONST('')"/>
								<WTSTATIC newline="1"/>
								<WTSTATIC tag="Placement" value="PARAM(Placement)"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
							<WTCODEGROUP>
								<WTCHECK value="PARAM(IsAgree)"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="1" value="CONST(Continue)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Contact Information ============================================ -->
				<WTSTATIC label="CompanyNameTip"/>
				<WTSTATIC label="Email2Tip"/>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONTACT)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(BillDay)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTHIDDEN value="PARAM(Data1)"/>
					<WTHIDDEN value="PARAM(Data2)"/>
					<WTHIDDEN value="PARAM(Data3)"/>
					<WTHIDDEN value="PARAM(Data4)"/>
					<WTHIDDEN value="PARAM(Data5)"/>
					<WTHIDDEN value="PARAM(Data6)"/>
					<WTHIDDEN value="PARAM(Data7)"/>
					<WTHIDDEN value="PARAM(Data8)"/>
					<WTHIDDEN value="PARAM(Data9)"/>
					<WTHIDDEN value="PARAM(Data10)"/>
					<WTHIDDEN value="PARAM(Data11)"/>
					<WTHIDDEN value="PARAM(Data12)"/>
					<WTHIDDEN value="PARAM(Data13)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollContact.png)" align="center"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="NewMemberText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="MemberName"/>
						<WTTEXT col="3" value="ATTR(Member.NameFirst)" width="200" label="NameFirst" size="25" focus="true" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, First Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Member.NameLast)" width="340" label="NameLast" size="25" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Last Name Required!')};TitleCase(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Email"/>
						<WTTEXT col="3" value="ATTR(Member.Email)" size="60" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Email Required!')};</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1" />
						<WTSTATIC col="2" tag="Address" />
						<WTTEXT col="3" value="ATTR(Address.Street1)" size="60">
							<WTEXIT>if(this.value==''){alert('Oops, Mailing Address Required!')}; document.getElementById('Street1b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.Street2)" size="60">
							<WTEXIT>document.getElementById('Street2b').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2"/>
						<WTTEXT col="3" value="ATTR(Address.City)" width="200" label="City" size="27" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, City Required!');}else{TitleCase(this);}; document.getElementById('Cityb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTTEXT col="3" value="ATTR(Address.State)" width="340" label="State" size="27" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, State Required!');}else{TitleCase(this);}; document.getElementById('Stateb').value = this.value;</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1" />
						<WTSTATIC col="2" />
						<WTTEXT col="3" value="ATTR(Address.Zip)" width="100" label="Zip" size="8" required="false">
							<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')}; document.getElementById('Zipb').value = this.value;</WTEXIT>
						</WTTEXT>
						<WTCOMBO col="3" value="ATTR(Address.CountryID)" width="440" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true">
							<WTEXIT>document.getElementById('CountryIDb').value = this.value;</WTEXIT>
						</WTCOMBO>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="Phone"/>
						<WTTEXT col="3" value="ATTR(Member.Phone1)" size="20">
							<WTEXIT>FormatPhone(this);</WTEXIT>
						</WTTEXT>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="6">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>
					<WTROW margin-bottom="6">
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" align="left" label="LogonText" class="prompt"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewLogon"/>
						<WTTEXT col="3" value="ATTR(Member.NewLogon)" size="20" class="prompt">
							<WTEXIT>FormatLogon(this);</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="3" label="LogonTip"/>
					</WTROW>
					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" tag="NewPassword"/>
						<WTTEXT col="3" value="ATTR(Member.NewPassword)" size="20" secure="false" class="prompt">
							<WTEXIT>if(this.value==''){alert('Oops, Password Required!');}</WTEXIT>
						</WTTEXT>
						<WTSTATIC col="3" label="PasswordText"/>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" action="2" value="CONST(Continue)" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(2,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Membership ===================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-MEMBERSHIP)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollMembership.png)" align="center"/>
					</WTROW>

					<!-- Custom Company Membership Info -->
					<WTROW margin-bottom="12">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="690" align="left"/>

							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="3" label="PHONEPLAN" bold="true" fontsize="4" align="left"/>
							</WTROW>
							
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_1" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_1a" newline="1"/>
									<WTSTATIC label="Membership19_1b"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
04								<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_2" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_2a" newline="1"/>
									<WTSTATIC label="Membership19_2b"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_3" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_3a" newline="1"/>
									<WTSTATIC label="Membership19_3b"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_4" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_4a" newline="1"/>
									<WTSTATIC label="Membership19_4b"/>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="160" align="left"/>
							<WTCOLUMN width="530" align="left"/>

							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="3" label="PHONE" bold="true" fontsize="4" align="left"/>
							</WTROW>

							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Data1" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@data1=2">
									<WTCLICK>ShowPhoneOptions()</WTCLICK>
								</WTRADIO>
								<WTSTATIC col="3" merge="2" label="NewPhone" bold="true"/>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Data1" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@data1=1">
									<WTCLICK>ShowPhoneOptions()</WTCLICK>
								</WTRADIO>
								<WTSTATIC col="3" merge="2" label="MyPhone" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="SimType" align="right"/>
								<WTCOMBO col="4" value="PARAM(Data2)">
									<WTOPTION id="" label="Select"/>
									<WTOPTION id="Standard-Sim" label="StandardSim"/>
									<WTOPTION id="Micro-Sim" label="MicroSim"/>
									<WTOPTION id="Nano-Sim" label="NanoSim"/>
									<WTOPTION id="My-Own" label="MyOwnSIM"/>
									<WTCHANGE>ShowSIMNumber()</WTCHANGE>
								</WTCOMBO>
								<WTSTATIC col="4" tag="SimNumber" align="right"/>
								<WTTEXT col="4" value="PARAM(Data3)" maxlength="19" size="20" prespace="false" required="false"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="PhoneLocked" align="right"/>
								<WTCOMBO col="4" value="PARAM(Data4)" class="prompt">
									<WTOPTION id="" label="Select"/>
									<WTOPTION id="Locked" label="LockedYes"/>
									<WTOPTION id="Unlocked" label="LockedNo"/>
								</WTCOMBO>
								<WTSTATIC col="4" label="PhoneLockedText"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="PhoneBrand" align="right"/>
								<WTTEXT col="4" value="PARAM(Data5)" size="20" required="false"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="PhoneModel" align="right"/>
								<WTTEXT col="4" value="PARAM(Data6)" size="20" required="false"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="PhoneIMIE" align="right"/>
								<WTTEXT col="4" value="PARAM(Data7)" size="20" required="false" class="prompt"/>
								<WTSTATIC col="4" label="PhoneIMIEText"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="160" align="left"/>
							<WTCOLUMN width="530" align="left"/>

							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTSTATIC col="2" merge="3" label="PHONENUMBER" bold="true" fontsize="4" align="left"/>
							</WTROW>

							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Data8" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@data8=2">
									<WTCLICK>ShowPhoneNumberOptions()</WTCLICK>
								</WTRADIO>
								<WTSTATIC col="3" merge="2" label="NewPhoneNumber" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="AreaCode" align="right"/>
								<WTTEXT col="4" value="PARAM(Data9)" size="10" required="false"/>
							</WTROW>

							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Data8" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@data8=1">
									<WTCLICK>ShowPhoneNumberOptions()</WTCLICK>
								</WTRADIO>
								<WTSTATIC col="3" merge="2" label="MyPhoneNumber" bold="true"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="PhoneNumber" align="right"/>
								<WTTEXT col="4" value="PARAM(Data10)" size="20" required="false"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="PhoneProvider" align="right"/>
								<WTTEXT col="4" value="PARAM(Data11)" size="20" required="false"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="ProviderAccount" align="right"/>
								<WTTEXT col="4" value="PARAM(Data12)" size="20" required="false"/>
							</WTROW>
							<WTROW margin-top="6">
								<WTSTATIC col="1" merge="2"/>
								<WTSTATIC col="3" tag="ProviderPswd" align="right"/>
								<WTTEXT col="4" value="PARAM(Data13)" size="20" required="false" class="prompt"/>
								<WTSTATIC col="5" label="ProviderPswdText"/>
							</WTROW>
							
							<WTROW margin-top="12">
								<WTDIVIDER col="1" merge="5" height="1" color="#584b42"/>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="1" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(1,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" action="3" value="CONST(Continue)" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(3,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Payment ========================================================= -->
				<WTSTATIC label="Checking"/>
				<WTSTATIC label="Savings"/>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PAYMENT)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(Data1)"/>
					<WTHIDDEN value="PARAM(Data2)"/>
					<WTHIDDEN value="PARAM(Data3)"/>
					<WTHIDDEN value="PARAM(Data4)"/>
					<WTHIDDEN value="PARAM(Data5)"/>
					<WTHIDDEN value="PARAM(Data6)"/>
					<WTHIDDEN value="PARAM(Data7)"/>
					<WTHIDDEN value="PARAM(Data8)"/>
					<WTHIDDEN value="PARAM(Data9)"/>
					<WTHIDDEN value="PARAM(Data10)"/>
					<WTHIDDEN value="PARAM(Data11)"/>
					<WTHIDDEN value="PARAM(Data12)"/>
					<WTHIDDEN value="PARAM(Data13)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollPayment.png)" align="center"/>
					</WTROW>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)"/>

						<WTROW id="Payment">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="750" align="center"/>

								<WTROW id="Pay2" margin-bottom="12">
									<WTSTATIC col="1" align="center" class="prompt">
										<WTSTATIC label="PaymentText"/>
									</WTSTATIC>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="6">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentVisa"/>
											<WTRADIO group="PayType" name="1" check="/DATA/TXN/PTSBILLING/@paytype=1">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentMC"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="2" check="/DATA/TXN/PTSBILLING/@paytype=2">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentDiscover"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="3" check="/DATA/TXN/PTSBILLING/@paytype=3">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentAmex"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="4" check="/DATA/TXN/PTSBILLING/@paytype=4">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentCheck"/>
											<WTSTATIC space="3"/>
											<WTRADIO group="PayType" name="5" check="/DATA/TXN/PTSBILLING/@paytype=5">
												<WTCLICK>ToggleType();</WTCLICK>
											</WTRADIO>
											<WTIMAGE value="CONST(PayType5.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(5);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="_IsPaymentWallet"/>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentiPayout"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="11" check="/DATA/TXN/PTSBILLING/@paytype=11">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType11.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(11);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentPayQuicker"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="12" check="/DATA/TXN/PTSBILLING/@paytype=12">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType12.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(12);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentSolidTrust"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="13" check="/DATA/TXN/PTSBILLING/@paytype=13">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType13.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(13);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentBitCoin"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="14" check="/DATA/TXN/PTSBILLING/@paytype=14">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType14.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(14);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTCONDITION expr="PARAM(CashPayment)" oper="not-equal" value="CONST(0)"/>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentCash"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="7" check="/DATA/TXN/PTSBILLING/@paytype=7">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType7.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(7);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
											<WTCODEGROUP>
												<WTCONDITION expr="_IsPaymentPO"/>
												<WTSTATIC space="3"/>
												<WTRADIO group="PayType" name="8" check="/DATA/TXN/PTSBILLING/@paytype=8">
													<WTCLICK>ToggleType();</WTCLICK>
												</WTRADIO>
												<WTIMAGE value="CONST(PayType8.gif)" imgalign="absmiddle">
													<WTCLICK>CheckType(8);</WTCLICK>
												</WTIMAGE>
											</WTCODEGROUP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CashRows" style="display:none">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
									<WTROW margin-top="6" margin-bottom="6">
										<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
									</WTROW>
									<WTROW margin-bottom="6">
										<WTSTATIC col="1" merge="3" label="CashPayment15" align="center" bold="true" fontcolor="blue"/>
									</WTROW>
								</WTCODEGROUP>
							</WTTABLE>
						</WTROW>

						<WTROW id="WalletRows" style="display:none">
							<WTTABLE col="1" merge="3">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="WalletName"/>
									<WTTEXT col="2" value="PARAM(Wallet)" required="true"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="BitCoinRows" style="display:none">
							<WTTABLE col="1" merge="3">
								<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(17)"/>
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW margin-top="6" margin-bottom="6">
									<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" merge="2" label="BitCoinPayments" class="PageHeading" fontcolor="red" align="center"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CardRows" style="display:none">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
										<WTEXIT>var x = this.value; if(x.tolowercase() != 'paypal'){this.value = x.replace(/[^\d]/g, '')};</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="CheckRows" style="display:none">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CheckBank"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckBank)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckRoute"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckRoute)"/>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(checkref.gif)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAccount"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckAccount)" size="25"/>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(checkref.gif)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckAcctType"/>
									<WTCOMBO col="2" value="ATTR(Billing.CheckAcctType)"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CheckName"/>
									<WTTEXT col="2" value="ATTR(Billing.CheckName)" size="25"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="BillingAddress" style="display:none">
							<WTSTATIC col="1"/>
							<WTTABLE col="2" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="BillingAddress" />
									<WTTEXT col="2" value="PARAM(Street1b)" size="60">
										<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>
							</WTTABLE>
						</WTROW>

						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="3" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="3" label="SecurePayment" bold="true"/>
						</WTROW>

						<WTROW margin-top="6" margin-bottom="12">
							<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
						</WTROW>
						<WTROW id="Agree2">
							<WTSTATIC col="1" merge="3" align="center" bold="true" fontcolor="blue">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(15)"/>
									<WTCODEGROUP>
										<WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(0)"/>
										<WTSTATIC label="IsAgree2Billed">
											<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(13)"/>
										</WTSTATIC>
										<WTSTATIC label="IsAgree2Monthly">
											<WTCONDITION expr="PARAM(CompanyID)" oper="not-equal" value="CONST(13)"/>
										</WTSTATIC>
									</WTCODEGROUP>
									<WTSTATIC label="IsAgree2Annually">
										<WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(2)"/>
									</WTSTATIC>
									<WTSTATIC label="IsAgree2OneTime">
										<WTCONDITION expr="PARAM(BillOneTime)" oper="equal" value="CONST(1)"/>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(15)"/>
									<WTSTATIC label="IsAgree2_15"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
						<WTROW margin-top="12">
							<WTCONDITION expr="PARAM(BillDay)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC col="1" merge="3" align="center">
								<WTCODEGROUP>
									<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(11)"/>
									<WTCOMBO value="PARAM(BillDay)">
										<WTOPTION id="1" label="BillDay1"/>
										<WTOPTION id="15" label="BillDay15"/>
									</WTCOMBO>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="2" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(2,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" action="4" value="CONST(Continue)" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 0; doSubmit(4,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Confirm ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-CONFIRM)"/>
					<WTHIDDEN value="PARAM(M)"/>
					<WTHIDDEN value="PARAM(IsAgree)"/>
					<WTHIDDEN value="PARAM(Wallet)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="ATTR(Member.CompanyName)"/>
					<WTHIDDEN value="ATTR(Member.Email)"/>
					<WTHIDDEN value="ATTR(Member.Reference)"/>
					<WTHIDDEN value="ATTR(Address.Street1)"/>
					<WTHIDDEN value="ATTR(Address.Street2)"/>
					<WTHIDDEN value="ATTR(Address.City)"/>
					<WTHIDDEN value="ATTR(Address.State)"/>
					<WTHIDDEN value="ATTR(Address.Zip)"/>
					<WTHIDDEN value="ATTR(Address.CountryID)"/>
					<WTHIDDEN value="ATTR(Member.Phone1)"/>
					<WTHIDDEN value="ATTR(Member.NewLogon)"/>
					<WTHIDDEN value="ATTR(Member.NewPassword)"/>
					<WTHIDDEN value="PARAM(Membership)"/>
					<WTHIDDEN value="PARAM(OrderOption)"/>
					<WTHIDDEN value="PARAM(BillDay)"/>
					<WTHIDDEN value="PARAM(IsAgree2)"/>
					<WTHIDDEN value="ATTR(Billing.PayType)"/>
					<WTHIDDEN value="ATTR(Billing.CardNumber)"/>
					<WTHIDDEN value="ATTR(Billing.CardMo)"/>
					<WTHIDDEN value="ATTR(Billing.CardYr)"/>
					<WTHIDDEN value="ATTR(Billing.CardName)"/>
					<WTHIDDEN value="ATTR(Billing.CardCode)"/>
					<WTHIDDEN value="ATTR(Billing.CheckBank)"/>
					<WTHIDDEN value="ATTR(Billing.CheckRoute)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAccount)"/>
					<WTHIDDEN value="ATTR(Billing.CheckAcctType)"/>
					<WTHIDDEN value="ATTR(Billing.CheckName)"/>
					<WTHIDDEN value="PARAM(Street1b)"/>
					<WTHIDDEN value="PARAM(Street2b)"/>
					<WTHIDDEN value="PARAM(Cityb)"/>
					<WTHIDDEN value="PARAM(Stateb)"/>
					<WTHIDDEN value="PARAM(Zipb)"/>
					<WTHIDDEN value="PARAM(CountryIDb)"/>
					<WTHIDDEN value="PARAM(Data1)"/>
					<WTHIDDEN value="PARAM(Data2)"/>
					<WTHIDDEN value="PARAM(Data3)"/>
					<WTHIDDEN value="PARAM(Data4)"/>
					<WTHIDDEN value="PARAM(Data5)"/>
					<WTHIDDEN value="PARAM(Data6)"/>
					<WTHIDDEN value="PARAM(Data7)"/>
					<WTHIDDEN value="PARAM(Data8)"/>
					<WTHIDDEN value="PARAM(Data9)"/>
					<WTHIDDEN value="PARAM(Data10)"/>
					<WTHIDDEN value="PARAM(Data11)"/>
					<WTHIDDEN value="PARAM(Data12)"/>
					<WTHIDDEN value="PARAM(Data13)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTCONDITION expr="PARAM(NoBanner)" oper="equal" value="CONST(0)"/>
						<WTIMAGE col="1" merge="3" value="CONST(EnrollConfirm.png)" align="center"/>
					</WTROW>

					<WTROW>
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="100" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTCOLUMN width="325" align="left"/>
							<WTROW>
								<WTSTATIC col="1"/>
								<WTSTATIC col="2">
									<WTSTATIC value="ATTR(Member.NameFirst)" space="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.NameLast)" newline="1" bold="true"/>
									<WTSTATIC value="ATTR(Member.CompanyName)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Email)" newline="1"/>
									<WTSTATIC value="ATTR(Member.Reference)" newline="1">
										<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(7)"/>
									</WTSTATIC>
									<WTSTATIC value="ATTR(Member.Phone1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.Street1)" newline="1"/>
									<WTSTATIC value="ATTR(Address.City)" space="1"/>
									<WTSTATIC value="ATTR(Address.State)" space="1"/>
									<WTSTATIC value="ATTR(Address.Zip)" newline="1"/>
									<WTSTATIC value="PARAM(CountryName)" newline="1"/>
									<WTSTATIC tag="Logon" value="ATTR(Member.NewLogon)" space="2"/>
									<WTSTATIC value="ATTR(Member.NewPassword)"/>
								</WTSTATIC>
								<WTSTATIC col="3">
									<WTCONDITION expr="PARAM(NoPayment)" oper="equal" value="CONST(0)"/>
									<WTCONDITION expr="PARAM(NoBill)" oper="equal" value="CONST(0)" connector="and"/>
									<WTSTATIC label="BillingInfo" newline="1" bold="true"/>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="greater-equal" value="CONST(1)"/>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="less-equal" value="CONST(4)" connector="and"/>
										<WTSTATIC value="ATTR(Billing.CardNumber)" newline="1"/>
										<WTSTATIC tag="Expires" value="ATTR(Billing.CardMo)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CardYr)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CardName)" newline="1"/>
										<WTSTATIC tag="Code" value="ATTR(Billing.CardCode)" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(5)"/>
										<WTSTATIC value="ATTR(Billing.CheckBank)" newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckRoute)" space="1"/>
										<WTSTATIC value="ATTR(Billing.CheckAccount)" newline="1"/>
										<WTSTATIC label="Checking">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(1)"/>
										</WTSTATIC>
										<WTSTATIC label="Savings">
											<WTCONDITION expr="ATTR(Billing.CheckAcctType)" oper="equal" value="CONST(2)"/>
										</WTSTATIC>
										<WTSTATIC newline="1"/>
										<WTSTATIC value="ATTR(Billing.CheckName)" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(7)"/>
										<WTSTATIC label="CashPayment" newline="1"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(11)"/>
										<WTSTATIC tag="iPayout" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(12)"/>
										<WTSTATIC tag="PayQuicker" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(13)"/>
										<WTSTATIC tag="SolidTrust" value="PARAM(Wallet)"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="equal" value="CONST(14)"/>
										<WTSTATIC label="BitCoinPayments"/>
									</WTCODEGROUP>
									<WTCODEGROUP>
										<WTCONDITION expr="ATTR(Billing.PayType)" oper="less" value="CONST(7)"/>
										<WTSTATIC value="PARAM(Street1b)" newline="1"/>
										<WTSTATIC value="PARAM(Cityb)" space="1"/>
										<WTSTATIC value="PARAM(Stateb)" space="1"/>
										<WTSTATIC value="PARAM(Zipb)" newline="1"/>
										<WTSTATIC value="PARAM(CountryNameb)" newline="2"/>
									</WTCODEGROUP>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>

					<WTROW margin-bottom="12">
						<WTSTATIC col="1" merge="3" align="center" bold="true">
							<WTSTATIC tag="ReferredBy" value="PARAM(ReferredBy)" fontsize="3" fontcolor="blue"/>
						</WTSTATIC>
					</WTROW>

					<WTROW>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
								<WTSTATIC label="Membership19_1" newline="1"/>
								<WTSTATIC label="Membership19_1a" newline="1"/>
								<WTSTATIC label="Membership19_1b"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
								<WTSTATIC label="Membership19_2" newline="1"/>
								<WTSTATIC label="Membership19_2a" newline="1"/>
								<WTSTATIC label="Membership19_2b"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
								<WTSTATIC label="Membership19_3" newline="1"/>
								<WTSTATIC label="Membership19_3a" newline="1"/>
								<WTSTATIC label="Membership19_3b"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
								<WTSTATIC label="Membership19_4" newline="1"/>
								<WTSTATIC label="Membership19_4a" newline="1"/>
								<WTSTATIC label="Membership19_4b"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12">
						<WTCONDITION expr="PARAM(Shipping)" oper="not-equal" value="CONST('')"/>
						<WTSTATIC col="1"/>
						<WTSTATIC col="2" merge="2" class="PageHeading" align="center">
							<WTSTATIC value="PARAM(Shipping)" space="1"/>
							<WTSTATIC label="ShippingCharges"/>
						</WTSTATIC>
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Data1)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="NewPhone" bold="true" align="left"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Data1)" oper="equal" value="CONST(1)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="MyPhone" bold="true" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="SimType" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data2)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTCONDITION expr="PARAM(Data2)" oper="equal" value="CONST('My-Own')"/>
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="SimNumber" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data3)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="PhoneLocked" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data4)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="PhoneBrand"/>
							<WTSTATIC col="3" value="PARAM(Data5)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="PhoneModel" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data6)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="PhoneIMIE" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data7)" align="left"/>
						</WTROW>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Data8)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="NewPhoneNumber" bold="true" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="AreaCode" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data9)" align="left"/>
						</WTROW>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Data8)" oper="equal" value="CONST(1)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" merge="2" label="MyPhoneNumber" bold="true" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="PhoneNumber" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data10)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="PhoneProvider" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data11)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="ProviderAccount" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data12)" align="left"/>
						</WTROW>
						<WTROW margin-top="6">
							<WTSTATIC col="1"/>
							<WTSTATIC col="2" tag="ProviderPswd" align="right"/>
							<WTSTATIC col="3" value="PARAM(Data13)" align="left"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="12" margin-bottom="12">
						<WTDIVIDER col="1" merge="3" height="1" color="#584b42"/>
					</WTROW>

					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Back)" action="3" align="center">
							<WTCLICK>document.getElementById('NoValidate').value = 1; doSubmit(3,&quot;&quot;);</WTCLICK>
						</WTBUTTON>
						<WTBUTTON col="1" merge="3" value="CONST(Confirm)" align="center">
							<WTCLICK>doSubmit(5,&quot;&quot;); this.disabled = true</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<!-- === Welcome ======================================================== -->
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="SYSCON(ENROLL-PROCESS)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="3" value="ATTR(HTMLFile.Data)" embedhtml="true" />
					</WTROW>
					<WTROW margin-top="12" margin-bottom="12">
						<WTBUTTON col="1" merge="3" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>
			</WTCONTENT>
		</WTWEBPAGE>

		<!-- Customer Change Membership Options Page -->
		<!--============================================================================================-->
		<WTWEBPAGE name="14904" caption="Change Membership" navbar="false" header="false" footer="false" stylesheet="StyleSheet5.css"
		aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl" langfile="14904" secured="52">
			<!--============================================================================================-->
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="BillingID" datatype="number"/>
			<WTPARAM name="Membership" datatype="number"/>
			<WTPARAM name="OrderOption" datatype="number"/>
			<WTPARAM name="IsAgree2" datatype="number"/>
			<WTPARAM name="PayType" datatype="number"/>
			<WTPARAM name="Amount" datatype="number"/>
			<WTPARAM name="BillingPrice" datatype="number"/>
			<WTPARAM name="CountryID" datatype="number"/>

			<WTPARAM name="NoBill" datatype="number"/>
			<WTPARAM name="Result" datatype="number"/>

			<WTPARAM name="Street1b" datatype="text"/>
			<WTPARAM name="Street2b" datatype="text"/>
			<WTPARAM name="Cityb" datatype="text"/>
			<WTPARAM name="Stateb" datatype="text"/>
			<WTPARAM name="Zipb" datatype="text"/>
			<WTPARAM name="CountryIDb" datatype="text"/>

			<WTPARAM name="Processor" datatype="number"/>
			<WTPARAM name="MemberToken" datatype="number"/>
			<WTPARAM name="Token" datatype="number"/>
			<WTPARAM name="PayDesc" datatype="text"/>
			<WTPARAM name="Popup" datatype="number"/>

			<WTINCLUDE name="Billing.asp"/>
			<WTINCLUDE name="Payment.asp"/>
			<WTINCLUDE name="Email.asp"/>
			<WTINCLUDE name="Note.asp"/>

			<WTINCLUDE name="Comm.asp"/>
			<WTINCLUDE name="CommissionEmail.asp"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(CompanyID)" value="CONST(19)"/>
			</WTCODEGROUP>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="NewBilling">
				<WTSETATTRIBUTE name="PARAM(PayType)" value="CONST(1)"/>
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(CountryIDb)" value="CONST(224)" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadBilling">
				<WTCALLSUB name="LoadLists"/>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="CONST(1)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlBilling" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
			<WTSUB name="LoadLists">
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(BillingID)" value="ATTR(BillingID)"/>
					<WTSETATTRIBUTE name="ATTR(CompanyName)" value="CONST(&quot;&quot;)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(1)">
							<WTCONDITION expr="CONST(InStr(.Options2, &quot;111&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(2)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;112&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(3)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;113&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="CONST(4)">
						<WTCONDITION expr="CONST(InStr(.Options2, &quot;114&quot;))" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlMember" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(PayType)" value="ATTR(CardType)"/>
					<WTSETATTRIBUTE name="PARAM(PayDesc)" value="CONST(BillingPayment( oBilling ))"/>
				</WTOBJECT>
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;Upgrade2.htm&quot;)"/>
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqCompanyID))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)" />
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)" />
					<WTMETHOD name="Load" />
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Address" project="ptsAddressUser" class="CAddress">
					<WTMETHOD name="FetchOwner">
						<WTPARAM name="OwnerType" direction="input" value="ENTITY(Member)"/>
						<WTPARAM name="OwnerID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="AddressType" direction="input" value="SYSCON(ADDRESS-TYPE-MAILING)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(CountryID)" value="ATTR(CountryID)"/>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="ValidBilling">
				<!-- Validate Card Number if paying by Credit Card -->
				<WTSETATTRIBUTE name="CONST(tmpPayType)" value="FORM(PayType)" />
				<WTSETATTRIBUTE name="CONST(tmpCardNumber)" value="FORM(CardNumber)" />
				<WTOBJECT name="Payment" project="wtPayment" class="CPayment">
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)"/>
					<WTMETHOD name="ValidCardNumber">
						<WTPARAM name="CardNumber" direction="input" value="CONST(tmpCardNumber)" />
						<WTPARAM name="result" direction="return" datatype="number" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="less" value="CONST(0)" />
						<WTERROR number="10008" message="Oops, Invalid Length of Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(result)" oper="equal" value="CONST(0)" />
						<WTERROR number="10009" message="Oops, Invalid Credit Card Number." />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- check for visa, mc, diners, amex -->
						<WTCONDITION expr="CONST(result)" oper="greater-equal" value="CONST(1)" />
						<WTCONDITION expr="CONST(result)" oper="less-equal" value="CONST(4)" connector="and"/>
						<WTCONDITION expr="CONST(CLng(result))" oper="not-equal" value="CONST(CLng(tmpPayType))" connector="and"/>
						<WTSETATTRIBUTE name="CONST(tmpPayType)" value="CONST(CLng(result))" />
						<!--<WTERROR number="10010" message="Oops, Selected Card Type does not match Card Number."/>-->
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- All other credit cards are not allowed -->
						<WTCONDITION expr="CONST(result)" oper="greater" value="CONST(4)" />
						<WTERROR number="10012" message="Oops, Invalid Credit Card Type." />
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" connector="and"/>
					<WTSETATTRIBUTE name="CONST(tmpCardMo)" value="FORM(CardMo)" />
					<WTSETATTRIBUTE name="CONST(tmpCardYr)" value="FORM(CardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(tmpCardMo + &quot;/1/&quot; + tmpCardYr)" />
					<WTSETATTRIBUTE name="CONST(tmpCardDate)" value="CONST(DATEADD(&quot;m&quot;, 1, tmpCardDate))" />
					<WTCODEGROUP>
						<!-- check for current card date -->
						<WTCONDITION expr="CONST(CDate(tmpCardDate))" oper="less" value="CONST(CDate(reqSysDate))" />
						<WTERROR number="10013" message="Oops, Credit Card date has expired." />
					</WTCODEGROUP>
				</WTCODEGROUP>

				<WTSETATTRIBUTE name="CONST(tmpCountryID)" value="FORM(CountryIDb)"/>
				<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="CONST(&quot;&quot;)"/>
				<WTOBJECT name="Country" project="ptsCountryUser" class="CCountry">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpCountryID)" oper="not-equal" value="CONST(0)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="CountryID" direction="input" value="CONST(tmpCountryID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCountryCode)" value="ATTR(Code)"/>
				</WTOBJECT>

				<WTOBJECT name="Billing" project="ptsBillingUser" class="CBilling">
					<WTCONDITION expr="NoErrors" />
					<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CASH)" connector="and"/>
					<WTMETHOD name="Load">
						<WTPARAM name="BillingID" direction="input" value="PARAM(BillingID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="less-equal" value="SYSCON(PAYTYPE-CREDITCARD)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CREDITCARD)"/>
						<WTSETATTRIBUTE name="ATTR(CardType)" value="CONST(tmpPayType)"/>
						<WTSETATTRIBUTE name="ATTR(CardNumber)" value="FORM(CardNumber)" />
						<WTSETATTRIBUTE name="ATTR(CardMo)" value="FORM(CardMo)" />
						<WTSETATTRIBUTE name="ATTR(CardYr)" value="FORM(CardYr)" />
						<WTSETATTRIBUTE name="ATTR(CardName)" value="FORM(CardName)" />
						<WTSETATTRIBUTE name="ATTR(CardCode)" value="FORM(CardCode)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(CardZip)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CHECK)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CHECK)"/>
						<WTSETATTRIBUTE name="ATTR(CheckBank)" value="FORM(CheckBank)" />
						<WTSETATTRIBUTE name="ATTR(CheckRoute)" value="FORM(CheckRoute)" />
						<WTSETATTRIBUTE name="ATTR(CheckAccount)" value="FORM(CheckAccount)" />
						<WTSETATTRIBUTE name="ATTR(CheckAcctType)" value="FORM(CheckAcctType)" />
						<WTSETATTRIBUTE name="ATTR(CheckName)" value="FORM(CheckName)" />
					</WTCODEGROUP>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpPayType)" oper="equal" value="SYSCON(PAYTYPE-CASH)" />
						<WTSETATTRIBUTE name="ATTR(PayType)" value="SYSCON(BILL-PAYTYPE-CASH)"/>
					</WTCODEGROUP>
					<WTMETHOD name="Validate">
						<WTCONDITION expr="NoErrors"/>
						<WTPARAM name="New" direction="input" value="CONST(1)" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTSETATTRIBUTE name="CONST(tmpNameFirst)" value="FORM(NameFirst)" />
						<WTSETATTRIBUTE name="CONST(tmpNameLast)" value="FORM(NameLast)" />
						<WTSETATTRIBUTE name="ATTR(BillingName)" value="CONST(tmpNameFirst + &quot; &quot; + tmpNameLast)" />
						<WTSETATTRIBUTE name="ATTR(Street1)" value="FORM(Street1b)" />
						<WTSETATTRIBUTE name="ATTR(Street2)" value="FORM(Street2b)" />
						<WTSETATTRIBUTE name="ATTR(City)" value="FORM(Cityb)" />
						<WTSETATTRIBUTE name="ATTR(State)" value="FORM(Stateb)" />
						<WTSETATTRIBUTE name="ATTR(Zip)" value="FORM(Zipb)" />
						<WTSETATTRIBUTE name="ATTR(CountryID)" value="FORM(CountryIDb)" />
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="Add">
							<WTCONDITION expr="NoErrors"/>
							<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" connector="and"/>
							<WTPARAM name="reqBillingID" direction="return" datatype="number"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="ATTR(CountryCode)" value="CONST(tmpCountryCode)"/>
						<WTCALLSUB name="reqPayDesc = BillingPayment( oBilling )">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewBilling"/>
			</WTACTION>

			<WTACTION id="2" name="Update" type="Update">
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(BillingID)" oper="equal" value="CONST(0)" />
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCONDITION expr="PARAM(IsAgree2)" oper="equal" value="SYSCON(NO)" connector="and"/>
						<WTCONDITION expr="PARAM(Membership)" oper="not-equal" value="CONST(0)" connector="and"/>
						<WTERROR number="10128" message="Oops, You must agree to recurring billing."/>
					</WTCODEGROUP>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(0)"/>
					<WTCALLSUB name="ValidBilling">
						<WTCONDITION expr="NoErrors"/>
					</WTCALLSUB>
					<WTSETATTRIBUTE name="CONST(tmpUpdateBilling)" value="CONST(1)">
						<WTCONDITION expr="PARAM(BillingID)" oper="not-equal" value="CONST(0)"/>
					</WTSETATTRIBUTE>
				</WTCODEGROUP>
				<WTOBJECT name="Coption" project="ptsCoptionUser" class="CCoption">
					<WTMETHOD name="FetchCompany">
						<WTPARAM name="CoptionID" direction="input" value="PARAM(CompanyID)"/>
					</WTMETHOD>
					<WTMETHOD name="Load">
						<WTPARAM name="CoptionID" direction="input" value="ATTR(CoptionID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCardProcessor)" value="ATTR(MerchantCardType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCardAcct)" value="ATTR(MerchantCardAcct)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckProcessor)" value="ATTR(MerchantCheckType)"/>
					<WTSETATTRIBUTE name="CONST(tmpCheckAcct)" value="ATTR(MerchantCheckAcct)"/>
					<WTSETATTRIBUTE name="CONST(ShipOption)" value="ATTR(Shopping)"/>
					<WTCUSTOM>EmailBonuses = InStr(ShipOption, "N")</WTCUSTOM>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="NoErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpReferralID)" value="ATTR(ReferralID)"/>
					<WTSETATTRIBUTE name="CONST(tmpName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast + &quot; (#&quot; + .MemberID + &quot;)&quot;)"/>
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdateBilling)" oper="not-equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(BillingID)" value="PARAM(BillingID)"/>
						<WTMETHOD name="Save">
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
					</WTCODEGROUP>

					<WTSETATTRIBUTE name="CONST(oldOptions2)" value="ATTR(Options2)"/>
					<WTSETATTRIBUTE name="PARAM(Membership)" value="FORM(Membership)"/>

					<!-- **************************************************************** -->
					<WTSETATTRIBUTE name="PARAM(BillingPrice)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpUpdatePaidDate)" value="CONST(0)"/>
					<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;&quot;)"/>
					
					<WTCODEGROUP>
						<!-- 1GB -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;111&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(34.88)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- 3GB -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;112&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(46.51)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- 5GB -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;113&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(58.14)"/>
					</WTCODEGROUP>
					<WTCODEGROUP>
						<!-- Unlimited -->
						<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
						<WTSETATTRIBUTE name="CONST(tmpCode)" value="CONST(&quot;114&quot;)"/>
						<WTSETATTRIBUTE name="ATTR(Price)" value="CONST(69.77)"/>
					</WTCODEGROUP>

					<WTCODEGROUP>
						<WTCONDITION expr="CONST(InStr(.Options2, tmpCode))" oper="equal" value="CONST(0)"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;111&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;112&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;113&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;114&quot;, &quot;&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(Replace(.Options2, &quot;,,&quot;, &quot;,&quot;))"/>
						<WTSETATTRIBUTE name="ATTR(Options2)" value="CONST(.Options2 + &quot;,&quot; + tmpCode )"/>
						<WTSETATTRIBUTE name="CONST(tmpUpdate)" value="CONST(1)"/>
					</WTCODEGROUP>

					<!-- If there is a change to the membership -->
					<WTCODEGROUP>
						<WTCONDITION expr="CONST(tmpUpdate)" oper="not-equal" value="CONST(0)"/>
						<WTMETHOD name="Save">
							<WTCONDITION expr="NoErrors"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlMember" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
						<!-- log the membership change -->
						<WTCALLSUB name="LogMemberNote reqMemberID, &quot;CUSTOMER CHANGE: (&quot; + oldOptions2 + &quot;) to (&quot; + .Options2 + &quot;)&quot;">
							<WTCONDITION expr="NoErrors"/>
						</WTCALLSUB>
					</WTCODEGROUP>
				</WTOBJECT>

				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTSETATTRIBUTE name="PARAM(Result)" value="CONST(1)"/>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="IsErrors"/>
					<WTCALLSUB name="LogMemberNote reqMemberID, &quot;MEMBERSHIP CHANGE ERROR: &quot; + xmlError"/>
				</WTCODEGROUP>

			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="logout" type="Cancel">
				<WTRETURN>
					<WTLINK name="0101" nodata="true">
						<WTPARAM name="ActionCode" value="CONST(9)"/>
					</WTLINK>
				</WTRETURN>
			</WTACTION>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="175" align="center"/>
				<WTCOLUMN width="575" align="center"/>

				<WTROW>
					<WTHIDDEN value="PARAM(BillingID)"/>
					<WTHIDDEN value="ATTR(Member.NameFirst)"/>
					<WTHIDDEN value="ATTR(Member.NameLast)"/>
					<WTHIDDEN value="PARAM(PayDesc)"/>
					<WTHIDDEN value="PARAM(PayType)"/>
					<WTHIDDEN value="PARAM(CountryID)"/>
				</WTROW>

				<WTFUNCTION name="ToggleType()">
					var payobj = document.getElementById('PayType');
					if( payobj != null ) {
					//var countryid = document.getElementById('CountryID').value;
					var VisibleCard = 'none'; var VisibleCheck = 'none';
					var paytype = payobj.value;
					//var l = payobj.length;
					//for( i = 0; i &lt; l; i++ ) {
					//	if (payobj[i].checked) {
					//		paytype = payobj[i].value;
					//		i = l;
					//	}
					//}
					//if (paytype == 5) {
					//	if ( countryid != 224 ) {
					//		paytype = 1;
					//		document.getElementById('PayType').value = paytype;
					//		alert("Electronic Checks not available outside the United States");
					//	}
					//}
					if (paytype &gt;= 1 &amp;&amp; paytype &lt;= 4) VisibleCard = '';
					if (paytype == 5) VisibleCheck = '';
					document.getElementById('CardRows').style.display = VisibleCard;
					//document.getElementById('CheckRows').style.display = VisibleCheck;
					}
				</WTFUNCTION>

				<WTFUNCTION name="CheckType(val)">
					//var payobj = Member.elements['PayType'];
					//if( payobj != null ) {
					//	var l = payobj.length;
					//	for( i = 0; i &lt; l; i++ ) {
					//		if (payobj[i].value == val) {
					//			payobj[i].checked=true;
					//			i = l;
					//		}
					//	}
					ToggleType();
					}
				</WTFUNCTION>
				<WTFUNCTION name="FormatCardCode(obj)">
					var val = obj.value;
					var newval = val.replace(/[^\d]/g, '');
					obj.value = newval.substring(0,4);
					if( newval.length &lt; 3 ) {
					alert('Oops, Invalid Security Code');
					}
				</WTFUNCTION>

				<WTFUNCTION name="ShowCC()">
					var disp, computers = document.getElementById('Computers').value;
					if( computers == 0 ) { disp = 'none' } else { disp = '' }
					document.getElementById('Agree2').style.display = disp;
					document.getElementById('Payment').style.display = disp;
					document.getElementById('CardRows').style.display = disp;
					document.getElementById('Secure').style.display = disp;
				</WTFUNCTION>

				<WTFUNCTION name="formatCurrency(num)">
					num = num.toString().replace(/\$|\,/g,'');
					if(isNaN(num))
					num = "0";
					sign = (num == (num = Math.abs(num)));
					num = Math.floor(num*100+0.50000000001);
					cents = num%100;
					num = Math.floor(num/100).toString();
					if(cents&lt;10)
					cents = "0" + cents;
					for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)
					num = num.substring(0,num.length-(4*i+3))+','+
					num.substring(num.length-(4*i+3));
					return (((sign)?'':'-') + '$' + num + '.' + cents);
					//return (((sign)?'':'-') + '$' + num);
				</WTFUNCTION>

				<WTFUNCTION name="TitleCase(obj)">
					var val = obj.value;
					if ( val.length == 2 ) {
					obj.value = val.charAt(0).toUpperCase() + val.charAt(1).toUpperCase();
					}
					else {
					obj.value = val.charAt(0).toUpperCase() + val.slice(1);
					}
				</WTFUNCTION>

				<WTSTATIC label="IsAgree2"/>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="#584b42"/>
				</WTROW>
				<WTROW>
					<WTSTATIC col="1" merge="2" align="center" class="PageHeading">
						<WTSTATIC value="ATTR(Member.NameFirst)" space="1"/>
						<WTSTATIC value="ATTR(Member.NameLast)" space="2"/>
					</WTSTATIC>
				</WTROW>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" label="SuccessfulChange" value="ATTR(Member.Price)" align="center" class="PageHeading" fontcolor="blue"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTSTATIC col="1" merge="2" class="PageHeading" align="center">
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(1)"/>
								<WTSTATIC label="Membership19_1" newline="1"/>
								<WTSTATIC label="Membership19_1a"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(2)"/>
								<WTSTATIC label="Membership19_2" newline="1"/>
								<WTSTATIC label="Membership19_2a"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(3)"/>
								<WTSTATIC label="Membership19_3" newline="1"/>
								<WTSTATIC label="Membership19_3a"/>
							</WTCODEGROUP>
							<WTCODEGROUP>
								<WTCONDITION expr="PARAM(Membership)" oper="equal" value="CONST(4)"/>
								<WTSTATIC label="Membership19_4" newline="1"/>
								<WTSTATIC label="Membership19_4a"/>
							</WTCODEGROUP>
						</WTSTATIC>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(2)"/>
						<WTROW margin-top="12">
							<WTSTATIC col="1" merge="2" label="Relogin" align="center" class="PageHeading" fontcolor="Red"/>
						</WTROW>
						<WTROW margin-top="12" margin-bottom="24">
							<WTBUTTON col="1" merge="2" action="4" value="CONST(Logout)" align="center"/>
						</WTROW>
					</WTCODEGROUP>
					<WTROW margin-top="12" margin-bottom="24">
						<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(1)"/>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Continue)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Result)" oper="equal" value="CONST(0)"/>

					<WTROW margin-bottom="12">
						<WTTABLE col="1" merge="3">
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="30" align="left"/>
							<WTCOLUMN width="690" align="left"/>

							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="1" align="left" valign="top" datapathx="/DATA/PARAM/@membership=1"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_1" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_1a"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="2" align="left" valign="top" datapathx="/DATA/PARAM/@membership=2"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_2" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_2a"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="3" align="left" valign="top" datapathx="/DATA/PARAM/@membership=3"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_3" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_3a"/>
								</WTSTATIC>
							</WTROW>
							<WTROW margin-top="12">
								<WTSTATIC col="1"/>
								<WTRADIO col="2" group="Membership" name="4" align="left" valign="top" datapathx="/DATA/PARAM/@membership=4"/>
								<WTSTATIC col="3">
									<WTSTATIC label="Membership19_4" newline="1" bold="true"/>
									<WTSTATIC label="Membership19_4a"/>
								</WTSTATIC>
							</WTROW>
						</WTTABLE>
					</WTROW>

					<WTCODEGROUP>
						<WTCONDITION expr = "ATTR(Member.BillingID)" oper="equal" value="CONST(0)" />
						<WTROW margin-top="12" id="Agree2">
							<WTSTATIC col="1" merge="2" align="center" bold="true" fontcolor="blue">
								<WTCODEGROUP>
									<WTCHECK value="PARAM(IsAgree2)"/>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>

						<WTROW id="Payment">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="750" align="center"/>

								<WTROW margin-top="12" margin-bottom="12">
									<WTDIVIDER col="1" height="1" color="#584b42"/>
								</WTROW>
								<WTROW id="Pay2" margin-bottom="6">
									<WTSTATIC col="1" align="left" label="PaymentText" class="prompt"/>
								</WTROW>
								<WTROW id="Pay3" margin-bottom="6">
									<WTSTATIC col="1" align="center">
										<WTCODEGROUP>
											<WTIMAGE value="CONST(PayType1.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(1);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType2.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(2);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType3.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(3);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
										<WTCODEGROUP>
											<WTSTATIC space="3"/>
											<WTIMAGE value="CONST(PayType4.gif)" imgalign="absmiddle">
												<WTCLICK>CheckType(4);</WTCLICK>
											</WTIMAGE>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="CardRows">
							<WTTABLE col="1" merge="2">
								<WTCOLUMN width="160" align="right"/>
								<WTCOLUMN width="440" align="left"/>
								<WTROW>
									<WTSTATIC col="1" tag="CardNumber"/>
									<WTTEXT col="2" value="ATTR(Billing.CardNumber)" size="25">
										<WTEXIT>var x = this.value; var filter  = /[^0-9]/; if (filter.test(x)) alert('Oops, Please enter digits only for your Credit Card Number');</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardDate"/>
									<WTCOMBO col="2" value="ATTR(Billing.CardMo)">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="1" label="January"/>
										<WTOPTION id="2" label="February"/>
										<WTOPTION id="3" label="March"/>
										<WTOPTION id="4" label="April"/>
										<WTOPTION id="5" label="May"/>
										<WTOPTION id="6" label="June"/>
										<WTOPTION id="7" label="July"/>
										<WTOPTION id="8" label="August"/>
										<WTOPTION id="9" label="September"/>
										<WTOPTION id="10" label="October"/>
										<WTOPTION id="11" label="November"/>
										<WTOPTION id="12" label="December"/>
									</WTCOMBO>
									<WTCOMBO col="2" value="ATTR(Billing.CardYr)" prespace="false">
										<WTOPTION id="" label="Select"/>
										<WTOPTION id="13" label="2013"/>
										<WTOPTION id="14" label="2014"/>
										<WTOPTION id="15" label="2015"/>
										<WTOPTION id="16" label="2016"/>
										<WTOPTION id="17" label="2017"/>
										<WTOPTION id="18" label="2018"/>
										<WTOPTION id="19" label="2019"/>
										<WTOPTION id="20" label="2020"/>
										<WTOPTION id="21" label="2021"/>
										<WTOPTION id="22" label="2022"/>
										<WTOPTION id="23" label="2023"/>
										<WTOPTION id="24" label="2024"/>
										<WTOPTION id="25" label="2025"/>
									</WTCOMBO>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardName"/>
									<WTTEXT col="2" value="ATTR(Billing.CardName)" size="25"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="CardCode"/>
									<WTTEXT col="2" value="ATTR(Billing.CardCode)" size="2" maxlength="4">
										<WTEXIT>FormatCardCode(this);</WTEXIT>
									</WTTEXT>
									<WTSTATIC col="2">
										<WTCODEGROUP>
											<WTTOOLTIP>
												<WTIMAGE value="CONST(SymbolHelp.gif)"/>
												<WTTIP>
													<WTIMAGE value="CONST(SecurityCode.png)"/>
												</WTTIP>
											</WTTOOLTIP>
										</WTCODEGROUP>
									</WTSTATIC>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1" tag="BillingAddress" />
									<WTTEXT col="2" value="PARAM(Street1b)" size="60">
										<WTEXIT>if(this.value==''){alert('Oops, Street Required!');}</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Street2b)" size="60"/>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Cityb)" width="200" label="City" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, City Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
									<WTTEXT col="2" value="PARAM(Stateb)" width="240" label="State" size="27" align="left">
										<WTEXIT>if(this.value==''){alert('Oops, State Required!')}; TitleCase(this);</WTEXIT>
									</WTTEXT>
								</WTROW>
								<WTROW>
									<WTSTATIC col="1"/>
									<WTTEXT col="2" value="PARAM(Zipb)" width="100" label="Zip" size="8" align="left" required="true">
										<WTEXIT>if(this.value==''){alert('Oops, Postal Code Required!')};</WTEXIT>
									</WTTEXT>
									<WTCOMBO col="2" value="PARAM(CountryIDb)" width="340" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true" align="left"/>
								</WTROW>
							</WTTABLE>
						</WTROW>
						<WTROW id="Secure" margin-top="12">
							<WTIMAGE col="1" merge="2" align="center" value="CONST(padlock.gif)" imgalign="absmiddle" class="PageHeading"/>
							<WTSTATIC col="1" merge="2" label="SecurePayment" bold="true"/>
						</WTROW>
					</WTCODEGROUP>

					<WTROW margin-top="24" margin-bottom="24">
						<WTBUTTON col="1" merge="2" action="2" value="CONST(Change)" align="center">
							<WTCONDITION expr="ATTR(Member.Title)" oper="less-equal" value="CONST(4)"/>
						</WTBUTTON>
						<WTBUTTON col="1" merge="2" action="3" value="CONST(Cancel)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="equal" value="CONST(0)"/>
						</WTBUTTON>
						<WTBUTTON col="1" value="CONST(Close)" align="center">
							<WTCONDITION expr="PARAM(Popup)" oper="not-equal" value="CONST(0)"/>
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

	</WTWEBPAGES>
</WTROOT>