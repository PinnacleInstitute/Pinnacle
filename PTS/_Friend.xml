<WTROOT prefix="pts" dbo="dbo" system="Pinnacle">
	<WTENTITY id="141" name="Friend" alias="fr" audit="false">

		<!--Identity-->
		<WTATTRIBUTE id="14101" name="FriendID" type="number" identity="true" min="1" title="true" required="true" source="entity"/>

		<!--Foreign Keys-->
		<WTATTRIBUTE id="14102" name="MemberID" type="number" min="1" source="entity"/>
		<WTATTRIBUTE id="14103" name="FriendGroupID" type="number" min="1" source="entity"/>
		<WTATTRIBUTE id="14104" name="CountryID" type="number" min="1" source="entity"/>

		<!--Foreign Table Fields-->
		<WTATTRIBUTE id="14105" name="FriendGroupName" type="text" length="40" min="1" max="40" source="join">
			<WTJOIN entity="FriendGroup" name="FriendGroupName"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="14106" name="CountryName" type="text" length="50" min="1" max="50" source="join">
			<WTJOIN entity="Country" name="CountryName"/>
		</WTATTRIBUTE>

		<!--Attribute-->
		<WTATTRIBUTE id="14110" name="NameLast" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="14111" name="NameFirst" type="text" length="30" min="1" max="30" source="entity" required="true"/>
		<WTATTRIBUTE id="14112" name="FriendName" type="text" length="62" min="1" max="62" source="entity">
			<WTCOMPUTE name="NameLast"/>
			<WTCOMPUTE text=", "/>
			<WTCOMPUTE name="NameFirst"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="14113" name="Email" type="text" length="80" min="1" max="80" source="entity" required="true"/>
		<WTATTRIBUTE id="14114" name="FriendDate" type="date" source="entity"/>
		<WTATTRIBUTE id="14115" name="Status" type="number" source="entity">
			<WTENUM id="1" name="Pending"/>
			<WTENUM id="2" name="Approved"/>
			<WTENUM id="3" name="Cancelled"/>
			<WTENUM id="4" name="Terminated"/>
		</WTATTRIBUTE>
		<WTATTRIBUTE id="14116" name="Zip" type="text" length="10" min="1" max="10" source="entity"/>
		<WTATTRIBUTE id="14117" name="DOB" type="date" source="entity"/>

		<!--Indexes-->
    <WTINDEX name="MemberID">
      <WTATTRIBUTE name="MemberID"/>
      <WTATTRIBUTE name="FriendGroupID"/>
    </WTINDEX>
    <WTINDEX name="Email">
      <WTATTRIBUTE name="Email"/>
    </WTINDEX>

    <!--Relationships-->
		<WTRELATIONSHIPS>
			<WTRELATIONSHIP name="Friend" entity="Friend" alias="fr"/>
			<WTRELATIONSHIP name="Common" entity="Friend" alias="fr">
				<WTENTITY name="FriendGroup" entity="FriendGroup" alias="frg">
					<WTATTRIBUTE alias="fr" name="FriendGroupID" relalias="frg" relname="FriendGroupID"/>
				</WTENTITY>
				<WTENTITY name="Country" entity="Country" alias="cou">
					<WTATTRIBUTE alias="fr" name="CountryID" relalias="cou" relname="CountryID"/>
				</WTENTITY>
			</WTRELATIONSHIP>
		</WTRELATIONSHIPS>

		<WTENUM id="1" type="find">
			<WTATTRIBUTE name="FriendName" default="true"/>
			<WTATTRIBUTE name="Email"/>
			<WTATTRIBUTE name="FriendDate"/>
			<WTATTRIBUTE name="FriendGroupName"/>
			<WTATTRIBUTE name="CountryName"/>
		</WTENUM>

		<!-- System Constants --> 
		<WTSYSCONS>
			<WTSYSCON name="FRIENDSTATUS-PENDING" value="1"/>
			<WTSYSCON name="FRIENDSTATUS-APPROVED" value="2"/>
			<WTSYSCON name="FRIENDSTATUS-CANCELLED" value="3"/>
			<WTSYSCON name="FRIENDSTATUS-TERMINATED" value="4"/>
		</WTSYSCONS>

	</WTENTITY>

	<!--Procedures-->
	<WTPROCEDURES>
		<!--===================================================================================-->
		<WTPROCEDURE type="Add" name="Add" style="GenerateDataProc.xsl"/>
		<!--===================================================================================-->
		<WTPROCEDURE name="Count" type="Count" style="GenerateDataProc.xsl"/>
		<!--===================================================================================-->
		<WTPROCEDURE type="Delete" name="Delete" style="GenerateDataProc.xsl"/>
		<!--===================================================================================-->
		<WTPROCEDURE type="Fetch" name="Fetch" style="GenerateDataProc.xsl">
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Find" name="Find" style="GenerateDataProc.xsl">
			<WTBOOKMARK name=""/>
			<WTPARAM name="ATTR(MemberID)" direction="input" required="false"/>
			<WTPARAM name="SYS(userid)" direction="input"/>
			<WTCONDITION expr="ATTR(Cash.MemberID)" oper="equal" value="PARAM(MemberID)" connector="and"/>
			<WTJOIN name="Common"/>
		</WTPROCEDURE>
		<!--===================================================================================-->
		<WTPROCEDURE type="Update" name="Update" style="GenerateDataProc.xsl"/>
		<!--===================================================================================-->
    <WTPROCEDURE name="UpdateStatus" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
      <WTPARAM name="Result" datatype="number" direction="output"/>
      <WTPARAM name="ATTR(FriendID)" direction="input"/>
      <WTPARAM name="ATTR(Status)" direction="input"/>
    </WTPROCEDURE>
    <WTPROCEDURE name="Duplicate" type="Check" style="GenerateDataProc.xsl" template="new" passthru="true" nodata="true">
      <WTPARAM name="Result" datatype="number" direction="output"/>
      <WTPARAM name="ATTR(Email)" direction="input"/>
    </WTPROCEDURE>
  </WTPROCEDURES>

	<WTWEBPAGES>
		<!--============================================================================================-->
		<WTWEBPAGE name="14101" caption="Friend" action="5" header="false" footer="false" navbar="false" wrapper="wrapper600"
		   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLList.xsl">
		<!--============================================================================================-->
			<WTPARAM name="SearchText" datatype="text"/>
			<WTPARAM name="FindTypeID" datatype="number"/>
			<WTPARAM name="Bookmark" datatype="text"/>
			<WTPARAM name="Direction" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="FriendCount" datatype="number"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(FindTypeID)" value="FINDID(FriendName)">
					<WTCONDITION expr="PARAM(FindTypeID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTSETATTRIBUTE name="PARAM(MemberID)" value="SYS(MemberID)">
					<WTCONDITION expr="PARAM(MemberID)" oper="equal" value="CONST(0)"/>
				</WTSETATTRIBUTE>
				<WTOBJECT name="FriendGroup" project="ptsFriendGroupUser" class="CFriendGroup">
					<WTMETHOD name="Count">
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)"/>
						<WTPARAM name="reqFriendCount" direction="return" datatype="number"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
				<WTOBJECT name="Friends" project="ptsFriendUser" class="CFriends">
					<WTSETATTRIBUTE name="CONST(.FindTypeID)" value="PARAM(FindTypeID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlFriends" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(14)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark"/>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN />
			</WTACTION>

			<WTACTION id="5" name="Find" type="New">
				<WTSETATTRIBUTE name="PARAM(Bookmark)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTACTION id="6" name="Previous" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(2)"/>
			</WTACTION>

			<WTACTION id="7" name="Next" type="New">
				<WTSETATTRIBUTE name="PARAM(Direction)" value="CONST(1)"/>
			</WTACTION>

			<WTOBJECT name="Friends" project="ptsFriendUser" class="CFriends">
				<WTMETHOD name="Find">
					<WTPARAM name="reqBookmark" direction="return" datatype="text"/>
					<WTPARAM name="FindTypeID" direction="input" value="PARAM(FindTypeID)"/>
					<WTPARAM name="Bookmark" direction="input" value="PARAM(Bookmark)"/>
					<WTPARAM name="SearchText" direction="input" value="PARAM(SearchText)"/>
					<WTPARAM name="Direction" direction="input" value="PARAM(Direction)"/>
					<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
					<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
				</WTMETHOD>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlFriends" direction="return" datatype="text"/>
					<WTPARAM name="Option" direction="input" value="CONST(15)"/>
				</WTMETHOD>
			</WTOBJECT>
			<WTOBJECT name="Bookmark" project="wtSystem" class="CBookmark">
				<WTSETATTRIBUTE name="ATTR(LastBookmark)" value="PARAM(Bookmark)"/>
				<WTMETHOD name="XML">
					<WTPARAM name="xmlBookmark" direction="return" datatype="text"/>
				</WTMETHOD>
			</WTOBJECT>

			<!--**********************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="left"/>

				<WTROW>
					<WTTABLE col="1">
						<WTCOLUMN width="75" align="center"/>
						<WTCOLUMN width="250" align="left"/>
						<WTCOLUMN width="275" align="right"/>
						<WTROW>
							<WTIMAGE col="1" value="CONST(Friend48.gif)"/>
							<WTSTATIC col="2" label="FindFriend" class="PageHeading"/>
							<WTSTATIC col="3">
								<WTCODEGROUP>
									<WTIMAGE value="CONST(addnew.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="NewFriend" bold="true">
										<WTLINK name="14102">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTSTATIC space="2"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(friend.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="FriendGroups" bold="true">
										<WTLINK name="14211">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
								<WTCODEGROUP>
<!--									<WTCONDITION expr="IsSysAdmin"/>-->
									<WTSTATIC space="2"/>
									<WTIMAGE value="CONST(import.gif)" imgalign="absmiddle"/>
									<WTSTATIC space="1"/>
									<WTSTATIC label="ImportFriends" bold="true">
										<WTLINK name="14106" target="import">
											<WTPARAM name="MemberID" value="PARAM(MemberID)"/>
										</WTLINK>
									</WTSTATIC>
								</WTCODEGROUP>
							</WTSTATIC>
						</WTROW>
					</WTTABLE>
				</WTROW>

				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="center" bold="true">
						<WTSTATIC label="NoFriendGroups">
							<WTCONDITION expr="PARAM(FriendCount)" oper="equal" value="CONST(0)"/>
						</WTSTATIC>
						<WTCODEGROUP>
							<WTCONDITION expr="PARAM(FriendCount)" oper="not-equal" value="CONST(0)"/>
							<WTSTATIC label="YouHave" space="1"/>
							<WTSTATIC value="PARAM(FriendCount)" space="1"/>
							<WTSTATIC label="FriendGroupsDefined"/>
						</WTCODEGROUP>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="FriendsText" class="prompt" />
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)" />
				</WTROW>

				<WTROW margin-bottom="6">
					<WTSTATIC col="1" tag="SearchBy" class="ColumnHeader" align="left"/>
					<WTCOMBO col="1" value="ATTR(Friends.FindTypeID)" translate="true"/>
					<WTSTATIC col="1" tag="SearchFor" class="ColumnHeader"/>
					<WTTEXT col="1" value="ATTR(Bookmark.SearchText)" size="20" focus="true"/>
					<WTBUTTON col="1" action="5" value="CONST(Go)" default="true"/>
					<WTBUTTON col="1" value="CONST(Close)">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>
				<WTROW>
					<WTRECORDSET col="1" graybar="true" prevnext="top" entity="Friend">
						<WTCOLUMN width="33" align="left" valign="top" label="FriendName"/>
						<WTCOLUMN width="43" align="left" valign="top" label="Email"/>
						<WTCOLUMN width="12" align="left" valign="top" label="FriendDate"/>
						<WTCOLUMN width="12" align="left" valign="top" label="Status"/>
						<WTROW height="24">
							<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(FRIENDSTATUS-PENDING)"/>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(FriendName)" fontcolor="orange" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="14103">
											<WTPARAM name="FriendID" value="DATA(FriendID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Email)" fontcolor="orange"/>
							<WTSTATIC col="3" value="DATA(FriendDate)" fontcolor="orange"/>
							<WTSTATIC col="4" value="DATA(Status)" fontcolor="orange"/>
						</WTROW>
						<WTROW height="24">
							<WTCONDITION expr="DATA(Status)" oper="equal" value="SYSCON(FRIENDSTATUS-APPROVED)"/>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(FriendName)" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="14103">
											<WTPARAM name="FriendID" value="DATA(FriendID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Email)"/>
							<WTSTATIC col="3" value="DATA(FriendDate)"/>
							<WTSTATIC col="4" value="DATA(Status)"/>
						</WTROW>
						<WTROW height="24">
							<WTCONDITION expr="DATA(Status)" oper="greater" value="SYSCON(FRIENDSTATUS-APPROVED)"/>
							<WTSTATIC col="1">
								<WTSTATIC value="DATA(FriendName)" fontcolor="red" space="1"/>
								<WTCODEGROUP>
									<WTIMAGE value="CONST(Edit.gif)" alt="Edit" imgalign="absmiddle">
										<WTLINK name="14103">
											<WTPARAM name="FriendID" value="DATA(FriendID)"/>
										</WTLINK>
									</WTIMAGE>
								</WTCODEGROUP>
							</WTSTATIC>
							<WTSTATIC col="2" value="DATA(Email)" fontcolor="red"/>
							<WTSTATIC col="3" value="DATA(FriendDate)" fontcolor="red"/>
							<WTSTATIC col="4" value="DATA(Status)" fontcolor="red"/>
						</WTROW>
						<WTROW>
							<WTSTATIC col="1" fontcolor="gray">
								<WTSTATIC value="DATA(FriendGroupName)"/>
							</WTSTATIC>
							<WTSTATIC col="2" merge="3" fontcolor="gray">
								<WTSTATIC value="DATA(DOB)" space="2"/>
								<WTSTATIC value="DATA(Zip)" space="2"/>
								<WTSTATIC value="DATA(CountryName)"/>
							</WTSTATIC>
						</WTROW>
					</WTRECORDSET>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="14102" header="false" footer="false" navbar="false" wrapper="wrapper600"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLAdd.xsl">
 		<!--===============================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="FriendID" datatype="number"/>
			<WTPARAM name="EditStatus" datatype="number"/>

			<WTINCLUDE name="FriendEmail.asp"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(RIGHT180)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(EditStatus)" value="CONST(1)">
					<WTCONDITION expr="IsEmployee"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="FriendGroups" project="ptsFriendGroupUser" class="CFriendGroups">
					<WTMETHOD name="EnumMember">
						<WTPARAM name="xmlFriendGroups" direction="return" datatype="text" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="NewFriend">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(CountryID)" value="CONST(224)"/>
					<WTSETATTRIBUTE name="ATTR(FriendDate)" value="SYS(Date)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(FRIENDSTATUS-PENDING)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTSUB>

			<WTSUB name="AddFriend">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="CONST(0)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(MemberID)" value="PARAM(MemberID)"/>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="Add">
						<WTPARAM name="reqFriendID" direction="return" datatype="number"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTCONDITION expr="IsErrors"/>
						<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTCODEGROUP>
						<WTCONDITION expr="NoErrors"/>
						<WTCUSTOM>
							EmailFriend reqCompanyID, reqMemberID, reqFriendID, .NameFirst, .NameLast, .Email
						</WTCUSTOM>
					</WTCODEGROUP>
				</WTOBJECT>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="NewFriend"/>
			</WTACTION>

			<WTACTION id="2" name="Add" type="Add">
				<WTCALLSUB name="AddFriend"/>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="4" name="AddAnother" type="Add">
				<WTCALLSUB name="AddFriend"/>
				<WTCALLSUB name="NewFriend">
					<WTCONDITION expr="NoErrors"/>
				</WTCALLSUB>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

	 		<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="500" align="left"/>

				<WTROW>
					<WTSTATIC col="1" merge="2" label="NewFriend" class="PageHeading" align="left"/>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" class="prompt" align="left">
						<WTSTATIC label="FriendAddHelp"/>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="FriendName"/>
					<WTTEXT col="2" value="ATTR(Friend.NameFirst)" width="200" label="NameFirst" size="25"/>
					<WTTEXT col="2" value="ATTR(Friend.NameLast)" width="300" label="NameLast" size="25"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Email"/>
					<WTTEXT col="2" value="ATTR(Friend.Email)" size="60"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSFRIENDGROUPS/ENUM))" oper="greater" value="CONST(1)"/>
					<WTSTATIC col="1" tag="FriendGroupID"/>
					<WTCOMBO col="2" value="ATTR(Friend.FriendGroupID)" datapath="/DATA/TXN/PTSFRIENDGROUPS/ENUM" setselected="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(EditStatus)" oper="equal" value="CONST(0)"/>
					<WTHIDDEN value="ATTR(Friend.Status)"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="FriendDate"/>
					<WTTEXT col="2" value="ATTR(Friend.FriendDate)"/>
					<WTSTATIC col="2" tag="Status">
						<WTCONDITION expr="PARAM(EditStatus)" oper="not-equal" value="CONST(0)"/>
					</WTSTATIC>
					<WTCOMBO col="2" value="ATTR(Friend.Status)" noprespace="true">
						<WTCONDITION expr="PARAM(EditStatus)" oper="not-equal" value="CONST(0)"/>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-top="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="LocationText" class="prompt"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Location"/>
					<WTTEXT col="2" value="ATTR(Friend.Zip)" width="100" label="Zip" size="10"/>
					<WTCOMBO col="2" value="ATTR(Friend.CountryID)" width="400" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="DOB"/>
					<WTTEXT col="2" value="ATTR(Friend.DOB)"/>
				</WTROW>

				<WTROW margin-top="24" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="2" value="CONST(Add)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="4" value="CONST(AddAnother)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(Cancel)"/>
				</WTROW>
				
			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="14103" header="false" footer="false" navbar="false" wrapper="wrapper600"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--===============================================================================-->
			<WTPARAM name="FriendID" datatype="number"/>
			<WTPARAM name="CompanyID" datatype="number"/>
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="EditStatus" datatype="number"/>
			<WTPARAM name="EmailFriend" datatype="number"/>

			<WTINCLUDE name="FriendEmail.asp"/>

			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYS(CompanyID)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>
			<WTSETATTRIBUTE name="PARAM(CompanyID)" value="SYSCON(RIGHT180)">
				<WTCONDITION expr="PARAM(CompanyID)" oper="equal" value="CONST(0)"/>
			</WTSETATTRIBUTE>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="PARAM(EditStatus)" value="CONST(1)">
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
				</WTSETATTRIBUTE>
			</WTCODEGROUP>

			<WTSUB name="LoadList">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(CompanyID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="FriendGroups" project="ptsFriendGroupUser" class="CFriendGroups">
					<WTMETHOD name="EnumMember">
						<WTPARAM name="xmlFriendGroups" direction="return" datatype="text" />
						<WTPARAM name="MemberID" direction="input" value="PARAM(MemberID)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>

			<WTSUB name="LoadFriend">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="PARAM(FriendID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadList"/>
			</WTSUB>

			<WTSUB name="UpdateFriend">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="PARAM(FriendID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
			</WTSUB>


			<WTACTION id="0" name="New" type="New">
				<WTCALLSUB name="LoadFriend"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTCALLSUB name="UpdateFriend"/>
				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<WTACTION id="5" name="Email" type="Update">
				<WTCALLSUB name="UpdateFriend"/>
				<WTCALLSUB name="LoadList">
					<WTCONDITION expr="IsErrors"/>
				</WTCALLSUB>
				<WTCODEGROUP>
					<WTCONDITION expr="NoErrors"/>
					<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
						<WTMETHOD name="Load">
							<WTPARAM name="FriendID" direction="input" value="PARAM(FriendID)"/>
							<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
						</WTMETHOD>
						<WTSETATTRIBUTE name="PARAM(MemberID)" value="ATTR(MemberID)"/>
						<WTMETHOD name="XML">
							<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
							<WTPARAM name="Option" direction="input" value="CONST(2)"/>
						</WTMETHOD>
						<WTCUSTOM>
							EmailFriend reqCompanyID, reqMemberID, reqFriendID, .NameFirst, .NameLast, .Email
						</WTCUSTOM>
					</WTOBJECT>
					<WTCALLSUB name="LoadList"/>
				</WTCODEGROUP>
			</WTACTION>

			<WTACTION id="3" name="Cancel" type="Cancel">
				<WTRETURN/>
			</WTACTION>

			<WTACTION id="4" name="Delete" type="Delete">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTMETHOD name="Delete">
						<WTPARAM name="FriendID" direction="input" value="PARAM(FriendID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTCONDITION expr="IsErrors"/>
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="PARAM(FriendID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTRETURN>
					<WTCONDITION expr="NoErrors"/>
				</WTRETURN>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="500" align="left"/>

				<WTROW>
					<WTHIDDEN value="PARAM(MemberID)"/>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" merge="2"  align="left" class="PageHeading">
						<WTSTATIC tag="Friend" space="2"/>
						<WTSTATIC fontcolor="orange">
							<WTCONDITION expr="ATTR(Friend.Status)" oper="equal" value="SYSCON(FRIENDSTATUS-PENDING)"/>
							<WTSTATIC value="ATTR(Friend.FriendName)" space="2"/>
							<WTSTATIC value="CONST(-)" space="1"/>
							<WTSTATIC value="ATTR(Friend.Status)"/>
						</WTSTATIC>
						<WTSTATIC>
							<WTCONDITION expr="ATTR(Friend.Status)" oper="equal" value="SYSCON(FRIENDSTATUS-APPROVED)"/>
							<WTSTATIC value="ATTR(Friend.FriendName)" space="2"/>
							<WTSTATIC value="CONST(-)" space="1"/>
							<WTSTATIC value="ATTR(Friend.Status)"/>
						</WTSTATIC>
						<WTSTATIC fontcolor="red">
							<WTCONDITION expr="ATTR(Friend.Status)" oper="greater" value="SYSCON(FRIENDSTATUS-APPROVED)"/>
							<WTSTATIC value="ATTR(Friend.FriendName)" space="2"/>
							<WTSTATIC value="CONST(-)" space="1"/>
							<WTSTATIC value="ATTR(Friend.Status)"/>
						</WTSTATIC>
						
						<WTSTATIC label="EmailedFriend" fontcolor="blue">
							<WTCONDITION expr="PARAM(EmailFriend)" oper="not-equal" value="CONST(0)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>
				<WTROW margin-top="2" margin-bottom="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" merge="2" class="prompt" align="left">
						<WTSTATIC label="FriendEditHelp" space="1"/>
						<WTSTATIC label="FriendEditHelpa">
							<WTCONDITION expr="ATTR(Friend.Status)" oper="equal" value="SYSCON(FRIENDSTATUS-PENDING)"/>
						</WTSTATIC>
					</WTSTATIC>
				</WTROW>

				<WTROW>
					<WTSTATIC col="1" tag="FriendName"/>
					<WTTEXT col="2" value="ATTR(Friend.NameFirst)" width="200" label="NameFirst" size="25"/>
					<WTTEXT col="2" value="ATTR(Friend.NameLast)" width="300" label="NameLast" size="25"/>
				</WTROW>
				
				<WTCODEGROUP>
					<WTCONDITION expr="NotEmployee"/>
					<WTCONDITION expr="NotOrgAdminOnly" connector="and"/>
					<WTCONDITION expr="NotOrgManagerOnly" connector="and"/>
					<WTCONDITION expr="ATTR(Status)" oper="equal" value="SYSCON(FRIENDSTATUS-APPROVED)" connector="and"/>
					<WTROW>
						<WTHIDDEN value="ATTR(Friend.Email)"/>
					</WTROW>
					<WTROW margin-top="6">
						<WTSTATIC col="1" tag="Email"/>
						<WTSTATIC col="2" value="ATTR(Friend.Email)" bold="true"/>
					</WTROW>
				</WTCODEGROUP>
				<WTCODEGROUP>
					<WTCONDITION expr="IsEmployee"/>
					<WTCONDITION expr="IsOrgAdminOnly" connector="or"/>
					<WTCONDITION expr="IsOrgManagerOnly" connector="or"/>
					<WTCONDITION expr="ATTR(Status)" oper="not-equal" value="SYSCON(FRIENDSTATUS-APPROVED)" connector="or"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" tag="Email"/>
						<WTTEXT col="2" value="ATTR(Friend.Email)" size="60"/>
					</WTROW>
				</WTCODEGROUP>
				
				<WTROW margin-top="6">
					<WTCONDITION expr="CONST(count(/DATA/TXN/PTSFRIENDGROUPS/ENUM))" oper="greater" value="CONST(1)"/>
					<WTSTATIC col="1" tag="FriendGroupID"/>
					<WTCOMBO col="2" value="ATTR(Friend.FriendGroupID)" datapath="/DATA/TXN/PTSFRIENDGROUPS/ENUM" setselected="true"/>
				</WTROW>
				<WTROW>
					<WTCONDITION expr="PARAM(EditStatus)" oper="equal" value="CONST(0)"/>
					<WTHIDDEN value="ATTR(Friend.Status)"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="FriendDate"/>
					<WTTEXT col="2" value="ATTR(Friend.FriendDate)"/>
					<WTSTATIC col="2" tag="Status">
						<WTCONDITION expr="PARAM(EditStatus)" oper="not-equal" value="CONST(0)"/>
					</WTSTATIC>
					<WTCOMBO col="2" value="ATTR(Friend.Status)" noprespace="true">
						<WTCONDITION expr="PARAM(EditStatus)" oper="not-equal" value="CONST(0)"/>
					</WTCOMBO>
				</WTROW>
				<WTROW margin-top="6">
					<WTDIVIDER col="1" merge="2" align="left" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTROW margin-top="6" margin-bottom="6">
					<WTSTATIC col="1" merge="2" align="left" label="LocationText" class="prompt"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="Location"/>
					<WTTEXT col="2" value="ATTR(Friend.Zip)" width="100" label="Zip" size="10"/>
					<WTCOMBO col="2" value="ATTR(Friend.CountryID)" width="400" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
				</WTROW>
				<WTROW margin-top="6">
					<WTSTATIC col="1" tag="DOB"/>
					<WTTEXT col="2" value="ATTR(Friend.DOB)"/>
				</WTROW>

				<WTROW margin-top="24" margin-bottom="12">
					<WTBUTTON col="1" merge="2" action="1" value="CONST(Update)" align="center">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
					<WTBUTTON col="1" merge="2" action="5" value="CONST(EmailFriend)" align="center">
						<WTCONDITION expr="ATTR(Friend.Status)" oper="equal" value="SYSCON(FRIENDSTATUS-PENDING)"/>
					</WTBUTTON>
					<WTBUTTON col="1" action="3" value="CONST(Cancel)"/>
					<WTBUTTON col="1" action="4" value="CONST(Delete)" msg="ConfirmDelete">
						<WTCONDITION expr="IsActive"/>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--===============================================================================-->
		<WTWEBPAGE name="14104" header="false" footer="false" navbar="false" wrapper="wrapper600"
			aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--===============================================================================-->
			<WTPARAM name="C" datatype="number"/>
			<WTPARAM name="F" datatype="number"/>
			<WTPARAM name="Mode" datatype="number"/>

			<WTCODEGROUP>
				<WTSETATTRIBUTE name="CONST(tmpFirst)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(tmpLast)" value="CONST(&quot;&quot;)"/>
				<WTSETATTRIBUTE name="CONST(tmpEmail)" value="CONST(&quot;&quot;)"/>
			</WTCODEGROUP>
			
			<WTSUB name="LoadFile">
				<WTOBJECT name="Countrys" project="ptsCountryUser" class="CCountrys">
					<WTMETHOD name="EnumCompany">
						<WTPARAM name="xmlCountrys" direction="return" datatype="text" />
						<WTPARAM name="CompanyID" direction="input" value="PARAM(C)" />
						<WTPARAM name="ItemID" direction="input" value="CONST()" />
						<WTPARAM name="Element" direction="input" value="CONST()" />
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)" />
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="HTMLFile" project="wtHTMLFile" class="CHTMLFile">
					<WTSETATTRIBUTE name="ATTR(Filename)" value="CONST(&quot;FriendConfirm.htm&quot;)" />
					<WTSETATTRIBUTE name="ATTR(Path)" value="CONST(reqSysWebDirectory + &quot;Sections\Company\&quot; + CStr(reqC))"/>
					<WTSETATTRIBUTE name="ATTR(Language)" value="SYS(language)"/>
					<WTSETATTRIBUTE name="ATTR(Project)" value="CONST(SysProject)"/>
					<WTMETHOD name="Load"/>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlHTMLFile" direction="return" datatype="text"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCUSTOM>
					xmlHTMLFile = Replace( xmlHTMLFile, "{firstname}", tmpFirst )
					xmlHTMLFile = Replace( xmlHTMLFile, "{lastname}", tmpLast )
					xmlHTMLFile = Replace( xmlHTMLFile, "{email}", tmpEmail )
				</WTCUSTOM>
			</WTSUB>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="PARAM(F)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(FRIENDSTATUS-APPROVED)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadFile"/>
			</WTACTION>

			<WTACTION id="1" name="Update" type="Update">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="PARAM(F)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTES/>
					<WTSETATTRIBUTE name="CONST(tmpFirst)" value="ATTR(NameFirst)"/>
					<WTSETATTRIBUTE name="CONST(tmpLast)" value="ATTR(NameLast)"/>
					<WTSETATTRIBUTE name="CONST(tmpEmail)" value="ATTR(Email)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="PARAM(Mode)" value="CONST(1)">
						<WTCONDITION expr="NoErrors"/>
					</WTSETATTRIBUTE>
					<WTMETHOD name="XML">
						<WTPARAM name="xmlFriend" direction="return" datatype="text"/>
						<WTPARAM name="Option" direction="input" value="CONST(2)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTCALLSUB name="LoadFile"/>
			</WTACTION>

			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="100" align="right"/>
				<WTCOLUMN width="500" align="left"/>
				<WTROW>
					<WTSTATIC col="1" merge="2" value="ATTR(HTMLFile.Data)" embedhtml="true"/>
				</WTROW>

				<WTROW margin-top="6">
					<WTDIVIDER col="1" merge="2" height="1" color="SYS(divider)"/>
				</WTROW>
				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="equal" value="CONST(0)"/>
					<WTROW margin-top="6" margin-bottom="6">
						<WTSTATIC col="1" merge="2" align="center" label="PleaseConfirm" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTSTATIC col="1" tag="Name"/>
						<WTTEXT col="2" value="ATTR(Friend.NameFirst)" width="200" label="NameFirst" size="25"/>
						<WTTEXT col="2" value="ATTR(Friend.NameLast)" width="300" label="NameLast" size="25"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTSTATIC col="1" tag="Location"/>
						<WTTEXT col="2" value="ATTR(Friend.Zip)" width="100" label="Zip" size="10"/>
						<WTCOMBO col="2" value="ATTR(Friend.CountryID)" width="400" label="CountryID" datapath="/DATA/TXN/PTSCOUNTRYS/ENUM" setselected="true"/>
					</WTROW>
					<WTROW margin-top="12">
						<WTSTATIC col="1" tag="DOB"/>
						<WTTEXT col="2" value="ATTR(Friend.DOB)"/>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="12">
						<WTBUTTON col="1" merge="2" action="1" value="CONST(Confirm)" align="center"/>
					</WTROW>
				</WTCODEGROUP>

				<WTCODEGROUP>
					<WTCONDITION expr="PARAM(Mode)" oper="not-equal" value="CONST(0)"/>
					<WTROW margin-top="6">
						<WTSTATIC col="1" merge="2" align="center" label="Confirmed" class="PageHeading"/>
					</WTROW>
					<WTROW margin-top="24" margin-bottom="12">
						<WTBUTTON col="1" merge="2" value="CONST(Close)" align="center">
							<WTCLICK>window.close()</WTCLICK>
						</WTBUTTON>
					</WTROW>
				</WTCODEGROUP>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--=============================================================================================-->
		<WTWEBPAGE name="14106" caption="Import Friends" action="false" navbar="false" secured="61" langfile="14106"
		submit="14106Upload.asp" type="multi" aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--=============================================================================================-->
			<WTPARAM name="MemberID" datatype="number"/>
			<WTPARAM name="UploadError" datatype="number"/>
			<WTPARAM name="UploadErrorDesc" datatype="text"/>
			<WTPARAM name="Friends" datatype="number"/>

			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(UploadError)" oper="not-equal" value="CONST(0)"/>
				<WTCUSTOM>
					DoError reqUploadError, "Upload", reqUploadErrorDesc
				</WTCUSTOM>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Friends)" oper="equal" value="CONST(-1)"/>
				<WTCUSTOM>
					DoError reqUploadError, "Import", "No Leads Imported!"
				</WTCUSTOM>
			</WTCODEGROUP>
			<WTCODEGROUP>
				<WTCONDITION expr="PARAM(Friends)" oper="greater" value="CONST(0)"/>
				<WTCUSTOM>
					DoError reqUploadError, "Import", reqFriends &amp; " Friends Successfully Imported!"
				</WTCUSTOM>
			</WTCODEGROUP>

			<WTACTION id="0" name="New" type="New">
				<WTSETCACHE name="MEMBERID" value="PARAM(MemberID)"/>
			</WTACTION>

			<!--*******************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="750" align="left"/>

				<WTROW>
					<WTSTATIC col="1" label="UploadFriends" class="PageHeading"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTDIVIDER col="1" height="1" color="SYS(headerdivider)"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="UploadFriendsText" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="UploadFriendsFormat" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="6">
					<WTSTATIC col="1" label="UploadFriendsExample" class="prompt"/>
				</WTROW>
				<WTROW margin-bottom="24">
					<WTDIVIDER col="1" height="1" color="SYS(divider)"/>
				</WTROW>

				<WTROW margin-bottom="24">
					<WTFILE col="1" value="upload" align="center" size="40"/>
					<WTBUTTON col="1" align="center" default="true" action="1" value="CONST(Submit)"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>

		<!--============================================================================================-->
		<WTWEBPAGE name="14107" caption="Unsubscribe" header="false" footer="false" navbar="false" wrapper="wrapper600"
				   aspstyle="GenerateWebASP.xsl" xslstyle="GenerateWebXSLItem.xsl">
			<!--============================================================================================-->
			<WTPARAM name="F" datatype="number"/>

			<WTINCLUDE name="Comm.asp"/>

			<WTACTION id="0" name="New" type="New">
				<WTOBJECT name="Friend" project="ptsFriendUser" class="CFriend">
					<WTCONDITION expr="PARAM(F)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="FriendID" direction="input" value="PARAM(F)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="ATTR(Status)" value="SYSCON(FRIENDSTATUS-CANCELLED)"/>
					<WTSETATTRIBUTE name="CONST(MemberID)" value="ATTR(MemberID)"/>
					<WTSETATTRIBUTE name="CONST(FriendName)" value="CONST(.NameFirst + &quot; &quot; + .NameLast)"/>
					<WTSETATTRIBUTE name="CONST(MemberID)" value="ATTR(MemberID)"/>
					<WTMETHOD name="Save">
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
				</WTOBJECT>
				<WTOBJECT name="Member" project="ptsMemberUser" class="CMember">
					<WTCONDITION expr="PARAM(F)" oper="not-equal" value="CONST(0)"/>
					<WTMETHOD name="Load">
						<WTPARAM name="MemberID" direction="input" value="CONST(MemberID)"/>
						<WTPARAM name="SecurityToken" direction="input" value="SYS(userid)"/>
					</WTMETHOD>
					<WTSETATTRIBUTE name="CONST(tmpCompanyID)" value="ATTR(CompanyID)"/>
					<WTSETATTRIBUTE name="CONST(tmpTo)" value="ATTR(Email)"/>
					<WTSETATTRIBUTE name="CONST(tmpFrom)" value="CONST(tmpTo)"/>
					<WTSETATTRIBUTE name="CONST(tmpSender)" value="CONST(tmpTo)"/>
					<WTCUSTOM>
						If InStr(tmpTo, "@") &gt; 0 Then
							If InStr(tmpFrom, "@") = 0 Then tmpFrom = tmpTo
							tmpSubject = "Right180 Contact Unsubscibed: " + FriendName
							tmpBody = ""
							SendEmail tmpCompanyID, tmpSender, tmpFrom, tmpTo, "", "", tmpSubject, tmpBody
						End If
					</WTCUSTOM>
				</WTOBJECT>
				
			</WTACTION>
			<!--************************************************************************************-->
			<WTCONTENT>
				<WTCOLUMN width="600" align="center"/>

				<WTROW margin-top="24" margin-bottom="24">
					<WTSTATIC col="1" class="PageHeading" label="UnsubscribeText"/>
				</WTROW>
				<WTROW margin-bottom="12">
					<WTBUTTON col="1" value="CONST(Close)" align="center">
						<WTCLICK>window.close()</WTCLICK>
					</WTBUTTON>
				</WTROW>

			</WTCONTENT>
		</WTWEBPAGE>
	</WTWEBPAGES>
</WTROOT>